<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Test Summary Report</title>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif;margin:0;padding:0;box-sizing:border-box;width:100%}
h1{font-size:20px}
.report-header{background-color:#f6f8fa;border:1px solid #d0d7de;border-radius:6px;padding:16px;margin:16px 0}
.report-header h2{margin:0 0 8px 0;font-size:16px;font-weight:600}
.report-header p{margin:4px 0;font-size:14px}
.report-header a{color:#0969da;text-decoration:none}
.report-header a:hover{text-decoration:underline}
th{text-transform:uppercase}
th,td{padding:5px;word-break:break-word;font-size:14px;min-width:80px}
td.test_name{min-width:72.5vw;max-width:72.5vw}
td.test_name.with_history{min-width:62vw;max-width:62vw}
table{border-collapse:collapse;width:100%;left:5}
span.test_status{font-weight:bold}
span.test_fail{color:red}
span.test_pass{color:green}
span.test_mute{color:blue}
span.test_fail_sanitizer,span.test_error_sanitizer{color:#ff4500;background-color:#fff5ee;padding:2px 4px;border-radius:3px;border-left:3px solid #ff4500}
.svg_passed{fill:green}
.svg_failure{fill:red}
.svg_skipped{fill:gray}
.svg_mute{fill:blue}
.issue-button{display:inline-block;background-color:#f6f8fa;border:1px solid #d0d7de;border-radius:6px;color:#0969da;padding:2px 6px;font-size:11px;font-weight:500;text-decoration:none;margin-left:8px;cursor:pointer;transition:background-color .2s,border-color .2s}
.issue-button:hover{background-color:#f3f4f6;border-color:#d0d7de;text-decoration:none}
.svg-icon{float:left;width:14px;height:14px;padding-left:1px;padding-right:1px;margin-right:0;border-radius:50%;position:relative;cursor:pointer}
.button{display:inline-flex;align-items:center;justify-content:left;padding:4px;border:none;background:none;cursor:pointer;position:relative}
.button svg{fill:#4b535c;fill-rule:evenodd}
.button svg:hover{fill:#0366d6;fill-rule:evenodd}
.button-group{display:inline-flex;float:right;align-items:center;position:relative;white-space:nowrap}
.button-group>button{margin-left:5px;padding:4px 8px;border:none;background:none;cursor:pointer;white-space:nowrap}
.button-group>button svg{fill:#4b535c;fill-rule:evenodd}
.button-group>button svg:hover{fill:#0366d6;fill-rule:evenodd}
.button-group .icon-container .show_history_svg{fill:#fff;stroke:#000;stroke-width:2.5;fill-rule:evenodd}
.button-group .icon-container .show_history_svg:hover{stroke:#0366d6}
.button-group .button-text{color:#4b535c}
.button-group .button-text:hover{color:#0366d6}
.button-group .dropdown{display:none;position:absolute;top:100%;right:0;background-color:#fff;border:1px solid #ddd;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.1);padding:8px;z-index:10;width:160}
.button-group .dropdown.show{display:block}
.button-group .dropdown>button{display:table;margin-bottom:3px}
.button-group button .icon-container{display:inline-block;vertical-align:middle;margin-right:3px}
.button-group button .button-text{margin-left:5px;cursor:pointer}
.button-group button::after{position:absolute;top:100%;left:50%;transform:translateX(-50%);background-color:#7d7d92;color:#fff;padding:2px 5px;border-radius:3px;visibility:hidden;opacity:0;transition:visibility .2s,opacity .2s}
.button-group button:hover::after{visibility:visible;opacity:1}
.tooltip{visibility:hidden;max-width:340px;min-width:260px;word-break:break-word;background-color:#7d7d92;color:#fff;text-align:left;border-radius:5px;padding:5px;position:absolute;z-index:3;bottom:100%;left:50%;margin-left:-95px;opacity:0;transition:opacity .3s;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
.tooltip::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#7d7d92 transparent transparent transparent}
.tooltip.visible{visibility:visible;opacity:1}
table>tbody>tr>td:nth-child(2),table>tbody>tr>td:nth-child(3),table>tbody>tr>td:nth-child(4){text-align:left}
.collapsible-content{display:table-row-group;position:absolute;top:-9999px;left:-9999px;height:0;overflow:hidden}
.collapsible-content.active{position:relative;top:0;left:5;height:auto}
.collapsible-header{cursor:pointer;background-color:#f2f2f2;padding:10px;border:1px solid #ddd;margin-bottom:5px}
.toggle-visibility-buttons{margin-bottom:10px;overflow:hidden;float:right}
.error-button{border:none;cursor:pointer;background:url("data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjM0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIzNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOC41OSAxNi4zNGw0LjU4LTQuNTktNC41OC00LjU5TDEwIDUuNzVsNiA2LTYgNnoiLz48L3N2Zz4=") no-repeat 50% 50%/1em 1em;width:1em;height:1em;content:"";transition:transform .5s}
.error-content{display:none}
.console-frame{font-size:x-small;display:grid;border-radius:4px;overscroll-behavior:none;background:#ddd;padding:5px;color:#f1f2f3;overflow-y:auto;font-family:monospace;word-break:keep-all}
.console-frame::-webkit-scrollbar{width:10px}
.console-frame::-webkit-scrollbar-track{background:#c5c6c8}
.console-frame::-webkit-scrollbar-thumb{background:#838485;border-radius:4px}
pre[class*=language-]{padding:1em;margin:0;overflow:auto}
pre>code[class*=language-]{font-size:x-small}
#errorModal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.5)}
.modal-content{background-color:#fefefe;margin:5% auto;padding:20px;border:1px solid #888;width:80%;border-radius:5px;max-height:80vh;overflow-y:auto}
.close-modal{color:#aaa;float:right;font-size:28px;font-weight:bold;cursor:pointer}
.modal-header{margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #eee;font-size:smaller}
.modal-info{font-size:small;margin-bottom:15px;line-height:1.5}
.modal-info-item{margin-bottom:5px}
.modal-info-label{font-weight:bold;display:inline-block;width:80px}
@media(max-width:768px){
td.test_name{min-width:90vw;max-width:90vw;font-size:12px}
td.test_name.with_history{min-width:85vw;max-width:85vw}
.button-group{display:block;float:none;margin-top:5px}
.svg-icon{width:12px;height:12px}
.modal-content{width:95%;margin:2% auto}
table{font-size:12px}
th,td{padding:3px;min-width:60px}
}
.load-more-btn{display:block;margin:10px auto;padding:10px 20px;background-color:#0969da;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px}
.load-more-btn:hover{background-color:#0550ae}
.test-row{display:table-row}
.test-row.hidden{display:none}
</style>
<script>
const MAX_URL_LENGTH=8000,GITHUB_ISSUE_BASE_URL="https://github.com/ydb-platform/ydb/issues/new";
function buildGitHubIssueUrl(t,e,o){return GITHUB_ISSUE_BASE_URL+"?title="+t+"&body="+e+"&labels="+o+"&type=Bug"}
function showCopiedTooltip(){}
function isDecodable(t){try{return decodeURIComponent(t),!0}catch(t){return!1}}
function safeTruncateEncoded(t,e){if(t.length<=e)return t;let o=t.slice(0,e);for(o=o.replace(/%(?:[0-9A-Fa-f]{0,2})$/,"");o&&!isDecodable(o);)o=/%[0-9A-Fa-f]{2}$/.test(o)?o.slice(0,-3):o.slice(0,-1);return o}
function parseTestName(t){const e=t.trim();let o;return o=e.includes(".py.")?/(.+)\/(.*py.*[^\/]+)$/.exec(e):/(.+)\/([^$]+)$/.exec(e),o?[o[1],o[2]]:(console.error("Unable to split path/test name from %o",e),null)}
function formatTestCommand(t,e){const o=e.split(".");return e=2===o.length?o[0]+"::"+o[1]:o[0]+"."+o[1]+"::"+o.slice(2).join("::"),"./ya make -ttt {{ buid_preset_params }} -F '"+e+"' "+t}
function getTestRunCommand(t){const e=parseTestName(t);if(!e)return"";const[o,n]=e;return formatTestCommand(o,n)}
function getOwnerAreaLabel(t){return({{ owner_area_mapping | tojson }})[t]||""}
function buildLabels(t,e,o){let n=[];return"mute"===t?n.push("mute"):(n.push("bug"),"sanitizer"===t&&(n.push("sanitizer"),e.includes("asan")?n.push("asan"):e.includes("msan")?n.push("msan"):e.includes("tsan")&&n.push("tsan"))),o&&n.push(o),n.join(",")}
function buildIssueBody(t,e,o,n,s,r,i,a,l,c,d,u){let p=encodeURIComponent(e)+"/"+encodeURIComponent(o)+"%0A%0A";return"sanitizer"===t||"mute"===t?p+="**Test mute request**%0A%0A":p+="**Test Failure**%0A%0A",p+="**Build Information:**%0A",r&&""!==r&&(p+="- Version: "+encodeURIComponent(r)+"%0A"),p+="- Build Preset: "+encodeURIComponent(n)+"%0A",p+="- Branch: "+encodeURIComponent(s)+"%0A%0A",p+="**Run Command:**%0A```%0A"+encodeURIComponent(i)+"%0A```%0A%0A",p+="**Owner:** [TEAM:@ydb-platform/"+a+"](https://github.com/orgs/ydb-platform/teams/"+a+")%0A%0A","sanitizer"!==t&&(p+=0!=a+l?"**Summary history:**%0A Success rate **"+a/(a+l)*100+"%25**%0APass:"+a+" Fail:"+l+"%0A%0A":"**Summary history:**%0APass:"+a+" Fail:"+l+"%0A%0A"),p+="**Test run history:** [link](https://datalens.yandex/34xnbsom67hcq?branch="+encodeURIComponent(s)+"%26full_name="+encodeURIComponent(e+"/"+o)+"%26build_type="+encodeURIComponent(n)+")%0A%0A",p+="More info in [dashboard](https://datalens.yandex/4un3zdm0zcnyr)%0A%0A",p}
function buildBodyWithLengthLimit(t,e,o,n,s,r){let i=t;if(e&&Object.keys(e).length>0){let t="**Logs:**%0A";for(const[o,n]of Object.entries(e))t+="- ["+encodeURIComponent(o)+"]("+encodeURIComponent(n)+")%0A";t+="%0A",i+=t}if(o&&""!==o.trim()){const t="**Error Summary:**%0A```%0A",e="%0A```%0A%0A",a="%0A<TRUNCATED>",l=o.trim(),c=encodeURIComponent(l),d=t+e,u=buildGitHubIssueUrl(n,i+d,s);if(!(u.length>r)){const o=r-u.length;if(c.length<=o)i+=t+c+e;else{const n=o-a.length;if(n>0){const o=safeTruncateEncoded(c,n);o&&(i+=t+o+a+e)}}}}return i}
function createIssueGeneric(t,e,o,n,s,r,i,a={}){const l=parseTestName(e);if(!l)return;const[c,d]=l,u="{{build_preset}}",p="{{branch}}",m="{{commit_sha}}",f=getTestRunCommand(e),h=getOwnerAreaLabel(o);let b=t;r&&"bug"===t&&(b="sanitizer");let y;y="sanitizer"===b?"Sanitizer error in "+encodeURIComponent(c)+"/"+encodeURIComponent(d):"mute"===b?"Mute test "+encodeURIComponent(c)+"/"+encodeURIComponent(d):"Test failure in "+encodeURIComponent(c)+"/"+encodeURIComponent(d);const g=buildIssueBody(b,c,d,u,p,m,f,o,n,s,a,i),A=buildLabels(b,u,h),C=buildBodyWithLengthLimit(g,a,i,y,A,MAX_URL_LENGTH),w=buildGitHubIssueUrl(y,C,A);window.open(w,"_blank")}
function createIssue(t,e,o,n,s,r,i={}){createIssueGeneric("bug",t,e,o,n,s,r,i)}
function createMuteIssue(t,e,o,n,s="",r={}){createIssueGeneric("mute",t,e,o,n,!1,s,r)}
function openHistory(t){const e=t.trim(),o="{{build_preset}}",n="{{branch}}";let s="https://datalens.yandex/34xnbsom67hcq?branch="+encodeURIComponent(n)+"&full_name="+encodeURIComponent(e)+"&build_type="+encodeURIComponent(o);window.open(s,"_blank")}
function copyTestNameToClipboard(t){const e=getTestRunCommand(t);e&&(console.log(e),navigator.clipboard.writeText(e).then(()=>{console.log("Copied!"),showCopiedTooltip()},()=>{console.error("Unable to copy %o to clipboard",e)}))}
function copyTestNameForMuteToClipboard(t){const e=parseTestName(t);if(!e)return;const[o,n]=e,s=`${o} ${n}`;console.log(s),navigator.clipboard.writeText(s).then(()=>{console.log("Copied!"),showCopiedTooltip()},()=>{console.error("Unable to copy %o to clipboard",s)})}
function findParentBySelector(t,e){var o=document.querySelectorAll(e),n=t.parentNode;for(;n&&!collectionHas(o,n);)n=n.parentNode;return n}
function collectionHas(t,e){for(var o=0,n=t.length;o<n;o++)if(t[o]==e)return!0;return!1}
function showTestInfo(t){const e=document.getElementById("errorModal"),o=document.getElementById("modalTitle"),n=document.getElementById("modalStatus"),s=document.getElementById("modalDate"),r=document.getElementById("modalSha"),i=document.getElementById("modalJob"),a=document.getElementById("modalErrorContent");o.textContent="Test details: "+t.testName,n.textContent=t.status,s.textContent=t.date;const l=document.getElementById("modalJobLink");l.href=`https://github.com/ydb-platform/ydb/actions/runs/${t.job_id}`,l.textContent=t.job_name;const c=document.getElementById("modalShaLink");c.href=`https://github.com/ydb-platform/ydb//commit/${t.commit}`,c.textContent=t.commit.substring(0,8),n.className="","passed"===t.status?n.classList.add("test_pass"):"failure"===t.status?n.classList.add("test_fail"):"mute"===t.status&&n.classList.add("test_mute"),t.errorText&&""!==t.errorText.trim()?(document.getElementById("modalErrorSection").style.display="block",a.textContent=t.errorText,a.className="language-"+(t.testName.includes(".py")?"python":"cpp")):document.getElementById("modalErrorSection").style.display="none",e.style.display="block"}
function toggleAllTables(t){const e=document.querySelectorAll(".collapsible-content");"expand"===t?e.forEach(t=>t.classList.add("active")):"collapse"===t&&e.forEach(t=>t.classList.remove("active"))}
function ButtonIconsClick(t){t.addEventListener("click",function(){const t=this.querySelector(".icon-container"),e=t.querySelector("svg:first-child"),o=t.querySelector("svg:last-child");e.style.display="none",o.style.display="block"})}
function toggleError(t){const e=t.nextElementSibling,o=e.querySelector(".console-frame"),n=e.querySelector("code");if("none"===e.style.display){if(!n.textContent){const e=t.getAttribute("data-error");e&&(n.textContent=e)}e.style.display="block",o.style.display="block",t.style.transform="rotate(90deg)"}else e.style.display="none",o.style.display="none",t.style.transform="rotate(0deg)"}
function initPagination(){const t=50;document.querySelectorAll("table tbody").forEach(e=>{const o=Array.from(e.querySelectorAll("tr"));if(o.length>t){o.forEach((e,n)=>{n>=t&&(e.classList.add("hidden"),e.classList.add("test-row"))});const n=document.createElement("tr"),s=document.createElement("td");s.colSpan=100,s.style.textAlign="center";const r=document.createElement("button");r.className="load-more-btn",r.textContent=`Load More (${o.length-t} hidden)`,r.onclick=function(){const n=Array.from(e.querySelectorAll("tr.hidden")).slice(0,t);n.forEach(t=>t.classList.remove("hidden"));const s=e.querySelectorAll("tr.hidden").length;0===s?this.parentElement.parentElement.remove():this.textContent=`Load More (${s} hidden)`},s.appendChild(r),n.appendChild(s),e.appendChild(n)}})}
document.addEventListener("DOMContentLoaded",function(){let t=null;const e=document.querySelectorAll(".button-group");e.forEach(e=>{const o=e.querySelector(".dropdown"),n=e.querySelector("button:first-child");n.addEventListener("click",function(){t&&t!==o&&t.classList.remove("show"),o.classList.toggle("show"),t=o.classList.contains("show")?o:null;const n=o.querySelectorAll(".icon-container");n.forEach(t=>{const e=t.querySelector("svg:first-child"),o=t.querySelector("svg:last-child");e.style.display="block",o.style.display="none"})}),document.addEventListener("click",function(e){e.target.closest(".button-group")||(o.classList.remove("show"),t=null)}),e.querySelectorAll(".button-group .dropdown  .button").forEach(t=>{ButtonIconsClick(t)})});document.addEventListener("keydown",function(t){(t.ctrlKey&&70==t.keyCode||t.metaKey&&70==t.keyCode)&&toggleAllTables("expand")});const o=document.querySelectorAll(".svg-icon");o.forEach(t=>{t.addEventListener("click",function(t){t.stopPropagation();const e=this.getAttribute("data-test-name"),o=this.getAttribute("data-status"),n=this.getAttribute("data-date"),s=this.getAttribute("data-error"),r=this.getAttribute("data-commit"),i=this.getAttribute("data-job-name"),a=this.getAttribute("data-job-id");showTestInfo({testName:e,status:o,date:n,errorText:s,commit:r,job_name:i,job_id:a})})});const n=document.querySelectorAll(".copy");n.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault(),copyTestNameToClipboard(findParentBySelector(t.target,"tr").querySelector(".test_name").querySelector("span").innerText)})});const s=document.querySelectorAll(".mute");s.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault(),copyTestNameForMuteToClipboard(findParentBySelector(t.target,"tr").querySelector(".test_name").querySelector("span").innerText)})});const r=document.querySelectorAll(".open_history");r.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault(),openHistory(findParentBySelector(t.target,"tr").querySelector(".test_name").querySelector("span").innerText)})});const i=document.querySelectorAll(".create_issue");i.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();const e=findParentBySelector(t.target,"tr"),o=e.querySelectorAll(".svg_passed").length,n=e.querySelectorAll(".svg_failure").length+e.querySelectorAll(".svg_mute").length,s=e.querySelector(".test_name").querySelector("span").innerText,r=e.querySelector(".test_owner").innerText,i=null!==e.querySelector('.test_name span[style*="background-color: #ff4500"]');let a="";const l=e.querySelector(".error-button");l&&(a=l.getAttribute("data-error")||"");let c={};const d=e.querySelectorAll("td:last-child a");d.forEach(t=>{const e=t.textContent.trim(),o=t.href;e&&o&&(c[e]=o)}),createIssue(s,r,o,n,i,a,c)})});const a=document.querySelectorAll(".create_mute_issue");a.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();const e=findParentBySelector(t.target,"tr"),o=e.querySelectorAll(".svg_passed").length,n=e.querySelectorAll(".svg_failure").length+e.querySelectorAll(".svg_mute").length,s=e.querySelector(".test_name").querySelector("span").innerText,r=e.querySelector(".test_owner").innerText;let i="";const a=e.querySelector(".error-button");a&&(i=a.getAttribute("data-error")||"");let l={};const c=e.querySelectorAll("td:last-child a");c.forEach(t=>{const e=t.textContent.trim(),o=t.href;e&&o&&(l[e]=o)}),createMuteIssue(s,r,o,n,i,l)})});const l=document.querySelectorAll(".collapsible-header");l.forEach(t=>{t.addEventListener("click",function(){const t=this.nextElementSibling;t.classList.contains("active")?t.classList.remove("active"):t.classList.add("active")})}),document.getElementById("expand-all").addEventListener("click",function(t){toggleAllTables("expand")}),document.getElementById("collapse-all").addEventListener("click",function(t){toggleAllTables("collapse")}),document.querySelector(".close-modal").onclick=function(){document.getElementById("errorModal").style.display="none"},window.onclick=function(t){const e=document.getElementById("errorModal");t.target==e&&(e.style.display="none")},initPagination()});
</script>
</head>
<body>
    {% if pr_url or workflow_url %}
    <div class="report-header">
        <h2>Test Report Information</h2>
        {% if pr_url %}
        <p><strong>Pull Request:</strong> <a href="{{ pr_url }}" target="_blank">PR #{{ pr_number }}</a></p>
        {% endif %}
        {% if workflow_url %}
        <p><strong>Workflow Run:</strong> <a href="{{ workflow_url }}" target="_blank">{{ workflow_run_id }}</a></p>
        {% endif %}
        <p><strong>Build Preset:</strong> {{ build_preset }}</p>
        <p><strong>Branch:</strong> {{ branch }}</p>
    </div>
    {% endif %}
    <div class="toggle-visibility-buttons">
        <button id="expand-all">Expand All</button>
        <button id="collapse-all">Collapse All</button>
    </div>
{% for status in status_order %}
{% set sanitizer_count = tests[status] | selectattr('is_sanitizer_issue') | list | length %}
{% set timeout_count = tests[status] | selectattr('is_timeout_issue') | list | length %}
{% set not_launched_count = tests[status] | selectattr('is_not_launched') | list | length %}
<h1 id="{{ status.name}}" class="collapsible-header">
    {{ status.name }} ({{ tests[status] | length }})
    {% if sanitizer_count > 0 %}
        <span style="color: #ff4500; font-weight: bold;">- {{ sanitizer_count }} SANITIZER ISSUE{{ 's' if sanitizer_count != 1 else '' }}</span>
    {% endif %}
    {% if timeout_count > 0 %}
        <span style="color: #ff8c00; font-weight: bold;">- {{ timeout_count }} TIMEOUT ISSUE{{ 's' if timeout_count != 1 else '' }}</span>
    {% endif %}
    {% if not_launched_count > 0 %}
        <span style="color: #6c757d; font-weight: bold;">- {{ not_launched_count }} NOT LAUNCHED ISSUE{{ 's' if not_launched_count != 1 else '' }}</span>
    {% endif %}
</h1>
<table class="collapsible-content active" border="1">
    <thead>
    <tr>
        <th>test owner</th>
        <th>test name</th>
    {% if status.is_error  and history%}
        <th>history<br>
            old->new
        </th>
    {% endif %}
        <th>elapsed</th>
        <th>status</th>
    {% if status in has_any_log %}
        <th>LOG</th>
    {% endif %}
    </tr>
    </thead>
    <tbody>
    {% for t in tests[status] %}
    <tr>
        <td class="test_owner">
            <a href="https://github.com/orgs/ydb-platform/teams/{{ t.owners.replace('TEAM:@ydb-platform/','')}}" target="_blank">{{ t.owners.replace('TEAM:@ydb-platform/','')}}</a>
        </td>
        {% if status.is_error %} 
        <td class="test_name with_history">
        {% else %} 
        <td class="test_name">
        {% endif %}
            <span>{{ t.full_name }}</span>
            {% if status.is_error %}
                <button class="issue-button create_issue" title="Create issue">+ ISSUE</button>
            {% endif %}
            {% if t.is_sanitizer_issue %}
                <span style="background-color: #ff4500; color: white; padding: 2px 6px; border-radius: 12px; font-size: 11px; margin-left: 8px; font-weight: bold;">SANITIZER</span>
            {% endif %}
            {% if t.is_timeout_issue %}
                <span style="background-color: #ff8c00; color: white; padding: 2px 6px; border-radius: 12px; font-size: 11px; margin-left: 8px; font-weight: bold;">TIMEOUT</span>
            {% endif %}
            {% if t.is_not_launched %}
                <span style="background-color: #6c757d; color: white; padding: 2px 6px; border-radius: 12px; font-size: 11px; margin-left: 8px; font-weight: bold;">NOT LAUNCHED</span>
            {% endif %}
            {% if status.is_error %}
            <div class="button-group">
                <button class="button" title="Show options">
                    <svg  class="more"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" stroke="none" aria-hidden="true" viewBox="0 0 448 512">
                        <path  d="M8 256a56 56 0 1 1 112 0A56 56 0 1 1 8 256zm160 0a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112z" clip-rule="evenodd"></path>
                    </svg>
                </button>
                <div class="dropdown">
                    <button class="button copy" title="Copy test filter to clipboard" >
                        <div class="icon-container"> 
                            <svg  class="copy_svg"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" stroke="none" aria-hidden="true" viewBox="0 0 16 16">
                                <path  d="M12 2.5H8A1.5 1.5 0 0 0 6.5 4v1H8a3 3 0 0 1 3 3v1.5h1A1.5 1.5 0 0 0 13.5 8V4A1.5 1.5 0 0 0 12 2.5M11 11h1a3 3 0 0 0 3-3V4a3 3 0 0 0-3-3H8a3 3 0 0 0-3 3v1H4a3 3 0 0 0-3 3v4a3 3 0 0 0 3 3h4a3 3 0 0 0 3-3zM4 6.5h4A1.5 1.5 0 0 1 9.5 8v4A1.5 1.5 0 0 1 8 13.5H4A1.5 1.5 0 0 1 2.5 12V8A1.5 1.5 0 0 1 4 6.5" clip-rule="evenodd"></path>
                            </svg>
                            <svg class="done-icon" width="16" height="16" viewBox="0 0 26 26" fill="green" display="none">
                                <path class="cls-2" d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/>
                                <path class="cls-2" d="M14.7,8.39l-3.78,5L9.29,11.28a1,1,0,0,0-1.58,1.23l2.43,3.11a1,1,0,0,0,.79.38h0a1,1,0,0,0,.79-.39l4.57-6a1,1,0,1,0-1.6-1.22Z"/>
                            </svg>
                        </div>
                        <span class="button-text">Copy run command</span>
                    </button>
                    {% if status.is_error %} 
                    <button class="button mute" title="Copy mute string to clipboard" >
                        <div class="icon-container"> 
                            <svg  class="mute_svg"  xmlns="http://www.w3.org/2000/svg" width="32" height="14" position="left" stroke="none" viewBox="2 0 30 17">
                                <!-- First icon: copied squares -->
                                <path transform="translate(20, 0)" d="M12 2.5H8A1.5 1.5 0 0 0 6.5 4v1H8a3 3 0 0 1 3 3v1.5h1A1.5 1.5 0 0 0 13.5 8V4A1.5 1.5 0 0 0 12 2.5M11 11h1a3 3 0 0 0 3-3V4a3 3 0 0 0-3-3H8a3 3 0 0 0-3 3v1H4a3 3 0 0 0-3 3v4a3 3 0 0 0 3 3h4a3 3 0 0 0 3-3zM4 6.5h4A1.5 1.5 0 0 1 9.5 8v4A1.5 1.5 0 0 1 8 13.5H4A1.5 1.5 0 0 1 2.5 12V8A1.5 1.5 0 0 1 4 6.5"  />
                                <!-- Second icon: microphone -->
                                <path transform="translate(0, 0)" d="M5.06 9.94A1.5 1.5 0 0 0 4 9.5H2a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h2a1.5 1.5 0 0 0 1.06-.44l2.483-2.482a.268.268 0 0 1 .457.19v8.464a.268.268 0 0 1-.457.19zM2 5h2l2.482-2.482A1.768 1.768 0 0 1 9.5 3.768v8.464a1.768 1.768 0 0 1-3.018 1.25L4 11H2a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2m10.28.72a.75.75 0 1 0-1.06 1.06L12.44 8l-1.22 1.22a.75.75 0 1 0 1.06 1.06l1.22-1.22 1.22 1.22a.75.75 0 1 0 1.06-1.06L14.56 8l1.22-1.22a.75.75 0 0 0-1.06-1.06L13.5 6.94z"  />
                            </svg>
                            <svg class="done-icon" width="16" height="16" viewBox="0 0 26 26" fill="green" display="none">
                                <path class="cls-2" d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/>
                                <path class="cls-2" d="M14.7,8.39l-3.78,5L9.29,11.28a1,1,0,0,0-1.58,1.23l2.43,3.11a1,1,0,0,0,.79.38h0a1,1,0,0,0,.79-.39l4.57-6a1,1,0,1,0-1.6-1.22Z"/>
                            </svg>
                        </div>
                        <span class="button-text">Copy mute string</span>
                    </button>
                    <button class="button create_mute_issue" title="Create mute issue">
                        <div class="icon-container"> 
                            <svg class="issue_svg" xmlns="http://www.w3.org/2000/svg" width="32" height="14" position="left"  stroke="none" viewBox="2 0 30 17">
                                <!-- First icon: plus -->
                                <path transform="translate(20, 0)" d="M13.5 8a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0M8.75 5.5a.75.75 0 0 0-1.5 0v1.75H5.5a.75.75 0 0 0 0 1.5h1.75v1.75a.75.75 0 0 0 1.5 0V8.75h1.75a.75.75 0 0 0 0-1.5H8.75z"  />
                                <!-- Second icon: microphone -->
                                <path transform="translate(0, 0)" d="M5.06 9.94A1.5 1.5 0 0 0 4 9.5H2a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h2a1.5 1.5 0 0 0 1.06-.44l2.483-2.482a.268.268 0 0 1 .457.19v8.464a.268.268 0 0 1-.457.19zM2 5h2l2.482-2.482A1.768 1.768 0 0 1 9.5 3.768v8.464a1.768 1.768 0 0 1-3.018 1.25L4 11H2a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2m10.28.72a.75.75 0 1 0-1.06 1.06L12.44 8l-1.22 1.22a.75.75 0 1 0 1.06 1.06l1.22-1.22 1.22 1.22a.75.75 0 1 0 1.06-1.06L14.56 8l1.22-1.22a.75.75 0 0 0-1.06-1.06L13.5 6.94z"  />
                            </svg>
                            <svg class="done-icon" width="16" height="16" viewBox="0 0 26 26" fill="green" display="none">
                                <path class="cls-2" d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/>
                                <path class="cls-2" d="M14.7,8.39l-3.78,5L9.29,11.28a1,1,0,0,0-1.58,1.23l2.43,3.11a1,1,0,0,0,.79.38h0a1,1,0,0,0,.79-.39l4.57-6a1,1,0,1,0-1.6-1.22Z"/>
                            </svg>
                        </div>
                        <span class="button-text">Create mute issue</span>
                    </button>

                     {% endif %}
                    <button class="button open_history" title="Show history">
                        <div class="icon-container"> 
                            <svg class="show_history_svg" width="18" height="18" viewBox="0 0 48 48" fill="none"  xmlns="http://www.w3.org/2000/svg">
                                <path d="M42 24V9C42 7.34315 40.6569 6 39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H24"  stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="32" cy="32" r="6" />
                                <path d="M37 36L42 40"  stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14 16H34"  stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14 24L22 24"   stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <svg class="done-icon" width="16" height="16" viewBox="0 0 26 26" fill="green" display="none">
                                <path class="cls-2" d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/>
                                <path class="cls-2" d="M14.7,8.39l-3.78,5L9.29,11.28a1,1,0,0,0-1.58,1.23l2.43,3.11a1,1,0,0,0,.79.38h0a1,1,0,0,0,.79-.39l4.57-6a1,1,0,1,0-1.6-1.22Z"/>
                            </svg>
                        </div>
                        <span class="button-text">Open test history</span>
                    </button>
           
                    </div>
                </div>
            {% endif %}
            {% if t.status_description %}
            <button class="error-button" onclick="toggleError(this)" data-error="{{ t.status_description | e }}"></button>
            <div style="display:none" class="error-content">
                <div class="console-frame" style="display:none">
                    <pre><code class="language-{{ 'python' if '.py' in t.full_name else 'cpp'}}"></code></pre>
                </div>
            </div>
            {% endif %}
        </td>
        {% if (status.is_error and t.full_name in history) %}
        <td>
            {% for h in history[t.full_name] %}
                <span class="svg-icon" 
                      data-test-name="{{ t.full_name }}" 
                      data-status="{{ history[t.full_name][h].status }}" 
                      data-date="{{ history[t.full_name][h].datetime }}" 
                      data-error="{{ history[t.full_name][h].status_description | e }}" 
                      data-commit="{{ history[t.full_name][h].commit }}"
                      data-job-name="{{ history[t.full_name][h].job_name }}[{{ history[t.full_name][h].branch}}:{{ build_preset }}]"
                      data-job-id="{{ history[t.full_name][h].job_id }}">
                    {% if history[t.full_name][h].status == 'failure' %}
                    <svg class="svg_failure" viewBox="0 0 16 16" >
                        <path  fill-rule="evenodd" d="M13.5 8a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0M6.53 5.47a.75.75 0 0 0-1.06 1.06L6.94 8 5.47 9.47a.75.75 0 1 0 1.06 1.06L8 9.06l1.47 1.47a.75.75 0 1 0 1.06-1.06L9.06 8l1.47-1.47a.75.75 0 1 0-1.06-1.06L8 6.94z" clip-rule="evenodd"></path>
                    </svg>
                    {% elif history[t.full_name][h].status == 'passed' %}
                    <svg class="svg_passed" viewBox="0 0 16 16" >
                        <path fill-rule="evenodd" d="M13.5 8a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0m-3.9-1.55a.75.75 0 1 0-1.2-.9L7.419 8.858 6.03 7.47a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.13-.08z" clip-rule="evenodd"></path>
                    </svg>
                    {% elif history[t.full_name][h].status == 'mute' %}
                    <svg class="svg_mute" viewBox="0 0 17 16" >
                        <path  fill-rule="evenodd" d="M5.06 9.94A1.5 1.5 0 0 0 4 9.5H2a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h2a1.5 1.5 0 0 0 1.06-.44l2.483-2.482a.268.268 0 0 1 .457.19v8.464a.268.268 0 0 1-.457.19zM2 5h2l2.482-2.482A1.768 1.768 0 0 1 9.5 3.768v8.464a1.768 1.768 0 0 1-3.018 1.25L4 11H2a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2m10.28.72a.75.75 0 1 0-1.06 1.06L12.44 8l-1.22 1.22a.75.75 0 1 0 1.06 1.06l1.22-1.22 1.22 1.22a.75.75 0 1 0 1.06-1.06L14.56 8l1.22-1.22a.75.75 0 0 0-1.06-1.06L13.5 6.94z" clip-rule="evenodd"></path>                    </svg>
                    </svg>
                    {% endif %}
                </span>
            {% endfor %}
        </td> 
        {% elif (status.is_error and  history) %}
        <td></td>
        {% elif status.is_error %}
        {% endif %}
        <td><span title="{{ t.elapsed }}s">{{ t.elapsed_display }}</span></td>
        <td>
            <span class="test_status test_{{ t.status_display }}">{{ t.status_display }}</span>
        </td>
        {% if status in has_any_log %}
        <td>
            {% if t.log_urls %}
                {% for log_name, log_url in t.log_urls.items() %}
                <a href="{{ log_url }}">{{ log_name }}</a>{% if not loop.last %} | {% endif %}

                {% endfor %}
            {% else %}
                &nbsp;
            {% endif %}
        </td>
        {% endif %}
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endfor %}

<!-- Модальное окно для детального отображения ошибок -->
<div id="errorModal" class="modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <div class="modal-header">
            <h3 id="modalTitle">Test Details</h3>
        </div>
        <div class="modal-info">
            <div class="modal-info-item">
                <span class="modal-info-label">Run:</span>
                <a id="modalJobLink" href="#" target="_blank"></a>
            </div>
            <div class="modal-info-item">
                <span class="modal-info-label">Status:</span>
                <span id="modalStatus"></span>
            </div>
            <div class="modal-info-item">
                <span class="modal-info-label">Date:</span>
                <span id="modalDate"></span>
            </div>
            <div class="modal-info-item">
                <span class="modal-info-label">Commit:</span>
                <a id="modalShaLink" href="#" target="_blank"></a>
            </div>
        </div>
        <div id="modalErrorSection">
            <div class="console-frame">
                <pre><code id="modalErrorContent"></code></pre>
            </div>
        </div>
    </div>
</div>

</body>
</html>
