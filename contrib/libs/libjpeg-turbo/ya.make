# Generated by devtools/yamaker from nixpkgs 24.05.

LIBRARY()

LICENSE(
    BSD-3-Clause AND
    IJG AND
    Libpbm AND
    Zlib
)

LICENSE_TEXTS(.yandex_meta/licenses.list.txt)

VERSION(3.1.1)

ORIGINAL_SOURCE(https://github.com/libjpeg-turbo/libjpeg-turbo/archive/3.1.1.tar.gz)

ADDINCL(
    contrib/libs/libjpeg-turbo
    contrib/libs/libjpeg-turbo/src
    FOR
    asm
    contrib/libs/libjpeg-turbo/simd/nasm
)

IF (OS_DARWIN OR OS_IOS)
    SET(ASM_PREFIX '_')
ENDIF()

NO_COMPILER_WARNINGS()

NO_RUNTIME()

CFLAGS(
    -DBMP_SUPPORTED
    -DPPM_SUPPORTED
)

CHECK_CONFIG_H(jconfigint.h)

IF (SANITIZER_TYPE)
    CFLAGS(
        -DWITH_SANITIZER
    )
ENDIF()

IF (ARCH_I386 AND NOT OS_ANDROID)
    SRCS(
        simd/i386/jccolor-avx2.asm
        simd/i386/jccolor-mmx.asm
        simd/i386/jccolor-sse2.asm
        simd/i386/jcgray-avx2.asm
        simd/i386/jcgray-mmx.asm
        simd/i386/jcgray-sse2.asm
        simd/i386/jchuff-sse2.asm
        simd/i386/jcphuff-sse2.asm
        simd/i386/jcsample-avx2.asm
        simd/i386/jcsample-mmx.asm
        simd/i386/jcsample-sse2.asm
        simd/i386/jdcolor-avx2.asm
        simd/i386/jdcolor-mmx.asm
        simd/i386/jdcolor-sse2.asm
        simd/i386/jdmerge-avx2.asm
        simd/i386/jdmerge-mmx.asm
        simd/i386/jdmerge-sse2.asm
        simd/i386/jdsample-avx2.asm
        simd/i386/jdsample-mmx.asm
        simd/i386/jdsample-sse2.asm
        simd/i386/jfdctflt-3dn.asm
        simd/i386/jfdctflt-sse.asm
        simd/i386/jfdctfst-mmx.asm
        simd/i386/jfdctfst-sse2.asm
        simd/i386/jfdctint-avx2.asm
        simd/i386/jfdctint-mmx.asm
        simd/i386/jfdctint-sse2.asm
        simd/i386/jidctflt-3dn.asm
        simd/i386/jidctflt-sse.asm
        simd/i386/jidctflt-sse2.asm
        simd/i386/jidctfst-mmx.asm
        simd/i386/jidctfst-sse2.asm
        simd/i386/jidctint-avx2.asm
        simd/i386/jidctint-mmx.asm
        simd/i386/jidctint-sse2.asm
        simd/i386/jidctred-mmx.asm
        simd/i386/jidctred-sse2.asm
        simd/i386/jquant-3dn.asm
        simd/i386/jquant-mmx.asm
        simd/i386/jquant-sse.asm
        simd/i386/jquantf-sse2.asm
        simd/i386/jquanti-avx2.asm
        simd/i386/jquanti-sse2.asm
        simd/i386/jsimd.c
        simd/i386/jsimdcpu.asm
    )
ELSEIF (ARCH_X86_64)
    SRCS(
        simd/x86_64/jccolor-avx2.asm
        simd/x86_64/jccolor-sse2.asm
        simd/x86_64/jcgray-avx2.asm
        simd/x86_64/jcgray-sse2.asm
        simd/x86_64/jchuff-sse2.asm
        simd/x86_64/jcphuff-sse2.asm
        simd/x86_64/jcsample-avx2.asm
        simd/x86_64/jcsample-sse2.asm
        simd/x86_64/jdcolor-avx2.asm
        simd/x86_64/jdcolor-sse2.asm
        simd/x86_64/jdmerge-avx2.asm
        simd/x86_64/jdmerge-sse2.asm
        simd/x86_64/jdsample-avx2.asm
        simd/x86_64/jdsample-sse2.asm
        simd/x86_64/jfdctflt-sse.asm
        simd/x86_64/jfdctfst-sse2.asm
        simd/x86_64/jfdctint-avx2.asm
        simd/x86_64/jfdctint-sse2.asm
        simd/x86_64/jidctflt-sse2.asm
        simd/x86_64/jidctfst-sse2.asm
        simd/x86_64/jidctint-avx2.asm
        simd/x86_64/jidctint-sse2.asm
        simd/x86_64/jidctred-sse2.asm
        simd/x86_64/jquantf-sse2.asm
        simd/x86_64/jquanti-avx2.asm
        simd/x86_64/jquanti-sse2.asm
        simd/x86_64/jsimd.c
        simd/x86_64/jsimdcpu.asm
    )
ELSEIF (ARCH_ARM7_NEON AND NOT MSVC)
    ADDINCL(
        contrib/libs/libjpeg-turbo/simd/arm
    )
    SRCS(
        simd/arm/aarch32/jchuff-neon.c
        simd/arm/aarch32/jsimd.c
        simd/arm/aarch32/jsimd_neon.S
        simd/arm/jccolor-neon.c
        simd/arm/jcgray-neon.c
        simd/arm/jcphuff-neon.c
        simd/arm/jcsample-neon.c
        simd/arm/jdcolor-neon.c
        simd/arm/jdmerge-neon.c
        simd/arm/jdsample-neon.c
        simd/arm/jfdctfst-neon.c
        simd/arm/jfdctint-neon.c
        simd/arm/jidctfst-neon.c
        simd/arm/jidctint-neon.c
        simd/arm/jidctred-neon.c
        simd/arm/jquanti-neon.c
    )
ELSEIF (ARCH_ARM7 AND NOT MSVC)
    ADDINCL(
        contrib/libs/libjpeg-turbo/simd/arm
    )
    SRCS(
        simd/arm/aarch32/jchuff-neon.c
        simd/arm/aarch32/jsimd.c
        simd/arm/aarch32/jsimd_neon.S
        simd/arm/jccolor-neon.c
        simd/arm/jcgray-neon.c
        simd/arm/jcphuff-neon.c
        simd/arm/jcsample-neon.c
        simd/arm/jdcolor-neon.c
        simd/arm/jdmerge-neon.c
        simd/arm/jdsample-neon.c
        simd/arm/jfdctfst-neon.c
        simd/arm/jfdctint-neon.c
        simd/arm/jidctfst-neon.c
        simd/arm/jidctint-neon.c
        simd/arm/jidctred-neon.c
        simd/arm/jquanti-neon.c
    )
ELSEIF (ARCH_ARM64 AND NOT MSVC)
    ADDINCL(
        contrib/libs/libjpeg-turbo/simd/arm
    )
    SRCS(
        simd/arm/aarch64/jchuff-neon.c
        simd/arm/aarch64/jsimd.c
        simd/arm/jccolor-neon.c
        simd/arm/jcgray-neon.c
        simd/arm/jcphuff-neon.c
        simd/arm/jcsample-neon.c
        simd/arm/jdcolor-neon.c
        simd/arm/jdmerge-neon.c
        simd/arm/jdsample-neon.c
        simd/arm/jfdctfst-neon.c
        simd/arm/jfdctint-neon.c
        simd/arm/jidctfst-neon.c
        simd/arm/jidctint-neon.c
        simd/arm/jidctred-neon.c
        simd/arm/jquanti-neon.c
    )
ENDIF()

SRCS(
    src/jaricom.c
    src/jcapimin.c
    src/jcarith.c
    src/jchuff.c
    src/jcicc.c
    src/jcinit.c
    src/jclhuff.c
    src/jcmarker.c
    src/jcmaster.c
    src/jcomapi.c
    src/jcparam.c
    src/jcphuff.c
    src/jctrans.c
    src/jdapimin.c
    src/jdarith.c
    src/jdatadst-tj.c
    src/jdatadst.c
    src/jdatasrc-tj.c
    src/jdatasrc.c
    src/jdhuff.c
    src/jdicc.c
    src/jdinput.c
    src/jdlhuff.c
    src/jdmarker.c
    src/jdmaster.c
    src/jdphuff.c
    src/jdtrans.c
    src/jerror.c
    src/jfdctflt.c
    src/jmemmgr.c
    src/jmemnobs.c
    src/jpeg_nbits.c
    src/rdbmp.c
    src/transupp.c
    src/turbojpeg.c
    src/wrapper/jcapistd-12.c
    src/wrapper/jcapistd-16.c
    src/wrapper/jcapistd-8.c
    src/wrapper/jccoefct-12.c
    src/wrapper/jccoefct-8.c
    src/wrapper/jccolor-12.c
    src/wrapper/jccolor-16.c
    src/wrapper/jccolor-8.c
    src/wrapper/jcdctmgr-12.c
    src/wrapper/jcdctmgr-8.c
    src/wrapper/jcdiffct-12.c
    src/wrapper/jcdiffct-16.c
    src/wrapper/jcdiffct-8.c
    src/wrapper/jclossls-12.c
    src/wrapper/jclossls-16.c
    src/wrapper/jclossls-8.c
    src/wrapper/jcmainct-12.c
    src/wrapper/jcmainct-16.c
    src/wrapper/jcmainct-8.c
    src/wrapper/jcprepct-12.c
    src/wrapper/jcprepct-16.c
    src/wrapper/jcprepct-8.c
    src/wrapper/jcsample-12.c
    src/wrapper/jcsample-16.c
    src/wrapper/jcsample-8.c
    src/wrapper/jdapistd-12.c
    src/wrapper/jdapistd-16.c
    src/wrapper/jdapistd-8.c
    src/wrapper/jdcoefct-12.c
    src/wrapper/jdcoefct-8.c
    src/wrapper/jdcolor-12.c
    src/wrapper/jdcolor-16.c
    src/wrapper/jdcolor-8.c
    src/wrapper/jddctmgr-12.c
    src/wrapper/jddctmgr-8.c
    src/wrapper/jddiffct-12.c
    src/wrapper/jddiffct-16.c
    src/wrapper/jddiffct-8.c
    src/wrapper/jdlossls-12.c
    src/wrapper/jdlossls-16.c
    src/wrapper/jdlossls-8.c
    src/wrapper/jdmainct-12.c
    src/wrapper/jdmainct-16.c
    src/wrapper/jdmainct-8.c
    src/wrapper/jdmerge-12.c
    src/wrapper/jdmerge-8.c
    src/wrapper/jdpostct-12.c
    src/wrapper/jdpostct-16.c
    src/wrapper/jdpostct-8.c
    src/wrapper/jdsample-12.c
    src/wrapper/jdsample-16.c
    src/wrapper/jdsample-8.c
    src/wrapper/jfdctfst-12.c
    src/wrapper/jfdctfst-8.c
    src/wrapper/jfdctint-12.c
    src/wrapper/jfdctint-8.c
    src/wrapper/jidctflt-12.c
    src/wrapper/jidctflt-8.c
    src/wrapper/jidctfst-12.c
    src/wrapper/jidctfst-8.c
    src/wrapper/jidctint-12.c
    src/wrapper/jidctint-8.c
    src/wrapper/jidctred-12.c
    src/wrapper/jidctred-8.c
    src/wrapper/jquant1-12.c
    src/wrapper/jquant1-8.c
    src/wrapper/jquant2-12.c
    src/wrapper/jquant2-8.c
    src/wrapper/jutils-12.c
    src/wrapper/jutils-16.c
    src/wrapper/jutils-8.c
    src/wrapper/rdppm-12.c
    src/wrapper/rdppm-16.c
    src/wrapper/rdppm-8.c
    src/wrapper/wrppm-12.c
    src/wrapper/wrppm-16.c
    src/wrapper/wrppm-8.c
    src/wrbmp.c
)

END()

RECURSE(
    cjpeg
    djpeg
    jpegtran
)
