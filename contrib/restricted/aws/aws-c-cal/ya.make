# Generated by devtools/yamaker from nixpkgs 22.11.

LIBRARY()

LICENSE(
    APSL-2.0 AND
    Apache-2.0
)

LICENSE_TEXTS(.yandex_meta/licenses.list.txt)

VERSION(0.5.26)

ORIGINAL_SOURCE(https://github.com/awslabs/aws-c-cal/archive/v0.5.26.tar.gz)

PEERDIR(
    contrib/libs/openssl
    contrib/restricted/aws/aws-c-common
)

ADDINCL(
    GLOBAL contrib/restricted/aws/aws-c-cal/include
)

NO_COMPILER_WARNINGS()

NO_RUNTIME()

CFLAGS(
    -DAWS_CAL_USE_IMPORT_EXPORT
    -DAWS_COMMON_USE_IMPORT_EXPORT
    -DHAVE_SYSCONF
)

SRCS(
    source/cal.c
    source/der.c
    source/ecc.c
    source/hash.c
    source/hmac.c
    source/symmetric_cipher.c
)

IF (OS_DARWIN)
    LDFLAGS(
        -framework
        Security
    )
    SRCS(
        source/darwin/common_cryptor_spi.h
        source/darwin/commoncrypto_aes.c
        source/darwin/commoncrypto_hmac.c
        source/darwin/commoncrypto_md5.c
        source/darwin/commoncrypto_platform_init.c
        source/darwin/commoncrypto_sha1.c
        source/darwin/commoncrypto_sha256.c
        source/darwin/securityframework_ecc.c
    )
ELSEIF (OS_LINUX)
    SRCS(
        source/unix/openssl_aes.c
        source/unix/openssl_platform_init.c
        source/unix/opensslcrypto_ecc.c
        source/unix/opensslcrypto_hash.c
        source/unix/opensslcrypto_hmac.c
    )
ENDIF()

END()
