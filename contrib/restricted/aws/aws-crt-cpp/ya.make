# Generated by devtools/yamaker from nixpkgs 24.05.

LIBRARY()

LICENSE(
    Apache-2.0 AND
    MIT
)

LICENSE_TEXTS(.yandex_meta/licenses.list.txt)

VERSION(0.19.8)

ORIGINAL_SOURCE(https://github.com/awslabs/aws-crt-cpp/archive/v0.19.8.tar.gz)

PEERDIR(
    contrib/restricted/aws/aws-c-auth
    contrib/restricted/aws/aws-c-cal
    contrib/restricted/aws/aws-c-common
    contrib/restricted/aws/aws-c-event-stream
    contrib/restricted/aws/aws-c-http
    contrib/restricted/aws/aws-c-io
    contrib/restricted/aws/aws-c-mqtt
    contrib/restricted/aws/aws-c-s3
    contrib/restricted/aws/aws-c-sdkutils
)

ADDINCL(
    GLOBAL contrib/restricted/aws/aws-crt-cpp/include
)

NO_COMPILER_WARNINGS()

NO_UTIL()

CFLAGS(
    -DAWS_AUTH_USE_IMPORT_EXPORT
    -DAWS_CAL_USE_IMPORT_EXPORT
    -DAWS_CHECKSUMS_USE_IMPORT_EXPORT
    -DAWS_COMMON_USE_IMPORT_EXPORT
    -DAWS_COMPRESSION_USE_IMPORT_EXPORT
    -DAWS_CRT_CPP_USE_IMPORT_EXPORT
    -DAWS_EVENT_STREAM_USE_IMPORT_EXPORT
    -DAWS_HTTP_USE_IMPORT_EXPORT
    -DAWS_IO_USE_IMPORT_EXPORT
    -DAWS_MQTT_USE_IMPORT_EXPORT
    -DAWS_MQTT_WITH_WEBSOCKETS
    -DAWS_S3_USE_IMPORT_EXPORT
    -DAWS_SDKUTILS_USE_IMPORT_EXPORT
    -DAWS_USE_EPOLL
    -DCJSON_HIDE_SYMBOLS
    -DS2N_CLONE_SUPPORTED
    -DS2N_CPUID_AVAILABLE
    -DS2N_FALL_THROUGH_SUPPORTED
    -DS2N_FEATURES_AVAILABLE
    -DS2N_KYBER512R3_AVX2_BMI2
    -DS2N_LIBCRYPTO_SUPPORTS_EVP_MD5_SHA1_HASH
    -DS2N_LIBCRYPTO_SUPPORTS_EVP_MD_CTX_SET_PKEY_CTX
    -DS2N_LIBCRYPTO_SUPPORTS_EVP_RC4
    -DS2N_MADVISE_SUPPORTED
    -DS2N_PLATFORM_SUPPORTS_KTLS
    -DS2N_STACKTRACE
    -DS2N___RESTRICT__SUPPORTED
)

IF (OS_WINDOWS)
    CFLAGS(
        -DAWS_CRT_CPP_EXPORTS
    )
ENDIF()

SRCS(
    source/Allocator.cpp
    source/Api.cpp
    source/DateTime.cpp
    source/ImdsClient.cpp
    source/JsonObject.cpp
    source/StringUtils.cpp
    source/Types.cpp
    source/UUID.cpp
    source/auth/Credentials.cpp
    source/auth/Sigv4Signing.cpp
    source/crypto/HMAC.cpp
    source/crypto/Hash.cpp
    source/endpoints/RuleEngine.cpp
    source/external/cJSON.cpp
    source/http/HttpConnection.cpp
    source/http/HttpConnectionManager.cpp
    source/http/HttpProxyStrategy.cpp
    source/http/HttpRequestResponse.cpp
    source/io/Bootstrap.cpp
    source/io/ChannelHandler.cpp
    source/io/EventLoopGroup.cpp
    source/io/HostResolver.cpp
    source/io/Pkcs11.cpp
    source/io/SocketOptions.cpp
    source/io/Stream.cpp
    source/io/TlsOptions.cpp
    source/io/Uri.cpp
    source/iot/Mqtt5Client.cpp
    source/iot/MqttClient.cpp
    source/iot/MqttCommon.cpp
    source/mqtt/Mqtt5Client.cpp
    source/mqtt/Mqtt5Packets.cpp
    source/mqtt/MqttClient.cpp
)

END()
