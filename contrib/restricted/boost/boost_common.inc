NO_COMPILER_WARNINGS()

NO_UTIL()

LICENSE(BSL-1.0)

SET(BOOST_ROOT contrib/restricted/boost)

PEERDIR(
    ${BOOST_ROOT}
)

ADDINCL(
    ${BOOST_ROOT}/boost/predef
)

# XXX: fix selective checkout
SRCDIR(${BOOST_ROOT}/boost)

IF (DYNAMIC_BOOST)
    CFLAGS(
        -DBOOST_ATOMIC_DYN_LINK=1
        -DBOOST_All_DYN_LINK=1
        -DBOOST_CHRONO_DYN_LINK=1
        -DBOOST_SYSTEM_DYN_LINK=1
        -DBOOST_TIMER_DYN_LINK=1
    )
ELSE()
    CFLAGS(
        -DBOOST_ATOMIC_STATIC_LINK=1
        -DBOOST_All_STATIC_LINK=1
        -DBOOST_CHRONO_STATIC_LINK=1
        -DBOOST_SYSTEM_STATIC_LINK=1
        -DBOOST_TIMER_STATIC_LINK=1
    )
ENDIF()

CFLAGS(
    -DBOOST_ALL_NO_LIB=1
    -DBOOST_ATOMIC_SOURCE
    -DBOOST_COROUTINES_SOURCE
    -DBOOST_DISABLE_ASSERTS
    -DBOOST_SPIRIT_USE_PHOENIX_V3=1
    -DBOOST_SYSTEM_NO_DEPRECATED
    -DBOOST_THREAD_BUILD_LIB=1
    -DBOOST_THREAD_DONT_USE_CHRONO=1
    -DBOOST_THREAD_NO_LIB=1
    -DBOOST_THREAD_USE_LIB=1
    -DDATE_TIME_INLINE
)

IF (OS_DARWIN AND ARCH_X86_64 OR OS_LINUX AND ARCH_X86_64)
    CFLAGS(
        -DBOOST_THREAD_DONT_USE_CHRONO
        -DBOOST_THREAD_POSIX
    )
ENDIF()

IF (OS_DARWIN)
    CFLAGS(-D_DARWIN_C_SOURCE=1)
ENDIF ()

IF (OS_WINDOWS AND ARCH_X86_64)
    CFLAGS(
        -DBOOST_THREAD_USES_CHRONO
        GLOBAL -DBOOST_USE_WINDOWS_H
        -DNOMINMAX
        -DSECURITY_WIN32
        -DWIN32_LEAN_AND_MEAN
    )
ENDIF()
