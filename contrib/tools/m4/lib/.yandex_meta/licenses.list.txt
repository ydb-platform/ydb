====================BSD-3-Clause====================
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
//   1. Redistributions of source code must retain the above copyright notice,
//      this list of conditions and the following disclaimer.
//
//   2. Redistributions in binary form must reproduce the above copyright
//      notice, this list of conditions and the following disclaimer in the
//      documentation and/or other materials provided with the distribution.
//
//   3. Neither the name of the product nor the names of its contributors may
//      be used to endorse or promote products derived from this software
//      without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
// EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
// OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
// WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
// OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


====================COPYRIGHT====================
    Copyright (C) 1998, 2001, 2003-2006, 2009-2013 Free Software Foundation,
    Inc.


====================COPYRIGHT====================
   Copyright (C) 1985, 1989-1993, 1995-1998, 2000-2003, 2005-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1987-1994, 1996-1998, 2004, 2006, 2009-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1987-1996, 1998-2004, 2006, 2008-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1988, 1990, 1999, 2003-2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1988-1994, 1996-1999, 2003-2006, 2009-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1988-1994, 1996-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1989-1994, 1996-1999, 2001, 2003-2004, 2009-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1989-1994, 1996-1999, 2001, 2003-2007, 2009-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1990, 1998, 2000-2001, 2003-2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1990, 1998-1999, 2001-2002, 2004-2005, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1990, 1998-1999, 2001-2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1990, 1998-2001, 2003-2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1990, 2001, 2003-2006, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 1990-1998, 2000-2007, 2009-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1990-2000, 2002-2006, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1990-2000, 2003-2004, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1991, 2004-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1991-1992, 1994-1999, 2003, 2005-2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1991-2003, 2005-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1992, 1995, 1997-1998, 2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1992, 1999, 2001, 2003, 2005, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1995, 1999, 2001-2004, 2006-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 1995-1996, 2001, 2003, 2005, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1995-1997, 2003, 2006, 2008-2013 Free Software Foundation,
   Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1995-1998, 2000-2002, 2004-2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1996-1997, 2003, 2005, 2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1996-1998, 2001-2003, 2005-2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1996-1999, 2008-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1996-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1996-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 1997, 2000, 2002, 2004, 2006, 2009-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.
   Contributed by Jean-Fran√ßois Bignolles <bignolle@ecoledoc.ibp.fr>, 1997.


====================COPYRIGHT====================
   Copyright (C) 1997, 2003-2004, 2006-2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1997-1998, 2006-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1997-2000, 2002-2004, 2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1997-2006, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1998, 2000, 2003-2004, 2006, 2008-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1998-1999, 2001, 2003, 2009-2013 Free Software Foundation,
   Inc.
   Written by Jim Meyering <meyering@ascend.com>, 1998.


====================COPYRIGHT====================
   Copyright (C) 1998-1999, 2005-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1998-2001, 2003, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1998-2002, 2004, 2006, 2008-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 1998-2002, 2004, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1998-2002, 2004-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1998-2004, 2006-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002, 2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002-2003, 2005, 2007, 2010-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002-2003, 2005-2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002-2003, 2006-2007, 2011-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002-2004, 2006, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002-2004, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2002-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2003, 2005, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999, 2004-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999-2000, 2002-2003, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 1999-2002, 2005-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2008.


====================COPYRIGHT====================
   Copyright (C) 2000, 2002, 2004, 2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000, 2002, 2004, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 2000, 2003, 2005-2006, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 2000, 2003-2004, 2008-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
   Copyright (C) 2000, 2004, 2006-2007, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 2000, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000-2001, 2004-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000-2003, 2006, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000-2003, 2009-2013 Free Software Foundation, Inc.
   This file is part of the GNU CHARSET Library.


====================COPYRIGHT====================
   Copyright (C) 2000-2004, 2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000-2006, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2000-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001, 2003, 2005, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001, 2003, 2005, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001, 2003, 2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001, 2003, 2006-2007, 2009-2013 Free Software Foundation,
   Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2006.


====================COPYRIGHT====================
   Copyright (C) 2001, 2003-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2003.


====================COPYRIGHT====================
   Copyright (C) 2001, 2004-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2004, 2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2004-2006, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2005, 2007, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2005-2007, 2009-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2002.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2006-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2002.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2002, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2003, 2005-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2003, 2005-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2003, 2005-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2003, 2006, 2008-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <haible@clisp.cons.org>, 2001.


====================COPYRIGHT====================
   Copyright (C) 2001-2003, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2003, 2008-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <haible@clisp.cons.org>, 2001.


====================COPYRIGHT====================
   Copyright (C) 2001-2004, 2006, 2009-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2001.


====================COPYRIGHT====================
   Copyright (C) 2001-2004, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2004, 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2004, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2001-2005, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2004, 2006, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2004, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2004, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2005-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2003, 2005-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2003, 2005-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2003, 2006, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2003, 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2004, 2006, 2009-2013 Free Software Foundation,
   Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2004, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2004, 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2004, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2002-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2003, 2005, 2007, 2009-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2003.


====================COPYRIGHT====================
   Copyright (C) 2003, 2006-2007, 2009-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2003.


====================COPYRIGHT====================
   Copyright (C) 2003, 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2003, 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2003, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2003-2004, 2006-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2003.


====================COPYRIGHT====================
   Copyright (C) 2003-2004, 2009-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2003.


====================COPYRIGHT====================
   Copyright (C) 2003-2007, 2009-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2003.


====================COPYRIGHT====================
   Copyright (C) 2003-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2004, 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2004, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2004-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2005, 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2005, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2005-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2005-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2005-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2006, 2011-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2006.


====================COPYRIGHT====================
   Copyright (C) 2006-2007, 2010-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2006-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2007, 2010-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2007-2008, 2010-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2008, 2010-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2008.


====================COPYRIGHT====================
   Copyright (C) 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright (C) 2011-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2011.


====================COPYRIGHT====================
   Copyright 2000-2003, 2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright 2002-2003, 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
   Copyright 2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 1999-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 2002-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 2006-2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 2007, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 2007-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 2008-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
# Copyright (C) 2012-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
/* Copyright (C) 1991, 1993, 1996-1997, 1999-2000, 2003-2004, 2006, 2008-2013
   Free Software Foundation, Inc.


====================COPYRIGHT====================
/* Copyright (C) 1991, 1994-2002, 2005, 2008-2013 Free Software Foundation,
   Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 1991, 1996-1998, 2002-2004, 2006-2007, 2009-2013 Free Software
   Foundation, Inc.


====================COPYRIGHT====================
/* Copyright (C) 1991, 1997, 2009-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 1991-1994, 1996-1998, 2000, 2004, 2007-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 1992, 1995-2002, 2005-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 1998-1999, 2001, 2005-2007, 2009-2013 Free Software
   Foundation, Inc.
   This file is derived from the one in the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 1999, 2001-2002, 2006, 2009-2013 Free Software Foundation,
   Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 1999, 2001-2003, 2006-2007, 2009-2013 Free Software
   Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 2000, 2004, 2009-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Copyright (C) 2000, 2008-2013 Free Software Foundation, Inc.
   This file is part of the GNU C Library.


====================COPYRIGHT====================
/* Sequential list data type implemented by a hash table with a linked list.
   Copyright (C) 2006, 2008-2013 Free Software Foundation, Inc.
   Written by Bruno Haible <bruno@clisp.org>, 2006.


====================COPYRIGHT====================
/* Variable with FSF copyright information, for version-etc.
   Copyright (C) 1999-2006, 2009-2013 Free Software Foundation, Inc.


====================COPYRIGHT====================
//  Copyright (c) 2006-2013 Alexander Chemeris


====================COPYRIGHT====================
Copyright d Free Software Foundation, Inc.

====================File: gnulib/src/filenamecat-lgpl.c====================
/* Concatenate two arbitrary file names.

   Copyright (C) 1996-2007, 2009-2013 Free Software Foundation, Inc.

   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */

/* Written by Jim Meyering.  */

#include <config.h>

/* Specification.  */
#include "filenamecat.h"

#include <stdlib.h>
#include <string.h>

#include "dirname.h"

#if ! HAVE_MEMPCPY && ! defined mempcpy
# define mempcpy(D, S, N) ((void *) ((char *) memcpy (D, S, N) + (N)))
#endif

/* Return the longest suffix of F that is a relative file name.
   If it has no such suffix, return the empty string.  */

static char const * _GL_ATTRIBUTE_PURE
longest_relative_suffix (char const *f)
{
  for (f += FILE_SYSTEM_PREFIX_LEN (f); ISSLASH (*f); f++)
    continue;
  return f;
}

/* Concatenate two file name components, DIR and ABASE, in
   newly-allocated storage and return the result.
   The resulting file name F is such that the commands "ls F" and "(cd
   DIR; ls BASE)" refer to the same file, where BASE is ABASE with any
   file system prefixes and leading separators removed.
   Arrange for a directory separator if necessary between DIR and BASE
   in the result, removing any redundant separators.
   In any case, if BASE_IN_RESULT is non-NULL, set
   *BASE_IN_RESULT to point to the copy of ABASE in the returned
   concatenation.  However, if ABASE begins with more than one slash,
   set *BASE_IN_RESULT to point to the sole corresponding slash that
   is copied into the result buffer.

   Return NULL if malloc fails.  */

char *
mfile_name_concat (char const *dir, char const *abase, char **base_in_result)
{
  char const *dirbase = last_component (dir);
  size_t dirbaselen = base_len (dirbase);
  size_t dirlen = dirbase - dir + dirbaselen;
  size_t needs_separator = (dirbaselen && ! ISSLASH (dirbase[dirbaselen - 1]));

  char const *base = longest_relative_suffix (abase);
  size_t baselen = strlen (base);

  char *p_concat = malloc (dirlen + needs_separator + baselen + 1);
  char *p;

  if (p_concat == NULL)
    return NULL;

  p = mempcpy (p_concat, dir, dirlen);
  *p = DIRECTORY_SEPARATOR;
  p += needs_separator;

  if (base_in_result)
    *base_in_result = p - IS_ABSOLUTE_FILE_NAME (abase);

  p = mempcpy (p, base, baselen);
  *p = '\0';

  return p_concat;
}


====================GPL-3.0-or-later====================
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   The GNU C Library is free software; you can redistribute it and/or
   modify it under the terms of the GNU General Public
   License as published by the Free Software Foundation; either
   version 3 of the License, or (at your option) any later version.

   The GNU C Library is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   General Public License for more details.

   You should have received a copy of the GNU General Public
   License along with the GNU C Library; if not, see
   <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.


====================GPL-3.0-or-later====================
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software: you can redistribute it and/or modify it
   under the terms of the GNU General Public License as published
   by the Free Software Foundation; either version 3 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software: you can redistribute it and/or modify it
   under the terms of the GNU General Public License as published by the
   Free Software Foundation; either version 3 of the License, or any
   later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3, or (at your option)
   any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program; if not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3, or (at your option)
   any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License along
   with this program; if not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
   This program is free software; you can redistribute it and/or modify it
   under the terms of the GNU General Public License as published
   by the Free Software Foundation; either version 3, or (at your option)
   any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   General Public License for more details.

   You should have received a copy of the GNU General Public
   License along with this program; if not, see
   <http://www.gnu.org/licenses/>.


====================GPL-3.0-or-later====================
   This program is free software; you can redistribute it and/or modify it
   under the terms of the GNU General Public License as published by the
   Free Software Foundation; either version 3, or (at your option) any
   later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program; if not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.\n\
This is free software: you are free to change and redistribute it.\n\
There is NO WARRANTY, to the extent permitted by law.\n\


====================GPL-3.0-or-later====================
This program is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 3 of the License, or any
later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.  */


====================GPL-3.0-or-later====================
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, see <http://www.gnu.org/licenses/>.  */


====================LGPL-2.0-or-later====================
/* Just like mfile_name_concat (filenamecat-lgpl.c), except, rather than
