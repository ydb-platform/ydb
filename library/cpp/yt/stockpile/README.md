# stockpile

При приближении к лимиту памяти в memory cgroup, linux запускает механизм direct reclaim,
чтобы освободить свободную память. По опыту YT, direct reclaim очень сильно замедляет работу
всего процесса.

Проблема возникает не только, когда память занята анонимными страницами. 50% памяти контейнера
может быть занято не dirty страницами page cache, но проблема всёравно будет проявляться. Например,
если процесс активно читает файлы с диска без O_DIRECT, вся память очень быстро будет забита.

Чтобы бороться с этой проблемой, в яндексовом ядре добавлена ручка `madvise(MADV_STOCKPILE)`.
Больше подробностей в https://st.yandex-team.ru/KERNEL-186