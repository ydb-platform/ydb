Trying to start YDB, gRPC: 9634, MsgBus: 19976
2025-10-07T09:17:17.827718Z node 1 :METADATA_PROVIDER WARN: log.cpp:841: fline=table_exists.cpp:54;actor=TTableExistsActor;event=undelivered;self_id=[1:7558406443101620092:2066];send_to=[0:7307199536658146131:7762515];
2025-10-07T09:17:17.827749Z node 1 :METADATA_PROVIDER ERROR: log.cpp:841: fline=accessor_snapshot_base.cpp:71;action=cannot detect path existence;path=//Root/.metadata/initialization/migrations;error=scheme_cache_undelivered_message;
test_client.cpp: SetPath # /home/s2m1/.ya/build/build_root/g9tj/000028/r3tmp/tmpfccIgr/pdisk_1.dat
2025-10-07T09:17:18.088756Z node 1 :KQP_PROXY WARN: kqp_finalize_script_service.cpp:135: [ScriptExecutions] [TKqpFinalizeScriptService] Failed to check script execution tables existence, scheme status: LookupError, path: Root/.metadata/script_executions
2025-10-07T09:17:18.094429Z node 1 :HIVE WARN: node_info.cpp:25: HIVE#72057594037968897 Node(1, (0,0,0,0)) VolatileState: Unknown -> Disconnected
2025-10-07T09:17:18.094495Z node 1 :HIVE WARN: node_info.cpp:25: HIVE#72057594037968897 Node(1, (0,0,0,0)) VolatileState: Disconnected -> Connecting
2025-10-07T09:17:18.181422Z node 1 :CONFIGS_DISPATCHER ERROR: configs_dispatcher.cpp:1229: Notification cookie mismatch for subscription [1:7558406443101620066:2081] 1759828637827059 != 1759828637827062
2025-10-07T09:17:18.196878Z node 1 :IMPORT WARN: schemeshard_import.cpp:307: Table profiles were not loaded
2025-10-07T09:17:18.197474Z node 1 :HIVE WARN: node_info.cpp:25: HIVE#72057594037968897 Node(1, (0,0,0,0)) VolatileState: Connecting -> Connected
TServer::EnableGrpc on GrpcPort 9634, node 1
2025-10-07T09:17:18.212892Z node 1 :NET_CLASSIFIER WARN: net_classifier.cpp:190: distributable config is empty, broken or outdated, will use file: (empty maybe)
2025-10-07T09:17:18.212904Z node 1 :NET_CLASSIFIER WARN: net_classifier.cpp:196: will try to initialize from file: (empty maybe)
2025-10-07T09:17:18.212907Z node 1 :NET_CLASSIFIER WARN: net_classifier.cpp:204: failed to initialize from file: (empty maybe)
2025-10-07T09:17:18.213000Z node 1 :NET_CLASSIFIER ERROR: net_classifier.cpp:228: got bad distributable configuration
TClient is connected to server localhost:19976
2025-10-07T09:17:18.341409Z node 1 :KQP_PROXY WARN: kqp_finalize_script_service.cpp:135: [ScriptExecutions] [TKqpFinalizeScriptService] Failed to check script execution tables existence, scheme status: PathErrorUnknown, path: Root/.metadata/script_executions
TClient is connected to server localhost:19976
WaitRootIsUp 'Root'...
TClient::Ls request: Root
TClient::Ls response: Status: 1
StatusCode: SUCCESS
SchemeStatus: 0
PathDescription {
  Self {
    Name: "Root"
    PathId: 1
    SchemeshardId: 72057594046644480
    PathType: EPathTypeDir
    CreateFinished: true
    CreateTxId: 1
    CreateStep: 0
    ParentPathId: 1
    PathState: EPathStateNoChanges
    Owner: "root@builtin"
    ACL: ""
    EffectiveACL: ""
    PathVersion: 2
    PathSubType: EPathSubTypeEmpty
    Version {
      GeneralVersion: 2
      ACLVersion: 0
      EffectiveACLVersion: 0
      UserAttrsVersion: 1
      ChildrenVersion: 1
      SubDomainVersion: 0
      SecurityStateVersion: 0
    }
    ChildrenExist: false
  }
  Children {
    Name: ".sys"
    PathId: 18446744073709551615
    SchemeshardId: 72057594046644480
    PathType: EPathTypeDir
    CreateFinished: true
    CreateTxId: 0
    CreateStep: 0
    ParentPathId: 18446744073709551615
  }
  DomainDescription {
    SchemeShardId_Depricated: 72057594046644480
    PathId_Depricated: 1
    ProcessingParams {
      Version: 0
      Pl...
(TRUNCATED)
WaitRootIsUp 'Root' success.
2025-10-07T09:17:18.473469Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpAlterSubDomain, opId: 281474976710657:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_alter_subdomain.cpp:311)
waiting...
2025-10-07T09:17:18.836382Z node 1 :TX_CONVEYOR ERROR: log.cpp:841: fline=service.h:53;problem=unexpected event for task executor;ev_type=NActors::TEvents::TEvWakeup;
2025-10-07T09:17:20.023992Z node 1 :KQP_WORKLOAD_SERVICE WARN: scheme_actors.cpp:225: [WorkloadService] [TPoolFetcherActor] ActorId: [1:7558406455986522835:2496], DatabaseId: /Root, PoolId: default, Failed to fetch pool info, NOT_FOUND, issues: { <main>: Error: Resource pool default not found or you don't have access permissions }
2025-10-07T09:17:20.024287Z node 1 :KQP_WORKLOAD_SERVICE WARN: scheme_actors.cpp:225: [WorkloadService] [TPoolFetcherActor] ActorId: [1:7558406455986522817:2493], DatabaseId: /Root, PoolId: default, Failed to fetch pool info, NOT_FOUND, issues: { <main>: Error: Resource pool default not found or you don't have access permissions }
2025-10-07T09:17:20.024346Z node 1 :KQP_WORKLOAD_SERVICE WARN: kqp_workload_service.cpp:263: [WorkloadService] [Service] Failed to fetch pool default, DatabaseId: /Root, status: NOT_FOUND, issues: { <main>: Error: Resource pool default not found or you don't have access permissions }
2025-10-07T09:17:20.025028Z node 1 :KQP_WORKLOAD_SERVICE WARN: scheme_actors.cpp:225: [WorkloadService] [TPoolFetcherActor] ActorId: [1:7558406455986522841:2498], DatabaseId: /Root, PoolId: default, Failed to fetch pool info, NOT_FOUND, issues: { <main>: Error: Resource pool default not found or you don't have access permissions }
2025-10-07T09:17:20.025089Z node 1 :KQP_WORKLOAD_SERVICE WARN: kqp_workload_service.cpp:263: [WorkloadService] [Service] Failed to fetch pool default, DatabaseId: /Root, status: NOT_FOUND, issues: { <main>: Error: Resource pool default not found or you don't have access permissions }
2025-10-07T09:17:20.026943Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateResourcePool, opId: 281474976710658:3, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_resource_pool.cpp:179)
2025-10-07T09:17:20.035588Z node 1 :KQP_WORKLOAD_SERVICE WARN: helpers.h:73: [WorkloadService] [TPoolCreatorActor] ActorId: [1:7558406455986522839:2497], DatabaseId: /Root, PoolId: default, Scheduled retry for error: { <main>: Error: Transaction 281474976710658 completed, doublechecking }
2025-10-07T09:17:20.097666Z node 1 :TX_PROXY ERROR: schemereq.cpp:590: Actor# [1:7558406455986522892:2345] txid# 281474976710659, issues: { message: "Check failed: path: \'/Root/.metadata/workload_manager/pools/default\', error: path exist, request accepts it (id: [OwnerId: 72057594046644480, LocalPathId: 5], type: EPathTypeResourcePool, state: EPathStateNoChanges), source_location: ydb/core/tx/schemeshard/schemeshard__operation_create_resource_pool.cpp:92" severity: 1 }
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406455986522909:2502], cluster: db, database: /Root, text: "\n            CREATE EXTERNAL DATA SOURCE `pqSourceName` WITH (\n                SOURCE_TYPE = \"Ydb\",\n                LOCATION = \"localhost:2893\",\n                DATABASE_NAME = \"local\",\n                AUTH_METHOD = \"NONE\"\n            );", startTime: 2025-10-07T09:17:20.099423Z
2025-10-07T09:17:20.341242Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:20.341813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 '('('"auth_method" '"NONE") '('"database_name" '"local") '('"location" '"localhost:2893") '('"source_type" '"Ydb")))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('objectId (String '"/Root/pqSourceName")) '('typeId (String '"EXTERNAL_DATA_SOURCE"))) (Void) '('('mode 'createObject) '('features $1))))
)
2025-10-07T09:17:20.342078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 '('('"auth_method" '"NONE") '('"database_name" '"local") '('"location" '"localhost:2893") '('"source_type" '"Ydb")))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('objectId (String '"/Root/pqSourceName")) '('typeId (String '"EXTERNAL_DATA_SOURCE"))) (Void) '('('mode 'createObject) '('features $1))))
)
2025-10-07T09:17:20.349259Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:20.349569Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '('('"auth_method" '"NONE") '('"database_name" '"local") '('"location" '"localhost:2893") '('"source_type" '"Ydb")))
(let $3 (KiCreateObject! world $1 '"/Root/pqSourceName" '"EXTERNAL_DATA_SOURCE" $2 '0 '0 world))
(return (Commit! $3 $1 '('('"mode" '"flush"))))
)
2025-10-07T09:17:20.349617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #51
2025-10-07T09:17:20.349652Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #51, status: Ok
2025-10-07T09:17:20.350043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #50
2025-10-07T09:17:20.350106Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #51, status: Async
2025-10-07T09:17:20.350214Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #50
2025-10-07T09:17:20.350287Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionComplete after apply async changes for node #50
2025-10-07T09:17:20.350334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #51
2025-10-07T09:17:20.350367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #51, status: Ok
2025-10-07T09:17:20.350413Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #51<Commit!> finished execution
2025-10-07T09:17:20.350472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #51<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.350509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #51, status: Ok
2025-10-07T09:17:20.350546Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #51
2025-10-07T09:17:20.350868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzbys054fat64g151qt7af, SessionId: CompileActor 2025-10-07 12:17:20.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406455986522909:2502], duration: 0.251385s
2025-10-07T09:17:20.353262Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateExternalDataSource, opId: 281474976710660:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_external_data_source.cpp:268)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406455986522941:2508], cluster: db, database: /Root, text: "\n            CREATE OBJECT secret_name (TYPE SECRET) WITH (value = \"root@builtin\");\n            CREATE EXTERNAL DATA SOURCE `ydbSourceName` WITH (\n                SOURCE_TYPE = \"Ydb\",\n                LOCATION = \"localhost:2893\",\n                DATABASE_NAME = \"local\",\n                AUTH_METHOD = \"TOKEN\",\n                TOKEN_SECRET_NAME = \"secret_name\",\n                USE_TLS = \"FALSE\"\n            );", startTime: 2025-10-07T09:17:20.363721Z
2025-10-07T09:17:20.382078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:20.382894Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Write! world (DataSink '"kikimr" '"db") (Key '('objectId (String '"secret_name")) '('typeId (String '"SECRET"))) (Void) '('('mode 'createObject) '('features '('('"value" '"root@builtin"))))))
(let $2 '('('"auth_method" '"TOKEN") '('"database_name" '"local") '('"location" '"localhost:2893") '('"source_type" '"Ydb") '('"token_secret_name" '"secret_name") '('"use_tls" '"FALSE")))
(return (Write! $1 (DataSink '"kikimr" '"db") (Key '('objectId (String '"/Root/ydbSourceName")) '('typeId (String '"EXTERNAL_DATA_SOURCE"))) (Void) '('('mode 'createObject) '('features $2))))
)
2025-10-07T09:17:20.383346Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Write! world (DataSink '"kikimr" '"db") (Key '('objectId (String '"secret_name")) '('typeId (String '"SECRET"))) (Void) '('('mode 'createObject) '('features '('('"value" '"root@builtin"))))))
(let $2 '('('"auth_method" '"TOKEN") '('"database_name" '"local") '('"location" '"localhost:2893") '('"source_type" '"Ydb") '('"token_secret_name" '"secret_name") '('"use_tls" '"FALSE")))
(return (Write! $1 (DataSink '"kikimr" '"db") (Key '('objectId (String '"/Root/ydbSourceName")) '('typeId (String '"EXTERNAL_DATA_SOURCE"))) (Void) '('('mode 'createObject) '('features $2))))
)
2025-10-07T09:17:20.389272Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.389 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:20.389654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.389 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 (KiCreateObject! world $1 '"secret_name" '"SECRET" '('('"value" '"root@builtin")) '0 '0 world))
(let $3 '('('"auth_method" '"TOKEN") '('"database_name" '"local") '('"location" '"localhost:2893") '('"source_type" '"Ydb") '('"token_secret_name" '"secret_name") '('"use_tls" '"FALSE")))
(let $4 (KiCreateObject! $2 $1 '"/Root/ydbSourceName" '"EXTERNAL_DATA_SOURCE" $3 '0 '0 world))
(return (Commit! $4 $1 '('('"mode" '"flush"))))
)
2025-10-07T09:17:20.389702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.389 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #89
2025-10-07T09:17:20.389742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.389 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #89, status: Ok
2025-10-07T09:17:20.390009Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.389 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #80
2025-10-07T09:17:20.390076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #89, status: Async
2025-10-07T09:17:20.390187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #80
2025-10-07T09:17:20.390252Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionComplete after apply async changes for node #80
2025-10-07T09:17:20.390296Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #89
2025-10-07T09:17:20.390338Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #89, status: Ok
2025-10-07T09:17:20.390564Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #88
2025-10-07T09:17:20.390617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #89, status: Async
2025-10-07T09:17:20.390683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #88
2025-10-07T09:17:20.390735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionComplete after apply async changes for node #88
2025-10-07T09:17:20.390777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #89
2025-10-07T09:17:20.390816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #89, status: Ok
2025-10-07T09:17:20.390866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #89<Commit!> finished execution
2025-10-07T09:17:20.390922Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #89<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.390963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #89, status: Ok
2025-10-07T09:17:20.390996Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.390 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #89
2025-10-07T09:17:20.391353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0k74khdry9e9x7gk3hz, SessionId: CompileActor 2025-10-07 12:17:20.391 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406455986522941:2508], duration: 0.027565s
2025-10-07T09:17:20.395628Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710661:1, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406455986523049:2522], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:20.486729Z
2025-10-07T09:17:20.555375Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.555 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:20.556291Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.555 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:20.556786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.556 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:20.559456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:20.585219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:20.590295Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:20.593903Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:20.594590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:20.594640Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:20.594680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:20.598470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:20.598858Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.599166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.599208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.599 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.604529Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.604 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:20.644897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:20.651083Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.651 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:20.656845Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.656 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:20.664555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.664 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:20.674563Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"50af7afc-d86338e1-f1f40151-2fb01eb9") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.675374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"50af7afc-d86338e1-f1f40151-2fb01eb9") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.675419Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.675 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.677051Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.676 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"50af7afc-d86338e1-f1f40151-2fb01eb9") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.677841Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.677 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"50af7afc-d86338e1-f1f40151-2fb01eb9") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.677883Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.677 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.726568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:20.782048Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.781 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:20.782170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:20.782217Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:20.782294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:20.782409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:20.782458Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:20.782502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:20.782536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:20.782683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:20.782728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:20.782765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:20.782930Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:20.782976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:20.783034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:20.783084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.783127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:20.783173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.783211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:20.783261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:20.783357Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:20.783401Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:20.783444Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:20.783486Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:20.783529Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.783 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:20.784595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc0q33vshyhg4w563p5rx, SessionId: CompileActor 2025-10-07 12:17:20.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406455986523049:2522], duration: 0.297816s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406455986523077:2531], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:20.799442Z
2025-10-07T09:17:20.820941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:20.821816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:20.822250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:20.837788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406455986523090:2538], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:20.842012Z
2025-10-07T09:17:20.842177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:20.842796Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:20.842847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:20.842885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:20.847085Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:20.847512Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:20.847853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:20.847893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.848100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:20.848711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:20.849012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:20.851023Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.850 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:20.852019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.851 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:20.859358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.859 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:20.860973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.860 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:20.861368Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.860 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:20.861410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.861 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.862218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.861 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:20.862595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:20.862636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.863412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:20.866397Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:20.866868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:20.866918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:20.866958Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:20.870740Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.870 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:20.870980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.870 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.871158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.870 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.871198Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.871 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.873402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.873 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:20.875760Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.875 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:20.878820Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.878 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:20.882892Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.882 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:20.884532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:20.884608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:20.884724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:20.884773Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:20.884817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:20.884853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:20.884974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:20.885019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:20.885061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:20.885123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:20.885166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.885211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:20.885257Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:20.885908Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc10y08239bk44kcy04ft, SessionId: CompileActor 2025-10-07 12:17:20.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406455986523077:2531], duration: 0.086417s
2025-10-07T09:17:20.888747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.888 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.889119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.888 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.889162Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.889 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.889973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.889 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.890341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.889 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.890382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.890 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.893279Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:20.898252Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpModifyACL, opId: 281474976710664:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_modify_acl.cpp:101)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406455986523125:2551], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:20.902939Z
2025-10-07T09:17:20.910844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:20.911697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:20.912145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:20.914558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.914 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:20.926417Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.926 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:20.929687Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:20.929801Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:20.929856Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:20.929908Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:20.930004Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:20.930061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:20.930107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:20.930148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:20.930300Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:20.930345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:20.930382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:20.930527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:20.930574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:20.930629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:20.930674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.930721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:20.930766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:20.930804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:20.930841Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:20.931439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:20.931729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc129605arpcfe06tse6s, SessionId: CompileActor 2025-10-07 12:17:20.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406455986523090:2538], duration: 0.089666s
2025-10-07T09:17:20.935046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:20.935683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:20.935732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:20.935772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:20.939801Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:20.940164Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:20.940484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.940 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:20.940525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.940 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:20.945439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:20.985517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.985 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:20.991549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.991 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:20.997262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:20.997 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:21.004754Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.004 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:21.014735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.013 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"214a471-71e47230-49445198-5018b3b1") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.015535Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.014 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"214a471-71e47230-49445198-5018b3b1") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.015579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.015 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.017192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.016 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"214a471-71e47230-49445198-5018b3b1") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.017968Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"214a471-71e47230-49445198-5018b3b1") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.018011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.065966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.065 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:21.118179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:21.118291Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:21.118339Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:21.118389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:21.118497Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:21.118546Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:21.118590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:21.118633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:21.118761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:21.118805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:21.118847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:21.118989Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:21.119037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:21.119092Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:21.119139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.119187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:21.119246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.119286Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:21.119323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:21.119413Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:21.119458Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:21.119501Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:21.119545Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:21.119588Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.119 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:21.120610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1461xectana6p5dkc7b, SessionId: CompileActor 2025-10-07 12:17:21.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406455986523125:2551], duration: 0.217622s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490469:2565], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:21.127565Z
2025-10-07T09:17:21.135667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.135 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.136494Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:21.136920Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:21.151505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.155751Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.156358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:21.156406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.156 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:21.156446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.156 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:21.160172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.160565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:21.160898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:21.160939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.164907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:21.173489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:21.173873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:21.173915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.174722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:21.175091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:21.175133Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.175 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.196183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:21.196272Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:21.196374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:21.196425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:21.196470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:21.196505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:21.196617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:21.196662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:21.196708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:21.196761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:21.196811Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.196851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:21.196888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:21.197530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1b66f4b972547sa1sp6, SessionId: CompileActor 2025-10-07 12:17:21.197 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490469:2565], duration: 0.069917s
2025-10-07T09:17:21.206948Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710669:1, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490570:2583], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:21.230025Z
2025-10-07T09:17:21.237655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.237 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.238494Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.238 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.238947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.238 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.241632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.241 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:21.253173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.258072Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.258 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:21.261657Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.262304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:21.262352Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.262 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:21.262387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.262 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:21.266324Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.266681Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.266992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.267034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.267 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.271850Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.271 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:21.313439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.313 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:21.319798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.319 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:21.325573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.325 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:21.333184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.333 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:21.343193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.342 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"12cbf783-998c67ce-f877a4db-1c42e727") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.343992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"12cbf783-998c67ce-f877a4db-1c42e727") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.344039Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.345651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"12cbf783-998c67ce-f877a4db-1c42e727") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.346425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"12cbf783-998c67ce-f877a4db-1c42e727") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.346472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.394446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.394 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:21.446761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.446 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:21.446877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.446 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:21.446927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.446 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:21.446978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.446 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:21.447084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:21.447131Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:21.447174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:21.447212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:21.447366Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:21.447409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:21.447450Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:21.447598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:21.447645Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:21.447700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:21.447746Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.447792Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:21.447837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.447875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:21.447911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:21.448009Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.447 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:21.448055Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.448 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:21.448093Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.448 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:21.448135Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.448 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:21.448178Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.448 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:21.449247Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1ed4y3j7myn03nw37h8, SessionId: CompileActor 2025-10-07 12:17:21.449 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490570:2583], duration: 0.219161s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490596:2592], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:21.456439Z
2025-10-07T09:17:21.465199Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.465 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.466055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.465 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:21.466502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.466 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:21.483948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.483 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.488581Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.489184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:21.489246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.489 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:21.489282Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.489 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:21.493041Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.493440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:21.493777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:21.493817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.497918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.497 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:21.506751Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.506 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:21.507167Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.506 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:21.507211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.507 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.508038Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.507 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:21.508436Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:21.508479Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.543974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:21.544087Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:21.544222Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:21.544307Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:21.544374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:21.544435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:21.544597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:21.544662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:21.544722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:21.544804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:21.544873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.544931Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:21.544987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:21.545944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1nfckejk87m8gn5dfad, SessionId: CompileActor 2025-10-07 12:17:21.545 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490596:2592], duration: 0.089432s
2025-10-07T09:17:21.553895Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710672:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490683:2609], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:21.576665Z
2025-10-07T09:17:21.585076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.584 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.585983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.586439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.589094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:21.601371Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.601 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.606352Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.606 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:21.609949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.609 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.610603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.610 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:21.610651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.610 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:21.610692Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.610 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:21.614554Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.614 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.614969Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.614 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.615298Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.614 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.615340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.615 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.620337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:21.660264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:21.666528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:21.672385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.672 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:21.680074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:21.690291Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.689 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"236c23b-82577c93-d89e5c50-b8867357") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.691093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.690 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"236c23b-82577c93-d89e5c50-b8867357") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.691138Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.692795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"236c23b-82577c93-d89e5c50-b8867357") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.693579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"236c23b-82577c93-d89e5c50-b8867357") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.693621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.742299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:21.794827Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:21.794937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:21.794988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:21.795044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:21.795159Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:21.795210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:21.795268Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:21.795306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:21.795457Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:21.795502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:21.795544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:21.795692Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:21.795750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:21.795802Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:21.795848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.795896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:21.795942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.795981Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:21.796018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:21.796111Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.796 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:21.796156Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.796 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:21.796199Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.796 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:21.796255Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.796 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:21.796300Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.796 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:21.797378Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc1s71pty4b2h55rxb3yd, SessionId: CompileActor 2025-10-07 12:17:21.797 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490683:2609], duration: 0.220664s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490709:2618], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:21.804738Z
2025-10-07T09:17:21.813632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.813 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.814515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.814 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:21.814955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.814 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:21.830362Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.834733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.834 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.835341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.834 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:21.835391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.835 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:21.835428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.835 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:21.839582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.839983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:21.840327Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:21.840370Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.840 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.844383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.844 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:21.853079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:21.853478Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:21.853522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.854331Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:21.854779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:21.854832Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.876472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:21.876549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:21.876653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:21.876703Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:21.876747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:21.876787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:21.876898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:21.876943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:21.876985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:21.877041Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:21.877087Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:21.877135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:21.877175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:21.877813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc20b3q542ynx9y9kmqbn, SessionId: CompileActor 2025-10-07 12:17:21.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490709:2618], duration: 0.073027s
2025-10-07T09:17:21.883646Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpModifyACL, opId: 281474976710675:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_modify_acl.cpp:101)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490751:2631], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:21.888153Z
2025-10-07T09:17:21.895733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.895 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.896593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.896 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.897037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.896 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.899402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.899 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:21.911979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.916932Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:21.920539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.921184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:21.921241Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.921 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:21.921283Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.921 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:21.925094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.925 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.925473Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.925 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.925782Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.925 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.925823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.925 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.930752Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406460281490762:2637], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:21.945681Z
2025-10-07T09:17:21.952528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.952 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:21.953337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.952 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.953694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.953 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:21.955816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.955 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:21.965041Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:21.969159Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:21.972116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.972 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:21.972602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.972 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:21.972649Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.972 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:21.972690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.972 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:21.973262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.973 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:21.976741Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:21.976989Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.977170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.977 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.977210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.977 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.979399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:21.979448Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:21.981718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.981 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:21.984774Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.984 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:21.985334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.985 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:21.988868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:21.993209Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:21.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:21.995351Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.995728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.995770Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.996591Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.996 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:21.996950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.996 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:21.996991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.996 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:21.999927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:21.999 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:22.003748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.002 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"8f33b9d7-4c842bf2-acb75fc7-3b3793f3") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.004569Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.003 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"8f33b9d7-4c842bf2-acb75fc7-3b3793f3") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.004613Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.004 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.006260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"8f33b9d7-4c842bf2-acb75fc7-3b3793f3") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.007032Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.006 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"8f33b9d7-4c842bf2-acb75fc7-3b3793f3") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.007074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.047150Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:22.047345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:22.047432Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:22.047520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:22.047670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:22.047751Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:22.047827Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:22.047893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:22.048117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.048190Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.048269Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:22.048512Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:22.048595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:22.048691Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:22.048768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.048867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:22.048947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.049015Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:22.049080Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:22.050539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc24r6mzv67rz0k4p4048, SessionId: CompileActor 2025-10-07 12:17:22.050 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490762:2637], duration: 0.104780s
2025-10-07T09:17:22.057672Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.057 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:22.111499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:22.111605Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:22.111655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:22.111707Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:22.111818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:22.111867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:22.111910Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:22.111950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:22.112091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.112134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.112177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:22.112333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:22.112381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:22.112437Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:22.112484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.112532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:22.112577Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.112617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:22.112654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:22.112743Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:22.112788Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:22.112830Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:22.112873Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:22.112916Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.112 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:22.113966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc22zev1thmvx1cd3t5js, SessionId: CompileActor 2025-10-07 12:17:22.113 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406460281490751:2631], duration: 0.225763s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406464576458106:2651], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:22.120942Z
2025-10-07T09:17:22.129408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:22.130276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:22.130711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.130 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:22.147249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.147 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:22.151714Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:22.152517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:22.152571Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:22.152618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:22.156856Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.156 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:22.157388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.156 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:22.157791Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:22.157834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.161965Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:22.171225Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.170 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:22.171632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.171 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:22.171678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.171 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.172506Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:22.172880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:22.172921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.194415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:22.194493Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:22.194608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:22.194659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:22.194706Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:22.194746Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:22.194867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.194913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.194958Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:22.195012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:22.195059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.195099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:22.195136Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:22.195794Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2a7ea885s4gxztf7mbs, SessionId: CompileActor 2025-10-07 12:17:22.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406464576458106:2651], duration: 0.074803s
2025-10-07T09:17:22.201796Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpModifyACL, opId: 281474976710680:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_modify_acl.cpp:101)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406464576458148:2664], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:22.206363Z
2025-10-07T09:17:22.214283Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.214 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:22.215144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.214 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:22.215609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.215 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:22.217959Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.217 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:22.229666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.229 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:22.234720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:22.238425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.238 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:22.239081Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.238 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:22.239130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:22.239170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:22.243002Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.242 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:22.243393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.243704Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.243746Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.248755Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.248 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:22.287911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.287 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:22.294063Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:22.299915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.299 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:22.307553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.307 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:22.317833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.316 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"4ef787a9-a9314126-1ee710ee-8377a27a") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.318647Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.317 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"4ef787a9-a9314126-1ee710ee-8377a27a") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.318695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.320341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.319 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"4ef787a9-a9314126-1ee710ee-8377a27a") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.321117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.320 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"4ef787a9-a9314126-1ee710ee-8377a27a") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.321159Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.369498Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.369 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:22.423089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:22.423193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:22.423252Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:22.423306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:22.423420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:22.423468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:22.423509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:22.423549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:22.423691Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.423736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.423778Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:22.423925Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:22.423976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:22.424033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:22.424080Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.424127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:22.424173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.424211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:22.424257Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:22.424349Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:22.424394Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:22.424438Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:22.424481Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:22.424526Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.424 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:22.425558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2cx79pf9v9b745t41f5, SessionId: CompileActor 2025-10-07 12:17:22.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406464576458148:2664], duration: 0.219147s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406464576458174:2673], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:22.431539Z
2025-10-07T09:17:22.439895Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.439 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:22.440727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.440 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:22.441159Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.440 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:22.455913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.455 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:22.460280Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:22.460897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:22.460947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:22.460987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:22.464798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:22.465188Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:22.465552Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.465 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:22.465594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.465 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.469660Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.469 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:22.478420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.477 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:22.478829Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.478 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:22.478875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.478 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.479703Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.479 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:22.480076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.479 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:22.480118Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.480 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.503251Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:22.503328Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:22.503439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:22.503488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:22.503535Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:22.503576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:22.503695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.503741Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.503784Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:22.503841Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:22.503887Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.503926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:22.503963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:22.504636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2ky3yh706vcz2wm0gq7, SessionId: CompileActor 2025-10-07 12:17:22.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406464576458174:2673], duration: 0.073049s
2025-10-07T09:17:22.514824Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpInitiateBuildIndexImplTable, opId: 281474976715758:2, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
2025-10-07T09:17:22.537810Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpFinalizeBuildIndexMainTable, opId: 281474976715759:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_finalize_build_index.cpp:383)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406464576458355:2693], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:22.565900Z
2025-10-07T09:17:22.573878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.573 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:22.574742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:22.575191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:22.577448Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.577 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:22.589143Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:22.594273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:22.597846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:22.598495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:22.598543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:22.598582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:22.602360Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.602 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:22.602729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.602 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.603037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.602 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.603077Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.603 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.610141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.610 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:22.650245Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.650 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:22.656426Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.656 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:22.662182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.662 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:22.669705Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:22.679745Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.678 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"41701030-3e48b787-b5163113-7202a36") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.680548Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"41701030-3e48b787-b5163113-7202a36") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.680591Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.682272Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"41701030-3e48b787-b5163113-7202a36") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.683049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.682 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"41701030-3e48b787-b5163113-7202a36") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.683091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.683 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.731254Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:22.783485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:22.783593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:22.783656Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:22.783726Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:22.783858Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:22.783915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:22.783968Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:22.784015Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:22.784178Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.784233Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.784282Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:22.784456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:22.784512Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:22.784576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:22.784631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.784686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:22.784740Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.784786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:22.784830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:22.784933Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:22.784989Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.784 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:22.785044Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.785 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:22.785096Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.785 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:22.785149Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.785 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:22.786246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2r595cxtaz7kjn000s3, SessionId: CompileActor 2025-10-07 12:17:22.786 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406464576458355:2693], duration: 0.220291s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406464576458381:2702], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:22.792752Z
2025-10-07T09:17:22.801281Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.801 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:22.802126Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.801 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:22.802563Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.802 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:22.818707Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.818 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:22.823013Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.822 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:22.823621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.823 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:22.823669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.823 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:22.823708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.823 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:22.827491Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:22.827890Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:22.828054Z node 1 :METADATA_PROVIDER ERROR: log.cpp:841: fline=table_exists.cpp:59;actor=TTableExistsActor;event=timeout;self_id=[1:7558406443101620092:2066];send_to=[0:7307199536658146131:7762515];
2025-10-07T09:17:22.828097Z node 1 :METADATA_PROVIDER ERROR: log.cpp:841: fline=accessor_snapshot_base.cpp:71;action=cannot detect path existence;path=//Root/.metadata/initialization/migrations;error=timeout;
2025-10-07T09:17:22.828242Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:22.828283Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.828 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.832418Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.832 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:22.841306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.840 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:22.841699Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.841 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:22.841741Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.841 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.842579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:22.842953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:22.842994Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.864405Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:22.864482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:22.864583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:22.864632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:22.864675Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:22.864715Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:22.864826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:22.864871Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:22.864913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:22.864970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:22.865016Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:22.865055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.865 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:22.865092Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.865 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:22.865727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc2z78rwgxf70cdgjcff2, SessionId: CompileActor 2025-10-07 12:17:22.865 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406464576458381:2702], duration: 0.072928s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406464576458411:2715], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/secrets/values`\nWHERE (ownerUserId, secretId) IN $ids\n", startTime: 2025-10-07T09:17:22.873915Z
2025-10-07T09:17:22.881730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:22.882618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.882 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"ownerUserId") (Member $5 '"secretId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:22.883067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.882 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"ownerUserId") (Member $5 '"secretId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:22.888392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.888 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:22.899918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.899 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:22.905295Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.905 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:22.908860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.908 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:22.909503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.909 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"ownerUserId") (Member $7 '"secretId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:22.909551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.909 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #350
2025-10-07T09:17:22.909591Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.909 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #350, status: Ok
2025-10-07T09:17:22.913467Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.913 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:22.913823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.913 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 384 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"ownerUserId") (Member $4 '"secretId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.914129Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.913 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 384 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"ownerUserId") (Member $4 '"secretId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.914170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.914 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.919049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.919 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:22.958179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.958 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:22.964219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:22.969970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:22.977528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.977 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:22.987557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.986 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1427 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1277) '('"_id" '"d0e6d8a1-3b26be6-bc1acf47-f2da066b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"ownerUserId" '"secretId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1327) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1340))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.988363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.987 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1427 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1277) '('"_id" '"d0e6d8a1-3b26be6-bc1acf47-f2da066b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"ownerUserId" '"secretId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1327) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1340))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.988408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:22.990053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.989 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1428 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1277) '('"_id" '"d0e6d8a1-3b26be6-bc1acf47-f2da066b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"ownerUserId" '"secretId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1327) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1340))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:22.990824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.990 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1428 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1277) '('"_id" '"d0e6d8a1-3b26be6-bc1acf47-f2da066b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"ownerUserId" '"secretId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1327) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1340))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:22.990865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:22.990 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.039267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.039 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1327
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871425759:2726], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:23.065697Z
2025-10-07T09:17:23.071545Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.072124Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.072428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.072 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.074273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.074 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:23.082657Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.082 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.086635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.086 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:23.089500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.089 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.089947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.089 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:23.089992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.089 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:23.090031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.090 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:23.091158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #338
2025-10-07T09:17:23.091255Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #347<Nth> finished execution
2025-10-07T09:17:23.091304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #347<Nth> created 0 trackable nodes: 
2025-10-07T09:17:23.091353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #350, status: Async
2025-10-07T09:17:23.091439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #338
2025-10-07T09:17:23.091488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #338
2025-10-07T09:17:23.091526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #350
2025-10-07T09:17:23.091565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #350, status: Ok
2025-10-07T09:17:23.091685Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #338<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.091727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #338<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.091768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #345<Left!> finished execution
2025-10-07T09:17:23.091906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<ResPull!> finished execution
2025-10-07T09:17:23.091953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #348<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:23.092008Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #349<Commit!> finished execution
2025-10-07T09:17:23.092054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #349<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.092101Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Commit!> finished execution
2025-10-07T09:17:23.092147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.092185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #350, status: Ok
2025-10-07T09:17:23.092222Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #350
2025-10-07T09:17:23.092315Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:23.092361Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:23.092404Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:23.092447Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:23.092491Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.092 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:23.093524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc31s0tjspn3yfveacgv2, SessionId: CompileActor 2025-10-07 12:17:23.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406464576458411:2715], duration: 0.219561s
2025-10-07T09:17:23.093891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.094102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.094289Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.094330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.096392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:23.098693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.098 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:23.101677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.101 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:23.105666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.105 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871425800:2739], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:23.106619Z
2025-10-07T09:17:23.111514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.111884Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.111926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.111999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.112580Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.112738Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.112872Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.113093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.112 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.113134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.113 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.115567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.115 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:23.115987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.115 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:23.123528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.127625Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:23.130508Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.130 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.130961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.130 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:23.131007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.130 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:23.131046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:23.134721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.134 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.134938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.134 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.135114Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.134 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.135154Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.135 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.137239Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.137 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:23.139522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.139 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:23.142532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:23.146554Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.146 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:23.152329Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:23.152421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:23.152470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:23.152520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:23.152578Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.152614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:23.152660Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:23.152703Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:23.152742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:23.152868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.152911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.152949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.152953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:23.152991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.153089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:23.153137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:23.153195Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:23.153254Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.153304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:23.153350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.153389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:23.153425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:23.153839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.154200Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.154249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.154276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc37r4sme69gqp1r718fw, SessionId: CompileActor 2025-10-07 12:17:23.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871425759:2726], duration: 0.088521s
2025-10-07T09:17:23.157049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:23.192011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.191 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:23.192107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:23.192153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:23.192209Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:23.192319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:23.192366Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:23.192408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:23.192447Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:23.192574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.192618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.192661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:23.192803Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:23.192850Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:23.192906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:23.192952Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.192999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:23.193045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.193083Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:23.193119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:23.193987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3913ndqbzxg8g2wsegc, SessionId: CompileActor 2025-10-07 12:17:23.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871425800:2739], duration: 0.087320s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871425860:2757], cluster: db, database: /Root, text: "--!syntax_v1\nSELECT secretId, ownerUserId, value\nFROM `//Root/.metadata/secrets/values`\nVIEW index_by_secret_id\nWHERE secretId IN (\"secret_name\")\n", startTime: 2025-10-07T09:17:23.199248Z
2025-10-07T09:17:23.211788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.211 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.212775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.212 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values")) '('view (String '"index_by_secret_id"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($12) (block '(
  (let $13 (SqlIn '((String '"secret_name")) (Member $12 '"secretId") '('('warnNoAnsi))))
  (return (Coalesce $13 (Bool 'false)))
)))))
(let $4 (TypeOf $3))
(let $5 (SqlProjectItem $4 '"secretId" (lambda '($14) (Member $14 '"secretId"))))
(let $6 (SqlProjectItem $4 '"ownerUserId" (lambda '($15) (Member $15 '"ownerUserId"))))
(let $7 (SqlProjectItem $4 '"value" (lambda '($16) (Member $16 '"value"))))
(let $8 '($5 $6 $7))
(let $9 '('"secretId" '"ownerUserId" '"value"))
(let $10 '('('type) '('autoref) '('columns $9)))
(let $11 (Write! (Left! $1) $2 (Key) (PersistableRepr (SqlProject $3 $8)) $10))
(return (Commit! $11 $2))
)
2025-10-07T09:17:23.213347Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.212 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values")) '('view (String '"index_by_secret_id"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($12) (block '(
  (let $13 (SqlIn '((String '"secret_name")) (Member $12 '"secretId") '('('warnNoAnsi))))
  (return (Coalesce $13 (Bool 'false)))
)))))
(let $4 (TypeOf $3))
(let $5 (SqlProjectItem $4 '"secretId" (lambda '($14) (Member $14 '"secretId"))))
(let $6 (SqlProjectItem $4 '"ownerUserId" (lambda '($15) (Member $15 '"ownerUserId"))))
(let $7 (SqlProjectItem $4 '"value" (lambda '($16) (Member $16 '"value"))))
(let $8 '($5 $6 $7))
(let $9 '('"secretId" '"ownerUserId" '"value"))
(let $10 '('('type) '('autoref) '('columns $9)))
(let $11 (Write! (Left! $1) $2 (Key) (PersistableRepr (SqlProject $3 $8)) $10))
(return (Commit! $11 $2))
)
2025-10-07T09:17:23.216388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.216 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:23.230392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.230 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.235562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:23.239264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.239901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('"secretId" '"ownerUserId" '"value"))
(let $4 '('('"mode" '"flush")))
(let $5 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2)) '('view (String '"index_by_secret_id"))) (Void) '())) (lambda '($9) (block '(
  (let $10 (SqlIn '((String '"secret_name")) (Member $9 '"secretId") '()))
  (return (OptionalIf (Coalesce $10 (Bool 'false)) $9))
)))) (Uint64 '"1001")) $3 '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $4 (Void)))
(let $6 (DataSink 'result))
(let $7 '('('type) '('autoref) '('columns $3)))
(let $8 (ResPull! (Left! $5) $6 (Key) (Nth (Right! $5) '0) $7 '"kikimr"))
(return (Commit! (Commit! $8 $6) $1 $4))
)
2025-10-07T09:17:23.239947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #393
2025-10-07T09:17:23.239986Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #393, status: Ok
2025-10-07T09:17:23.243586Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.243913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 428 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (TKqlReadTableIndexRanges $1 (Void) $2 '() '() '"index_by_secret_id"))
(let $4 '('"secretId" '"ownerUserId" '"value"))
(return '('('('((Take (FlatMap $3 (lambda '($5) (block '(
  (let $6 (SqlIn '((String '"secret_name")) (Member $5 '"secretId") '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $5))
)))) (Uint64 '"1001")) $4)) '())))
)
-------- block transformer end
2025-10-07T09:17:23.244199Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 428 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (TKqlReadTableIndexRanges $1 (Void) $2 '() '() '"index_by_secret_id"))
(let $4 '('"secretId" '"ownerUserId" '"value"))
(return '('('((Take (FlatMap $3 (lambda '($5) (block '(
  (let $6 (SqlIn '((String '"secret_name")) (Member $5 '"secretId") '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $5))
)))) (Uint64 '"1001")) $4)) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.244248Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.248271Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.248 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:23.251361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.251 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteTakeOverIndexRead
2025-10-07T09:17:23.253864Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:23.257145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.257 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:23.260901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:23.265170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildStreamLookupTableStages
2025-10-07T09:17:23.269755Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.269 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:23.278254Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.277 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 802 (
(let $1 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $2 (KqpTable $1 '"72057594046644480:13" '"" '2))
(let $3 (Uint64 '"1001"))
(let $4 '('('"ItemsLimit" $3) '('"Sequential" '"1") '('"PointPrefixLen" '"1")))
(let $5 (KqlKeyInc (Utf8 '"secret_name")))
(let $6 (KqpRowsSourceSettings $2 '('"ownerUserId" '"secretId") $4 '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($17) (Take (ToFlow $17) $3)) '('('"_logical_id" '679) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DqStage '($8) (lambda '($18) (Take $18 $3)) '('('"_logical_id" '692))))
(let $10 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $11 '('"ownerUserId" '"secretId" '"value"))
(let $12 (OptionalType (DataType 'Utf8)))
(let $13 (KqpCnStreamLookup (TDqOutput $9 '"0") $10 $11 (ListType (StructType '('"ownerUserId" $12) '('"secretId" $12))) '('('"Strategy" '"LookupRows"))))
(let $14 (DqStage '($13) (lambda '($19) $19) '('('"_logical_id" '750))))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 '('"secretId" '"ownerUserId" '"value"))
(return '('('('($15 $16)) '())))
)
-------- block transformer end
2025-10-07T09:17:23.278831Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 802 n: 0 (
(let $1 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $2 (KqpTable $1 '"72057594046644480:13" '"" '2))
(let $3 (Uint64 '"1001"))
(let $4 '('('"ItemsLimit" $3) '('"Sequential" '"1") '('"PointPrefixLen" '"1")))
(let $5 (KqlKeyInc (Utf8 '"secret_name")))
(let $6 (KqpRowsSourceSettings $2 '('"ownerUserId" '"secretId") $4 '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($17) (Take (ToFlow $17) $3)) '('('"_logical_id" '679) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DqStage '($8) (lambda '($18) (Take $18 $3)) '('('"_logical_id" '692))))
(let $10 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $11 '('"ownerUserId" '"secretId" '"value"))
(let $12 (OptionalType (DataType 'Utf8)))
(let $13 (KqpCnStreamLookup (TDqOutput $9 '"0") $10 $11 (ListType (StructType '('"ownerUserId" $12) '('"secretId" $12))) '('('"Strategy" '"LookupRows"))))
(let $14 (DqStage '($13) (lambda '($19) $19) '('('"_logical_id" '750))))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 '('"secretId" '"ownerUserId" '"value"))
(return '('('($15 $16)) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.278873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.280101Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 803 (
(let $1 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $2 (KqpTable $1 '"72057594046644480:13" '"" '2))
(let $3 (Uint64 '"1001"))
(let $4 '('('"ItemsLimit" $3) '('"Sequential" '"1") '('"PointPrefixLen" '"1")))
(let $5 (KqlKeyInc (Utf8 '"secret_name")))
(let $6 (KqpRowsSourceSettings $2 '('"ownerUserId" '"secretId") $4 '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($17) (Take (ToFlow $17) $3)) '('('"_logical_id" '679) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DqStage '($8) (lambda '($18) (Take $18 $3)) '('('"_logical_id" '692))))
(let $10 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $11 '('"ownerUserId" '"secretId" '"value"))
(let $12 (OptionalType (DataType 'Utf8)))
(let $13 (KqpCnStreamLookup (TDqOutput $9 '"0") $10 $11 (ListType (StructType '('"ownerUserId" $12) '('"secretId" $12))) '('('"Strategy" '"LookupRows"))))
(let $14 (DqStage '($13) (lambda '($19) $19) '('('"_logical_id" '750))))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 '('"secretId" '"ownerUserId" '"value"))
(return '('('('($15 $16)) '())))
)
-------- block transformer end
2025-10-07T09:17:23.280668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.280 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 803 n: 0 (
(let $1 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $2 (KqpTable $1 '"72057594046644480:13" '"" '2))
(let $3 (Uint64 '"1001"))
(let $4 '('('"ItemsLimit" $3) '('"Sequential" '"1") '('"PointPrefixLen" '"1")))
(let $5 (KqlKeyInc (Utf8 '"secret_name")))
(let $6 (KqpRowsSourceSettings $2 '('"ownerUserId" '"secretId") $4 '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($17) (Take (ToFlow $17) $3)) '('('"_logical_id" '679) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DqStage '($8) (lambda '($18) (Take $18 $3)) '('('"_logical_id" '692))))
(let $10 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $11 '('"ownerUserId" '"secretId" '"value"))
(let $12 (OptionalType (DataType 'Utf8)))
(let $13 (KqpCnStreamLookup (TDqOutput $9 '"0") $10 $11 (ListType (StructType '('"ownerUserId" $12) '('"secretId" $12))) '('('"Strategy" '"LookupRows"))))
(let $14 (DqStage '($13) (lambda '($19) $19) '('('"_logical_id" '750))))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 '('"secretId" '"ownerUserId" '"value"))
(return '('('($15 $16)) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.280708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.280 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.284742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 679
2025-10-07T09:17:23.330760Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #381
2025-10-07T09:17:23.330851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #390<Nth> finished execution
2025-10-07T09:17:23.330892Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #390<Nth> created 0 trackable nodes: 
2025-10-07T09:17:23.330939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #393, status: Async
2025-10-07T09:17:23.331030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #381
2025-10-07T09:17:23.331073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #381
2025-10-07T09:17:23.331115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #393
2025-10-07T09:17:23.331151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #393, status: Ok
2025-10-07T09:17:23.331276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #381<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.331316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #381<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.331355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #388<Left!> finished execution
2025-10-07T09:17:23.331485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #391<ResPull!> finished execution
2025-10-07T09:17:23.331529Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #391<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:23.331580Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #392<Commit!> finished execution
2025-10-07T09:17:23.331622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #392<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.331667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #393<Commit!> finished execution
2025-10-07T09:17:23.331709Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #393<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.331745Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #393, status: Ok
2025-10-07T09:17:23.331779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #393
2025-10-07T09:17:23.331859Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:23.331900Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:2:1: Warning: At function: RemovePrefixMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:23.331939Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:6: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:23.331978Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:5:7: Warning: At function: SqlIn
2025-10-07T09:17:23.332018Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.331 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:5:7: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:23.332963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3by2r60tzpee7psh2df, SessionId: CompileActor 2025-10-07 12:17:23.332 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871425860:2757], duration: 0.133673s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871425898:2770], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<ownerUserId:Utf8, secretId:Utf8, value:Utf8>>;\nINSERT INTO `//Root/.metadata/secrets/values`\nSELECT ownerUserId,secretId,value FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:23.338684Z
2025-10-07T09:17:23.346415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.347160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"ownerUserId" (lambda '($7) (Member $7 '"ownerUserId"))))
(let $4 (SqlProjectItem $2 '"secretId" (lambda '($8) (Member $8 '"secretId"))))
(let $5 (SqlProjectItem $2 '"value" (lambda '($9) (Member $9 '"value"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'insert_abort))))
)
2025-10-07T09:17:23.347558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.347 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"ownerUserId" (lambda '($7) (Member $7 '"ownerUserId"))))
(let $4 (SqlProjectItem $2 '"secretId" (lambda '($8) (Member $8 '"secretId"))))
(let $5 (SqlProjectItem $2 '"value" (lambda '($9) (Member $9 '"value"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'insert_abort))))
)
2025-10-07T09:17:23.364509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.364 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.368720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.368 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.369302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.368 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 (DataType 'Utf8))
(let $4 '('"ownerUserId" '"secretId" '"value"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"ownerUserId" (Just (Member $7 '"ownerUserId"))) '('"secretId" (Just (Member $7 '"secretId"))) '('"value" (Just (Member $7 '"value"))))))) 'insert_abort $5 '())) '('('"db" $2 '"InsertAbort")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:23.369349Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.369 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #358
2025-10-07T09:17:23.369389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.369 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #358, status: Ok
2025-10-07T09:17:23.373056Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.373 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.373429Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.373 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 383 (
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 (DataType 'Utf8))
(let $3 '('"ownerUserId" '"secretId" '"value"))
(return '('('() '((TKqlInsertRowsIndex $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"ownerUserId" (Just (Member $4 '"ownerUserId"))) '('"secretId" (Just (Member $4 '"secretId"))) '('"value" (Just (Member $4 '"value"))))))) '()) $3 '"abort" '() '('('"Mode" '"insert")))))))
)
-------- block transformer end
2025-10-07T09:17:23.373756Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.373 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 383 n: 0 (
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 (DataType 'Utf8))
(let $3 '('"ownerUserId" '"secretId" '"value"))
(return '('() '((TKqlInsertRowsIndex $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"ownerUserId" (Just (Member $4 '"ownerUserId"))) '('"secretId" (Just (Member $4 '"secretId"))) '('"value" (Just (Member $4 '"value"))))))) '()) $3 '"abort" '() '('('"Mode" '"insert"))))))
)
-------- block transformer block end
2025-10-07T09:17:23.373797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.373 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.377657Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:23.380461Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildInsertIndexStages
2025-10-07T09:17:23.418031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.417 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpLookupTable
2025-10-07T09:17:23.441204Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.441 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-PrecomputeToInput
2025-10-07T09:17:23.453826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.452 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1078 (
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (DataType 'Utf8))
(let $2 (OptionalType $1))
(let $3 '('"ownerUserId" $2))
(let $4 '('"secretId" $2))
(let $5 (ListType (StructType $3 $4 '('"value" $2))))
(let $6 (ListType (StructType $3 $4)))
(let $7 (DqStage '() (lambda '() (block '(
  (let $33 $objects)
  (let $34 (OrderedFlatMap $33 (lambda '($40) (Just (AsStruct '('"ownerUserId" (Just (Member $40 '"ownerUserId"))) '('"secretId" (Just (Member $40 '"secretId"))) '('"value" (Just (Member $40 '"value"))))))))
  (let $35 (VariantType (TupleType $5 $6 (DataType 'Bool))))
  (let $36 (Variant $34 '"0" $35))
  (let $37 (ToDict $34 (lambda '($41) (AsStruct '('"ownerUserId" (Member $41 '"ownerUserId")) '('"secretId" (Member $41 '"secretId")))) (lambda '($42) (Void)) '('"One" '"Hashed")))
  (let $38 (Variant (DictKeys $37) '"1" $35))
  (let $39 (Variant (== (Length $33) (Length $37)) '2 $35))
  (return (Iterator (AsList $36 $38 $39)))
))) '()))
(let $8 (DqCnValue (TDqOutput $7 '"0")))
(let $9 (DqCnValue (TDqOutput $7 '2)))
(let $10 (DqCnValue (TDqOutput $7 '"1")))
(let $11 (DqStage '((DqPhyPrecompute $10)) (lambda '($43) (Iterator $43)) '()))
(let $12 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $13 (KqpCnStreamLookup (TDqOutput $11 '"0") $12 '() $6 '('('"Strategy" '"LookupRows"))))
(let $14 (Bool 'false))
(let $15 (DqStage '($13) (lambda '($44) (FlatMap (Take $44 (Uint64 '"1")) (lambda '($45) (Just $14)))) '()))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (Bool 'true))
(let $18 (DqStage '($16) (lambda '($46) (block '(
  (let $47 (lambda '($48 $49) $14))
  (return (FromFlow (Condense $46 $17 $47 $47)))
))) '()))
(let $19 (DqCnValue (TDqOutput $18 '"0")))
(let $20 '((DqPhyPrecompute $8) (DqPhyPrecompute $9) (DqPhyPrecompute $19)))
(let $21 (DqStage $20 (lambda '($50 $51 $52) (block '(
  (let $53 (KqpEnsure $17 $51 '"2012" (Utf8 '"Duplicated keys found.")))
  (let $54 (KqpEnsure $17 $52 '"2012" (Utf8 '"Conflict with existing key.")))
  (return (Iterator (If (And $53 $54) $50 (List $5))))
))) '()))
(let $22 (DqCnUnionAll (TDqOutput $21 '"0")))
(let $23 '((DqPhyPrecompute $22)))
(let $24 (DataSink '"KqpTableSink" '"db"))
(let $25 (KqpTableSinkSettings $12 'false '"" '"0" 'false 'false 'false '()))
(let $26 (DqStage $23 (lambda '($55) (ToFlow $55)) '() '((DqSink '"0" $24 $25))))
(let $27 (DqStage $23 (lambda '($56) (Iterator (ExtractMembers $56 '('"ownerUserId" '"secretId")))) '()))
(let $28 (DqCnUnionAll (TDqOutput $27 '"0")))
(let $29 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $30 (KqpTable $29 '"72057594046644480:13" '"" '2))
(let $31 (KqpTableSinkSettings $30 'false '"" '"1" 'false 'false 'true '()))
(let $32 (DqStage '($28) (lambda '($57) $57) '() '((DqSink '"0" $24 $31))))
(return '('('() '((KqpSinkEffect $26 '"0") (KqpSinkEffect $32 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:23.455179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.453 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1078 n: 0 (
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (DataType 'Utf8))
(let $2 (OptionalType $1))
(let $3 '('"ownerUserId" $2))
(let $4 '('"secretId" $2))
(let $5 (ListType (StructType $3 $4 '('"value" $2))))
(let $6 (ListType (StructType $3 $4)))
(let $7 (DqStage '() (lambda '() (block '(
  (let $33 $objects)
  (let $34 (OrderedFlatMap $33 (lambda '($40) (Just (AsStruct '('"ownerUserId" (Just (Member $40 '"ownerUserId"))) '('"secretId" (Just (Member $40 '"secretId"))) '('"value" (Just (Member $40 '"value"))))))))
  (let $35 (VariantType (TupleType $5 $6 (DataType 'Bool))))
  (let $36 (Variant $34 '"0" $35))
  (let $37 (ToDict $34 (lambda '($41) (AsStruct '('"ownerUserId" (Member $41 '"ownerUserId")) '('"secretId" (Member $41 '"secretId")))) (lambda '($42) (Void)) '('"One" '"Hashed")))
  (let $38 (Variant (DictKeys $37) '"1" $35))
  (let $39 (Variant (== (Length $33) (Length $37)) '2 $35))
  (return (Iterator (AsList $36 $38 $39)))
))) '()))
(let $8 (DqCnValue (TDqOutput $7 '"0")))
(let $9 (DqCnValue (TDqOutput $7 '2)))
(let $10 (DqCnValue (TDqOutput $7 '"1")))
(let $11 (DqStage '((DqPhyPrecompute $10)) (lambda '($43) (Iterator $43)) '()))
(let $12 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $13 (KqpCnStreamLookup (TDqOutput $11 '"0") $12 '() $6 '('('"Strategy" '"LookupRows"))))
(let $14 (Bool 'false))
(let $15 (DqStage '($13) (lambda '($44) (FlatMap (Take $44 (Uint64 '"1")) (lambda '($45) (Just $14)))) '()))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (Bool 'true))
(let $18 (DqStage '($16) (lambda '($46) (block '(
  (let $47 (lambda '($48 $49) $14))
  (return (FromFlow (Condense $46 $17 $47 $47)))
))) '()))
(let $19 (DqCnValue (TDqOutput $18 '"0")))
(let $20 '((DqPhyPrecompute $8) (DqPhyPrecompute $9) (DqPhyPrecompute $19)))
(let $21 (DqStage $20 (lambda '($50 $51 $52) (block '(
  (let $53 (KqpEnsure $17 $51 '"2012" (Utf8 '"Duplicated keys found.")))
  (let $54 (KqpEnsure $17 $52 '"2012" (Utf8 '"Conflict with existing key.")))
  (return (Iterator (If (And $53 $54) $50 (List $5))))
))) '()))
(let $22 (DqCnUnionAll (TDqOutput $21 '"0")))
(let $23 '((DqPhyPrecompute $22)))
(let $24 (DataSink '"KqpTableSink" '"db"))
(let $25 (KqpTableSinkSettings $12 'false '"" '"0" 'false 'false 'false '()))
(let $26 (DqStage $23 (lambda '($55) (ToFlow $55)) '() '((DqSink '"0" $24 $25))))
(let $27 (DqStage $23 (lambda '($56) (Iterator (ExtractMembers $56 '('"ownerUserId" '"secretId")))) '()))
(let $28 (DqCnUnionAll (TDqOutput $27 '"0")))
(let $29 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $30 (KqpTable $29 '"72057594046644480:13" '"" '2))
(let $31 (KqpTableSinkSettings $30 'false '"" '"1" 'false 'false 'true '()))
(let $32 (DqStage '($28) (lambda '($57) $57) '() '((DqSink '"0" $24 $31))))
(return '('() '((KqpSinkEffect $26 '"0") (KqpSinkEffect $32 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:23.455222Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.455 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.457954Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1079 (
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (DataType 'Utf8))
(let $2 (OptionalType $1))
(let $3 '('"ownerUserId" $2))
(let $4 '('"secretId" $2))
(let $5 (ListType (StructType $3 $4 '('"value" $2))))
(let $6 (ListType (StructType $3 $4)))
(let $7 (DqStage '() (lambda '() (block '(
  (let $33 $objects)
  (let $34 (OrderedFlatMap $33 (lambda '($40) (Just (AsStruct '('"ownerUserId" (Just (Member $40 '"ownerUserId"))) '('"secretId" (Just (Member $40 '"secretId"))) '('"value" (Just (Member $40 '"value"))))))))
  (let $35 (VariantType (TupleType $5 $6 (DataType 'Bool))))
  (let $36 (Variant $34 '"0" $35))
  (let $37 (ToDict $34 (lambda '($41) (AsStruct '('"ownerUserId" (Member $41 '"ownerUserId")) '('"secretId" (Member $41 '"secretId")))) (lambda '($42) (Void)) '('"One" '"Hashed")))
  (let $38 (Variant (DictKeys $37) '"1" $35))
  (let $39 (Variant (== (Length $33) (Length $37)) '2 $35))
  (return (Iterator (AsList $36 $38 $39)))
))) '()))
(let $8 (DqCnValue (TDqOutput $7 '"0")))
(let $9 (DqCnValue (TDqOutput $7 '2)))
(let $10 (DqCnValue (TDqOutput $7 '"1")))
(let $11 (DqStage '((DqPhyPrecompute $10)) (lambda '($43) (Iterator $43)) '()))
(let $12 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $13 (KqpCnStreamLookup (TDqOutput $11 '"0") $12 '() $6 '('('"Strategy" '"LookupRows"))))
(let $14 (Bool 'false))
(let $15 (DqStage '($13) (lambda '($44) (FlatMap (Take $44 (Uint64 '"1")) (lambda '($45) (Just $14)))) '()))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (Bool 'true))
(let $18 (DqStage '($16) (lambda '($46) (block '(
  (let $47 (lambda '($48 $49) $14))
  (return (FromFlow (Condense $46 $17 $47 $47)))
))) '()))
(let $19 (DqCnValue (TDqOutput $18 '"0")))
(let $20 '((DqPhyPrecompute $8) (DqPhyPrecompute $9) (DqPhyPrecompute $19)))
(let $21 (DqStage $20 (lambda '($50 $51 $52) (block '(
  (let $53 (KqpEnsure $17 $51 '"2012" (Utf8 '"Duplicated keys found.")))
  (let $54 (KqpEnsure $17 $52 '"2012" (Utf8 '"Conflict with existing key.")))
  (return (Iterator (If (And $53 $54) $50 (List $5))))
))) '()))
(let $22 (DqCnUnionAll (TDqOutput $21 '"0")))
(let $23 '((DqPhyPrecompute $22)))
(let $24 (DataSink '"KqpTableSink" '"db"))
(let $25 (KqpTableSinkSettings $12 'false '"" '"0" 'false 'false 'false '()))
(let $26 (DqStage $23 (lambda '($55) (ToFlow $55)) '() '((DqSink '"0" $24 $25))))
(let $27 (DqStage $23 (lambda '($56) (Iterator (ExtractMembers $56 '('"ownerUserId" '"secretId")))) '()))
(let $28 (DqCnUnionAll (TDqOutput $27 '"0")))
(let $29 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $30 (KqpTable $29 '"72057594046644480:13" '"" '2))
(let $31 (KqpTableSinkSettings $30 'false '"" '"1" 'false 'false 'true '()))
(let $32 (DqStage '($28) (lambda '($57) $57) '() '((DqSink '"0" $24 $31))))
(return '('('() '((KqpSinkEffect $26 '"0") (KqpSinkEffect $32 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:23.459292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.457 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1079 n: 0 (
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (DataType 'Utf8))
(let $2 (OptionalType $1))
(let $3 '('"ownerUserId" $2))
(let $4 '('"secretId" $2))
(let $5 (ListType (StructType $3 $4 '('"value" $2))))
(let $6 (ListType (StructType $3 $4)))
(let $7 (DqStage '() (lambda '() (block '(
  (let $33 $objects)
  (let $34 (OrderedFlatMap $33 (lambda '($40) (Just (AsStruct '('"ownerUserId" (Just (Member $40 '"ownerUserId"))) '('"secretId" (Just (Member $40 '"secretId"))) '('"value" (Just (Member $40 '"value"))))))))
  (let $35 (VariantType (TupleType $5 $6 (DataType 'Bool))))
  (let $36 (Variant $34 '"0" $35))
  (let $37 (ToDict $34 (lambda '($41) (AsStruct '('"ownerUserId" (Member $41 '"ownerUserId")) '('"secretId" (Member $41 '"secretId")))) (lambda '($42) (Void)) '('"One" '"Hashed")))
  (let $38 (Variant (DictKeys $37) '"1" $35))
  (let $39 (Variant (== (Length $33) (Length $37)) '2 $35))
  (return (Iterator (AsList $36 $38 $39)))
))) '()))
(let $8 (DqCnValue (TDqOutput $7 '"0")))
(let $9 (DqCnValue (TDqOutput $7 '2)))
(let $10 (DqCnValue (TDqOutput $7 '"1")))
(let $11 (DqStage '((DqPhyPrecompute $10)) (lambda '($43) (Iterator $43)) '()))
(let $12 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $13 (KqpCnStreamLookup (TDqOutput $11 '"0") $12 '() $6 '('('"Strategy" '"LookupRows"))))
(let $14 (Bool 'false))
(let $15 (DqStage '($13) (lambda '($44) (FlatMap (Take $44 (Uint64 '"1")) (lambda '($45) (Just $14)))) '()))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (Bool 'true))
(let $18 (DqStage '($16) (lambda '($46) (block '(
  (let $47 (lambda '($48 $49) $14))
  (return (FromFlow (Condense $46 $17 $47 $47)))
))) '()))
(let $19 (DqCnValue (TDqOutput $18 '"0")))
(let $20 '((DqPhyPrecompute $8) (DqPhyPrecompute $9) (DqPhyPrecompute $19)))
(let $21 (DqStage $20 (lambda '($50 $51 $52) (block '(
  (let $53 (KqpEnsure $17 $51 '"2012" (Utf8 '"Duplicated keys found.")))
  (let $54 (KqpEnsure $17 $52 '"2012" (Utf8 '"Conflict with existing key.")))
  (return (Iterator (If (And $53 $54) $50 (List $5))))
))) '()))
(let $22 (DqCnUnionAll (TDqOutput $21 '"0")))
(let $23 '((DqPhyPrecompute $22)))
(let $24 (DataSink '"KqpTableSink" '"db"))
(let $25 (KqpTableSinkSettings $12 'false '"" '"0" 'false 'false 'false '()))
(let $26 (DqStage $23 (lambda '($55) (ToFlow $55)) '() '((DqSink '"0" $24 $25))))
(let $27 (DqStage $23 (lambda '($56) (Iterator (ExtractMembers $56 '('"ownerUserId" '"secretId")))) '()))
(let $28 (DqCnUnionAll (TDqOutput $27 '"0")))
(let $29 '"//Root/.metadata/secrets/values/index_by_secret_id/indexImplTable")
(let $30 (KqpTable $29 '"72057594046644480:13" '"" '2))
(let $31 (KqpTableSinkSettings $30 'false '"" '"1" 'false 'false 'true '()))
(let $32 (DqStage '($28) (lambda '($57) $57) '() '((DqSink '"0" $24 $31))))
(return '('() '((KqpSinkEffect $26 '"0") (KqpSinkEffect $32 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:23.459334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.509703Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1656
2025-10-07T09:17:23.580835Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.580 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #356
2025-10-07T09:17:23.580902Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.580 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #358, status: Async
2025-10-07T09:17:23.580989Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.580 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #356
2025-10-07T09:17:23.581028Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #356
2025-10-07T09:17:23.581064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #358
2025-10-07T09:17:23.581099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #358, status: Ok
2025-10-07T09:17:23.581218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #356<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.581261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #356<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.581296Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #357<Left!> finished execution
2025-10-07T09:17:23.581343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #358<Commit!> finished execution
2025-10-07T09:17:23.581380Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #358<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.581412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #358, status: Ok
2025-10-07T09:17:23.581443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #358
2025-10-07T09:17:23.582665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3g98hq67s6ymh3gsdmn, SessionId: CompileActor 2025-10-07 12:17:23.582 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871425898:2770], duration: 0.243939s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871425937:2784], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<ownerUserId:Utf8, secretId:Utf8, value:Utf8, historyUserId:Utf8, historyInstant:Uint64, historyAction:Utf8>>;\nINSERT INTO `//Root/.metadata/secrets/values_history`\nSELECT ownerUserId,secretId,value,historyUserId,historyInstant,historyAction FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:23.590666Z
2025-10-07T09:17:23.600175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.600 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.601265Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.600 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)) '('"historyUserId" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyAction" (DataType 'Utf8)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"ownerUserId" (lambda '($10) (Member $10 '"ownerUserId"))))
(let $4 (SqlProjectItem $2 '"secretId" (lambda '($11) (Member $11 '"secretId"))))
(let $5 (SqlProjectItem $2 '"value" (lambda '($12) (Member $12 '"value"))))
(let $6 (SqlProjectItem $2 '"historyUserId" (lambda '($13) (Member $13 '"historyUserId"))))
(let $7 (SqlProjectItem $2 '"historyInstant" (lambda '($14) (Member $14 '"historyInstant"))))
(let $8 (SqlProjectItem $2 '"historyAction" (lambda '($15) (Member $15 '"historyAction"))))
(let $9 '($3 $4 $5 $6 $7 $8))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values_history"))) (PersistableRepr (OrderedSqlProject $1 $9)) '('('mode 'insert_abort))))
)
2025-10-07T09:17:23.601805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.601 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)) '('"historyUserId" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyAction" (DataType 'Utf8)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"ownerUserId" (lambda '($10) (Member $10 '"ownerUserId"))))
(let $4 (SqlProjectItem $2 '"secretId" (lambda '($11) (Member $11 '"secretId"))))
(let $5 (SqlProjectItem $2 '"value" (lambda '($12) (Member $12 '"value"))))
(let $6 (SqlProjectItem $2 '"historyUserId" (lambda '($13) (Member $13 '"historyUserId"))))
(let $7 (SqlProjectItem $2 '"historyInstant" (lambda '($14) (Member $14 '"historyInstant"))))
(let $8 (SqlProjectItem $2 '"historyAction" (lambda '($15) (Member $15 '"historyAction"))))
(let $9 '($3 $4 $5 $6 $7 $8))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values_history"))) (PersistableRepr (OrderedSqlProject $1 $9)) '('('mode 'insert_abort))))
)
2025-10-07T09:17:23.619182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.624099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.624 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.624783Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.624 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values_history")
(let $3 (DataType 'Utf8))
(let $4 '('"historyAction" '"historyInstant" '"historyUserId" '"ownerUserId" '"secretId" '"value"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"historyAction" (Just (Member $7 '"historyAction"))) '('"historyInstant" (Just (Member $7 '"historyInstant"))) '('"historyUserId" (Just (Member $7 '"historyUserId"))) '('"ownerUserId" (Just (Member $7 '"ownerUserId"))) '('"secretId" (Just (Member $7 '"secretId"))) '('"value" (Just (Member $7 '"value"))))))) 'insert_abort $5 '())) '('('"db" $2 '"InsertAbort")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:23.624828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.624 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #530
2025-10-07T09:17:23.624865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.624 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #530, status: Ok
2025-10-07T09:17:23.628603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.629030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 555 (
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values_history" '"72057594046644480:11" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"historyAction" '"historyInstant" '"historyUserId" '"ownerUserId" '"secretId" '"value"))
(return '('('() '((TKqlInsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"historyAction" (Just (Member $4 '"historyAction"))) '('"historyInstant" (Just (Member $4 '"historyInstant"))) '('"historyUserId" (Just (Member $4 '"historyUserId"))) '('"ownerUserId" (Just (Member $4 '"ownerUserId"))) '('"secretId" (Just (Member $4 '"secretId"))) '('"value" (Just (Member $4 '"value"))))))) '()) $3 '"abort" '() '('('"Mode" '"insert")))))))
)
-------- block transformer end
2025-10-07T09:17:23.629409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.629 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 555 n: 0 (
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values_history" '"72057594046644480:11" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"historyAction" '"historyInstant" '"historyUserId" '"ownerUserId" '"secretId" '"value"))
(return '('() '((TKqlInsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"historyAction" (Just (Member $4 '"historyAction"))) '('"historyInstant" (Just (Member $4 '"historyInstant"))) '('"historyUserId" (Just (Member $4 '"historyUserId"))) '('"ownerUserId" (Just (Member $4 '"ownerUserId"))) '('"secretId" (Just (Member $4 '"secretId"))) '('"value" (Just (Member $4 '"value"))))))) '()) $3 '"abort" '() '('('"Mode" '"insert"))))))
)
-------- block transformer block end
2025-10-07T09:17:23.629444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.629 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.634430Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:23.636695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildInsertStages
2025-10-07T09:17:23.646859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 600 (
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values_history" '"72057594046644480:11" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"insert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"historyAction" (Just (Member $5 '"historyAction"))) '('"historyInstant" (Just (Member $5 '"historyInstant"))) '('"historyUserId" (Just (Member $5 '"historyUserId"))) '('"ownerUserId" (Just (Member $5 '"ownerUserId"))) '('"secretId" (Just (Member $5 '"secretId"))) '('"value" (Just (Member $5 '"value"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:23.647319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 600 n: 0 (
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values_history" '"72057594046644480:11" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"insert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"historyAction" (Just (Member $5 '"historyAction"))) '('"historyInstant" (Just (Member $5 '"historyInstant"))) '('"historyUserId" (Just (Member $5 '"historyUserId"))) '('"ownerUserId" (Just (Member $5 '"ownerUserId"))) '('"secretId" (Just (Member $5 '"secretId"))) '('"value" (Just (Member $5 '"value"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:23.647359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.648299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 601 (
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values_history" '"72057594046644480:11" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"insert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"historyAction" (Just (Member $5 '"historyAction"))) '('"historyInstant" (Just (Member $5 '"historyInstant"))) '('"historyUserId" (Just (Member $5 '"historyUserId"))) '('"ownerUserId" (Just (Member $5 '"ownerUserId"))) '('"secretId" (Just (Member $5 '"secretId"))) '('"value" (Just (Member $5 '"value"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:23.648732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.648 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 601 n: 0 (
(declare $objects (ListType (StructType '('"historyAction" (DataType 'Utf8)) '('"historyInstant" (DataType 'Uint64)) '('"historyUserId" (DataType 'Utf8)) '('"ownerUserId" (DataType 'Utf8)) '('"secretId" (DataType 'Utf8)) '('"value" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/secrets/values_history" '"72057594046644480:11" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"insert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"historyAction" (Just (Member $5 '"historyAction"))) '('"historyInstant" (Just (Member $5 '"historyInstant"))) '('"historyUserId" (Just (Member $5 '"historyUserId"))) '('"ownerUserId" (Just (Member $5 '"ownerUserId"))) '('"secretId" (Just (Member $5 '"secretId"))) '('"value" (Just (Member $5 '"value"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:23.648772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.648 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.673472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #528
2025-10-07T09:17:23.673551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #530, status: Async
2025-10-07T09:17:23.673652Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #528
2025-10-07T09:17:23.673697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #528
2025-10-07T09:17:23.673737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #530
2025-10-07T09:17:23.673773Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #530, status: Ok
2025-10-07T09:17:23.673886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #528<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.673928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #528<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.673967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #529<Left!> finished execution
2025-10-07T09:17:23.674019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #530<Commit!> finished execution
2025-10-07T09:17:23.674061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #530<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.674096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #530, status: Ok
2025-10-07T09:17:23.674129Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #530
2025-10-07T09:17:23.674785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3r54g6bkj9jpfkyq48k, SessionId: CompileActor 2025-10-07 12:17:23.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871425937:2784], duration: 0.084073s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871425987:2797], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:23.688754Z
2025-10-07T09:17:23.694063Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.694622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.694897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.697259Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.697 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:23.704704Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.704 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.708377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.708 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:23.711020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.711462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:23.711504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:23.711541Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:23.715091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.715314Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.715487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.715525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.717595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.717 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:23.719784Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.719 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:23.722592Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:23.726425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:23.731852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.732197Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.732241Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.732 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.732988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.732 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.733326Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.733364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.735964Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.735 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:23.768539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:23.768642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:23.768688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:23.768738Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:23.768873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:23.768923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:23.768962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:23.768996Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:23.769147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.769185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.769222Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:23.769357Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:23.769396Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:23.769443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:23.769482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.769522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:23.769560Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.769593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:23.769623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:23.770414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3v86x8bvas313r0qpm3, SessionId: CompileActor 2025-10-07 12:17:23.770 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871425987:2797], duration: 0.081620s
2025-10-07T09:17:23.775887Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateExternalDataSource, opId: 281474976710696:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_external_data_source.cpp:268)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406468871426048:2812], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:23.832315Z
2025-10-07T09:17:23.837869Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:23.838444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.838 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.838739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.838 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:23.840511Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.840 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:23.848516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:23.852454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:23.855317Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:23.855761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:23.855807Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:23.855846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:23.859559Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.859 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:23.859770Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.859 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.859948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.859 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.859988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.859 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.862045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:23.864304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:23.867276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.867 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:23.871210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.871 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:23.876937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.877315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.876 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.877356Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.878151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:23.878516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.878 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:23.878556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.878 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:23.881345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:23.916099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:23.916175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:23.916216Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:23.916262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:23.916339Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:23.916380Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:23.916413Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:23.916445Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:23.916548Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:23.916584Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:23.916619Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:23.916735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:23.916775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:23.916821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:23.916859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.916898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:23.916937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:23.916970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:23.917000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:23.917693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc3zqbvsddewqemdp7f1t, SessionId: CompileActor 2025-10-07 12:17:23.917 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406468871426048:2812], duration: 0.085339s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393377:2822], cluster: db, database: /Root, text: "\n            CREATE STREAMING QUERY `streamingQuery` AS\n            DO BEGIN\n                PRAGMA ydb.HashJoinMode = \"map\";\n                $ydb_lookup = SELECT * FROM `ydbSourceName`.`lookup`;\n\n                $pq_source = SELECT * FROM `pqSourceName`.`inputTopicName` WITH (\n                    FORMAT = \"json_each_row\",\n                    SCHEMA (\n                        time Int32 NOT NULL,\n                        event String,\n                        host String\n                    )\n                );\n\n                $joined = SELECT l.payload AS payload, p.* FROM $pq_source AS p\n                LEFT JOIN $ydb_lookup AS l\n                ON (l.fqdn = p.host);\n\n                INSERT INTO `pqSourceName`.`outputTopicName`\n                SELECT Unwrap(event || \"-\" || payload) FROM $joined\n            END DO;", startTime: 2025-10-07T09:17:24.123042Z
2025-10-07T09:17:24.161840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.163708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.162 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Configure! (World) (DataSource '"ydb" '"$all") '"Attr" '"hashjoinmode" '"map"))
(let $2 (Read! $1 (DataSource '"kikimr" '"/Root/ydbSourceName") (Key '('table (String '"lookup"))) (Void) '()))
(let $3 (Right! $2))
(let $4 '((Left! $2) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($20) $20) '())))))))
(let $5 (StructType '('"time" (DataType 'Int32)) '('"event" (AsOptionalType (DataType 'String))) '('"host" (AsOptionalType (DataType 'String)))))
(let $6 '('"time" '"event" '"host"))
(let $7 '('"userschema" $5 $6))
(let $8 (Read! (Nth $4 '0) (DataSource '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"inputTopicName"))) (Void) '('('"format" '"json_each_row") $7)))
(let $9 (Right! $8))
(let $10 '((Left! $8) (RemoveSystemMembers (PersistableRepr (SqlProject $9 '((SqlProjectStarItem (TypeOf $9) '"" (lambda '($21) $21) '())))))))
(let $11 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $12 (EquiJoin '((RemoveSystemMembers (Nth $10 '1)) '"p") '((RemoveSystemMembers (Nth $4 '1)) '"l") $11 '()))
(let $13 (TypeOf $12))
(let $14 (SqlProjectItem $13 '"payload" (lambda '($22) (SqlColumn $22 '"payload" '"l"))))
(let $15 (SqlProjectStarItem $13 '"p" (lambda '($23) (DivePrefixMembers $23 '('"p."))) '('('divePrefix '('"p.")))))
(let $16 '((Nth $10 '0) (PersistableRepr (OrderedSqlProject $12 '($14 $15)))))
(let $17 (Nth $16 '1))
(let $18 (Write! (Nth $16 '0) (DataSink '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"outputTopicName"))) (PersistableRepr (OrderedSqlProject $17 '((SqlProjectItem (TypeOf $17) '"" (lambda '($24) (Unwrap (Concat (Concat (Member $24 '"event") (String '"-")) (Member $24 '"payload")))) '('('autoName)))))) '('('mode 'insert_abort))))
(let $19 '"\n                PRAGMA ydb.HashJoinMode = \"map\";\n                $ydb_lookup = SELECT * FROM `ydbSourceName`.`lookup`;\n\n                $pq_source = SELECT * FROM `pqSourceName`.`inputTopicName` WITH (\n                    FORMAT = \"json_each_row\",\n                    SCHEMA (\n                        time Int32 NOT NULL,\n                        event String,\n                        host String\n                    )\n                );\n\n                $joined = SELECT l.payload AS payload, p.* FROM $pq_source AS p\n                LEFT JOIN $ydb_lookup AS l\n                ON (l.fqdn = p.host);\n\n                INSERT INTO `pqSourceName`.`outputTopicName`\n                SELECT Unwrap(event || \"-\" || payload) FROM $joined\n            ")
(return (Write! world (DataSink '"kikimr" '"db") (Key '('objectId (String '"/Root/streamingQuery")) '('typeId (String '"STREAMING_QUERY"))) (Void) '('('mode 'createObject) '('features '('('"__query_ast" $18) '('"__query_text" $19))))))
)
2025-10-07T09:17:24.164821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.163 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Configure! (World) (DataSource '"ydb" '"$all") '"Attr" '"hashjoinmode" '"map"))
(let $2 (Read! $1 (DataSource '"kikimr" '"/Root/ydbSourceName") (Key '('table (String '"lookup"))) (Void) '()))
(let $3 (Right! $2))
(let $4 '((Left! $2) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($20) $20) '())))))))
(let $5 (StructType '('"time" (DataType 'Int32)) '('"event" (AsOptionalType (DataType 'String))) '('"host" (AsOptionalType (DataType 'String)))))
(let $6 '('"time" '"event" '"host"))
(let $7 '('"userschema" $5 $6))
(let $8 (Read! (Nth $4 '0) (DataSource '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"inputTopicName"))) (Void) '('('"format" '"json_each_row") $7)))
(let $9 (Right! $8))
(let $10 '((Left! $8) (RemoveSystemMembers (PersistableRepr (SqlProject $9 '((SqlProjectStarItem (TypeOf $9) '"" (lambda '($21) $21) '())))))))
(let $11 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $12 (EquiJoin '((RemoveSystemMembers (Nth $10 '1)) '"p") '((RemoveSystemMembers (Nth $4 '1)) '"l") $11 '()))
(let $13 (TypeOf $12))
(let $14 (SqlProjectItem $13 '"payload" (lambda '($22) (SqlColumn $22 '"payload" '"l"))))
(let $15 (SqlProjectStarItem $13 '"p" (lambda '($23) (DivePrefixMembers $23 '('"p."))) '('('divePrefix '('"p.")))))
(let $16 '((Nth $10 '0) (PersistableRepr (OrderedSqlProject $12 '($14 $15)))))
(let $17 (Nth $16 '1))
(let $18 (Write! (Nth $16 '0) (DataSink '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"outputTopicName"))) (PersistableRepr (OrderedSqlProject $17 '((SqlProjectItem (TypeOf $17) '"" (lambda '($24) (Unwrap (Concat (Concat (Member $24 '"event") (String '"-")) (Member $24 '"payload")))) '('('autoName)))))) '('('mode 'insert_abort))))
(let $19 '"\n                PRAGMA ydb.HashJoinMode = \"map\";\n                $ydb_lookup = SELECT * FROM `ydbSourceName`.`lookup`;\n\n                $pq_source = SELECT * FROM `pqSourceName`.`inputTopicName` WITH (\n                    FORMAT = \"json_each_row\",\n                    SCHEMA (\n                        time Int32 NOT NULL,\n                        event String,\n                        host String\n                    )\n                );\n\n                $joined = SELECT l.payload AS payload, p.* FROM $pq_source AS p\n                LEFT JOIN $ydb_lookup AS l\n                ON (l.fqdn = p.host);\n\n                INSERT INTO `pqSourceName`.`outputTopicName`\n                SELECT Unwrap(event || \"-\" || payload) FROM $joined\n            ")
(return (Write! world (DataSink '"kikimr" '"db") (Key '('objectId (String '"/Root/streamingQuery")) '('typeId (String '"STREAMING_QUERY"))) (Void) '('('mode 'createObject) '('features '('('"__query_ast" $18) '('"__query_text" $19))))))
)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393383:2826], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:24.164895Z
2025-10-07T09:17:24.169691Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.169 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.170174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.169 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.170425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.170 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.172775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.179299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.179 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.182532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.182 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.184857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.184 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.185221Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.184 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.185263Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.185 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:24.185295Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.185 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:24.188312Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.188487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.188633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.188665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.188898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [generic] yql_generic_settings.cpp:61: GenericConfiguration::AddCluster: name = /Root/ydbSourceName, kind = YDB, database name = local, database id = , endpoint = { host: "localhost" port: 2893 }, use tls = 0, protocol = NATIVE
2025-10-07T09:17:24.190354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.190 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:24.190753Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.190 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [generic] yql_generic_describe_table.cpp:321: Describe table for: ``/Root/ydbSourceName`.`lookup``
Call DescribeTable.
2025-10-07T09:17:24.192189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
data_source_instance {
  kind: YDB
  endpoint {
    host: "localhost"
    port: 2893
  }
  database: "local"
  credentials {
    token {
      type: "IAM"
      value: "root@builtin"
    }
  }
  use_tls: false
  protocol: NATIVE
}
table: "lookup"
type_mapping_settings {
  date_time_format: STRING_FORMAT
}
CRAB Expected: data_source_instance {
  kind: YDB
  endpoint {
    host: "localhost"
    port: 2893
  }
  database: "local"
  credentials {
    token {
      type: "IAM"
      value: "root@builtin"
    }
  }
  use_tls: false
  protocol: NATIVE
}
table: "lookup"
type_mapping_settings {
  date_time_format: STRING_FORMAT
}
CRAB Actual: data_source_instance {
  kind: YDB
  endpoint {
    host: "localhost"
    port: 2893
  }
  database: "local"
  credentials {
    token {
      type: "IAM"
      value: "root@builtin"
    }
  }
  use_tls: false
  protocol: NATIVE
}
table: "lookup"
type_mapping_settings {
  date_time_format: STRING_FORMAT
}
DescribeTable result.
GRpcStatusCode: 0
schema {
  columns {
    name: "fqdn"
    type {
      type_id: STRING
    }
  }
  columns {
    name: "payload"
    type {
      type_id: STRING
    }
  }
}
error {
  status: SUCCESS
}
2025-10-07T09:17:24.194559Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_load_meta.cpp:35: Load topic meta for: `/Root/pqSourceName`.`outputTopicName`
2025-10-07T09:17:24.194609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:24.194612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_load_meta.cpp:35: Load topic meta for: `/Root/pqSourceName`.`inputTopicName`
2025-10-07T09:17:24.194706Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.194 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_load_meta.cpp:35: Load topic meta for: `/Root/pqSourceName`.`inputTopicName`
2025-10-07T09:17:24.196146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_datasource.cpp:88: RewriteIO
2025-10-07T09:17:24.196207Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_datasource.cpp:88: RewriteIO
2025-10-07T09:17:24.196512Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_datasink.cpp:102: Rewrite Write!
2025-10-07T09:17:24.197816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.197 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.200748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.200 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.201023Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.200 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"\n                PRAGMA ydb.HashJoinMode = \"map\";\n                $ydb_lookup = SELECT * FROM `ydbSourceName`.`lookup`;\n\n                $pq_source = SELECT * FROM `pqSourceName`.`inputTopicName` WITH (\n                    FORMAT = \"json_each_row\",\n                    SCHEMA (\n                        time Int32 NOT NULL,\n                        event String,\n                        host String\n                    )\n                );\n\n                $joined = SELECT l.payload AS payload, p.* FROM $pq_source AS p\n                LEFT JOIN $ydb_lookup AS l\n                ON (l.fqdn = p.host);\n\n                INSERT INTO `pqSourceName`.`outputTopicName`\n                SELECT Unwrap(event || \"-\" || payload) FROM $joined\n            ")
(let $3 (KiCreateObject! world $1 '"/Root/streamingQuery" '"STREAMING_QUERY" '('('"__query_text" $2)) '0 '0 (Void)))
(return (Commit! $3 $1 '('('"mode" '"flush"))))
)
2025-10-07T09:17:24.201062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #467
2025-10-07T09:17:24.201095Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #467, status: Ok
2025-10-07T09:17:24.201319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #466
2025-10-07T09:17:24.201369Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #467, status: Async
2025-10-07T09:17:24.201462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #466
2025-10-07T09:17:24.201507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionComplete after apply async changes for node #466
2025-10-07T09:17:24.201543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #467
2025-10-07T09:17:24.201575Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #467, status: Ok
2025-10-07T09:17:24.201612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #467<Commit!> finished execution
2025-10-07T09:17:24.201655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #467<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.201686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #467, status: Ok
2025-10-07T09:17:24.201716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #467
2025-10-07T09:17:24.201962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc48q507bv0tmy2hq82p2, SessionId: CompileActor 2025-10-07 12:17:24.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393377:2822], duration: 0.078883s
2025-10-07T09:17:24.202513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.202 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.202815Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.202 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.202848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.202 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.203505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.203797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.203830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.206101Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.206 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:24.207169Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710700:1, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393435:2837], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:24.208284Z
2025-10-07T09:17:24.212798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.212 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.213266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.213 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.213511Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.213 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.221866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.221 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.228575Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.231801Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.231 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.234136Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.234505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.234543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:24.234575Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:24.234923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:24.234995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:24.235035Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.235074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:24.235181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:24.235219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:24.235261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:24.235292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:24.235389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.235425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.235459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:24.235571Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:24.235610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.235658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:24.235697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.235735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:24.235772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.235805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:24.235834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:24.236502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4a44mjjzgb7s38er95w, SessionId: CompileActor 2025-10-07 12:17:24.236 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393383:2826], duration: 0.071569s
2025-10-07T09:17:24.237724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.237 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.237905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.237 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.238050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.237 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.238082Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.238 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.239787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:24.241639Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.241 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:24.244083Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:24.247422Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.247 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393536:2859], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:24.250637Z
2025-10-07T09:17:24.252127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.251 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.252434Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.252471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.253123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.253419Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.253452Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.255714Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.255 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:24.256444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.256 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.257103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.256 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.257473Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.257 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.259208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.268468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.268 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.272403Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.272 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.275305Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.275799Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.275840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:24.275870Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:24.278677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.278958Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.279206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.279249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.283071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.283 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:24.284698Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:24.284774Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:24.284813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.284853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:24.284947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:24.284985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:24.285020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:24.285051Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:24.285152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.285188Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.285221Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:24.285345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:24.285384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.285428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:24.285465Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.285503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:24.285539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.285570Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:24.285599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:24.286313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4bf88s89f7dsx6dex63, SessionId: CompileActor 2025-10-07 12:17:24.286 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393435:2837], duration: 0.077989s
2025-10-07T09:17:24.314488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.314 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:24.319277Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.319 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:24.323827Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.323 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:24.329874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.337826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"704227b1-cae9199f-2203b34-4b2e908b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.338470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"704227b1-cae9199f-2203b34-4b2e908b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.338505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.338 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.339817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.339 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"704227b1-cae9199f-2203b34-4b2e908b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.340447Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.339 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"704227b1-cae9199f-2203b34-4b2e908b") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.340481Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.340 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.378749Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.378 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:24.421694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:24.421767Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:24.421804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.421844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:24.421914Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:24.421951Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:24.421986Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:24.422018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:24.422116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.422151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.422185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:24.422302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:24.422341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.422387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:24.422424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.422463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:24.422501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.422532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:24.422562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:24.422630Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:24.422667Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:24.422702Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:24.422733Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:24.422768Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.422 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:24.423585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4cs17253xgsxs9whp37, SessionId: CompileActor 2025-10-07 12:17:24.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393536:2859], duration: 0.172910s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393581:2872], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:24.430166Z
2025-10-07T09:17:24.436501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.437146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:24.437498Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.437 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:24.449073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.449 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.452508Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.452 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.452969Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.452 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:24.453007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.452 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:24.453038Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.453 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:24.455749Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.455 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.456046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.455 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:24.456321Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:24.456354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.459531Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:24.466443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.466 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.466756Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.466 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.466790Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.466 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.467447Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.467 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.467747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.467 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.467781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.467 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.484514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:24.484567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:24.484632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:24.484669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:24.484704Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:24.484735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:24.484816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.484851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.484885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:24.484930Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:24.484967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.484999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:24.485030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:24.485520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4jd7e10htqjn7kjfrqf, SessionId: CompileActor 2025-10-07 12:17:24.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393581:2872], duration: 0.055319s
2025-10-07T09:17:24.492100Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpModifyACL, opId: 281474976710707:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_modify_acl.cpp:101)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393623:2885], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $ids AS List<Tuple<Utf8, Utf8>>;\nSELECT * FROM `//Root/.metadata/initialization/migrations`\nWHERE (componentId, modificationId) IN $ids\n", startTime: 2025-10-07T09:17:24.496342Z
2025-10-07T09:17:24.502079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.502 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.502736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.502 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.503097Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.502 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (block '(
  (let $6 (SqlIn $ids '((Member $5 '"componentId") (Member $5 '"modificationId")) '('('warnNoAnsi))))
  (return (Coalesce $6 (Bool 'false)))
)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($7) $7) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.504961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.515691Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.515 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.520187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.520 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.523478Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.524070Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (SqlIn $ids '((Member $7 '"componentId") (Member $7 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $9 (Bool 'false)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.524114Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.524 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:24.524151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.524 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:24.527639Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.527970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 387 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.528259Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 387 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (SqlIn $ids '((Member $4 '"componentId") (Member $4 '"modificationId")) '()))
  (return (OptionalIf (Coalesce $6 (Bool 'false)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.528297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.528 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.532833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:24.570144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.570 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:24.575725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.575 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:24.581019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.580 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:24.587985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.597145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.596 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1430 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"c8e2103-ca2ae14a-fdc92c29-6416ed00") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.597880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1430 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"c8e2103-ca2ae14a-fdc92c29-6416ed00") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.597919Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.599435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1431 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"c8e2103-ca2ae14a-fdc92c29-6416ed00") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('('($14 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.600148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.599 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1431 n: 0 (
(declare $ids (ListType (TupleType (DataType 'Utf8) (DataType 'Utf8))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 '('"_partition_mode" '"single"))
(let $5 '('('"_logical_id" '1280) '('"_id" '"c8e2103-ca2ae14a-fdc92c29-6416ed00") $4))
(let $6 (DqStage '() (lambda '() (block '(
  (let $15 (Uint64 '10000))
  (let $16 (DataType 'Utf8))
  (let $17 (OptionalType $16))
  (let $18 (Collect (Take (FlatMap $ids (lambda '($21) (block '(
    (let $22 (RangeFor '== (Nth $21 '0) $17))
    (let $23 (RangeFor '=== (Nth $21 '1) $17))
    (return (RangeMultiply $15 $22 $23))
  )))) (Uint64 '10001))))
  (let $19 (Nothing (OptionalType $17)))
  (let $20 '($19 $19 (Int32 '0)))
  (return (ToStream (Just '((RangeFinalize (RangeMultiply $15 (RangeUnion (If (> (Length $18) $15) (AsRange '($20 $20)) (RangeUnion $18)))))))))
))) $5))
(let $7 (DqCnValue (TDqOutput $6 '0)))
(let $8 (DqPhyPrecompute $7))
(let $9 '('('"UsedKeyColumns" '('"componentId" '"modificationId")) '('"ExpectedMaxRanges" '"9999") '('"PointPrefixLen" '"2")))
(let $10 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) $8 $9))
(let $11 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $10) $8) (lambda '($24 $25) (Take (ToFlow $24) $3)) '('('"_logical_id" '1330) $4)))
(let $12 (DqCnUnionAll (TDqOutput $11 '0)))
(let $13 (DqStage '($12) (lambda '($26) (Take $26 $3)) '('('"_logical_id" '1343))))
(let $14 (DqCnUnionAll (TDqOutput $13 '0)))
(return '('('($14 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.600187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.600 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.644256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1330
2025-10-07T09:17:24.691316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #341
2025-10-07T09:17:24.691418Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #350<Nth> finished execution
2025-10-07T09:17:24.691464Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #350<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.691511Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Async
2025-10-07T09:17:24.691607Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #341
2025-10-07T09:17:24.691651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #341
2025-10-07T09:17:24.691690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #353
2025-10-07T09:17:24.691726Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #353, status: Ok
2025-10-07T09:17:24.691848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #341<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.691885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #341<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.691921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #348<Left!> finished execution
2025-10-07T09:17:24.692053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #351<ResPull!> finished execution
2025-10-07T09:17:24.692094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #351<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.692142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #352<Commit!> finished execution
2025-10-07T09:17:24.692182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #352<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.692223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #353<Commit!> finished execution
2025-10-07T09:17:24.692267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #353<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.692300Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #353, status: Ok
2025-10-07T09:17:24.692332Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #353
2025-10-07T09:17:24.692412Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Type annotation, code: 1030
2025-10-07T09:17:24.692451Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:3:1: Warning: At function: RemovePrefixMembers, At function: RemoveSystemMembers, At function: PersistableRepr, At function: SqlProject
2025-10-07T09:17:24.692488Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:3:15: Warning: At function: Filter, At lambda, At function: Coalesce
2025-10-07T09:17:24.692524Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: At function: SqlIn
2025-10-07T09:17:24.692560Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.692 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:4:21: Warning: IN may produce unexpected result when used with nullable arguments. Consider adding 'PRAGMA AnsiInForEmptyOrNullableItemsCollections;', code: 1108
2025-10-07T09:17:24.693442Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4mf92mr3zq5x28mwzgx, SessionId: CompileActor 2025-10-07 12:17:24.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393623:2885], duration: 0.197058s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393649:2894], cluster: db, database: /Root, text: "--!syntax_v1\nDECLARE $objects AS List<Struct<componentId:Utf8, modificationId:Utf8, instant:Uint32>>;\nUPSERT INTO `//Root/.metadata/initialization/migrations`\nSELECT componentId,modificationId,instant FROM AS_TABLE($objects)\n", startTime: 2025-10-07T09:17:24.699008Z
2025-10-07T09:17:24.705576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.705 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.706260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.705 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:24.706620Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.706 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"modificationId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)))))
(let $1 (ToList $objects))
(let $2 (TypeOf $1))
(let $3 (SqlProjectItem $2 '"componentId" (lambda '($7) (Member $7 '"componentId"))))
(let $4 (SqlProjectItem $2 '"modificationId" (lambda '($8) (Member $8 '"modificationId"))))
(let $5 (SqlProjectItem $2 '"instant" (lambda '($9) (Member $9 '"instant"))))
(let $6 '($3 $4 $5))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (PersistableRepr (OrderedSqlProject $1 $6)) '('('mode 'upsert))))
)
2025-10-07T09:17:24.718628Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.718 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.722157Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.722638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 (DataType 'Utf8))
(let $4 '('"componentId" '"instant" '"modificationId"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (OrderedFlatMap $objects (lambda '($7) (Just (AsStruct '('"componentId" (Just (Member $7 '"componentId"))) '('"instant" (Just (Member $7 '"instant"))) '('"modificationId" (Just (Member $7 '"modificationId"))))))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:24.722677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:24.722710Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:24.725734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.725 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.726046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.725 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 389 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:24.726329Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 389 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"componentId" '"instant" '"modificationId"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (OrderedFlatMap $objects (lambda '($4) (Just (AsStruct '('"componentId" (Just (Member $4 '"componentId"))) '('"instant" (Just (Member $4 '"instant"))) '('"modificationId" (Just (Member $4 '"modificationId"))))))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:24.726363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.729649Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:24.736775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.736 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 430 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.737098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.736 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 430 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.737133Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.737810Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 431 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.738120Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 431 n: 0 (
(declare $objects (ListType (StructType '('"componentId" (DataType 'Utf8)) '('"instant" (DataType 'Uint32)) '('"modificationId" (DataType 'Utf8)))))
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (OrderedFlatMap (ToFlow $objects) (lambda '($5) (Just (AsStruct '('"componentId" (Just (Member $5 '"componentId"))) '('"instant" (Just (Member $5 '"instant"))) '('"modificationId" (Just (Member $5 '"modificationId"))))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.738154Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.738 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.755399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #360
2025-10-07T09:17:24.755454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Async
2025-10-07T09:17:24.755526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #360
2025-10-07T09:17:24.755565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #360
2025-10-07T09:17:24.755602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #362
2025-10-07T09:17:24.755634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #362, status: Ok
2025-10-07T09:17:24.755720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #360<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.755758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #360<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.755793Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #361<Left!> finished execution
2025-10-07T09:17:24.755840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #362<Commit!> finished execution
2025-10-07T09:17:24.755878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #362<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.755911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #362, status: Ok
2025-10-07T09:17:24.755942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #362
2025-10-07T09:17:24.756450Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4tte0mc3t6v9y2c7da1, SessionId: CompileActor 2025-10-07 12:17:24.756 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393649:2894], duration: 0.057405s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393687:2903], cluster: db, database: /Root, text: "-- TLockStreamingQueryRequestActor::ReadQueryInfo\n\n                DECLARE $database_id AS Text;\n                DECLARE $query_path AS Text;\n\n                SELECT\n                    *\n                FROM `//Root/.metadata/streaming/queries`\n                WHERE database_id = $database_id\n                  AND query_path = $query_path;\n            ", startTime: 2025-10-07T09:17:24.764509Z
2025-10-07T09:17:24.774663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.775301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (Coalesce (And (== (Member $5 '"database_id") $database_id) (== (Member $5 '"query_path") $query_path)) (Bool 'false)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($6) $6) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.775653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (Coalesce (And (== (Member $5 '"database_id") $database_id) (== (Member $5 '"query_path") $query_path)) (Bool 'false)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($6) $6) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.777367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.777 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393700:2910], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:24.778587Z
2025-10-07T09:17:24.783719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.784273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.784551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.786999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.786 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.787948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.787 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.791969Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.794390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.795017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.795539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/streaming/queries")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $7 '"database_id") $database_id) $9) (Coalesce (== (Member $7 '"query_path") $query_path) $9)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.795579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #390
2025-10-07T09:17:24.795611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #390, status: Ok
2025-10-07T09:17:24.798036Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.797 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.798420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.798704Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 424 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $4 '"database_id") $database_id) $6) (Coalesce (== (Member $4 '"query_path") $query_path) $6)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.798960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 424 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $4 '"database_id") $database_id) $6) (Coalesce (== (Member $4 '"query_path") $query_path) $6)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.798993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.800690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.800 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.801104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.800 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.801148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.801 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:24.801184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.801 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:24.803293Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.803 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:24.804411Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.804608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.804772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.804809Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.805689Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-DropTakeOverLookupTable
2025-10-07T09:17:24.806668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.806 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:24.806746Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.806 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:24.808017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.807 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:24.808842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.808 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:24.810238Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.810 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.811604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.811 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:24.813708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.813 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 760 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"8d259e5d-2d6fde8a-12b2c7c0-a60e7355") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.813987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.813 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 760 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"8d259e5d-2d6fde8a-12b2c7c0-a60e7355") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.814021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.813 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.814594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.814 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 761 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"8d259e5d-2d6fde8a-12b2c7c0-a60e7355") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.814855Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.814 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 761 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"8d259e5d-2d6fde8a-12b2c7c0-a60e7355") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.814888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.814 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.815057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.819883Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.820195Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.820234Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.820909Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.821209Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.821246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.823572Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.823 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:24.826767Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #378
2025-10-07T09:17:24.826837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #387<Nth> finished execution
2025-10-07T09:17:24.826877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #387<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.826915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #390, status: Async
2025-10-07T09:17:24.826977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #378
2025-10-07T09:17:24.827014Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #378
2025-10-07T09:17:24.827059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #390
2025-10-07T09:17:24.827091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #390, status: Ok
2025-10-07T09:17:24.827182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #378<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.827217Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #378<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.827257Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #385<Left!> finished execution
2025-10-07T09:17:24.827368Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #388<ResPull!> finished execution
2025-10-07T09:17:24.827407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #388<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.827451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #389<Commit!> finished execution
2025-10-07T09:17:24.827489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #389<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.827527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #390<Commit!> finished execution
2025-10-07T09:17:24.827565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #390<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.827596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #390, status: Ok
2025-10-07T09:17:24.827626Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #390
2025-10-07T09:17:24.828206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4wv8a0a8jy0w4qem1y6, SessionId: CompileActor 2025-10-07 12:17:24.828 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393687:2903], duration: 0.063660s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393734:2919], cluster: db, database: /Root, text: "-- TLockStreamingQueryRequestActor::PersistQueryInfo\n\n                DECLARE $database_id AS Text;\n                DECLARE $query_path AS Text;\n                DECLARE $state AS Json;\n\n                UPSERT INTO `//Root/.metadata/streaming/queries` (\n                    database_id, query_path, state\n                ) VALUES (\n                    $database_id, $query_path, $state\n                );\n            ", startTime: 2025-10-07T09:17:24.833933Z
2025-10-07T09:17:24.842607Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.843012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (PersistableRepr '((AsStruct '('"database_id" $database_id) '('"query_path" $query_path) '('"state" $state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:24.843222Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.843 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (PersistableRepr '((AsStruct '('"database_id" $database_id) '('"query_path" $query_path) '('"state" $state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:24.847232Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.850185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.850 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.850586Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.850 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/streaming/queries")
(let $3 (DataType 'Utf8))
(let $4 '('"database_id" '"query_path" '"state"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:24.850623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.850 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #131
2025-10-07T09:17:24.850655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.850 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #131, status: Ok
2025-10-07T09:17:24.853180Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:24.853263Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:24.853308Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.853351Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:24.853402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.853425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:24.853464Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:24.853504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:24.853540Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:24.853649Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.853652Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 158 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database_id" '"query_path" '"state"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:24.853689Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.853727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:24.853853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:24.853870Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 158 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database_id" '"query_path" '"state"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:24.853896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.853899Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.853945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:24.853985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.854025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:24.854064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.854098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:24.854129Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:24.854886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4x9fzf22bh6jct82a0t, SessionId: CompileActor 2025-10-07 12:17:24.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393700:2910], duration: 0.076259s
2025-10-07T09:17:24.856173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.856 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:24.860987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.860 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 189 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.861256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.861 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 189 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.861289Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.861 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.861818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.861 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 190 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.862069Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.861 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 190 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.862102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.873926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.873 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #129
2025-10-07T09:17:24.873978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.873 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #131, status: Async
2025-10-07T09:17:24.874047Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #129
2025-10-07T09:17:24.874084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #129
2025-10-07T09:17:24.874118Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #131
2025-10-07T09:17:24.874150Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #131, status: Ok
2025-10-07T09:17:24.874230Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #129<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.874266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #129<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.874300Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #130<Left!> finished execution
2025-10-07T09:17:24.874344Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #131<Commit!> finished execution
2025-10-07T09:17:24.874381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #131<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.874412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #131, status: Ok
2025-10-07T09:17:24.874442Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #131
2025-10-07T09:17:24.874934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc4z18cpwe6cfb8k0921g, SessionId: CompileActor 2025-10-07 12:17:24.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393734:2919], duration: 0.040967s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393796:2930], cluster: db, database: /Root, text: "-- TUpdateStreamingQueryStateRequestActor::ReadQueryInfo\n\n                DECLARE $database_id AS Text;\n                DECLARE $query_path AS Text;\n\n                SELECT\n                    *\n                FROM `//Root/.metadata/streaming/queries`\n                WHERE database_id = $database_id\n                  AND query_path = $query_path;\n            ", startTime: 2025-10-07T09:17:24.884714Z
2025-10-07T09:17:24.891683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.891 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.892317Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (Coalesce (And (== (Member $5 '"database_id") $database_id) (== (Member $5 '"query_path") $query_path)) (Bool 'false)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($6) $6) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.892662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (Coalesce (And (== (Member $5 '"database_id") $database_id) (== (Member $5 '"query_path") $query_path)) (Bool 'false)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($6) $6) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.894385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.894 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.904924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.904 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.909071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.909 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.912082Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.912620Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/streaming/queries")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $7 '"database_id") $database_id) $9) (Coalesce (== (Member $7 '"query_path") $query_path) $9)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.912661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #390
2025-10-07T09:17:24.912693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #390, status: Ok
2025-10-07T09:17:24.915716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.915 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.916005Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.915 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 424 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $4 '"database_id") $database_id) $6) (Coalesce (== (Member $4 '"query_path") $query_path) $6)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.916263Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 424 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $4 '"database_id") $database_id) $6) (Coalesce (== (Member $4 '"query_path") $query_path) $6)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.916297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.920618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:24.923040Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.923 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-DropTakeOverLookupTable
2025-10-07T09:17:24.924057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.924 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393807:2936], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:24.924356Z
2025-10-07T09:17:24.925439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.925 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:24.927687Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.927 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.928542Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.928 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.929000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.928 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.929248Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:24.930598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:24.931273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 760 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"d4e97527-8a3caf9e-bd5b163f-422e2905") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.931555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 760 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"d4e97527-8a3caf9e-bd5b163f-422e2905") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.931590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.932164Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 761 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"d4e97527-8a3caf9e-bd5b163f-422e2905") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.932435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 761 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"d4e97527-8a3caf9e-bd5b163f-422e2905") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.932469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.936998Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.936 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.940170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.940 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:24.942489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.942844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:24.942881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:24.942912Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:24.944556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #378
2025-10-07T09:17:24.944630Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #387<Nth> finished execution
2025-10-07T09:17:24.944670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #387<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.944711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #390, status: Async
2025-10-07T09:17:24.944779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #378
2025-10-07T09:17:24.944817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #378
2025-10-07T09:17:24.944852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #390
2025-10-07T09:17:24.944884Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #390, status: Ok
2025-10-07T09:17:24.944980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #378<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.945017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #378<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.945052Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #385<Left!> finished execution
2025-10-07T09:17:24.945172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #388<ResPull!> finished execution
2025-10-07T09:17:24.945213Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #388<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.945265Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #389<Commit!> finished execution
2025-10-07T09:17:24.945304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #389<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.945344Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #390<Commit!> finished execution
2025-10-07T09:17:24.945382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #390<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.945415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #390, status: Ok
2025-10-07T09:17:24.945448Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #390
2025-10-07T09:17:24.945891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.946048Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc50m0b5wr62d1ak77rgs, SessionId: CompileActor 2025-10-07 12:17:24.946 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393796:2930], duration: 0.061295s
2025-10-07T09:17:24.946061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.946202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.946 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.946240Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.946 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.947872Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:24.949688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.949 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:24.952089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.952 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406473166393828:2941], cluster: db, database: /Root, text: "-- TUpdateStreamingQueryStateRequestActor::PersistQueryInfo\n\n                DECLARE $database_id AS Text;\n                DECLARE $query_path AS Text;\n                DECLARE $state AS Json;\n\n                UPSERT INTO `//Root/.metadata/streaming/queries` (\n                    database_id, query_path, state\n                ) VALUES (\n                    $database_id, $query_path, $state\n                );\n            ", startTime: 2025-10-07T09:17:24.952880Z
2025-10-07T09:17:24.955318Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.955 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:24.959981Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.960287Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.960320Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.960558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:24.960971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:24.960990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (PersistableRepr '((AsStruct '('"database_id" $database_id) '('"query_path" $query_path) '('"state" $state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:24.961207Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (PersistableRepr '((AsStruct '('"database_id" $database_id) '('"query_path" $query_path) '('"state" $state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:24.961267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:24.961301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.963567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:24.965266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.965 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:24.968314Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.968 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:24.968725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.968 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/streaming/queries")
(let $3 (DataType 'Utf8))
(let $4 '('"database_id" '"query_path" '"state"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:24.968763Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.968 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #131
2025-10-07T09:17:24.968795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.968 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #131, status: Ok
2025-10-07T09:17:24.971611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:24.971870Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 158 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database_id" '"query_path" '"state"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:24.972101Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 158 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database_id" '"query_path" '"state"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:24.972135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.972 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.974493Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.974 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:24.979462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 189 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.979732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 189 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.979766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.980316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 190 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:24.980576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 190 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:24.980610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:24.992315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:24.992382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:24.992422Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:24.992460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:24.992525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:24.992562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:24.992596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:24.992628Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:24.992721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.992756Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.992790Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:24.992840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #129
2025-10-07T09:17:24.992896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #131, status: Async
2025-10-07T09:17:24.992901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:24.992936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:24.992962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #129
2025-10-07T09:17:24.992977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:24.993001Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #129
2025-10-07T09:17:24.993011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.993037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #131
2025-10-07T09:17:24.993046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:24.993068Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #131, status: Ok
2025-10-07T09:17:24.993080Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.993107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:24.993140Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:24.993146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #129<KiExecDataQuery!> finished execution
2025-10-07T09:17:24.993178Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #129<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:24.993213Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #130<Left!> finished execution
2025-10-07T09:17:24.993264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #131<Commit!> finished execution
2025-10-07T09:17:24.993301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #131<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:24.993333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #131, status: Ok
2025-10-07T09:17:24.993363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #131
2025-10-07T09:17:24.993797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc51v6521q6hxh03dea6n, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393807:2936], duration: 0.069404s
2025-10-07T09:17:24.993874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc52r2k658r2rh1a4a1tz, SessionId: CompileActor 2025-10-07 12:17:24.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406473166393828:2941], duration: 0.040957s
2025-10-07T09:17:25.015895Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710723:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
2025-10-07T09:17:25.016840Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710724:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
2025-10-07T09:17:25.018533Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard__operation.cpp:183: Operation part proposed ok, but propose itself is undo unsafe, suboperation type: ESchemeOpCreateTable, opId: 281474976710725:0, at schemeshard:  72057594046644480, first GetDB called at:  (GetDB first called at /home/runner/actions_runner/_work/ydb/ydb/ydb/core/tx/schemeshard/schemeshard__operation_create_table.cpp:684)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361426:2977], cluster: db, database: /Root, text: "\n            -- TCreateScriptOperationQuery::OnRunQuery\n            DECLARE $database AS Text;\n            DECLARE $execution_id AS Text;\n            DECLARE $run_script_actor_id AS Text;\n            DECLARE $execution_status AS Int32;\n            DECLARE $execution_mode AS Int32;\n            DECLARE $query_text AS Text;\n            DECLARE $syntax AS Int32;\n            DECLARE $meta AS JsonDocument;\n            DECLARE $lease_duration AS Interval;\n            DECLARE $lease_state AS Int32;\n            DECLARE $execution_meta_ttl AS Interval;\n            DECLARE $retry_state AS JsonDocument;\n            DECLARE $user_sid AS Text;\n            DECLARE $user_group_sids AS JsonDocument;\n            DECLARE $parameters AS String;\n            DECLARE $graph_compressed AS Optional<String>;\n            DECLARE $graph_compression_method AS Optional<Text>;\n\n            UPSERT INTO `.metadata/script_executions` (\n                database, execution_id, run_script_actor_id, execution_status, execution_mode, start_ts,\n                query_text, syntax, meta, expire_at, retry_state,\n                user_token, user_group_sids, parameters,\n                graph_compressed, graph_compression_method, lease_generation\n            ) VALUES (\n                $database, $execution_id, $run_script_actor_id, $execution_status, $execution_mode, CurrentUtcTimestamp(),\n                $query_text, $syntax, $meta, CurrentUtcTimestamp() + $execution_meta_ttl, $retry_state,\n                $user_sid, $user_group_sids, $parameters,\n                $graph_compressed, $graph_compression_method, 1\n            );\n\n            UPSERT INTO `.metadata/script_execution_leases` (\n                database, execution_id, lease_deadline, lease_generation,\n                expire_at, lease_state\n            ) VALUES (\n                $database, $execution_id, CurrentUtcTimestamp() + $lease_duration, 1,\n                CurrentUtcTimestamp() + $execution_meta_ttl, $lease_state\n            );\n        ", startTime: 2025-10-07T09:17:25.125919Z
2025-10-07T09:17:25.151421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.152906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 $database)
(let $2 $execution_id)
(let $3 $execution_meta_ttl)
(let $4 (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (PersistableRepr '((AsStruct '('"database" $1) '('"execution_id" $2) '('"run_script_actor_id" $run_script_actor_id) '('"execution_status" $execution_status) '('"execution_mode" $execution_mode) '('"start_ts" (CurrentUtcTimestamp)) '('"query_text" $query_text) '('"syntax" $syntax) '('"meta" $meta) '('"expire_at" (+MayWarn (CurrentUtcTimestamp) $3)) '('"retry_state" $retry_state) '('"user_token" $user_sid) '('"user_group_sids" $user_group_sids) '('"parameters" $parameters) '('"graph_compressed" $graph_compressed) '('"graph_compression_method" $graph_compression_method) '('"lease_generation" (Int32 '"1"))))) '('('mode 'upsert))))
(return (Write! $4 (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (PersistableRepr '((AsStruct '('"database" $1) '('"execution_id" $2) '('"lease_deadline" (+MayWarn (CurrentUtcTimestamp) $lease_duration)) '('"lease_generation" (Int32 '"1")) '('"expire_at" (+MayWarn (CurrentUtcTimestamp) $3)) '('"lease_state" $lease_state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:25.153708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 $database)
(let $2 $execution_id)
(let $3 $execution_meta_ttl)
(let $4 (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (PersistableRepr '((AsStruct '('"database" $1) '('"execution_id" $2) '('"run_script_actor_id" $run_script_actor_id) '('"execution_status" $execution_status) '('"execution_mode" $execution_mode) '('"start_ts" (CurrentUtcTimestamp)) '('"query_text" $query_text) '('"syntax" $syntax) '('"meta" $meta) '('"expire_at" (+MayWarn (CurrentUtcTimestamp) $3)) '('"retry_state" $retry_state) '('"user_token" $user_sid) '('"user_group_sids" $user_group_sids) '('"parameters" $parameters) '('"graph_compressed" $graph_compressed) '('"graph_compression_method" $graph_compression_method) '('"lease_generation" (Int32 '"1"))))) '('('mode 'upsert))))
(return (Write! $4 (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (PersistableRepr '((AsStruct '('"database" $1) '('"execution_id" $2) '('"lease_deadline" (+MayWarn (CurrentUtcTimestamp) $lease_duration)) '('"lease_generation" (Int32 '"1")) '('"expire_at" (+MayWarn (CurrentUtcTimestamp) $3)) '('"lease_state" $lease_state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:25.166653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.166 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.173409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.174485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"/Root/.metadata/script_executions")
(let $3 (DataType 'Utf8))
(let $4 '('"database" (Just $database)))
(let $5 '('"execution_id" (Just $execution_id)))
(let $6 (DataType 'Int32))
(let $7 (DataType 'Interval))
(let $8 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $9 (DataType 'String))
(let $10 '"graph_compression_method")
(let $11 '('"lease_generation" (Just (Int64 '1))))
(let $12 (DataType 'JsonDocument))
(let $13 '"run_script_actor_id")
(let $14 '('"database" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"graph_compressed" $10 '"lease_generation" '"meta" '"parameters" '"query_text" '"retry_state" $13 '"start_ts" '"syntax" '"user_group_sids" '"user_token"))
(let $15 '('"default_constraint_columns" '()))
(let $16 '('"generate_columns_if_insert" '()))
(let $17 '('('"input_columns" $14) $15 $16))
(let $18 (KiWriteTable! world $1 $2 (AsList (AsStruct $4 $5 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $8 '('"graph_compressed" $graph_compressed) '($10 $graph_compression_method) $11 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '($13 (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid)))) 'upsert $17 '()))
(let $19 '"/Root/.metadata/script_execution_leases")
(let $20 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $21 '('('"input_columns" $20) $15 $16))
(let $22 (KiWriteTable! world $1 $19 (AsList (AsStruct $4 $5 $8 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $11 '('"lease_state" (Just $lease_state)))) 'upsert $21 '()))
(let $23 '('"db" $2 '"Upsert"))
(let $24 '('"db" $19 '"Upsert"))
(let $25 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects $18 $22) '($23 $24) '())) $25 (Void))) $1 $25))
)
2025-10-07T09:17:25.174524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #447
2025-10-07T09:17:25.174556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #447, status: Ok
2025-10-07T09:17:25.177715Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.178516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 495 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database" (Just $database)))
(let $4 '('"execution_id" (Just $execution_id)))
(let $5 (DataType 'Int32))
(let $6 (DataType 'Interval))
(let $7 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $8 (DataType 'String))
(let $9 '"graph_compression_method")
(let $10 '('"lease_generation" (Just (Int64 '1))))
(let $11 (DataType 'JsonDocument))
(let $12 '"run_script_actor_id")
(let $13 '('"database" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"graph_compressed" $9 '"lease_generation" '"meta" '"parameters" '"query_text" '"retry_state" $12 '"start_ts" '"syntax" '"user_group_sids" '"user_token"))
(let $14 (KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct $3 $4 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $7 '('"graph_compressed" $graph_compressed) '($9 $graph_compression_method) $10 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '($12 (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid)))) '()) $13 '() '"false" '('('"Mode" '"upsert"))))
(let $15 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $16 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $17 (KqlUpsertRows $15 (KqpWriteConstraint (AsList (AsStruct $3 $4 $7 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $10 '('"lease_state" (Just $lease_state)))) '()) $16 '() '"false" '('('"Mode" '"upsert"))))
(return '('('() '($14 $17))))
)
-------- block transformer end
2025-10-07T09:17:25.179290Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.178 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 495 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database" (Just $database)))
(let $4 '('"execution_id" (Just $execution_id)))
(let $5 (DataType 'Int32))
(let $6 (DataType 'Interval))
(let $7 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $8 (DataType 'String))
(let $9 '"graph_compression_method")
(let $10 '('"lease_generation" (Just (Int64 '1))))
(let $11 (DataType 'JsonDocument))
(let $12 '"run_script_actor_id")
(let $13 '('"database" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"graph_compressed" $9 '"lease_generation" '"meta" '"parameters" '"query_text" '"retry_state" $12 '"start_ts" '"syntax" '"user_group_sids" '"user_token"))
(let $14 (KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct $3 $4 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $7 '('"graph_compressed" $graph_compressed) '($9 $graph_compression_method) $10 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '($12 (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid)))) '()) $13 '() '"false" '('('"Mode" '"upsert"))))
(let $15 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $16 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $17 (KqlUpsertRows $15 (KqpWriteConstraint (AsList (AsStruct $3 $4 $7 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $10 '('"lease_state" (Just $lease_state)))) '()) $16 '() '"false" '('('"Mode" '"upsert"))))
(return '('() '($14 $17)))
)
-------- block transformer block end
2025-10-07T09:17:25.179323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.179 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.186841Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.186 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:25.187048Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:25.201194Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.200 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 552 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (DataType 'Utf8))
(let $2 '('"database" (Just $database)))
(let $3 '('"execution_id" (Just $execution_id)))
(let $4 (DataType 'Int32))
(let $5 (DataType 'Interval))
(let $6 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $7 '('"lease_generation" (Just (Int64 '1))))
(let $8 (DataSink '"KqpTableSink" '"db"))
(let $9 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $10 (KqpTableSinkSettings $9 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $11 (DqStage '() (lambda '() (block '(
  (let $15 (DataType 'String))
  (let $16 (DataType 'JsonDocument))
  (return (ToFlow (AsList (AsStruct $2 $3 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $6 '('"graph_compressed" $graph_compressed) '('"graph_compression_method" $graph_compression_method) $7 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '('"run_script_actor_id" (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid))))))
))) '() '((DqSink '"0" $8 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 '"false" '"upsert" '1 '"false" '"false" '"false" '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct $2 $3 $6 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $7 '('"lease_state" (Just $lease_state)))))) '() '((DqSink '"0" $8 $13))))
(return '('('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:25.202000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 552 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (DataType 'Utf8))
(let $2 '('"database" (Just $database)))
(let $3 '('"execution_id" (Just $execution_id)))
(let $4 (DataType 'Int32))
(let $5 (DataType 'Interval))
(let $6 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $7 '('"lease_generation" (Just (Int64 '1))))
(let $8 (DataSink '"KqpTableSink" '"db"))
(let $9 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $10 (KqpTableSinkSettings $9 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $11 (DqStage '() (lambda '() (block '(
  (let $15 (DataType 'String))
  (let $16 (DataType 'JsonDocument))
  (return (ToFlow (AsList (AsStruct $2 $3 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $6 '('"graph_compressed" $graph_compressed) '('"graph_compression_method" $graph_compression_method) $7 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '('"run_script_actor_id" (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid))))))
))) '() '((DqSink '"0" $8 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 '"false" '"upsert" '1 '"false" '"false" '"false" '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct $2 $3 $6 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $7 '('"lease_state" (Just $lease_state)))))) '() '((DqSink '"0" $8 $13))))
(return '('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:25.202035Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.202 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.203546Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.202 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 553 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (DataType 'Utf8))
(let $2 '('"database" (Just $database)))
(let $3 '('"execution_id" (Just $execution_id)))
(let $4 (DataType 'Int32))
(let $5 (DataType 'Interval))
(let $6 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $7 '('"lease_generation" (Just (Int64 '1))))
(let $8 (DataSink '"KqpTableSink" '"db"))
(let $9 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $10 (KqpTableSinkSettings $9 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $11 (DqStage '() (lambda '() (block '(
  (let $15 (DataType 'String))
  (let $16 (DataType 'JsonDocument))
  (return (ToFlow (AsList (AsStruct $2 $3 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $6 '('"graph_compressed" $graph_compressed) '('"graph_compression_method" $graph_compression_method) $7 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '('"run_script_actor_id" (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid))))))
))) '() '((DqSink '"0" $8 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 '"false" '"upsert" '1 '"false" '"false" '"false" '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct $2 $3 $6 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $7 '('"lease_state" (Just $lease_state)))))) '() '((DqSink '"0" $8 $13))))
(return '('('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:25.204346Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 553 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_meta_ttl (DataType 'Interval))
(declare $execution_mode (DataType 'Int32))
(declare $execution_status (DataType 'Int32))
(declare $graph_compressed (OptionalType (DataType 'String)))
(declare $graph_compression_method (OptionalType (DataType 'Utf8)))
(declare $lease_duration (DataType 'Interval))
(declare $lease_state (DataType 'Int32))
(declare $meta (DataType 'JsonDocument))
(declare $parameters (DataType 'String))
(declare $query_text (DataType 'Utf8))
(declare $retry_state (DataType 'JsonDocument))
(declare $run_script_actor_id (DataType 'Utf8))
(declare $syntax (DataType 'Int32))
(declare $user_group_sids (DataType 'JsonDocument))
(declare $user_sid (DataType 'Utf8))
(let $1 (DataType 'Utf8))
(let $2 '('"database" (Just $database)))
(let $3 '('"execution_id" (Just $execution_id)))
(let $4 (DataType 'Int32))
(let $5 (DataType 'Interval))
(let $6 '('"expire_at" (+ (CurrentUtcTimestamp) $execution_meta_ttl)))
(let $7 '('"lease_generation" (Just (Int64 '1))))
(let $8 (DataSink '"KqpTableSink" '"db"))
(let $9 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $10 (KqpTableSinkSettings $9 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $11 (DqStage '() (lambda '() (block '(
  (let $15 (DataType 'String))
  (let $16 (DataType 'JsonDocument))
  (return (ToFlow (AsList (AsStruct $2 $3 '('"execution_mode" (Just $execution_mode)) '('"execution_status" (Just $execution_status)) $6 '('"graph_compressed" $graph_compressed) '('"graph_compression_method" $graph_compression_method) $7 '('"meta" (Just $meta)) '('"parameters" (Just $parameters)) '('"query_text" (Just $query_text)) '('"retry_state" (Just $retry_state)) '('"run_script_actor_id" (Just $run_script_actor_id)) '('"start_ts" (Just (CurrentUtcTimestamp))) '('"syntax" (Just $syntax)) '('"user_group_sids" (Just $user_group_sids)) '('"user_token" (Just $user_sid))))))
))) '() '((DqSink '"0" $8 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 '"false" '"upsert" '1 '"false" '"false" '"false" '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct $2 $3 $6 '('"lease_deadline" (+ (CurrentUtcTimestamp) $lease_duration)) $7 '('"lease_state" (Just $lease_state)))))) '() '((DqSink '"0" $8 $13))))
(return '('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:25.204380Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361443:2987], cluster: db, database: /Root, text: "\n            -- TListExpiredLeasesQueryActor::OnRunQuery\n            DECLARE $max_lease_deadline AS Timestamp;\n            DECLARE $max_listed_leases AS Uint64;\n\n            SELECT\n                database,\n                execution_id\n            FROM `.metadata/script_execution_leases`\n            WHERE lease_deadline < $max_lease_deadline\n              AND (expire_at > CurrentUtcTimestamp() OR expire_at IS NULL)\n            LIMIT $max_listed_leases;\n        ", startTime: 2025-10-07T09:17:25.231030Z
2025-10-07T09:17:25.245127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #445
2025-10-07T09:17:25.245183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #447, status: Async
2025-10-07T09:17:25.245316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #445
2025-10-07T09:17:25.245354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #445
2025-10-07T09:17:25.245390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #447
2025-10-07T09:17:25.245421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #447, status: Ok
2025-10-07T09:17:25.245507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #445<KiExecDataQuery!> finished execution
2025-10-07T09:17:25.245544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #445<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:25.245578Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #446<Left!> finished execution
2025-10-07T09:17:25.245623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #447<Commit!> finished execution
2025-10-07T09:17:25.245660Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #447<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.245692Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #447, status: Ok
2025-10-07T09:17:25.245721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #447
2025-10-07T09:17:25.246998Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc584dggsrbe97ty36tjw, SessionId: CompileActor 2025-10-07 12:17:25.246 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361426:2977], duration: 0.121041s
2025-10-07T09:17:25.248058Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.248 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.248934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.248 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($9) (Coalesce (And (< (Member $9 '"lease_deadline") $max_lease_deadline) (Or (> (Member $9 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $9 '"expire_at"))))) (Bool 'false)))))
(let $4 (TypeOf $3))
(let $5 (SqlProjectItem $4 '"database" (lambda '($10) (Member $10 '"database"))))
(let $6 (SqlProjectItem $4 '"execution_id" (lambda '($11) (Member $11 '"execution_id"))))
(let $7 '('('type) '('autoref) '('columns '('"database" '"execution_id"))))
(let $8 (Write! (Left! $1) $2 (Key) (Take (PersistableRepr (SqlProject $3 '($5 $6))) (Coalesce $max_listed_leases (Uint64 '18446744073709551615))) $7))
(return (Commit! $8 $2))
)
2025-10-07T09:17:25.249420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.249 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($9) (Coalesce (And (< (Member $9 '"lease_deadline") $max_lease_deadline) (Or (> (Member $9 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $9 '"expire_at"))))) (Bool 'false)))))
(let $4 (TypeOf $3))
(let $5 (SqlProjectItem $4 '"database" (lambda '($10) (Member $10 '"database"))))
(let $6 (SqlProjectItem $4 '"execution_id" (lambda '($11) (Member $11 '"execution_id"))))
(let $7 '('('type) '('autoref) '('columns '('"database" '"execution_id"))))
(let $8 (Write! (Left! $1) $2 (Key) (Take (PersistableRepr (SqlProject $3 '($5 $6))) (Coalesce $max_listed_leases (Uint64 '18446744073709551615))) $7))
(return (Commit! $8 $2))
)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361470:2995], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:25.253772Z
2025-10-07T09:17:25.253950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.258526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.258 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.259033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.258 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:25.259308Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:25.261301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.268935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.268 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.272530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.272 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.272662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.272 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.275328Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.275736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:25.275778Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:25.275813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:25.277568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.277 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.279078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.279278Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.279446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.279482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.281402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:25.282869Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.283505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.283 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"/Root/.metadata/script_execution_leases")
(let $3 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(let $4 '('"database" '"execution_id"))
(let $5 '('('"mode" '"flush")))
(let $6 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (ExtractMembers (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) $3) (lambda '($10) (block '(
  (let $11 (Bool 'false))
  (let $12 (Member $10 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $10 '"lease_deadline") $max_lease_deadline) $11) (Or (Coalesce (> $12 (CurrentUtcTimestamp)) $11) (Not (Exists $12)))) (AsStruct '('"database" (Member $10 '"database")) '('"execution_id" (Member $10 '"execution_id")))))
)))) (Min (Uint64 '"1001") $max_listed_leases)) $4 '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $5 (Void)))
(let $7 (DataSink 'result))
(let $8 '('('type) '('autoref) '('columns $4)))
(let $9 (ResPull! (Left! $6) $7 (Key) (Nth (Right! $6) '0) $8 '"kikimr"))
(return (Commit! (Commit! $9 $7) $1 $5))
)
2025-10-07T09:17:25.283510Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.283 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.283545Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.283 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #647
2025-10-07T09:17:25.283577Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.283 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #647, status: Ok
2025-10-07T09:17:25.286285Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.286 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:25.286629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.286 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.287006Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.286 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 688 (
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $2 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(let $4 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(return '('('('((Take (FlatMap (ExtractMembers $3 $4) (lambda '($5) (block '(
  (let $6 (Bool 'false))
  (let $7 (Member $5 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $5 '"lease_deadline") $max_lease_deadline) $6) (Or (Coalesce (> $7 (CurrentUtcTimestamp)) $6) (Not (Exists $7)))) (AsStruct '('"database" (Member $5 '"database")) '('"execution_id" (Member $5 '"execution_id")))))
)))) (Min (Uint64 '"1001") $max_listed_leases)) '('"database" '"execution_id"))) '())))
)
-------- block transformer end
2025-10-07T09:17:25.287358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.287 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 688 n: 0 (
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $2 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(let $4 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(return '('('((Take (FlatMap (ExtractMembers $3 $4) (lambda '($5) (block '(
  (let $6 (Bool 'false))
  (let $7 (Member $5 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $5 '"lease_deadline") $max_lease_deadline) $6) (Or (Coalesce (> $7 (CurrentUtcTimestamp)) $6) (Not (Exists $7)))) (AsStruct '('"database" (Member $5 '"database")) '('"execution_id" (Member $5 '"execution_id")))))
)))) (Min (Uint64 '"1001") $max_listed_leases)) '('"database" '"execution_id"))) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.287393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.287 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.289932Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.289 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.291544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.291 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.295334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.295678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.295717Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.296026Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:25.296460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.296770Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.296805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.299377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.299 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:25.300089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.300 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.305106Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.310252Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.310 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.317653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.317 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1016 (
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $2 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(let $3 (KqpRowsSourceSettings $1 $2 '() (Void) '()))
(let $4 (Min (Uint64 '"1001") $max_listed_leases))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $3)) (lambda '($9) (Take (FlatMap (ToFlow $9) (lambda '($10) (block '(
  (let $11 (Bool 'false))
  (let $12 (Member $10 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $10 '"lease_deadline") $max_lease_deadline) $11) (Or (Coalesce (> $12 (CurrentUtcTimestamp)) $11) (Not (Exists $12)))) (AsStruct '('"database" (Member $10 '"database")) '('"execution_id" (Member $10 '"execution_id")))))
)))) $4)) '('('"_logical_id" '951) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($13) (Take $13 $4)) '('('"_logical_id" '964))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '('"database" '"execution_id"))) '())))
)
-------- block transformer end
2025-10-07T09:17:25.318118Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.317 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1016 n: 0 (
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $2 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(let $3 (KqpRowsSourceSettings $1 $2 '() (Void) '()))
(let $4 (Min (Uint64 '"1001") $max_listed_leases))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $3)) (lambda '($9) (Take (FlatMap (ToFlow $9) (lambda '($10) (block '(
  (let $11 (Bool 'false))
  (let $12 (Member $10 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $10 '"lease_deadline") $max_lease_deadline) $11) (Or (Coalesce (> $12 (CurrentUtcTimestamp)) $11) (Not (Exists $12)))) (AsStruct '('"database" (Member $10 '"database")) '('"execution_id" (Member $10 '"execution_id")))))
)))) $4)) '('('"_logical_id" '951) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($13) (Take $13 $4)) '('('"_logical_id" '964))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '('"database" '"execution_id"))) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.318153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.319138Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1017 (
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $2 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(let $3 (KqpRowsSourceSettings $1 $2 '() (Void) '()))
(let $4 (Min (Uint64 '"1001") $max_listed_leases))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $3)) (lambda '($9) (Take (FlatMap (ToFlow $9) (lambda '($10) (block '(
  (let $11 (Bool 'false))
  (let $12 (Member $10 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $10 '"lease_deadline") $max_lease_deadline) $11) (Or (Coalesce (> $12 (CurrentUtcTimestamp)) $11) (Not (Exists $12)))) (AsStruct '('"database" (Member $10 '"database")) '('"execution_id" (Member $10 '"execution_id")))))
)))) $4)) '('('"_logical_id" '951) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($13) (Take $13 $4)) '('('"_logical_id" '964))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '('"database" '"execution_id"))) '())))
)
-------- block transformer end
2025-10-07T09:17:25.319595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.319 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1017 n: 0 (
(declare $max_lease_deadline (DataType 'Timestamp))
(declare $max_listed_leases (DataType 'Uint64))
(let $1 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $2 '('"database" '"execution_id" '"expire_at" '"lease_deadline"))
(let $3 (KqpRowsSourceSettings $1 $2 '() (Void) '()))
(let $4 (Min (Uint64 '"1001") $max_listed_leases))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $3)) (lambda '($9) (Take (FlatMap (ToFlow $9) (lambda '($10) (block '(
  (let $11 (Bool 'false))
  (let $12 (Member $10 '"expire_at"))
  (return (OptionalIf (And (Coalesce (< (Member $10 '"lease_deadline") $max_lease_deadline) $11) (Or (Coalesce (> $12 (CurrentUtcTimestamp)) $11) (Not (Exists $12)))) (AsStruct '('"database" (Member $10 '"database")) '('"execution_id" (Member $10 '"execution_id")))))
)))) $4)) '('('"_logical_id" '951) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($13) (Take $13 $4)) '('('"_logical_id" '964))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '('"database" '"execution_id"))) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.319629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.319 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.322488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 951
2025-10-07T09:17:25.329374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:25.329451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:25.329492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:25.329534Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:25.330833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:25.330875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:25.330910Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:25.330941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:25.331044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:25.331079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:25.331112Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:25.331236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:25.331276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:25.331323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:25.331361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.331399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:25.331436Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.331468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:25.331498Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:25.332186Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5c50msq2byp1n4dex7k, SessionId: CompileActor 2025-10-07 12:17:25.332 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361470:2995], duration: 0.078375s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361499:3005], cluster: db, database: /Root, text: "\n                PRAGMA ydb.HashJoinMode = \"map\";\n                $ydb_lookup = SELECT * FROM `ydbSourceName`.`lookup`;\n\n                $pq_source = SELECT * FROM `pqSourceName`.`inputTopicName` WITH (\n                    FORMAT = \"json_each_row\",\n                    SCHEMA (\n                        time Int32 NOT NULL,\n                        event String,\n                        host String\n                    )\n                );\n\n                $joined = SELECT l.payload AS payload, p.* FROM $pq_source AS p\n                LEFT JOIN $ydb_lookup AS l\n                ON (l.fqdn = p.host);\n\n                INSERT INTO `pqSourceName`.`outputTopicName`\n                SELECT Unwrap(event || \"-\" || payload) FROM $joined\n            ", startTime: 2025-10-07T09:17:25.341452Z
2025-10-07T09:17:25.356057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.356 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.357652Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.356 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Configure! world (DataSource '"ydb" '"$all") '"Attr" '"hashjoinmode" '"map"))
(let $2 (Read! $1 (DataSource '"kikimr" '"/Root/ydbSourceName") (Key '('table (String '"lookup"))) (Void) '()))
(let $3 (Right! $2))
(let $4 '((Left! $2) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($18) $18) '())))))))
(let $5 (StructType '('"time" (DataType 'Int32)) '('"event" (AsOptionalType (DataType 'String))) '('"host" (AsOptionalType (DataType 'String)))))
(let $6 '('"time" '"event" '"host"))
(let $7 '('"userschema" $5 $6))
(let $8 (Read! (Nth $4 '0) (DataSource '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"inputTopicName"))) (Void) '('('"format" '"json_each_row") $7)))
(let $9 (Right! $8))
(let $10 '((Left! $8) (RemoveSystemMembers (PersistableRepr (SqlProject $9 '((SqlProjectStarItem (TypeOf $9) '"" (lambda '($19) $19) '())))))))
(let $11 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $12 (EquiJoin '((RemoveSystemMembers (Nth $10 '1)) '"p") '((RemoveSystemMembers (Nth $4 '1)) '"l") $11 '()))
(let $13 (TypeOf $12))
(let $14 (SqlProjectItem $13 '"payload" (lambda '($20) (SqlColumn $20 '"payload" '"l"))))
(let $15 (SqlProjectStarItem $13 '"p" (lambda '($21) (DivePrefixMembers $21 '('"p."))) '('('divePrefix '('"p.")))))
(let $16 '((Nth $10 '0) (PersistableRepr (SqlProject $12 '($14 $15)))))
(let $17 (Nth $16 '1))
(return (Write! (Nth $16 '0) (DataSink '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"outputTopicName"))) (PersistableRepr (SqlProject $17 '((SqlProjectItem (TypeOf $17) '"" (lambda '($22) (Unwrap (Concat (Concat (Member $22 '"event") (String '"-")) (Member $22 '"payload")))) '('('autoName)))))) '('('mode 'insert_abort))))
)
2025-10-07T09:17:25.358589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.357 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Configure! world (DataSource '"ydb" '"$all") '"Attr" '"hashjoinmode" '"map"))
(let $2 (Read! $1 (DataSource '"kikimr" '"/Root/ydbSourceName") (Key '('table (String '"lookup"))) (Void) '()))
(let $3 (Right! $2))
(let $4 '((Left! $2) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($18) $18) '())))))))
(let $5 (StructType '('"time" (DataType 'Int32)) '('"event" (AsOptionalType (DataType 'String))) '('"host" (AsOptionalType (DataType 'String)))))
(let $6 '('"time" '"event" '"host"))
(let $7 '('"userschema" $5 $6))
(let $8 (Read! (Nth $4 '0) (DataSource '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"inputTopicName"))) (Void) '('('"format" '"json_each_row") $7)))
(let $9 (Right! $8))
(let $10 '((Left! $8) (RemoveSystemMembers (PersistableRepr (SqlProject $9 '((SqlProjectStarItem (TypeOf $9) '"" (lambda '($19) $19) '())))))))
(let $11 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $12 (EquiJoin '((RemoveSystemMembers (Nth $10 '1)) '"p") '((RemoveSystemMembers (Nth $4 '1)) '"l") $11 '()))
(let $13 (TypeOf $12))
(let $14 (SqlProjectItem $13 '"payload" (lambda '($20) (SqlColumn $20 '"payload" '"l"))))
(let $15 (SqlProjectStarItem $13 '"p" (lambda '($21) (DivePrefixMembers $21 '('"p."))) '('('divePrefix '('"p.")))))
(let $16 '((Nth $10 '0) (PersistableRepr (SqlProject $12 '($14 $15)))))
(let $17 (Nth $16 '1))
(return (Write! (Nth $16 '0) (DataSink '"kikimr" '"/Root/pqSourceName") (Key '('table (String '"outputTopicName"))) (PersistableRepr (SqlProject $17 '((SqlProjectItem (TypeOf $17) '"" (lambda '($22) (Unwrap (Concat (Concat (Member $22 '"event") (String '"-")) (Member $22 '"payload")))) '('('autoName)))))) '('('mode 'insert_abort))))
)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361508:3009], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:25.366141Z
2025-10-07T09:17:25.370693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.370 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.371189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.370 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:25.371439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.371 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:25.375000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.374 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [generic] yql_generic_settings.cpp:61: GenericConfiguration::AddCluster: name = /Root/ydbSourceName, kind = YDB, database name = local, database id = , endpoint = { host: "localhost" port: 2893 }, use tls = 0, protocol = NATIVE
2025-10-07T09:17:25.376554Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [generic] yql_generic_describe_table.cpp:321: Describe table for: ``/Root/ydbSourceName`.`lookup``
Call DescribeTable.
data_source_instance {
  kind: YDB
  endpoint {
    host: "localhost"
    port: 2893
  }
  database: "local"
  credentials {
    token {
      type: "IAM"
      value: "root@builtin"
    }
  }
  use_tls: false
  protocol: NATIVE
}
table: "lookup"
type_mapping_settings {
  date_time_format: STRING_FORMAT
}
CRAB Expected: data_source_instance {
  kind: YDB
  endpoint {
    host: "localhost"
    port: 2893
  }
  database: "local"
  credentials {
    token {
      type: "IAM"
      value: "root@builtin"
    }
  }
  use_tls: false
  protocol: NATIVE
}
table: "lookup"
type_mapping_settings {
  date_time_format: STRING_FORMAT
}
CRAB Actual: data_source_instance {
  kind: YDB
  endpoint {
    host: "localhost"
    port: 2893
  }
  database: "local"
  credentials {
    token {
      type: "IAM"
      value: "root@builtin"
    }
  }
  use_tls: false
  protocol: NATIVE
}
table: "lookup"
type_mapping_settings {
  date_time_format: STRING_FORMAT
}
DescribeTable result.
GRpcStatusCode: 0
schema {
  columns {
    name: "fqdn"
    type {
      type_id: STRING
    }
  }
  columns {
    name: "payload"
    type {
      type_id: STRING
    }
  }
}
error {
  status: SUCCESS
}
2025-10-07T09:17:25.376928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_load_meta.cpp:35: Load topic meta for: `/Root/pqSourceName`.`outputTopicName`
2025-10-07T09:17:25.376978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_load_meta.cpp:35: Load topic meta for: `/Root/pqSourceName`.`inputTopicName`
2025-10-07T09:17:25.377072Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_load_meta.cpp:35: Load topic meta for: `/Root/pqSourceName`.`inputTopicName`
2025-10-07T09:17:25.378323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.378 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_datasource.cpp:88: RewriteIO
2025-10-07T09:17:25.378383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.378 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_datasource.cpp:88: RewriteIO
2025-10-07T09:17:25.378674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.378 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_datasink.cpp:102: Rewrite Write!
2025-10-07T09:17:25.380750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #641
2025-10-07T09:17:25.380818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #644<Nth> finished execution
2025-10-07T09:17:25.380858Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #644<Nth> created 0 trackable nodes: 
2025-10-07T09:17:25.380896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #647, status: Async
2025-10-07T09:17:25.381273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #641
2025-10-07T09:17:25.381311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #641
2025-10-07T09:17:25.381347Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #647
2025-10-07T09:17:25.381378Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #647, status: Ok
2025-10-07T09:17:25.381488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #641<KiExecDataQuery!> finished execution
2025-10-07T09:17:25.381524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #641<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:25.381558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #642<Left!> finished execution
2025-10-07T09:17:25.381680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #645<ResPull!> finished execution
2025-10-07T09:17:25.381719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #645<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:25.381765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #646<Commit!> finished execution
2025-10-07T09:17:25.381803Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #646<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.381841Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #647<Commit!> finished execution
2025-10-07T09:17:25.381879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #647<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.381911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #647, status: Ok
2025-10-07T09:17:25.381941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #647
2025-10-07T09:17:25.382750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5be4gxt67zs1wnmy8vc, SessionId: CompileActor 2025-10-07 12:17:25.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361443:2987], duration: 0.151681s
2025-10-07T09:17:25.392718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.392 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.399117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.399 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.402311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.402 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.404627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.404 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.404984Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.404 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:25.405021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.404 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:25.405053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.405 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:25.408246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.408452Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.408637Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.408679Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.410734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:25.412963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.412 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.415992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:25.419389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.419 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.422734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.424170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.424475Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.424509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.425186Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.425481Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.425515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.427873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:25.431050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.431937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (Configure! world (DataSource '"kikimr" '"$all") '"Attr" '"hashjoinmode" '"map"))
(let $2 (DataSink '"kikimr" '"db"))
(let $3 '"/Root/pqSourceName")
(let $4 '('('"PartitionsCount" '"1")))
(let $5 (DataType 'String))
(let $6 (PqTopic $3 '"local" '"outputTopicName" $4 '() (StructType '('"Data" $5))))
(let $7 '('('"system" '"_yql_sys_create_time") '('"system" '"_yql_sys_tsp_write_time") '('"system" '"_yql_sys_partition_id") '('"system" '"_yql_sys_offset") '('"system" '"_yql_sys_message_group_id") '('"system" '"_yql_sys_seq_no")))
(let $8 (OptionalType $5))
(let $9 (StructType '('"event" $8) '('"host" $8) '('"time" (DataType 'Int32))))
(let $10 (PqTopic $3 '"local" '"inputTopicName" $4 $7 $9))
(let $11 '('"time" '"event" '"host"))
(let $12 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $13 '('"rename" '"l.fqdn" '""))
(let $14 '('"rename" '"p.host" '""))
(let $15 (EquiJoin '((ExtractMembers (Right! (PqReadTopic! world (DataSource '"pq" $3) $10 $11 '"json_each_row" '"" (Void) '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX")))) '('"event" '"host")) '"p") '((Right! (GenReadTable! world (DataSource '"generic" '"/Root/ydbSourceName") (GenTable '"lookup") (Void) (lambda '($17) (Bool '"true")))) '"l") $12 '($13 $14)))
(let $16 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! $1 $2 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (PqWriteTopic! world (DataSink '"pq" $3) $6 (FlatMap $15 (lambda '($18) (Just (AsStruct '('"column0" (Unwrap (Concat (Concat (Member $18 '"p.event") (String '"-")) (Member $18 '"l.payload")))))))) 'insert_abort '())) '() '())) $16 (Void))) $2 $16))
)
2025-10-07T09:17:25.431978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #1204
2025-10-07T09:17:25.432011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #1204, status: Ok
2025-10-07T09:17:25.432089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.432 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #9<Configure!> finished execution
2025-10-07T09:17:25.432125Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.432 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #9<Configure!> created 0 trackable nodes: 
2025-10-07T09:17:25.435823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.435 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.436765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.435 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1275 (
(let $1 '"/Root/pqSourceName")
(let $2 '('('"PartitionsCount" '"1")))
(let $3 (DataType 'String))
(let $4 (PqTopic $1 '"local" '"outputTopicName" $2 '() (StructType '('"Data" $3))))
(let $5 '"_yql_sys_create_time")
(let $6 '"_yql_sys_tsp_write_time")
(let $7 '"_yql_sys_partition_id")
(let $8 '"_yql_sys_message_group_id")
(let $9 '('('"system" $5) '('"system" $6) '('"system" $7) '('"system" '"_yql_sys_offset") '('"system" $8) '('"system" '"_yql_sys_seq_no")))
(let $10 (OptionalType $3))
(let $11 '('"event" $10))
(let $12 '('"host" $10))
(let $13 '('"time" (DataType 'Int32)))
(let $14 (StructType $11 $12 $13))
(let $15 (PqTopic $1 '"local" '"inputTopicName" $2 $9 $14))
(let $16 '('"event" '"host" '"time"))
(let $17 '('('"Endpoint" '"localhost:2893") '('"SharedReading" '"0") '('"ReconnectPeriod" '"") '('"Format" '"json_each_row") '('"ReadGroup" '"")))
(let $18 (DataType 'Timestamp))
(let $19 (DataType 'Uint64))
(let $20 (StructType '($5 $18) '($8 $3) '('"_yql_sys_offset" $19) '($7 $19) '('"_yql_sys_seq_no" $19) '($6 $18) $11 $12 $13))
(let $21 (DqPqTopicSource world $15 $16 $17 (SecureParam '"cluster:default_/Root/pqSourceName") '"" $20 '""))
(let $22 '('"_yql_sys_create_time" '"_yql_sys_tsp_write_time" '"_yql_sys_partition_id" '"_yql_sys_offset" '"_yql_sys_message_group_id" '"_yql_sys_seq_no"))
(let $23 '('('"format" '"json_each_row") '('"metadataColumns" $22) '('"formatSettings" '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX"))) '('"settings" '('('"SharedReading" '"0")))))
(let $24 (DqSourceWrap $21 (DataSource '"pq" $1) $20 $23))
(let $25 '"/Root/ydbSourceName")
(let $26 (GenSourceSettings world $25 '"lookup" (SecureParam '"cluster:default_/Root/ydbSourceName") '('"fqdn" '"payload") (lambda '($32) (Bool '"true"))))
(let $27 (DqSourceWrap $26 (DataSource '"generic" $25) (StructType '('"fqdn" $3) '('"payload" $3))))
(let $28 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $29 '('"rename" '"l.fqdn" '""))
(let $30 '('"rename" '"p.host" '""))
(let $31 (EquiJoin '((ExtractMembers $24 '('"event" '"host")) '"p") '($27 '"l") $28 '($29 $30)))
(return '('('() '((KqlExternalEffect (PqInsert world (DataSink '"pq" $1) $4 (FlatMap $31 (lambda '($33) (Just (AsStruct '('"column0" (Unwrap (Concat (Concat (Member $33 '"p.event") (String '"-")) (Member $33 '"l.payload"))))))))))))))
)
-------- block transformer end
2025-10-07T09:17:25.437661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1275 n: 0 (
(let $1 '"/Root/pqSourceName")
(let $2 '('('"PartitionsCount" '"1")))
(let $3 (DataType 'String))
(let $4 (PqTopic $1 '"local" '"outputTopicName" $2 '() (StructType '('"Data" $3))))
(let $5 '"_yql_sys_create_time")
(let $6 '"_yql_sys_tsp_write_time")
(let $7 '"_yql_sys_partition_id")
(let $8 '"_yql_sys_message_group_id")
(let $9 '('('"system" $5) '('"system" $6) '('"system" $7) '('"system" '"_yql_sys_offset") '('"system" $8) '('"system" '"_yql_sys_seq_no")))
(let $10 (OptionalType $3))
(let $11 '('"event" $10))
(let $12 '('"host" $10))
(let $13 '('"time" (DataType 'Int32)))
(let $14 (StructType $11 $12 $13))
(let $15 (PqTopic $1 '"local" '"inputTopicName" $2 $9 $14))
(let $16 '('"event" '"host" '"time"))
(let $17 '('('"Endpoint" '"localhost:2893") '('"SharedReading" '"0") '('"ReconnectPeriod" '"") '('"Format" '"json_each_row") '('"ReadGroup" '"")))
(let $18 (DataType 'Timestamp))
(let $19 (DataType 'Uint64))
(let $20 (StructType '($5 $18) '($8 $3) '('"_yql_sys_offset" $19) '($7 $19) '('"_yql_sys_seq_no" $19) '($6 $18) $11 $12 $13))
(let $21 (DqPqTopicSource world $15 $16 $17 (SecureParam '"cluster:default_/Root/pqSourceName") '"" $20 '""))
(let $22 '('"_yql_sys_create_time" '"_yql_sys_tsp_write_time" '"_yql_sys_partition_id" '"_yql_sys_offset" '"_yql_sys_message_group_id" '"_yql_sys_seq_no"))
(let $23 '('('"format" '"json_each_row") '('"metadataColumns" $22) '('"formatSettings" '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX"))) '('"settings" '('('"SharedReading" '"0")))))
(let $24 (DqSourceWrap $21 (DataSource '"pq" $1) $20 $23))
(let $25 '"/Root/ydbSourceName")
(let $26 (GenSourceSettings world $25 '"lookup" (SecureParam '"cluster:default_/Root/ydbSourceName") '('"fqdn" '"payload") (lambda '($32) (Bool '"true"))))
(let $27 (DqSourceWrap $26 (DataSource '"generic" $25) (StructType '('"fqdn" $3) '('"payload" $3))))
(let $28 '('Left '"p" '"l" '('"p" '"host") '('"l" '"fqdn") '()))
(let $29 '('"rename" '"l.fqdn" '""))
(let $30 '('"rename" '"p.host" '""))
(let $31 (EquiJoin '((ExtractMembers $24 '('"event" '"host")) '"p") '($27 '"l") $28 '($29 $30)))
(return '('() '((KqlExternalEffect (PqInsert world (DataSink '"pq" $1) $4 (FlatMap $31 (lambda '($33) (Just (AsStruct '('"column0" (Unwrap (Concat (Concat (Member $33 '"p.event") (String '"-")) (Member $33 '"l.payload")))))))))))))
)
-------- block transformer block end
2025-10-07T09:17:25.437696Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.437 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.444674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteEquiJoin
2025-10-07T09:17:25.454084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.454 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_optimize.cpp:135: LogicalOptimizer-ExtractMembersOverDqWrap
2025-10-07T09:17:25.456074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:25.456144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:25.456186Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:25.456240Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:25.456308Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:25.456348Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:25.456383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:25.456414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:25.456513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:25.456550Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:25.456581Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:25.456693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:25.456731Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:25.456776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:25.456814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.456852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:25.456889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.456921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:25.456951Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.456 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:25.457648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5fm312vy1eyebxej81x, SessionId: CompileActor 2025-10-07 12:17:25.457 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361508:3009], duration: 0.091467s
2025-10-07T09:17:25.458929Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildStageWithSourceWrap
2025-10-07T09:17:25.459123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildStageWithSourceWrap
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361566:3026], cluster: db, database: /Root, text: "\n            -- TGetScriptExecutionOperationQueryActor::OnRunQuery\n            DECLARE $database AS Text;\n            DECLARE $execution_id AS Text;\n\n            SELECT\n                run_script_actor_id,\n                operation_status,\n                execution_status,\n                finalization_status,\n                query_text,\n                syntax,\n                execution_mode,\n                result_set_metas,\n                plan,\n                plan_compressed,\n                plan_compression_method,\n                issues,\n                transient_issues,\n                stats,\n                ast,\n                ast_compressed,\n                ast_compression_method,\n                graph_compressed IS NOT NULL AS has_graph\n            FROM `.metadata/script_executions`\n            WHERE database = $database AND execution_id = $execution_id AND\n                  (expire_at > CurrentUtcTimestamp() OR expire_at IS NULL);\n\n            SELECT\n                lease_deadline,\n                lease_generation,\n                lease_state\n            FROM `.metadata/script_execution_leases`\n            WHERE database = $database AND execution_id = $execution_id AND\n                  (expire_at > CurrentUtcTimestamp() OR expire_at IS NULL);\n        ", startTime: 2025-10-07T09:17:25.463964Z
2025-10-07T09:17:25.467893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.467 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildJoin<false>
2025-10-07T09:17:25.474463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.474 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushExtractMembersToStage<false>
2025-10-07T09:17:25.480907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.480 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.489204Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.489 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
Call ListSplits.
selects {
  data_source_instance {
    kind: YDB
    endpoint {
      host: "localhost"
      port: 2893
    }
    database: "local"
    credentials {
      token {
        type: "IAM"
        value: "root@builtin"
      }
    }
    use_tls: false
    protocol: NATIVE
  }
  what {
    items {
      column {
        name: "fqdn"
        type {
          type_id: STRING
        }
      }
    }
    items {
      column {
        name: "payload"
        type {
          type_id: STRING
        }
      }
    }
  }
  from {
    table: "lookup"
  }
}
CRAB Expected: selects {
  data_source_instance {
    kind: YDB
    endpoint {
      host: "localhost"
      port: 2893
    }
    database: "local"
    credentials {
      token {
        type: "IAM"
        value: "root@builtin"
      }
    }
    use_tls: false
    protocol: NATIVE
  }
  what {
    items {
      column {
        name: "fqdn"
        type {
          type_id: STRING
        }
      }
    }
    items {
      column {
        name: "payload"
        type {
          type_id: STRING
        }
      }
    }
  }
  from {
    table: "lookup"
  }
}
CRAB Actual: selects {
  data_source_instance {
    kind: YDB
    endpoint {
      host: "localhost"
      port: 2893
    }
    database: "local"
    credentials {
      token {
        type: "IAM"
        value: "root@builtin"
      }
    }
    use_tls: false
    protocol: NATIVE
  }
  what {
    items {
      column {
        name: "fqdn"
        type {
          type_id: STRING
        }
      }
    }
    items {
      column {
        name: "payload"
        type {
          type_id: STRING
        }
      }
    }
  }
  from {
    table: "lookup"
  }
}
ListSplits result.
GRpcStatusCode: 0
2025-10-07T09:17:25.491641Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_pq_physical_optimize.cpp:150: Optimize PqInsert `/Root/pqSourceName`.`outputTopicName`
2025-10-07T09:17:25.491770Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [PQ] yql_optimize.cpp:95: PhysicalOptimizer-PqInsert
2025-10-07T09:17:25.491880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 $database)
(let $4 $execution_id)
(let $5 (Filter (Right! $1) (lambda '($40) (Coalesce (And (And (== (Member $40 '"database") $3) (== (Member $40 '"execution_id") $4)) (Or (> (Member $40 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $40 '"expire_at"))))) (Bool 'false)))))
(let $6 (TypeOf $5))
(let $7 (SqlProjectItem $6 '"run_script_actor_id" (lambda '($41) (Member $41 '"run_script_actor_id"))))
(let $8 (SqlProjectItem $6 '"operation_status" (lambda '($42) (Member $42 '"operation_status"))))
(let $9 (SqlProjectItem $6 '"execution_status" (lambda '($43) (Member $43 '"execution_status"))))
(let $10 (SqlProjectItem $6 '"finalization_status" (lambda '($44) (Member $44 '"finalization_status"))))
(let $11 (SqlProjectItem $6 '"query_text" (lambda '($45) (Member $45 '"query_text"))))
(let $12 (SqlProjectItem $6 '"syntax" (lambda '($46) (Member $46 '"syntax"))))
(let $13 (SqlProjectItem $6 '"execution_mode" (lambda '($47) (Member $47 '"execution_mode"))))
(let $14 (SqlProjectItem $6 '"result_set_metas" (lambda '($48) (Member $48 '"result_set_metas"))))
(let $15 (SqlProjectItem $6 '"plan" (lambda '($49) (Member $49 '"plan"))))
(let $16 (SqlProjectItem $6 '"plan_compressed" (lambda '($50) (Member $50 '"plan_compressed"))))
(let $17 (SqlProjectItem $6 '"plan_compression_method" (lambda '($51) (Member $51 '"plan_compression_method"))))
(let $18 (SqlProjectItem $6 '"issues" (lambda '($52) (Member $52 '"issues"))))
(let $19 (SqlProjectItem $6 '"transient_issues" (lambda '($53) (Member $53 '"transient_issues"))))
(let $20 (SqlProjectItem $6 '"stats" (lambda '($54) (Member $54 '"stats"))))
(let $21 (SqlProjectItem $6 '"ast" (lambda '($55) (Member $55 '"ast"))))
(let $22 (SqlProjectItem $6 '"ast_compressed" (lambda '($56) (Member $56 '"ast_compressed"))))
(let $23 (SqlProjectItem $6 '"ast_compression_method" (lambda '($57) (Member $57 '"ast_compression_method"))))
(let $24 (SqlProjectItem $6 '"has_graph" (lambda '($58) (Not (Not (Exists (Member $58 '"graph_compressed")))))))
(let $25 '($7 $8 $9 $10 $11 $12 $13 $14 $15 $16 $17 $18 $19 $20 $21 $22 $23 $24))
(let $26 '('"run_script_actor_id" '"operation_status" '"execution_status" '"finalization_status" '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" '"plan_compression_method" '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" '"ast_compression_method" '"has_graph"))
(let $27 '('('type) '('autoref) '('columns $26)))
(let $28 (Write! (Left! $1) $2 (Key) (PersistableRepr (SqlProject $5 $25)) $27))
(let $29 (Read! (Commit! $28 $2) (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '()))
(let $30 (DataSink 'result))
(let $31 (Filter (Right! $29) (lambda '($59) (Coalesce (And (And (== (Member $59 '"database") $3) (== (Member $59 '"execution_id") $4)) (Or (> (Member $59 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $59 '"expire_at"))))) (Bool 'false)))))
(let $32 (TypeOf $31))
(let $33 (SqlProjectItem $32 '"lease_deadline" (lambda '($60) (Member $60 '"lease_deadline"))))
(let $34 (SqlProjectItem $32 '"lease_generation" (lambda '($61) (Member $61 '"lease_generation"))))
(let $35 (SqlProjectItem $32 '"lease_state" (lambda '($62) (Member $62 '"lease_state"))))
(let $36 '($33 $34 $35))
(let $37 '('"lease_deadline" '"lease_generation" '"lease_state"))
(let $38 '('('type) '('autoref) '('columns $37)))
(let $39 (Write! (Left! $29) $30 (Key) (PersistableRepr (SqlProject $31 $36)) $38))
(return (Commit! $39 $30))
)
2025-10-07T09:17:25.492429Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #1202
2025-10-07T09:17:25.492485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #1204, status: Async
2025-10-07T09:17:25.492640Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #1202
2025-10-07T09:17:25.492683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #1202
2025-10-07T09:17:25.492722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #1204
2025-10-07T09:17:25.492757Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #1204, status: Ok
2025-10-07T09:17:25.493502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 $database)
(let $4 $execution_id)
(let $5 (Filter (Right! $1) (lambda '($40) (Coalesce (And (And (== (Member $40 '"database") $3) (== (Member $40 '"execution_id") $4)) (Or (> (Member $40 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $40 '"expire_at"))))) (Bool 'false)))))
(let $6 (TypeOf $5))
(let $7 (SqlProjectItem $6 '"run_script_actor_id" (lambda '($41) (Member $41 '"run_script_actor_id"))))
(let $8 (SqlProjectItem $6 '"operation_status" (lambda '($42) (Member $42 '"operation_status"))))
(let $9 (SqlProjectItem $6 '"execution_status" (lambda '($43) (Member $43 '"execution_status"))))
(let $10 (SqlProjectItem $6 '"finalization_status" (lambda '($44) (Member $44 '"finalization_status"))))
(let $11 (SqlProjectItem $6 '"query_text" (lambda '($45) (Member $45 '"query_text"))))
(let $12 (SqlProjectItem $6 '"syntax" (lambda '($46) (Member $46 '"syntax"))))
(let $13 (SqlProjectItem $6 '"execution_mode" (lambda '($47) (Member $47 '"execution_mode"))))
(let $14 (SqlProjectItem $6 '"result_set_metas" (lambda '($48) (Member $48 '"result_set_metas"))))
(let $15 (SqlProjectItem $6 '"plan" (lambda '($49) (Member $49 '"plan"))))
(let $16 (SqlProjectItem $6 '"plan_compressed" (lambda '($50) (Member $50 '"plan_compressed"))))
(let $17 (SqlProjectItem $6 '"plan_compression_method" (lambda '($51) (Member $51 '"plan_compression_method"))))
(let $18 (SqlProjectItem $6 '"issues" (lambda '($52) (Member $52 '"issues"))))
(let $19 (SqlProjectItem $6 '"transient_issues" (lambda '($53) (Member $53 '"transient_issues"))))
(let $20 (SqlProjectItem $6 '"stats" (lambda '($54) (Member $54 '"stats"))))
(let $21 (SqlProjectItem $6 '"ast" (lambda '($55) (Member $55 '"ast"))))
(let $22 (SqlProjectItem $6 '"ast_compressed" (lambda '($56) (Member $56 '"ast_compressed"))))
(let $23 (SqlProjectItem $6 '"ast_compression_method" (lambda '($57) (Member $57 '"ast_compression_method"))))
(let $24 (SqlProjectItem $6 '"has_graph" (lambda '($58) (Not (Not (Exists (Member $58 '"graph_compressed")))))))
(let $25 '($7 $8 $9 $10 $11 $12 $13 $14 $15 $16 $17 $18 $19 $20 $21 $22 $23 $24))
(let $26 '('"run_script_actor_id" '"operation_status" '"execution_status" '"finalization_status" '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" '"plan_compression_method" '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" '"ast_compression_method" '"has_graph"))
(let $27 '('('type) '('autoref) '('columns $26)))
(let $28 (Write! (Left! $1) $2 (Key) (PersistableRepr (SqlProject $5 $25)) $27))
(let $29 (Read! (Commit! $28 $2) (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '()))
(let $30 (DataSink 'result))
(let $31 (Filter (Right! $29) (lambda '($59) (Coalesce (And (And (== (Member $59 '"database") $3) (== (Member $59 '"execution_id") $4)) (Or (> (Member $59 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $59 '"expire_at"))))) (Bool 'false)))))
(let $32 (TypeOf $31))
(let $33 (SqlProjectItem $32 '"lease_deadline" (lambda '($60) (Member $60 '"lease_deadline"))))
(let $34 (SqlProjectItem $32 '"lease_generation" (lambda '($61) (Member $61 '"lease_generation"))))
(let $35 (SqlProjectItem $32 '"lease_state" (lambda '($62) (Member $62 '"lease_state"))))
(let $36 '($33 $34 $35))
(let $37 '('"lease_deadline" '"lease_generation" '"lease_state"))
(let $38 '('('type) '('autoref) '('columns $37)))
(let $39 (Write! (Left! $29) $30 (Key) (PersistableRepr (SqlProject $31 $36)) $38))
(return (Commit! $39 $30))
)
2025-10-07T09:17:25.493946Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1625 (
(let $1 '"/Root/pqSourceName")
(let $2 (DataSource '"pq" $1))
(let $3 '('('"PartitionsCount" '"1")))
(let $4 (DataType 'String))
(let $5 (OptionalType $4))
(let $6 (StructType '('"event" $5) '('"host" $5)))
(let $7 (PqTopic $1 '"local" '"inputTopicName" $3 '() $6))
(let $8 '('"SharedReading" '"0"))
(let $9 '('('"Endpoint" '"localhost:2893") $8 '('"ReconnectPeriod" '"") '('"Format" '"json_each_row") '('"ReadGroup" '"")))
(let $10 (DqPqTopicSource world $7 '('"event" '"host") $9 (SecureParam '"cluster:default_/Root/pqSourceName") '"" $6 '""))
(let $11 '"/Root/ydbSourceName")
(let $12 (DataSource '"generic" $11))
(let $13 (GenSourceSettings world $11 '"lookup" (SecureParam '"cluster:default_/Root/ydbSourceName") '('"fqdn" '"payload") (lambda '($19) (Bool '"true"))))
(let $14 (DqStage '((DqSource $12 $13)) (lambda '($20) (NarrowMap (ToFlow (WideFromBlocks (FromFlow (DqSourceWideBlockWrap $20 $12 (StructType '('"fqdn" $4) '('"payload" $4)))))) (lambda '($21 $22) (AsStruct '('"fqdn" $21) '('"payload" $22))))) '('('"_logical_id" '1409))))
(let $15 (DqCnBroadcast (TDqOutput $14 '"0")))
(let $16 (PqTopic $1 '"local" '"outputTopicName" $3 '() (StructType '('"Data" $4))))
(let $17 (DqPqTopicSink $16 '('('"Endpoint" '"localhost:2893")) (SecureParam '"cluster:default_/Root/pqSourceName")))
(let $18 (DqStage '((DqSource $2 $10) $15) (lambda '($23 $24) (block '(
  (let $25 '('('"format" '"json_each_row") '('"formatSettings" '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX"))) '('"settings" '($8))))
  (let $26 (DqSourceWideWrap $23 $2 $6 $25))
  (let $27 (DqPhyMapJoin (NarrowMap $26 (lambda '($28 $29) (AsStruct '('"event" $28) '('"host" $29)))) $24 '"p" '"l" 'Left '('('"p" '"host" '"l" '"fqdn")) '('"p.host") '('"l.fqdn")))
  (return (FlatMap (ExtractMembers $27 '('"l.payload" '"p.event")) (lambda '($30) (Just (AsStruct '('"column0" (Unwrap (Concat (Concat (Member $30 '"p.event") (String '"-")) (Member $30 '"l.payload")))))))))
))) '('('"_logical_id" '1580)) '((DqSink '"0" (DataSink '"pq" $1) $17))))
(return '('() '((KqlExternalEffect $18))))
)
-------- block transformer end
2025-10-07T09:17:25.494011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1625 n: 0 (
(return '())
)
-------- block transformer block end
2025-10-07T09:17:25.494936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1625 n: 1 (
(let $1 '"/Root/pqSourceName")
(let $2 (DataSource '"pq" $1))
(let $3 '('('"PartitionsCount" '"1")))
(let $4 (DataType 'String))
(let $5 (OptionalType $4))
(let $6 (StructType '('"event" $5) '('"host" $5)))
(let $7 (PqTopic $1 '"local" '"inputTopicName" $3 '() $6))
(let $8 '('"SharedReading" '"0"))
(let $9 '('('"Endpoint" '"localhost:2893") $8 '('"ReconnectPeriod" '"") '('"Format" '"json_each_row") '('"ReadGroup" '"")))
(let $10 (DqPqTopicSource world $7 '('"event" '"host") $9 (SecureParam '"cluster:default_/Root/pqSourceName") '"" $6 '""))
(let $11 '"/Root/ydbSourceName")
(let $12 (DataSource '"generic" $11))
(let $13 (GenSourceSettings world $11 '"lookup" (SecureParam '"cluster:default_/Root/ydbSourceName") '('"fqdn" '"payload") (lambda '($19) (Bool '"true"))))
(let $14 (DqStage '((DqSource $12 $13)) (lambda '($20) (NarrowMap (ToFlow (WideFromBlocks (FromFlow (DqSourceWideBlockWrap $20 $12 (StructType '('"fqdn" $4) '('"payload" $4)))))) (lambda '($21 $22) (AsStruct '('"fqdn" $21) '('"payload" $22))))) '('('"_logical_id" '1409))))
(let $15 (DqCnBroadcast (TDqOutput $14 '"0")))
(let $16 (PqTopic $1 '"local" '"outputTopicName" $3 '() (StructType '('"Data" $4))))
(let $17 (DqPqTopicSink $16 '('('"Endpoint" '"localhost:2893")) (SecureParam '"cluster:default_/Root/pqSourceName")))
(let $18 (DqStage '((DqSource $2 $10) $15) (lambda '($23 $24) (block '(
  (let $25 '('('"format" '"json_each_row") '('"formatSettings" '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX"))) '('"settings" '($8))))
  (let $26 (DqSourceWideWrap $23 $2 $6 $25))
  (let $27 (DqPhyMapJoin (NarrowMap $26 (lambda '($28 $29) (AsStruct '('"event" $28) '('"host" $29)))) $24 '"p" '"l" 'Left '('('"p" '"host" '"l" '"fqdn")) '('"p.host") '('"l.fqdn")))
  (return (FlatMap (ExtractMembers $27 '('"l.payload" '"p.event")) (lambda '($30) (Just (AsStruct '('"column0" (Unwrap (Concat (Concat (Member $30 '"p.event") (String '"-")) (Member $30 '"l.payload")))))))))
))) '('('"_logical_id" '1580)) '((DqSink '"0" (DataSink '"pq" $1) $17))))
(return '((KqlExternalEffect $18)))
)
-------- block transformer block end
2025-10-07T09:17:25.494974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.495341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #1202
2025-10-07T09:17:25.495388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #1204, status: Async
2025-10-07T09:17:25.495450Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #1202
2025-10-07T09:17:25.495487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #1202
2025-10-07T09:17:25.495524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #1204
2025-10-07T09:17:25.495556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #1204, status: Ok
2025-10-07T09:17:25.495632Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Execution, code: 1060
2025-10-07T09:17:25.495669Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001
2025-10-07T09:17:25.495706Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Fatal: Execution, code: 1060
2025-10-07T09:17:25.495741Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1
2025-10-07T09:17:25.495815Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #1204, status: Error
2025-10-07T09:17:25.495872Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Warning: Execution, code: 1060
2025-10-07T09:17:25.495908Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001
2025-10-07T09:17:25.495944Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Fatal: Execution, code: 1060
2025-10-07T09:17:25.495979Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.495 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1
2025-10-07T09:17:25.496743Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, SessionId: CompileActor 2025-10-07 12:17:25.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:575: ---- Compilation failed: 0, self: [1:7558406477461361499:3005], status: INTERNAL_ERROR, issues: <main>: Warning: Execution, code: 1060
    <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001
<main>: Fatal: Execution, code: 1060
    <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1
2025-10-07T09:17:25.496962Z node 1 :KQP_SESSION WARN: kqp_session_actor.cpp:2408: SessionId: ydb://session/3?node_id=1&id=ZTQwZDg2NjctZGQ2OTBjNzctZGNmMDlmZjEtNzEzNWQwY2Y=, ActorId: [1:7558406477461361491:3001], ActorState: ExecuteState, TraceId: streaming-query-/Root/streamingQuery-c05729e0-a50ed2f-e744d8a7-b3ba1409-72057594046644480-17, ReplyQueryCompileError, status INTERNAL_ERROR remove tx with tx_id: 
2025-10-07T09:17:25.501331Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.501 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.501486Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.501 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361594:3036], cluster: db, database: /Root, text: "\n            -- TSaveScriptExecutionResultMetaQuery::OnRunQuery\n            DECLARE $database AS Text;\n            DECLARE $execution_id AS Text;\n            DECLARE $result_set_metas AS JsonDocument;\n            DECLARE $lease_generation AS Int64;\n\n            UPDATE `.metadata/script_executions`\n            SET result_set_metas = $result_set_metas\n            WHERE database = $database\n              AND execution_id = $execution_id\n              AND (lease_generation IS NULL OR lease_generation = $lease_generation);\n        ", startTime: 2025-10-07T09:17:25.501976Z
2025-10-07T09:17:25.512007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.511 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.512673Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.512 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 '('('filter (lambda '($2) (Coalesce (And (And (== (Member $2 '"database") $database) (== (Member $2 '"execution_id") $execution_id)) (Or (Not (Exists (Member $2 '"lease_generation"))) (== (Member $2 '"lease_generation") $lease_generation))) (Bool 'false)))) '('update (lambda '($3) (AsStruct '('result_set_metas $result_set_metas)))) '('mode 'update)))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) $1))
)
2025-10-07T09:17:25.513038Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.512 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 '('('filter (lambda '($2) (Coalesce (And (And (== (Member $2 '"database") $database) (== (Member $2 '"execution_id") $execution_id)) (Or (Not (Exists (Member $2 '"lease_generation"))) (== (Member $2 '"lease_generation") $lease_generation))) (Bool 'false)))) '('update (lambda '($3) (AsStruct '('result_set_metas $result_set_metas)))) '('mode 'update)))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) $1))
)
2025-10-07T09:17:25.523533Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.527146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.527636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"/Root/.metadata/script_executions")
(let $3 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiUpdateTable! world $1 $2 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (let $7 (Member $4 '"lease_generation"))
  (return (And (Coalesce (== (Member $4 '"database") $database) $6) (Coalesce (== (Member $4 '"execution_id") $execution_id) $6) (Or (Not (Exists $7)) (Coalesce (== $7 $lease_generation) $6))))
))) (lambda '($8) (AsStruct '('"result_set_metas" (Just $result_set_metas)))) '() 'false)) '('('"db" $2 '"Update")) '())) $3 (Void))) $1 $3))
)
2025-10-07T09:17:25.527678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #293
2025-10-07T09:17:25.527708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #293, status: Ok
2025-10-07T09:17:25.531076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.531737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 381 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $4 (KqlReadTableRanges $2 (Void) $3 '() '()))
(let $5 '('"result_set_metas" '"execution_id" '"database"))
(let $6 '('('"Mode" '"upsert") '('"IsUpdate") '('"IsConditionalUpdate")))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (Map (Filter $4 (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (Bool 'false))
  (let $10 (Member $7 '"lease_generation"))
  (return (And (Coalesce (== (Member $7 '"database") $database) $9) (Coalesce (== (Member $7 '"execution_id") $execution_id) $9) (Or (Not (Exists $10)) (Coalesce (== $10 $lease_generation) $9))))
)))) (lambda '($11) (AsStruct '('"result_set_metas" (Member (AsStruct '('"result_set_metas" (Just $result_set_metas))) '"result_set_metas")) '('"execution_id" (Member $11 '"execution_id")) '('"database" (Member $11 '"database"))))) '()) $5 '() 'false $6)))))
)
-------- block transformer end
2025-10-07T09:17:25.532367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 381 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $4 (KqlReadTableRanges $2 (Void) $3 '() '()))
(let $5 '('"result_set_metas" '"execution_id" '"database"))
(let $6 '('('"Mode" '"upsert") '('"IsUpdate") '('"IsConditionalUpdate")))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (Map (Filter $4 (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (Bool 'false))
  (let $10 (Member $7 '"lease_generation"))
  (return (And (Coalesce (== (Member $7 '"database") $database) $9) (Coalesce (== (Member $7 '"execution_id") $execution_id) $9) (Or (Not (Exists $10)) (Coalesce (== $10 $lease_generation) $9))))
)))) (lambda '($11) (AsStruct '('"result_set_metas" (Member (AsStruct '('"result_set_metas" (Just $result_set_metas))) '"result_set_metas")) '('"execution_id" (Member $11 '"execution_id")) '('"database" (Member $11 '"database"))))) '()) $5 '() 'false $6))))
)
-------- block transformer block end
2025-10-07T09:17:25.532402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.550567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.550 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.556236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.556 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:25.560297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:25.563702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:25.568153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.572823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:25.576040Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.576 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.581206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.587171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1351 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"database" '"execution_id" '"lease_generation"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database $execution_id))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($10) (FlatMap (ToFlow $10) (lambda '($11) (block '(
  (let $12 (Member $11 '"lease_generation"))
  (let $13 (AsStruct '('"database" (Member $11 '"database")) '('"execution_id" (Member $11 '"execution_id")) '('"result_set_metas" (Just $result_set_metas))))
  (return (OptionalIf (Or (Not (Exists $12)) (Coalesce (== $12 $lease_generation) (Bool 'false))) $13))
))))) '('('"_logical_id" '1259) '('"_partition_mode" '"single"))))
(let $7 (DqCnUnionAll (TDqOutput $6 '"0")))
(let $8 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $9 (DqStage '($7) (lambda '($14) $14) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $8))))
(return '('('() '((KqpSinkEffect $9 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:25.587658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1351 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"database" '"execution_id" '"lease_generation"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database $execution_id))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($10) (FlatMap (ToFlow $10) (lambda '($11) (block '(
  (let $12 (Member $11 '"lease_generation"))
  (let $13 (AsStruct '('"database" (Member $11 '"database")) '('"execution_id" (Member $11 '"execution_id")) '('"result_set_metas" (Just $result_set_metas))))
  (return (OptionalIf (Or (Not (Exists $12)) (Coalesce (== $12 $lease_generation) (Bool 'false))) $13))
))))) '('('"_logical_id" '1259) '('"_partition_mode" '"single"))))
(let $7 (DqCnUnionAll (TDqOutput $6 '"0")))
(let $8 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $9 (DqStage '($7) (lambda '($14) $14) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $8))))
(return '('() '((KqpSinkEffect $9 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:25.587693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.588724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.588 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 1352 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"database" '"execution_id" '"lease_generation"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database $execution_id))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($10) (FlatMap (ToFlow $10) (lambda '($11) (block '(
  (let $12 (Member $11 '"lease_generation"))
  (let $13 (AsStruct '('"database" (Member $11 '"database")) '('"execution_id" (Member $11 '"execution_id")) '('"result_set_metas" (Just $result_set_metas))))
  (return (OptionalIf (Or (Not (Exists $12)) (Coalesce (== $12 $lease_generation) (Bool 'false))) $13))
))))) '('('"_logical_id" '1259) '('"_partition_mode" '"single"))))
(let $7 (DqCnUnionAll (TDqOutput $6 '"0")))
(let $8 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $9 (DqStage '($7) (lambda '($14) $14) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $8))))
(return '('('() '((KqpSinkEffect $9 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:25.589192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.588 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 1352 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $lease_generation (DataType 'Int64))
(declare $result_set_metas (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"database" '"execution_id" '"lease_generation"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database $execution_id))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($10) (FlatMap (ToFlow $10) (lambda '($11) (block '(
  (let $12 (Member $11 '"lease_generation"))
  (let $13 (AsStruct '('"database" (Member $11 '"database")) '('"execution_id" (Member $11 '"execution_id")) '('"result_set_metas" (Just $result_set_metas))))
  (return (OptionalIf (Or (Not (Exists $12)) (Coalesce (== $12 $lease_generation) (Bool 'false))) $13))
))))) '('('"_logical_id" '1259) '('"_partition_mode" '"single"))))
(let $7 (DqCnUnionAll (TDqOutput $6 '"0")))
(let $8 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $9 (DqStage '($7) (lambda '($14) $14) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $8))))
(return '('() '((KqpSinkEffect $9 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:25.589229Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.592123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.592 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.592145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.592 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1259
2025-10-07T09:17:25.599276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.599 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.607197Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.607 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.608662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.607 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 (DataSource '"kikimr" '"db"))
(let $3 '"/Root/.metadata/script_executions")
(let $4 '"ast_compression_method")
(let $5 '"finalization_status")
(let $6 '"plan_compression_method")
(let $7 '"run_script_actor_id")
(let $8 '('"ast" '"ast_compressed" $4 '"database" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" $5 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $6 '"query_text" '"result_set_metas" $7 '"stats" '"syntax" '"transient_issues"))
(let $9 (DataType 'Utf8))
(let $10 $database)
(let $11 (Bool 'false))
(let $12 $execution_id)
(let $13 (Uint64 '"1001"))
(let $14 '($7 '"operation_status" '"execution_status" $5 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $6 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $4 '"has_graph"))
(let $15 '((Take (FlatMap (ExtractMembers (Right! (KiReadTable! world $2 (Key '('table (String $3))) (Void) '())) $8) (lambda '($31) (block '(
  (let $32 (Member $31 '"expire_at"))
  (let $33 (And (Coalesce (== (Member $31 '"database") $10) $11) (Coalesce (== (Member $31 '"execution_id") $12) $11) (Or (Coalesce (> $32 (CurrentUtcTimestamp)) $11) (Not (Exists $32)))))
  (let $34 (AsStruct '('"ast" (Member $31 '"ast")) '('"ast_compressed" (Member $31 '"ast_compressed")) '($4 (Member $31 $4)) '('"execution_mode" (Member $31 '"execution_mode")) '('"execution_status" (Member $31 '"execution_status")) '($5 (Member $31 $5)) '('"has_graph" (Exists (Member $31 '"graph_compressed"))) '('"issues" (Member $31 '"issues")) '('"operation_status" (Member $31 '"operation_status")) '('"plan" (Member $31 '"plan")) '('"plan_compressed" (Member $31 '"plan_compressed")) '($6 (Member $31 $6)) '('"query_text" (Member $31 '"query_text")) '('"result_set_metas" (Member $31 '"result_set_metas")) '($7 (Member $31 $7)) '('"stats" (Member $31 '"stats")) '('"syntax" (Member $31 '"syntax")) '('"transient_issues" (Member $31 '"transient_issues"))))
  (return (OptionalIf $33 $34))
)))) $13) $14 '"1000"))
(let $16 '"/Root/.metadata/script_execution_leases")
(let $17 '('"lease_deadline" '"lease_generation" '"lease_state"))
(let $18 '((Take (FlatMap (Right! (KiReadTable! world $2 (Key '('table (String $16))) (Void) '())) (lambda '($35) (block '(
  (let $36 (Member $35 '"expire_at"))
  (let $37 (And (Coalesce (== (Member $35 '"database") $10) $11) (Coalesce (== (Member $35 '"execution_id") $12) $11) (Or (Coalesce (> $36 (CurrentUtcTimestamp)) $11) (Not (Exists $36)))))
  (let $38 (AsStruct '('"lease_deadline" (Member $35 '"lease_deadline")) '('"lease_generation" (Member $35 '"lease_generation")) '('"lease_state" (Member $35 '"lease_state"))))
  (return (OptionalIf $37 $38))
)))) $13) $17 '"1000"))
(let $19 '('"db" $3 '"Select"))
(let $20 '('"db" $16 '"Select"))
(let $21 '('('"mode" '"flush")))
(let $22 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '($15 $18) (KiEffects) '($19 $20) '())) $21 (Void)))
(let $23 (DataSink 'result))
(let $24 (Right! $22))
(let $25 '('type))
(let $26 '('autoref))
(let $27 '($25 $26 '('columns $14)))
(let $28 (ResPull! (Left! $22) $23 (Key) (Nth $24 '0) $27 '"kikimr"))
(let $29 '($25 $26 '('columns $17)))
(let $30 (ResPull! (Commit! $28 $23) $23 (Key) (Nth $24 '1) $29 '"kikimr"))
(return (Commit! (Commit! $30 $23) $1 $21))
)
2025-10-07T09:17:25.608701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.608 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #2646
2025-10-07T09:17:25.608732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.608 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #2646, status: Ok
2025-10-07T09:17:25.612166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.612 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.613302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.612 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 2773 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(let $4 '"ast_compression_method")
(let $5 '"finalization_status")
(let $6 '"plan_compression_method")
(let $7 '"run_script_actor_id")
(let $8 '('"ast" '"ast_compressed" $4 '"database" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" $5 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $6 '"query_text" '"result_set_metas" $7 '"stats" '"syntax" '"transient_issues"))
(let $9 (DataType 'Utf8))
(let $10 $database)
(let $11 (Bool 'false))
(let $12 $execution_id)
(let $13 (Uint64 '"1001"))
(let $14 '($7 '"operation_status" '"execution_status" $5 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $6 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $4 '"has_graph"))
(let $15 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $16 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $17 (KqlReadTableRanges $15 (Void) $16 '() '()))
(let $18 '('"lease_deadline" '"lease_generation" '"lease_state"))
(return '('('('((Take (FlatMap (ExtractMembers $3 $8) (lambda '($19) (block '(
  (let $20 (Member $19 '"expire_at"))
  (let $21 (And (Coalesce (== (Member $19 '"database") $10) $11) (Coalesce (== (Member $19 '"execution_id") $12) $11) (Or (Coalesce (> $20 (CurrentUtcTimestamp)) $11) (Not (Exists $20)))))
  (let $22 (AsStruct '('"ast" (Member $19 '"ast")) '('"ast_compressed" (Member $19 '"ast_compressed")) '($4 (Member $19 $4)) '('"execution_mode" (Member $19 '"execution_mode")) '('"execution_status" (Member $19 '"execution_status")) '($5 (Member $19 $5)) '('"has_graph" (Exists (Member $19 '"graph_compressed"))) '('"issues" (Member $19 '"issues")) '('"operation_status" (Member $19 '"operation_status")) '('"plan" (Member $19 '"plan")) '('"plan_compressed" (Member $19 '"plan_compressed")) '($6 (Member $19 $6)) '('"query_text" (Member $19 '"query_text")) '('"result_set_metas" (Member $19 '"result_set_metas")) '($7 (Member $19 $7)) '('"stats" (Member $19 '"stats")) '('"syntax" (Member $19 '"syntax")) '('"transient_issues" (Member $19 '"transient_issues"))))
  (return (OptionalIf $21 $22))
)))) $13) $14) '((Take (FlatMap $17 (lambda '($23) (block '(
  (let $24 (Member $23 '"expire_at"))
  (let $25 (And (Coalesce (== (Member $23 '"database") $10) $11) (Coalesce (== (Member $23 '"execution_id") $12) $11) (Or (Coalesce (> $24 (CurrentUtcTimestamp)) $11) (Not (Exists $24)))))
  (let $26 (AsStruct '('"lease_deadline" (Member $23 '"lease_deadline")) '('"lease_generation" (Member $23 '"lease_generation")) '('"lease_state" (Member $23 '"lease_state"))))
  (return (OptionalIf $25 $26))
)))) $13) $18)) '())))
)
-------- block transformer end
2025-10-07T09:17:25.614389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.613 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 2773 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(let $4 '"ast_compression_method")
(let $5 '"finalization_status")
(let $6 '"plan_compression_method")
(let $7 '"run_script_actor_id")
(let $8 '('"ast" '"ast_compressed" $4 '"database" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" $5 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $6 '"query_text" '"result_set_metas" $7 '"stats" '"syntax" '"transient_issues"))
(let $9 (DataType 'Utf8))
(let $10 $database)
(let $11 (Bool 'false))
(let $12 $execution_id)
(let $13 (Uint64 '"1001"))
(let $14 '($7 '"operation_status" '"execution_status" $5 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $6 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $4 '"has_graph"))
(let $15 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $16 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $17 (KqlReadTableRanges $15 (Void) $16 '() '()))
(let $18 '('"lease_deadline" '"lease_generation" '"lease_state"))
(return '('('((Take (FlatMap (ExtractMembers $3 $8) (lambda '($19) (block '(
  (let $20 (Member $19 '"expire_at"))
  (let $21 (And (Coalesce (== (Member $19 '"database") $10) $11) (Coalesce (== (Member $19 '"execution_id") $12) $11) (Or (Coalesce (> $20 (CurrentUtcTimestamp)) $11) (Not (Exists $20)))))
  (let $22 (AsStruct '('"ast" (Member $19 '"ast")) '('"ast_compressed" (Member $19 '"ast_compressed")) '($4 (Member $19 $4)) '('"execution_mode" (Member $19 '"execution_mode")) '('"execution_status" (Member $19 '"execution_status")) '($5 (Member $19 $5)) '('"has_graph" (Exists (Member $19 '"graph_compressed"))) '('"issues" (Member $19 '"issues")) '('"operation_status" (Member $19 '"operation_status")) '('"plan" (Member $19 '"plan")) '('"plan_compressed" (Member $19 '"plan_compressed")) '($6 (Member $19 $6)) '('"query_text" (Member $19 '"query_text")) '('"result_set_metas" (Member $19 '"result_set_metas")) '($7 (Member $19 $7)) '('"stats" (Member $19 '"stats")) '('"syntax" (Member $19 '"syntax")) '('"transient_issues" (Member $19 '"transient_issues"))))
  (return (OptionalIf $21 $22))
)))) $13) $14) '((Take (FlatMap $17 (lambda '($23) (block '(
  (let $24 (Member $23 '"expire_at"))
  (let $25 (And (Coalesce (== (Member $23 '"database") $10) $11) (Coalesce (== (Member $23 '"execution_id") $12) $11) (Or (Coalesce (> $24 (CurrentUtcTimestamp)) $11) (Not (Exists $24)))))
  (let $26 (AsStruct '('"lease_deadline" (Member $23 '"lease_deadline")) '('"lease_generation" (Member $23 '"lease_generation")) '('"lease_state" (Member $23 '"lease_state"))))
  (return (OptionalIf $25 $26))
)))) $13) $18)) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.614423Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.614 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.633613Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.633 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.636700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:25.646424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #291
2025-10-07T09:17:25.646486Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #293, status: Async
2025-10-07T09:17:25.646688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #291
2025-10-07T09:17:25.646727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #291
2025-10-07T09:17:25.646764Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #293
2025-10-07T09:17:25.646795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #293, status: Ok
2025-10-07T09:17:25.646891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #291<KiExecDataQuery!> finished execution
2025-10-07T09:17:25.646927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #291<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:25.646962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #292<Left!> finished execution
2025-10-07T09:17:25.647008Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #293<Commit!> finished execution
2025-10-07T09:17:25.647046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #293<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.647078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #293, status: Ok
2025-10-07T09:17:25.647107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #293
2025-10-07T09:17:25.648020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5kx9j8yesjy6qhqt9w7, SessionId: CompileActor 2025-10-07 12:17:25.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361594:3036], duration: 0.146004s
2025-10-07T09:17:25.654224Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:25.654350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361629:3049], cluster: db, database: /Root, text: "\n            -- TSaveScriptFinalStatusActor::OnRunQuery\n            DECLARE $database AS Text;\n            DECLARE $execution_id AS Text;\n\n            SELECT\n                operation_status,\n                finalization_status,\n                meta,\n                customer_supplied_id,\n                user_token,\n                user_group_sids,\n                script_sinks,\n                script_secret_names,\n                retry_state,\n                graph_compressed\n            FROM `.metadata/script_executions`\n            WHERE database = $database AND execution_id = $execution_id AND\n                  (expire_at > CurrentUtcTimestamp() OR expire_at IS NULL);\n\n            SELECT\n                lease_generation,\n                lease_state\n            FROM `.metadata/script_execution_leases`\n            WHERE database = $database AND execution_id = $execution_id AND\n                  (expire_at > CurrentUtcTimestamp() OR expire_at IS NULL);\n        ", startTime: 2025-10-07T09:17:25.661266Z
2025-10-07T09:17:25.668377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.676742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.676 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:25.676969Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.676 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:25.677595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.677 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.679713Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.678 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 $database)
(let $4 $execution_id)
(let $5 (Filter (Right! $1) (lambda '($29) (Coalesce (And (And (== (Member $29 '"database") $3) (== (Member $29 '"execution_id") $4)) (Or (> (Member $29 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $29 '"expire_at"))))) (Bool 'false)))))
(let $6 (TypeOf $5))
(let $7 (SqlProjectItem $6 '"operation_status" (lambda '($30) (Member $30 '"operation_status"))))
(let $8 (SqlProjectItem $6 '"finalization_status" (lambda '($31) (Member $31 '"finalization_status"))))
(let $9 (SqlProjectItem $6 '"meta" (lambda '($32) (Member $32 '"meta"))))
(let $10 (SqlProjectItem $6 '"customer_supplied_id" (lambda '($33) (Member $33 '"customer_supplied_id"))))
(let $11 (SqlProjectItem $6 '"user_token" (lambda '($34) (Member $34 '"user_token"))))
(let $12 (SqlProjectItem $6 '"user_group_sids" (lambda '($35) (Member $35 '"user_group_sids"))))
(let $13 (SqlProjectItem $6 '"script_sinks" (lambda '($36) (Member $36 '"script_sinks"))))
(let $14 (SqlProjectItem $6 '"script_secret_names" (lambda '($37) (Member $37 '"script_secret_names"))))
(let $15 (SqlProjectItem $6 '"retry_state" (lambda '($38) (Member $38 '"retry_state"))))
(let $16 (SqlProjectItem $6 '"graph_compressed" (lambda '($39) (Member $39 '"graph_compressed"))))
(let $17 '($7 $8 $9 $10 $11 $12 $13 $14 $15 $16))
(let $18 '('"operation_status" '"finalization_status" '"meta" '"customer_supplied_id" '"user_token" '"user_group_sids" '"script_sinks" '"script_secret_names" '"retry_state" '"graph_compressed"))
(let $19 '('('type) '('autoref) '('columns $18)))
(let $20 (Write! (Left! $1) $2 (Key) (PersistableRepr (SqlProject $5 $17)) $19))
(let $21 (Read! (Commit! $20 $2) (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '()))
(let $22 (DataSink 'result))
(let $23 (Filter (Right! $21) (lambda '($40) (Coalesce (And (And (== (Member $40 '"database") $3) (== (Member $40 '"execution_id") $4)) (Or (> (Member $40 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $40 '"expire_at"))))) (Bool 'false)))))
(let $24 (TypeOf $23))
(let $25 (SqlProjectItem $24 '"lease_generation" (lambda '($41) (Member $41 '"lease_generation"))))
(let $26 (SqlProjectItem $24 '"lease_state" (lambda '($42) (Member $42 '"lease_state"))))
(let $27 '('('type) '('autoref) '('columns '('"lease_generation" '"lease_state"))))
(let $28 (Write! (Left! $21) $22 (Key) (PersistableRepr (SqlProject $23 '($25 $26))) $27))
(return (Commit! $28 $22))
)
2025-10-07T09:17:25.681007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 $database)
(let $4 $execution_id)
(let $5 (Filter (Right! $1) (lambda '($29) (Coalesce (And (And (== (Member $29 '"database") $3) (== (Member $29 '"execution_id") $4)) (Or (> (Member $29 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $29 '"expire_at"))))) (Bool 'false)))))
(let $6 (TypeOf $5))
(let $7 (SqlProjectItem $6 '"operation_status" (lambda '($30) (Member $30 '"operation_status"))))
(let $8 (SqlProjectItem $6 '"finalization_status" (lambda '($31) (Member $31 '"finalization_status"))))
(let $9 (SqlProjectItem $6 '"meta" (lambda '($32) (Member $32 '"meta"))))
(let $10 (SqlProjectItem $6 '"customer_supplied_id" (lambda '($33) (Member $33 '"customer_supplied_id"))))
(let $11 (SqlProjectItem $6 '"user_token" (lambda '($34) (Member $34 '"user_token"))))
(let $12 (SqlProjectItem $6 '"user_group_sids" (lambda '($35) (Member $35 '"user_group_sids"))))
(let $13 (SqlProjectItem $6 '"script_sinks" (lambda '($36) (Member $36 '"script_sinks"))))
(let $14 (SqlProjectItem $6 '"script_secret_names" (lambda '($37) (Member $37 '"script_secret_names"))))
(let $15 (SqlProjectItem $6 '"retry_state" (lambda '($38) (Member $38 '"retry_state"))))
(let $16 (SqlProjectItem $6 '"graph_compressed" (lambda '($39) (Member $39 '"graph_compressed"))))
(let $17 '($7 $8 $9 $10 $11 $12 $13 $14 $15 $16))
(let $18 '('"operation_status" '"finalization_status" '"meta" '"customer_supplied_id" '"user_token" '"user_group_sids" '"script_sinks" '"script_secret_names" '"retry_state" '"graph_compressed"))
(let $19 '('('type) '('autoref) '('columns $18)))
(let $20 (Write! (Left! $1) $2 (Key) (PersistableRepr (SqlProject $5 $17)) $19))
(let $21 (Read! (Commit! $20 $2) (DataSource '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '()))
(let $22 (DataSink 'result))
(let $23 (Filter (Right! $21) (lambda '($40) (Coalesce (And (And (== (Member $40 '"database") $3) (== (Member $40 '"execution_id") $4)) (Or (> (Member $40 '"expire_at") (CurrentUtcTimestamp)) (Not (Exists (Member $40 '"expire_at"))))) (Bool 'false)))))
(let $24 (TypeOf $23))
(let $25 (SqlProjectItem $24 '"lease_generation" (lambda '($41) (Member $41 '"lease_generation"))))
(let $26 (SqlProjectItem $24 '"lease_state" (lambda '($42) (Member $42 '"lease_state"))))
(let $27 '('('type) '('autoref) '('columns '('"lease_generation" '"lease_state"))))
(let $28 (Write! (Left! $21) $22 (Key) (PersistableRepr (SqlProject $23 '($25 $26))) $27))
(return (Commit! $28 $22))
)
2025-10-07T09:17:25.685267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.685 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.685435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.685 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.687207Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.687 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:25.687746Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.687 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:25.700100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.700568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.715795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.716363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.730701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.730 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.731046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.749679Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 4452 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"ast_compression_method")
(let $4 '"finalization_status")
(let $5 '"plan_compression_method")
(let $6 '"run_script_actor_id")
(let $7 '('"ast" '"ast_compressed" $3 '"execution_mode" '"execution_status" '"expire_at" $4 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $5 '"query_text" '"result_set_metas" $6 '"stats" '"syntax" '"transient_issues"))
(let $8 (DataType 'Utf8))
(let $9 (KqlKeyInc $database $execution_id))
(let $10 '($9 $9))
(let $11 (KqpRowsSourceSettings $2 $7 '() $10))
(let $12 (Bool 'false))
(let $13 (Uint64 '"1001"))
(let $14 '('"_partition_mode" '"single"))
(let $15 (DqStage '((DqSource $1 $11)) (lambda '($28) (Take (FlatMap (ToFlow $28) (lambda '($29) (block '(
  (let $30 (Member $29 '"expire_at"))
  (let $31 (AsStruct '('"ast" (Member $29 '"ast")) '('"ast_compressed" (Member $29 '"ast_compressed")) '($3 (Member $29 $3)) '('"execution_mode" (Member $29 '"execution_mode")) '('"execution_status" (Member $29 '"execution_status")) '($4 (Member $29 $4)) '('"has_graph" (Exists (Member $29 '"graph_compressed"))) '('"issues" (Member $29 '"issues")) '('"operation_status" (Member $29 '"operation_status")) '('"plan" (Member $29 '"plan")) '('"plan_compressed" (Member $29 '"plan_compressed")) '($5 (Member $29 $5)) '('"query_text" (Member $29 '"query_text")) '('"result_set_metas" (Member $29 '"result_set_metas")) '($6 (Member $29 $6)) '('"stats" (Member $29 '"stats")) '('"syntax" (Member $29 '"syntax")) '('"transient_issues" (Member $29 '"transient_issues"))))
  (return (OptionalIf (Or (Coalesce (> $30 (CurrentUtcTimestamp)) $12) (Not (Exists $30))) $31))
)))) $13)) '('('"_logical_id" '4317) $14)))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (DqStage '($16) (lambda '($32) (Take $32 $13)) '('('"_logical_id" '4330))))
(let $18 (DqCnUnionAll (TDqOutput $17 '"0")))
(let $19 '($6 '"operation_status" '"execution_status" $4 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $5 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $3 '"has_graph"))
(let $20 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $21 '('"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $22 (KqpRowsSourceSettings $20 $21 '() $10))
(let $23 (DqStage '((DqSource $1 $22)) (lambda '($33) (Take (FlatMap (ToFlow $33) (lambda '($34) (block '(
  (let $35 (Member $34 '"expire_at"))
  (let $36 (AsStruct '('"lease_deadline" (Member $34 '"lease_deadline")) '('"lease_generation" (Member $34 '"lease_generation")) '('"lease_state" (Member $34 '"lease_state"))))
  (return (OptionalIf (Or (Coalesce (> $35 (CurrentUtcTimestamp)) $12) (Not (Exists $35))) $36))
)))) $13)) '('('"_logical_id" '4349) $14)))
(let $24 (DqCnUnionAll (TDqOutput $23 '"0")))
(let $25 (DqStage '($24) (lambda '($37) (Take $37 $13)) '('('"_logical_id" '4362))))
(let $26 (DqCnUnionAll (TDqOutput $25 '"0")))
(let $27 '('"lease_deadline" '"lease_generation" '"lease_state"))
(return '('('('($18 $19) '($26 $27)) '())))
)
-------- block transformer end
2025-10-07T09:17:25.750788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.749 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 4452 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"ast_compression_method")
(let $4 '"finalization_status")
(let $5 '"plan_compression_method")
(let $6 '"run_script_actor_id")
(let $7 '('"ast" '"ast_compressed" $3 '"execution_mode" '"execution_status" '"expire_at" $4 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $5 '"query_text" '"result_set_metas" $6 '"stats" '"syntax" '"transient_issues"))
(let $8 (DataType 'Utf8))
(let $9 (KqlKeyInc $database $execution_id))
(let $10 '($9 $9))
(let $11 (KqpRowsSourceSettings $2 $7 '() $10))
(let $12 (Bool 'false))
(let $13 (Uint64 '"1001"))
(let $14 '('"_partition_mode" '"single"))
(let $15 (DqStage '((DqSource $1 $11)) (lambda '($28) (Take (FlatMap (ToFlow $28) (lambda '($29) (block '(
  (let $30 (Member $29 '"expire_at"))
  (let $31 (AsStruct '('"ast" (Member $29 '"ast")) '('"ast_compressed" (Member $29 '"ast_compressed")) '($3 (Member $29 $3)) '('"execution_mode" (Member $29 '"execution_mode")) '('"execution_status" (Member $29 '"execution_status")) '($4 (Member $29 $4)) '('"has_graph" (Exists (Member $29 '"graph_compressed"))) '('"issues" (Member $29 '"issues")) '('"operation_status" (Member $29 '"operation_status")) '('"plan" (Member $29 '"plan")) '('"plan_compressed" (Member $29 '"plan_compressed")) '($5 (Member $29 $5)) '('"query_text" (Member $29 '"query_text")) '('"result_set_metas" (Member $29 '"result_set_metas")) '($6 (Member $29 $6)) '('"stats" (Member $29 '"stats")) '('"syntax" (Member $29 '"syntax")) '('"transient_issues" (Member $29 '"transient_issues"))))
  (return (OptionalIf (Or (Coalesce (> $30 (CurrentUtcTimestamp)) $12) (Not (Exists $30))) $31))
)))) $13)) '('('"_logical_id" '4317) $14)))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (DqStage '($16) (lambda '($32) (Take $32 $13)) '('('"_logical_id" '4330))))
(let $18 (DqCnUnionAll (TDqOutput $17 '"0")))
(let $19 '($6 '"operation_status" '"execution_status" $4 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $5 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $3 '"has_graph"))
(let $20 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $21 '('"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $22 (KqpRowsSourceSettings $20 $21 '() $10))
(let $23 (DqStage '((DqSource $1 $22)) (lambda '($33) (Take (FlatMap (ToFlow $33) (lambda '($34) (block '(
  (let $35 (Member $34 '"expire_at"))
  (let $36 (AsStruct '('"lease_deadline" (Member $34 '"lease_deadline")) '('"lease_generation" (Member $34 '"lease_generation")) '('"lease_state" (Member $34 '"lease_state"))))
  (return (OptionalIf (Or (Coalesce (> $35 (CurrentUtcTimestamp)) $12) (Not (Exists $35))) $36))
)))) $13)) '('('"_logical_id" '4349) $14)))
(let $24 (DqCnUnionAll (TDqOutput $23 '"0")))
(let $25 (DqStage '($24) (lambda '($37) (Take $37 $13)) '('('"_logical_id" '4362))))
(let $26 (DqCnUnionAll (TDqOutput $25 '"0")))
(let $27 '('"lease_deadline" '"lease_generation" '"lease_state"))
(return '('('($18 $19) '($26 $27)) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.750822Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.752781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.752 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.753631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.752 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 4453 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"ast_compression_method")
(let $4 '"finalization_status")
(let $5 '"plan_compression_method")
(let $6 '"run_script_actor_id")
(let $7 '('"ast" '"ast_compressed" $3 '"execution_mode" '"execution_status" '"expire_at" $4 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $5 '"query_text" '"result_set_metas" $6 '"stats" '"syntax" '"transient_issues"))
(let $8 (DataType 'Utf8))
(let $9 (KqlKeyInc $database $execution_id))
(let $10 '($9 $9))
(let $11 (KqpRowsSourceSettings $2 $7 '() $10))
(let $12 (Bool 'false))
(let $13 (Uint64 '"1001"))
(let $14 '('"_partition_mode" '"single"))
(let $15 (DqStage '((DqSource $1 $11)) (lambda '($28) (Take (FlatMap (ToFlow $28) (lambda '($29) (block '(
  (let $30 (Member $29 '"expire_at"))
  (let $31 (AsStruct '('"ast" (Member $29 '"ast")) '('"ast_compressed" (Member $29 '"ast_compressed")) '($3 (Member $29 $3)) '('"execution_mode" (Member $29 '"execution_mode")) '('"execution_status" (Member $29 '"execution_status")) '($4 (Member $29 $4)) '('"has_graph" (Exists (Member $29 '"graph_compressed"))) '('"issues" (Member $29 '"issues")) '('"operation_status" (Member $29 '"operation_status")) '('"plan" (Member $29 '"plan")) '('"plan_compressed" (Member $29 '"plan_compressed")) '($5 (Member $29 $5)) '('"query_text" (Member $29 '"query_text")) '('"result_set_metas" (Member $29 '"result_set_metas")) '($6 (Member $29 $6)) '('"stats" (Member $29 '"stats")) '('"syntax" (Member $29 '"syntax")) '('"transient_issues" (Member $29 '"transient_issues"))))
  (return (OptionalIf (Or (Coalesce (> $30 (CurrentUtcTimestamp)) $12) (Not (Exists $30))) $31))
)))) $13)) '('('"_logical_id" '4317) $14)))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (DqStage '($16) (lambda '($32) (Take $32 $13)) '('('"_logical_id" '4330))))
(let $18 (DqCnUnionAll (TDqOutput $17 '"0")))
(let $19 '($6 '"operation_status" '"execution_status" $4 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $5 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $3 '"has_graph"))
(let $20 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $21 '('"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $22 (KqpRowsSourceSettings $20 $21 '() $10))
(let $23 (DqStage '((DqSource $1 $22)) (lambda '($33) (Take (FlatMap (ToFlow $33) (lambda '($34) (block '(
  (let $35 (Member $34 '"expire_at"))
  (let $36 (AsStruct '('"lease_deadline" (Member $34 '"lease_deadline")) '('"lease_generation" (Member $34 '"lease_generation")) '('"lease_state" (Member $34 '"lease_state"))))
  (return (OptionalIf (Or (Coalesce (> $35 (CurrentUtcTimestamp)) $12) (Not (Exists $35))) $36))
)))) $13)) '('('"_logical_id" '4349) $14)))
(let $24 (DqCnUnionAll (TDqOutput $23 '"0")))
(let $25 (DqStage '($24) (lambda '($37) (Take $37 $13)) '('('"_logical_id" '4362))))
(let $26 (DqCnUnionAll (TDqOutput $25 '"0")))
(let $27 '('"lease_deadline" '"lease_generation" '"lease_state"))
(return '('('('($18 $19) '($26 $27)) '())))
)
-------- block transformer end
2025-10-07T09:17:25.754695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.753 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 4453 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"ast_compression_method")
(let $4 '"finalization_status")
(let $5 '"plan_compression_method")
(let $6 '"run_script_actor_id")
(let $7 '('"ast" '"ast_compressed" $3 '"execution_mode" '"execution_status" '"expire_at" $4 '"graph_compressed" '"issues" '"operation_status" '"plan" '"plan_compressed" $5 '"query_text" '"result_set_metas" $6 '"stats" '"syntax" '"transient_issues"))
(let $8 (DataType 'Utf8))
(let $9 (KqlKeyInc $database $execution_id))
(let $10 '($9 $9))
(let $11 (KqpRowsSourceSettings $2 $7 '() $10))
(let $12 (Bool 'false))
(let $13 (Uint64 '"1001"))
(let $14 '('"_partition_mode" '"single"))
(let $15 (DqStage '((DqSource $1 $11)) (lambda '($28) (Take (FlatMap (ToFlow $28) (lambda '($29) (block '(
  (let $30 (Member $29 '"expire_at"))
  (let $31 (AsStruct '('"ast" (Member $29 '"ast")) '('"ast_compressed" (Member $29 '"ast_compressed")) '($3 (Member $29 $3)) '('"execution_mode" (Member $29 '"execution_mode")) '('"execution_status" (Member $29 '"execution_status")) '($4 (Member $29 $4)) '('"has_graph" (Exists (Member $29 '"graph_compressed"))) '('"issues" (Member $29 '"issues")) '('"operation_status" (Member $29 '"operation_status")) '('"plan" (Member $29 '"plan")) '('"plan_compressed" (Member $29 '"plan_compressed")) '($5 (Member $29 $5)) '('"query_text" (Member $29 '"query_text")) '('"result_set_metas" (Member $29 '"result_set_metas")) '($6 (Member $29 $6)) '('"stats" (Member $29 '"stats")) '('"syntax" (Member $29 '"syntax")) '('"transient_issues" (Member $29 '"transient_issues"))))
  (return (OptionalIf (Or (Coalesce (> $30 (CurrentUtcTimestamp)) $12) (Not (Exists $30))) $31))
)))) $13)) '('('"_logical_id" '4317) $14)))
(let $16 (DqCnUnionAll (TDqOutput $15 '"0")))
(let $17 (DqStage '($16) (lambda '($32) (Take $32 $13)) '('('"_logical_id" '4330))))
(let $18 (DqCnUnionAll (TDqOutput $17 '"0")))
(let $19 '($6 '"operation_status" '"execution_status" $4 '"query_text" '"syntax" '"execution_mode" '"result_set_metas" '"plan" '"plan_compressed" $5 '"issues" '"transient_issues" '"stats" '"ast" '"ast_compressed" $3 '"has_graph"))
(let $20 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $21 '('"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $22 (KqpRowsSourceSettings $20 $21 '() $10))
(let $23 (DqStage '((DqSource $1 $22)) (lambda '($33) (Take (FlatMap (ToFlow $33) (lambda '($34) (block '(
  (let $35 (Member $34 '"expire_at"))
  (let $36 (AsStruct '('"lease_deadline" (Member $34 '"lease_deadline")) '('"lease_generation" (Member $34 '"lease_generation")) '('"lease_state" (Member $34 '"lease_state"))))
  (return (OptionalIf (Or (Coalesce (> $35 (CurrentUtcTimestamp)) $12) (Not (Exists $35))) $36))
)))) $13)) '('('"_logical_id" '4349) $14)))
(let $24 (DqCnUnionAll (TDqOutput $23 '"0")))
(let $25 (DqStage '($24) (lambda '($37) (Take $37 $13)) '('('"_logical_id" '4362))))
(let $26 (DqCnUnionAll (TDqOutput $25 '"0")))
(let $27 '('"lease_deadline" '"lease_generation" '"lease_state"))
(return '('('($18 $19) '($26 $27)) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.754729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.754 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.761094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 4317
2025-10-07T09:17:25.761494Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 4349
2025-10-07T09:17:25.763550Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.763 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.769977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.777000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.776 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.778304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.777 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 (DataSource '"kikimr" '"db"))
(let $3 '"/Root/.metadata/script_executions")
(let $4 '"customer_supplied_id")
(let $5 '"finalization_status")
(let $6 '"script_secret_names")
(let $7 '($4 '"database" '"execution_id" '"expire_at" $5 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $6 '"script_sinks" '"user_group_sids" '"user_token"))
(let $8 (DataType 'Utf8))
(let $9 $database)
(let $10 (Bool 'false))
(let $11 $execution_id)
(let $12 (Uint64 '"1001"))
(let $13 '('"operation_status" $5 '"meta" $4 '"user_token" '"user_group_sids" '"script_sinks" $6 '"retry_state" '"graph_compressed"))
(let $14 '((Take (FlatMap (ExtractMembers (Right! (KiReadTable! world $2 (Key '('table (String $3))) (Void) '())) $7) (lambda '($31) (block '(
  (let $32 (Member $31 '"expire_at"))
  (let $33 (And (Coalesce (== (Member $31 '"database") $9) $10) (Coalesce (== (Member $31 '"execution_id") $11) $10) (Or (Coalesce (> $32 (CurrentUtcTimestamp)) $10) (Not (Exists $32)))))
  (let $34 (AsStruct '($4 (Member $31 $4)) '($5 (Member $31 $5)) '('"graph_compressed" (Member $31 '"graph_compressed")) '('"meta" (Member $31 '"meta")) '('"operation_status" (Member $31 '"operation_status")) '('"retry_state" (Member $31 '"retry_state")) '($6 (Member $31 $6)) '('"script_sinks" (Member $31 '"script_sinks")) '('"user_group_sids" (Member $31 '"user_group_sids")) '('"user_token" (Member $31 '"user_token"))))
  (return (OptionalIf $33 $34))
)))) $12) $13 '"1000"))
(let $15 '"/Root/.metadata/script_execution_leases")
(let $16 '('"database" '"execution_id" '"expire_at" '"lease_generation" '"lease_state"))
(let $17 '('"lease_generation" '"lease_state"))
(let $18 '((Take (FlatMap (ExtractMembers (Right! (KiReadTable! world $2 (Key '('table (String $15))) (Void) '())) $16) (lambda '($35) (block '(
  (let $36 (Member $35 '"expire_at"))
  (let $37 (And (Coalesce (== (Member $35 '"database") $9) $10) (Coalesce (== (Member $35 '"execution_id") $11) $10) (Or (Coalesce (> $36 (CurrentUtcTimestamp)) $10) (Not (Exists $36)))))
  (return (OptionalIf $37 (AsStruct '('"lease_generation" (Member $35 '"lease_generation")) '('"lease_state" (Member $35 '"lease_state")))))
)))) $12) $17 '"1000"))
(let $19 '('"db" $3 '"Select"))
(let $20 '('"db" $15 '"Select"))
(let $21 '('('"mode" '"flush")))
(let $22 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '($14 $18) (KiEffects) '($19 $20) '())) $21 (Void)))
(let $23 (DataSink 'result))
(let $24 (Right! $22))
(let $25 '('type))
(let $26 '('autoref))
(let $27 '($25 $26 '('columns $13)))
(let $28 (ResPull! (Left! $22) $23 (Key) (Nth $24 '0) $27 '"kikimr"))
(let $29 '($25 $26 '('columns $17)))
(let $30 (ResPull! (Commit! $28 $23) $23 (Key) (Nth $24 '1) $29 '"kikimr"))
(return (Commit! (Commit! $30 $23) $1 $21))
)
2025-10-07T09:17:25.778345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.778 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #2125
2025-10-07T09:17:25.778378Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.778 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #2125, status: Ok
2025-10-07T09:17:25.781904Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.781 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.782880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.781 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 2253 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(let $4 '"customer_supplied_id")
(let $5 '"finalization_status")
(let $6 '"script_secret_names")
(let $7 '($4 '"database" '"execution_id" '"expire_at" $5 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $6 '"script_sinks" '"user_group_sids" '"user_token"))
(let $8 (DataType 'Utf8))
(let $9 $database)
(let $10 (Bool 'false))
(let $11 $execution_id)
(let $12 (Uint64 '"1001"))
(let $13 '('"operation_status" $5 '"meta" $4 '"user_token" '"user_group_sids" '"script_sinks" $6 '"retry_state" '"graph_compressed"))
(let $14 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $15 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $16 (KqlReadTableRanges $14 (Void) $15 '() '()))
(let $17 '('"database" '"execution_id" '"expire_at" '"lease_generation" '"lease_state"))
(return '('('('((Take (FlatMap (ExtractMembers $3 $7) (lambda '($18) (block '(
  (let $19 (Member $18 '"expire_at"))
  (let $20 (And (Coalesce (== (Member $18 '"database") $9) $10) (Coalesce (== (Member $18 '"execution_id") $11) $10) (Or (Coalesce (> $19 (CurrentUtcTimestamp)) $10) (Not (Exists $19)))))
  (let $21 (AsStruct '($4 (Member $18 $4)) '($5 (Member $18 $5)) '('"graph_compressed" (Member $18 '"graph_compressed")) '('"meta" (Member $18 '"meta")) '('"operation_status" (Member $18 '"operation_status")) '('"retry_state" (Member $18 '"retry_state")) '($6 (Member $18 $6)) '('"script_sinks" (Member $18 '"script_sinks")) '('"user_group_sids" (Member $18 '"user_group_sids")) '('"user_token" (Member $18 '"user_token"))))
  (return (OptionalIf $20 $21))
)))) $12) $13) '((Take (FlatMap (ExtractMembers $16 $17) (lambda '($22) (block '(
  (let $23 (Member $22 '"expire_at"))
  (let $24 (And (Coalesce (== (Member $22 '"database") $9) $10) (Coalesce (== (Member $22 '"execution_id") $11) $10) (Or (Coalesce (> $23 (CurrentUtcTimestamp)) $10) (Not (Exists $23)))))
  (return (OptionalIf $24 (AsStruct '('"lease_generation" (Member $22 '"lease_generation")) '('"lease_state" (Member $22 '"lease_state")))))
)))) $12) '('"lease_generation" '"lease_state"))) '())))
)
-------- block transformer end
2025-10-07T09:17:25.783804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 2253 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(let $4 '"customer_supplied_id")
(let $5 '"finalization_status")
(let $6 '"script_secret_names")
(let $7 '($4 '"database" '"execution_id" '"expire_at" $5 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $6 '"script_sinks" '"user_group_sids" '"user_token"))
(let $8 (DataType 'Utf8))
(let $9 $database)
(let $10 (Bool 'false))
(let $11 $execution_id)
(let $12 (Uint64 '"1001"))
(let $13 '('"operation_status" $5 '"meta" $4 '"user_token" '"user_group_sids" '"script_sinks" $6 '"retry_state" '"graph_compressed"))
(let $14 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $15 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $16 (KqlReadTableRanges $14 (Void) $15 '() '()))
(let $17 '('"database" '"execution_id" '"expire_at" '"lease_generation" '"lease_state"))
(return '('('((Take (FlatMap (ExtractMembers $3 $7) (lambda '($18) (block '(
  (let $19 (Member $18 '"expire_at"))
  (let $20 (And (Coalesce (== (Member $18 '"database") $9) $10) (Coalesce (== (Member $18 '"execution_id") $11) $10) (Or (Coalesce (> $19 (CurrentUtcTimestamp)) $10) (Not (Exists $19)))))
  (let $21 (AsStruct '($4 (Member $18 $4)) '($5 (Member $18 $5)) '('"graph_compressed" (Member $18 '"graph_compressed")) '('"meta" (Member $18 '"meta")) '('"operation_status" (Member $18 '"operation_status")) '('"retry_state" (Member $18 '"retry_state")) '($6 (Member $18 $6)) '('"script_sinks" (Member $18 '"script_sinks")) '('"user_group_sids" (Member $18 '"user_group_sids")) '('"user_token" (Member $18 '"user_token"))))
  (return (OptionalIf $20 $21))
)))) $12) $13) '((Take (FlatMap (ExtractMembers $16 $17) (lambda '($22) (block '(
  (let $23 (Member $22 '"expire_at"))
  (let $24 (And (Coalesce (== (Member $22 '"database") $9) $10) (Coalesce (== (Member $22 '"execution_id") $11) $10) (Or (Coalesce (> $23 (CurrentUtcTimestamp)) $10) (Not (Exists $23)))))
  (return (OptionalIf $24 (AsStruct '('"lease_generation" (Member $22 '"lease_generation")) '('"lease_state" (Member $22 '"lease_state")))))
)))) $12) '('"lease_generation" '"lease_state"))) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.783837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.783 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.798764Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.799113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.809488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.809 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:25.812177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.812 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:25.824285Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.824518Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:25.830741Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:25.830925Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:25.837947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:25.838387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.838 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:25.846950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.846 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.847394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:25.857953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.857 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.858516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.858 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.869141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.869480Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.884758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 3758 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"customer_supplied_id")
(let $4 '"finalization_status")
(let $5 '"script_secret_names")
(let $6 '($3 '"expire_at" $4 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $5 '"script_sinks" '"user_group_sids" '"user_token"))
(let $7 (DataType 'Utf8))
(let $8 (KqlKeyInc $database $execution_id))
(let $9 '($8 $8))
(let $10 (KqpRowsSourceSettings $2 $6 '() $9))
(let $11 (Bool 'false))
(let $12 (Uint64 '"1001"))
(let $13 '('"_partition_mode" '"single"))
(let $14 (DqStage '((DqSource $1 $10)) (lambda '($26) (Take (FlatMap (ToFlow $26) (lambda '($27) (block '(
  (let $28 (Member $27 '"expire_at"))
  (let $29 (AsStruct '($3 (Member $27 $3)) '($4 (Member $27 $4)) '('"graph_compressed" (Member $27 '"graph_compressed")) '('"meta" (Member $27 '"meta")) '('"operation_status" (Member $27 '"operation_status")) '('"retry_state" (Member $27 '"retry_state")) '($5 (Member $27 $5)) '('"script_sinks" (Member $27 '"script_sinks")) '('"user_group_sids" (Member $27 '"user_group_sids")) '('"user_token" (Member $27 '"user_token"))))
  (return (OptionalIf (Or (Coalesce (> $28 (CurrentUtcTimestamp)) $11) (Not (Exists $28))) $29))
)))) $12)) '('('"_logical_id" '3623) $13)))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 (DqStage '($15) (lambda '($30) (Take $30 $12)) '('('"_logical_id" '3636))))
(let $17 (DqCnUnionAll (TDqOutput $16 '"0")))
(let $18 '('"operation_status" $4 '"meta" $3 '"user_token" '"user_group_sids" '"script_sinks" $5 '"retry_state" '"graph_compressed"))
(let $19 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $20 '('"expire_at" '"lease_generation" '"lease_state"))
(let $21 (KqpRowsSourceSettings $19 $20 '() $9))
(let $22 (DqStage '((DqSource $1 $21)) (lambda '($31) (Take (FlatMap (ToFlow $31) (lambda '($32) (block '(
  (let $33 (Member $32 '"expire_at"))
  (return (OptionalIf (Or (Coalesce (> $33 (CurrentUtcTimestamp)) $11) (Not (Exists $33))) (AsStruct '('"lease_generation" (Member $32 '"lease_generation")) '('"lease_state" (Member $32 '"lease_state")))))
)))) $12)) '('('"_logical_id" '3655) $13)))
(let $23 (DqCnUnionAll (TDqOutput $22 '"0")))
(let $24 (DqStage '($23) (lambda '($34) (Take $34 $12)) '('('"_logical_id" '3668))))
(let $25 (DqCnUnionAll (TDqOutput $24 '"0")))
(return '('('('($17 $18) '($25 '('"lease_generation" '"lease_state"))) '())))
)
-------- block transformer end
2025-10-07T09:17:25.885649Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 3758 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"customer_supplied_id")
(let $4 '"finalization_status")
(let $5 '"script_secret_names")
(let $6 '($3 '"expire_at" $4 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $5 '"script_sinks" '"user_group_sids" '"user_token"))
(let $7 (DataType 'Utf8))
(let $8 (KqlKeyInc $database $execution_id))
(let $9 '($8 $8))
(let $10 (KqpRowsSourceSettings $2 $6 '() $9))
(let $11 (Bool 'false))
(let $12 (Uint64 '"1001"))
(let $13 '('"_partition_mode" '"single"))
(let $14 (DqStage '((DqSource $1 $10)) (lambda '($26) (Take (FlatMap (ToFlow $26) (lambda '($27) (block '(
  (let $28 (Member $27 '"expire_at"))
  (let $29 (AsStruct '($3 (Member $27 $3)) '($4 (Member $27 $4)) '('"graph_compressed" (Member $27 '"graph_compressed")) '('"meta" (Member $27 '"meta")) '('"operation_status" (Member $27 '"operation_status")) '('"retry_state" (Member $27 '"retry_state")) '($5 (Member $27 $5)) '('"script_sinks" (Member $27 '"script_sinks")) '('"user_group_sids" (Member $27 '"user_group_sids")) '('"user_token" (Member $27 '"user_token"))))
  (return (OptionalIf (Or (Coalesce (> $28 (CurrentUtcTimestamp)) $11) (Not (Exists $28))) $29))
)))) $12)) '('('"_logical_id" '3623) $13)))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 (DqStage '($15) (lambda '($30) (Take $30 $12)) '('('"_logical_id" '3636))))
(let $17 (DqCnUnionAll (TDqOutput $16 '"0")))
(let $18 '('"operation_status" $4 '"meta" $3 '"user_token" '"user_group_sids" '"script_sinks" $5 '"retry_state" '"graph_compressed"))
(let $19 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $20 '('"expire_at" '"lease_generation" '"lease_state"))
(let $21 (KqpRowsSourceSettings $19 $20 '() $9))
(let $22 (DqStage '((DqSource $1 $21)) (lambda '($31) (Take (FlatMap (ToFlow $31) (lambda '($32) (block '(
  (let $33 (Member $32 '"expire_at"))
  (return (OptionalIf (Or (Coalesce (> $33 (CurrentUtcTimestamp)) $11) (Not (Exists $33))) (AsStruct '('"lease_generation" (Member $32 '"lease_generation")) '('"lease_state" (Member $32 '"lease_state")))))
)))) $12)) '('('"_logical_id" '3655) $13)))
(let $23 (DqCnUnionAll (TDqOutput $22 '"0")))
(let $24 (DqStage '($23) (lambda '($34) (Take $34 $12)) '('('"_logical_id" '3668))))
(let $25 (DqCnUnionAll (TDqOutput $24 '"0")))
(return '('('($17 $18) '($25 '('"lease_generation" '"lease_state"))) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.885683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.888181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 3759 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"customer_supplied_id")
(let $4 '"finalization_status")
(let $5 '"script_secret_names")
(let $6 '($3 '"expire_at" $4 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $5 '"script_sinks" '"user_group_sids" '"user_token"))
(let $7 (DataType 'Utf8))
(let $8 (KqlKeyInc $database $execution_id))
(let $9 '($8 $8))
(let $10 (KqpRowsSourceSettings $2 $6 '() $9))
(let $11 (Bool 'false))
(let $12 (Uint64 '"1001"))
(let $13 '('"_partition_mode" '"single"))
(let $14 (DqStage '((DqSource $1 $10)) (lambda '($26) (Take (FlatMap (ToFlow $26) (lambda '($27) (block '(
  (let $28 (Member $27 '"expire_at"))
  (let $29 (AsStruct '($3 (Member $27 $3)) '($4 (Member $27 $4)) '('"graph_compressed" (Member $27 '"graph_compressed")) '('"meta" (Member $27 '"meta")) '('"operation_status" (Member $27 '"operation_status")) '('"retry_state" (Member $27 '"retry_state")) '($5 (Member $27 $5)) '('"script_sinks" (Member $27 '"script_sinks")) '('"user_group_sids" (Member $27 '"user_group_sids")) '('"user_token" (Member $27 '"user_token"))))
  (return (OptionalIf (Or (Coalesce (> $28 (CurrentUtcTimestamp)) $11) (Not (Exists $28))) $29))
)))) $12)) '('('"_logical_id" '3623) $13)))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 (DqStage '($15) (lambda '($30) (Take $30 $12)) '('('"_logical_id" '3636))))
(let $17 (DqCnUnionAll (TDqOutput $16 '"0")))
(let $18 '('"operation_status" $4 '"meta" $3 '"user_token" '"user_group_sids" '"script_sinks" $5 '"retry_state" '"graph_compressed"))
(let $19 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $20 '('"expire_at" '"lease_generation" '"lease_state"))
(let $21 (KqpRowsSourceSettings $19 $20 '() $9))
(let $22 (DqStage '((DqSource $1 $21)) (lambda '($31) (Take (FlatMap (ToFlow $31) (lambda '($32) (block '(
  (let $33 (Member $32 '"expire_at"))
  (return (OptionalIf (Or (Coalesce (> $33 (CurrentUtcTimestamp)) $11) (Not (Exists $33))) (AsStruct '('"lease_generation" (Member $32 '"lease_generation")) '('"lease_state" (Member $32 '"lease_state")))))
)))) $12)) '('('"_logical_id" '3655) $13)))
(let $23 (DqCnUnionAll (TDqOutput $22 '"0")))
(let $24 (DqStage '($23) (lambda '($34) (Take $34 $12)) '('('"_logical_id" '3668))))
(let $25 (DqCnUnionAll (TDqOutput $24 '"0")))
(return '('('('($17 $18) '($25 '('"lease_generation" '"lease_state"))) '())))
)
-------- block transformer end
2025-10-07T09:17:25.889084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.888 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 3759 n: 0 (
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(let $1 (DataSource '"KqpReadRangesSource"))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '"customer_supplied_id")
(let $4 '"finalization_status")
(let $5 '"script_secret_names")
(let $6 '($3 '"expire_at" $4 '"graph_compressed" '"meta" '"operation_status" '"retry_state" $5 '"script_sinks" '"user_group_sids" '"user_token"))
(let $7 (DataType 'Utf8))
(let $8 (KqlKeyInc $database $execution_id))
(let $9 '($8 $8))
(let $10 (KqpRowsSourceSettings $2 $6 '() $9))
(let $11 (Bool 'false))
(let $12 (Uint64 '"1001"))
(let $13 '('"_partition_mode" '"single"))
(let $14 (DqStage '((DqSource $1 $10)) (lambda '($26) (Take (FlatMap (ToFlow $26) (lambda '($27) (block '(
  (let $28 (Member $27 '"expire_at"))
  (let $29 (AsStruct '($3 (Member $27 $3)) '($4 (Member $27 $4)) '('"graph_compressed" (Member $27 '"graph_compressed")) '('"meta" (Member $27 '"meta")) '('"operation_status" (Member $27 '"operation_status")) '('"retry_state" (Member $27 '"retry_state")) '($5 (Member $27 $5)) '('"script_sinks" (Member $27 '"script_sinks")) '('"user_group_sids" (Member $27 '"user_group_sids")) '('"user_token" (Member $27 '"user_token"))))
  (return (OptionalIf (Or (Coalesce (> $28 (CurrentUtcTimestamp)) $11) (Not (Exists $28))) $29))
)))) $12)) '('('"_logical_id" '3623) $13)))
(let $15 (DqCnUnionAll (TDqOutput $14 '"0")))
(let $16 (DqStage '($15) (lambda '($30) (Take $30 $12)) '('('"_logical_id" '3636))))
(let $17 (DqCnUnionAll (TDqOutput $16 '"0")))
(let $18 '('"operation_status" $4 '"meta" $3 '"user_token" '"user_group_sids" '"script_sinks" $5 '"retry_state" '"graph_compressed"))
(let $19 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $20 '('"expire_at" '"lease_generation" '"lease_state"))
(let $21 (KqpRowsSourceSettings $19 $20 '() $9))
(let $22 (DqStage '((DqSource $1 $21)) (lambda '($31) (Take (FlatMap (ToFlow $31) (lambda '($32) (block '(
  (let $33 (Member $32 '"expire_at"))
  (return (OptionalIf (Or (Coalesce (> $33 (CurrentUtcTimestamp)) $11) (Not (Exists $33))) (AsStruct '('"lease_generation" (Member $32 '"lease_generation")) '('"lease_state" (Member $32 '"lease_state")))))
)))) $12)) '('('"_logical_id" '3655) $13)))
(let $23 (DqCnUnionAll (TDqOutput $22 '"0")))
(let $24 (DqStage '($23) (lambda '($34) (Take $34 $12)) '('('"_logical_id" '3668))))
(let $25 (DqCnUnionAll (TDqOutput $24 '"0")))
(return '('('($17 $18) '($25 '('"lease_generation" '"lease_state"))) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.889119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.889 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.894658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.894 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 3623
2025-10-07T09:17:25.895020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:25.894 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 3655
2025-10-07T09:17:25.931487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #2630
2025-10-07T09:17:25.931557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2639<Nth> finished execution
2025-10-07T09:17:25.931596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2639<Nth> created 0 trackable nodes: 
2025-10-07T09:17:25.931643Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2643<Nth> finished execution
2025-10-07T09:17:25.931680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2643<Nth> created 0 trackable nodes: 
2025-10-07T09:17:25.931718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #2646, status: Async
2025-10-07T09:17:25.932151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #2630
2025-10-07T09:17:25.932189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #2630
2025-10-07T09:17:25.932224Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #2646
2025-10-07T09:17:25.932260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #2646, status: Ok
2025-10-07T09:17:25.932400Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2630<KiExecDataQuery!> finished execution
2025-10-07T09:17:25.932435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2630<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:25.932469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2637<Left!> finished execution
2025-10-07T09:17:25.932583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2640<ResPull!> finished execution
2025-10-07T09:17:25.932621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2640<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:25.932666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2641<Commit!> finished execution
2025-10-07T09:17:25.932710Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2641<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.932801Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2644<ResPull!> finished execution
2025-10-07T09:17:25.932838Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2644<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:25.932882Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2645<Commit!> finished execution
2025-10-07T09:17:25.932919Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2645<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.932957Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #2646<Commit!> finished execution
2025-10-07T09:17:25.932998Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.932 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #2646<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:25.933032Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.933 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #2646, status: Ok
2025-10-07T09:17:25.933061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.933 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #2646
2025-10-07T09:17:25.934918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5jq4hkfeg9tt0etcf9c, SessionId: CompileActor 2025-10-07 12:17:25.934 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361566:3026], duration: 0.470914s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406477461361651:3059], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:25.945741Z
2025-10-07T09:17:25.950142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.950 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:25.950602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.950 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:25.950837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.950 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:25.959438Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:25.965833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.965 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:25.969015Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.968 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:25.971394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:25.971752Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:25.971789Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:25.971821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.971 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:25.974680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.974 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:25.974850Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.974 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.974997Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.974 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.975030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.976667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:25.978487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:25.980894Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:25.984106Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.984 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:25.988769Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.989080Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.989116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.989 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.989797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.989 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:25.990089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.989 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:25.990122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.990 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:25.992384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:25.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:26.020357Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:26.020424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:26.020463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:26.020502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:26.020566Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:26.020603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:26.020638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:26.020669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:26.020762Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:26.020798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:26.020831Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:26.020937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:26.020976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:26.021020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:26.021059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.021097Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:26.021134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.021165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:26.021194Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:26.021874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc61s7zwdhymf5e4kfh5h, SessionId: CompileActor 2025-10-07 12:17:26.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361651:3059], duration: 0.076097s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406481756328988:3075], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:26.026737Z
2025-10-07T09:17:26.030867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:26.031312Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:26.031551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:26.031804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #2109
2025-10-07T09:17:26.031885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2118<Nth> finished execution
2025-10-07T09:17:26.031927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2118<Nth> created 0 trackable nodes: 
2025-10-07T09:17:26.031979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2122<Nth> finished execution
2025-10-07T09:17:26.032018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2122<Nth> created 0 trackable nodes: 
2025-10-07T09:17:26.032061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #2125, status: Async
2025-10-07T09:17:26.032238Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #2109
2025-10-07T09:17:26.032278Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #2109
2025-10-07T09:17:26.032316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #2125
2025-10-07T09:17:26.032349Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #2125, status: Ok
2025-10-07T09:17:26.032491Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2109<KiExecDataQuery!> finished execution
2025-10-07T09:17:26.032528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2109<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:26.032564Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2116<Left!> finished execution
2025-10-07T09:17:26.032685Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2119<ResPull!> finished execution
2025-10-07T09:17:26.032725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2119<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:26.032772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2120<Commit!> finished execution
2025-10-07T09:17:26.032812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2120<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.032906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2123<ResPull!> finished execution
2025-10-07T09:17:26.032946Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2123<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:26.032991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2124<Commit!> finished execution
2025-10-07T09:17:26.033030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.033 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2124<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.033071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.033 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #2125<Commit!> finished execution
2025-10-07T09:17:26.033109Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.033 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #2125<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.033142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.033 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #2125, status: Ok
2025-10-07T09:17:26.033173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.033 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #2125
2025-10-07T09:17:26.034765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.034 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:26.034933Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc5rwcmymsg4ztfgr739d, SessionId: CompileActor 2025-10-07 12:17:26.034 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406477461361629:3049], duration: 0.373624s
2025-10-07T09:17:26.041093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.041 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:26.044247Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.044 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:26.046538Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.046 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:26.046890Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.046 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:26.046927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.046 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:26.046961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.046 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:26.049622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:26.049793Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.049937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.049969Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.051588Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.051 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406481756329032:3087], cluster: db, database: /Root, text: "\n            -- TSaveScriptFinalStatusActor::FinishScriptExecution\n            DECLARE $database AS Text;\n            DECLARE $execution_id AS Text;\n            DECLARE $operation_status AS Int32;\n            DECLARE $execution_status AS Int32;\n            DECLARE $finalization_status AS Int32;\n            DECLARE $issues AS JsonDocument;\n            DECLARE $plan_compressed AS Optional<String>;\n            DECLARE $plan_compression_method AS Optional<Text>;\n            DECLARE $stats AS JsonDocument;\n            DECLARE $ast_compressed AS Optional<String>;\n            DECLARE $ast_compression_method AS Optional<Text>;\n            DECLARE $operation_ttl AS Interval;\n            DECLARE $customer_supplied_id AS Text;\n            DECLARE $script_sinks AS Optional<JsonDocument>;\n            DECLARE $script_secret_names AS Optional<JsonDocument>;\n            DECLARE $applicate_script_external_effect_required AS Bool;\n            DECLARE $retry_state AS JsonDocument;\n            DECLARE $retry_deadline AS Timestamp;\n            DECLARE $lease_state AS Int32;\n\n            UPDATE `.metadata/script_executions`\n            SET\n                operation_status = $operation_status,\n                execution_status = $execution_status,\n                finalization_status = IF($applicate_script_external_effect_required, $finalization_status, NULL),\n                issues = $issues,\n                plan_compressed = $plan_compressed,\n                plan_compression_method = $plan_compression_method,\n                end_ts = CurrentUtcTimestamp(),\n                stats = $stats,\n                ast_compressed = $ast_compressed,\n                ast_compression_method = $ast_compression_method,\n                expire_at = IF($operation_ttl > CAST(0 AS Interval), CurrentUtcTimestamp() + $operation_ttl, NULL),\n                customer_supplied_id = IF($applicate_script_external_effect_required, $customer_supplied_id, NULL),\n                script_sinks = IF($applicate_script_external_effect_required, $script_sinks, NULL),\n                script_secret_names = IF($applicate_script_external_effect_required, $script_secret_names, NULL),\n                retry_state = $retry_state\n            WHERE database = $database AND execution_id = $execution_id;\n        \n                DELETE FROM `.metadata/script_execution_leases`\n                WHERE database = $database AND execution_id = $execution_id;\n            ", startTime: 2025-10-07T09:17:26.052409Z
2025-10-07T09:17:26.053398Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.053 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:26.055786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:26.058948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.058 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:26.063571Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.063 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.063873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.063 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.063906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.063 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.064556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.064846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.064879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.067122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:26.086406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.086 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:26.088343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 $database)
(let $2 $execution_id)
(let $3 '('('filter (lambda '($5) (Coalesce (And (== (Member $5 '"database") $1) (== (Member $5 '"execution_id") $2)) (Bool 'false)))) '('update (lambda '($6) (block '(
  (let $7 $applicate_script_external_effect_required)
  (let $8 (If (Coalesce $7 (Bool 'false)) $finalization_status (Null)))
  (let $9 $operation_ttl)
  (let $10 (If (Coalesce (> $9 (SafeCast (Int32 '"0") (DataType 'Interval))) (Bool 'false)) (+MayWarn (CurrentUtcTimestamp) $9) (Null)))
  (let $11 (If (Coalesce $7 (Bool 'false)) $customer_supplied_id (Null)))
  (let $12 (If (Coalesce $7 (Bool 'false)) $script_sinks (Null)))
  (let $13 (If (Coalesce $7 (Bool 'false)) $script_secret_names (Null)))
  (return (AsStruct '('operation_status $operation_status) '('execution_status $execution_status) '('finalization_status $8) '('issues $issues) '('plan_compressed $plan_compressed) '('plan_compression_method $plan_compression_method) '('end_ts (CurrentUtcTimestamp)) '('stats $stats) '('ast_compressed $ast_compressed) '('ast_compression_method $ast_compression_method) '('expire_at $10) '('customer_supplied_id $11) '('script_sinks $12) '('script_secret_names $13) '('retry_state $retry_state)))
)))) '('mode 'update)))
(let $4 (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) $3))
(return (Write! $4 (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '('('filter (lambda '($14) (Coalesce (And (== (Member $14 '"database") $1) (== (Member $14 '"execution_id") $2)) (Bool 'false)))) '('mode 'delete))))
)
2025-10-07T09:17:26.089415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.088 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 $database)
(let $2 $execution_id)
(let $3 '('('filter (lambda '($5) (Coalesce (And (== (Member $5 '"database") $1) (== (Member $5 '"execution_id") $2)) (Bool 'false)))) '('update (lambda '($6) (block '(
  (let $7 $applicate_script_external_effect_required)
  (let $8 (If (Coalesce $7 (Bool 'false)) $finalization_status (Null)))
  (let $9 $operation_ttl)
  (let $10 (If (Coalesce (> $9 (SafeCast (Int32 '"0") (DataType 'Interval))) (Bool 'false)) (+MayWarn (CurrentUtcTimestamp) $9) (Null)))
  (let $11 (If (Coalesce $7 (Bool 'false)) $customer_supplied_id (Null)))
  (let $12 (If (Coalesce $7 (Bool 'false)) $script_sinks (Null)))
  (let $13 (If (Coalesce $7 (Bool 'false)) $script_secret_names (Null)))
  (return (AsStruct '('operation_status $operation_status) '('execution_status $execution_status) '('finalization_status $8) '('issues $issues) '('plan_compressed $plan_compressed) '('plan_compression_method $plan_compression_method) '('end_ts (CurrentUtcTimestamp)) '('stats $stats) '('ast_compressed $ast_compressed) '('ast_compression_method $ast_compression_method) '('expire_at $10) '('customer_supplied_id $11) '('script_sinks $12) '('script_secret_names $13) '('retry_state $retry_state)))
)))) '('mode 'update)))
(let $4 (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_executions"))) (Void) $3))
(return (Write! $4 (DataSink '"kikimr" '"db") (Key '('table (String '"/Root/.metadata/script_execution_leases"))) (Void) '('('filter (lambda '($14) (Coalesce (And (== (Member $14 '"database") $1) (== (Member $14 '"execution_id") $2)) (Bool 'false)))) '('mode 'delete))))
)
2025-10-07T09:17:26.095474Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:26.095541Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:26.095580Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:26.095619Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:26.095683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:26.095722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:26.095753Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:26.095784Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:26.095877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:26.095912Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:26.095946Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:26.096052Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:26.096091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:26.096135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:26.096173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.096211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:26.096254Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.096286Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:26.096315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:26.096980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc64ab1fnc9fqjtmfns43, SessionId: CompileActor 2025-10-07 12:17:26.096 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406481756328988:3075], duration: 0.070206s
2025-10-07T09:17:26.105417Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.105 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:26.113201Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.113 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:26.114413Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.113 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"/Root/.metadata/script_executions")
(let $3 (DataType 'Utf8))
(let $4 $database)
(let $5 (Bool 'false))
(let $6 $execution_id)
(let $7 (KiUpdateTable! world $1 $2 (lambda '($13) (And (Coalesce (== (Member $13 '"database") $4) $5) (Coalesce (== (Member $13 '"execution_id") $6) $5))) (lambda '($14) (block '(
  (let $15 (OptionalType (DataType 'String)))
  (let $16 (OptionalType $3))
  (let $17 $applicate_script_external_effect_required)
  (let $18 (If $17 (Just $customer_supplied_id) (Nothing $16)))
  (let $19 (DataType 'Int32))
  (let $20 (DataType 'Interval))
  (let $21 $operation_ttl)
  (let $22 (If (> $21 (SafeCast (Int32 '"0") $20)) (+ (CurrentUtcTimestamp) $21) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $23 (If $17 (Just $finalization_status) (Nothing (OptionalType $19))))
  (let $24 (DataType 'JsonDocument))
  (let $25 (OptionalType $24))
  (let $26 (Nothing $25))
  (let $27 (If $17 $script_secret_names $26))
  (let $28 (If $17 $script_sinks $26))
  (return (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $18) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_status" (Just $execution_status)) '('"expire_at" $22) '('"finalization_status" $23) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $27) '('"script_sinks" $28) '('"stats" (Just $stats))))
))) '() 'false))
(let $8 '"/Root/.metadata/script_execution_leases")
(let $9 (KiDeleteTable! world $1 $8 (lambda '($29) (And (Coalesce (== (Member $29 '"database") $4) $5) (Coalesce (== (Member $29 '"execution_id") $6) $5))) '() 'false))
(let $10 '('"db" $2 '"Update"))
(let $11 '('"db" $8 '"Delete"))
(let $12 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects $7 $9) '($10 $11) '())) $12 (Void))) $1 $12))
)
2025-10-07T09:17:26.114453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.114 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #521
2025-10-07T09:17:26.114486Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.114 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #521, status: Ok
2025-10-07T09:17:26.118786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:26.120469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 714 (
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $4 (KqlReadTableRanges $2 (Void) $3 '() '()))
(let $5 (DataType 'Utf8))
(let $6 $database)
(let $7 (Bool 'false))
(let $8 $execution_id)
(let $9 '('"stats" '"ast_compression_method" '"customer_supplied_id" '"operation_status" '"issues" '"execution_status" '"execution_id" '"database" '"end_ts" '"ast_compressed" '"finalization_status" '"expire_at" '"retry_state" '"plan_compression_method" '"plan_compressed" '"script_sinks" '"script_secret_names"))
(let $10 '('('"Mode" '"upsert") '('"IsUpdate") '('"IsConditionalUpdate")))
(let $11 (KqlUpsertRows $1 (KqpWriteConstraint (Map (Filter $4 (lambda '($17) (And (Coalesce (== (Member $17 '"database") $6) $7) (Coalesce (== (Member $17 '"execution_id") $8) $7)))) (lambda '($18) (block '(
  (let $19 (OptionalType (DataType 'String)))
  (let $20 (OptionalType $5))
  (let $21 $applicate_script_external_effect_required)
  (let $22 (If $21 (Just $customer_supplied_id) (Nothing $20)))
  (let $23 (DataType 'Int32))
  (let $24 (DataType 'Interval))
  (let $25 $operation_ttl)
  (let $26 (If (> $25 (SafeCast (Int32 '"0") $24)) (+ (CurrentUtcTimestamp) $25) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $27 (If $21 (Just $finalization_status) (Nothing (OptionalType $23))))
  (let $28 (DataType 'JsonDocument))
  (let $29 (OptionalType $28))
  (let $30 (Nothing $29))
  (let $31 (If $21 $script_secret_names $30))
  (let $32 (If $21 $script_sinks $30))
  (let $33 (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $22) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_status" (Just $execution_status)) '('"expire_at" $26) '('"finalization_status" $27) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $31) '('"script_sinks" $32) '('"stats" (Just $stats))))
  (let $34 '"ast_compression_method")
  (let $35 '"customer_supplied_id")
  (let $36 '"finalization_status")
  (let $37 '"plan_compression_method")
  (let $38 '"script_secret_names")
  (return (AsStruct '('"stats" (Member $33 '"stats")) '($34 (Member $33 $34)) '($35 (Member $33 $35)) '('"operation_status" (Member $33 '"operation_status")) '('"issues" (Member $33 '"issues")) '('"execution_status" (Member $33 '"execution_status")) '('"execution_id" (Member $18 '"execution_id")) '('"database" (Member $18 '"database")) '('"end_ts" (Member $33 '"end_ts")) '('"ast_compressed" (Member $33 '"ast_compressed")) '($36 (Member $33 $36)) '('"expire_at" (Member $33 '"expire_at")) '('"retry_state" (Member $33 '"retry_state")) '($37 (Member $33 $37)) '('"plan_compressed" (Member $33 '"plan_compressed")) '('"script_sinks" (Member $33 '"script_sinks")) '($38 (Member $33 $38))))
)))) '()) $9 '() 'false $10))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $14 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $15 (KqlReadTableRanges $13 (Void) $14 '() '()))
(let $16 (KqlDeleteRows $12 (Map (Filter $15 (lambda '($39) (And (Coalesce (== (Member $39 '"database") $6) $7) (Coalesce (== (Member $39 '"execution_id") $8) $7)))) (lambda '($40) (AsStruct '('"database" (Member $40 '"database")) '('"execution_id" (Member $40 '"execution_id"))))) '() 'false '('('"IsConditionalDelete"))))
(return '('('() '($11 $16))))
)
-------- block transformer end
2025-10-07T09:17:26.122100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 714 n: 0 (
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $3 '('"ast" '"ast_compressed" '"ast_compression_method" '"customer_supplied_id" '"database" '"end_ts" '"execution_id" '"execution_mode" '"execution_status" '"expire_at" '"finalization_status" '"graph_compressed" '"graph_compression_method" '"issues" '"lease_generation" '"meta" '"operation_status" '"parameters" '"plan" '"plan_compressed" '"plan_compression_method" '"query_text" '"result_set_metas" '"retry_state" '"run_script_actor_id" '"script_secret_names" '"script_sinks" '"start_ts" '"stats" '"syntax" '"transient_issues" '"user_group_sids" '"user_token"))
(let $4 (KqlReadTableRanges $2 (Void) $3 '() '()))
(let $5 (DataType 'Utf8))
(let $6 $database)
(let $7 (Bool 'false))
(let $8 $execution_id)
(let $9 '('"stats" '"ast_compression_method" '"customer_supplied_id" '"operation_status" '"issues" '"execution_status" '"execution_id" '"database" '"end_ts" '"ast_compressed" '"finalization_status" '"expire_at" '"retry_state" '"plan_compression_method" '"plan_compressed" '"script_sinks" '"script_secret_names"))
(let $10 '('('"Mode" '"upsert") '('"IsUpdate") '('"IsConditionalUpdate")))
(let $11 (KqlUpsertRows $1 (KqpWriteConstraint (Map (Filter $4 (lambda '($17) (And (Coalesce (== (Member $17 '"database") $6) $7) (Coalesce (== (Member $17 '"execution_id") $8) $7)))) (lambda '($18) (block '(
  (let $19 (OptionalType (DataType 'String)))
  (let $20 (OptionalType $5))
  (let $21 $applicate_script_external_effect_required)
  (let $22 (If $21 (Just $customer_supplied_id) (Nothing $20)))
  (let $23 (DataType 'Int32))
  (let $24 (DataType 'Interval))
  (let $25 $operation_ttl)
  (let $26 (If (> $25 (SafeCast (Int32 '"0") $24)) (+ (CurrentUtcTimestamp) $25) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $27 (If $21 (Just $finalization_status) (Nothing (OptionalType $23))))
  (let $28 (DataType 'JsonDocument))
  (let $29 (OptionalType $28))
  (let $30 (Nothing $29))
  (let $31 (If $21 $script_secret_names $30))
  (let $32 (If $21 $script_sinks $30))
  (let $33 (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $22) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_status" (Just $execution_status)) '('"expire_at" $26) '('"finalization_status" $27) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $31) '('"script_sinks" $32) '('"stats" (Just $stats))))
  (let $34 '"ast_compression_method")
  (let $35 '"customer_supplied_id")
  (let $36 '"finalization_status")
  (let $37 '"plan_compression_method")
  (let $38 '"script_secret_names")
  (return (AsStruct '('"stats" (Member $33 '"stats")) '($34 (Member $33 $34)) '($35 (Member $33 $35)) '('"operation_status" (Member $33 '"operation_status")) '('"issues" (Member $33 '"issues")) '('"execution_status" (Member $33 '"execution_status")) '('"execution_id" (Member $18 '"execution_id")) '('"database" (Member $18 '"database")) '('"end_ts" (Member $33 '"end_ts")) '('"ast_compressed" (Member $33 '"ast_compressed")) '($36 (Member $33 $36)) '('"expire_at" (Member $33 '"expire_at")) '('"retry_state" (Member $33 '"retry_state")) '($37 (Member $33 $37)) '('"plan_compressed" (Member $33 '"plan_compressed")) '('"script_sinks" (Member $33 '"script_sinks")) '($38 (Member $33 $38))))
)))) '()) $9 '() 'false $10))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $14 '('"database" '"execution_id" '"expire_at" '"lease_deadline" '"lease_generation" '"lease_state"))
(let $15 (KqlReadTableRanges $13 (Void) $14 '() '()))
(let $16 (KqlDeleteRows $12 (Map (Filter $15 (lambda '($39) (And (Coalesce (== (Member $39 '"database") $6) $7) (Coalesce (== (Member $39 '"execution_id") $8) $7)))) (lambda '($40) (AsStruct '('"database" (Member $40 '"database")) '('"execution_id" (Member $40 '"execution_id"))))) '() 'false '('('"IsConditionalDelete"))))
(return '('() '($11 $16)))
)
-------- block transformer block end
2025-10-07T09:17:26.122136Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.122 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.157662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:26.158042Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #1166
2025-10-07T09:17:26.158078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #1166, status: Ok
2025-10-07T09:17:26.158110Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #1166, status: Ok
2025-10-07T09:17:26.172579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:26.173129Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-ApplyExtractMembersToReadTable<false>
2025-10-07T09:17:26.182296Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.182 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:26.184216Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.184 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:26.192875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.192 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-DeleteOverLookup
2025-10-07T09:17:26.197391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.197 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:26.204079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:26.212141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.212 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-PushFlatmapToStage<false>
2025-10-07T09:17:26.220072Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.220 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:26.226778Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.226 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:26.246198Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 2057 (
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 $database)
(let $4 $execution_id)
(let $5 (KqlKeyInc $3 $4))
(let $6 (KqpRowsSourceSettings $1 '('"database" '"execution_id") '() '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($15) (FlatMap (ToFlow $15) (lambda '($16) (block '(
  (let $17 (OptionalType (DataType 'String)))
  (let $18 (OptionalType $2))
  (let $19 $applicate_script_external_effect_required)
  (let $20 (If $19 (Just $customer_supplied_id) (Nothing $18)))
  (let $21 (DataType 'Int32))
  (let $22 $operation_ttl)
  (let $23 (If (> $22 (Interval '"0")) (+ (CurrentUtcTimestamp) $22) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $24 (If $19 (Just $finalization_status) (Nothing (OptionalType $21))))
  (let $25 (DataType 'JsonDocument))
  (let $26 (OptionalType $25))
  (let $27 (Nothing $26))
  (let $28 (If $19 $script_secret_names $27))
  (let $29 (If $19 $script_sinks $27))
  (return (Just (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $20) '('"database" (Member $16 '"database")) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_id" (Member $16 '"execution_id")) '('"execution_status" (Just $execution_status)) '('"expire_at" $23) '('"finalization_status" $24) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $28) '('"script_sinks" $29) '('"stats" (Just $stats)))))
))))) '('('"_logical_id" '1948) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DataSink '"KqpTableSink" '"db"))
(let $10 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $11 (DqStage '($8) (lambda '($30) $30) '() '((DqSink '"0" $9 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 'false '"delete" '1 'false 'false 'false '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct '('"database" $3) '('"execution_id" $4))))) '() '((DqSink '"0" $9 $13))))
(return '('('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:26.247232Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.246 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 2057 n: 0 (
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 $database)
(let $4 $execution_id)
(let $5 (KqlKeyInc $3 $4))
(let $6 (KqpRowsSourceSettings $1 '('"database" '"execution_id") '() '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($15) (FlatMap (ToFlow $15) (lambda '($16) (block '(
  (let $17 (OptionalType (DataType 'String)))
  (let $18 (OptionalType $2))
  (let $19 $applicate_script_external_effect_required)
  (let $20 (If $19 (Just $customer_supplied_id) (Nothing $18)))
  (let $21 (DataType 'Int32))
  (let $22 $operation_ttl)
  (let $23 (If (> $22 (Interval '"0")) (+ (CurrentUtcTimestamp) $22) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $24 (If $19 (Just $finalization_status) (Nothing (OptionalType $21))))
  (let $25 (DataType 'JsonDocument))
  (let $26 (OptionalType $25))
  (let $27 (Nothing $26))
  (let $28 (If $19 $script_secret_names $27))
  (let $29 (If $19 $script_sinks $27))
  (return (Just (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $20) '('"database" (Member $16 '"database")) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_id" (Member $16 '"execution_id")) '('"execution_status" (Just $execution_status)) '('"expire_at" $23) '('"finalization_status" $24) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $28) '('"script_sinks" $29) '('"stats" (Just $stats)))))
))))) '('('"_logical_id" '1948) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DataSink '"KqpTableSink" '"db"))
(let $10 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $11 (DqStage '($8) (lambda '($30) $30) '() '((DqSink '"0" $9 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 'false '"delete" '1 'false 'false 'false '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct '('"database" $3) '('"execution_id" $4))))) '() '((DqSink '"0" $9 $13))))
(return '('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:26.247267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.247 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.249544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.248 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 2058 (
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 $database)
(let $4 $execution_id)
(let $5 (KqlKeyInc $3 $4))
(let $6 (KqpRowsSourceSettings $1 '('"database" '"execution_id") '() '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($15) (FlatMap (ToFlow $15) (lambda '($16) (block '(
  (let $17 (OptionalType (DataType 'String)))
  (let $18 (OptionalType $2))
  (let $19 $applicate_script_external_effect_required)
  (let $20 (If $19 (Just $customer_supplied_id) (Nothing $18)))
  (let $21 (DataType 'Int32))
  (let $22 $operation_ttl)
  (let $23 (If (> $22 (Interval '"0")) (+ (CurrentUtcTimestamp) $22) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $24 (If $19 (Just $finalization_status) (Nothing (OptionalType $21))))
  (let $25 (DataType 'JsonDocument))
  (let $26 (OptionalType $25))
  (let $27 (Nothing $26))
  (let $28 (If $19 $script_secret_names $27))
  (let $29 (If $19 $script_sinks $27))
  (return (Just (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $20) '('"database" (Member $16 '"database")) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_id" (Member $16 '"execution_id")) '('"execution_status" (Just $execution_status)) '('"expire_at" $23) '('"finalization_status" $24) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $28) '('"script_sinks" $29) '('"stats" (Just $stats)))))
))))) '('('"_logical_id" '1948) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DataSink '"KqpTableSink" '"db"))
(let $10 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $11 (DqStage '($8) (lambda '($30) $30) '() '((DqSink '"0" $9 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 'false '"delete" '1 'false 'false 'false '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct '('"database" $3) '('"execution_id" $4))))) '() '((DqSink '"0" $9 $13))))
(return '('('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:26.250566Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.249 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 2058 n: 0 (
(declare $applicate_script_external_effect_required (DataType 'Bool))
(declare $ast_compressed (OptionalType (DataType 'String)))
(declare $ast_compression_method (OptionalType (DataType 'Utf8)))
(declare $customer_supplied_id (DataType 'Utf8))
(declare $database (DataType 'Utf8))
(declare $execution_id (DataType 'Utf8))
(declare $execution_status (DataType 'Int32))
(declare $finalization_status (DataType 'Int32))
(declare $issues (DataType 'JsonDocument))
(declare $operation_status (DataType 'Int32))
(declare $operation_ttl (DataType 'Interval))
(declare $plan_compressed (OptionalType (DataType 'String)))
(declare $plan_compression_method (OptionalType (DataType 'Utf8)))
(declare $retry_state (DataType 'JsonDocument))
(declare $script_secret_names (OptionalType (DataType 'JsonDocument)))
(declare $script_sinks (OptionalType (DataType 'JsonDocument)))
(declare $stats (DataType 'JsonDocument))
(let $1 (KqpTable '"/Root/.metadata/script_executions" '"72057594046644480:20" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 $database)
(let $4 $execution_id)
(let $5 (KqlKeyInc $3 $4))
(let $6 (KqpRowsSourceSettings $1 '('"database" '"execution_id") '() '($5 $5)))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $6)) (lambda '($15) (FlatMap (ToFlow $15) (lambda '($16) (block '(
  (let $17 (OptionalType (DataType 'String)))
  (let $18 (OptionalType $2))
  (let $19 $applicate_script_external_effect_required)
  (let $20 (If $19 (Just $customer_supplied_id) (Nothing $18)))
  (let $21 (DataType 'Int32))
  (let $22 $operation_ttl)
  (let $23 (If (> $22 (Interval '"0")) (+ (CurrentUtcTimestamp) $22) (Nothing (OptionalType (DataType 'Timestamp)))))
  (let $24 (If $19 (Just $finalization_status) (Nothing (OptionalType $21))))
  (let $25 (DataType 'JsonDocument))
  (let $26 (OptionalType $25))
  (let $27 (Nothing $26))
  (let $28 (If $19 $script_secret_names $27))
  (let $29 (If $19 $script_sinks $27))
  (return (Just (AsStruct '('"ast_compressed" $ast_compressed) '('"ast_compression_method" $ast_compression_method) '('"customer_supplied_id" $20) '('"database" (Member $16 '"database")) '('"end_ts" (Just (CurrentUtcTimestamp))) '('"execution_id" (Member $16 '"execution_id")) '('"execution_status" (Just $execution_status)) '('"expire_at" $23) '('"finalization_status" $24) '('"issues" (Just $issues)) '('"operation_status" (Just $operation_status)) '('"plan_compressed" $plan_compressed) '('"plan_compression_method" $plan_compression_method) '('"retry_state" (Just $retry_state)) '('"script_secret_names" $28) '('"script_sinks" $29) '('"stats" (Just $stats)))))
))))) '('('"_logical_id" '1948) '('"_partition_mode" '"single"))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(let $9 (DataSink '"KqpTableSink" '"db"))
(let $10 (KqpTableSinkSettings $1 'false '"upsert" '"0" 'false 'false 'false '()))
(let $11 (DqStage '($8) (lambda '($30) $30) '() '((DqSink '"0" $9 $10))))
(let $12 (KqpTable '"/Root/.metadata/script_execution_leases" '"72057594046644480:19" '"" '1))
(let $13 (KqpTableSinkSettings $12 'false '"delete" '1 'false 'false 'false '()))
(let $14 (DqStage '() (lambda '() (ToFlow (AsList (AsStruct '('"database" $3) '('"execution_id" $4))))) '() '((DqSink '"0" $9 $13))))
(return '('() '((KqpSinkEffect $11 '"0") (KqpSinkEffect $14 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:26.250601Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.250 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.255621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.255 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 1948
2025-10-07T09:17:26.341380Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #519
2025-10-07T09:17:26.341445Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #521, status: Async
2025-10-07T09:17:26.341527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #519
2025-10-07T09:17:26.341565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #519
2025-10-07T09:17:26.341600Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #521
2025-10-07T09:17:26.341631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #521, status: Ok
2025-10-07T09:17:26.341732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #519<KiExecDataQuery!> finished execution
2025-10-07T09:17:26.341768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #519<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:26.341802Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #520<Left!> finished execution
2025-10-07T09:17:26.341849Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #521<Commit!> finished execution
2025-10-07T09:17:26.341885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #521<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.341916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #521, status: Ok
2025-10-07T09:17:26.341945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #521
2025-10-07T09:17:26.342019Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.341 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:20:21: Warning: Symbol $retry_deadline is not used, code: 4527
2025-10-07T09:17:26.342056Z node 1 :KQP_YQL NOTICE: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.342 NOTE  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [common provider] yql_provider_gateway.cpp:21: <main>:21:21: Warning: Symbol $lease_state is not used, code: 4527
2025-10-07T09:17:26.343409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6530m12tk48wr390wfn, SessionId: CompileActor 2025-10-07 12:17:26.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406481756329032:3087], duration: 0.290959s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406481756329169:3130], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:26.392392Z
2025-10-07T09:17:26.396827Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.396 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:26.397299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:26.397540Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:26.399028Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:26.405935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.405 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:26.409537Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:26.412000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:26.412387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.412 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:26.412427Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.412 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:26.412460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.412 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:26.415562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:26.415742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.415892Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.415925Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.417705Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.417 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:26.419632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.419 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:26.422111Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:26.425410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:26.430139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.429 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.430456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.430491Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.431165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.431469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.431503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.433848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.433 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:26.463542Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:26.463621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:26.463662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:26.463704Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:26.463781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:26.463823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:26.463859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:26.463891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:26.463993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:26.464029Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:26.464064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:26.464180Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:26.464218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:26.464267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:26.464305Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.464343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:26.464379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.464410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:26.464439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.464 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:26.465103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6fqfc0e86avapdex9tk, SessionId: CompileActor 2025-10-07 12:17:26.465 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406481756329169:3130], duration: 0.072673s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406481756329281:3168], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:26.519335Z
2025-10-07T09:17:26.523621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:26.524081Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:26.524323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.524 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:26.526475Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.526 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:26.533206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.533 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:26.536539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:26.538933Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.538 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:26.539327Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.539 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:26.539367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.539 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:26.539400Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.539 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:26.542521Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:26.542702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.542852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.542885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.544658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:26.546510Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.546 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:26.548986Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.548 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:26.552206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.552 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:26.557022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.556 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.557338Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.557 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.557372Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.557 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.558031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.557 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:26.558325Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.558 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:26.558358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.558 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:26.560651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:26.589283Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:26.589362Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:26.589402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:26.589443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:26.589517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:26.589555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:26.589590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:26.589622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:26.589723Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:26.589757Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:26.589790Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:26.589907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:26.589945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:26.589990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:26.590028Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.590066Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:26.590106Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:26.590139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:26.590169Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:26.590866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc6kp1fjdr471pays50q3, SessionId: CompileActor 2025-10-07 12:17:26.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406481756329281:3168], duration: 0.071492s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406486051296700:3210], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:27.045379Z
2025-10-07T09:17:27.049910Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:27.050377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.050 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.050615Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.050 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.052761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.052 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:27.060294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:27.063876Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.063 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:27.066365Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.066 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:27.066771Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.066 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:27.066812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.066 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:27.066846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.066 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:27.070100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.070 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:27.070301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.070 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.070458Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.070 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.070495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.070 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.072489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.072 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:27.074614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.074 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:27.077410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.077 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:27.081089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.081 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:27.086471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.086 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.086816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.086 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.086855Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.086 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.087604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.087941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.087979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.090593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.090 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406486051296723:3221], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:27.105057Z
2025-10-07T09:17:27.109683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.109 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:27.110145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.109 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.110391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.110 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.111776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:27.118317Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:27.121506Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:27.123476Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:27.123573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:27.123621Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:27.123671Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:27.123766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:27.123810Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:27.123822Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:27.123852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:27.123889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:27.124013Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:27.124054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:27.124095Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:27.124172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:27.124211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:27.124234Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:27.124249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:27.124275Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:27.124330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:27.124373Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.124419Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:27.124462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.124499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:27.124534Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:27.125363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc744a5c7k2hvw0fs4k3r, SessionId: CompileActor 2025-10-07 12:17:27.125 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406486051296700:3210], duration: 0.079939s
2025-10-07T09:17:27.127261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:27.127436Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.127582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.127614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.129314Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:27.131152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:27.133576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.133 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:27.136819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:27.141544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.141 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.141846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.141 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.141880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.141 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.142536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.142847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.142881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.145149Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.145 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:27.173787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:27.173859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:27.173899Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:27.173940Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:27.174011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:27.174048Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:27.174084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:27.174115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:27.174213Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:27.174253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:27.174287Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:27.174402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:27.174441Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:27.174488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:27.174527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.174565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:27.174603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.174634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:27.174665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:27.175322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc760an0zabctbq9dwq9x, SessionId: CompileActor 2025-10-07 12:17:27.175 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406486051296723:3221], duration: 0.070228s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406486051296773:3235], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:27.472800Z
2025-10-07T09:17:27.477035Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.477 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:27.477489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.477 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.477728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.477 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.479141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.479 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:27.485549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:27.488717Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:27.491020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:27.491377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:27.491415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:27.491446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:27.494065Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:27.494241Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.494385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.494418Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.496053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:27.497866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.497 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:27.500257Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.500 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:27.503428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:27.508052Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.507 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.508356Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.508390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.509037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.509330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.509363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.511642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.511 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:27.540101Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:27.540170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:27.540210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:27.540253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:27.540322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:27.540359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:27.540394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:27.540425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:27.540519Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:27.540553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:27.540587Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:27.540697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:27.540736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:27.540781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:27.540819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.540857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:27.540894Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.540926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:27.540955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.540 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:27.541615Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7hg2g329pj5qr50bv7f, SessionId: CompileActor 2025-10-07 12:17:27.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406486051296773:3235], duration: 0.068778s
2025-10-07T09:17:27.569763Z node 1 :KQP_PROXY WARN: queries.cpp:398: [StreamingQueries] [TStartStreamingQueryTableActor] OwnerId: [1:7558406473166393789:3173] ActorId: [1:7558406473166393864:3202] QueryPath: /Root/streamingQuery. Query compilation / planing [1:7558406481756329118:3526] failed INTERNAL_ERROR, issues: [ { <main>: Warning: Execution, code: 1060 subissue: { <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001 } } { <main>: Fatal: Execution, code: 1060 subissue: { <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1 } } ]
2025-10-07T09:17:27.578427Z node 1 :KQP_PROXY WARN: queries.cpp:413: [StreamingQueries] [TStartStreamingQueryTableActor] OwnerId: [1:7558406473166393789:3173] ActorId: [1:7558406473166393864:3202] QueryPath: /Root/streamingQuery. Failed INTERNAL_ERROR, with issues: { <main>: Fatal: Query compilation / planing failed subissue: { <main>: Warning: Execution, code: 1060 subissue: { <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001 } } subissue: { <main>: Fatal: Execution, code: 1060 subissue: { <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1 } } }
2025-10-07T09:17:27.578503Z node 1 :KQP_PROXY WARN: queries.cpp:398: [StreamingQueries] [TSyncStreamingQueryTableActor] OwnerId: [1:7558406473166393670:3113] ActorId: [1:7558406473166393789:3173] QueryPath: /Root/streamingQuery. Start streaming query [1:7558406473166393864:3202] failed INTERNAL_ERROR, issues: { <main>: Fatal: Query compilation / planing failed subissue: { <main>: Warning: Execution, code: 1060 subissue: { <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001 } } subissue: { <main>: Fatal: Execution, code: 1060 subissue: { <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1 } } }
2025-10-07T09:17:27.587090Z node 1 :KQP_PROXY WARN: queries.cpp:413: [StreamingQueries] [TSyncStreamingQueryTableActor] OwnerId: [1:7558406473166393670:3113] ActorId: [1:7558406473166393789:3173] QueryPath: /Root/streamingQuery. Failed INTERNAL_ERROR, with issues: { <main>: Fatal: Start streaming query failed subissue: { <main>: Fatal: Query compilation / planing failed subissue: { <main>: Warning: Execution, code: 1060 subissue: { <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001 } } subissue: { <main>: Fatal: Execution, code: 1060 subissue: { <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1 } } } }
2025-10-07T09:17:27.587167Z node 1 :KQP_PROXY WARN: queries.cpp:398: [StreamingQueries] [TCreateStreamingQueryActor] OwnerId: [0:0:0] ActorId: [1:7558406473166393670:3113] QueryPath: /Root/streamingQuery. Streaming query initialization [1:7558406473166393789:3173] failed INTERNAL_ERROR, issues: { <main>: Fatal: Start streaming query failed subissue: { <main>: Fatal: Query compilation / planing failed subissue: { <main>: Warning: Execution, code: 1060 subissue: { <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001 } } subissue: { <main>: Fatal: Execution, code: 1060 subissue: { <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1 } } } }
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406486051296898:3266], cluster: db, database: /Root, text: "-- TUnlockStreamingQueryRequestActor::ReadQueryInfo\n\n                DECLARE $database_id AS Text;\n                DECLARE $query_path AS Text;\n\n                SELECT\n                    *\n                FROM `//Root/.metadata/streaming/queries`\n                WHERE database_id = $database_id\n                  AND query_path = $query_path;\n            ", startTime: 2025-10-07T09:17:27.590130Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406486051296906:3271], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:27.596593Z
2025-10-07T09:17:27.597255Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:27.597889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (Coalesce (And (== (Member $5 '"database_id") $database_id) (== (Member $5 '"query_path") $query_path)) (Bool 'false)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($6) $6) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.598237Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Filter (Right! $1) (lambda '($5) (Coalesce (And (== (Member $5 '"database_id") $database_id) (== (Member $5 '"query_path") $query_path)) (Bool 'false)))))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($6) $6) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.599845Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.599 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:27.601221Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.601 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:27.601713Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.601 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.601962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.601 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:27.604102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.604 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:27.610251Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.610 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:27.610759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.610 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:27.613993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.613 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:27.614289Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.614 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:27.616385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.616 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:27.616759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.616 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:27.616798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.616 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:27.616832Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.616 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:27.617281Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:27.617785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/streaming/queries")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (FlatMap (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (lambda '($7) (block '(
  (let $8 (DataType 'Utf8))
  (let $9 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $7 '"database_id") $database_id) $9) (Coalesce (== (Member $7 '"query_path") $query_path) $9)) $7))
)))) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:27.617823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #390
2025-10-07T09:17:27.617855Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #390, status: Ok
2025-10-07T09:17:27.619781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:27.619963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.620112Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.620146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.620597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:27.620888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 424 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $4 '"database_id") $database_id) $6) (Coalesce (== (Member $4 '"query_path") $query_path) $6)) $4))
)))) (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.621145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 424 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take (FlatMap $3 (lambda '($4) (block '(
  (let $5 (DataType 'Utf8))
  (let $6 (Bool 'false))
  (return (OptionalIf (And (Coalesce (== (Member $4 '"database_id") $database_id) $6) (Coalesce (== (Member $4 '"query_path") $query_path) $6)) $4))
)))) (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.621178Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.621931Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:27.623850Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.623 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:27.625506Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.625 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-PushExtractedPredicateToReadTable
2025-10-07T09:17:27.626387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:27.627963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-DropTakeOverLookupTable
2025-10-07T09:17:27.628964Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpLogical-RewriteLookupTable
2025-10-07T09:17:27.629762Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.629 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:27.630322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.630 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableStage
2025-10-07T09:17:27.632595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.632 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:27.634631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.634936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.634970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.635630Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.635 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.635922Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.635 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.635955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.635 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.636064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.635 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 760 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"abd3ad7a-22835470-3ce36ce0-b21b408e") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.636339Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 760 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"abd3ad7a-22835470-3ce36ce0-b21b408e") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.636373Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.636935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 761 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"abd3ad7a-22835470-3ce36ce0-b21b408e") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:27.637193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 761 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 '('"database_id" '"query_path" '"state"))
(let $3 (DataType 'Utf8))
(let $4 (KqlKeyInc $database_id $query_path))
(let $5 (KqpRowsSourceSettings $1 $2 '() '($4 $4)))
(let $6 '('('"_logical_id" '711) '('"_id" '"abd3ad7a-22835470-3ce36ce0-b21b408e") '('"_partition_mode" '"single")))
(let $7 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $5)) (lambda '($9) (ToFlow $9)) $6))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:27.637230Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.637 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.638252Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.638 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:27.649170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #378
2025-10-07T09:17:27.649244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #387<Nth> finished execution
2025-10-07T09:17:27.649288Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #387<Nth> created 0 trackable nodes: 
2025-10-07T09:17:27.649326Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #390, status: Async
2025-10-07T09:17:27.649394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #378
2025-10-07T09:17:27.649431Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #378
2025-10-07T09:17:27.649473Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #390
2025-10-07T09:17:27.649505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #390, status: Ok
2025-10-07T09:17:27.649597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #378<KiExecDataQuery!> finished execution
2025-10-07T09:17:27.649633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #378<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:27.649667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #385<Left!> finished execution
2025-10-07T09:17:27.649776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #388<ResPull!> finished execution
2025-10-07T09:17:27.649815Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #388<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:27.649866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #389<Commit!> finished execution
2025-10-07T09:17:27.649905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #389<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.649943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #390<Commit!> finished execution
2025-10-07T09:17:27.649980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #390<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.650012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #390, status: Ok
2025-10-07T09:17:27.650041Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.650 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #390
2025-10-07T09:17:27.650607Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7n500akh1t8249cq705, SessionId: CompileActor 2025-10-07 12:17:27.650 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406486051296898:3266], duration: 0.060441s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406486051296942:3282], cluster: db, database: /Root, text: "-- TUnlockStreamingQueryRequestActor::PersistQueryInfo\n\n                DECLARE $database_id AS Text;\n                DECLARE $query_path AS Text;\n                DECLARE $state AS Json;\n\n                UPSERT INTO `//Root/.metadata/streaming/queries` (\n                    database_id, query_path, state\n                ) VALUES (\n                    $database_id, $query_path, $state\n                );\n            ", startTime: 2025-10-07T09:17:27.656078Z
2025-10-07T09:17:27.663278Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:27.663672Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (PersistableRepr '((AsStruct '('"database_id" $database_id) '('"query_path" $query_path) '('"state" $state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:27.663879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(return (Write! world (DataSink '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/streaming/queries"))) (PersistableRepr '((AsStruct '('"database_id" $database_id) '('"query_path" $query_path) '('"state" $state)))) '('('mode 'upsert))))
)
2025-10-07T09:17:27.667280Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:27.667358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:27.667399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:27.667441Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:27.667513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:27.667552Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:27.667588Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:27.667622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:27.667637Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:27.667727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:27.667764Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:27.667799Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:27.667916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:27.667955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:27.668001Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:27.668040Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.668079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:27.668117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.668149Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:27.668179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:27.668916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7nbdkqtq1qw34q9ae1a, SessionId: CompileActor 2025-10-07 12:17:27.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406486051296906:3271], duration: 0.072269s
2025-10-07T09:17:27.670593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.670 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:27.670990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.670 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/streaming/queries")
(let $3 (DataType 'Utf8))
(let $4 '('"database_id" '"query_path" '"state"))
(let $5 '('('"input_columns" $4) '('"default_constraint_columns" '()) '('"generate_columns_if_insert" '())))
(let $6 '('('"mode" '"flush")))
(return (Commit! (Left! (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '() (KiEffects (KiWriteTable! world $1 $2 (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) 'upsert $5 '())) '('('"db" $2 '"Upsert")) '())) $6 (Void))) $1 $6))
)
2025-10-07T09:17:27.671027Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.671 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #131
2025-10-07T09:17:27.671059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.671 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #131, status: Ok
2025-10-07T09:17:27.673736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:27.673985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 158 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database_id" '"query_path" '"state"))
(return '('('() '((KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) '()) $3 '() '"false" '('('"Mode" '"upsert")))))))
)
-------- block transformer end
2025-10-07T09:17:27.674207Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 158 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (DataType 'Utf8))
(let $3 '('"database_id" '"query_path" '"state"))
(return '('() '((KqlUpsertRows $1 (KqpWriteConstraint (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state)))) '()) $3 '() '"false" '('('"Mode" '"upsert"))))))
)
-------- block transformer block end
2025-10-07T09:17:27.674245Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.676530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.676 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildWriteConstraint<false>
2025-10-07T09:17:27.681322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 189 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:27.681583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 189 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:27.681616Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.682143Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 190 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('('() '((KqpSinkEffect $3 '"0")))))
)
-------- block transformer end
2025-10-07T09:17:27.682397Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.682 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 190 n: 0 (
(declare $database_id (DataType 'Utf8))
(declare $query_path (DataType 'Utf8))
(declare $state (DataType 'Json))
(let $1 (KqpTable '"//Root/.metadata/streaming/queries" '"72057594046644480:16" '"" '1))
(let $2 (KqpTableSinkSettings $1 '"false" '"upsert" '"0" '"false" '"false" '"false" '()))
(let $3 (DqStage '() (lambda '() (block '(
  (let $4 (DataType 'Utf8))
  (return (ToFlow (AsList (AsStruct '('"database_id" (Just $database_id)) '('"query_path" (Just $query_path)) '('"state" (Just $state))))))
))) '() '((DqSink '"0" (DataSink '"KqpTableSink" '"db") $2))))
(return '('() '((KqpSinkEffect $3 '"0"))))
)
-------- block transformer block end
2025-10-07T09:17:27.682429Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.682 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:27.694739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #129
2025-10-07T09:17:27.694807Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #131, status: Async
2025-10-07T09:17:27.694893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #129
2025-10-07T09:17:27.694939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #129
2025-10-07T09:17:27.694982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #131
2025-10-07T09:17:27.695020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #131, status: Ok
2025-10-07T09:17:27.695114Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #129<KiExecDataQuery!> finished execution
2025-10-07T09:17:27.695158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #129<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:27.695200Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #130<Left!> finished execution
2025-10-07T09:17:27.695260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #131<Commit!> finished execution
2025-10-07T09:17:27.695306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #131<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:27.695345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #131, status: Ok
2025-10-07T09:17:27.695381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #131
2025-10-07T09:17:27.696023Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc7q767mpx2ndwhpkms24, SessionId: CompileActor 2025-10-07 12:17:27.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406486051296942:3282], duration: 0.039898s
2025-10-07T09:17:27.701195Z node 1 :KQP_PROXY WARN: queries.cpp:413: [StreamingQueries] [TCreateStreamingQueryActor] OwnerId: [0:0:0] ActorId: [1:7558406473166393670:3113] QueryPath: /Root/streamingQuery. Failed INTERNAL_ERROR, with issues: { <main>: Fatal: Streaming query initialization failed subissue: { <main>: Fatal: Start streaming query failed subissue: { <main>: Fatal: Query compilation / planing failed subissue: { <main>: Warning: Execution, code: 1060 subissue: { <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001 } } subissue: { <main>: Fatal: Execution, code: 1060 subissue: { <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1 } } } } }
2025-10-07T09:17:27.701599Z node 1 :KQP_SESSION WARN: kqp_session_actor.cpp:2843: SessionId: ydb://session/3?node_id=1&id=NWMyN2QyODQtODExZmUxYjktNGY0NTA4ZTMtMzJjYWUxOGM=, ActorId: [1:7558406473166393375:2821], ActorState: ExecuteState, TraceId: 01k6yzc48q507bv0tmy2hq82p2, Create QueryResponse for error on request, msg: 
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406490346264310:3303], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:28.135643Z
2025-10-07T09:17:28.140099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.140 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:28.140573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.140 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.140812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.140 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.142973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:28.149451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.149 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:28.152624Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:28.154928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:28.155287Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:28.155325Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:28.155358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:28.158018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:28.158189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.158337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.158370Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.160058Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:28.161901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:28.164313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:28.167509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.167 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:28.172152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.171 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.172456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.172490Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.173142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.172 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.173435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.173469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.175744Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.175 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406490346264331:3313], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:28.182438Z
2025-10-07T09:17:28.187109Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:28.187598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.187841Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.189377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.189 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:28.195935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:28.199160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.199 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:28.201522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:28.201889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:28.201926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:28.201958Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:28.203849Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:28.203917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:28.203956Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:28.203995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:28.204062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:28.204099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:28.204134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:28.204165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:28.204268Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:28.204303Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:28.204337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:28.204451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:28.204491Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:28.204536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:28.204573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.204612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:28.204649Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.204681Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:28.204711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:28.204897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:28.205073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.205218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.205 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.205255Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.205 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.205408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc86698qrw206addrac8d, SessionId: CompileActor 2025-10-07 12:17:28.205 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406490346264310:3303], duration: 0.069727s
2025-10-07T09:17:28.206948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.206 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:28.208794Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:28.211224Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.211 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:28.214476Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.214 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:28.219381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.219 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.219693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.219 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.219727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.219 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.220411Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.220 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.220711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.220 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.220745Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.220 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.223054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.223 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:28.252336Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:28.252409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:28.252448Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:28.252488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:28.252562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:28.252599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:28.252633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:28.252664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:28.252762Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:28.252797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:28.252830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:28.252942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:28.252981Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:28.253028Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:28.253065Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.253103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:28.253139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.253170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:28.253199Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:28.253867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc87n5m4y1rdpkz06ab84, SessionId: CompileActor 2025-10-07 12:17:28.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406490346264331:3313], duration: 0.071392s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406490346264381:3327], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:28.548628Z
2025-10-07T09:17:28.553532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.553 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:28.554030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.553 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.554284Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.554 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.555874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.555 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:28.562366Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.562 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:28.565543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.565 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:28.567872Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.567 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:28.568244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.567 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:28.568282Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:28.568314Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:28.571264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.571 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:28.571440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.571 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.571585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.571 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.571617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.571 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.573276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.573 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:28.575093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.575 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:28.577502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.577 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:28.580679Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.580 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:28.585324Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.585627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.585660Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.586314Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.586605Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.586638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.588893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.588 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:28.617424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:28.617496Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:28.617535Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:28.617574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:28.617643Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:28.617681Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:28.617716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:28.617748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:28.617842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:28.617879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:28.617909Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:28.618023Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.617 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:28.618062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:28.618121Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:28.618160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.618198Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:28.618240Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.618272Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:28.618303Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:28.618961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8k4frezd0cz2fzp521y, SessionId: CompileActor 2025-10-07 12:17:28.618 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406490346264381:3327], duration: 0.070295s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406490346264433:3346], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:28.677831Z
2025-10-07T09:17:28.682660Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.682 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:28.683104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.682 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.683348Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.683 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:28.685392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.685 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:28.691694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:28.694855Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:28.697148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.697 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:28.697507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.697 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:28.697545Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.697 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:28.697578Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.697 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:28.700214Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:28.700389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.700531Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.700564Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.702201Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.702 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:28.704019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.703 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:28.706423Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.706 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:28.709945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.709 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:28.715616Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.715983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.716025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.716826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:28.717182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:28.717223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.717 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:28.719743Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.719 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:28.747512Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:28.747581Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:28.747622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:28.747661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:28.747730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:28.747768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:28.747803Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:28.747834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:28.747928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:28.747963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:28.747997Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:28.748105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:28.748144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:28.748188Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:28.748231Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.748272Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:28.748308Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:28.748340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:28.748370Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:28.749051Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc8q51nj79ga8aw9r0q5f, SessionId: CompileActor 2025-10-07 12:17:28.749 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406490346264433:3346], duration: 0.071184s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406494641231776:3362], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:29.214307Z
2025-10-07T09:17:29.218596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.218 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:29.219043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.218 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.219287Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.219 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.221363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.221 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:29.227670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:29.230833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.230 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:29.233132Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:29.233489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:29.233529Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:29.233558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:29.236190Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.236 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:29.236365Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.236 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.236507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.236 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.236540Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.236 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.238174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.238 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:29.239992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:29.242393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.242 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:29.245584Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:29.250201Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.249 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.250507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.250 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.250542Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.250 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.251189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.250 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.251484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.251 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.251518Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.251 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.253758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406494641231798:3372], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:29.260194Z
2025-10-07T09:17:29.264741Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.264 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:29.265210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.264 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.265455Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.266900Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:29.273408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.273 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:29.276633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.276 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:29.279017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:29.279389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:29.279428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:29.279460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:29.281661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:29.281730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:29.281769Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:29.281808Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:29.281889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:29.281928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:29.281960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:29.281991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:29.282087Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:29.282122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:29.282156Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:29.282269Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:29.282307Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:29.282354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:29.282406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:29.282408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.282443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:29.282481Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.282513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:29.282543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:29.282583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.282733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.282766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.283236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc97xfbza1v9gjhzdkp08, SessionId: CompileActor 2025-10-07 12:17:29.283 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406494641231776:3362], duration: 0.068883s
2025-10-07T09:17:29.284492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:29.286384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.286 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:29.288907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.288 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:29.292206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:29.296928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.297231Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.297265Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.297910Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.298200Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.298236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.298 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.300494Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.300 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:29.330871Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:29.330942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:29.330982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:29.331020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:29.331089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:29.331126Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:29.331160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:29.331191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:29.331291Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:29.331328Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:29.331361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:29.331471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:29.331509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:29.331555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:29.331593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.331631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:29.331667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.331698Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:29.331727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:29.332384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc99b889trz53zgv68f6e, SessionId: CompileActor 2025-10-07 12:17:29.332 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406494641231798:3372], duration: 0.072154s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406494641231848:3386], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:29.625163Z
2025-10-07T09:17:29.629995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.629 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:29.630500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.630 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.630750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.630 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.632303Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.632 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:29.638750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.638 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:29.641936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:29.644240Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:29.644605Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:29.644645Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:29.644674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:29.647610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:29.647785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.647930Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.647963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.649610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:29.651434Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.651 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:29.653837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.653 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:29.657025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.656 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:29.661657Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.661958Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.661991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.662644Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.662 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.662935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.662 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.662968Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.662 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.665218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.665 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:29.693734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:29.693805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:29.693844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:29.693884Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:29.693953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:29.693990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.693 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:29.694025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:29.694057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:29.694154Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:29.694189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:29.694223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:29.694340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:29.694379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:29.694424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:29.694461Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.694499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:29.694536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.694568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:29.694598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.694 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:29.695263Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9mrft3whcn0h0m3p3r7, SessionId: CompileActor 2025-10-07 12:17:29.695 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406494641231848:3386], duration: 0.070055s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406494641231881:3397], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:29.756420Z
2025-10-07T09:17:29.760860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.760 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:29.761326Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.761571Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:29.763800Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.763 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:29.770166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.770 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:29.773330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:29.775651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:29.776004Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:29.776042Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.776 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:29.776073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.776 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:29.778705Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.778 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:29.778875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.778 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.779017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.778 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.779051Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.779 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.780694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:29.782511Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.782 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:29.784917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.784 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:29.788105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.788 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:29.792738Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.793043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.793076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.793 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.793734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.793 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:29.794026Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.793 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:29.794059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:29.796307Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.796 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:29.824064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:29.824132Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:29.824171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:29.824210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:29.824282Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:29.824319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:29.824355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:29.824386Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:29.824479Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:29.824514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:29.824549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:29.824656Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:29.824694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:29.824739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:29.824776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.824814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:29.824852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:29.824883Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:29.824913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:29.825598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzc9rvfa5k78f8j3qp1ys1, SessionId: CompileActor 2025-10-07 12:17:29.825 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406494641231881:3397], duration: 0.069142s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406498936199264:3429], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:30.291299Z
2025-10-07T09:17:30.296116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:30.296606Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.296846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.299003Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.298 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:30.305503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:30.308690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.308 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:30.311009Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.310 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:30.311383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:30.311422Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:30.311454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:30.314438Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.314 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:30.314614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.314 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.314758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.314 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.314790Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.314 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.316485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.316 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:30.318322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:30.320733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.320 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:30.323938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.323 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:30.328609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.328909Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.328943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.329596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.329888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.329921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.329 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.332182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.332 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406498936199285:3439], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:30.339152Z
2025-10-07T09:17:30.343909Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:30.344390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.344632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.346253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:30.352911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.352 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:30.356192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.356 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:30.358611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.358 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:30.358982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.358 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:30.359019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.358 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:30.359051Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.359 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:30.360383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:30.360455Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:30.360495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:30.360535Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:30.360604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:30.360642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:30.360676Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:30.360708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:30.360805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:30.360840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:30.360874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:30.360987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.360 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:30.361029Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:30.361071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:30.361108Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.361147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:30.361184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.361216Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:30.361250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:30.361945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzca9j58x88nt406e3qzpw, SessionId: CompileActor 2025-10-07 12:17:30.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406498936199264:3429], duration: 0.070608s
2025-10-07T09:17:30.362240Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.362 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:30.362415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.362 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.362562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.362 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.362594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.362 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.364349Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.364 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:30.366182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.366 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:30.368654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.368 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:30.371988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.371 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:30.376832Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.377139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.377173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.377826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.378117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.378150Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.378 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.380414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:30.409456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:30.409531Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:30.409571Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:30.409610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:30.409681Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:30.409720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:30.409756Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:30.409787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:30.409885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:30.409920Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:30.409954Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:30.410066Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:30.410104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:30.410151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:30.410188Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.410232Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:30.410267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.410298Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:30.410329Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:30.410990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcab27te1smfp28zedaf9, SessionId: CompileActor 2025-10-07 12:17:30.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406498936199285:3439], duration: 0.071801s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406498936199337:3454], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:30.702575Z
2025-10-07T09:17:30.707442Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.707 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:30.707942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.707 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.708192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.707 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.709785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.709 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:30.717730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.717 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:30.721445Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:30.723758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.723 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:30.724130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.723 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:30.724170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.724 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:30.724202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.724 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:30.727141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:30.727320Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.727466Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.727499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.729174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:30.731019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.730 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:30.733437Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:30.736672Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.736 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:30.741354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.741 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.741655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.741 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.741689Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.741 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.742343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.742635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.742668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.744938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:30.773573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:30.773648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:30.773688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:30.773728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:30.773801Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:30.773839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:30.773874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:30.773905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:30.774003Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:30.774038Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:30.774072Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:30.774186Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:30.774225Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:30.774276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:30.774316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.774354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:30.774391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.774425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:30.774455Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.774 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:30.775126Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcapd2hba7wgjg970ysx8, SessionId: CompileActor 2025-10-07 12:17:30.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406498936199337:3454], duration: 0.072513s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406498936199370:3465], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:30.832798Z
2025-10-07T09:17:30.837335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:30.837797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.838037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:30.840707Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.840 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:30.848179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:30.851836Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.851 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:30.854484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:30.854916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:30.854960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:30.854997Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:30.858365Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.858 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:30.858557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.858 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.858712Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.858 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.858747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.858 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.860663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.860 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:30.862760Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:30.865334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.865 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:30.868867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.868 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:30.873921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.873 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.874249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.873 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.874286Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.875011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:30.875346Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.875 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:30.875384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.875 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:30.878009Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:30.910152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:30.910253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:30.910297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:30.910341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:30.910431Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:30.910472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:30.910511Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:30.910544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:30.910664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:30.910701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:30.910736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:30.910864Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:30.910905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:30.910952Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:30.910992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.911033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:30.911072Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:30.911105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:30.911137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:30.911922Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcatg042cgs9ktvvkbh5t, SessionId: CompileActor 2025-10-07 12:17:30.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406498936199370:3465], duration: 0.079078s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406503231166713:3482], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:31.371913Z
2025-10-07T09:17:31.376628Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:31.377104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.377350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.379699Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:31.386502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.386 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:31.389699Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.389 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:31.392036Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.392 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:31.392430Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.392 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:31.392470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.392 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:31.392504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.392 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:31.395606Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.395 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:31.395791Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.395 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.395939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.395 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.395972Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.395 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.397771Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:31.399677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.399 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:31.402179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.402 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:31.405598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.405 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:31.410475Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.410788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.410823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.411502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.411802Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.411836Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.414182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406503231166734:3492], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:31.417238Z
2025-10-07T09:17:31.421748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:31.422208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.422456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.422 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.423926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:31.430557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:31.433797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.433 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:31.436168Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:31.436529Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:31.436568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:31.436600Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:31.439568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.439 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:31.439740Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.439 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.439885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.439 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.439917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.439 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.441602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.441 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:31.443439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:31.443617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:31.443697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:31.443738Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:31.443779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:31.443852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:31.443892Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:31.443928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:31.443960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:31.444069Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:31.444105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:31.444139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:31.444266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:31.444306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:31.444352Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:31.444390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.444430Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:31.444469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.444501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:31.444531Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.444 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:31.445267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbbbdar1thtnnafw64ae, SessionId: CompileActor 2025-10-07 12:17:31.445 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406503231166713:3482], duration: 0.073309s
2025-10-07T09:17:31.445857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.445 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:31.449072Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.449 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:31.453754Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.453 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.454057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.453 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.454091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.454 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.454745Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.454 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.455039Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.454 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.455073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.455 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.457350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.457 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:31.485955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:31.486024Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:31.486064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:31.486102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:31.486175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:31.486212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:31.486252Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:31.486284Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:31.486379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:31.486414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:31.486448Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:31.486559Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:31.486598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:31.486645Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:31.486683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.486721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:31.486759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.486790Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:31.486820Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:31.487481Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbcr1zvhnb2wappwx82p, SessionId: CompileActor 2025-10-07 12:17:31.487 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406503231166734:3492], duration: 0.070206s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406503231166786:3507], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:31.783233Z
2025-10-07T09:17:31.787737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.787 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:31.788212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.787 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.788465Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.788 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.789963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.789 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:31.796449Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.796 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:31.799693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:31.802074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.802 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:31.802450Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.802 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:31.802489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.802 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:31.802522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.802 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:31.805408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:31.805589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.805742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.805775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.807504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.807 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:31.809387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.809 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:31.811866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.811 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:31.815152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:31.819877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.820181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.820215Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.820868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.821158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.821191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.823518Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.823 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:31.852520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:31.852594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:31.852634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:31.852675Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:31.852749Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:31.852788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:31.852824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:31.852857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:31.852956Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:31.852993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:31.853031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:31.853144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:31.853184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:31.853241Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:31.853280Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.853320Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:31.853358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.853391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:31.853422Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:31.854110Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbr63mnww2jmxsvcjh29, SessionId: CompileActor 2025-10-07 12:17:31.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406503231166786:3507], duration: 0.070838s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406503231166820:3518], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:31.919817Z
2025-10-07T09:17:31.924205Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.924 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:31.924680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.924 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.924925Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.924 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:31.927163Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.927 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:31.933623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.933 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:31.936785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.936 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:31.939083Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:31.939446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:31.939483Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:31.939515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:31.942245Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:31.942417Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.942560Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.942593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.944250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:31.946068Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.946 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:31.948477Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.948 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:31.951674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.951 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:31.956500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.956 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.956810Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.956 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.956845Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.956 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.957520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.957 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:31.957819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.957 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:31.957853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.957 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:31.960170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:31.988024Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.987 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:31.988096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:31.988133Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:31.988174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:31.988257Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:31.988296Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:31.988335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:31.988363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:31.988459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:31.988495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:31.988530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:31.988646Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:31.988686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:31.988732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:31.988771Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.988811Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:31.988849Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:31.988882Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:31.988914Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:31.989634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcbwf36e58saf0v0gvp4k, SessionId: CompileActor 2025-10-07 12:17:31.989 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406503231166820:3518], duration: 0.069778s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406507526134180:3542], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:32.454758Z
2025-10-07T09:17:32.459800Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:32.460325Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:32.460582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:32.462817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.462 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:32.470010Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.469 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:32.473714Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.473 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:32.476354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:32.476773Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:32.476816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:32.476853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:32.480022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.479 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:32.480214Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.480 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.480372Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.480 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.480407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.480 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.482277Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.482 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:32.484251Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.484 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:32.487081Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.486 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:32.490962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406507526134201:3552], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:32.494543Z
2025-10-07T09:17:32.496115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.495 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.496435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.496471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.497170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.497485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.497 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.497520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.497 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.499074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.499 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:32.499552Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.499 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:32.499794Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.499 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:32.499954Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.499 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:32.501393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.501 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:32.507985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.507 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:32.511229Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.511 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:32.513577Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.513 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:32.513940Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.513 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:32.513978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.513 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:32.514011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.513 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:32.516812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.516 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:32.516985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.516 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.517130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.516 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.517163Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.517 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.518855Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.518 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:32.520710Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.520 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:32.523167Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:32.526374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.526 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:32.531043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.530 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.531268Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:32.531350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.531358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:32.531385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.531400Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:32.531444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:32.531528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:32.531572Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:32.531612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:32.531648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:32.531765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:32.531805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:32.531843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:32.531976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:32.532020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:32.532037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.531 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.532070Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:32.532113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:32.532156Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:32.532198Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:32.532236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:32.532270Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:32.532331Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.532365Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.532 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.533066Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccd6adqc7njqwxc5k34c, SessionId: CompileActor 2025-10-07 12:17:32.533 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406507526134180:3542], duration: 0.078262s
2025-10-07T09:17:32.534634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.534 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:32.563387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:32.563460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:32.563496Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:32.563536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:32.563606Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:32.563644Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:32.563679Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:32.563710Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:32.563809Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:32.563844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:32.563879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:32.563998Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:32.564036Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:32.564081Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:32.564119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:32.564158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:32.564195Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:32.564232Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:32.564262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:32.564923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcceda85y6m88f5ab0pnp, SessionId: CompileActor 2025-10-07 12:17:32.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406507526134201:3552], duration: 0.070343s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406507526134272:3575], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:32.861183Z
2025-10-07T09:17:32.865688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.865 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:32.866158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.865 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:32.866411Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:32.867968Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.867 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:32.874587Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.874 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:32.877814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.877 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:32.880171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:32.880535Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:32.880574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:32.880603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:32.883388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:32.883562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.883706Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.883739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.885410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:32.887262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:32.889663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.889 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:32.892854Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:32.897504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.897806Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.897840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.898495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:32.898786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:32.898819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:32.901080Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.901 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:32.929693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:32.929766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:32.929808Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:32.929848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:32.929915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:32.929953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:32.929989Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:32.930020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:32.930116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:32.930150Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:32.930184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:32.930299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:32.930338Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:32.930382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:32.930420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:32.930458Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:32.930496Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:32.930528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:32.930558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:32.931219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccsw6a5cd3ak23stdgpk, SessionId: CompileActor 2025-10-07 12:17:32.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406507526134272:3575], duration: 0.069999s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406507526134305:3586], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:32.996895Z
2025-10-07T09:17:33.001934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.001 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:33.002482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.002 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.002758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.002 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.005142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:33.012220Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:33.015536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.015 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:33.017948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:33.018333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.018 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:33.018373Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.018 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:33.018406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.018 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:33.021509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:33.021696Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.021857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.021894Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.023849Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.023 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:33.025826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.025 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:33.028382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:33.031779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:33.036725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.036 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.037050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.036 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.037086Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.037 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.037789Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.037 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.038102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.037 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.038138Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.038 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.040661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.040 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:33.047019Z node 1 :FLAT_TX_SCHEMESHARD WARN: schemeshard_impl.cpp:7721: Cannot get console configs
2025-10-07T09:17:33.047031Z node 1 :IMPORT WARN: schemeshard_import.cpp:307: Table profiles were not loaded
2025-10-07T09:17:33.071112Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:33.071202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:33.071249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:33.071292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:33.071376Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:33.071416Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:33.071453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:33.071486Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:33.071599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:33.071635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:33.071670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:33.071793Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:33.071834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:33.071880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:33.071919Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:33.071961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:33.071999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.071 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:33.072031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.072 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:33.072062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.072 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:33.072806Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzccy4d8e3cmghw3wz8wdq, SessionId: CompileActor 2025-10-07 12:17:33.072 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406507526134305:3586], duration: 0.075869s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406511821101665:3610], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:33.543945Z
2025-10-07T09:17:33.548530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.548 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:33.548997Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.548 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.549242Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.549 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.551555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.551 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:33.558525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.558 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:33.562007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.561 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:33.564647Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:33.565076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:33.565120Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.565 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:33.565156Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.565 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:33.568537Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:33.568736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.568901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.568938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.570907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.570 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406511821101686:3620], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:33.571633Z
2025-10-07T09:17:33.572951Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:33.575541Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.575 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:33.575901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.575 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:33.576360Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.576 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.576603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.576 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.578123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.578 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:33.578983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.578 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:33.584193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.583 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.584543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.584 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.584582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.584 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.584737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.584 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:33.585337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.585673Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.585711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.587976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:33.588324Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.588 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:33.590307Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:33.590668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:33.590706Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:33.590738Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:33.593789Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:33.593963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.594109Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.594142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.595878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.595 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:33.597750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:33.600186Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.600 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:33.603472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.603 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:33.608198Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.607 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.608507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.608 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.608543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.608 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.609217Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.608 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.609514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.609 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.609547Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.609 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.611844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.611 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:33.619437Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:33.619525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:33.619566Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:33.619609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:33.619713Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:33.619755Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:33.619788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:33.619820Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:33.619931Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:33.619967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:33.620001Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.619 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:33.620125Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:33.620165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:33.620212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:33.620258Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:33.620299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:33.620337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:33.620369Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:33.620400Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:33.621128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdf7fkt7jw33s61g0w0t, SessionId: CompileActor 2025-10-07 12:17:33.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406511821101665:3610], duration: 0.077141s
2025-10-07T09:17:33.640523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:33.640594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:33.640635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:33.640676Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:33.640749Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:33.640788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:33.640824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:33.640856Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:33.640954Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:33.640991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.640 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:33.641026Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:33.641143Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:33.641183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:33.641234Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:33.641273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:33.641313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:33.641351Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:33.641383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:33.641414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.641 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:33.642098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdg3284sr5n0mx1hyc9j, SessionId: CompileActor 2025-10-07 12:17:33.642 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406511821101686:3620], duration: 0.070421s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406511821101737:3634], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:33.938626Z
2025-10-07T09:17:33.943581Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:33.944092Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.944356Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:33.945955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:33.952415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.952 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:33.955594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.955 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:33.957908Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.957 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:33.958278Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.957 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:33.958316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.958 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:33.958348Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.958 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:33.961261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:33.961433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.961577Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.961610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.963253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:33.965071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.965 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:33.967477Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.967 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:33.970720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.970 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:33.975495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.975804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.975839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.976510Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:33.976808Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:33.976842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:33.979151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:33.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:34.007716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:34.007786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:34.007822Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:34.007863Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:34.007934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:34.007971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:34.008006Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:34.008038Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:34.008133Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:34.008171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:34.008201Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:34.008312Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:34.008350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:34.008395Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:34.008433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.008471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:34.008508Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.008540Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:34.008570Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:34.009224Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdvh64zxh5svhcv8z8t3, SessionId: CompileActor 2025-10-07 12:17:34.009 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406511821101737:3634], duration: 0.070562s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406516116069066:3645], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:34.079548Z
2025-10-07T09:17:34.083764Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.083 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:34.084210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:34.084454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:34.087188Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:34.094012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:34.097328Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.097 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:34.099731Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.099 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:34.100126Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.099 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:34.100166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.100 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:34.100199Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.100 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:34.103295Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.103 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:34.103485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.103 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.103634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.103 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.103668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.103 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.105458Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.105 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:34.107387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:34.109934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.109 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:34.113321Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.113 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:34.118184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.117 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.118500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.118536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.119212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.119515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.119550Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.119 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.121941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:34.151608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:34.151695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:34.151737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:34.151780Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:34.151862Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:34.151902Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:34.151939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:34.151971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.151 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:34.152082Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:34.152119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:34.152153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:34.152281Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:34.152321Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:34.152367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:34.152406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.152446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:34.152484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.152517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:34.152547Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:34.153318Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcdzyeb7m529f1dnmhdn2, SessionId: CompileActor 2025-10-07 12:17:34.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406516116069066:3645], duration: 0.073728s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406516116069113:3662], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:34.631452Z
2025-10-07T09:17:34.635982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.635 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:34.636454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:34.636695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:34.638933Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.638 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:34.645377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.645 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:34.648555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.648 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406516116069134:3672], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:34.649207Z
2025-10-07T09:17:34.650862Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.650 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:34.651258Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.650 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:34.651297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.651 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:34.651330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.651 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:34.654103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:34.654282Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.654293Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:34.654427Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.654460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.654824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:34.655105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:34.656163Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.656 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:34.656966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.656 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:34.658006Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.657 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:34.660440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:34.663658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:34.663688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:34.666926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:34.668435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.668743Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.668777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.669328Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:34.669437Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.669727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:34.669730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.669760Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.669768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:34.669798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.669 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:34.672021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.671 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:34.672976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.672 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:34.673160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.673315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.673351Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.675110Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.675 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:34.677011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.676 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:34.679511Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:34.682810Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.682 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:34.687668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.687 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.687984Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.687 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.688020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.687 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.688698Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.688 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:34.688999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.688 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:34.689033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.689 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:34.691395Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.691 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:34.700445Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:34.700517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:34.700558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:34.700598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:34.700664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:34.700702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:34.700738Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:34.700769Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:34.700866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:34.700901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:34.700935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.700 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:34.701049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:34.701088Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:34.701133Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:34.701170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.701208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:34.701251Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.701283Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:34.701313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:34.702020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzceh60xt7gmkys50g9xd7, SessionId: CompileActor 2025-10-07 12:17:34.701 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406516116069113:3662], duration: 0.070531s
2025-10-07T09:17:34.721700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:34.721795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:34.721842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:34.721885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:34.721975Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:34.722017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:34.722057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:34.722093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:34.722210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:34.722256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:34.722294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:34.722424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:34.722468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:34.722522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:34.722565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.722609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:34.722650Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:34.722686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:34.722719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.722 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:34.723492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcehr3vdj58rax6prwhj4, SessionId: CompileActor 2025-10-07 12:17:34.723 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406516116069134:3672], duration: 0.074242s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406520411036500:3694], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:35.016245Z
2025-10-07T09:17:35.020626Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:35.021082Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.021327Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.021 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.022824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.022 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:35.029248Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:35.032428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.032 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:35.034731Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.034 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:35.035084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.034 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:35.035121Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.035 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:35.035153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.035 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:35.037839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.037 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:35.038012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.037 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.038158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.038 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.038190Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.038 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.039843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.039 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:35.041662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.041 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:35.044060Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.044 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:35.047238Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:35.051874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.051 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.052176Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.051 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.052210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.052 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.052865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.052 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.053158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.052 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.053191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.053 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.055460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:35.084071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:35.084144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:35.084183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:35.084223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:35.084299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:35.084336Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:35.084371Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:35.084403Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:35.084501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:35.084536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:35.084570Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:35.084682Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:35.084721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:35.084766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:35.084804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.084844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:35.084882Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.084913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:35.084945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:35.085610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcex70qnwb3pc9mvwfnck, SessionId: CompileActor 2025-10-07 12:17:35.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406520411036500:3694], duration: 0.069328s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406520411036541:3709], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:35.160129Z
2025-10-07T09:17:35.164388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:35.164837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.165075Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.167195Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.167 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:35.173518Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:35.176689Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:35.178996Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.178 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:35.179355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.179 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:35.179393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.179 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:35.179425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.179 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:35.182094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.182 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:35.182270Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.182 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.182413Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.182 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.182446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.182 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.184087Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.184 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:35.185908Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.185 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:35.188313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:35.191525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.191 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:35.196155Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.196463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.196496Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.197147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.196 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.197442Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.197 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.197475Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.197 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.199724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.199 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:35.227523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:35.227592Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:35.227631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:35.227670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:35.227740Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:35.227777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:35.227812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:35.227844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:35.227938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:35.227973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:35.228007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:35.228118Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:35.228156Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:35.228201Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:35.228244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.228286Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:35.228319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.228352Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:35.228382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:35.229067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcf1q04tycwer4qeftege, SessionId: CompileActor 2025-10-07 12:17:35.229 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406520411036541:3709], duration: 0.068901s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406520411036585:3724], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:35.711382Z
2025-10-07T09:17:35.715917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:35.716392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.716640Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.718822Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.718 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:35.725181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.725 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:35.728350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.728 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406520411036606:3734], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:35.730062Z
2025-10-07T09:17:35.730664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.730 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:35.731019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.730 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:35.731057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:35.731090Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:35.733788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:35.733961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.734104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.734137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.734 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.734917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.734 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:35.735413Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.735 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.735664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.735 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:35.735812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.735 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:35.737329Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:35.737647Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:35.740073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.740 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:35.743295Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:35.744176Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:35.747574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:35.748004Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.748310Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.748344Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.749032Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.749335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.749 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.749368Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.749 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.750063Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:35.750461Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:35.750504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:35.750534Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:35.751625Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.751 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:35.753705Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.753 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:35.753890Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.753 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.754045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.753 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.754079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.754 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.755877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.755 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:35.757837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.757 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:35.760590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.760 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:35.764115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.764 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:35.769267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.768 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.769590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.769626Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.769 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.770329Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.770 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:35.770639Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.770 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:35.770675Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.770 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:35.773122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.773 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:35.780084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:35.780160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:35.780203Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:35.780248Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:35.780334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:35.780372Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:35.780406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:35.780446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:35.780544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:35.780579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:35.780613Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:35.780728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:35.780768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:35.780814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:35.780852Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.780891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:35.780928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.780960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:35.780990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.780 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:35.781696Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfjy9b7nwp1n7rpb5h6e, SessionId: CompileActor 2025-10-07 12:17:35.781 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406520411036585:3724], duration: 0.070276s
2025-10-07T09:17:35.804303Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:35.804391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:35.804433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:35.804477Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:35.804558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:35.804597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:35.804634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:35.804663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:35.804777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:35.804816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:35.804847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:35.804968Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:35.805008Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:35.805055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:35.805094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.805135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:35.805173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:35.805206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:35.805241Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:35.805941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfkh4f5vwsf17pehbxzx, SessionId: CompileActor 2025-10-07 12:17:35.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406520411036606:3734], duration: 0.075840s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406524706003972:3756], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:36.092959Z
2025-10-07T09:17:36.097264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.097 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:36.097719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.097 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.097960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.097 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.099460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.099 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:36.105925Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.105 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:36.109091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.109 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:36.111397Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:36.111751Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:36.111788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:36.111820Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.111 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:36.114484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.114 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:36.114654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.114 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.114798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.114 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.114831Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.114 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.116482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.116 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:36.118301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.118 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:36.120700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:36.123896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:36.128667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.128 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.128976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.128 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.129011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.128 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.129684Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.129982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.130016Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.132343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:36.160935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:36.161006Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:36.161046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:36.161086Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:36.161154Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:36.161192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:36.161231Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:36.161263Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:36.161360Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:36.161395Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:36.161429Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:36.161536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:36.161574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:36.161618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:36.161657Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.161692Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:36.161729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.161760Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:36.161790Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:36.162452Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcfywdhveymhh9wsmr7c8, SessionId: CompileActor 2025-10-07 12:17:36.162 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406524706003972:3756], duration: 0.069456s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406524706004008:3768], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:36.236018Z
2025-10-07T09:17:36.240267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.240 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:36.240712Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.240 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.240950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.240 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.243034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:36.249356Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.249 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:36.252891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.252 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:36.255728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.255 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:36.256158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.255 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:36.256203Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.256 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:36.256246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.256 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:36.259479Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:36.259683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.259855Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.259893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.261739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:36.263605Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.263 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:36.266027Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:36.269205Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.269 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:36.273835Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.273 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.274137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.273 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.274171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.274 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.274824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.274 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.275113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.274 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.275146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.277391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.277 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:36.305134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:36.305202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:36.305246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:36.305285Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:36.305353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:36.305390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:36.305425Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:36.305456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:36.305549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:36.305584Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:36.305618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:36.305724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:36.305763Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:36.305808Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:36.305845Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.305884Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:36.305922Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.305953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:36.305983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:36.306669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcg3b04kt673n3m3ddnr6, SessionId: CompileActor 2025-10-07 12:17:36.306 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406524706004008:3768], duration: 0.070612s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406524706004072:3791], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:36.790476Z
2025-10-07T09:17:36.794928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:36.795398Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.795638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.797801Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.797 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:36.804361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:36.808326Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.808 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:36.811213Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.811 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:36.811661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.811 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:36.811709Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.811 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:36.811744Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.811 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406524706004093:3801], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:36.813687Z
2025-10-07T09:17:36.815233Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:36.815443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.815619Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.815659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.817739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.817 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:36.819244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:36.819821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.819987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:36.820118Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:36.822039Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:36.822601Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.822 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:36.825830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.825 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:36.829409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.829 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:36.830555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.830866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.830901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.831562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.831 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.831865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.831 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.831899Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.831 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.832985Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.832 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:36.834213Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.834 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:36.835632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.835 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:36.836058Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.835 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:36.836102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:36.836139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:36.839542Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:36.839740Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.839905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.839943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.841860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.841 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:36.843962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.843 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:36.846727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.846 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:36.850418Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.850 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:36.855792Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.856138Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.856176Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.856 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.856919Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.856 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:36.857256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.856 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:36.857294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.857 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:36.859873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.859 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:36.862718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:36.862792Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:36.862833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:36.862872Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:36.862945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:36.862982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:36.863017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.862 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:36.863050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:36.863154Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:36.863196Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:36.863235Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:36.863355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:36.863397Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:36.863444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:36.863481Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.863520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:36.863557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.863589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:36.863620Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.863 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:36.864341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgmn8en6yxh1wj5dqjpg, SessionId: CompileActor 2025-10-07 12:17:36.864 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406524706004072:3791], duration: 0.073826s
2025-10-07T09:17:36.892559Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:36.892653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:36.892699Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:36.892746Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:36.892834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:36.892877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:36.892916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:36.892952Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.892 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:36.893073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:36.893113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:36.893151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:36.893289Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:36.893335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:36.893387Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:36.893430Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.893473Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:36.893515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:36.893551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:36.893585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:36.894355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcgncfqw7ekwrha49mx1e, SessionId: CompileActor 2025-10-07 12:17:36.894 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406524706004093:3801], duration: 0.080624s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406529000971441:3816], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:37.168978Z
2025-10-07T09:17:37.174139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:37.174642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.174900Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.176477Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:37.183507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.183 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:37.186979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.186 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:37.189459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.189 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:37.189851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.189 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:37.189890Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.189 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:37.189924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.189 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:37.193112Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:37.193308Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.193466Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.193500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.195335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.195 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:37.197323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.197 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:37.199942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.199 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:37.203509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:37.208716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.209054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.209091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.209826Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.210136Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.210172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.212612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.212 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:37.244644Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:37.244739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:37.244784Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:37.244831Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:37.244924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:37.244968Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:37.245008Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:37.245044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:37.245168Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:37.245207Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:37.245250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:37.245384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:37.245429Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:37.245480Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:37.245523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.245567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:37.245609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.245645Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:37.245678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:37.246468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch0g7rjb5gqcc3j4yn4k, SessionId: CompileActor 2025-10-07 12:17:37.246 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406529000971441:3816], duration: 0.077443s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406529000971474:3827], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:37.313927Z
2025-10-07T09:17:37.318348Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:37.318807Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.319045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.318 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.321205Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:37.327614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.327 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:37.330787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:37.333094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.333 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:37.333455Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.333 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:37.333493Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.333 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:37.333525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.333 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:37.336243Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:37.336415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.336559Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.336591Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.338268Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.338 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:37.340096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.340 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:37.342513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.342 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:37.345711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:37.350383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.350685Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.350719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.351374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.351 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.351664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.351 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.351697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.351 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.353959Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.353 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:37.381902Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:37.381974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:37.382014Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:37.382053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:37.382126Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:37.382164Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:37.382199Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:37.382236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:37.382334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:37.382369Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:37.382402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:37.382514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:37.382553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:37.382598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:37.382636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.382674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:37.382711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.382744Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:37.382774Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:37.383489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzch510v5r7vda5cy8gha3, SessionId: CompileActor 2025-10-07 12:17:37.383 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406529000971474:3827], duration: 0.069524s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406529000971538:3850], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:37.874045Z
2025-10-07T09:17:37.878529Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.878 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:37.879003Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.878 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.879254Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.879 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.881431Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:37.888064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.888 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:37.891269Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.891 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:37.893576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:37.893936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:37.893975Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:37.894009Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:37.896777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.896 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:37.896949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.896 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.897092Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.896 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.897125Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.898824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:37.900658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.900 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406529000971559:3860], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:37.900956Z
2025-10-07T09:17:37.903073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.903 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:37.906064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.906 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:37.906277Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.906 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:37.906609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.906 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.906878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.906 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:37.908633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.908 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:37.910971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.911279Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.911313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.911971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.912266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.911 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.912300Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.914574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.914 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:37.916043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:37.919676Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.919 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:37.922316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.922 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:37.922741Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.922 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:37.922784Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.922 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:37.922821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.922 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:37.926160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.926 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:37.926363Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.926 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.926529Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.926 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.926566Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.926 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.928504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.928 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:37.930593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:37.933345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.933 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:37.936876Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.936 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:37.942255Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.941 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.942600Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.942639Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.943316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:37.943390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:37.943390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:37.943432Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:37.943473Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:37.943577Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:37.943617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:37.943654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:37.943686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:37.943718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:37.943757Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:37.943786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:37.943824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:37.943859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:37.943975Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:37.944015Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:37.944061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:37.944100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.944141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:37.944179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.944212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:37.944247Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:37.944944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchphbjmzat0vtz3wfh0h, SessionId: CompileActor 2025-10-07 12:17:37.944 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406529000971538:3850], duration: 0.070861s
2025-10-07T09:17:37.946359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.946 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:37.978579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:37.978675Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:37.978720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:37.978768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:37.978858Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:37.978901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:37.978941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:37.978977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:37.979096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:37.979137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:37.979175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:37.979319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:37.979364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:37.979415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:37.979458Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.979501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:37.979543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:37.979578Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:37.979611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:37.980385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzchqccnsmh174gtr6v7x3, SessionId: CompileActor 2025-10-07 12:17:37.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406529000971559:3860], duration: 0.079385s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406533295938907:3875], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:38.253140Z
2025-10-07T09:17:38.257503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.257 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:38.257958Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.257 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.258198Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.258 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.259730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:38.266157Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:38.269341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.269 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:38.271651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.271 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:38.272011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.271 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:38.272051Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.272 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:38.272083Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.272 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:38.274800Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.274 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:38.274973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.274 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.275119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.274 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.275151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.276814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.276 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:38.278636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.278 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:38.281042Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:38.284244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.284 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:38.288880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.288 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.289184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.288 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.289217Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.289 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.289870Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.289 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.290162Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.289 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.290195Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.290 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.292459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:38.321340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:38.321411Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:38.321451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:38.321491Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:38.321563Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:38.321601Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:38.321635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:38.321667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:38.321763Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:38.321798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:38.321833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:38.321948Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:38.321986Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:38.322031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:38.322069Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:38.322108Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:38.322145Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:38.322177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:38.322207Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:38.322875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj2ce226sv78h857stry, SessionId: CompileActor 2025-10-07 12:17:38.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406533295938907:3875], duration: 0.069697s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406533295938959:3894], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:38.390702Z
2025-10-07T09:17:38.395893Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.395 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:38.396404Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.396 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.396662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.396 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.398916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:38.405262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.405 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:38.408494Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:38.410861Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:38.411240Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:38.411279Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:38.411312Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:38.414307Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:38.414483Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.414632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.414666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.416349Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.416 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:38.418173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.418 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:38.420584Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.420 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:38.423772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:38.428399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.428702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.428736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.429393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.429 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.429683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.429 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.429716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.429 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.431967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.431 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:38.459747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:38.459816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:38.459851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:38.459891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:38.459959Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:38.459996Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:38.460032Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:38.460063Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:38.460158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:38.460193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:38.460232Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:38.460341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:38.460379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:38.460424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:38.460461Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:38.460500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:38.460537Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:38.460569Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:38.460599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:38.461288Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcj6p7rd86ayjenpe7gq1, SessionId: CompileActor 2025-10-07 12:17:38.461 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406533295938959:3894], duration: 0.070550s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406533295939003:3909], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:38.954473Z
2025-10-07T09:17:38.958990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.958 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:38.959457Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.959697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.962092Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.962 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:38.969558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:38.973054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.973 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:38.975589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:38.976020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:38.976064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:38.976100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:38.979503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:38.979704Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.979868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.979905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.981880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.981 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:38.983990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.983 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406533295939024:3919], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:38.986547Z
2025-10-07T09:17:38.986839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.986 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:38.990527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.990 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:38.990970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:38.990 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:38.991434Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:38.991 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.991678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:38.991 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:38.993176Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:38.993 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:38.995604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.995918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.995953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.996636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.996 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:38.996935Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.996 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:38.996970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.996 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:38.999341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:38.999 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:38.999690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:38.999 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:39.002919Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.002 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:39.005239Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:39.005597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:39.005635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:39.005676Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:39.008471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:39.008644Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.008788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.008820Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.010528Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.010 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:39.012364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:39.014819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.014 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:39.018021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:39.022789Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.022 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.023090Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.022 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.023125Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.023 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.023779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.023 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.024070Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.023 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.024103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.024 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.026371Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.026 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:39.029594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:39.029686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:39.029732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:39.029779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:39.029863Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:39.029907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:39.029947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:39.029982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:39.030102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:39.030142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:39.030183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:39.030323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:39.030369Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:39.030420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:39.030463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.030506Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:39.030548Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.030583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:39.030616Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.030 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:39.031432Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjr94tamnjatqbjxpd8q, SessionId: CompileActor 2025-10-07 12:17:39.031 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406533295939003:3909], duration: 0.076914s
2025-10-07T09:17:39.055083Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:39.055153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:39.055192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:39.055235Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:39.055304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:39.055342Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:39.055377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:39.055408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:39.055502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:39.055537Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:39.055571Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:39.055682Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:39.055721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:39.055766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:39.055804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.055842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:39.055880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.055914Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:39.055945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:39.056629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcjs9f4krw4gw7dgramce, SessionId: CompileActor 2025-10-07 12:17:39.056 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406533295939024:3919], duration: 0.070044s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406537590906391:3942], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:39.330336Z
2025-10-07T09:17:39.334632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.334 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:39.335089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.334 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:39.335333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.335 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:39.336818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:39.343215Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:39.346386Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:39.348680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.348 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:39.349035Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.348 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:39.349073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:39.349105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:39.351772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.351 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:39.351943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.351 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.352087Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.351 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.352119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.352 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.353769Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.353 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:39.355594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.355 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:39.357988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.357 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:39.361177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.361 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:39.365830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.365 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.366132Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.365 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.366166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.366 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.366823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.366 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.367113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.366 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.367147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.367 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.369409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.369 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:39.397868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:39.397937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:39.397978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:39.398016Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.397 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:39.398085Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:39.398122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:39.398157Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:39.398189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:39.398288Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:39.398323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:39.398357Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:39.398465Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:39.398504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:39.398552Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:39.398590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.398629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:39.398666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.398697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:39.398727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.398 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:39.399389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck4150bacg9497w0gyys, SessionId: CompileActor 2025-10-07 12:17:39.399 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406537590906391:3942], duration: 0.069016s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406537590906424:3953], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:39.468596Z
2025-10-07T09:17:39.472769Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.472 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:39.473215Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.473 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:39.473462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.473 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:39.475729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:39.482044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.482 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:39.485208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:39.487533Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.487 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:39.487886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.487 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:39.487924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.487 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:39.487956Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.487 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:39.490583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:39.490754Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.490896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.490929Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.492567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:39.494382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:39.496781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:39.499961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.499 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:39.504596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.504898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.504932Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.505588Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.505 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:39.505889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.505 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:39.505923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.505 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:39.508245Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:39.536311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:39.536379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:39.536419Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:39.536458Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:39.536526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:39.536562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:39.536599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:39.536627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:39.536716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:39.536752Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:39.536786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:39.536896Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:39.536936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:39.536980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:39.537018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.536 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.537057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.537 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:39.537094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.537 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:39.537125Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.537 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:39.537155Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.537 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:39.537842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzck8bb65zdn98cybp51sc, SessionId: CompileActor 2025-10-07 12:17:39.537 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406537590906424:3953], duration: 0.069210s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406541885873768:3968], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:40.042448Z
2025-10-07T09:17:40.046878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.046 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:40.047344Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.047583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.049902Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:40.057367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.057 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:40.061035Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406541885873789:3978], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:40.063245Z
2025-10-07T09:17:40.063693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.063 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:40.064130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.063 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:40.064174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:40.064211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:40.067379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:40.067632Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:40.067818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.067837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.067996Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.068034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.068 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.068055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.069460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.069 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:40.070007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.069 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:40.072106Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.072 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:40.074883Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.074 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:40.076030Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.075 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:40.078548Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.078 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:40.079292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.079 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:40.081676Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.081 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:40.082036Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.081 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:40.082074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.082 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:40.082111Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.082 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:40.083884Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.083 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.084230Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.083 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.084270Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.085015Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.084 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.085053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:40.085231Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.085350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.085378Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.085389Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.085412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.085 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.087076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:40.087971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.087 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:40.088906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.088 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:40.091347Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.091 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:40.094570Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:40.099303Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.098 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.099612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.099 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.099646Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.099 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.100326Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.100 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.100625Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.100 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.100658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.100 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.102945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.102 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:40.120316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:40.120408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:40.120451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:40.120495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:40.120648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:40.120688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:40.120726Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:40.120759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:40.120876Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:40.120913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:40.120949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.120 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:40.121077Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:40.121118Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:40.121166Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:40.121206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.121253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:40.121292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.121325Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:40.121356Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:40.122121Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckt937phscr7cb5yv2cw, SessionId: CompileActor 2025-10-07 12:17:40.122 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406541885873768:3968], duration: 0.079631s
2025-10-07T09:17:40.131828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:40.131899Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:40.131939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:40.131979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:40.132048Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:40.132086Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:40.132121Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:40.132153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:40.132255Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:40.132292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:40.132322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:40.132436Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:40.132475Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:40.132520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:40.132558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.132597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:40.132634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.132667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:40.132697Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.132 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:40.133361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzckty0gn40ame3ghzq39z, SessionId: CompileActor 2025-10-07 12:17:40.133 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406541885873789:3978], duration: 0.070080s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406541885873860:4001], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:40.406573Z
2025-10-07T09:17:40.410983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:40.411456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.411696Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.413426Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:40.419891Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.419 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:40.423068Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.423 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:40.425374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:40.425730Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:40.425767Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:40.425799Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:40.428505Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:40.428678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.428824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.428857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.428 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.430536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:40.432368Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.432 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:40.434775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.434 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:40.437962Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.437 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:40.442614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.442915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.442949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.443614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.443904Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.443938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.443 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.446201Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.446 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:40.474777Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.474 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:40.474848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.474 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:40.474883Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.474 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:40.474923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.474 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:40.474994Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.474 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:40.475031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:40.475067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:40.475098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:40.475194Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:40.475235Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:40.475270Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:40.475381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:40.475422Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:40.475463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:40.475501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.475549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:40.475587Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.475618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:40.475648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:40.476316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcm5n9btaawjmwz72g9wz, SessionId: CompileActor 2025-10-07 12:17:40.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406541885873860:4001], duration: 0.069705s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406541885873893:4012], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:40.545117Z
2025-10-07T09:17:40.550104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.550 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:40.550648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.550 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.550921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.550 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:40.553277Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.553 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:40.560670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:40.564187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.564 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:40.566803Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.566 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:40.567204Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.566 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:40.567249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.567 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:40.567294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.567 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:40.570499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.570 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:40.570701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.570 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.570865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.570 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.570902Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.570 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.572845Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:40.574931Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:40.577641Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.577 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:40.581195Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:40.586262Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.586584Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.586620Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.587322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:40.587631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:40.587666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:40.590084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.590 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:40.620661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:40.620758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:40.620804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:40.620850Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:40.620941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:40.620984Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.620 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:40.621025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:40.621061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:40.621183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:40.621223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:40.621266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:40.621400Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:40.621447Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:40.621496Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:40.621540Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.621585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:40.621627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:40.621665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:40.621700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.621 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:40.622515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcma0fwegdgst192vvv3y, SessionId: CompileActor 2025-10-07 12:17:40.622 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406541885873893:4012], duration: 0.077353s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406546180841235:4028], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:41.132501Z
2025-10-07T09:17:41.137111Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.137 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:41.137592Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.137 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.137833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.137 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406546180841256:4038], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:41.140135Z
2025-10-07T09:17:41.140280Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.140 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:41.144293Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.144 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:41.144732Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.144 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.144969Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.144 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.146374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.146 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:41.147340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.147 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:41.150905Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.150 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:41.152964Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.152 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:41.153561Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:41.153995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:41.154039Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:41.154077Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:41.156196Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.156 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:41.157560Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:41.157763Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.157933Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.157972Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.158521Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:41.158886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:41.158924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:41.158956Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.158 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:41.160048Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.160 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:41.161971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:41.162148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.161 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.162169Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.162 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:41.162300Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.162 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.162333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.162 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.164033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:41.164944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.164 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:41.165892Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.165 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:41.168385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.168 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:41.168628Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.168 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:41.171668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.171 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:41.173951Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.174279Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.173 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.174316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.175001Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.174 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.175310Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.175 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.175346Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.175 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.176416Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.176718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.176753Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.177410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.177701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.177735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.177786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:41.180021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.179 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:41.208296Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:41.208391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:41.208437Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:41.208484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:41.208655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:41.208699Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:41.208744Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:41.208776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:41.208900Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:41.208940Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:41.208978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.208 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:41.209115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:41.209160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:41.209164Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:41.209212Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:41.209236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:41.209260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.209281Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:41.209306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:41.209323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:41.209347Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.209383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:41.209392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:41.209415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:41.209426Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:41.209457Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:41.209489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:41.209589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:41.209624Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:41.209659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:41.209772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:41.209811Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:41.209857Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:41.209897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.209936Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:41.209973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.210005Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:41.210036Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:41.210181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwb51v8epzejkyd74sb, SessionId: CompileActor 2025-10-07 12:17:41.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406546180841235:4028], duration: 0.077638s
2025-10-07T09:17:41.210710Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcmwk19my4hk1dy4ae6fv, SessionId: CompileActor 2025-10-07 12:17:41.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406546180841256:4038], duration: 0.070538s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406546180841304:4051], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:41.483554Z
2025-10-07T09:17:41.488386Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:41.488868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.489109Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.490612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:41.497152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.497 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:41.500847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.500 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:41.503799Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:41.504273Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.503 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:41.504320Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:41.504359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:41.507977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.507 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:41.508191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.508373Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.508412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.510507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:41.512753Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.512 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:41.515637Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.515 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:41.519097Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.519 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:41.524045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.523 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.524408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.524 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.524444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.524 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.525122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.524 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.525426Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.525 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.525460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.525 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.527888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.527 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:41.558901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.558 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:41.558993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.558 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:41.559035Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:41.559079Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:41.559165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:41.559206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:41.559247Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:41.559279Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:41.559399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:41.559435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:41.559469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:41.559593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:41.559633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:41.559681Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:41.559719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.559766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:41.559805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.559837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:41.559867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:41.560574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcn7a817g2ebs5aknxfx2, SessionId: CompileActor 2025-10-07 12:17:41.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406546180841304:4051], duration: 0.076979s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406546180841337:4062], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:41.629567Z
2025-10-07T09:17:41.634107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:41.634587Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.634835Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.634 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:41.637029Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:41.643655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.643 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:41.646840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.646 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:41.649147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:41.649516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:41.649555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:41.649587Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:41.652344Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.652 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:41.652518Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.652 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.652663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.652 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.652694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.652 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.654391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:41.656230Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.656 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:41.658644Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.658 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:41.661851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:41.666526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.666828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.666862Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.667538Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:41.667829Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:41.667862Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:41.670130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.670 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:41.698382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:41.698457Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:41.698499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:41.698538Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:41.698611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:41.698648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:41.698683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:41.698713Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:41.698813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:41.698848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:41.698881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:41.698995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.698 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:41.699033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:41.699078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:41.699115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.699152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:41.699188Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:41.699219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:41.699253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:41.699952Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnbw4xp1sts2csp5475w, SessionId: CompileActor 2025-10-07 12:17:41.699 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406546180841337:4062], duration: 0.070348s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406550475808703:4089], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:42.222370Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406550475808705:4090], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:42.222962Z
2025-10-07T09:17:42.226940Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.226 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:42.227420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.227662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.227722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:42.228206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.228453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.229162Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.229 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:42.230898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.230 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:42.235839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.235 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:42.237604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.237 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:42.239080Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.239 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:42.240937Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.240 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:42.241450Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.241 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:42.241819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.241 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:42.241860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.241 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:42.241894Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.241 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:42.243333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:42.243726Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:42.243765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:42.243799Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.243 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:42.244758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:42.244934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.245081Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.244 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.245113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.245 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.246817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.246 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:42.246991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.246 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:42.247170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.247 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.247324Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.247 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.247358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.247 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.248664Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.248 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:42.249137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.249 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:42.251050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.251 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:42.251128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.251 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:42.253560Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.253 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:42.254401Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.254 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:42.256889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.256 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:42.259208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.258 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.259521Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.259555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.260216Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.260517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.260553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.261748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.262059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.262094Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.262 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.262768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.262 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.262843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.262 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:42.263067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.262 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.263102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.263 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.265418Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:42.292663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:42.292734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:42.292775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:42.292813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:42.292879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:42.292917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:42.292951Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:42.292982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:42.293078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:42.293113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:42.293146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:42.293264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:42.293302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:42.293346Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:42.293383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.293421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:42.293457Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.293489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:42.293519Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.293 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:42.294191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd1j3zw3a806sgsf6a, SessionId: CompileActor 2025-10-07 12:17:42.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406550475808703:4089], duration: 0.071783s
2025-10-07T09:17:42.295054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:42.295134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:42.295175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:42.295220Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:42.295304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:42.295342Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:42.295379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:42.295412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:42.295521Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:42.295556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:42.295591Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:42.295709Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:42.295748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:42.295795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:42.295833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.295874Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:42.295911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.295944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:42.295975Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.295 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:42.296715Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcnyd5ttdc582tqrs58ef, SessionId: CompileActor 2025-10-07 12:17:42.296 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406550475808705:4090], duration: 0.073712s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406550475808770:4110], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:42.567698Z
2025-10-07T09:17:42.572191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:42.572659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.572901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.574436Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:42.580877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.580 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:42.584050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.584 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:42.586359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:42.586716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:42.586754Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:42.586785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.586 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:42.589453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:42.589627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.589771Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.589804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.591459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.591 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:42.593285Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:42.595692Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.595 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:42.598880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.598 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:42.603530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.603 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.603833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.603 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.603867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.603 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.604520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.604 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.604812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.604 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.604844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.604 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.607105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.607 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:42.636043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:42.636114Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:42.636153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:42.636191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:42.636261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:42.636299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:42.636333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:42.636364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:42.636457Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:42.636492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:42.636525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:42.636636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:42.636674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:42.636718Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:42.636754Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.636792Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:42.636828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.636860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:42.636888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.636 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:42.637551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcp964xch2szhxwfn9xdj, SessionId: CompileActor 2025-10-07 12:17:42.637 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406550475808770:4110], duration: 0.069815s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406550475808803:4121], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:42.707471Z
2025-10-07T09:17:42.711694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:42.712152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.712402Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.712 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:42.714594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:42.721117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.721 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:42.724359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.724 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:42.726653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:42.727007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:42.727044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:42.727076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:42.729728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:42.729899Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.730042Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.730074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.730 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.731722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:42.733548Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.733 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:42.735949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.735 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:42.739133Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.739 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:42.743756Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.744058Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.744091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.744744Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:42.745034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:42.745067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.745 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:42.747318Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:42.775193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:42.775266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:42.775305Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:42.775342Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:42.775410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:42.775446Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:42.775480Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:42.775510Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:42.775603Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:42.775638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:42.775671Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:42.775779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:42.775817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:42.775860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:42.775897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.775934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:42.775970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:42.776002Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.775 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:42.776031Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.776 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:42.776720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcpdj9wvaew5rtkayy8m9, SessionId: CompileActor 2025-10-07 12:17:42.776 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406550475808803:4121], duration: 0.069212s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406554770776168:4148], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:43.305736Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406554770776170:4149], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:43.306339Z
2025-10-07T09:17:43.310294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.310 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:43.310770Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.310 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.311011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.310 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.311158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:43.311672Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.311924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.312523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.312 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:43.314014Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.313 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:43.319216Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.319 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:43.321059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.321 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:43.322552Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.322 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:43.324562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.324 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:43.324947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.324 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:43.325313Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.325 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:43.325353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.325 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:43.325385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.325 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:43.327019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.326 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:43.327412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.327 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:43.327453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.327 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:43.327487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.327 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:43.328170Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:43.328354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.328501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.328533Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.328 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.330256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:43.330661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:43.330847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.331000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.330 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.331034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.331 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.332127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.332 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:43.332853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.332 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:43.334592Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.334 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:43.334895Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.334 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:43.337686Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:43.337853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:43.341086Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.341 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:43.342659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.342 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.342976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.342 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.343009Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.342 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.343674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.343972Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.344005Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.343 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.346053Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.346328Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:43.346376Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.346415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.347121Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.346 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.347435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.347 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.347470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.347 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.349903Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.349 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:43.375353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:43.375426Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:43.375467Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:43.375516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:43.375580Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:43.375618Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:43.375653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:43.375683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:43.375780Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:43.375814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:43.375847Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:43.375957Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:43.375995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.375 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:43.376040Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:43.376076Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.376114Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:43.376151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.376181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:43.376210Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:43.376879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq086g1wv49h52ddqj3v, SessionId: CompileActor 2025-10-07 12:17:43.376 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406554770776168:4148], duration: 0.071105s
2025-10-07T09:17:43.379623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:43.379711Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:43.379755Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:43.379802Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:43.379886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:43.379930Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:43.379970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:43.380006Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.379 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:43.380124Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:43.380163Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:43.380202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:43.380334Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:43.380375Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:43.380423Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:43.380465Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.380506Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:43.380546Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.380579Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:43.380610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.380 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:43.381401Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcq0952bxtd3d2bhrtrmq, SessionId: CompileActor 2025-10-07 12:17:43.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406554770776170:4149], duration: 0.075021s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406554770776235:4169], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:43.645056Z
2025-10-07T09:17:43.649487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:43.649943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.650185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.649 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.651650Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.651 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:43.658071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.658 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:43.661246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:43.663548Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:43.663904Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:43.663941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:43.663972Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:43.666626Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:43.666798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.666942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.666974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.668623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:43.670447Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.670 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:43.672843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.672 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:43.676039Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.676 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:43.680677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.680979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.681013Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.681669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.681959Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.681991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.684259Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.684 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:43.714829Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:43.714902Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:43.714944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:43.714983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:43.715054Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:43.715092Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:43.715127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:43.715159Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:43.715261Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:43.715297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:43.715331Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:43.715443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:43.715485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:43.715533Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:43.715572Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.715610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:43.715648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.715679Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:43.715709Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:43.716407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqaw7vnnzsm4ndnxwhfv, SessionId: CompileActor 2025-10-07 12:17:43.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406554770776235:4169], duration: 0.071312s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406554770776287:4188], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:43.783994Z
2025-10-07T09:17:43.788397Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.788 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:43.788858Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.788 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.789103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.788 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:43.791233Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:43.797562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.797 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:43.800728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.800 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:43.803122Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.803 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:43.803494Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.803 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:43.803532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.803 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:43.803565Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.803 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:43.806206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.806 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:43.806386Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.806 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.806534Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.806 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.806567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.806 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.808272Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.808 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:43.810151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.810 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:43.812631Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.812 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:43.815865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:43.820501Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.820804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.820838Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.820 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.821492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:43.821781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:43.821814Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.821 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:43.824061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:43.853485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:43.853568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:43.853616Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:43.853662Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:43.853742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:43.853787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:43.853828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:43.853865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:43.853977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:43.854022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:43.854059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:43.854190Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:43.854242Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:43.854296Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:43.854343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.854388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:43.854433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:43.854470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:43.854506Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.854 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:43.855285Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcqf7aw3zjdbf4vr4htn9, SessionId: CompileActor 2025-10-07 12:17:43.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406554770776287:4188], duration: 0.071253s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406559065743648:4213], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:44.386324Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406559065743653:4216], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:44.388696Z
2025-10-07T09:17:44.391196Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.391 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:44.391701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.391 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.391952Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.391 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.393168Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.393 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:44.393524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.393 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:44.393651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.393 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.393900Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.393 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.396057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.396 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:44.400311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.400 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:44.402712Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.402 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:44.403623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.403 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:44.405970Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.405 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:44.406029Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.405 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:44.406421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.406 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:44.406460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.406 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:44.406493Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.406 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:44.408359Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:44.408729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:44.408768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:44.408799Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.408 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:44.409737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:44.409923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.410073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.409 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.410107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.410 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.411582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:44.411761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.411910Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.411920Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:44.411943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.411 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.413702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:44.413840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:44.415629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:44.416362Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.416 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:44.418176Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.418 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:44.419737Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.419 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:44.421580Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.421 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:44.424961Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.425312Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.424 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.425351Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.426098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.425 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.426422Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.426 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.426435Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.426 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.426470Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.426 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.426727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.426 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.426761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.426 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.427437Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.427740Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.427773Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.429086Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.429 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:44.430055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:44.458467Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:44.458536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:44.458576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:44.458614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:44.458677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:44.458714Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:44.458748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:44.458779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:44.458872Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:44.458907Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:44.458940Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.458 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:44.459047Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:44.459085Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:44.459128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:44.459165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.459202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:44.459243Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.459275Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:44.459304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:44.459347Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:44.459433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:44.459474Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:44.459517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:44.459602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:44.459641Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:44.459677Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:44.459709Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:44.459821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:44.459856Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:44.459892Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:44.459987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr24dvrhs14j53axknta, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406559065743653:4216], duration: 0.071254s
2025-10-07T09:17:44.460011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:44.460050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:44.460096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:44.460135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.460177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:44.460215Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.460252Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:44.460282Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:44.460975Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcr210m6r6tkbg0c4dj7e, SessionId: CompileActor 2025-10-07 12:17:44.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406559065743648:4213], duration: 0.074611s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406559065743716:4235], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:44.723331Z
2025-10-07T09:17:44.727725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:44.728184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.728431Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.728 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.729964Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:44.736460Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.736 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:44.739636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.739 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:44.741932Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.741 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:44.742294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:44.742331Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:44.742364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.742 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:44.745037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.745 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:44.745211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.745 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.745362Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.745 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.745394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.745 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.747050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:44.748875Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:44.751291Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.751 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:44.754472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.754 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:44.759127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.758 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.759433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.759 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.759467Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.759 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.760115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.759 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.760408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.760 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.760441Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.760 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.762691Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.762 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:44.791341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:44.791415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:44.791454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:44.791493Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:44.791562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:44.791599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:44.791634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:44.791665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:44.791761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:44.791796Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:44.791829Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:44.791940Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:44.791978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.791 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:44.792022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:44.792061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.792098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:44.792134Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.792165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:44.792194Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:44.792863Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrcjcngqwdjq3ady1sx5, SessionId: CompileActor 2025-10-07 12:17:44.792 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406559065743716:4235], duration: 0.069494s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406559065743749:4246], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:44.862142Z
2025-10-07T09:17:44.866370Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:44.866812Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.867049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.866 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:44.869109Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:44.875444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.875 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:44.878608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.878 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:44.880909Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:44.881269Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:44.881306Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:44.881337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:44.884012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:44.884182Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.884330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.884362Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.886009Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.885 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:44.887828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:44.890239Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.890 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:44.893414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.893 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:44.898034Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.898338Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.898371Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.899022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:44.899315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.899 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:44.899348Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.899 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:44.901593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.901 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:44.929374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:44.929444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:44.929482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:44.929523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:44.929599Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:44.929635Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:44.929670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:44.929700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:44.929792Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:44.929827Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:44.929859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:44.929966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:44.930004Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.929 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:44.930049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:44.930085Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.930125Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:44.930161Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:44.930192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:44.930221Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:44.930909Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcrgx5atbtmrm3ff2tcwr, SessionId: CompileActor 2025-10-07 12:17:44.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406559065743749:4246], duration: 0.068730s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406563360711114:4273], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:45.471190Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406563360711116:4274], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:45.471781Z
2025-10-07T09:17:45.475955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.475 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:45.476330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:45.476449Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.476691Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.476804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.477045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.476 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.478417Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.478 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:45.478952Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.478 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:45.485267Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:45.485536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.485 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:45.488615Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:45.488806Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.488 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:45.491028Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.490 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:45.491186Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:45.491416Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:45.491454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:45.491487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:45.491551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:45.491590Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:45.491622Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.491 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:45.494601Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:45.494607Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:45.494773Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.494783Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.494921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.494926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.494953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.494955Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.494 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.496678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:45.496754Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.496 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:45.498557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.498 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:45.498668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.498 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:45.501071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.501 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:45.501181Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.501 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:45.504371Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:45.504439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.504 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:45.509290Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.509302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.508 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.509604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.509615Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.509639Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.509647Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.509 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.510319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.510344Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.510620Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.510654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.510658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.510690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.510 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.512995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.512 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:45.513174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.513 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:45.541568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:45.541638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:45.541678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:45.541717Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:45.541780Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:45.541817Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:45.541851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:45.541881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:45.541977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:45.542011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.541 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:45.542044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:45.542155Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:45.542193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:45.542242Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:45.542280Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:45.542318Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:45.542354Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:45.542385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:45.542415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.542 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:45.543110Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3y5e2sq9sw0rad3tdx, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406563360711114:4273], duration: 0.071882s
2025-10-07T09:17:45.543165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:45.543253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:45.543294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:45.543337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:45.543420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:45.543459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:45.543495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:45.543527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:45.543638Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:45.543675Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:45.543709Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:45.543829Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:45.543869Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:45.543915Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:45.543954Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:45.543994Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.543 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:45.544032Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:45.544064Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:45.544096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:45.544804Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcs3yadwheaxx7p1d003p, SessionId: CompileActor 2025-10-07 12:17:45.544 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406563360711116:4274], duration: 0.072983s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406563360711179:4293], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:45.800108Z
2025-10-07T09:17:45.804897Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.804 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:45.805393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.805642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.805 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.807205Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.807 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:45.813666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.813 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:45.816839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.816 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:45.819148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:45.819519Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:45.819557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:45.819588Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:45.822527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.822 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:45.822701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.822 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.822846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.822 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.822878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.822 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.824543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:45.826372Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:45.828767Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.828 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:45.831964Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.831 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:45.836619Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.836923Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.836956Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.837610Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.837901Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.837934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.837 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.840200Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.840 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:45.868854Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.868 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:45.868927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.868 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:45.868967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.868 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:45.869005Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.868 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:45.869074Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:45.869111Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:45.869146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:45.869178Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:45.869281Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:45.869316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:45.869350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:45.869463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:45.869503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:45.869547Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:45.869585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:45.869624Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:45.869661Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:45.869693Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:45.869723Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.869 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:45.870404Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcse7d94pa927z93h0xcc, SessionId: CompileActor 2025-10-07 12:17:45.870 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406563360711179:4293], duration: 0.070257s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406563360711212:4304], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:45.938144Z
2025-10-07T09:17:45.942573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:45.943018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.942 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.943260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.943 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:45.945376Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.945 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:45.952805Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.952 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:45.956727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.956 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:45.959556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:45.959996Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.959 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:45.960042Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:45.960081Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.960 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:45.963453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:45.963665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.963842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.963882Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.965926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.965 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:45.968165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.968 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:45.970983Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.970 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:45.974285Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.974 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:45.979089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.978 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.979405Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.979441Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.980117Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:45.980421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:45.980456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.980 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:45.982794Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:45.982 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:46.011818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:46.011890Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:46.011927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:46.011967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:46.012046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:46.012084Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:46.012119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:46.012151Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:46.012257Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:46.012292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:46.012327Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:46.012441Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:46.012480Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:46.012525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:46.012563Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.012602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:46.012639Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.012670Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:46.012700Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:46.013403Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcsjh32rf36swe8wj0ddr, SessionId: CompileActor 2025-10-07 12:17:46.013 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406563360711212:4304], duration: 0.075220s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406567655678558:4323], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:46.554887Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406567655678560:4324], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:46.555468Z
2025-10-07T09:17:46.559849Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.559 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:46.560049Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:46.560361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:46.560532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:46.560616Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:46.560776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.560 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:46.562392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.562 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:46.563062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.563 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:46.568927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.568 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:46.569830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.569 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:46.572154Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.572 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:46.573223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.573 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:46.574516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:46.574887Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:46.574925Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:46.574957Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.574 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:46.575682Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.575 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:46.576062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.575 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:46.576102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.576 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:46.576135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.576 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:46.577786Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.577 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:46.577966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.577 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.578116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.577 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.578149Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.578 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.579546Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.579 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:46.579728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.579 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.579877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.579 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.579885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.579 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:46.579911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.579 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.581651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:46.581795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.581 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:46.583507Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.583 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:46.584316Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.584 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:46.585993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.585 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:46.587695Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.587 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:46.589320Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.589 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:46.592514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.592 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.592824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.592 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.592858Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.592 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.593543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.593836Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.593870Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.594192Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.593 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.594509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.594547Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.595218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.594 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.595523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.595 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.595558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.595 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.596142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.596 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:46.597900Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.597 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:46.625918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.625 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:46.625992Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.625 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:46.626033Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:46.626075Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:46.626264Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:46.626305Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:46.626342Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:46.626375Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:46.626480Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:46.626517Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:46.626553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:46.626672Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:46.626712Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:46.626759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:46.626798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.626838Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:46.626877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.626910Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:46.626941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.626 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:46.627160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:46.627250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:46.627292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:46.627335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:46.627415Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:46.627454Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:46.627490Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:46.627523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:46.627653Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5te33csaehwtw83rkx, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406567655678560:4324], duration: 0.072137s
2025-10-07T09:17:46.627654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:46.627687Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:46.627722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:46.627840Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:46.627881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:46.627927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:46.627966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.628006Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.627 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:46.628044Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.628077Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:46.628107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:46.628860Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzct5t3w35dyj3rf0271ds, SessionId: CompileActor 2025-10-07 12:17:46.628 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406567655678558:4323], duration: 0.073931s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406567655678622:4343], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:46.877961Z
2025-10-07T09:17:46.882586Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.882 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:46.883067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.882 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:46.883319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.883 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:46.885013Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.884 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:46.891659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.891 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:46.894953Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.894 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:46.897350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:46.897719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:46.897759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:46.897792Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.897 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:46.900614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.900 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:46.900795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.900 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.900944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.900 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.900978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.900 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.902701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.902 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:46.904583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.904 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:46.907025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.906 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:46.910219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:46.914877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.914 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.915179Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.914 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.915213Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.915 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.915869Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.915 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:46.916160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.915 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:46.916193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:46.918463Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.918 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:46.947216Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:46.947292Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:46.947332Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:46.947368Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:46.947440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:46.947473Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:46.947503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:46.947530Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:46.947624Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:46.947655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:46.947685Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:46.947795Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:46.947834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:46.947879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:46.947917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.947956Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:46.947994Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.947 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:46.948025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.948 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:46.948055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.948 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:46.948733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctfx78hw8wxx3cbdvyc2, SessionId: CompileActor 2025-10-07 12:17:46.948 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406567655678622:4343], duration: 0.070732s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406571950645970:4362], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:47.021023Z
2025-10-07T09:17:47.025381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.025 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:47.025834Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.025 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.026073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.025 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.028339Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:47.035244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.035 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:47.038725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.038 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:47.041367Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.041 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:47.041798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.041 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:47.041842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.041 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:47.041878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.041 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:47.045052Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:47.045250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.045406Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.045440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.047268Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.047 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:47.049250Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:47.051853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.051 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:47.055297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:47.060503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.060827Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.060863Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.061568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.061 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.061881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.061 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.061916Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.061 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.064339Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:47.093679Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:47.093772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:47.093816Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:47.093859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:47.093947Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:47.093987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.093 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:47.094024Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:47.094057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:47.094171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:47.094208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:47.094248Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:47.094369Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:47.094410Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:47.094456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:47.094495Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:47.094536Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:47.094574Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:47.094606Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:47.094637Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.094 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:47.095378Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzctmca269rw3k0dp262dg, SessionId: CompileActor 2025-10-07 12:17:47.095 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406571950645970:4362], duration: 0.074314s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406571950646019:4381], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:47.639663Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406571950646021:4382], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:47.640233Z
2025-10-07T09:17:47.644641Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:47.644725Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:47.645158Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.645191Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.644 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.645423Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.645 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.645438Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.645 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.647060Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:47.647728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.647 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:47.654421Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:47.654438Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.654 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:47.657761Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.657 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:47.658096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.658 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:47.660165Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:47.660532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:47.660569Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:47.660594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:47.660602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:47.661000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.660 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:47.661041Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:47.661075Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.661 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:47.663652Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:47.663830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.663974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.664007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.663 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.664333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.664 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:47.664564Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.664 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.664722Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.664 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.664757Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.664 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.665726Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.665 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:47.666576Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.666 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:47.667596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.667 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:47.668492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.668 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:47.670069Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.670 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:47.671021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.670 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:47.673374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.673 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:47.674449Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.674 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:47.678116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.677 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.678428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.678 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.678462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.678 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.679123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.678 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.679418Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.679453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.679513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.679839Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.679876Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.679 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.680568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.680871Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.680906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.680 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.681727Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.681 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:47.683330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.683 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:47.710353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:47.710427Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:47.710468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:47.710509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:47.710578Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:47.710617Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:47.710655Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:47.710688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:47.710791Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:47.710828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:47.710863Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:47.710979Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:47.711019Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.710 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:47.711067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:47.711106Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:47.711146Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:47.711185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:47.711220Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:47.711256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:47.711974Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7peve7a5tjh4a16r8a, SessionId: CompileActor 2025-10-07 12:17:47.711 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406571950646019:4381], duration: 0.072272s
2025-10-07T09:17:47.714668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:47.714755Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:47.714798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:47.714843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:47.714946Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:47.714987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.714 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:47.715025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:47.715059Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:47.715173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:47.715211Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:47.715253Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:47.715378Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:47.715420Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:47.715471Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:47.715512Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:47.715553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:47.715594Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:47.715627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:47.715659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.715 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:47.716391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcv7q4fq235ajf168ngje, SessionId: CompileActor 2025-10-07 12:17:47.716 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406571950646021:4382], duration: 0.076116s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406571950646106:4410], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:47.956028Z
2025-10-07T09:17:47.961130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:47.961658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.961918Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.961 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:47.963554Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:47.970341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.970 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:47.973636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.973 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:47.976021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.975 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:47.976412Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:47.976451Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:47.976485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.976 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:47.979581Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:47.979762Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.979912Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.979946Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.981682Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.981 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:47.983567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.983 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:47.986114Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.986 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:47.989520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.989 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:47.994355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.994676Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.994713Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.995409Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:47.995720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:47.995755Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:47.998172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:47.998 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:48.028311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:48.028386Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:48.028428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:48.028469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:48.028544Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:48.028583Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:48.028619Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:48.028652Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:48.028752Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:48.028788Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:48.028823Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:48.028939Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:48.028978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.028 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:48.029025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:48.029065Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.029105Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:48.029144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.029177Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:48.029208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:48.029895Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvhk4y7m8ypsch8pygjy, SessionId: CompileActor 2025-10-07 12:17:48.029 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406571950646106:4410], duration: 0.073829s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406576245613434:4421], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:48.102503Z
2025-10-07T09:17:48.107069Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:48.107540Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:48.107785Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:48.110101Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.110 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:48.117456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.117 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:48.121097Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:48.123659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:48.124093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:48.124137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:48.124173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.124 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:48.127569Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:48.127759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.127913Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.127950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.127 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.129779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.129 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:48.131748Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.131 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:48.134401Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.134 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:48.137830Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.137 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:48.142778Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.143103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.142 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.143139Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.143 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.143842Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.143 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.144153Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.143 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.144189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.144 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.146592Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.146 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:48.176689Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:48.176778Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:48.176819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:48.176861Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:48.176944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:48.176982Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:48.177018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.176 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:48.177050Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:48.177160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:48.177196Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:48.177233Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:48.177355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:48.177394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:48.177440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:48.177477Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.177516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:48.177553Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.177585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:48.177614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.177 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:48.178340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcvp59s82stc501jjgfzc, SessionId: CompileActor 2025-10-07 12:17:48.178 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406576245613434:4421], duration: 0.075797s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406576245613480:4438], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:48.721765Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406576245613485:4441], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:48.724318Z
2025-10-07T09:17:48.726768Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.726 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:48.727294Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:48.727554Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.727 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:48.728880Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.728 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:48.729364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:48.729611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.729 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:48.730183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.730 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:48.731077Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.731 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:48.737649Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:48.737889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.737 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:48.740980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.740 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:48.741523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.741 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:48.743411Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:48.743781Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:48.743821Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:48.743856Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:48.744017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.743 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:48.744424Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:48.744465Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:48.744500Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.744 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:48.746708Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.746 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:48.746886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.746 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.747038Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.746 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.747071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.747926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:48.748115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.747 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.748276Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.748311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.748782Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.748 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:48.750124Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:48.750629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.750 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:48.752123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.752 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:48.753093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.753 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:48.754766Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.754 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:48.756403Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.756 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:48.758219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.758 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:48.761208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.760 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.761520Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.761556Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.762223Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.761 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.762524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.762 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.762558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.762 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.763269Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.762 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.763596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.763 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.763633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.763 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.764350Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.764 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:48.764692Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.764 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:48.764729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.764 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:48.764846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.764 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:48.767242Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.767 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:48.794239Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:48.794315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:48.794355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:48.794396Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:48.794462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:48.794499Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:48.794534Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:48.794566Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:48.794665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:48.794701Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:48.794735Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:48.794848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:48.794887Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:48.794950Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:48.794990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.794 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.795029Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:48.795066Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.795098Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:48.795128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:48.795793Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9k0ywvp81d5a7phj3p, SessionId: CompileActor 2025-10-07 12:17:48.795 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406576245613485:4441], duration: 0.071438s
2025-10-07T09:17:48.798733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:48.798819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:48.798861Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:48.798904Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:48.798984Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:48.799022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.798 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:48.799058Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:48.799091Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:48.799202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:48.799243Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:48.799281Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:48.799399Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:48.799439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:48.799487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:48.799526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.799566Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:48.799604Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:48.799636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:48.799667Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.799 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:48.800407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcw9hfqrj6mhsrxrz4qj7, SessionId: CompileActor 2025-10-07 12:17:48.800 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406576245613480:4438], duration: 0.078601s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406580540580866:4469], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:49.037716Z
2025-10-07T09:17:49.042977Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.042 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:49.043531Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.043 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.043808Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.043 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.045526Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:49.051999Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.051 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:49.055168Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.055 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:49.057516Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.057 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:49.057898Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.057 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:49.057938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.057 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:49.057972Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.057 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:49.060973Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:49.061152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.060 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.061302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.061 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.061335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.061 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.063022Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.062 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:49.064851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.064 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:49.067323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.067 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:49.070612Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.070 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:49.075297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.074 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.075601Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.075 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.075636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.075 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.076291Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.076 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.076582Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.076 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.076616Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.076 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.078881Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.078 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:49.107532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:49.107606Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:49.107642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:49.107684Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:49.107758Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:49.107797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:49.107833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:49.107866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:49.107966Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:49.108002Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.107 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:49.108040Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:49.108157Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:49.108197Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:49.108249Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:49.108288Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.108327Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:49.108364Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.108396Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:49.108427Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.108 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:49.109087Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwkd7g4tdkyd24vaw80q, SessionId: CompileActor 2025-10-07 12:17:49.109 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406580540580866:4469], duration: 0.071334s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406580540580901:4481], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:49.186008Z
2025-10-07T09:17:49.190440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.190 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:49.190885Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.190 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.191123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.190 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.193466Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.193 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:49.200628Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.200 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:49.204070Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.204 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:49.206720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.206 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:49.207149Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.206 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:49.207193Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.207 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:49.207235Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.207 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:49.210542Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:49.210733Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.210886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.210920Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.210 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.212724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.212 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:49.214636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.214 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:49.217184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.217 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:49.220765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.220 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:49.226173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.225 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.226522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.226 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.226562Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.226 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.227311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.226 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.227642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.227680Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.227 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.230160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.230 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:49.259683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:49.259778Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:49.259820Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:49.259863Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:49.259949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:49.259988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.259 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:49.260025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:49.260058Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:49.260172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:49.260208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:49.260246Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:49.260372Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:49.260413Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:49.260459Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:49.260497Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.260538Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:49.260575Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.260608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:49.260641Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.260 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:49.261379Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcwr13p87z8kqj59hshvv, SessionId: CompileActor 2025-10-07 12:17:49.261 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406580540580901:4481], duration: 0.075330s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406580540580967:4507], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:49.810693Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406580540580969:4508], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:49.811301Z
2025-10-07T09:17:49.815301Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:49.815775Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.816018Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.815 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.816102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.816 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:49.816608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.816 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.816861Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.816 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:49.817514Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.817 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:49.819115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.819 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:49.824102Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.824 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:49.826509Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.826 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:49.827355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.827 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:49.829719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.829 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:49.830090Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.829 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:49.830128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:49.830128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:49.830160Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.830 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:49.832601Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.832 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:49.832995Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.832 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:49.833037Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.833 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:49.833066Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.833 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:49.833071Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.833 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:49.833247Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.833 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.833393Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.833 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.833426Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.833 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.835123Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.835 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:49.836299Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:49.836484Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.836634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.836668Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.836971Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.836 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:49.838456Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.838 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:49.839430Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.839 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:49.840377Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.840 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:49.842714Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:49.842997Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.842 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:49.846486Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.846 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:49.847532Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.847837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.847871Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.847 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.848542Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.848833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.848868Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.848 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.851208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.851 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:49.851633Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.851 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.851975Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.851 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.852011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.851 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.852716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:49.853026Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.852 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:49.853062Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.853 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:49.855503Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.855 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:49.880851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:49.880926Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:49.880967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:49.881008Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.880 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:49.881078Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:49.881116Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:49.881152Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:49.881185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:49.881290Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:49.881326Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:49.881361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:49.881474Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:49.881513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:49.881558Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:49.881596Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.881634Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:49.881674Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.881706Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:49.881736Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.881 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:49.882419Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh0hhndnh7v61z33d0, SessionId: CompileActor 2025-10-07 12:17:49.882 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406580540580967:4507], duration: 0.071687s
2025-10-07T09:17:49.886575Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:49.886659Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:49.886702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:49.886747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:49.886843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:49.886886Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:49.886924Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:49.886957Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.886 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:49.887075Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:49.887113Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:49.887148Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:49.887270Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:49.887309Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:49.887355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:49.887394Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.887433Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:49.887472Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:49.887504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:49.887535Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.887 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:49.888260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxbh3b29qrve3vndqgdb, SessionId: CompileActor 2025-10-07 12:17:49.888 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406580540580969:4508], duration: 0.076916s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406584835548330:4528], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:50.116144Z
2025-10-07T09:17:50.121311Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:50.121846Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.122103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.121 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.123836Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.123 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:50.130525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.130 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:50.133808Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.133 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:50.136187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:50.136572Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:50.136611Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:50.136644Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.136 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:50.139698Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.139 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:50.139877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.139 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.140027Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.139 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.140061Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.140 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.141774Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.141 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:50.143663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.143 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:50.146144Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.146 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:50.149436Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.149 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:50.154244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.153 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.154557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.154592Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.155268Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.154 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.155567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.155602Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.155 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.157945Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.157 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:50.187161Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:50.187239Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:50.187279Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:50.187319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:50.187391Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:50.187428Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:50.187464Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:50.187496Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:50.187593Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:50.187629Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:50.187663Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:50.187776Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:50.187818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:50.187864Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:50.187903Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.187942Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:50.187980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.188013Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.187 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:50.188043Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:50.188715Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxn3d31mqajk402kc00z, SessionId: CompileActor 2025-10-07 12:17:50.188 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406584835548330:4528], duration: 0.072532s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406584835548365:4540], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:50.268624Z
2025-10-07T09:17:50.273070Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.273 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:50.273527Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.273 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.273765Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.273 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.275998Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.275 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:50.282353Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.282 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:50.285525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.285 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:50.287832Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.287 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:50.288189Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.287 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:50.288232Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.288 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:50.288265Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.288 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:50.290991Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.290 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:50.291180Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.291 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.291333Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.291 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.291366Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.291 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.293016Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.292 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:50.294853Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:50.297337Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:50.300598Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.300 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:50.305236Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.304 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.305539Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.305573Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.306230Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.305 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.306523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.306 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.306557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.306 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.308811Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.308 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:50.336879Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:50.336949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:50.336990Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.336 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:50.337029Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:50.337099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:50.337136Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:50.337171Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:50.337203Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:50.337304Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:50.337340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:50.337374Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:50.337483Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:50.337522Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:50.337567Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:50.337605Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.337646Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:50.337684Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.337716Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:50.337747Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.337 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:50.338439Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcxsv0eb622ah11vp6r0c, SessionId: CompileActor 2025-10-07 12:17:50.338 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406584835548365:4540], duration: 0.069778s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406584835548430:4564], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:50.893468Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406584835548435:4567], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:50.896253Z
2025-10-07T09:17:50.898266Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:50.898753Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.899003Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.898 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.900549Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.900 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:50.901099Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.901 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:50.901609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.901 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.901859Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.901 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:50.904199Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.904 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:50.907138Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.907 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:50.910469Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:50.910927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.910 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:50.912798Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:50.913163Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.912 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:50.913202Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.913 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:50.913239Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.913 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:50.914248Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.914 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:50.916056Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:50.916235Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.916383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.916417Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.916706Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:50.917088Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.916 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:50.917128Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.917 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:50.917161Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.917 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:50.918119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.918 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:50.919967Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.919 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:50.920487Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:50.920669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.920818Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.920851Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.920 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.922400Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.922 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:50.922636Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.922 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:50.924550Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.924 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:50.925760Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.925 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:50.927119Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.927 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:50.930486Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:50.930673Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.930978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.931012Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.930 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.931678Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.931987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.932024Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.931 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.934382Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.934 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:50.935370Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.935683Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.935719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.935 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.936397Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.936 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:50.936707Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.936 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:50.936742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.936 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:50.939108Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.939 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:50.963605Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:50.963681Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:50.963719Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:50.963759Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.963 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:50.964109Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:50.964147Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:50.964183Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:50.964214Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:50.964319Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:50.964355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:50.964390Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:50.964504Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:50.964543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:50.964589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:50.964627Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.964666Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:50.964707Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.964739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:50.964769Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.964 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:50.965443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydc1hax9xsgrm6ed6kw, SessionId: CompileActor 2025-10-07 12:17:50.965 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406584835548430:4564], duration: 0.071937s
2025-10-07T09:17:50.969057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:50.969142Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:50.969187Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:50.969238Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:50.969330Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:50.969370Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:50.969407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:50.969440Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:50.969551Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:50.969589Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:50.969624Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:50.969750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:50.969794Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:50.969845Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:50.969889Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.969934Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:50.969976Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:50.970011Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.969 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:50.970045Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.970 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:50.970850Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcydfdjdkcrppswnr641s, SessionId: CompileActor 2025-10-07 12:17:50.970 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406584835548435:4567], duration: 0.074554s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406589130515799:4588], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:51.196529Z
2025-10-07T09:17:51.200993Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.200 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:51.201462Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.201702Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.201 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.203260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.203 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:51.209844Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.209 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:51.213103Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.213 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:51.215492Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.215 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:51.215865Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.215 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:51.215904Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.215 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:51.215938Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.215 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:51.218780Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.218 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:51.218954Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.218 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.219100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.218 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.219132Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.219 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.220831Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.220 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:51.222703Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.222 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:51.225107Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.225 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:51.228385Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.228 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:51.233172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.232 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.233488Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.233523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.234174Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.233 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.234468Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.234502Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.234 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.236779Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.236 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:51.265871Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:51.265944Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:51.265980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:51.266021Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.265 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:51.266096Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:51.266135Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:51.266172Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:51.266204Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:51.266310Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:51.266346Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:51.266381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:51.266498Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:51.266538Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:51.266584Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:51.266623Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:51.266665Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:51.266699Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:51.266734Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:51.266764Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.266 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:51.267464Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcypv9v3whsg5e8ntr4q4, SessionId: CompileActor 2025-10-07 12:17:51.267 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406589130515799:4588], duration: 0.070896s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406589130515833:4599], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:51.345783Z
2025-10-07T09:17:51.350159Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:51.350609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.350848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.350 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.353007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.352 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:51.359341Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.359 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:51.362513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.362 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:51.364824Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.364 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:51.365180Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.364 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:51.365218Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.365 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:51.365256Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.365 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:51.367932Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.367 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:51.368100Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.367 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.368247Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.368 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.368280Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.368 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.369931Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.369 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:51.371780Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.371 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:51.374206Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.374 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:51.377401Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.377 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:51.382067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.381 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.382373Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.382407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.383060Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.382 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.383355Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.383 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.383388Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.383 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.385637Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.385 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:51.413728Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:51.413797Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:51.413837Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:51.413876Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:51.413943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:51.413980Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:51.414015Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.413 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:51.414046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:51.414140Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:51.414175Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:51.414209Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:51.414322Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:51.414361Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:51.414405Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:51.414443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:51.414482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:51.414519Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:51.414550Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:51.414577Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.414 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:51.415263Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzcyvh51xmr4a3snr4fe9c, SessionId: CompileActor 2025-10-07 12:17:51.415 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406589130515833:4599], duration: 0.069438s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406589130515877:4614], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:51.974708Z
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406589130515884:4618], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:51.977641Z
2025-10-07T09:17:51.979403Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:51.979887Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.980137Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.979 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.981658Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.981 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:51.982546Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.982 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:51.983046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.982 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.983309Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.983 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:51.985723Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.985 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:51.988407Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.988 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:51.991772Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.991 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:51.992445Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.992 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:51.994184Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:51.994568Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:51.994608Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:51.994642Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.994 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:51.995739Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.995 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:51.997555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.997 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:51.997729Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.997 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:51.997873Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.997 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:51.997906Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.997 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:51.998130Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.998 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:51.998524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.998 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:51.998564Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.998 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:51.998597Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:51.998 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:51.999595Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:51.999 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:52.001443Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.001 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:52.001757Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.001 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:52.001941Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.001 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.002093Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.001 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.002127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.002 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.003878Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.003 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:52.003914Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.003 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:52.005800Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.005 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:52.007127Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.007 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:52.008315Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.008 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:52.011720Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:52.011919Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.012222Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.011 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.012260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.012917Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.013220Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.012 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.013260Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.013 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.015613Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.015 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:52.016614Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.016 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.016927Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.016 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.016963Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.016 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.017641Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.017943Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.017978Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.017 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.020317Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.020 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:52.044914Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.044 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:52.044987Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.044 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:52.045028Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:52.045067Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:52.045136Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:52.045173Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:52.045208Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:52.045244Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:52.045345Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:52.045380Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:52.045414Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:52.045525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:52.045564Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:52.045609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:52.045648Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.045687Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:52.045724Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.045757Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:52.045787Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.045 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:52.046464Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf6bqx7fx895xy3743p, SessionId: CompileActor 2025-10-07 12:17:52.046 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406589130515877:4614], duration: 0.071717s
2025-10-07T09:17:52.048922Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:52.049004Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.048 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:52.049046Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:52.049089Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:52.049178Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:52.049219Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:52.049265Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:52.049297Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:52.049408Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:52.049444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:52.049478Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:52.049586Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:52.049624Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:52.049669Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:52.049707Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.049744Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:52.049782Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.049813Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:52.049843Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.049 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:52.050543Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczf91z3awhejn5cjrd5q, SessionId: CompileActor 2025-10-07 12:17:52.050 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406589130515884:4618], duration: 0.072867s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406593425483265:4647], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/initialization/migrations`;\n", startTime: 2025-10-07T09:17:52.274844Z
2025-10-07T09:17:52.279609Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:52.280095Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.279 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:52.280343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.280 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356EE9C700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/initialization/migrations"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:52.281895Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.281 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:52.288513Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.288 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:52.291750Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.291 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:52.294115Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:52.294485Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/initialization/migrations")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:52.294523Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:52.294555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.294 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:52.297515Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:52.297688Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 313 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.297833Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 313 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.297866Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.297 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.299521Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.299 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:52.301339Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.301 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:52.303742Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.303 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:52.306928Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.306 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:52.311575Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 425 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.311877Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 425 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.311911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.311 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.312563Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.312 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 426 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.312854Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.312 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 426 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/initialization/migrations" '"72057594046644480:8" '"" '1))
(let $2 '('"componentId" '"instant" '"modificationId"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '1)) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '338) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '351))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.312888Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.312 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.315141Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.315 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 338
2025-10-07T09:17:52.344215Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #268
2025-10-07T09:17:52.344298Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Nth> finished execution
2025-10-07T09:17:52.344340Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Nth> created 0 trackable nodes: 
2025-10-07T09:17:52.344381Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Async
2025-10-07T09:17:52.344453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #268
2025-10-07T09:17:52.344489Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #268
2025-10-07T09:17:52.344524Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #280
2025-10-07T09:17:52.344555Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #280, status: Ok
2025-10-07T09:17:52.344651Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #268<KiExecDataQuery!> finished execution
2025-10-07T09:17:52.344687Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #268<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:52.344721Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<Left!> finished execution
2025-10-07T09:17:52.344828Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #278<ResPull!> finished execution
2025-10-07T09:17:52.344867Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #278<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:52.344911Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #279<Commit!> finished execution
2025-10-07T09:17:52.344949Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #279<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.344988Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.344 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #280<Commit!> finished execution
2025-10-07T09:17:52.345025Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #280<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.345057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #280, status: Ok
2025-10-07T09:17:52.345088Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #280
2025-10-07T09:17:52.345751Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczrjfcs4xt3c4p362y1q, SessionId: CompileActor 2025-10-07 12:17:52.345 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406593425483265:4647], duration: 0.070870s
---- traceId: verbosity = 0, trace_id = 0
---- Start compilation , traceid0, self: [1:7558406593425483298:4658], cluster: db, database: /Root, text: "SELECT * FROM `//Root/.metadata/secrets/values`;\n", startTime: 2025-10-07T09:17:52.422882Z
2025-10-07T09:17:52.427482Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1342: Good place to weld in
2025-10-07T09:17:52.427946Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_host.cpp:1347: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:52.428185Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.427 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_host.cpp:1353: Compiled query:
(
(let $1 (Read! world (DataSource '"kikimr" '"db") (Key '('table (String '"//Root/.metadata/secrets/values"))) (Void) '()))
(let $2 (DataSink 'result))
(let $3 (Right! $1))
(let $4 (Write! (Left! $1) $2 (Key) (RemoveSystemMembers (PersistableRepr (SqlProject $3 '((SqlProjectStarItem (TypeOf $3) '"" (lambda '($5) $5) '()))))) '('('type) '('autoref))))
(return (Commit! $4 $2))
)
2025-10-07T09:17:52.430392Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.430 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:1418: RewriteIO
2025-10-07T09:17:52.436819Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.436 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KIKIMR] yql_kikimr_opt_build.cpp:1281: KiBuildQuery
2025-10-07T09:17:52.440057Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.440 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [RESULT] yql_result_provider.cpp:773: ResPull
2025-10-07T09:17:52.442444Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core] yql_linear_checker.cpp:210: Scanned 0 static linear types
2025-10-07T09:17:52.442810Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] kqp_transform.cpp:33: Optimized expr:
(
(let $1 (DataSink '"kikimr" '"db"))
(let $2 '"//Root/.metadata/secrets/values")
(let $3 '('('"mode" '"flush")))
(let $4 (KiExecDataQuery! world $1 (DataQueryBlocks (TKiDataQueryBlock '('((Take (Right! (KiReadTable! world (DataSource '"kikimr" '"db") (Key '('table (String $2))) (Void) '())) (Uint64 '"1001")) '() '"1000")) (KiEffects) '('('"db" $2 '"Select")) '())) $3 (Void)))
(let $5 (DataSink 'result))
(let $6 (ResPull! (Left! $4) $5 (Key) (Nth (Right! $4) '0) '('('type) '('autoref)) '"kikimr"))
(return (Commit! (Commit! $6 $5) $1 $3))
)
2025-10-07T09:17:52.442848Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:52.442883Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.442 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:52.445694Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.445 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] kqp_runner.cpp:294: Taking the old RBO branch
2025-10-07T09:17:52.445872Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.445 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 310 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('('((Take $3 (Uint64 '"1001")) '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.446020Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.445 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 310 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (KqlReadTableRanges $1 (Void) $2 '() '()))
(return '('('((Take $3 (Uint64 '"1001")) '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.446055Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.446 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.447796Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.447 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildReadTableRangesStage
2025-10-07T09:17:52.449690Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.449 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-BuildTakeStage<false>
2025-10-07T09:17:52.452178Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.452 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-ApplyLimitToReadTable
2025-10-07T09:17:52.455384Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.455 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [KQP] yql_optimize.cpp:135: KqpPhysical-RewriteKqpReadTable
2025-10-07T09:17:52.460017Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.459 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 422 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.460323Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 422 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.460358Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.461007Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.460 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:32: -------- block transformer start: 423 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('('($8 '())) '())))
)
-------- block transformer end
2025-10-07T09:17:52.461302Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.461 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:59: --------! block transformer block start: 423 n: 0 (
(let $1 (KqpTable '"//Root/.metadata/secrets/values" '"72057594046644480:10" '"" '3))
(let $2 '('"ownerUserId" '"secretId" '"value"))
(let $3 (Uint64 '"1001"))
(let $4 (KqpRowsSourceSettings $1 $2 '('('"ItemsLimit" $3) '('"Sequential" '"1")) (Void) '()))
(let $5 (DqStage '((DqSource (DataSource '"KqpReadRangesSource") $4)) (lambda '($9) (Take (ToFlow $9) $3)) '('('"_logical_id" '335) '('"_partition_mode" '"single"))))
(let $6 (DqCnUnionAll (TDqOutput $5 '"0")))
(let $7 (DqStage '($6) (lambda '($10) (Take $10 $3)) '('('"_logical_id" '348))))
(let $8 (DqCnUnionAll (TDqOutput $7 '"0")))
(return '('('($8 '())) '()))
)
-------- block transformer block end
2025-10-07T09:17:52.461335Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.461 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_query_blocks_transformer.cpp:68: -------- Do Block:0
2025-10-07T09:17:52.463585Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.463 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core dq] dq_opt_build.cpp:482: Enabled wide channels for stage with logical id = 335
2025-10-07T09:17:52.492225Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:523: Register async execution for node #265
2025-10-07T09:17:52.492303Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #274<Nth> finished execution
2025-10-07T09:17:52.492343Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #274<Nth> created 0 trackable nodes: 
2025-10-07T09:17:52.492383Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Async
2025-10-07T09:17:52.492453Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:139: Completed async execution for node #265
2025-10-07T09:17:52.492490Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:159: State is ExecutionRequired after apply async changes for node #265
2025-10-07T09:17:52.492525Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:62: Begin, root #277
2025-10-07T09:17:52.492557Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:75: Collect unused nodes for root #277, status: Ok
2025-10-07T09:17:52.492654Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #265<KiExecDataQuery!> finished execution
2025-10-07T09:17:52.492689Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #265<KiExecDataQuery!> created 0 trackable nodes: 
2025-10-07T09:17:52.492723Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #272<Left!> finished execution
2025-10-07T09:17:52.492836Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #275<ResPull!> finished execution
2025-10-07T09:17:52.492876Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #275<ResPull!> created 0 trackable nodes: 
2025-10-07T09:17:52.492921Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #276<Commit!> finished execution
2025-10-07T09:17:52.492960Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #276<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.493000Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.492 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:634: Node #277<Commit!> finished execution
2025-10-07T09:17:52.493039Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:651: Node #277<Commit!> created 0 trackable nodes: 
2025-10-07T09:17:52.493073Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:93: Finish, output #277, status: Ok
2025-10-07T09:17:52.493104Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [core exec] yql_execution.cpp:99: Creating finalizing transformer, output #277
2025-10-07T09:17:52.493806Z node 1 :KQP_YQL INFO: log.cpp:67: TraceId: 01k6yzczx65bpkw2rhgcrtr9e9, SessionId: CompileActor 2025-10-07 12:17:52.493 INFO  ydb-core-kqp-ut-federated_query-datastreams(pid=3331286, tid=0x00007F356F69D700) [default] kqp_compile_actor.cpp:565: ---- Compilation successful: 0, self: [1:7558406593425483298:4658], duration: 0.070886s
[[bad]]assertion failed at ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:285, std::vector<TResultSet> NKikimr::NKqp::(anonymous namespace)::TStreamingTestFixture::ExecQuery(const TString &, EStatus, const TString &): (result.GetStatus() == expectedStatus) failed: (GENERIC_ERROR != SUCCESS) { <main>: Error: Executing operation with object "STREAMING_QUERY", code: 2035 subissue: { <main>: Error: <main>: Fatal: Streaming query initialization failed     <main>: Fatal: Start streaming query failed         <main>: Fatal: Query compilation / planing failed             <main>: Warning: Execution, code: 1060                 <main>:14:79: Warning: Cost Based Optimizer could not be applied to this query: couldn't load statistics, code: 8001             <main>: Fatal: Execution, code: 1060                 <main>: Fatal: ydb/core/kqp/expr_nodes/kqp_expr_nodes.gen.h:13061  TKqlQueryStub(): requirement Match(node.Get()) failed, code: 1, code: 2035 } }, with diff:
[[rst]]([[good]]GENERI[[rst]]|[[bad]]SUC[[rst]])C([[good]]_[[rst]]|[[bad]][[rst]])E([[good]]RROR[[rst]]|[[bad]]SS[[rst]])[[rst]]
[[alt1]]0. /-S/util/system/backtrace.cpp:102: BackTrace(void**, unsigned long) @ 0x3D8E02AC
1. /-S/util/system/backtrace.cpp:284: TBackTrace::Capture() @ 0x3D8E083F
2. /-S/library/cpp/testing/unittest/registar.cpp:46: NUnitTest::NPrivate::RaiseError(char const*, TBasicString<char, std::__y1::char_traits<char>> const&, bool) @ 0x3DB124DE
3. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:285: NKikimr::NKqp::(anonymous namespace)::TStreamingTestFixture::ExecQuery(TBasicString<char, std::__y1::char_traits<char>> const&, NYdb::Dev::EStatus, TBasicString<char, std::__y1::char_traits<char>> const&) @ 0x3D6DAE70
4. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:1792: NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TTestCaseStreamingQueryWithYdbJoin::Execute_(NUnitTest::TTestContext&) @ 0x3D6F31F1
5. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:1255: NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()::operator()() const @ 0x3D733F6B
6. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__type_traits/invoke.h:149: decltype(std::declval<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()&>()()) std::__y1::__invoke[abi:fe200000]<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()&>(NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()&) @ 0x3D733EE4
7. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__type_traits/invoke.h:224: void std::__y1::__invoke_void_return_wrapper<void, true>::__call[abi:fe200000]<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()&>(NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()&) @ 0x3D733EC4
8. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__functional/function.h:169: std::__y1::__function::__alloc_func<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'(), std::__y1::allocator<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()>, void ()>::operator()[abi:fe200000]() @ 0x3D733EA4
9. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__functional/function.h:314: std::__y1::__function::__func<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'(), std::__y1::allocator<NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute()::'lambda'()>, void ()>::operator()() @ 0x3D733A58
10. /-S/contrib/libs/cxxsupp/libcxx/include/__functional/function.h:431: std::__y1::__function::__value_func<void ()>::operator()[abi:fe200000]() const @ 0x3BEDEEED
11. /-S/contrib/libs/cxxsupp/libcxx/include/__functional/function.h:990: std::__y1::function<void ()>::operator()() const @ 0x3BEDEE64
12. /-S/library/cpp/testing/unittest/utmain.cpp:525: TColoredProcessor::Run(std::__y1::function<void ()>, TBasicString<char, std::__y1::char_traits<char>> const&, char const*, bool) @ 0x3DB37885
13. /-S/library/cpp/testing/unittest/registar.cpp:373: NUnitTest::TTestBase::Run(std::__y1::function<void ()>, TBasicString<char, std::__y1::char_traits<char>> const&, char const*, bool) @ 0x3DB1499F
14. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:1255: NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute() @ 0x3D733028
15. /-S/library/cpp/testing/unittest/registar.cpp:494: NUnitTest::TTestFactory::Execute() @ 0x3DB15213
16. /-S/library/cpp/testing/unittest/utmain.cpp:872: NUnitTest::RunMain(int, char**) @ 0x3DB3574A
17. /-S/library/cpp/testing/unittest_main/main.cpp:4: main @ 0x3DB34811
18. ??:0: ?? @ 0x7F35A8A50082
19. ??:0: ?? @ 0x3BD86028
[[rst]]
VERIFY failed (2025-10-07T12:17:53.118595+0300): Actual function call count doesn't match EXPECT_CALL(*Mock_, ReadSplitsImpl(ProtobufRequestMatcher(*Result_)))...
         Expected: to be called twice
           Actual: never called - unsatisfied and active
 in non-unittest thread with message:
/home/s2m1/dev/ydb/ydb/library/yql/providers/generic/connector/libcpp/ut_helpers/connector_client_mock.h:827:
Actual function call count doesn't match EXPECT_CALL(*Mock_, ReadSplitsImpl(ProtobufRequestMatcher(*Result_)))...
         Expected: to be called twice
           Actual: never called - unsatisfied and active
  library/cpp/testing/unittest/registar.cpp:36
  RaiseError(): requirement UnittestThread failed
0. /-S/util/system/backtrace.cpp:102: BackTrace(void**, unsigned long) @ 0x3D8E02AC
1. /-S/util/system/backtrace.cpp:265: FormatBackTrace(IOutputStream*) @ 0x3D8E078F
2. /-S/util/system/backtrace.cpp:274: PrintBackTrace() @ 0x3D8E07E0
3. /-S/util/system/yassert.cpp:83: NPrivate::InternalPanicImpl(int, char const*, char const*, int, int, int, TBasicStringBuf<char, std::__y1::char_traits<char>>, char const*, unsigned long) @ 0x3D92049F
4. /-S/util/system/yassert.cpp:55: NPrivate::Panic(NPrivate::TStaticBuf const&, int, char const*, char const*, char const*, ...) @ 0x3D91467D
5. /-S/library/cpp/testing/unittest/registar.cpp:36: NUnitTest::NPrivate::RaiseError(char const*, TBasicString<char, std::__y1::char_traits<char>> const&, bool) @ 0x3DB123B1
6. /-S/library/cpp/testing/gmock_in_unittest/events.cpp:30: TGMockTestEventListener::OnTestPartResult(testing::TestPartResult const&) @ 0x4F587510
7. /-S/contrib/restricted/googletest/googletest/src/gtest.cc:3907: testing::internal::TestEventRepeater::OnTestPartResult(testing::TestPartResult const&) @ 0x4F54C604
8. /-S/contrib/restricted/googletest/googletest/src/gtest.cc:1067: testing::internal::DefaultGlobalTestPartResultReporter::ReportTestPartResult(testing::TestPartResult const&) @ 0x4F53EE9E
9. /-S/contrib/restricted/googletest/googletest/src/gtest.cc:1076: testing::internal::DefaultPerThreadTestPartResultReporter::ReportTestPartResult(testing::TestPartResult const&) @ 0x4F53EFD9
10. /-S/contrib/restricted/googletest/googletest/src/gtest.cc:5450: testing::UnitTest::AddTestPartResult(testing::TestPartResult::Type, char const*, int, std::__y1::basic_string<char, std::__y1::char_traits<char>, std::__y1::allocator<char>> const&, std::__y1::basic_string<char, std::__y1::char_traits<char>, std::__y1::allocator<char>> const&) @ 0x4F53BF07
11. /-S/contrib/restricted/googletest/googletest/src/gtest.cc:487: testing::internal::AssertHelper::operator=(testing::Message const&) const @ 0x4F53BB12
12. /-S/contrib/restricted/googletest/googlemock/src/gmock-internal-utils.cc:108: testing::internal::GoogleTestFailureReporter::ReportFailure(testing::internal::FailureReporterInterface::FailureType, char const*, int, std::__y1::basic_string<char, std::__y1::char_traits<char>, std::__y1::allocator<char>> const&) @ 0x4F57F36F
13. /home/s2m1/dev/ydb/contrib/restricted/googletest/googlemock/include/gmock/internal/gmock-internal-utils.h:259: testing::internal::Expect(bool, char const*, int, std::__y1::basic_string<char, std::__y1::char_traits<char>, std::__y1::allocator<char>> const&) @ 0x3D74BCFB
14. /-S/contrib/restricted/googletest/googlemock/src/gmock-spec-builders.cc:424: testing::internal::UntypedFunctionMockerBase::VerifyAndClearExpectationsLocked() @ 0x4F57D102
15. /home/s2m1/dev/ydb/contrib/restricted/googletest/googlemock/include/gmock/gmock-spec-builders.h:1471: testing::internal::FunctionMocker<NYql::NConnector::TIteratorResult<NYql::NConnector::IStreamIterator<NYql::NConnector::NApi::TReadSplitsResponse>> (NYql::NConnector::NApi::TReadSplitsRequest const&)>::~FunctionMocker() @ 0x3D747DBE
16. /home/s2m1/dev/ydb/ydb/library/yql/providers/generic/connector/libcpp/ut_helpers/connector_client_mock.h:247: NYql::NConnector::NTest::TConnectorClientMock::~TConnectorClientMock() @ 0x3D741C7D
17. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__memory/allocator.h:154: std::__y1::allocator<NYql::NConnector::NTest::TConnectorClientMock>::destroy[abi:fe200000](NYql::NConnector::NTest::TConnectorClientMock*) @ 0x3D7504A9
18. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__memory/allocator_traits.h:335: void std::__y1::allocator_traits<std::__y1::allocator<NYql::NConnector::NTest::TConnectorClientMock>>::destroy[abi:fe200000]<NYql::NConnector::NTest::TConnectorClientMock, 0>(std::__y1::allocator<NYql::NConnector::NTest::TConnectorClientMock>&, NYql::NConnector::NTest::TConnectorClientMock*) @ 0x3D75047C
19. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__memory/shared_ptr.h:317: void std::__y1::__shared_ptr_emplace<NYql::NConnector::NTest::TConnectorClientMock, std::__y1::allocator<NYql::NConnector::NTest::TConnectorClientMock>>::__on_zero_shared_impl[abi:fe200000]<std::__y1::allocator<NYql::NConnector::NTest::TConnectorClientMock>, 0>() @ 0x3D75044D
20. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__memory/shared_ptr.h:320: std::__y1::__shared_ptr_emplace<NYql::NConnector::NTest::TConnectorClientMock, std::__y1::allocator<NYql::NConnector::NTest::TConnectorClientMock>>::__on_zero_shared() @ 0x3D741384
21. /-S/contrib/libs/cxxsupp/libcxx/include/__memory/shared_ptr.h:173: std::__y1::__shared_count::__release_shared[abi:fe200000]() @ 0x3BE14E7C
22. /-S/contrib/libs/cxxsupp/libcxx/include/__memory/shared_ptr.h:219: std::__y1::__shared_weak_count::__release_shared[abi:fe200000]() @ 0x3BE14E38
23. /home/s2m1/dev/ydb/contrib/libs/cxxsupp/libcxx/include/__memory/shared_ptr.h:694: std::__y1::shared_ptr<NYql::NConnector::IClient>::~shared_ptr[abi:fe200000]() @ 0x3D6FD367
24. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:37: NKikimr::NKqp::(anonymous namespace)::TStreamingTestFixture::~TStreamingTestFixture() @ 0x3D6FCD1D
25. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:1671: NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TTestCaseStreamingQueryWithYdbJoin::~TTestCaseStreamingQueryWithYdbJoin() @ 0x3D6F5C84
26. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:1671: NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TTestCaseStreamingQueryWithYdbJoin::~TTestCaseStreamingQueryWithYdbJoin() @ 0x3D6F5CA8
27. /home/s2m1/dev/ydb/util/generic/ptr.h:36: void CheckedDelete<NUnitTest::TBaseTestCase>(NUnitTest::TBaseTestCase*) @ 0x3D6FB868
28. /home/s2m1/dev/ydb/util/generic/ptr.h:57: void TDelete::Destroy<NUnitTest::TBaseTestCase>(NUnitTest::TBaseTestCase*) @ 0x3D6FB824
29. /home/s2m1/dev/ydb/util/generic/ptr.h:376: THolder<NUnitTest::TBaseTestCase, TDelete>::DoDestroy() @ 0x3D6FB805
30. /home/s2m1/dev/ydb/util/generic/ptr.h:306: THolder<NUnitTest::TBaseTestCase, TDelete>::~THolder() @ 0x3D6F96E4
31. /home/s2m1/dev/ydb/ydb/core/kqp/ut/federated_query/datastreams/datastreams_ut.cpp:1255: NKikimr::NKqp::NTestSuiteKqpStreamingQueriesDdl::TCurrentTest::Execute() @ 0x3D733110
32. /-S/library/cpp/testing/unittest/registar.cpp:494: NUnitTest::TTestFactory::Execute() @ 0x3DB15213
33. /-S/library/cpp/testing/unittest/utmain.cpp:872: NUnitTest::RunMain(int, char**) @ 0x3DB3574A
34. /-S/library/cpp/testing/unittest_main/main.cpp:4: main @ 0x3DB34811
35. ??:0: ?? @ 0x7F35A8A50082
36. ??:0: ?? @ 0x3BD86028
