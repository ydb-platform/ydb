import "ydb/public/api/protos/draft/ydb_backup.proto";
import "ydb/public/api/protos/ydb_issue_message.proto";
import "ydb/public/api/protos/ydb_status_codes.proto";

import "google/protobuf/timestamp.proto";

package NKikimrBackup;
option java_package = "ru.yandex.kikimr.proto";

message TEvFetchBackupCollectionsRequest {
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional string UserSID = 3;
}

message TEvFetchBackupCollectionsResponse {
}

message TEvListBackupCollectionsRequest {
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional string UserSID = 3;
}

message TEvListBackupCollectionsResponse {
}

message TEvCreateBackupCollectionRequest {
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional string UserSID = 3;
}

message TEvCreateBackupCollectionResponse {
}

message TEvReadBackupCollectionRequest {
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional string UserSID = 3;
}

message TEvReadBackupCollectionResponse {
}

message TEvUpdateBackupCollectionRequest {
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional string UserSID = 3;
}

message TEvUpdateBackupCollectionResponse {
}

message TEvDeleteBackupCollectionRequest {
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional string UserSID = 3;
}

message TEvDeleteBackupCollectionResponse {
}

message TIncrementalBackup {
    optional uint64 Id = 1;
    optional Ydb.StatusIds.StatusCode Status = 2;
    repeated Ydb.Issue.IssueMessage Issues = 3;
    optional Ydb.Backup.BackupProgress.Progress Progress = 4;
    optional int32 ProgressPercent = 5;
    optional google.protobuf.Timestamp StartTime = 6;
    optional google.protobuf.Timestamp EndTime = 7;
    optional string UserSID = 8;
}

message TEvGetIncrementalBackupRequest {
    optional string DatabaseName = 1;
    optional uint64 IncrementalBackupId = 2;
}

message TEvGetIncrementalBackupResponse {
    optional Ydb.StatusIds.StatusCode Status = 1;
    repeated Ydb.Issue.IssueMessage Issues = 2;
    optional TIncrementalBackup IncrementalBackup = 3;
}

message TEvForgetIncrementalBackupRequest{
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional uint64 IncrementalBackupId = 3;
}

message TEvForgetIncrementalBackupResponse {
    optional uint64 TxId = 1;
    optional Ydb.StatusIds.StatusCode Status = 2;
    repeated Ydb.Issue.IssueMessage Issues = 3;
}

message TEvListIncrementalBackupsRequest {
    optional string DatabaseName = 1;
    optional uint64 PageSize = 2;
    optional string PageToken = 3;
}

message TEvListIncrementalBackupsResponse {
    optional Ydb.StatusIds.StatusCode Status = 1;
    repeated Ydb.Issue.IssueMessage Issues = 2;
    repeated TIncrementalBackup Entries = 3;
    optional string NextPageToken = 4;
}

message TBackupCollectionRestore {
    optional uint64 Id = 1;
    optional Ydb.StatusIds.StatusCode Status = 2;
    repeated Ydb.Issue.IssueMessage Issues = 3;
    optional Ydb.Backup.RestoreProgress.Progress Progress = 4;
    optional int32 ProgressPercent = 5;
    optional google.protobuf.Timestamp StartTime = 6;
    optional google.protobuf.Timestamp EndTime = 7;
    optional string UserSID = 8;
}

message TEvGetBackupCollectionRestoreRequest {
    optional string DatabaseName = 1;
    optional uint64 BackupCollectionRestoreId = 2;
}

message TEvGetBackupCollectionRestoreResponse {
    optional Ydb.StatusIds.StatusCode Status = 1;
    repeated Ydb.Issue.IssueMessage Issues = 2;
    optional TBackupCollectionRestore BackupCollectionRestore = 3;
}

message TEvForgetBackupCollectionRestoreRequest{
    optional uint64 TxId = 1;
    optional string DatabaseName = 2;
    optional uint64 BackupCollectionRestoreId = 3;
}

message TEvForgetBackupCollectionRestoreResponse {
    optional uint64 TxId = 1;
    optional Ydb.StatusIds.StatusCode Status = 2;
    repeated Ydb.Issue.IssueMessage Issues = 3;
}

message TEvListBackupCollectionRestoresRequest {
    optional string DatabaseName = 1;
    optional uint64 PageSize = 2;
    optional string PageToken = 3;
}

message TEvListBackupCollectionRestoresResponse {
    optional Ydb.StatusIds.StatusCode Status = 1;
    repeated Ydb.Issue.IssueMessage Issues = 2;
    repeated TBackupCollectionRestore Entries = 3;
    optional string NextPageToken = 4;
}
