"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[1001],{66498:(e,t,a)=>{a.d(t,{a:()=>s.a});var s=a(41989)},50377:(e,t,a)=>{a.d(t,{P:()=>k});var s=a(41577),i=a(46878),l=a(65e3),n=a(25665),d=a(10142),r=a(99294),o=a(14075),c=a(70340),u=a(55842),v=a(62508),p=a(43862),h=a(90808),m=a(20760),g=a(37711);const b=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),x=(0,g.wZ)("ydb-pDisk-info",{en:b});var N=a(10161);const j=(0,r.cn)("ydb-pdisk-info");function k(e){let{pDisk:t,nodeId:a,withPDiskPageLink:r,className:g}=e;const b=(0,u.ix)(l.VH),[k,y,I,f]=function(e){let{pDisk:t,nodeId:a,withPDiskPageLink:s,isUserAllowedToMakeChanges:l}=e;const{PDiskId:r,Path:u,Guid:p,Category:g,Type:b,Device:k,Realtime:y,State:I,SerialNumber:f,TotalSize:w,AllocatedSize:D,StatusV2:T,NumActiveSlots:S,ExpectedSlotCount:P,LogUsedSize:z,LogTotalSize:V,SystemSize:A,SharedWithOs:C}=t||{},E=[];(0,n.D)(g)&&E.push({label:x("type"),value:b}),(0,n.D)(u)&&E.push({label:x("path"),value:u}),(0,n.D)(p)&&E.push({label:x("guid"),value:p}),f&&E.push({label:x("serial-number"),value:f}),(0,n.D)(C)&&E.push({label:x("shared-with-os"),value:x("yes")});const q=[];(0,n.D)(T)&&q.push({label:x("drive-status"),value:T}),(0,n.D)(I)&&q.push({label:x("state"),value:I}),(0,n.D)(k)&&q.push({label:x("device"),value:(0,N.jsx)(v.A,{status:k})}),(0,n.D)(y)&&q.push({label:x("realtime"),value:(0,N.jsx)(v.A,{status:y})});const R=[];R.push({label:x("space"),value:(0,N.jsx)(m.y,{value:D,capacity:w,formatValues:o.q3,colorizeProgress:!0})}),(0,n.D)(S)&&(0,n.D)(P)&&R.push({label:x("slots"),value:(0,N.jsx)(m.y,{value:S,capacity:P})}),(0,n.D)(z)&&(0,n.D)(V)&&R.push({label:x("log-size"),value:(0,N.jsx)(m.y,{value:z,capacity:V,formatValues:o.q3})}),(0,n.D)(A)&&R.push({label:x("system-size"),value:(0,d.td)({value:A})});const L=[];if((s||l)&&(0,n.D)(r)&&(0,n.D)(a)){const e=(0,i.ds)(r,a),t=(0,c.ok)({nodeId:a,pDiskId:r});L.push({label:x("links"),value:(0,N.jsxs)("span",{className:j("links"),children:[s&&(0,N.jsx)(h.j,{title:x("pdisk-page"),url:e,external:!1}),l&&(0,N.jsx)(h.j,{title:x("developer-ui"),url:t})]})})}return[E,q,R,L]}({pDisk:t,nodeId:a,withPDiskPageLink:r,isUserAllowedToMakeChanges:b});return(0,N.jsxs)(s.k,{className:g,gap:2,direction:"row",wrap:!0,children:[(0,N.jsxs)(s.k,{direction:"column",gap:2,width:500,children:[(0,N.jsx)(p._,{info:k,renderEmptyState:()=>null}),(0,N.jsx)(p._,{info:I,renderEmptyState:()=>null})]}),(0,N.jsxs)(s.k,{direction:"column",gap:2,width:500,children:[(0,N.jsx)(p._,{info:y,renderEmptyState:()=>null}),(0,N.jsx)(p._,{info:f,renderEmptyState:()=>null})]})]})}},59907:(e,t,a)=>{a.d(t,{f:()=>n});var s=a(2634),i=a(55973),l=a(10161);function n(e){let{state:t}=e;return(0,l.jsx)(s._,{theme:(0,i.KR)(t),children:t})}},26107:(e,t,a)=>{a.d(t,{$:()=>r});a(34706);var s=a(99294),i=a(10161);const l=(0,s.cn)("tag"),n=e=>{let{text:t,type:a}=e;return(0,i.jsx)("div",{className:l({type:a}),children:t})},d=(0,s.cn)("tags"),r=e=>{let{tags:t,tagsType:a,className:s=""}=e;return(0,i.jsx)("div",{className:d(null,s),children:t&&t.map(((e,t)=>(0,i.jsx)(n,{text:e,type:a},t)))})}},22439:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>be,STORAGE_ROLE:()=>ge});var s=a(34706),i=a(72555),l=a(42152),n=a(55783),d=a(26836),r=a(74003),o=a(15152),c=a(14561),u=a(99294),v=a(70340),p=a(62508),h=a(26107),m=a(10161);const g=(0,u.cn)("basic-node-viewer"),b=e=>{let t,{node:a,additionalNodesProps:i,className:l}=e;return null!==i&&void 0!==i&&i.getNodeRef?t=i.getNodeRef(a)+"internal":a.NodeId&&(t=(0,v.wq)(a.NodeId)+"internal"),(0,m.jsx)("div",{className:g(null,l),children:a?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:g("title"),children:"Node"}),(0,m.jsx)(p.A,{status:a.SystemState,name:a.Host}),t&&(0,m.jsx)("a",{rel:"noopener noreferrer",className:g("link",{external:!0}),href:t,target:"_blank",children:(0,m.jsx)(c.J,{data:o.Z})}),(0,m.jsxs)("div",{className:g("id"),children:[(0,m.jsx)("label",{className:g("label"),children:"NodeID"}),(0,m.jsx)("label",{children:a.NodeId})]}),a.DC&&(0,m.jsx)(h.$,{tags:[a.DC]}),a.Roles&&(0,m.jsx)(h.$,{tags:a.Roles,tagsType:"blue"})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var x=a(15327),N=a(27810),j=a(43862);const k=(0,u.cn)("ydb-pool-usage"),y=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},I=e=>{let{data:t={}}=e;const{Threads:a,Name:s="Unknown",Usage:i=0}=t,l=i&&a,n=Math.floor(100*i),d=n>100?100:n;return(0,m.jsxs)("div",{className:k(),children:[(0,m.jsxs)("div",{className:k("info"),children:[(0,m.jsx)("div",{className:k("pool-name"),children:s}),l&&(0,m.jsxs)("div",{className:k("value"),children:[(0,m.jsxs)("div",{className:k("percents"),children:[n<1?"<1":n,"%"]}),(0,m.jsxs)("div",{className:k("threads"),children:["(\xd7",a,")"]})]})]}),(0,m.jsx)("div",{className:k("visual"),children:(0,m.jsx)("div",{className:k("usage-line",{type:y(d)}),style:{width:`${d}%`}})})]})};var f=a(20760);const w=(0,u.cn)("full-node-viewer"),D=e=>{var t,a,s,i;let{node:l,className:n}=e;const d=null===l||void 0===l||null===(t=l.Endpoints)||void 0===t?void 0:t.map((e=>{let{Name:t,Address:a}=e;return{label:t,value:a}})),r=[];null!==l&&void 0!==l&&null!==(a=l.Tenants)&&void 0!==a&&a.length&&r.push({label:"Database",value:l.Tenants[0]}),r.push({label:"Version",value:null===l||void 0===l?void 0:l.Version},{label:"Uptime",value:null===l||void 0===l?void 0:l.Uptime},{label:"DC",value:(null===l||void 0===l?void 0:l.DataCenterDescription)||(null===l||void 0===l?void 0:l.DC)},{label:"Rack",value:null===l||void 0===l?void 0:l.Rack});const o=null===l||void 0===l||null===(s=l.LoadAveragePercents)||void 0===s?void 0:s.map(((e,t)=>({label:N.x5[t],value:(0,m.jsx)(f.y,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,m.jsx)("div",{className:`${w()} ${n}`,children:l?(0,m.jsxs)("div",{className:w("common-info"),children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:w("section-title"),children:"Pools"}),(0,m.jsx)("div",{className:w("section",{pools:!0}),children:null===l||void 0===l||null===(i=l.PoolStats)||void 0===i?void 0:i.map(((e,t)=>(0,m.jsx)(I,{data:e},t)))})]}),d&&d.length&&(0,m.jsx)(j._,{title:"Endpoints",className:w("section"),info:d}),(0,m.jsx)(j._,{title:"Common info",className:w("section"),info:r}),(0,m.jsx)(j._,{title:"Load average",className:w("section",{average:!0}),info:o})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var T=a(66498),S=a(46878),P=a(39202),z=a(85709),V=a(90195),A=a(55842),C=a(35120),E=a(28265),q=a(75544),R=a(55102),L=a.n(R),F=a(99495),O=a(67386),U=a(14075),_=a(84953);const Z=(0,O.P1)((e=>e),(e=>V.N.endpoints.getNodeStructure.select({nodeId:e}))),G=(0,O.P1)((e=>e),((e,t)=>Z(t)),((e,t)=>t(e).data)),J=(0,O.P1)(((e,t)=>Number(t)),((e,t)=>G(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,s={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var i;const l=null===(i=a.VDisks)||void 0===i?void 0:i.filter((t=>t.NodeId===e)).map(_.w);null===l||void 0===l||l.forEach((a=>{const i=(0,U.a2)(a.VDiskId),l=(0,_.b)(a.PDisk),n=l.PDiskId;s[String(n)]||(s[String(n)]={vDisks:{},...l}),s[String(n)].vDisks[i]={...a,PDiskId:n,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(s).reduce(((e,t)=>{const a=s[t].vDisks,i=Object.keys(a).reduce(((e,t,s)=>(e.push({...a[t],id:t,order:s}),e)),[]);return e[t]={...s[t],vDisks:i},e}),{})}));var $=a(29254),H=a(71624),M=a(72616),B=a(16318),K=a(81778),Q=a(50377),Y=a(49263),X=a(77468),W=a(38392),ee=a(25665),te=a(37711);const ae=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),se=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),ie=(0,te.wZ)("ydb-node-page",{en:ae,ru:se}),le=(0,u.cn)("kv-node-structure");function ne(e){let{label:t,value:a,className:s}=e;return(0,m.jsxs)("span",{className:le("pdisk-title-item",s),children:[t&&(0,m.jsxs)("span",{className:le("pdisk-title-item-label"),children:[t,":"]}),(0,m.jsx)("span",{className:le("pdisk-title-item-value"),children:a})]})}const de=(0,u.cn)("kv-node-structure");var re;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(re||(re={}));const oe={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function ce(e){let{pDiskId:t,selectedVdiskId:a,nodeId:s}=e;return[{name:re.slotId,header:oe[re.slotId],width:100,render:e=>{let{row:i}=e;const l=i.VDiskSlotId;let n=null;return(0,ee.D)(s)&&(0,ee.D)(t)&&(0,ee.D)(l)&&(n=(0,v.yf)({nodeId:s,pDiskId:t,vDiskSlotId:l})),(0,m.jsxs)("div",{className:de("vdisk-id",{selected:i.id===a}),children:[(0,m.jsx)("span",{children:l}),n&&(0,m.jsx)(M.z,{size:"s",className:de("external-button",{hidden:!0}),href:n,target:"_blank",title:ie("vdisk.developer-ui-button-title"),children:(0,m.jsx)(c.J,{data:o.Z})})]})},align:H.ZP.LEFT},{name:re.VDiskState,header:oe[re.VDiskState],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(p.A,{status:t.VDiskState===W.H.OK?X.K.Green:X.K.Red})},sortAccessor:e=>e.VDiskState===W.H.OK?1:0,align:H.ZP.CENTER},{name:re.Size,header:oe[re.Size],width:100,render:e=>{let{row:t}=e;return(0,m.jsx)(f.y,{value:t.AllocatedSize,capacity:Number(t.AllocatedSize)+Number(t.AvailableSize),formatValues:U.q3,colorizeProgress:!0})},sortAccessor:e=>Number(e.AllocatedSize),align:H.ZP.CENTER},{name:re.Info,header:oe[re.Info],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(B.J,{placement:["right"],content:(0,m.jsx)(Y.K,{data:t,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:de("vdisk-details"),children:(0,m.jsx)(M.z,{view:"flat-secondary",className:de("vdisk-details-button",{selected:t.id===a}),children:(0,m.jsx)(c.J,{data:$.Z,size:18})})})},sortable:!1}]}function ue(e){let{id:t,data:a,selectedVdiskId:i,nodeId:l,unfolded:n}=e;const[d,r]=s.useState(null!==n&&void 0!==n&&n),{TotalSize:o=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:h,vDisks:g}=a,b=Number(o),x=Number(c);return(0,m.jsxs)("div",{className:de("pdisk"),id:t,children:[(0,m.jsxs)("div",{className:de("pdisk-header"),children:[(0,m.jsxs)("div",{className:de("pdisk-title-wrapper"),children:[(0,m.jsx)(p.A,{status:u}),(0,m.jsx)(ne,{label:"PDiskID",value:v,className:de("pdisk-title-id")}),(0,m.jsx)(ne,{value:h,className:de("pdisk-title-type")}),(0,m.jsx)(f.y,{value:b-x,capacity:b,formatValues:U.q3,colorizeProgress:!0,className:de("pdisk-title-size")}),(0,m.jsx)(ne,{label:"VDisks",value:g.length})]}),(0,m.jsx)(M.z,{onClick:d?()=>{r(!1)}:()=>{r(!0)},view:"flat-secondary",children:(0,m.jsx)(K.F,{direction:d?"top":"bottom"})})]}),d&&(L()(a)?(0,m.jsx)("div",{children:"No information about PDisk"}):(0,m.jsxs)("div",{children:[(0,m.jsx)(Q.P,{pDisk:a,nodeId:l,className:de("pdisk-details"),withPDiskPageLink:!0}),(0,m.jsxs)("div",{className:de("vdisks-container"),children:[(0,m.jsx)("div",{className:de("vdisks-header"),children:"VDisks"}),(0,m.jsx)(H.ZP,{theme:"yandex-cloud",data:g,columns:ce({nodeId:l,pDiskId:v,selectedVdiskId:i}),settings:{...N.LE,dynamicRender:!1},rowClassName:e=>e.id===i?de("selected-vdisk"):""})]})]}))]})}const ve=(0,u.cn)("kv-node-structure");function pe(e){let{type:t,id:a}=e;return`${t}-${a}`}const he=function(e){let{nodeId:t,className:a}=e;const i=(0,A.ix)((e=>J(e,t))),[l]=(0,A.Rj)(),{currentData:n,isFetching:d,error:r}=V.N.useGetNodeStructureQuery({nodeId:t},{pollingInterval:l}),o=d&&void 0===n,[{pdiskId:c,vdiskId:u}]=(0,F.useQueryParams)({pdiskId:F.StringParam,vdiskId:F.StringParam}),v=s.useRef(null),p=s.useRef(!1);return s.useEffect((()=>{if(!L()(i)&&!p.current&&v.current&&c){const t=document.getElementById(pe({type:"pdisk",id:c}));let a=0;if(u){var e;const t=null===(e=i[c])||void 0===e?void 0:e.vDisks,s=null===t||void 0===t?void 0:t.find((e=>e.id===u)),l=s?document.querySelector(".data-table"):void 0,n=(null===s||void 0===s?void 0:s.order)||0;l&&(a+=l.offsetTop+40*n)}t&&(v.current.scrollTo({behavior:"smooth",top:a||t.offsetTop}),p.current=!0)}}),[i,c,u]),(0,m.jsxs)("div",{className:ve(),ref:v,children:[r?(0,m.jsx)(x.V,{error:r,className:ve("error")}):null,(0,m.jsx)("div",{className:a,children:o?(0,m.jsx)(T.a,{size:"m"}):r&&!n?null:(()=>{const e=Object.keys(i);return e.length>0?e.map((e=>(0,m.jsx)(ue,{data:i[e],id:pe({type:"pdisk",id:e}),unfolded:c===e,selectedVdiskId:u,nodeId:t},e))):"There is no information about node structure."})()})]})},me=(0,u.cn)("node"),ge="Storage";function be(e){var t,a;const o=s.useRef(null),c=(0,A.zL)(),u=(0,n.TH)(),v=null!==(t=(0,n.$B)(S.ZP.node))&&void 0!==t?t:Object.create(null),{id:p,activeTab:h}=v.params,{tenantName:g}=(0,S.mB)(u),[N]=(0,A.Rj)(),{currentData:j,isFetching:k,error:y}=V.N.useGetNodeInfoQuery({nodeId:p},{pollingInterval:N}),I=k&&void 0===j,f=j,w=(0,P.rU)(),R=(0,P.X_)(),{activeTabVerified:L,nodeTabs:F}=s.useMemo((()=>{var e;let t=(null===f||void 0===f||null===(e=f.Roles)||void 0===e?void 0:e.find((e=>e===ge)))?q.ZJ:q.ZJ.filter((e=>e.id!==q.P_));R&&(t=t.filter((e=>e.id!==q.pV)));const a=t.map((e=>({...e,title:e.name})));let s=a.find((e=>{let{id:t}=e;return t===h}));return s||(s=a[0]),{activeTabVerified:s,nodeTabs:a}}),[h,f,R]),O=(null===f||void 0===f||null===(a=f.Tenants)||void 0===a?void 0:a[0])||(null===g||void 0===g?void 0:g.toString());let U;if(f){var _;const e=!(null!==f&&void 0!==f&&null!==(_=f.Tenants)&&void 0!==_&&_[0]);U=e?"Storage":"Compute"}s.useEffect((()=>{c((0,z.J)("node",{tenantName:O,nodeRole:U,nodeId:p}))}),[c,O,p,U]);const Z=()=>{switch(L.id){case q.P_:return(0,m.jsx)("div",{className:me("storage"),children:(0,m.jsx)(C.V,{nodeId:p,parentRef:o})});case q.IA:return(0,m.jsx)(E.J,{nodeId:p,database:O,className:me("node-page-wrapper")});case q.pV:return(0,m.jsx)(he,{className:me("node-page-wrapper"),nodeId:p});case q.mD:return(0,m.jsx)(D,{node:f,className:me("overview-wrapper")});default:return!1}};return I||!w?(0,m.jsx)(T.a,{size:"l"}):f?(0,m.jsxs)("div",{className:me(null,e.className),ref:o,children:[(0,m.jsx)(l.ql,{titleTemplate:`%s \u2014 ${f.Host} \u2014 YDB Monitoring`,defaultTitle:`${f.Host} \u2014 YDB Monitoring`,children:(0,m.jsx)("title",{children:L.title})}),(0,m.jsx)(b,{node:f,additionalNodesProps:e.additionalNodesProps,className:me("header")}),y?(0,m.jsx)(x.V,{error:y,className:me("error")}):null,(0,m.jsxs)("div",{className:me("tabs"),children:[(0,m.jsx)(i.m,{size:"l",items:F,activeTab:L.id,wrapTo:(e,t)=>{let{id:a}=e;return(0,m.jsx)(d.rU,{to:(0,S.ax)(S.ZP.node,{id:p,activeTab:a},{tenantName:O}),className:me("tab"),children:t},a)},allowNotSelected:!0}),(0,m.jsx)(r.q,{})]}),(0,m.jsx)("div",{className:me("content"),children:Z()})]}):y?(0,m.jsx)(x.V,{error:y}):(0,m.jsx)("div",{className:"error",children:"no node data"})}},72427:(e,t,a)=>{a.d(t,{O:()=>T});var s=a(73878),i=a(23795),l=a(14561),n=a(55982),d=a(98779),r=a(62508),o=a(67653),c=a(74116),u=a(59907),v=a(46878),p=a(65e3),h=a(6215),m=a(9038),g=a(27810),b=a(14075),x=a(70340),N=a(55842),j=a(75544),k=a(37711);const y=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),I=(0,k.wZ)("ydb-tablets",{en:y});var f=a(10161);function w(e){let{database:t}=e;return[{name:"Type",width:150,get header(){return I("Type")},render:e=>{let{row:t}=e;const a=!1===t.Leader;return(0,f.jsxs)("span",{children:[t.Type," ",a?(0,f.jsx)(i.x,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return I("Tablet")},render:e=>{var a;let{row:s}=e;if(!s.TabletId)return g.jX;const i=(0,v.fK)(s.TabletId,{nodeId:s.NodeId,type:s.Type,tenantName:t});return(0,f.jsx)(r.A,{name:null===(a=s.TabletId)||void 0===a?void 0:a.toString(),path:i,hasClipboardButton:!0,showStatus:!1,additionalControls:(0,f.jsx)(d.Q,{href:(0,x.wz)(s.TabletId)})})}},{name:"State",get header(){return I("State")},render:e=>{let{row:t}=e;return(0,f.jsx)(u.f,{state:t.State})}},{name:"NodeId",get header(){return I("Node ID")},render:e=>{let{row:t}=e;const a=void 0===t.NodeId?void 0:(0,j.a3)(t.NodeId);return(0,f.jsx)(o.h,{to:a,children:t.NodeId})},align:"right"},{name:"fqdn",get header(){return I("Node FQDN")},render:e=>{let{row:t}=e;return t.fqdn?(0,f.jsx)(r.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,f.jsx)("span",{children:"\u2014"})}},{name:"Generation",get header(){return I("Generation")},align:"right"},{name:"Uptime",get header(){return I("Uptime")},render:e=>{let{row:t}=e;return(0,b.fG)(t.ChangeTime)},sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:e=>{let{row:t}=e;return(0,f.jsx)(D,{...t})}}]}function D(e){const t=e.State===m.g.Stopped,a=(0,N.ix)(p.VH),[i]=h._.useKillTabletMutation(),d=e.TabletId;return d?(0,f.jsx)(n.U,{buttonView:"outlined",dialogHeader:I("dialog.kill-header"),dialogText:I("dialog.kill-text"),onConfirmAction:()=>i({id:d}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:I("controls.kill-not-allowed"),popoverDisabled:a,children:(0,f.jsx)(l.J,{data:s.Z})}):null}function T(e){let{database:t,tablets:a,className:s}=e;return(0,f.jsx)(c.G,{wrapperClassName:s,columns:w({database:t}),data:a,settings:g.LE,emptyDataMessage:I("noTabletsData")})}},28265:(e,t,a)=>{a.d(t,{J:()=>j});var s=a(64485),i=a(15327),l=a(22877),n=a(67386),d=a(74647),r=a.n(d),o=a(78759),c=a(4969);const u=o.h.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,t)=>{let{signal:a}=t;try{return{data:await window.api.getTabletsInfo(e,{signal:a})}}catch(s){return{error:s}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),v=(0,n.P1)((e=>e),(e=>u.endpoints.getTabletsInfo.select(e)),{argsMemoize:n.PP,argsMemoizeOptions:{equalityCheck:r()}}),p=(0,n.P1)((e=>e),((e,t)=>v(t)),((e,t)=>t(e).data)),h=(0,n.P1)(((e,t)=>p(e,t)),(e=>(0,c.s)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]));var m=a(99294),g=a(55842),b=a(72427),x=a(10161);const N=(0,m.cn)("tablets");function j(e){let{nodeId:t,path:a,database:n,className:d}=e;const[r]=(0,g.Rj)();let o={};const c=void 0===t?void 0:String(t);void 0!==c?o={nodeId:c,database:n}:a&&(o={path:a,database:n});const{currentData:v,isFetching:p,error:m}=u.useGetTabletsInfoQuery(0===Object.keys(o).length?s.CN:o,{pollingInterval:r}),j=p&&void 0===v,k=(0,g.ix)((e=>h(e,o)));return j?(0,x.jsx)(l.h,{}):(0,x.jsxs)("div",{className:N(null,d),children:[m?(0,x.jsx)(i.V,{error:m}):null,v?(0,x.jsx)(b.O,{tablets:k,database:n}):null]})}},90195:(e,t,a)=>{a.d(t,{N:()=>n});var s=a(78759),i=a(96183);const l=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,i.Ns)(a)},n=s.h.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{const e=await window.api.getNodeInfo(a,{signal:s});return{data:l(e)}}catch(i){return{error:i}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{return{data:await window.api.getStorageInfo({nodeId:a},{signal:s})}}catch(i){return{error:i}}},providesTags:["All"]})}),overrideExisting:"throw"})},6215:(e,t,a)=>{a.d(t,{_:()=>i});var s=a(96183);const i=a(78759).h.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async(e,t)=>{let{id:a,database:i,nodeId:l}=e,{signal:n}=t;try{const[e,t,d]=await Promise.all([window.api.getTablet({id:a,database:i,nodeId:l},{signal:n}),window.api.getTabletHistory({id:a,database:i,nodeId:l},{signal:n}),window.api.getNodesList({signal:n})]),r=(0,s.Xs)(d),o=Object.keys(t).reduce(((e,a)=>{var s;const i=null===(s=t[a])||void 0===s?void 0:s.TabletStateInfo;if(i&&i.length){const t=i.find((e=>e.Leader))||i[0],{ChangeTime:s,Generation:l,State:n,Leader:d,FollowerId:o}=t,c=r&&a?r.get(Number(a)):void 0;"Dead"!==n&&e.push({nodeId:a,generation:l,changeTime:s,state:n,leader:d,followerId:o,fqdn:c})}return e}),[]),{TabletStateInfo:c=[]}=e,[u={}]=c,{TabletId:v}=u;return{data:{id:v,data:u,history:o}}}catch(d){return{error:d}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async(e,t)=>{let{tenantId:a}=e,{signal:s}=t;try{const e=await window.api.getTabletDescribe(a,{signal:s}),{SchemeShard:t,PathId:i}=a;return{data:(null===e||void 0===e?void 0:e.Path)||`${t}:${i}`}}catch(i){return{error:i}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async(e,t)=>{let{id:a,hiveId:s}=e,{signal:i}=t;try{return{data:await window.api.getTabletFromHive({id:a,hiveId:s},{signal:i})}}catch(l){return{error:l}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async e=>{let{id:t}=e;try{return{data:await window.api.killTablet(t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.stopTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.resumeTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},73878:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(34706);const i=e=>s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.501 6.501 0 0 0-6.445 5.649.75.75 0 1 0 1.488.194A5.001 5.001 0 0 1 11.57 4.5h-1.32a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 .75-.75v-3a.75.75 0 0 0-1.5 0v1.06A6.48 6.48 0 0 0 8 1.5Zm-5.25 13a.75.75 0 0 1-.75-.75v-3a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H4.43a5.001 5.001 0 0 0 8.528-2.843.75.75 0 1 1 1.487.194A6.501 6.501 0 0 1 3.5 12.691v1.059a.75.75 0 0 1-.75.75Z",clipRule:"evenodd"}))}}]);