"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[1276],{74003:(e,s,t)=>{t.d(s,{q:()=>h});var r=t(26714),l=t(72616),a=t(98647),n=t(78759),o=t(99294),i=t(55842),c=t(37711);const d=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),u=(0,c.wZ)("ydb-diagnostics-autorefresh-control",{en:d});var v=t(10161);const m=(0,o.cn)("auto-refresh-control");function h(e){let{className:s}=e;const t=(0,i.zL)(),[o,c]=(0,i.Rj)();return(0,v.jsxs)("div",{className:m(null,s),children:[(0,v.jsx)(l.z,{view:"flat",onClick:()=>{t(n.h.util.invalidateTags(["All"]))},extraProps:{"aria-label":u("Refresh")},children:(0,v.jsx)(l.z.Icon,{children:(0,v.jsx)(r.Z,{})})}),(0,v.jsxs)(a.P,{value:[String(o)],onUpdate:e=>{c(Number(e))},width:85,children:[(0,v.jsx)(a.P.Option,{value:"0",children:u("None")}),(0,v.jsx)(a.P.Option,{value:"15000",children:u("15 sec")}),(0,v.jsx)(a.P.Option,{value:"60000",children:u("1 min")}),(0,v.jsx)(a.P.Option,{value:"120000",children:u("2 min")}),(0,v.jsx)(a.P.Option,{value:"300000",children:u("5 min")})]})]})}},66498:(e,s,t)=>{t.d(s,{a:()=>r.a});var r=t(41989)},20760:(e,s,t)=>{t.d(s,{y:()=>u});var r=t(53216),l=t(99294),a=t(14075),n=t(73689),o=t(10161);const i=(0,l.cn)("progress-viewer"),c=e=>(0,a.uf)((0,a.W0)(Number(e),2)),d=(e,s)=>[c(e),c(s)];function u(e){let{value:s,capacity:t,formatValues:l=d,percents:a,className:c,size:u="xs",colorizeProgress:v,inverseColorize:m,warningThreshold:h=60,dangerThreshold:N=80}=e;const g=(0,r.F)();let p=Math.round(parseFloat(String(s))/parseFloat(String(t))*100)||0;p=p>100?100:p;let S=s,x=t,f="/";a?(S=p+"%",x="",f=""):l&&([S,x]=l(Number(s),Number(t)));let b=m?"danger":"good";v&&(p>h&&p<=N?b="warning":p>N&&(b=m?"good":"danger"),(0,n.kE)(t)||(p=100));const E={width:p+"%"};return(0,n.kE)(s)?(0,o.jsxs)("div",{className:i({size:u,theme:g,status:b},c),children:[(0,o.jsx)("div",{className:i("line"),style:E}),(0,o.jsx)("span",{className:i("text"),children:(0,n.kE)(t)?`${S} ${f} ${x}`:S})]}):(0,o.jsx)("div",{className:`${i({size:u})} ${c} error`,children:"no data"})}},74116:(e,s,t)=>{t.d(s,{G:()=>c});var r=t(59769),l=t(71624),a=t(99294),n=t(46154),o=t(10161);const i=(0,a.cn)("ydb-resizeable-data-table");function c(e){let{columnsWidthLSKey:s,columns:t,settings:a,wrapperClassName:c,...d}=e;const[u,v]=(0,n.M)(s),m=(0,r.B)(t,u),h={...a,defaultResizeable:!0};return(0,o.jsx)("div",{className:i(null,c),children:(0,o.jsx)(l.ZP,{theme:"yandex-cloud",columns:m,onResize:v,settings:h,...d})})}},76485:(e,s,t)=>{t.d(s,{o:()=>i});var r=t(34706),l=t(86357),a=t(99294),n=t(10161);const o=(0,a.cn)("ydb-search"),i=e=>{let{onChange:s,value:t="",className:a,debounce:i=200,placeholder:c}=e;const[d,u]=r.useState(t),v=r.useRef();r.useEffect((()=>{u((e=>e!==t?t:e))}),[t]);return(0,n.jsx)(l.o,{hasClear:!0,autoFocus:!0,className:o(null,a),placeholder:c,value:d,onUpdate:e=>{u(e),window.clearTimeout(v.current),v.current=window.setTimeout((()=>{null===s||void 0===s||s(e)}),i)}})}},17784:(e,s,t)=>{t.d(s,{o:()=>r.o});var r=t(76485)},61490:(e,s,t)=>{t.r(s),t.d(s,{Clusters:()=>ee});var r=t(34706),l=t(71624),a=t(98647),n=t(38471),o=t(42152),i=t(74003),c=t(15327),d=t(66498),u=t(74116),v=t(17784),m=t(33921),h=t(78171),N=t.n(h);const g=e=>e.clusters.clusterName,p=e=>e.clusters.status,S=e=>e.clusters.service,x=e=>e.clusters.version,f=(e,s)=>0===s.length||e.status&&s.includes(e.status),b=(e,s)=>0===s.length||e.service&&s.includes(e.service),E=(e,s)=>0===s.length||s.some((s=>{var t,r;return null===(t=e.cluster)||void 0===t||null===(r=t.Versions)||void 0===r?void 0:r.some((e=>e.startsWith(s)))})),j=function(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!t)return!0;const r=t.toLowerCase(),l=r.split(" "),a=(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().match(/[^\d\s]+|\d+|[^-\s]+|[^_\s]+/g))||[],n=l.every((s=>{const t=N()(s),r=new RegExp(`^${t}|[\\s\\-_]${t}`,"i");return e.title&&r.test(e.title)||a.some((e=>e.startsWith(s)))})),o=e.preparedVersions.some((e=>e.version.includes(r))),i=Boolean(e.hosts&&e.hosts[r]);return n||o||i};var T=t(27810),C=t(55842),O=t(97485),w=t(58274),_=t(20760),A=t(14075),y=t(37711);const R=JSON.parse('{"controls_status-select-label":"Status:","controls_service-select-label":"Service:","controls_version-select-label":"Version:","controls_search-placeholder":"Cluster name, version, host","controls_select-placeholder":"All","statistics_clusters":"Clusters","statistics_hosts":"Hosts","statistics_tenants":"Tenants","statistics_nodes":"Nodes","statistics_load":"Load","statistics_storage":"Storage","tooltip_no-cluster-data":"No cluster data","page_title":"Clusters"}'),I=JSON.parse('{"controls_status-select-label":"\u0421\u0442\u0430\u0442\u0443\u0441:","controls_service-select-label":"\u0421\u0435\u0440\u0432\u0438\u0441:","controls_version-select-label":"\u0412\u0435\u0440\u0441\u0438\u044f:","controls_search-placeholder":"\u0418\u043c\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432\u0435\u0440\u0441\u0438\u044f \u0438\u043b\u0438 \u0445\u043e\u0441\u0442","controls_select-placeholder":"\u0412\u0441\u0435","statistics_clusters":"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b","statistics_hosts":"\u0425\u043e\u0441\u0442\u044b","statistics_tenants":"\u0411\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445","statistics_nodes":"\u0423\u0437\u043b\u044b","statistics_load":"\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430","statistics_storage":"\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435","tooltip_no-cluster-data":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430","page_title":"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b"}'),D=(0,y.wZ)("ydb-clusters-page",{ru:I,en:R});var L=t(99294);const z=(0,L.cn)("clusters");var P=t(10161);const V=e=>{let{count:s,stats:t}=e;const{NodesTotal:r,NodesAlive:l,Hosts:a,Tenants:n,LoadAverage:o,NumberOfCpus:i,StorageUsed:c,StorageTotal:d}=t;return(0,P.jsxs)("div",{className:z("aggregation"),children:[(0,P.jsxs)("div",{className:z("aggregation-value-container"),children:[(0,P.jsx)("span",{className:z("aggregation-label"),children:D("statistics_clusters")}),s]}),(0,P.jsxs)("div",{className:z("aggregation-value-container"),children:[(0,P.jsx)("span",{className:z("aggregation-label"),children:D("statistics_hosts")}),a]}),(0,P.jsxs)("div",{className:z("aggregation-value-container"),children:[(0,P.jsx)("span",{className:z("aggregation-label"),children:D("statistics_tenants")}),n]}),(0,P.jsxs)("div",{className:z("aggregation-value-container"),children:[(0,P.jsx)("span",{className:z("aggregation-label"),children:D("statistics_nodes")}),(0,P.jsx)(_.y,{size:"ns",value:l,capacity:r,colorizeProgress:!0,inverseColorize:!0})]}),(0,P.jsxs)("div",{className:z("aggregation-value-container"),children:[(0,P.jsx)("span",{className:z("aggregation-label"),children:D("statistics_load")}),(0,P.jsx)(_.y,{size:"ns",value:o,capacity:i,colorizeProgress:!0})]}),(0,P.jsxs)("div",{className:z("aggregation-value-container"),children:[(0,P.jsx)("span",{className:z("aggregation-label"),children:D("statistics_storage")}),(0,P.jsx)(_.y,{size:"ns",value:c,capacity:d,formatValues:A.QO,colorizeProgress:!0})]})]})};var k=t(91807),U=t(17823),G=t(30963),M=t(16426),W=t(75147);const Z=(0,L.cn)("kv-user");function H(e){let{login:s,className:t}=e;const r=(0,W.C)("StaffCard");return(0,P.jsx)("div",{className:Z(null,t),children:(0,P.jsx)(r,{login:s,children:(0,P.jsx)("div",{className:Z("name"),children:s})})})}var B=t(25791),$=t(4128);const J="selectedColumns",q={TITLE:"title",VERSIONS:"versions",DC:"dc",SERVICE:"service",STATUS:"status",NODES:"nodes",LOAD:"load",STORAGE:"storage",HOSTS:"hosts",TENANTS:"tenants",OWNER:"owner",DESCRIPTION:"description",BALANCER:"balancer"},F=[q.TITLE,q.VERSIONS,q.SERVICE,q.STATUS,q.NODES,q.LOAD,q.STORAGE,q.HOSTS,q.TENANTS,q.OWNER,q.BALANCER],X={[q.TITLE]:"Cluster",[q.VERSIONS]:"Versions",[q.DC]:"DC",[q.SERVICE]:"Service",[q.STATUS]:"Status",[q.NODES]:"Nodes",[q.LOAD]:"Load",[q.STORAGE]:"Storage",[q.HOSTS]:"Hosts",[q.TENANTS]:"Tenants",[q.OWNER]:"Owner",[q.DESCRIPTION]:"Description",[q.BALANCER]:"Balancer"},K="clustersTableColumnsWidth",Q=(0,P.jsx)("span",{className:z("empty-cell"),children:"\u2014"}),Y=[{name:q.TITLE,header:X[q.TITLE],width:230,render:e=>{var s,t;let{row:r}=e;const{balancer:l,name:a}=r,n=l&&(0,B.M2)(l),o=(0,$.B7)(void 0,{backend:n,clusterName:a}),i=null===(s=r.cluster)||void 0===s?void 0:s.Overall;return(0,P.jsxs)("div",{className:z("cluster"),children:[i?(0,P.jsx)(U.r,{href:o,children:(0,P.jsx)("div",{className:z("cluster-status",{type:i&&i.toLowerCase()})})}):(0,P.jsx)("div",{className:z("cluster-status"),children:(0,P.jsx)(k.J,{content:(0,P.jsx)("span",{className:z("tooltip-content"),children:(null===(t=r.cluster)||void 0===t?void 0:t.error)||D("tooltip_no-cluster-data")}),offset:{left:0}})}),(0,P.jsx)("div",{className:z("cluster-name"),children:(0,P.jsx)(U.r,{href:o,children:r.title})})]})},defaultOrder:l.ZP.ASCENDING},{name:q.VERSIONS,header:X[q.VERSIONS],width:300,defaultOrder:l.ZP.DESCENDING,sortAccessor:e=>{let{preparedVersions:s}=e;return s.map((e=>e.version.replace(/^[0-9]\+\./g,""))).sort(((e,s)=>e.localeCompare(s)))[0]||void 0},render:e=>{let{row:s}=e;const{preparedVersions:t,versions:l=[],balancer:a,name:n}=s;if(!l.length||l.some((e=>!e.version)))return Q;const o=l.reduce(((e,s)=>e+s.count),0),i=l.map((e=>{var s;return{value:e.count/o*100,color:null===(s=t.find((s=>s.version===e.version)))||void 0===s?void 0:s.color}})),c=a&&(0,B.M2)(a);return t.length>0&&(0,P.jsx)(U.r,{className:z("cluster-versions"),href:(0,$.B7)($.xu.versions,{backend:c,clusterName:n}),children:(0,P.jsxs)(r.Fragment,{children:[t.map(((e,s)=>(0,P.jsx)("div",{className:z("cluster-version"),style:{color:e.color},title:e.version,children:e.version},s))),(0,P.jsx)(G.E,{size:"s",value:100,stack:i})]})})}},{name:q.DC,header:X[q.DC],width:120,sortable:!1,render:e=>{let{row:s}=e;const t=s.cluster&&s.cluster.DataCenters||[];return(0,P.jsx)("div",{className:z("cluster-dc"),children:t.join(", ")||Q})}},{name:q.SERVICE,header:X[q.SERVICE],width:100,sortable:!0},{name:q.STATUS,header:X[q.STATUS],width:150,sortable:!0},{name:q.NODES,header:X[q.NODES],resizeMinWidth:140,defaultOrder:l.ZP.DESCENDING,sortAccessor:e=>{let{cluster:s={}}=e;const{NodesTotal:t=0}=s;return t},render:e=>{let{row:s}=e;const{NodesAlive:t=0,NodesTotal:r=0,Overall:l}=s.cluster||{};return l?(0,P.jsx)(_.y,{value:t,capacity:r}):Q}},{name:q.LOAD,header:X[q.LOAD],resizeMinWidth:140,defaultOrder:l.ZP.DESCENDING,sortAccessor:e=>{let{cluster:s}=e;return null===s||void 0===s?void 0:s.NumberOfCpus},render:e=>{let{row:s}=e;const{LoadAverage:t=0,NumberOfCpus:r=0,Overall:l}=s.cluster||{};return l?(0,P.jsx)(_.y,{value:t,capacity:r}):Q}},{name:q.STORAGE,header:X[q.STORAGE],resizeMinWidth:140,defaultOrder:l.ZP.DESCENDING,sortAccessor:e=>{let{cluster:s}=e;return Number(null===s||void 0===s?void 0:s.StorageTotal)},render:e=>{let{row:s}=e;const{StorageUsed:t=0,StorageTotal:r=0,Overall:l}=s.cluster||{};return l?(0,P.jsx)(_.y,{value:t,capacity:r,formatValues:A.JD}):Q}},{name:q.HOSTS,header:X[q.HOSTS],width:80,defaultOrder:l.ZP.DESCENDING,sortAccessor:e=>{let{cluster:s}=e;return Number(null===s||void 0===s?void 0:s.Hosts)||0},render:e=>{var s;let{row:t}=e;return Number(null===(s=t.cluster)||void 0===s?void 0:s.Hosts)||Q}},{name:q.TENANTS,header:X[q.TENANTS],width:80,defaultOrder:l.ZP.DESCENDING,sortAccessor:e=>{let{cluster:s}=e;return Number(null===s||void 0===s?void 0:s.Tenants)||0},render:e=>{var s;let{row:t}=e;return Number(null===(s=t.cluster)||void 0===s?void 0:s.Tenants)||Q}},{name:q.OWNER,header:X[q.OWNER],sortable:!1,width:120,render:e=>{var s;let{row:t}=e;const r=null===(s=t.owner)||void 0===s?void 0:s.split(", ");return null!==r&&void 0!==r&&r.length?r.map((e=>(0,P.jsx)(H,{login:e},e))):Q}},{name:q.DESCRIPTION,header:X[q.DESCRIPTION],sortable:!1,width:150,render:e=>{let{row:s}=e;return s.description?(0,P.jsx)("div",{className:z("description"),children:s.description}):Q}},{name:q.BALANCER,header:X[q.BALANCER],sortable:!1,width:290,render:e=>{let{row:s}=e;if(!s.balancer)return Q;const t=(0,B.q)(s.balancer);return(0,P.jsxs)("div",{className:z("balancer-cell"),children:[(0,P.jsx)("div",{className:z("balancer-text"),children:t}),(0,P.jsx)(M.m,{size:"s",text:t,className:z("balancer-icon")})]})}}];function ee(){const[e]=(0,C.Rj)(),s=m.W1.useGetClustersListQuery(void 0,{pollingInterval:e}),t=(0,C.zL)(),h=(0,C.ix)(g),N=(0,C.ix)(p),_=(0,C.ix)(S),A=(0,C.ix)(x),{columnsToShow:y,columnsToSelect:R,setColumns:I}=(0,O.N)(Y,J,X,F,[q.TITLE]),L=s.data,{servicesToSelect:k,versions:U}=r.useMemo((()=>{const e=new Set,s=new Set;return(null!==L&&void 0!==L?L:[]).forEach((t=>{var r,l;t.service&&e.add(t.service),null===(r=t.cluster)||void 0===r||null===(l=r.Versions)||void 0===l||l.forEach((e=>{s.add((0,w.H)(e))}))})),{servicesToSelect:Array.from(e).map((e=>({value:e,content:e}))),versions:Array.from(s).map((e=>({value:e,content:e})))}}),[L]),G=r.useMemo((()=>function(e,s){return e.filter((e=>f(e,s.status)&&b(e,s.service)&&E(e,s.version)&&j(e,s.clusterName)))}(null!==L&&void 0!==L?L:[],{clusterName:h,status:N,service:_,version:A})),[h,L,_,N,A]),M=r.useMemo((()=>function(e){let s=0,t=0,r=0,l=0,a=0,n=0,o=0;const i=new Set;return e.filter((e=>{let{cluster:s}=e;return!(null!==s&&void 0!==s&&s.error)})).forEach((e=>{let{cluster:c,hosts:d={}}=e;s+=(null===c||void 0===c?void 0:c.NodesTotal)||0,t+=(null===c||void 0===c?void 0:c.NodesAlive)||0,Object.keys(d).forEach((e=>i.add(e))),o+=Number(null===c||void 0===c?void 0:c.Tenants)||0,r+=Number(null===c||void 0===c?void 0:c.LoadAverage)||0,l+=(null===c||void 0===c?void 0:c.NumberOfCpus)||0,a+=null!==c&&void 0!==c&&c.StorageUsed?Math.floor(parseInt(c.StorageUsed,10)):0,n+=null!==c&&void 0!==c&&c.StorageTotal?Math.floor(parseInt(c.StorageTotal,10)):0})),{NodesTotal:s,NodesAlive:t,Hosts:i.size,Tenants:o,LoadAverage:r,NumberOfCpus:l,StorageUsed:a,StorageTotal:n}}(G)),[G]),W=r.useMemo((()=>Array.from(new Set((null!==L&&void 0!==L?L:[]).map((e=>e.status)).filter(Boolean))).sort().map((e=>({value:e,content:e})))),[L]);return(0,P.jsxs)("div",{className:z(),children:[(0,P.jsx)(o.ql,{children:(0,P.jsx)("title",{children:D("page_title")})}),(0,P.jsx)(V,{stats:M,count:G.length}),(0,P.jsxs)("div",{className:z("controls"),children:[(0,P.jsx)("div",{className:z("control",{wide:!0}),children:(0,P.jsx)(v.o,{placeholder:D("controls_search-placeholder"),onChange:e=>{t((0,m.g_)({clusterName:e}))},value:h})}),(0,P.jsx)("div",{className:z("control"),children:(0,P.jsx)(a.P,{multiple:!0,filterable:!0,hasClear:!0,placeholder:D("controls_select-placeholder"),label:D("controls_status-select-label"),value:N,options:W,onUpdate:e=>{t((0,m.g_)({status:e}))},width:"max"})}),(0,P.jsx)("div",{className:z("control"),children:(0,P.jsx)(a.P,{multiple:!0,filterable:!0,hasClear:!0,placeholder:D("controls_select-placeholder"),label:D("controls_service-select-label"),value:_,options:k,onUpdate:e=>{t((0,m.g_)({service:e}))},width:"max"})}),(0,P.jsx)("div",{className:z("control"),children:(0,P.jsx)(a.P,{multiple:!0,filterable:!0,hasClear:!0,placeholder:D("controls_select-placeholder"),label:D("controls_version-select-label"),value:A,options:U,onUpdate:e=>{t((0,m.g_)({version:e}))},width:"max"})}),(0,P.jsx)("div",{className:z("control"),children:(0,P.jsx)(n.N,{popupWidth:242,items:R,showStatus:!0,onUpdate:I,sortable:!1},"TableColumnSetup")}),(0,P.jsx)(i.q,{})]}),s.isError?(0,P.jsx)(c.V,{error:s.error,className:z("error")}):null,s.isLoading?(0,P.jsx)(d.a,{size:"l"}):null,s.fulfilledTimeStamp?(0,P.jsx)("div",{className:z("table-wrapper"),children:(0,P.jsx)("div",{className:z("table-content"),children:(0,P.jsx)(u.G,{columnsWidthLSKey:K,wrapperClassName:z("table"),data:G,columns:y,settings:{...T.LE,dynamicRender:!1},initialSortOrder:{columnId:q.TITLE,order:l.ZP.ASCENDING}})})}):null]})}},97485:(e,s,t)=>{t.d(s,{N:()=>a});var r=t(34706),l=t(9951);const a=(e,s,t,a,n)=>{const[o,i]=r.useState((()=>l.r.readUserSettingsValue(s,a)));return{columnsToShow:r.useMemo((()=>e.filter((e=>{const s=e.name,t=o.includes(s),r=null===n||void 0===n?void 0:n.includes(s);return t||r}))),[e,n,o]),columnsToSelect:r.useMemo((()=>e.map((e=>e.name)).map((e=>{const s=null===n||void 0===n?void 0:n.includes(e),r=o.includes(e);return{id:e,title:t[e],selected:s||r,required:s,sticky:s?"start":void 0}}))),[e,t,n,o]),setColumns:r.useCallback((e=>{const t=e.filter((e=>e.selected)).map((e=>e.id));l.r.setUserSettingsValue(s,t),i(t)}),[s])}}},46154:(e,s,t)=>{t.d(s,{M:()=>n});var r=t(34706),l=t(59769),a=t(9951);const n=e=>{const s=r.useCallback((()=>e?a.r.readUserSettingsValue(e,{}):{}),[e]),t=r.useCallback((s=>{e&&a.r.setUserSettingsValue(e,s)}),[e]);return(0,l.M)({saveSizes:t,getSizes:s})}},91807:(e,s,t)=>{t.d(s,{J:()=>c});var r=t(34706),l=t(29837),a=t(16318),n=t(14561);const o=(0,t(38534).G)("help-popover"),i=16;function c(e){var s;return r.createElement(a.J,Object.assign({},e,{className:o(null,e.className)}),r.createElement("button",Object.assign({ref:e.buttonRef,type:"button"},e.buttonProps,{className:o("button",null===(s=e.buttonProps)||void 0===s?void 0:s.className)}),r.createElement(n.J,{data:l.Z,size:i})))}},38534:(e,s,t)=>{t.d(s,{G:()=>l});var r=t(95936);(0,r.withNaming)({e:"__",m:"_",v:"_"});const l=(0,r.withNaming)({n:"gc-",e:"__",m:"_",v:"_"})},30963:(e,s,t)=>{t.d(s,{E:()=>u});var r=t(34706);const l=(0,t(87578).Ge)("progress");function a(e){const{text:s,offset:t=0}=e;return s?r.createElement("div",{className:l("text-inner"),style:{transform:`translateX(calc(var(--g-flow-direction) * ${-t}%))`}},s):null}function n(e){let{item:s}=e;const{value:t,color:a,className:n,theme:o,title:i,content:c,loading:d}=s,u={loading:d};return"undefined"===typeof a&&(u.theme=o||"default"),Number.isFinite(t)?r.createElement("div",{className:l("item",u,n),style:{width:`${t}%`,backgroundColor:a},title:i},c):null}function o(e){return e<100?e-100:0}function i(e){const{theme:s,colorStops:t,colorStopsValue:r,value:l}=e;if(t){const e=t.find(((e,s)=>{const a="number"===typeof r?r:l,n=s>1?t[s-1].stop:0,o=s<t.length-1?e.stop:100;return a>=n&&a<=o}));return e?e.theme:s}return s}function c(e){const{stack:s,stackClassName:t,value:i,text:c}=e,d=o(i||function(e){return e.reduce(((e,s)=>{let{value:t}=s;return e+t}),0)}(s));return r.createElement("div",{className:l("stack",t),style:{transform:`translateX(calc(var(--g-flow-direction) * ${d}%))`}},r.createElement("div",{className:l("item"),style:{width:-d+"%"}}),s.map(((e,s)=>r.createElement(n,{key:s,item:e}))),r.createElement(a,{offset:d,text:c}))}function d(e){const{value:s,loading:t,text:n}=e,c=o(s);return Number.isFinite(s)?r.createElement("div",{className:l("item",{theme:i(e),loading:t}),style:{transform:`translateX(calc(var(--g-flow-direction) * ${c}%))`}},r.createElement(a,{offset:c,text:n})):null}const u=r.forwardRef((function(e,s){const{text:t="",theme:a="default",size:n="m",loading:o=!1,className:i,qa:u}=e,v=Object.assign(Object.assign({},e),{text:t,theme:a,size:n,loading:o});return r.createElement("div",{ref:s,className:l({size:n},i),"data-qa":u},r.createElement("div",{className:l("text")},t),function(e){return void 0!==e.stack}(v)?r.createElement(c,Object.assign({},v)):r.createElement(d,Object.assign({},v)))}))}}]);