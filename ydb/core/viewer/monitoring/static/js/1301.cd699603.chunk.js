"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[1301],{30832:(e,t,s)=>{s.d(t,{a:()=>d});var i=s(24362),o=s(98366),n=s(75859);const a=(0,i.cn)("ydb-entity-page-title");function d(e){let{entityName:t,status:s,id:i,className:d,children:l}=e;return(0,n.jsxs)("div",{className:a(null,d),children:[(0,n.jsx)("span",{className:a("prefix"),children:t}),(0,n.jsx)(o.J,{className:a("icon"),status:s,size:"s"}),i,l]})}},91816:(e,t,s)=>{s.d(t,{b:()=>c});var i=s(68963),o=s(56711),n=s(24362),a=s(42587),d=s(75859);const l=(0,n.cn)("ydb-info-viewer-skeleton"),r=()=>(0,d.jsxs)("div",{className:l("label"),children:[(0,d.jsx)(o.O,{className:l("label__text")}),(0,d.jsx)("div",{className:l("label__dots")})]}),c=e=>{let{rows:t=8,className:s,delay:n=600}=e;const c=(0,a.$)(n);let v=(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(r,{}),(0,d.jsx)(o.O,{className:l("value")})]});return c||(v=null),(0,d.jsx)("div",{className:l(null,s),children:[...new Array(t)].map(((e,t)=>(0,d.jsx)("div",{className:l("row"),children:v},"skeleton-row-".concat(t))))})}},27174:(e,t,s)=>{s.d(t,{B:()=>u});var i=s(77796),o=s(24362),n=s(50422),a=s(56711),d=s(42587),l=s(75859);const r=e=>{let{delay:t=600,className:s}=e;return(0,d.$)(t)?(0,l.jsx)(a.O,{className:s}):null},c=(0,o.cn)("ydb-page-meta");function v(e){let{items:t,loading:s}=e;return(0,l.jsx)("div",{className:c("info"),children:s?(0,l.jsx)(r,{className:c("skeleton")}):t.filter((e=>Boolean(e))).join("\xa0\xa0\xb7\xa0\xa0")})}function u(e){let{className:t,...s}=e;return(0,l.jsxs)(i.k,{gap:1,alignItems:"center",justifyContent:"space-between",className:c(null,t),children:[(0,l.jsx)(v,{...s}),(0,l.jsx)(n.q,{})]})}},17159:(e,t,s)=>{s.r(t),s.d(t,{VDiskGroup:()=>q,VDiskPage:()=>R});var i=s(68963);const o=e=>i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),i.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.28 4.78a.75.75 0 0 0 0-1.06l-2.5-2.5a.75.75 0 1 0-1.06 1.06L6.94 3.5H1.75a.75.75 0 1 0 0 1.5h5.19L5.72 6.22a.75.75 0 1 0 1.06 1.06l2.5-2.5Zm-.06 3.94-2.5 2.5a.75.75 0 0 0 0 1.06l2.5 2.5a.75.75 0 1 0 1.06-1.06L9.06 12.5h5.19a.75.75 0 0 0 0-1.5H9.06l1.22-1.22a.75.75 0 1 0-1.06-1.06ZM14 4.25a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0ZM3.75 13.5a1.75 1.75 0 1 0 0-3.5 1.75 1.75 0 0 0 0 3.5Z",clipRule:"evenodd"}));var n=s(88776),a=s(17095),d=s(49352),l=s(52846),r=s(14659),c=s(30832),v=s(26688),u=s(91816),D=s(27174),k=s(2098),p=s(22200),m=s(14146),g=s(79061),I=s(99337),f=s(11431),N=s(5922),x=s(905),w=s(3764),h=s(51688),y=s(92092);const j=x.h.injectEndpoints({endpoints:e=>({getVDiskData:e.query({queryFn:async e=>{let{nodeId:t,pDiskId:s,vDiskSlotId:i}=e;try{const{vDiskData:e,groupData:o}=await async function(e){let{nodeId:t,pDiskId:s,vDiskSlotId:i}=e,{signal:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await Promise.all([window.api.getVDiskInfo({nodeId:t,pDiskId:s,vDiskSlotId:i},{signal:o}),window.api.getNodeWhiteboardPDiskInfo({nodeId:t,pDiskId:s},{signal:o}),window.api.getNodeInfo(t,{signal:o})]),a=function(e){var t,s,i,o,n,a,d;let[l,r,c]=e;const v=null===(t=l.VDiskStateInfo)||void 0===t?void 0:t[0],u=(0,w.w)(v),D=null===(s=r.PDiskStateInfo)||void 0===s?void 0:s[0],k=(0,w.b)(D),p=null===(i=c.SystemStateInfo)||void 0===i?void 0:i[0],m=(0,h.Ns)(p),g=null!==(o=null!==(n=u.NodeId)&&void 0!==n?n:k.NodeId)&&void 0!==o?o:m.NodeId,I=m.Host,f=null===(a=m.Roles)||void 0===a?void 0:a[0],N=m.DC,x=null!==(d=u.PDiskId)&&void 0!==d?d:k.PDiskId,y=k.Type;return{...u,NodeId:g,NodeHost:I,NodeType:f,NodeDC:N,PDiskId:x,PDiskType:y}}(n),{StoragePoolName:d,VDiskId:l={}}=a,{GroupID:r}=l;let c;if((0,N.D)(d)&&(0,N.D)(r)){c=function(e,t,s){var i,o;const n=null===(i=e.StoragePools)||void 0===i?void 0:i.find((e=>e.Name===t)),a=null===n||void 0===n||null===(o=n.Groups)||void 0===o?void 0:o.find((e=>e.GroupID===s));if(a&&n)return(0,y.mD)(a,n)}(await window.api.getStorageInfo({nodeId:t,poolName:d,groupId:r,version:f.w.v1},{signal:o}),d,r)}return{vDiskData:a,groupData:c}}({nodeId:t,pDiskId:s,vDiskSlotId:i});return{data:{vDiskData:e,groupData:o}}}catch(o){return{error:o}}},providesTags:["All"]})}),overrideExisting:"throw"});var b=s(24362),S=s(52317),P=s(34301),V=s(92666),C=s(17096),G=s(92076),T=s(30817);const E=JSON.parse('{"fqdn":"FQDN","node":"Node","pdisk":"PDisk","vdisk":"VDisk","group":"Group","evict-vdisk-button":"Evict VDisk","force-evict-vdisk-button":"Evict anyway","evict-vdisk-dialog":"VDisk will be evicted. Do you want to proceed?","evict-vdisk-not-allowed":"You don\'t have enough rights to evict VDisk"}'),_=(0,T.wZ)("ydb-vDisk-page",{en:E});var B=s(75859);const H=(0,b.cn)("ydb-vdisk-page");function R(){const e=(0,C.zL)(),t=(0,C.ix)(m.VH),[{nodeId:s,pDiskId:k,vDiskSlotId:I}]=(0,l.useQueryParams)({nodeId:l.StringParam,pDiskId:l.StringParam,vDiskSlotId:l.StringParam});i.useEffect((()=>{e((0,g.J)("vDisk",{nodeId:s,pDiskId:k,vDiskSlotId:I}))}),[e,s,k,I]);const[f]=(0,C.Rj)(),x=(0,N.D)(s)&&(0,N.D)(k)&&(0,N.D)(I)?{nodeId:s,pDiskId:k,vDiskSlotId:I}:a.CN,{currentData:w,isFetching:h,refetch:y,error:b}=j.useGetVDiskDataQuery(x,{pollingInterval:f}),S=h&&void 0===w,{vDiskData:G={},groupData:T}=w||{},{NodeHost:E,NodeId:R,NodeType:F,NodeDC:L,PDiskId:M,PDiskType:A,Severity:O,VDiskId:Z}=G,{GroupID:J,GroupGeneration:Q,Ring:Y,Domain:z,VDisk:K}=Z||{},W=(0,N.D)(J)&&(0,N.D)(Q)&&(0,N.D)(Y)&&(0,N.D)(z)&&(0,N.D)(K),$=async e=>{if(W)return window.api.evictVDisk({groupId:J,groupGeneration:Q,failRealmIdx:Y,failDomainIdx:z,vDiskIdx:K,force:e}).then((e=>{if(!1===(null===e||void 0===e?void 0:e.result)){throw{statusText:e.error,retryPossible:e.forceRetryPossible}}}))},U=async()=>y();return(0,B.jsxs)("div",{className:H(null),children:[(()=>{const e=I?"".concat(_("vdisk")," ").concat(I):_("vdisk"),t=k?"".concat(_("pdisk")," ").concat(k):_("pdisk"),s=E||_("node");return(0,B.jsx)(d.ql,{titleTemplate:"%s - ".concat(e," - ").concat(t," \u2014 ").concat(s," \u2014 YDB Monitoring"),defaultTitle:"".concat(e," - ").concat(t," \u2014 ").concat(s," \u2014 YDB Monitoring")})})(),(()=>{const e=E?"".concat(_("fqdn"),": ").concat(E):void 0,t=R?"".concat(_("node"),": ").concat(R):void 0,s=R?"".concat(_("pdisk"),": ").concat(M):void 0;return(0,B.jsx)(D.B,{className:H("meta"),loading:S,items:[e,t,F,L,s,A]})})(),(0,B.jsx)(c.a,{className:H("title"),entityName:_("vdisk"),status:(0,V.b2)(O),id:(0,P.a2)(null===G||void 0===G?void 0:G.VDiskId)}),(0,B.jsx)("div",{className:H("controls"),children:(0,B.jsxs)(r.U,{onConfirmAction:$,onConfirmActionSuccess:U,buttonDisabled:!W||!t,buttonView:"normal",dialogContent:_("evict-vdisk-dialog"),retryButtonText:_("force-evict-vdisk-button"),withPopover:!0,popoverContent:_("evict-vdisk-not-allowed"),popoverDisabled:t,children:[(0,B.jsx)(n.J,{data:o}),_("evict-vdisk-button")]})}),S?(0,B.jsx)(u.b,{rows:20}):(0,B.jsxs)(i.Fragment,{children:[b?(0,B.jsx)(v.V,{error:b}):null,(0,B.jsx)(p.K,{data:G,className:H("info")}),T?(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{className:H("group-title"),children:_("group")}),(0,B.jsx)(q,{data:T})]}):null]})]})}function q(e){let{data:t}=e;const s=(0,C.ix)(I.d),o=i.useMemo((()=>(0,G.AH)(s)),[s]);return(0,B.jsx)(k.G,{columnsWidthLSKey:G.Ty,data:[t],columns:o,settings:S.LE})}}}]);