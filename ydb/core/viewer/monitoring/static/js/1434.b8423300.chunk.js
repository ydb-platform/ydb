"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[1434],{22983:(e,t,a)=>{a.d(t,{B:()=>d});var n=a(59284),r=a(84476),s=a(84375),o=a(55974),l=a(42829),i=a(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:a,dialogHeader:d,dialogText:u,retryButtonText:c,buttonDisabled:p=!1,buttonView:h="action",buttonTitle:m,buttonClassName:b,withPopover:g=!1,popoverContent:v,popoverPlacement:y="right",popoverDisabled:x=!0}){const[f,j]=n.useState(!1),[N,w]=n.useState(!1),[C,T]=n.useState(!1),S=()=>(0,i.jsx)(r.$,{onClick:()=>j(!0),view:h,disabled:p,loading:!p&&N,className:b,title:m,children:e});return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(o.g,{visible:f,header:d,text:u,withRetry:C,retryButtonText:c,onConfirm:async e=>{w(!0),await t(e)},onConfirmActionSuccess:async()=>{T(!1);try{await(null===a||void 0===a?void 0:a())}finally{w(!1)}},onConfirmActionError:e=>{T((0,l.D)(e)),w(!1)},onClose:()=>{j(!1)}}),g?(0,i.jsx)(s.A,{content:v,placement:y,disabled:x,children:S()}):S()]})}},55974:(e,t,a)=>{a.d(t,{g:()=>v});var n=a(59284),r=a(18677),s=a(71153),o=a(74321),l=a(2198),i=a(99991),d=a(89954),u=a(77506),c=a(48372);const p=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),h=(0,c.g4)("ydb-critical-action-dialog",{en:p});var m=a(60712);const b=(0,u.cn)("ydb-critical-dialog"),g=e=>e.data&&"issues"in e.data&&e.data.issues?(0,m.jsx)(d.O,{hideSeverity:!0,data:e.data}):403===e.status?h("no-rights-error"):e.statusText?e.statusText:h("default-error");function v({visible:e,header:t,text:a,withRetry:d,retryButtonText:u,withCheckBox:c,onClose:p,onConfirm:v,onConfirmActionSuccess:y,onConfirmActionError:x}){const[f,j]=n.useState(!1),[N,w]=n.useState(),[C,T]=n.useState(!1),S=async e=>(j(!0),v(e).then((()=>{y(),p()})).catch((e=>{x(e),w(e)})).finally((()=>{j(!1)})));return(0,m.jsx)(l.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:p,onTransitionExited:()=>{w(void 0),T(!1)},children:N?(0,m.jsxs)(n.Fragment,{children:[(0,m.jsx)(l.l.Header,{caption:t}),(0,m.jsx)(l.l.Body,{className:b("body"),children:(0,m.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,m.jsx)("span",{className:b("error-icon"),children:(0,m.jsx)(r.A,{width:"24",height:"22"})}),g(N)]})}),(0,m.jsx)(l.l.Footer,{loading:!1,preset:"default",textButtonApply:d?u||h("button-retry"):void 0,textButtonCancel:h("button-close"),onClickButtonApply:()=>S(!0),onClickButtonCancel:p})]}):(0,m.jsxs)(n.Fragment,{children:[(0,m.jsx)(l.l.Header,{caption:t}),(0,m.jsxs)(l.l.Body,{className:b("body"),children:[(0,m.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,m.jsx)("span",{className:b("warning-icon"),children:(0,m.jsx)(i.I,{data:s.A,size:24})}),a]}),c?(0,m.jsx)(o.S,{checked:C,onUpdate:T,children:h("checkbox-text")}):null]}),(0,m.jsx)(l.l.Footer,{loading:f,preset:"default",textButtonApply:h("button-confirm"),textButtonCancel:h("button-cancel"),propsButtonApply:{type:"submit",disabled:c&&!C},onClickButtonCancel:p,onClickButtonApply:()=>S()})]})})}},42829:(e,t,a)=>{a.d(t,{D:()=>n});const n=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},2102:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(77506),r=a(60712);const s=(0,n.cn)("ydb-diagnostic-card");function o({children:e,className:t,active:a,size:n="m",interactive:o=!0}){return(0,r.jsx)("div",{className:s({active:a,size:n,interactive:o},t),children:e})}},28539:(e,t,a)=>{a.d(t,{T:()=>n.T});var n=a(53755)},52248:(e,t,a)=>{a.d(t,{a:()=>n.a});var n=a(47334)},9252:(e,t,a)=>{a.d(t,{k:()=>o});var n=a(44433),r=a(88610),s=a(60712);const o=({value:e,onChange:t,className:a})=>(0,s.jsxs)(n.a,{value:e,onUpdate:t,className:a,children:[(0,s.jsx)(n.a.Option,{value:r.s$.ALL,children:r.s$.ALL}),(0,s.jsx)(n.a.Option,{value:r.s$.PROBLEMS,children:r.s$.PROBLEMS})]})},17594:(e,t,a)=>{a.d(t,{l:()=>d});var n=a(69024),r=a(4557),s=a(77506),o=a(16819),l=a(60712);const i=(0,s.cn)("ydb-resizeable-data-table");function d({columnsWidthLSKey:e,columns:t,settings:a,wrapperClassName:s,...d}){const[u,c]=(0,o.a)(e),p=(0,n.j)(t,u),h={...a,defaultResizeable:!0};return(0,l.jsx)("div",{className:i(null,s),children:(0,l.jsx)(r.Ay,{theme:"yandex-cloud",columns:p,onResize:c,settings:h,...d})})}},95963:(e,t,a)=>{a.d(t,{v:()=>n.v});var n=a(41775)},80420:(e,t,a)=>{a.d(t,{$:()=>b});var n=a(40336),r=a(63291),s=a(92459),o=a(31684),l=a(12888),i=a(71661),d=a(10508),u=a(25196),c=a(48372);const p=JSON.parse('{"field_links":"Links","context_developer-ui":"Developer UI"}'),h=(0,c.g4)("ydb-tablet-name-wrapper",{en:p});var m=a(60712);function b({tabletId:e,database:t}){const a=(0,l.X)(),c=(0,s.DM)(e,{database:t});return(0,m.jsx)(i.s,{disabled:!a,delayClosing:200,content:(0,m.jsx)(n.u,{responsive:!0,children:(0,m.jsx)(n.u.Item,{name:h("field_links"),children:(0,m.jsx)(u.K,{title:h("context_developer-ui"),url:(0,o._t)(e)})})}),placement:["top","bottom"],behavior:r.m.Immediate,children:(0,m.jsx)(d.c,{name:e.toString(),path:c,hasClipboardButton:!0,showStatus:!1})})}},27775:(e,t,a)=>{a.d(t,{i:()=>o});var n=a(47665),r=a(58267),s=a(60712);function o({state:e}){return(0,s.jsx)(n.J,{theme:(0,r._)(e),children:e})}},7117:(e,t,a)=>{a.d(t,{G:()=>ee});var n=a(59284),r=a(44508),s=a(98167),o=a(89073),l=a(86782),i=a(67028),d=a(15298),u=a(90182),c=a(88610);function p(){const e=(0,u.YQ)();return{problemFilter:(0,u.N4)(c.yV),handleProblemFilterChange:t=>{e((0,c.$u)(t))}}}var h=a(12888),m=a(43951),b=a(78034),g=a(71708),v=a(62710),y=a(98089),x=a(69775),f=a(24555),j=a(28539),N=a(9252),w=a(95963),C=a(64934),T=a(44433),S=a(48372);const F=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),I=(0,S.g4)("ydb-nodes",{en:F}),P=["database","static","other","any"],R={get database(){return I("database")},get static(){return I("static")},get other(){return I("other")},get any(){return I("any")}};var A=a(60712);function _({value:e="database",onChange:t}){return(0,A.jsx)(T.a,{value:e,onUpdate:t,children:P.map((e=>(0,A.jsx)(T.a.Option,{value:e,children:R[e]},e)))})}const B="nodesTableSelectedColumns",k=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],G=["NodeId"],L=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function D(e,t){return t?e:e.filter((e=>"SystemState"!==e))}var E=a(59109);const O=(0,a(77506).cn)("ydb-nodes"),q=e=>O("node",{unavailable:(0,b.X7)(e)}),U=e=>e&&403===e.status?(0,A.jsx)(E.O,{position:"left"}):(0,A.jsx)(r.o,{error:e});var V=a(67087);function $(e){var t;const[a,n]=(0,V.useQueryParams)({uptimeFilter:V.StringParam,peerRole:V.StringParam,search:V.StringParam,nodesGroupBy:V.StringParam}),r=b.Bm.parse(a.uptimeFilter),s=null!==(t=a.search)&&void 0!==t?t:"",o=(l=a.peerRole,P.find((e=>e===l)));var l;const d=(0,i.DM)(),u=function(e,t,a){return D(t,a).find((t=>t===e))}(a.nodesGroupBy,null!==e&&void 0!==e?e:[],d);return{uptimeFilter:r,searchValue:s,peerRoleFilter:o,groupByParam:u,handleSearchQueryChange:e=>{n({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{n({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{n({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{n({nodesGroupBy:e},"replaceIn")}}}function M({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:a,columnsToSelect:r,handleSelectedColumnsUpdate:s,entitiesCountCurrent:o,entitiesCountTotal:d,entitiesLoading:u}){const{searchValue:c,uptimeFilter:h,peerRoleFilter:m,groupByParam:b,handleSearchQueryChange:g,handleUptimeFilterChange:v,handlePeerRoleFilterChange:T,handleGroupByParamChange:S}=$(t),{problemFilter:F,handleProblemFilterChange:P}=p(),R=(0,i.DM)(),B=function(e,t){return D(e,t).map((e=>({value:e,content:(0,l.kn)(e)})))}(t,R),k=(0,i.WF)(),G=a&&k;return(0,A.jsxs)(n.Fragment,{children:[(0,A.jsx)(w.v,{onChange:g,placeholder:I("controls_search-placeholder"),width:238,value:c}),R&&e?null:(0,A.jsx)(N.k,{value:F,onChange:P}),e?null:(0,A.jsx)(C.j,{value:h,onChange:v}),G?(0,A.jsxs)(n.Fragment,{children:[(0,A.jsx)(y.E,{variant:"body-2",children:I("controls_peer-role-label")}),(0,A.jsx)(_,{value:m,onChange:T})]}):null,(0,A.jsx)(x.O,{popupWidth:200,items:r,showStatus:!0,onUpdate:s,sortable:!1}),e?(0,A.jsxs)(n.Fragment,{children:[(0,A.jsx)(y.E,{variant:"body-2",children:I("controls_group-by-placeholder")}),(0,A.jsx)(f.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:b?[b]:void 0,onUpdate:e=>{S(e[0])},options:B,className:O("group-by-select"),popupClassName:O("group-by-popup")})]}):null,(0,A.jsx)(j.T,{current:o,total:d,label:I("nodes"),loading:u})]})}var H=a(78524),K=a(40427),Q=a(11906),z=a(69464),W=a(40781);const X=async e=>{const{type:t="any",storage:a=!1,tablets:n=!0,limit:r,offset:s,sortParams:o,filters:i,columnsIds:d}=e,{sortOrder:u,columnId:c}=null!==o&&void 0!==o?o:{},{path:p,database:h,searchValue:m,problemFilter:g,uptimeFilter:v,peerRoleFilter:y,filterGroup:x,filterGroupBy:f}=null!==i&&void 0!==i?i:{},j=(0,l.kU)(c),N=j?(0,z.T)(j,u):void 0,w=(0,W.R)(d,l.fN),C=await window.api.viewer.getNodes({type:t,storage:a,tablets:n,limit:r,offset:s,sort:N,path:p,database:h,filter:m,problems_only:(0,b.AB)(g),uptime:(0,b.Fo)(v),filter_peer_role:y,filter_group:x,filter_group_by:f,fieldsRequired:w}),T=(0,Q.N)(C);return{data:T.Nodes||[],found:T.FoundNodes||0,total:T.TotalNodes||0}};function J({path:e,database:t,searchValue:a,problemFilter:r,uptimeFilter:s,peerRoleFilter:o,filterGroup:i,filterGroupBy:d,columns:u,parentRef:c,renderControls:p,initialEntitiesCount:h}){const m=n.useMemo((()=>({path:e,database:t,searchValue:a,problemFilter:r,uptimeFilter:s,peerRoleFilter:o,filterGroup:i,filterGroupBy:d})),[e,t,a,r,s,o,i,d]);return(0,A.jsx)(K.k5,{columnsWidthLSKey:l.zO,parentRef:c,columns:u,fetchData:X,limit:50,initialEntitiesCount:h,renderControls:p,renderErrorMessage:U,renderEmptyDataMessage:()=>"All"!==r||s!==b.cW.All?(0,A.jsx)(H.v,{name:"thumbsUp",width:"200"}):I("empty.default"),getRowClassName:q,filters:m,tableName:"nodes"})}var Y=a(78762);function Z(e){return[(0,Y._E)(),(0,Y.Nh)(e),(0,Y.eT)(),(0,Y.uk)(),(0,Y.OX)(),(0,Y.jl)(),(0,Y.fr)(),(0,Y.kv)(),(0,Y.pH)(),(0,Y.iX)(),(0,Y.ID)(),(0,Y.Rn)(),(0,Y.qp)(e)].map((e=>({...e,sortable:(0,l.sp)(e.name)})))}function ee({path:e,database:t,parentRef:a,additionalNodesProps:r,withPeerRoleFilter:o,columns:d=Z({database:t,getNodeRef:null===r||void 0===r?void 0:r.getNodeRef}),defaultColumnsIds:u=k,requiredColumnsIds:c=G,selectedColumnsKey:m=B,groupByParams:g=L}){const{uptimeFilter:v,groupByParam:y,handleUptimeFilterChange:x}=$(g),{problemFilter:f,handleProblemFilterChange:j}=p(),N=(0,i.Pm)(),w=(0,i.Ye)(),C=(0,h.X)(),T=n.useMemo((()=>C?d:d.filter((e=>!(0,l.xd)(e.name)))),[d,C]);n.useEffect((()=>{!w||"All"===f&&v===b.cW.All||(j("All"),x(b.cW.All))}),[j,x,f,v,w]);return(0,A.jsx)(s.r,{loading:!N,children:w&&y?(0,A.jsx)(ae,{path:e,database:t,parentRef:a,withPeerRoleFilter:o,columns:T,defaultColumnsIds:u,requiredColumnsIds:c,selectedColumnsKey:m,groupByParams:g}):(0,A.jsx)(te,{path:e,database:t,parentRef:a,withPeerRoleFilter:o,columns:T,defaultColumnsIds:u,requiredColumnsIds:c,selectedColumnsKey:m,groupByParams:g})})}function te({path:e,database:t,parentRef:a,withPeerRoleFilter:n,columns:r,defaultColumnsIds:s,requiredColumnsIds:o,selectedColumnsKey:d,groupByParams:u}){const{searchValue:c,uptimeFilter:h,peerRoleFilter:b}=$(u),{problemFilter:g}=p(),v=(0,i.Ye)(),{columnsToShow:y,columnsToSelect:x,setColumns:f}=(0,m.K)(r,d,l.uG,s,o);return(0,A.jsx)(J,{path:e,database:t,searchValue:c,problemFilter:g,uptimeFilter:h,peerRoleFilter:b,columns:y,parentRef:a,renderControls:({totalEntities:e,foundEntities:t,inited:a})=>(0,A.jsx)(M,{withGroupBySelect:v,groupByParams:u,withPeerRoleFilter:n,columnsToSelect:x,handleSelectedColumnsUpdate:f,entitiesCountCurrent:t,entitiesCountTotal:e,entitiesLoading:!a})})}function ae({path:e,database:t,parentRef:a,withPeerRoleFilter:n,columns:s,defaultColumnsIds:i,requiredColumnsIds:c,selectedColumnsKey:p,groupByParams:h}){const{searchValue:y,peerRoleFilter:x,groupByParam:f}=$(h),[j]=(0,u.Nt)(),{columnsToShow:N,columnsToSelect:w,setColumns:C}=(0,m.K)(s,p,l.uG,i,c),{currentData:T,isFetching:S,error:F}=d.s.useGetNodesQuery({path:e,database:t,filter:y,filter_peer_role:x,group:f,limit:0},{pollingInterval:j}),P=void 0===T&&S,{NodeGroups:R,FoundNodes:_=0,TotalNodes:B=0}=T||{},{expandedGroups:k,setIsGroupExpanded:G}=(0,v.$)(R);return(0,A.jsxs)(o.L,{children:[(0,A.jsx)(o.L.Controls,{children:(0,A.jsx)(M,{withGroupBySelect:!0,groupByParams:h,withPeerRoleFilter:n,columnsToSelect:w,handleSelectedColumnsUpdate:C,entitiesCountCurrent:_,entitiesCountTotal:B,entitiesLoading:P})}),F?(0,A.jsx)(r.o,{error:F}):null,(0,A.jsx)(o.L.Table,{loading:P,className:O("groups-wrapper"),children:null!==R&&void 0!==R&&R.length?R.map((({name:n,count:r})=>{const s=k[n];return(0,A.jsx)(g.Q,{title:n,count:r,entityName:I("nodes"),expanded:s,onIsExpandedChange:G,children:(0,A.jsx)(J,{path:e,database:t,searchValue:y,problemFilter:"All",uptimeFilter:b.cW.All,peerRoleFilter:x,filterGroup:n,filterGroupBy:f,initialEntitiesCount:r,columns:N,parentRef:a})},n)})):I("no-nodes-groups")})]})}},88616:(e,t,a)=>{a.d(t,{Q:()=>P});var n=a(59284),r=a(76938),s=a(98089),o=a(99991),l=a(67087),i=a(22983),d=a(28539),u=a(10508),c=a(44508),p=a(44294),h=a(17594),m=a(41775),b=a(89073),g=a(80420),v=a(27775),y=a(41826),x=a(21545),f=a(6354),j=a(76086),N=a(12888),w=a(29819),C=a(48372);const T=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),S=(0,C.g4)("ydb-tablets",{en:T});var F=a(60712);function I(e){const t=e.State===f.r.Stopped,a=(0,N.X)(),[n]=x.X.useKillTabletMutation(),s=e.TabletId;return s?(0,F.jsx)(i.B,{buttonView:"outlined",buttonTitle:S("dialog.kill-header"),dialogHeader:S("dialog.kill-header"),dialogText:S("dialog.kill-text"),onConfirmAction:()=>n({id:s}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:S(a?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,F.jsx)(o.I,{data:r.A})}):null}function P({database:e,tablets:t,loading:a,error:r}){const[{tabletsSearch:o},i]=(0,l.useQueryParams)({tabletsSearch:l.StringParam}),x=n.useMemo((()=>function({database:e}){return[{name:"Type",width:150,get header(){return S("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,F.jsxs)("span",{children:[e.Type," ",t?(0,F.jsx)(s.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return S("Tablet")},render:({row:t})=>t.TabletId?(0,F.jsx)(g.$,{tabletId:t.TabletId,database:e}):j.Pd},{name:"State",get header(){return S("State")},render:({row:e})=>(0,F.jsx)(v.i,{state:e.State})},{name:"NodeId",get header(){return S("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,w.vI)(e.NodeId);return(0,F.jsx)(p.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return S("Node FQDN")},render:({row:e})=>e.fqdn?(0,F.jsx)(u.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,F.jsx)("span",{children:"\u2014"})},{name:"Generation",get header(){return S("Generation")},align:"right"},{name:"Uptime",get header(){return S("Uptime")},render:({row:e})=>(0,F.jsx)(y.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,F.jsx)(I,{...e})}]}({database:e})),[e]),f=n.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==o&&void 0!==o?o:"")))),[t,o]);return(0,F.jsxs)(b.L,{children:[(0,F.jsxs)(b.L.Controls,{children:[(0,F.jsx)(m.v,{placeholder:S("controls.search-placeholder"),onChange:e=>{i({tabletsSearch:e||void 0},"replaceIn")},value:null!==o&&void 0!==o?o:"",width:238}),(0,F.jsx)(d.T,{label:S("controls.entities-count-label"),loading:a,total:t.length,current:f.length})]}),r?(0,F.jsx)(c.o,{error:r}):null,(0,F.jsx)(b.L.Table,{loading:a,children:(0,F.jsx)(h.l,{columns:x,data:f,settings:j.N3,emptyDataMessage:S("noTabletsData")})})]})}},89954:(e,t,a)=>{a.d(t,{O:()=>S});var n=a(59284),r=a(45720),s=a(16929),o=a(71153),l=a(18677),i=a(84476),d=a(33705),u=a(67884),c=a(99991),p=a(77506),h=a(48372);const m=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),b=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),g=(0,h.g4)("ydb-shorty-string",{ru:b,en:m});var v=a(60712);const y=(0,p.cn)("kv-shorty-string");function x({value:e="",limit:t=200,strict:a=!1,displayLength:r=!0,render:s=e=>e,onToggle:o,expandLabel:l=g("default_expand_label"),collapseLabel:i=g("default_collapse_label")}){const[d,c]=n.useState(!1),p=(d?i:l)+(r&&!d?g("chars_count",{count:e.length}):""),h=e.length>t+(a?0:p.length),m=d||!h?e:e.slice(0,t-4)+"\xa0...";return(0,v.jsxs)("div",{className:y(),children:[s(m),h?(0,v.jsx)(u.N,{className:y("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),c((e=>!e)),null===o||void 0===o||o()},children:p}):null]})}var f=a(41650);const j=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function N(e){return function(e){return!!e&&void 0!==j[e]}(e)?j[e]:"S_INFO"}const w=(0,p.cn)("kv-result-issues"),C=(0,p.cn)("kv-issues"),T=(0,p.cn)("kv-issue");function S({data:e,hideSeverity:t}){const[a,r]=n.useState(!1),s="string"===typeof e||null===e||void 0===e?void 0:e.issues,o=Array.isArray(s)&&s.length>0;return(0,v.jsxs)("div",{className:w(),children:[(0,v.jsxs)("div",{className:w("error-message"),children:[(()=>{let a;if("string"===typeof e)a=e;else{var r,s;const o=N(null===e||void 0===e||null===(r=e.error)||void 0===r?void 0:r.severity);a=(0,v.jsxs)(n.Fragment,{children:[t?null:(0,v.jsxs)(n.Fragment,{children:[(0,v.jsx)(B,{severity:o})," "]}),(0,v.jsx)("span",{className:w("error-message-text"),children:null===e||void 0===e||null===(s=e.error)||void 0===s?void 0:s.message})]})}return a})(),o&&(0,v.jsx)(i.$,{view:"normal",onClick:()=>r(!a),children:a?"Hide details":"Show details"})]}),o&&a&&(0,v.jsx)(F,{hideSeverity:t,issues:s})]})}function F({issues:e,hideSeverity:t}){const a=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var a;const n=null!==(a=t.severity)&&void 0!==a?a:10;return Math.min(e,n)}),10);return(0,v.jsx)("div",{className:C(null),children:null===e||void 0===e?void 0:e.map(((e,n)=>(0,v.jsx)(I,{hideSeverity:t,issue:e,expanded:e===a},n)))})}function I({issue:e,hideSeverity:t,level:a=0}){const[r,s]=n.useState(!0),o=N(e.severity),l=e.issues,u=Array.isArray(l)&&l.length>0,c=r?"bottom":"right";return(0,v.jsxs)("div",{className:T({leaf:!u,"has-issues":u}),children:[(0,v.jsxs)("div",{className:T("line"),children:[u&&(0,v.jsx)(i.$,{view:"flat-secondary",onClick:()=>s(!r),className:T("arrow-toggle"),children:(0,v.jsx)(d.I,{direction:c,size:16})}),t?null:(0,v.jsx)(B,{severity:o}),(0,v.jsx)(P,{issue:e}),e.issue_code?(0,v.jsxs)("span",{className:T("code"),children:["Code: ",e.issue_code]}):null]}),u&&r&&(0,v.jsx)("div",{className:T("issues"),children:(0,v.jsx)(R,{issues:l,level:a+1,expanded:r})})]})}function P({issue:e}){var t;const a=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,f.kf)(t.row))return"";const{row:a,column:n}=t;return(0,f.kf)(n)?`${a}:${n}`:`line ${a}`}(e),n=window.ydbEditor,r=()=>(0,v.jsxs)("span",{className:T("message"),children:[a&&(0,v.jsx)("span",{className:T("place-text"),title:"Position",children:a}),(0,v.jsx)("div",{className:T("message-text"),children:(0,v.jsx)(x,{value:e.message,expandLabel:"Show full message"})})]}),{row:s,column:o}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,f.kf)(s)&&n))return r();return(0,v.jsx)(u.N,{href:"#",extraProps:{draggable:!1},onClick:()=>{const e={lineNumber:s,column:null!==o&&void 0!==o?o:0};n.setPosition(e),n.revealPositionInCenterIfOutsideViewport(e),n.focus()},view:"primary",children:r()})}function R(e){const{issues:t,level:a,expanded:n}=e;return(0,v.jsx)("div",{className:T("list"),children:t.map(((e,t)=>(0,v.jsx)(I,{issue:e,level:a,expanded:n},t)))})}const A={S_INFO:r.A,S_WARNING:s.A,S_ERROR:o.A,S_FATAL:l.A},_=(0,p.cn)("yql-issue-severity");function B({severity:e}){const t=e.slice(2).toLowerCase();return(0,v.jsxs)("span",{className:_({severity:t}),children:[(0,v.jsx)(c.I,{className:_("icon"),data:A[e]}),(0,v.jsx)("span",{className:_("title"),children:t})]})}},15298:(e,t,a)=>{a.d(t,{s:()=>s});var n=a(21334),r=a(11906);const s=n.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const a=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,r.N)(a)}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"})},11906:(e,t,a)=>{a.d(t,{N:()=>r});var n=a(78034);const r=e=>{var t;const a=(e.Nodes||[]).map((e=>{const{SystemState:t,...a}=e;return{...a,...(0,n.q1)(t)}}));return{Nodes:a,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||a.length,FoundNodes:Number(e.FoundNodes)}}},21545:(e,t,a)=>{a.d(t,{X:()=>r});var n=a(78034);const r=a(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t},{signal:a})=>{try{const[r,s,o]=await Promise.all([window.api.viewer.getTablet({id:e,database:t},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({signal:a})]),l=(0,n.nN)(o),i=Object.keys(s).reduce(((e,t)=>{var a;const n=null===(a=s[t])||void 0===a?void 0:a.TabletStateInfo;if(n&&n.length){var r;const a=n.find((e=>e.Leader))||n[0],{ChangeTime:s,Generation:o,State:i,Leader:d,FollowerId:u}=a,c=l&&t?null===(r=l.get(Number(t)))||void 0===r?void 0:r.Host:void 0;"Dead"!==i&&e.push({nodeId:t,generation:o,changeTime:s,state:i,leader:d,followerId:u,fqdn:c})}return e}),[]),{TabletStateInfo:d=[]}=r,[u={}]=d,{TabletId:c}=u;return{data:{id:c,data:u,history:i}}}catch(r){return{error:r}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const a=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:n,PathId:r}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${n}:${r}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(n){return{error:n}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})}}]);