"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[1434],{22983:(e,t,a)=>{a.d(t,{B:()=>d});var r=a(59284),n=a(84476),s=a(84375),l=a(55974),o=a(42829),i=a(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:a,dialogHeader:d,dialogText:u,retryButtonText:c,buttonDisabled:p=!1,buttonView:h="action",buttonTitle:m,buttonClassName:g,withPopover:b=!1,popoverContent:y,popoverPlacement:v="right",popoverDisabled:x=!0}){const[f,j]=r.useState(!1),[w,C]=r.useState(!1),[N,T]=r.useState(!1),S=()=>(0,i.jsx)(n.$,{onClick:()=>j(!0),view:h,disabled:p,loading:!p&&w,className:g,title:m,children:e});return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)(l.g,{visible:f,header:d,text:u,withRetry:N,retryButtonText:c,onConfirm:async e=>{C(!0),await t(e)},onConfirmActionSuccess:async()=>{T(!1);try{await(null===a||void 0===a?void 0:a())}finally{C(!1)}},onConfirmActionError:e=>{T((0,o.D)(e)),C(!1)},onClose:()=>{j(!1)}}),b?(0,i.jsx)(s.A,{content:y,placement:v,disabled:x,children:S()}):S()]})}},55974:(e,t,a)=>{a.d(t,{g:()=>y});var r=a(59284),n=a(18677),s=a(71153),l=a(74321),o=a(2198),i=a(99991),d=a(89954),u=a(77506),c=a(48372);const p=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),h=(0,c.g4)("ydb-critical-action-dialog",{en:p});var m=a(60712);const g=(0,u.cn)("ydb-critical-dialog"),b=e=>e.data&&"issues"in e.data&&e.data.issues?(0,m.jsx)(d.O,{hideSeverity:!0,data:e.data}):403===e.status?h("no-rights-error"):e.statusText?e.statusText:h("default-error");function y({visible:e,header:t,text:a,withRetry:d,retryButtonText:u,withCheckBox:c,onClose:p,onConfirm:y,onConfirmActionSuccess:v,onConfirmActionError:x}){const[f,j]=r.useState(!1),[w,C]=r.useState(),[N,T]=r.useState(!1),S=async e=>(j(!0),y(e).then((()=>{v(),p()})).catch((e=>{x(e),C(e)})).finally((()=>{j(!1)})));return(0,m.jsx)(o.l,{open:e,hasCloseButton:!1,className:g(),size:"s",onClose:p,onTransitionExited:()=>{C(void 0),T(!1)},children:w?(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(o.l.Header,{caption:t}),(0,m.jsx)(o.l.Body,{className:g("body"),children:(0,m.jsxs)("div",{className:g("body-message",{error:!0}),children:[(0,m.jsx)("span",{className:g("error-icon"),children:(0,m.jsx)(n.A,{width:"24",height:"22"})}),b(w)]})}),(0,m.jsx)(o.l.Footer,{loading:!1,preset:"default",textButtonApply:d?u||h("button-retry"):void 0,textButtonCancel:h("button-close"),onClickButtonApply:()=>S(!0),onClickButtonCancel:p})]}):(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(o.l.Header,{caption:t}),(0,m.jsxs)(o.l.Body,{className:g("body"),children:[(0,m.jsxs)("div",{className:g("body-message",{warning:!0}),children:[(0,m.jsx)("span",{className:g("warning-icon"),children:(0,m.jsx)(i.I,{data:s.A,size:24})}),a]}),c?(0,m.jsx)(l.S,{checked:N,onUpdate:T,children:h("checkbox-text")}):null]}),(0,m.jsx)(o.l.Footer,{loading:f,preset:"default",textButtonApply:h("button-confirm"),textButtonCancel:h("button-cancel"),propsButtonApply:{type:"submit",disabled:c&&!N},onClickButtonCancel:p,onClickButtonApply:()=>S()})]})})}},42829:(e,t,a)=>{a.d(t,{D:()=>r});const r=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},2102:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(77506),n=a(60712);const s=(0,r.cn)("ydb-diagnostic-card");function l({children:e,className:t,active:a,size:r="m",interactive:l=!0}){return(0,n.jsx)("div",{className:s({active:a,size:r,interactive:l},t),children:e})}},28539:(e,t,a)=>{a.d(t,{T:()=>r.T});var r=a(53755)},52248:(e,t,a)=>{a.d(t,{a:()=>r.a});var r=a(47334)},9252:(e,t,a)=>{a.d(t,{k:()=>l});var r=a(44433),n=a(88610),s=a(60712);const l=({value:e,onChange:t,className:a})=>(0,s.jsxs)(r.a,{value:e,onUpdate:t,className:a,children:[(0,s.jsx)(r.a.Option,{value:n.s$.ALL,children:n.s$.ALL}),(0,s.jsx)(r.a.Option,{value:n.s$.PROBLEMS,children:n.s$.PROBLEMS})]})},95963:(e,t,a)=>{a.d(t,{v:()=>r.v});var r=a(41775)},80420:(e,t,a)=>{a.d(t,{$:()=>b});var r=a(40336),n=a(63291),s=a(92459),l=a(78668),o=a(31684),i=a(90182),d=a(71661),u=a(10508),c=a(25196),p=a(48372);const h=JSON.parse('{"field_links":"Links","context_developer-ui":"Developer UI"}'),m=(0,p.g4)("ydb-tablet-name-wrapper",{en:h});var g=a(60712);function b({tabletId:e,database:t}){const a=(0,i.N4)(l._5),p=(0,s.DM)(e,{database:t});return(0,g.jsx)(d.s,{disabled:!a,delayClosing:200,content:(0,g.jsx)(r.u,{responsive:!0,children:(0,g.jsx)(r.u.Item,{name:m("field_links"),children:(0,g.jsx)(c.K,{title:m("context_developer-ui"),url:(0,o._t)(e)})})}),placement:["top","bottom"],behavior:n.m.Immediate,children:(0,g.jsx)(u.c,{name:e.toString(),path:p,hasClipboardButton:!0,showStatus:!1})})}},27775:(e,t,a)=>{a.d(t,{i:()=>l});var r=a(47665),n=a(58267),s=a(60712);function l({state:e}){return(0,s.jsx)(r.J,{theme:(0,n._8)(e),children:e})}},7117:(e,t,a)=>{a.d(t,{G:()=>Z});var r=a(59284),n=a(44508),s=a(98167),l=a(89073),o=a(86782),i=a(67028),d=a(15298),u=a(90182),c=a(88610);function p(){const e=(0,u.YQ)();return{problemFilter:(0,u.N4)(c.yV),handleProblemFilterChange:t=>{e((0,c.$u)(t))}}}var h=a(43951),m=a(78034),g=a(71708),b=a(62710),y=a(98089),v=a(29289),x=a(24555),f=a(28539),j=a(9252),w=a(95963),C=a(64934),N=a(44433),T=a(48372);const S=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),F=(0,T.g4)("ydb-nodes",{en:S}),I=["database","static","other","any"],R={get database(){return F("database")},get static(){return F("static")},get other(){return F("other")},get any(){return F("any")}};var _=a(60712);function P({value:e="database",onChange:t}){return(0,_.jsx)(N.a,{value:e,onUpdate:t,children:I.map((e=>(0,_.jsx)(N.a.Option,{value:e,children:R[e]},e)))})}const A="nodesTableSelectedColumns",B=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],k=["NodeId"],G=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function D(e,t){return t?e:e.filter((e=>"SystemState"!==e))}var L=a(59109);const E=(0,a(77506).cn)("ydb-nodes"),O=e=>E("node",{unavailable:(0,m.X7)(e)}),q=e=>e&&403===e.status?(0,_.jsx)(L.O,{position:"left"}):(0,_.jsx)(n.o,{error:e});var U=a(67087);function $(e){var t;const[a,r]=(0,U.useQueryParams)({uptimeFilter:U.StringParam,peerRole:U.StringParam,search:U.StringParam,nodesGroupBy:U.StringParam}),n=m.Bm.parse(a.uptimeFilter),s=null!==(t=a.search)&&void 0!==t?t:"",l=(o=a.peerRole,I.find((e=>e===o)));var o;const d=(0,i.DM)(),u=function(e,t,a){return D(t,a).find((t=>t===e))}(a.nodesGroupBy,null!==e&&void 0!==e?e:[],d);return{uptimeFilter:n,searchValue:s,peerRoleFilter:l,groupByParam:u,handleSearchQueryChange:e=>{r({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{r({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{r({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{r({nodesGroupBy:e},"replaceIn")}}}function V({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:a,columnsToSelect:n,handleSelectedColumnsUpdate:s,entitiesCountCurrent:l,entitiesCountTotal:d,entitiesLoading:u}){const{searchValue:c,uptimeFilter:h,peerRoleFilter:m,groupByParam:g,handleSearchQueryChange:b,handleUptimeFilterChange:N,handlePeerRoleFilterChange:T,handleGroupByParamChange:S}=$(t),{problemFilter:I,handleProblemFilterChange:R}=p(),A=(0,i.DM)(),B=function(e,t){return D(e,t).map((e=>({value:e,content:(0,o.kn)(e)})))}(t,A),k=(0,i.WF)(),G=a&&k;return(0,_.jsxs)(r.Fragment,{children:[(0,_.jsx)(w.v,{onChange:b,placeholder:F("controls_search-placeholder"),width:238,value:c}),A&&e?null:(0,_.jsx)(j.k,{value:I,onChange:R}),e?null:(0,_.jsx)(C.j,{value:h,onChange:N}),G?(0,_.jsxs)(r.Fragment,{children:[(0,_.jsx)(y.E,{variant:"body-2",children:F("controls_peer-role-label")}),(0,_.jsx)(P,{value:m,onChange:T})]}):null,(0,_.jsx)(v.O,{popupWidth:200,items:n,showStatus:!0,onUpdate:s,sortable:!1}),e?(0,_.jsxs)(r.Fragment,{children:[(0,_.jsx)(y.E,{variant:"body-2",children:F("controls_group-by-placeholder")}),(0,_.jsx)(x.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:g?[g]:void 0,onUpdate:e=>{S(e[0])},options:B,className:E("group-by-select"),popupClassName:E("group-by-popup")})]}):null,(0,_.jsx)(f.T,{current:l,total:d,label:F("nodes"),loading:u})]})}var H=a(78524),M=a(40427),Q=a(11906),K=a(69464),W=a(40781);const z=async e=>{const{type:t="any",storage:a=!1,tablets:r=!0,limit:n,offset:s,sortParams:l,filters:i,columnsIds:d}=e,{sortOrder:u,columnId:c}=null!==l&&void 0!==l?l:{},{path:p,database:h,searchValue:g,problemFilter:b,uptimeFilter:y,peerRoleFilter:v,filterGroup:x,filterGroupBy:f}=null!==i&&void 0!==i?i:{},j=(0,o.kU)(c),w=j?(0,K.T)(j,u):void 0,C=(0,W.R)(d,o.fN),N=await window.api.viewer.getNodes({type:t,storage:a,tablets:r,limit:n,offset:s,sort:w,path:p,database:h,filter:g,problems_only:(0,m.AB)(b),uptime:(0,m.Fo)(y),filter_peer_role:v,filter_group:x,filter_group_by:f,fieldsRequired:C}),T=(0,Q.N)(N);return{data:T.Nodes||[],found:T.FoundNodes||0,total:T.TotalNodes||0}};function J({path:e,database:t,searchValue:a,problemFilter:n,uptimeFilter:s,peerRoleFilter:l,filterGroup:i,filterGroupBy:d,columns:u,parentRef:c,renderControls:p,initialEntitiesCount:h}){const g=r.useMemo((()=>({path:e,database:t,searchValue:a,problemFilter:n,uptimeFilter:s,peerRoleFilter:l,filterGroup:i,filterGroupBy:d})),[e,t,a,n,s,l,i,d]);return(0,_.jsx)(M.k5,{columnsWidthLSKey:o.zO,parentRef:c,columns:u,fetchData:z,limit:50,initialEntitiesCount:h,renderControls:p,renderErrorMessage:q,renderEmptyDataMessage:()=>"All"!==n||s!==m.cW.All?(0,_.jsx)(H.v,{name:"thumbsUp",width:"200"}):F("empty.default"),getRowClassName:O,filters:g,tableName:"nodes"})}var X=a(78762);function Y(e){return[(0,X._E)(),(0,X.Nh)(e),(0,X.eT)(),(0,X.uk)(),(0,X.OX)(),(0,X.jl)(),(0,X.fr)(),(0,X.kv)(),(0,X.pH)(),(0,X.iX)(),(0,X.ID)(),(0,X.Rn)(),(0,X.qp)(e)].map((e=>({...e,sortable:(0,o.sp)(e.name)})))}function Z({path:e,database:t,parentRef:a,additionalNodesProps:n,withPeerRoleFilter:l,columns:o=Y({database:t,getNodeRef:null===n||void 0===n?void 0:n.getNodeRef}),defaultColumnsIds:d=B,requiredColumnsIds:u=k,selectedColumnsKey:c=A,groupByParams:h=G}){const{uptimeFilter:g,groupByParam:b,handleUptimeFilterChange:y}=$(h),{problemFilter:v,handleProblemFilterChange:x}=p(),f=(0,i.Pm)(),j=(0,i.Ye)();r.useEffect((()=>{!j||"All"===v&&g===m.cW.All||(x("All"),y(m.cW.All))}),[x,y,v,g,j]);return(0,_.jsx)(s.r,{loading:!f,children:j&&b?(0,_.jsx)(te,{path:e,database:t,parentRef:a,withPeerRoleFilter:l,columns:o,defaultColumnsIds:d,requiredColumnsIds:u,selectedColumnsKey:c,groupByParams:h}):(0,_.jsx)(ee,{path:e,database:t,parentRef:a,withPeerRoleFilter:l,columns:o,defaultColumnsIds:d,requiredColumnsIds:u,selectedColumnsKey:c,groupByParams:h})})}function ee({path:e,database:t,parentRef:a,withPeerRoleFilter:r,columns:n,defaultColumnsIds:s,requiredColumnsIds:l,selectedColumnsKey:d,groupByParams:u}){const{searchValue:c,uptimeFilter:m,peerRoleFilter:g}=$(u),{problemFilter:b}=p(),y=(0,i.Ye)(),{columnsToShow:v,columnsToSelect:x,setColumns:f}=(0,h.K)(n,d,o.uG,s,l);return(0,_.jsx)(J,{path:e,database:t,searchValue:c,problemFilter:b,uptimeFilter:m,peerRoleFilter:g,columns:v,parentRef:a,renderControls:({totalEntities:e,foundEntities:t,inited:a})=>(0,_.jsx)(V,{withGroupBySelect:y,groupByParams:u,withPeerRoleFilter:r,columnsToSelect:x,handleSelectedColumnsUpdate:f,entitiesCountCurrent:t,entitiesCountTotal:e,entitiesLoading:!a})})}function te({path:e,database:t,parentRef:a,withPeerRoleFilter:r,columns:s,defaultColumnsIds:i,requiredColumnsIds:c,selectedColumnsKey:p,groupByParams:y}){const{searchValue:v,peerRoleFilter:x,groupByParam:f}=$(y),[j]=(0,u.Nt)(),{columnsToShow:w,columnsToSelect:C,setColumns:N}=(0,h.K)(s,p,o.uG,i,c),{currentData:T,isFetching:S,error:I}=d.s.useGetNodesQuery({path:e,database:t,filter:v,filter_peer_role:x,group:f,limit:0},{pollingInterval:j}),R=void 0===T&&S,{NodeGroups:P,FoundNodes:A=0,TotalNodes:B=0}=T||{},{expandedGroups:k,setIsGroupExpanded:G}=(0,b.$)(P);return(0,_.jsxs)(l.L,{children:[(0,_.jsx)(l.L.Controls,{children:(0,_.jsx)(V,{withGroupBySelect:!0,groupByParams:y,withPeerRoleFilter:r,columnsToSelect:C,handleSelectedColumnsUpdate:N,entitiesCountCurrent:A,entitiesCountTotal:B,entitiesLoading:R})}),I?(0,_.jsx)(n.o,{error:I}):null,(0,_.jsx)(l.L.Table,{loading:R,className:E("groups-wrapper"),children:null!==P&&void 0!==P&&P.length?P.map((({name:r,count:n})=>{const s=k[r];return(0,_.jsx)(g.Q,{title:r,count:n,entityName:F("nodes"),expanded:s,onIsExpandedChange:G,children:(0,_.jsx)(J,{path:e,database:t,searchValue:v,problemFilter:"All",uptimeFilter:m.cW.All,peerRoleFilter:x,filterGroup:r,filterGroupBy:f,initialEntitiesCount:n,columns:w,parentRef:a})},r)})):F("no-nodes-groups")})]})}},88616:(e,t,a)=>{a.d(t,{Q:()=>S});var r=a(76938),n=a(98089),s=a(99991),l=a(22983),o=a(10508),i=a(44294),d=a(17594),u=a(19228),c=a(80420),p=a(27775),h=a(78668),m=a(21545),g=a(6354),b=a(76086),y=a(86200),v=a(90182),x=a(29819),f=a(48372);const j=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),w=(0,f.g4)("ydb-tablets",{en:j});var C=a(60712);function N({database:e}){return[{name:"Type",width:150,get header(){return w("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,C.jsxs)("span",{children:[e.Type," ",t?(0,C.jsx)(n.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return w("Tablet")},render:({row:t})=>t.TabletId?(0,C.jsx)(c.$,{tabletId:t.TabletId,database:e}):b.Pd},{name:"State",get header(){return w("State")},render:({row:e})=>(0,C.jsx)(p.i,{state:e.State})},{name:"NodeId",get header(){return w("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,x.vI)(e.NodeId);return(0,C.jsx)(i.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return w("Node FQDN")},render:({row:e})=>e.fqdn?(0,C.jsx)(o.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,C.jsx)("span",{children:"\u2014"})},{name:"Generation",get header(){return w("Generation")},align:"right"},{name:"Uptime",get header(){return w("Uptime")},render:({row:e})=>(0,y.H7)(e.ChangeTime),sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,C.jsx)(T,{...e})}]}function T(e){const t=e.State===g.r.Stopped,a=(0,v.N4)(h._5),[n]=m.X.useKillTabletMutation(),o=e.TabletId;return o?(0,C.jsx)(l.B,{buttonView:"outlined",buttonTitle:w("dialog.kill-header"),dialogHeader:w("dialog.kill-header"),dialogText:w("dialog.kill-text"),onConfirmAction:()=>n({id:o}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:w(a?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,C.jsx)(s.I,{data:r.A})}):null}function S({database:e,tablets:t,className:a,loading:r}){return r?(0,C.jsx)(u.Q,{}):(0,C.jsx)(d.l,{wrapperClassName:a,columns:N({database:e}),data:t,settings:b.N3,emptyDataMessage:w("noTabletsData")})}},89954:(e,t,a)=>{a.d(t,{O:()=>S});var r=a(59284),n=a(45720),s=a(16929),l=a(71153),o=a(18677),i=a(84476),d=a(33705),u=a(99991),c=a(67884),p=a(77506),h=a(48372);const m=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),g=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),b=(0,h.g4)("ydb-shorty-string",{ru:g,en:m});var y=a(60712);const v=(0,p.cn)("kv-shorty-string");function x({value:e="",limit:t=200,strict:a=!1,displayLength:n=!0,render:s=e=>e,onToggle:l,expandLabel:o=b("default_expand_label"),collapseLabel:i=b("default_collapse_label")}){const[d,u]=r.useState(!1),p=(d?i:o)+(n&&!d?b("chars_count",{count:e.length}):""),h=e.length>t+(a?0:p.length),m=d||!h?e:e.slice(0,t-4)+"\xa0...";return(0,y.jsxs)("div",{className:v(),children:[s(m),h?(0,y.jsx)(c.N,{className:v("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),u((e=>!e)),null===l||void 0===l||l()},children:p}):null]})}var f=a(41650);const j=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function w(e){return function(e){return!!e&&void 0!==j[e]}(e)?j[e]:"S_INFO"}const C=(0,p.cn)("kv-result-issues"),N=(0,p.cn)("kv-issues"),T=(0,p.cn)("kv-issue");function S({data:e,hideSeverity:t}){const[a,n]=r.useState(!1),s="string"===typeof e||null===e||void 0===e?void 0:e.issues,l=Array.isArray(s)&&s.length>0;return(0,y.jsxs)("div",{className:C(),children:[(0,y.jsxs)("div",{className:C("error-message"),children:[(()=>{let a;if("string"===typeof e)a=e;else{var n,s;const l=w(null===e||void 0===e||null===(n=e.error)||void 0===n?void 0:n.severity);a=(0,y.jsxs)(r.Fragment,{children:[t?null:(0,y.jsxs)(r.Fragment,{children:[(0,y.jsx)(A,{severity:l})," "]}),(0,y.jsx)("span",{className:C("error-message-text"),children:null===e||void 0===e||null===(s=e.error)||void 0===s?void 0:s.message})]})}return a})(),l&&(0,y.jsx)(i.$,{view:"normal",onClick:()=>n(!a),children:a?"Hide details":"Show details"})]}),l&&a&&(0,y.jsx)(F,{hideSeverity:t,issues:s})]})}function F({issues:e,hideSeverity:t}){const a=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var a;const r=null!==(a=t.severity)&&void 0!==a?a:10;return Math.min(e,r)}),10);return(0,y.jsx)("div",{className:N(null),children:null===e||void 0===e?void 0:e.map(((e,r)=>(0,y.jsx)(I,{hideSeverity:t,issue:e,expanded:e===a},r)))})}function I({issue:e,hideSeverity:t,level:a=0}){const[n,s]=r.useState(!0),l=w(e.severity),o=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,f.kf)(t.row))return"";const{row:a,column:r}=t;return(0,f.kf)(r)?`${a}:${r}`:`line ${a}`}(e),u=e.issues,c=Array.isArray(u)&&u.length>0,p=n?"bottom":"right";return(0,y.jsxs)("div",{className:T({leaf:!c,"has-issues":c}),children:[(0,y.jsxs)("div",{className:T("line"),children:[c&&(0,y.jsx)(i.$,{view:"flat-secondary",onClick:()=>s(!n),className:T("arrow-toggle"),children:(0,y.jsx)(d.I,{direction:p,size:16})}),t?null:(0,y.jsx)(A,{severity:l}),(0,y.jsxs)("span",{className:T("message"),children:[o&&(0,y.jsx)("span",{className:T("place-text"),title:"Position",children:o}),(0,y.jsx)("div",{className:T("message-text"),children:(0,y.jsx)(x,{value:e.message,expandLabel:"Show full message"})})]}),e.issue_code?(0,y.jsxs)("span",{className:T("code"),children:["Code: ",e.issue_code]}):null]}),c&&n&&(0,y.jsx)("div",{className:T("issues"),children:(0,y.jsx)(R,{issues:u,level:a+1,expanded:n})})]})}function R(e){const{issues:t,level:a,expanded:r}=e;return(0,y.jsx)("div",{className:T("list"),children:t.map(((e,t)=>(0,y.jsx)(I,{issue:e,level:a,expanded:r},t)))})}const _={S_INFO:n.A,S_WARNING:s.A,S_ERROR:l.A,S_FATAL:o.A},P=(0,p.cn)("yql-issue-severity");function A({severity:e}){const t=e.slice(2).toLowerCase();return(0,y.jsxs)("span",{className:P({severity:t}),children:[(0,y.jsx)(u.I,{className:P("icon"),data:_[e]}),(0,y.jsx)("span",{className:P("title"),children:t})]})}},15298:(e,t,a)=>{a.d(t,{s:()=>s});var r=a(21334),n=a(11906);const s=r.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const a=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,n.N)(a)}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"})},21545:(e,t,a)=>{a.d(t,{X:()=>n});var r=a(78034);const n=a(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t},{signal:a})=>{try{const[n,s,l]=await Promise.all([window.api.viewer.getTablet({id:e,database:t},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({signal:a})]),o=(0,r.pl)(l),i=Object.keys(s).reduce(((e,t)=>{var a;const r=null===(a=s[t])||void 0===a?void 0:a.TabletStateInfo;if(r&&r.length){const a=r.find((e=>e.Leader))||r[0],{ChangeTime:n,Generation:s,State:l,Leader:i,FollowerId:d}=a,u=o&&t?o.get(Number(t)):void 0;"Dead"!==l&&e.push({nodeId:t,generation:s,changeTime:n,state:l,leader:i,followerId:d,fqdn:u})}return e}),[]),{TabletStateInfo:d=[]}=n,[u={}]=d,{TabletId:c}=u;return{data:{id:c,data:u,history:i}}}catch(n){return{error:n}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const a=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:r,PathId:n}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${r}:${n}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(r){return{error:r}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})}}]);