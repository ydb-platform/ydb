"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[15521],{9252:(e,t,r)=>{r.d(t,{k:()=>s});var n=r(74281),a=r(88610),o=r(60712);const s=({value:e,onChange:t,className:r})=>(0,o.jsxs)(n.x,{value:e,onUpdate:t,className:r,children:[(0,o.jsx)(n.x.Option,{value:a.s$.ALL,children:a.s$.ALL}),(0,o.jsx)(n.x.Option,{value:a.s$.PROBLEMS,children:a.s$.PROBLEMS})]})},11363:(e,t,r)=>{r.d(t,{G:()=>oe});var n=r(59284),a=r(86782),o=r(12888),s=r(98167),l=r(67028),i=r(53627),d=r(88610);function c(){const e=(0,i.YQ)();return{problemFilter:(0,i.N4)(d.yV),handleProblemFilterChange:t=>{e((0,d.$u)(t))}}}var u=r(78034),h=r(80987),p=r(48372);const m=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),g=(0,p.g4)("ydb-nodes",{en:m}),v=["database","static","other","any"],b={get database(){return g("database")},get static(){return g("static")},get other(){return g("other")},get any(){return g("any")}};const y="nodesTableSelectedColumns",x=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],f=["NodeId"],w=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function N(e,t){return t?e:e.filter((e=>"SystemState"!==e))}function C(e){var t;const[r,n]=(0,h.useQueryParams)({uptimeFilter:h.StringParam,peerRole:h.StringParam,search:h.StringParam,nodesGroupBy:h.StringParam}),a=u.Bm.parse(r.uptimeFilter),o=null!==(t=r.search)&&void 0!==t?t:"",s=(i=r.peerRole,v.find((e=>e===i)));var i;const d=(0,l.DM)(),c=function(e,t,r){return N(t,r).find((t=>t===e))}(r.nodesGroupBy,null!==e&&void 0!==e?e:[],d);return{uptimeFilter:a,searchValue:o,peerRoleFilter:s,groupByParam:c,handleSearchQueryChange:e=>{n({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{n({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{n({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{n({nodesGroupBy:e},"replaceIn")}}}var j=r(44508),S=r(42265),T=r(15298),F=r(43951),k=r(71708),I=r(62710),_=r(88908),P=r(53807),R=r(12207),A=r(28539),B=r(9252),G=r(95963),D=r(64934),E=r(74281),L=r(60712);function O({value:e="database",onChange:t}){return(0,L.jsx)(E.x,{value:e,onUpdate:t,children:v.map((e=>(0,L.jsx)(E.x.Option,{value:e,children:b[e]},e)))})}const W=(0,r(77506).cn)("ydb-nodes"),$=e=>W("node",{unavailable:(0,u.X7)(e)});function U({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:r,columnsToSelect:o,handleSelectedColumnsUpdate:s,entitiesCountCurrent:i,entitiesCountTotal:d,entitiesLoading:u}){const{searchValue:h,uptimeFilter:p,peerRoleFilter:m,groupByParam:v,handleSearchQueryChange:b,handleUptimeFilterChange:y,handlePeerRoleFilterChange:x,handleGroupByParamChange:f}=C(t),{problemFilter:w,handleProblemFilterChange:j}=c(),S=(0,l.DM)(),T=function(e,t){return N(e,t).map((e=>({value:e,content:(0,a.kn)(e)})))}(t,S),F=(0,l.WF)(),k=r&&F;return(0,L.jsxs)(n.Fragment,{children:[(0,L.jsx)(G.v,{onChange:b,placeholder:g("controls_search-placeholder"),width:238,value:h}),S&&e?null:(0,L.jsx)(B.k,{value:w,onChange:j}),e?null:(0,L.jsx)(D.j,{value:p,onChange:y}),k?(0,L.jsxs)(n.Fragment,{children:[(0,L.jsx)(_.E,{variant:"body-2",children:g("controls_peer-role-label")}),(0,L.jsx)(O,{value:m,onChange:x})]}):null,(0,L.jsx)(P.O,{popupWidth:200,items:o,showStatus:!0,onUpdate:s,sortable:!1}),e?(0,L.jsxs)(n.Fragment,{children:[(0,L.jsx)(_.E,{variant:"body-2",children:g("controls_group-by-placeholder")}),(0,L.jsx)(R.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:v?[v]:void 0,onUpdate:e=>{f(e[0])},options:T,className:W("group-by-select"),popupClassName:W("group-by-popup")})]}):null,(0,L.jsx)(A.T,{current:i,total:d,label:g("nodes"),loading:u})]})}var V=r(78524),q=r(62783),z=r(81101),H=r(11906),M=r(69464),K=r(40781);const Q=async e=>{const{type:t="any",storage:r=!1,limit:n,offset:o,sortParams:s,filters:l,columnsIds:i}=e,{sortOrder:d,columnId:c}=null!==s&&void 0!==s?s:{},{path:h,database:p,searchValue:m,problemFilter:g,uptimeFilter:v,peerRoleFilter:b,filterGroup:y,filterGroupBy:x}=null!==l&&void 0!==l?l:{},f=(0,a.kU)(c),w=f?(0,M.T)(f,d):void 0,N=(0,K.R)(i,a.fN),C=await window.api.viewer.getNodes({type:t,storage:r,limit:n,offset:o,sort:w,path:h,database:p,filter:m,problems_only:(0,u.AB)(g),uptime:(0,u.Fo)(v),filter_peer_role:b,filter_group:y,filter_group_by:x,fieldsRequired:N}),j=(0,H.N)(C);return{data:j.Nodes||[],found:j.FoundNodes||0,total:j.TotalNodes||0}};function Y({path:e,database:t,searchValue:r,problemFilter:o,uptimeFilter:s,peerRoleFilter:l,filterGroup:i,filterGroupBy:d,columns:c,scrollContainerRef:h,initialEntitiesCount:p}){const m=n.useMemo((()=>({path:e,database:t,searchValue:r,problemFilter:o,uptimeFilter:s,peerRoleFilter:l,filterGroup:i,filterGroupBy:d})),[e,t,r,o,s,l,i,d]);return(0,L.jsx)(q.k5,{columnsWidthLSKey:a.zO,scrollContainerRef:h,columns:c,fetchData:Q,initialEntitiesCount:p,renderErrorMessage:z.$,renderEmptyDataMessage:()=>"All"!==o||s!==u.cW.All?(0,L.jsx)(V.v,{name:"thumbsUp",width:"200"}):g("empty.default"),getRowClassName:$,filters:m,tableName:"nodes"})}const J=n.memo((function({name:e,count:t,isExpanded:r,path:n,database:a,searchValue:o,peerRoleFilter:s,groupByParam:l,columns:i,scrollContainerRef:d,onIsExpandedChange:c}){return(0,L.jsx)(k.Q,{title:e,count:t,entityName:g("nodes"),expanded:r,onIsExpandedChange:c,children:(0,L.jsx)(S.o,{initialState:{sortParams:void 0},table:(0,L.jsx)(Y,{path:n,database:a,searchValue:o,problemFilter:"All",uptimeFilter:u.cW.All,peerRoleFilter:s,filterGroup:e,filterGroupBy:l,initialEntitiesCount:t,columns:i,scrollContainerRef:d}),tableWrapperProps:{scrollContainerRef:d}})},e)}));function X({path:e,database:t,scrollContainerRef:r,withPeerRoleFilter:o,columns:s,defaultColumnsIds:l,requiredColumnsIds:d,selectedColumnsKey:c,groupByParams:u}){const{searchValue:h,peerRoleFilter:p,groupByParam:m}=C(u),[v]=(0,i.Nt)(),{columnsToShow:b,columnsToSelect:y,setColumns:x}=(0,F.K)(s,c,a.uG,l,d),{currentData:f,isFetching:w,error:N}=T.s.useGetNodesQuery({path:e,database:t,filter:h,filter_peer_role:p,group:m,limit:0},{pollingInterval:v}),k=void 0===f&&w,{NodeGroups:_,FoundNodes:P=0,TotalNodes:R=0}=f||{},{expandedGroups:A,setIsGroupExpanded:B}=(0,I.$)(_),G=n.useMemo((()=>({foundEntities:P,totalEntities:R,isInitialLoad:k,sortParams:void 0})),[P,R,k]);return(0,L.jsx)(S.o,{initialState:G,controls:(0,L.jsx)(U,{groupByParams:u,withPeerRoleFilter:o,columnsToSelect:y,handleSelectedColumnsUpdate:x,entitiesCountCurrent:P,entitiesCountTotal:R,entitiesLoading:k,withGroupBySelect:!0}),error:N?(0,L.jsx)(j.o,{error:N}):null,table:null!==_&&void 0!==_&&_.length?_.map((({name:n,count:a})=>{const o=A[n];return(0,L.jsx)(J,{name:n,count:a,isExpanded:o,path:e,database:t,searchValue:h,peerRoleFilter:p,groupByParam:m,columns:b,scrollContainerRef:r,onIsExpandedChange:B},n)})):g("no-nodes-groups"),tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[h,m,_,p],loading:k,className:W("groups-wrapper")}})}var Z=r(49554);function ee({withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:r,columnsToSelect:n,handleSelectedColumnsUpdate:a}){const{tableState:o}=(0,Z.WV)();return(0,L.jsx)(U,{withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:r,columnsToSelect:n,handleSelectedColumnsUpdate:a,entitiesCountCurrent:o.foundEntities,entitiesCountTotal:o.totalEntities,entitiesLoading:o.isInitialLoad})}function te({path:e,database:t,scrollContainerRef:r,withPeerRoleFilter:n,columns:o,defaultColumnsIds:s,requiredColumnsIds:i,selectedColumnsKey:d,groupByParams:u}){const{searchValue:h,uptimeFilter:p,peerRoleFilter:m}=C(u),{problemFilter:g}=c(),v=(0,l.Ye)(),{columnsToShow:b,columnsToSelect:y,setColumns:x}=(0,F.K)(o,d,a.uG,s,i);return(0,L.jsx)(S.o,{controls:(0,L.jsx)(ee,{withGroupBySelect:v,groupByParams:u,withPeerRoleFilter:n,columnsToSelect:y,handleSelectedColumnsUpdate:x}),table:(0,L.jsx)(Y,{path:e,database:t,searchValue:h,problemFilter:g,uptimeFilter:p,peerRoleFilter:m,columns:b,scrollContainerRef:r}),tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[h,g,p,m]}})}function re(e){const{uptimeFilter:t,groupByParam:r,handleUptimeFilterChange:a}=C(e.groupByParams),{problemFilter:o,handleProblemFilterChange:i}=c(),d=(0,l.Pm)(),h=(0,l.Ye)();n.useEffect((()=>{!h||"All"===o&&t===u.cW.All||(i("All"),a(u.cW.All))}),[i,a,o,t,h]);return(0,L.jsx)(s.r,{loading:!d,children:h&&r?(0,L.jsx)(X,{...e}):(0,L.jsx)(te,{...e})})}var ne=r(95109);function ae(e){return[(0,ne._E)(),(0,ne.Nh)(e),(0,ne.eT)(),(0,ne.uk)(),(0,ne.OX)(),(0,ne.jl)(),(0,ne.fr)(),(0,ne.kv)(),(0,ne.pH)(),(0,ne.iX)(),(0,ne.ID)(),(0,ne.Rn)(),(0,ne.qp)(e)].map((e=>({...e,sortable:(0,a.sp)(e.name)})))}function oe({path:e,database:t,scrollContainerRef:r,additionalNodesProps:s,withPeerRoleFilter:l,columns:i=ae({database:t,getNodeRef:null===s||void 0===s?void 0:s.getNodeRef}),defaultColumnsIds:d=x,requiredColumnsIds:c=f,selectedColumnsKey:u=y,groupByParams:h=w}){const p=(0,o.X)(),m=n.useMemo((()=>p?i:i.filter((e=>!(0,a.xd)(e.name)))),[i,p]);return(0,L.jsx)(re,{path:e,database:t,scrollContainerRef:r,withPeerRoleFilter:l,columns:m,defaultColumnsIds:d,requiredColumnsIds:c,selectedColumnsKey:u,groupByParams:h})}},11906:(e,t,r)=>{r.d(t,{N:()=>a});var n=r(78034);const a=e=>{var t;const r=(e.Nodes||[]).map((e=>{const{SystemState:t,...r}=e;return{...r,...(0,n.q1)(t)}}));return{Nodes:r,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||r.length,FoundNodes:Number(e.FoundNodes)}}},15298:(e,t,r)=>{r.d(t,{s:()=>o});var n=r(21334),a=r(11906);const o=n.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const r=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,a.N)(r)}}catch(r){return{error:r}}},providesTags:["All"]})}),overrideExisting:"throw"})},18836:(e,t,r)=>{r.d(t,{s:()=>s,v:()=>o});var n=r(56839),a=r(35736);function o({colorizeProgress:e=!0,warningThreshold:t,dangerThreshold:r,inverseColorize:o=!1,fillWidth:s}){const l=Math.max(s,.5);return{status:(0,a.w)({fillWidth:s,warningThreshold:t,dangerThreshold:r,colorizeProgress:e,inverseColorize:o}),percents:(0,n.l9)(s/100),fill:l}}function s({value:e,capacity:t,legendFormatter:r,...n}){const a=parseFloat(String(e)),s=parseFloat(String(t));let l=a/s*100||0;l=l>100?100:l;const i=r({value:a,capacity:s});return{...o({fillWidth:l,...n}),legend:i}}},21049:(e,t,r)=>{r.d(t,{e:()=>m});var n=r(59284),a=r(32752),o=r(88908),s=r(20263),l=r(77506),i=r(60712);function d({cx:e,cy:t,r:r,stroke:n,strokeWidth:a,strokeDasharray:o,strokeDashoffset:s,strokeLinecap:l="butt",fill:d="none",className:c}){return(0,i.jsx)("circle",{cx:e,cy:t,r:r,fill:d,stroke:n,strokeWidth:a,strokeDasharray:o,strokeDashoffset:s,strokeLinecap:l,className:c})}const c={small:{width:65,strokeWidth:12,textVariant:"subheader-1"},medium:{width:100,strokeWidth:16,textVariant:"subheader-2"},large:{width:130,strokeWidth:20,textVariant:"subheader-3"}},u=.75;const h=(0,l.cn)("ydb-doughnut-metrics"),p=n.createContext("medium");function m({status:e,fillWidth:t,children:r,className:n,size:a="medium"}){const o=c[a],s=(o.width-o.strokeWidth)/2,l=function(e){return 2*Math.PI*e}(s),m=l*u,g=o.width/2,v=o.width/2,b=function(e,t){if(e<=0)return"0 0";const r=Math.min(e,100)/100*t;return`${r} ${t-r}`}(t,l),y=function(e,t){if(e<=100)return"0 0";const r=(e-100)/100*t;return`${r} ${t-r}`}(t,l),x=t>100;return(0,i.jsx)(p.Provider,{value:a,children:(0,i.jsxs)("div",{className:h({status:e},n),children:[(0,i.jsxs)("svg",{width:o.width,height:o.width,className:h("doughnut"),children:[(0,i.jsx)(d,{cx:g,cy:v,r:s,stroke:"var(--doughnut-backdrop-color)",strokeWidth:o.strokeWidth}),(0,i.jsx)(d,{cx:g,cy:v,r:s,stroke:"var(--doughnut-color)",strokeWidth:o.strokeWidth,strokeDasharray:b,strokeDashoffset:m,className:h("progress-circle")}),x&&(0,i.jsx)(d,{cx:g,cy:v,r:s,stroke:"var(--doughnut-overlap-color)",strokeWidth:o.strokeWidth,strokeDasharray:y,strokeDashoffset:m,className:h("overlap-circle")})]}),(0,i.jsx)("div",{className:h("text-wrapper"),children:r})]})})}m.Legend=function({children:e,variant:t="subheader-3",color:r="primary",note:n,noteIconSize:l="m"}){return(0,i.jsxs)(a.s,{gap:1,alignItems:"center",children:[(0,i.jsx)(o.E,{variant:t,color:r,className:h("legend"),as:"div",children:e}),n&&(0,i.jsx)(s.H,{iconSize:l,className:h("legend-note"),popoverProps:{placement:"right"},children:n})]})},m.Value=function({children:e,variant:t}){const r=n.useContext(p),a=t||c[r].textVariant;return(0,i.jsx)(o.E,{variant:a,className:h("value"),children:e})}},21545:(e,t,r)=>{r.d(t,{X:()=>a});var n=r(78034);const a=r(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:r},{signal:a})=>{try{const[o,s,l]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:r},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({signal:a})]),i=(0,n.nN)(l),d=Object.keys(s).reduce(((e,t)=>{var r;const n=null===(r=s[t])||void 0===r?void 0:r.TabletStateInfo;return null===n||void 0===n||n.forEach((r=>{var n;const{ChangeTime:a,Generation:o,State:s,Leader:l,FollowerId:d}=r,c=i&&t?null===(n=i.get(Number(t)))||void 0===n?void 0:n.Host:void 0;e.push({nodeId:t,generation:o,changeTime:a,state:s,leader:l,followerId:d,fqdn:c})})),e}),[]),{TabletStateInfo:c=[]}=o,u=void 0===r?c.find((e=>e.Leader)):c.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===r})),{TabletId:h}=u||{};return{data:{id:h,data:u,history:d}}}catch(o){return{error:o}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const r=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:n,PathId:a}=e;return{data:(null===r||void 0===r?void 0:r.Path)||`${n}:${a}`}}catch(r){return{error:r}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:r})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:r})}}catch(n){return{error:n}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,r)=>{r.d(t,{B:()=>d});var n=r(59284),a=r(80136),o=r(58611),s=r(55974),l=r(42829),i=r(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:r,dialogHeader:d,dialogText:c,retryButtonText:u,buttonDisabled:h=!1,buttonView:p="action",buttonTitle:m,buttonClassName:g,withPopover:v=!1,popoverContent:b,popoverPlacement:y="right",popoverDisabled:x=!0}){const[f,w]=n.useState(!1),[N,C]=n.useState(!1),[j,S]=n.useState(!1),T=()=>(0,i.jsx)(a.$,{onClick:()=>w(!0),view:p,disabled:h,loading:!h&&N,className:g,title:m,children:e});return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(s.g,{visible:f,header:d,text:c,withRetry:j,retryButtonText:u,onConfirm:async e=>{C(!0),await t(e)},onConfirmActionSuccess:async()=>{S(!1);try{await(null===r||void 0===r?void 0:r())}finally{C(!1)}},onConfirmActionError:e=>{S((0,l.D)(e)),C(!1)},onClose:()=>{w(!1)}}),v?(0,i.jsx)(o.A,{content:b,placement:y,disabled:x,children:T()}):T()]})}},27775:(e,t,r)=>{r.d(t,{i:()=>s});var n=r(52443),a=r(58267),o=r(60712);function s({state:e}){return(0,o.jsx)(n.J,{theme:(0,a._)(e),children:e})}},28539:(e,t,r)=>{r.d(t,{T:()=>n.T});var n=r(53755)},37477:(e,t,r)=>{r.d(t,{c:()=>C});r(59284);var n=r(8979),a=r(52443),o=r(32752),s=r(20263),l=r(54090),i=r(77506),d=r(43937),c=r(36388),u=r(94420),h=r(70825),p=r(49917),m=r(47653),g=r(60712);const v={[l.m.Blue]:d.A,[l.m.Yellow]:c.A,[l.m.Orange]:u.A,[l.m.Red]:c.A,[l.m.Green]:h.A,[l.m.Grey]:p.A};function b({status:e,...t}){return e?(0,g.jsx)(m.I,{...t,data:v[e]}):null}var y=r(89732),x=r(97677);const f=(0,i.cn)("ydb-entity-status-new"),w={[l.m.Red]:"danger",[l.m.Blue]:"info",[l.m.Green]:"success",[l.m.Grey]:"unknown",[l.m.Orange]:"orange",[l.m.Yellow]:"warning"},N={get[l.m.Red](){return(0,y.A)("title_red")},get[l.m.Yellow](){return(0,y.A)("title_yellow")},get[l.m.Orange](){return(0,y.A)("title_orange")},get[l.m.Green](){return(0,y.A)("title_green")},get[l.m.Grey](){return(0,y.A)("title_grey")},get[l.m.Blue](){return(0,y.A)("title_blue")}};function C({className:e,children:t}){return(0,g.jsx)(o.s,{gap:"2",wrap:"nowrap",alignItems:"center",className:f(null,e),children:t})}C.Label=function({children:e,status:t,withStatusName:r=!0,note:l,size:i="m",iconSize:d=14}){const c=w[t];return(0,g.jsx)(n.m,{title:x.D[t],disabled:Boolean(l),children:(0,g.jsx)(a.J,{theme:"orange"===c?void 0:c,icon:(0,g.jsx)(b,{size:d,status:t}),size:i,className:f({orange:"orange"===c}),children:(0,g.jsxs)(o.s,{gap:"2",wrap:"nowrap",children:[e,r?N[t]:null,l&&(0,g.jsx)(s.H,{className:f("note"),children:l})]})})})},C.displayName="EntityStatus"},42829:(e,t,r)=>{r.d(t,{D:()=>n});const n=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55340:(e,t,r)=>{r.d(t,{x:()=>u});var n=r(11363),a=r(95109),o=r(86782);const s="networkNodesTableSelectedColumns",l=["NodeId","NetworkHost","Connections","NetworkUtilization","SendThroughput","ReceiveThroughput","PingTime","ClockSkew"],i=["NodeId","NetworkHost"],d=["Host","DC","Rack","Uptime","ConnectStatus","NetworkUtilization","PingTime","ClockSkew"];var c=r(60712);function u({database:e,path:t,scrollContainerRef:r,additionalNodesProps:u}){return(0,c.jsx)(n.G,{path:t,database:e,scrollContainerRef:r,withPeerRoleFilter:Boolean(e),additionalNodesProps:u,columns:(h={database:e,getNodeRef:null===u||void 0===u?void 0:u.getNodeRef},[(0,a._E)(),(0,a.b8)(h),(0,a.uk)(),(0,a.OX)(),(0,a.jl)(),(0,a.fr)(),(0,a.kv)(),(0,a.SH)(),(0,a.H)(),(0,a.DH)(),(0,a.ui)(),(0,a.wN)(),(0,a.pt)()].map((e=>({...e,sortable:(0,o.sp)(e.name)})))),defaultColumnsIds:l,requiredColumnsIds:i,selectedColumnsKey:s,groupByParams:d});var h}},55974:(e,t,r)=>{r.d(t,{g:()=>y});var n=r(59284),a=r(18677),o=r(71153),s=r(48139),l=r(82521),i=r(47653),d=r(56999),c=r(77506),u=r(81288),h=r(48372);const p=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),m=(0,h.g4)("ydb-critical-action-dialog",{en:p});var g=r(60712);const v=(0,c.cn)("ydb-critical-dialog"),b=e=>{if((0,u.cH)(e)){if(403===e.status)return m("no-rights-error");if("string"===typeof e.data)return e.data;if((0,u._E)(e)&&e.data)return(0,g.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return m("default-error")};function y({visible:e,header:t,text:r,withRetry:d,retryButtonText:c,withCheckBox:u,onClose:h,onConfirm:p,onConfirmActionSuccess:y,onConfirmActionError:x}){const[f,w]=n.useState(!1),[N,C]=n.useState(),[j,S]=n.useState(!1),T=async e=>(w(!0),p(e).then((()=>{y(),h()})).catch((e=>{x(e),C(e)})).finally((()=>{w(!1)})));return(0,g.jsx)(l.l,{open:e,hasCloseButton:!1,className:v(),size:"s",onClose:h,onTransitionOutComplete:()=>{C(void 0),S(!1)},children:N?(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(l.l.Header,{caption:t}),(0,g.jsx)(l.l.Body,{className:v("body"),children:(0,g.jsxs)("div",{className:v("body-message",{error:!0}),children:[(0,g.jsx)("span",{className:v("error-icon"),children:(0,g.jsx)(a.A,{width:"24",height:"22"})}),b(N)]})}),(0,g.jsx)(l.l.Footer,{loading:!1,preset:"default",textButtonApply:d?c||m("button-retry"):void 0,textButtonCancel:m("button-close"),onClickButtonApply:()=>T(!0),onClickButtonCancel:h})]}):(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(l.l.Header,{caption:t}),(0,g.jsxs)(l.l.Body,{className:v("body"),children:[(0,g.jsxs)("div",{className:v("body-message",{warning:!0}),children:[(0,g.jsx)("span",{className:v("warning-icon"),children:(0,g.jsx)(i.I,{data:o.A,size:24})}),r]}),u?(0,g.jsx)(s.S,{checked:j,onUpdate:S,children:m("checkbox-text")}):null]}),(0,g.jsx)(l.l.Footer,{loading:f,preset:"default",textButtonApply:m("button-confirm"),textButtonCancel:m("button-cancel"),propsButtonApply:{type:"submit",disabled:u&&!j},onClickButtonCancel:h,onClickButtonApply:()=>T()})]})})}},56999:(e,t,r)=>{r.d(t,{O:()=>w});var n=r(59284),a=r(45720),o=r(16929),s=r(71153),l=r(18677),i=r(80136),d=r(60461),c=r(78540),u=r(47653),h=r(74529),p=r(77506),m=r(41650);const g=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function v(e){return function(e){return!!e&&void 0!==g[e]}(e)?g[e]:"S_INFO"}var b=r(60712);const y=(0,p.cn)("kv-result-issues"),x=(0,p.cn)("kv-issues"),f=(0,p.cn)("kv-issue");function w({data:e,hideSeverity:t}){const[r,a]=n.useState(!1),o="string"===typeof e||null===e||void 0===e?void 0:e.issues,s=Array.isArray(o)&&o.length>0;return(0,b.jsxs)("div",{className:y(),children:[(0,b.jsxs)("div",{className:y("error-message"),children:[(()=>{let r;if("string"===typeof e)r=e;else{var a,o;const s=v(null===e||void 0===e||null===(a=e.error)||void 0===a?void 0:a.severity);r=(0,b.jsxs)(n.Fragment,{children:[t?null:(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)(k,{severity:s})," "]}),(0,b.jsx)("span",{className:y("error-message-text"),children:null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message})]})}return r})(),s&&(0,b.jsx)(i.$,{view:"normal",onClick:()=>a(!r),children:r?"Hide details":"Show details"})]}),s&&r&&(0,b.jsx)(N,{hideSeverity:t,issues:o})]})}function N({issues:e,hideSeverity:t}){const r=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var r;const n=null!==(r=t.severity)&&void 0!==r?r:10;return Math.min(e,n)}),10);return(0,b.jsx)("div",{className:x(null),children:null===e||void 0===e?void 0:e.map(((e,n)=>(0,b.jsx)(C,{hideSeverity:t,issue:e,expanded:e===r},n)))})}function C({issue:e,hideSeverity:t,level:r=0}){const[a,o]=n.useState(!0),s=v(e.severity),l=e.issues,c=Array.isArray(l)&&l.length>0,u=a?"bottom":"right";return(0,b.jsxs)("div",{className:f({leaf:!c,"has-issues":c}),children:[(0,b.jsxs)("div",{className:f("line"),children:[c&&(0,b.jsx)(i.$,{view:"flat-secondary",onClick:()=>o(!a),className:f("arrow-toggle"),children:(0,b.jsx)(d.I,{direction:u,size:16})}),t?null:(0,b.jsx)(k,{severity:s}),(0,b.jsx)(j,{issue:e}),e.issue_code?(0,b.jsxs)("span",{className:f("code"),children:["Code: ",e.issue_code]}):null]}),c&&a&&(0,b.jsx)("div",{className:f("issues"),children:(0,b.jsx)(S,{issues:l,level:r+1,expanded:a})})]})}function j({issue:e}){var t;const r=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,m.kf)(t.row))return"";const{row:r,column:n}=t;return(0,m.kf)(n)?`${r}:${n}`:`line ${r}`}(e),n=window.ydbEditor,a=()=>(0,b.jsxs)("span",{className:f("message"),children:[r&&(0,b.jsx)("span",{className:f("place-text"),title:"Position",children:r}),(0,b.jsx)("div",{className:f("message-text"),children:(0,b.jsx)(h.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:o,column:s}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,m.kf)(o)&&n))return a();return(0,b.jsx)(c.N,{href:"#",onClick:()=>{const e={lineNumber:o,column:null!==s&&void 0!==s?s:0};n.setPosition(e),n.revealPositionInCenterIfOutsideViewport(e),n.focus()},view:"primary",draggable:!1,children:a()})}function S(e){const{issues:t,level:r,expanded:n}=e;return(0,b.jsx)("div",{className:f("list"),children:t.map(((e,t)=>(0,b.jsx)(C,{issue:e,level:r,expanded:n},t)))})}const T={S_INFO:a.A,S_WARNING:o.A,S_ERROR:s.A,S_FATAL:l.A},F=(0,p.cn)("yql-issue-severity");function k({severity:e}){const t=e.slice(2).toLowerCase();return(0,b.jsxs)("span",{className:F({severity:t}),children:[(0,b.jsx)(u.I,{className:F("icon"),data:T[e]}),(0,b.jsx)("span",{className:F("title"),children:t})]})}},57428:(e,t,r)=>{r.d(t,{vs:()=>d,sp:()=>c,cO:()=>i});var n=r(46549),a=r(56839),o=r(48372);const s=JSON.parse('{"context_of":"of","context_cores":"cores"}'),l=(0,o.g4)("ydb-metrics",{en:s});function i({value:e,capacity:t}){const r=(0,a.j9)(e,t,void 0,"\n");return`${r[0]} ${l("context_of")} ${r[1]}`}function d({value:e,capacity:t}){let r=[];return r=t<1e4?[(0,a.ZV)(Math.round(e)),(0,a.ZV)(Math.round(t))]:(0,a.Nd)(e,t,void 0,"",!0),`${r[0]} ${l("context_of")} ${r[1]} ${l("context_cores")}`}function c({value:e,capacity:t}){const r=(0,n.fn)(t),a=(0,n.z3)({value:e,size:r,precision:2,withSpeedLabel:!1,withSizeLabel:!1}),o=(0,n.z3)({value:t,size:r,precision:2,withSpeedLabel:!0});return`${a} ${l("context_of")} ${o}`}},74529:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(59284),a=r(78540),o=r(77506),s=r(48372);const l=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),i=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,s.g4)("ydb-shorty-string",{ru:i,en:l});var c=r(60712);const u=(0,o.cn)("kv-shorty-string");function h({value:e="",limit:t=200,strict:r=!1,displayLength:o=!0,render:s=e=>e,onToggle:l,expandLabel:i=d("default_expand_label"),collapseLabel:h=d("default_collapse_label")}){const[p,m]=n.useState(!1),g=(p?h:i)+(o&&!p?d("chars_count",{count:e.length}):""),v=e.length>t+(r?0:g.length),b=p||!v?e:e.slice(0,t-4)+"\xa0...";return(0,c.jsxs)("div",{className:u(),children:[s(b),v?(0,c.jsx)(a.N,{className:u("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),m((e=>!e)),null===l||void 0===l||l()},children:g}):null]})}},78321:(e,t,r)=>{r.d(t,{b:()=>s,s:()=>l});var n=r(67028),a=r(76086),o=r(53627);function s(){const e=(0,n.WF)(),[t]=(0,o.iK)(a.g5);return Boolean(e&&t)}function l(){const e=(0,n.DY)(),[t]=(0,o.iK)(a.g5);return Boolean(e&&t)}},88616:(e,t,r)=>{r.d(t,{Q:()=>I});var n=r(59284),a=r(76938),o=r(88908),s=r(47653),l=r(80987),i=r(22983),d=r(28539),c=r(10508),u=r(44508),h=r(44294),p=r(17594),m=r(41775),g=r(69326),v=r(80420),b=r(27775),y=r(41826),x=r(21545),f=r(6354),w=r(76086),N=r(12888),C=r(29819),j=r(48372);const S=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),T=(0,j.g4)("ydb-tablets",{en:S});var F=r(60712);function k(e){const t=e.State===f.r.Stopped,r=(0,N.X)(),[n]=x.X.useKillTabletMutation(),o=e.TabletId;return o?(0,F.jsx)(i.B,{buttonView:"outlined",buttonTitle:T("dialog.kill-header"),dialogHeader:T("dialog.kill-header"),dialogText:T("dialog.kill-text"),onConfirmAction:()=>n({id:o}).unwrap(),buttonDisabled:t||!r,withPopover:!0,popoverContent:T(r?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","bottom"],popoverDisabled:!1,children:(0,F.jsx)(s.I,{data:a.A})}):null}function I({database:e,tablets:t,loading:r,error:a,scrollContainerRef:s,nodeId:i}){const[{tabletsSearch:x},f]=(0,l.useQueryParams)({tabletsSearch:l.StringParam}),[N,j]=n.useState(),S=n.useMemo((()=>function({database:e,nodeId:t}){const r=[{name:"Type",width:150,get header(){return T("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,F.jsxs)("span",{children:[e.Type," ",t?(0,F.jsx)(o.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return T("Tablet")},render:({row:t})=>t.TabletId?(0,F.jsx)(v.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):w.Pd},{name:"State",get header(){return T("State")},render:({row:e})=>(0,F.jsx)(b.i,{state:e.State})}];return void 0===t&&r.push({name:"NodeId",get header(){return T("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,C.vI)(e.NodeId);return(0,F.jsx)(h.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return T("Node FQDN")},render:({row:e})=>e.fqdn?(0,F.jsx)(c.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,F.jsx)("span",{children:"\u2014"})}),r.push({name:"Generation",get header(){return T("Generation")},align:"right"},{name:"Uptime",get header(){return T("Uptime")},render:({row:e})=>(0,F.jsx)(y.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,F.jsx)(k,{...e})}),r}({database:e,nodeId:i})),[e,i]),I=n.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==x&&void 0!==x?x:"")))),[t,x]);return(0,F.jsxs)(g.L,{fullHeight:!0,children:[(0,F.jsxs)(g.L.Controls,{children:[(0,F.jsx)(m.v,{placeholder:T("controls.search-placeholder"),onChange:e=>{f({tabletsSearch:e||void 0},"replaceIn")},value:null!==x&&void 0!==x?x:"",width:238}),(0,F.jsx)(d.T,{label:T("controls.entities-count-label"),loading:r,total:t.length,current:I.length})]}),a?(0,F.jsx)(u.o,{error:a}):null,(0,F.jsx)(g.L.Table,{scrollContainerRef:s,scrollDependencies:[x,N],loading:r,children:(0,F.jsx)(p.l,{columns:S,data:I,settings:w.N3,emptyDataMessage:T("noTabletsData"),onSortChange:j})})]})}},89732:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(48372);const a=JSON.parse('{"title_red":"Critical","title_blue":"Normal","title_green":"Good","title_grey":"Unknown","title_orange":"Caution","title_yellow":"Warning","context_red":"Some systems are failed and not available","context_yellow":"There are minor issues","context_orange":"Critical state, requires immediate attention","context_green":"Everything is working as expected","context_grey":"The condition cannot be determined","context_blue":"All good, some parts of the system are restoring"}'),o=(0,n.g4)("ydb-entity-status",{en:a})},95963:(e,t,r)=>{r.d(t,{v:()=>n.v});var n=r(41775)},97677:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(54090),a=r(89732);const o={get[n.m.Red](){return(0,a.A)("context_red")},get[n.m.Yellow](){return(0,a.A)("context_yellow")},get[n.m.Orange](){return(0,a.A)("context_orange")},get[n.m.Green](){return(0,a.A)("context_green")},get[n.m.Grey](){return(0,a.A)("context_grey")},get[n.m.Blue](){return(0,a.A)("context_blue")}}}}]);