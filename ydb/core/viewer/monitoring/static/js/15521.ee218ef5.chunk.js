"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[15521],{9252:(e,t,r)=>{r.d(t,{k:()=>s});var n=r(74281),a=r(88610),o=r(60712);const s=({value:e,onChange:t,className:r})=>(0,o.jsxs)(n.x,{value:e,onUpdate:t,className:r,children:[(0,o.jsx)(n.x.Option,{value:a.s$.ALL,children:a.s$.ALL}),(0,o.jsx)(n.x.Option,{value:a.s$.PROBLEMS,children:a.s$.PROBLEMS})]})},11363:(e,t,r)=>{r.d(t,{G:()=>oe});var n=r(59284),a=r(86782),o=r(67028),s=r(12888),l=r(98167),i=r(53627),d=r(88610);function c(){const e=(0,i.YQ)();return{problemFilter:(0,i.N4)(d.yV),handleProblemFilterChange:t=>{e((0,d.$u)(t))}}}var u=r(78034),h=r(80987),p=r(48372);const m=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),g=(0,p.g4)("ydb-nodes",{en:m}),b=["database","static","other","any"],v={get database(){return g("database")},get static(){return g("static")},get other(){return g("other")},get any(){return g("any")}};const y="nodesTableSelectedColumns",f=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],x=["NodeId"],w=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function N(e,t){return t?e:e.filter((e=>"SystemState"!==e))}function C(e){var t;const[r,n]=(0,h.useQueryParams)({uptimeFilter:h.StringParam,peerRole:h.StringParam,search:h.StringParam,nodesGroupBy:h.StringParam}),a=(0,s.b)(),l=u.Bm.parse(r.uptimeFilter),i=null!==(t=r.search)&&void 0!==t?t:"",d=a?(c=r.peerRole,b.find((e=>e===c))):"database";var c;const p=(0,o.DM)(),m=function(e,t,r){return N(t,r).find((t=>t===e))}(r.nodesGroupBy,null!==e&&void 0!==e?e:[],p);return{uptimeFilter:l,searchValue:i,peerRoleFilter:d,groupByParam:m,handleSearchQueryChange:e=>{n({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{n({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{n({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{n({nodesGroupBy:e},"replaceIn")}}}var j=r(44508),S=r(42265),T=r(15298),F=r(43951),k=r(71708),I=r(62710),P=r(88908),_=r(53807),R=r(12207),A=r(28539),B=r(9252),G=r(95963),D=r(64934),E=r(74281),L=r(60712);function O({value:e="database",onChange:t}){return(0,L.jsx)(E.x,{value:e,onUpdate:t,children:b.map((e=>(0,L.jsx)(E.x.Option,{value:e,children:v[e]},e)))})}const W=(0,r(77506).cn)("ydb-nodes"),$=e=>W("node",{unavailable:(0,u.X7)(e)});function V({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:r,columnsToSelect:l,handleSelectedColumnsUpdate:i,entitiesCountCurrent:d,entitiesCountTotal:u,entitiesLoading:h}){const{searchValue:p,uptimeFilter:m,peerRoleFilter:b,groupByParam:v,handleSearchQueryChange:y,handleUptimeFilterChange:f,handlePeerRoleFilterChange:x,handleGroupByParamChange:w}=C(t),{problemFilter:j,handleProblemFilterChange:S}=c(),T=(0,s.b)(),F=(0,o.DM)(),k=function(e,t){return N(e,t).map((e=>({value:e,content:(0,a.kn)(e)})))}(t,F),I=(0,o.WF)(),E=r&&I&&T;return(0,L.jsxs)(n.Fragment,{children:[(0,L.jsx)(G.v,{onChange:y,placeholder:g("controls_search-placeholder"),width:238,value:p}),F&&e?null:(0,L.jsx)(B.k,{value:j,onChange:S}),e?null:(0,L.jsx)(D.j,{value:m,onChange:f}),E?(0,L.jsxs)(n.Fragment,{children:[(0,L.jsx)(P.E,{variant:"body-2",children:g("controls_peer-role-label")}),(0,L.jsx)(O,{value:b,onChange:x})]}):null,(0,L.jsx)(_.O,{popupWidth:200,items:l,showStatus:!0,onUpdate:i,sortable:!1}),e?(0,L.jsxs)(n.Fragment,{children:[(0,L.jsx)(P.E,{variant:"body-2",children:g("controls_group-by-placeholder")}),(0,L.jsx)(R.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:v?[v]:void 0,onUpdate:e=>{w(e[0])},options:k,className:W("group-by-select"),popupClassName:W("group-by-popup")})]}):null,(0,L.jsx)(A.T,{current:d,total:u,label:g("nodes"),loading:h})]})}var U=r(78524),q=r(62783),z=r(81101),H=r(11906),M=r(69464),K=r(40781);const Q=async e=>{const{type:t="any",storage:r=!1,limit:n,offset:o,sortParams:s,filters:l,columnsIds:i}=e,{sortOrder:d,columnId:c}=null!==s&&void 0!==s?s:{},{path:h,database:p,searchValue:m,problemFilter:g,uptimeFilter:b,peerRoleFilter:v,filterGroup:y,filterGroupBy:f}=null!==l&&void 0!==l?l:{},x=(0,a.kU)(c),w=x?(0,M.T)(x,d):void 0,N=(0,K.R)(i,a.fN),C=await window.api.viewer.getNodes({type:t,storage:r,limit:n,offset:o,sort:w,path:h,database:p,filter:m,problems_only:(0,u.AB)(g),uptime:(0,u.Fo)(b),filter_peer_role:v,filter_group:y,filter_group_by:f,fieldsRequired:N}),j=(0,H.N)(C);return{data:j.Nodes||[],found:j.FoundNodes||0,total:j.TotalNodes||0}};function Y({path:e,database:t,searchValue:r,problemFilter:o,uptimeFilter:s,peerRoleFilter:l,filterGroup:i,filterGroupBy:d,columns:c,scrollContainerRef:h,initialEntitiesCount:p}){const m=n.useMemo((()=>({path:e,database:t,searchValue:r,problemFilter:o,uptimeFilter:s,peerRoleFilter:l,filterGroup:i,filterGroupBy:d})),[e,t,r,o,s,l,i,d]);return(0,L.jsx)(q.k5,{columnsWidthLSKey:a.zO,scrollContainerRef:h,columns:c,fetchData:Q,initialEntitiesCount:p,renderErrorMessage:z.$,renderEmptyDataMessage:()=>"All"!==o||s!==u.cW.All?(0,L.jsx)(U.v,{name:"thumbsUp",width:"200"}):g("empty.default"),getRowClassName:$,filters:m,tableName:"nodes"})}const J=n.memo((function({name:e,count:t,isExpanded:r,path:n,database:a,searchValue:o,peerRoleFilter:s,groupByParam:l,columns:i,scrollContainerRef:d,onIsExpandedChange:c}){return(0,L.jsx)(k.Q,{title:e,count:t,entityName:g("nodes"),expanded:r,onIsExpandedChange:c,children:(0,L.jsx)(S.o,{initialState:{sortParams:void 0},table:(0,L.jsx)(Y,{path:n,database:a,searchValue:o,problemFilter:"All",uptimeFilter:u.cW.All,peerRoleFilter:s,filterGroup:e,filterGroupBy:l,initialEntitiesCount:t,columns:i,scrollContainerRef:d}),tableWrapperProps:{scrollContainerRef:d}})},e)}));function X({path:e,database:t,scrollContainerRef:r,withPeerRoleFilter:o,columns:s,defaultColumnsIds:l,requiredColumnsIds:d,selectedColumnsKey:c,groupByParams:u}){const{searchValue:h,peerRoleFilter:p,groupByParam:m}=C(u),[b]=(0,i.Nt)(),{columnsToShow:v,columnsToSelect:y,setColumns:f}=(0,F.K)(s,c,a.uG,l,d),{currentData:x,isFetching:w,error:N}=T.s.useGetNodesQuery({path:e,database:t,filter:h,filter_peer_role:p,group:m,limit:0},{pollingInterval:b}),k=void 0===x&&w,{NodeGroups:P,FoundNodes:_=0,TotalNodes:R=0}=x||{},{expandedGroups:A,setIsGroupExpanded:B}=(0,I.$)(P),G=n.useMemo((()=>({foundEntities:_,totalEntities:R,isInitialLoad:k,sortParams:void 0})),[_,R,k]);return(0,L.jsx)(S.o,{initialState:G,controls:(0,L.jsx)(V,{groupByParams:u,withPeerRoleFilter:o,columnsToSelect:y,handleSelectedColumnsUpdate:f,entitiesCountCurrent:_,entitiesCountTotal:R,entitiesLoading:k,withGroupBySelect:!0}),error:N?(0,L.jsx)(j.o,{error:N}):null,table:null!==P&&void 0!==P&&P.length?P.map((({name:n,count:a})=>{const o=A[n];return(0,L.jsx)(J,{name:n,count:a,isExpanded:o,path:e,database:t,searchValue:h,peerRoleFilter:p,groupByParam:m,columns:v,scrollContainerRef:r,onIsExpandedChange:B},n)})):g("no-nodes-groups"),tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[h,m,P,p],loading:k,className:W("groups-wrapper")}})}var Z=r(49554);function ee({withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:r,columnsToSelect:n,handleSelectedColumnsUpdate:a}){const{tableState:o}=(0,Z.WV)();return(0,L.jsx)(V,{withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:r,columnsToSelect:n,handleSelectedColumnsUpdate:a,entitiesCountCurrent:o.foundEntities,entitiesCountTotal:o.totalEntities,entitiesLoading:o.isInitialLoad})}function te({path:e,database:t,scrollContainerRef:r,withPeerRoleFilter:n,columns:s,defaultColumnsIds:l,requiredColumnsIds:i,selectedColumnsKey:d,groupByParams:u}){const{searchValue:h,uptimeFilter:p,peerRoleFilter:m}=C(u),{problemFilter:g}=c(),b=(0,o.Ye)(),{columnsToShow:v,columnsToSelect:y,setColumns:f}=(0,F.K)(s,d,a.uG,l,i);return(0,L.jsx)(S.o,{controls:(0,L.jsx)(ee,{withGroupBySelect:b,groupByParams:u,withPeerRoleFilter:n,columnsToSelect:y,handleSelectedColumnsUpdate:f}),table:(0,L.jsx)(Y,{path:e,database:t,searchValue:h,problemFilter:g,uptimeFilter:p,peerRoleFilter:m,columns:v,scrollContainerRef:r}),tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[h,g,p,m]}})}function re(e){const{uptimeFilter:t,groupByParam:r,handleUptimeFilterChange:a}=C(e.groupByParams),{problemFilter:s,handleProblemFilterChange:i}=c(),d=(0,o.Pm)(),h=(0,o.Ye)();n.useEffect((()=>{!h||"All"===s&&t===u.cW.All||(i("All"),a(u.cW.All))}),[i,a,s,t,h]);return(0,L.jsx)(l.r,{loading:!d,children:h&&r?(0,L.jsx)(X,{...e}):(0,L.jsx)(te,{...e})})}var ne=r(95109);function ae(e){return[(0,ne._E)(),(0,ne.Nh)(e),(0,ne.eT)(),(0,ne.uk)(),(0,ne.OV)(),(0,ne.OX)(),(0,ne.jl)(),(0,ne.fr)(),(0,ne.kv)(),(0,ne.pH)(),(0,ne.iX)(),(0,ne.ID)(),(0,ne.Rn)(),(0,ne.qp)(e)].map((e=>({...e,sortable:(0,a.sp)(e.name)})))}function oe({path:e,database:t,scrollContainerRef:r,additionalNodesProps:l,withPeerRoleFilter:i,columns:d=ae({database:t,getNodeRef:null===l||void 0===l?void 0:l.getNodeRef}),defaultColumnsIds:c=f,requiredColumnsIds:u=x,selectedColumnsKey:h=y,groupByParams:p=w}){const m=(0,o.Z9)(),g=n.useMemo((()=>m?d:d.filter((e=>e.name!==a.vg.PileName))),[m,d]),b=n.useMemo((()=>m?c.includes(a.vg.PileName)?c:[...c,a.vg.PileName]:c),[m,c]),v=(0,s.X)(),N=(0,s.b)(),C=n.useMemo((()=>{if(v)return g;const e=g.filter((e=>!(0,a.xd)(e.name)));return N?e:e.filter((e=>!(0,a.ri)(e.name)))}),[g,v,N]),j=n.useMemo((()=>m&&p?p.includes("PileName")?p:[...p,"PileName"]:p),[m,p]);return(0,L.jsx)(re,{path:e,database:t,scrollContainerRef:r,withPeerRoleFilter:i,columns:C,defaultColumnsIds:b,requiredColumnsIds:u,selectedColumnsKey:h,groupByParams:j})}},11906:(e,t,r)=>{r.d(t,{N:()=>a});var n=r(78034);const a=e=>{var t;const r=(e.Nodes||[]).map((e=>{const{SystemState:t,...r}=e;return{...r,...(0,n.q1)(t)}}));return{Nodes:r,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||r.length,FoundNodes:Number(e.FoundNodes)}}},15298:(e,t,r)=>{r.d(t,{s:()=>o});var n=r(21334),a=r(11906);const o=n.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const r=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,a.N)(r)}}catch(r){return{error:r}}},providesTags:["All"]})}),overrideExisting:"throw"})},18836:(e,t,r)=>{r.d(t,{s:()=>s,v:()=>o});var n=r(56839),a=r(35736);function o({colorizeProgress:e=!0,warningThreshold:t,dangerThreshold:r,inverseColorize:o=!1,fillWidth:s}){const l=Math.max(s,.5);return{status:(0,a.w)({fillWidth:s,warningThreshold:t,dangerThreshold:r,colorizeProgress:e,inverseColorize:o}),percents:(0,n.l9)(s/100),fill:l}}function s({value:e,capacity:t,legendFormatter:r,...n}){const a=parseFloat(String(e)),s=parseFloat(String(t));let l=a/s*100||0;l=l>100?100:l;const i=r({value:a,capacity:s});return{...o({fillWidth:l,...n}),legend:i}}},21049:(e,t,r)=>{r.d(t,{e:()=>m});var n=r(59284),a=r(32752),o=r(88908),s=r(20263),l=r(77506),i=r(60712);function d({cx:e,cy:t,r:r,stroke:n,strokeWidth:a,strokeDasharray:o,strokeDashoffset:s,strokeLinecap:l="butt",fill:d="none",className:c}){return(0,i.jsx)("circle",{cx:e,cy:t,r:r,fill:d,stroke:n,strokeWidth:a,strokeDasharray:o,strokeDashoffset:s,strokeLinecap:l,className:c})}const c={small:{width:65,strokeWidth:12,textVariant:"subheader-1"},medium:{width:100,strokeWidth:16,textVariant:"subheader-2"},large:{width:130,strokeWidth:20,textVariant:"subheader-3"}},u=.75;const h=(0,l.cn)("ydb-doughnut-metrics"),p=n.createContext("medium");function m({status:e,fillWidth:t,children:r,className:n,size:a="medium"}){const o=c[a],s=(o.width-o.strokeWidth)/2,l=function(e){return 2*Math.PI*e}(s),m=l*u,g=o.width/2,b=o.width/2,v=function(e,t){if(e<=0)return"0 0";const r=Math.min(e,100)/100*t;return`${r} ${t-r}`}(t,l),y=function(e,t){if(e<=100)return"0 0";const r=(e-100)/100*t;return`${r} ${t-r}`}(t,l),f=t>100;return(0,i.jsx)(p.Provider,{value:a,children:(0,i.jsxs)("div",{className:h({status:e},n),children:[(0,i.jsxs)("svg",{width:o.width,height:o.width,className:h("doughnut"),children:[(0,i.jsx)(d,{cx:g,cy:b,r:s,stroke:"var(--doughnut-backdrop-color)",strokeWidth:o.strokeWidth}),(0,i.jsx)(d,{cx:g,cy:b,r:s,stroke:"var(--doughnut-color)",strokeWidth:o.strokeWidth,strokeDasharray:v,strokeDashoffset:m,className:h("progress-circle")}),f&&(0,i.jsx)(d,{cx:g,cy:b,r:s,stroke:"var(--doughnut-overlap-color)",strokeWidth:o.strokeWidth,strokeDasharray:y,strokeDashoffset:m,className:h("overlap-circle")})]}),(0,i.jsx)("div",{className:h("text-wrapper"),children:r})]})})}m.Legend=function({children:e,variant:t="subheader-3",color:r="primary",note:n,noteIconSize:l="m"}){return(0,i.jsxs)(a.s,{gap:1,alignItems:"center",children:[(0,i.jsx)(o.E,{variant:t,color:r,className:h("legend"),as:"div",children:e}),n&&(0,i.jsx)(s.H,{iconSize:l,className:h("legend-note"),popoverProps:{placement:"right"},children:n})]})},m.Value=function({children:e,variant:t}){const r=n.useContext(p),a=t||c[r].textVariant;return(0,i.jsx)(o.E,{variant:a,className:h("value"),children:e})}},21545:(e,t,r)=>{r.d(t,{X:()=>a});var n=r(78034);const a=r(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:r},{signal:a})=>{try{const[o,s,l]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:r},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({database:t},{signal:a})]),i=(0,n.nN)(l),d=Object.keys(s).reduce(((e,t)=>{var r;const n=null===(r=s[t])||void 0===r?void 0:r.TabletStateInfo;return null===n||void 0===n||n.forEach((r=>{var n;const{ChangeTime:a,Generation:o,State:s,Leader:l,FollowerId:d}=r,c=i&&t?null===(n=i.get(Number(t)))||void 0===n?void 0:n.Host:void 0;e.push({nodeId:t,generation:o,changeTime:a,state:s,leader:l,followerId:d,fqdn:c})})),e}),[]),{TabletStateInfo:c=[]}=o,u=void 0===r?c.find((e=>e.Leader)):c.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===r})),{TabletId:h}=u||{};return{data:{id:h,data:u,history:d}}}catch(o){return{error:o}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e,database:t},{signal:r})=>{try{const n=await window.api.viewer.getTabletDescribe(e,t,{signal:r}),{SchemeShard:a,PathId:o}=e;return{data:(null===n||void 0===n?void 0:n.Path)||`${a}:${o}`}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:r})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:r})}}catch(n){return{error:n}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,r)=>{r.d(t,{B:()=>d});var n=r(59284),a=r(80136),o=r(58611),s=r(55974),l=r(42829),i=r(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:r,dialogHeader:d,dialogText:c,retryButtonText:u,buttonDisabled:h=!1,buttonView:p="action",buttonTitle:m,buttonClassName:g,withPopover:b=!1,popoverContent:v,popoverPlacement:y="right",popoverDisabled:f=!0}){const[x,w]=n.useState(!1),[N,C]=n.useState(!1),[j,S]=n.useState(!1),T=()=>(0,i.jsx)(a.$,{onClick:()=>w(!0),view:p,disabled:h,loading:!h&&N,className:g,title:m,children:e});return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(s.g,{visible:x,header:d,text:c,withRetry:j,retryButtonText:u,onConfirm:async e=>{C(!0),await t(e)},onConfirmActionSuccess:async()=>{S(!1);try{await(null===r||void 0===r?void 0:r())}finally{C(!1)}},onConfirmActionError:e=>{S((0,l.D)(e)),C(!1)},onClose:()=>{w(!1)}}),b?(0,i.jsx)(o.A,{content:v,placement:y,disabled:f,children:T()}):T()]})}},27775:(e,t,r)=>{r.d(t,{i:()=>s});var n=r(52443),a=r(58267),o=r(60712);function s({state:e}){return(0,o.jsx)(n.J,{theme:(0,a._)(e),children:e})}},28539:(e,t,r)=>{r.d(t,{T:()=>n.T});var n=r(53755)},37477:(e,t,r)=>{r.d(t,{c:()=>C});r(59284);var n=r(8979),a=r(52443),o=r(32752),s=r(20263),l=r(54090),i=r(77506),d=r(43937),c=r(36388),u=r(94420),h=r(70825),p=r(49917),m=r(47653),g=r(60712);const b={[l.m.Blue]:d.A,[l.m.Yellow]:c.A,[l.m.Orange]:u.A,[l.m.Red]:c.A,[l.m.Green]:h.A,[l.m.Grey]:p.A};function v({status:e,...t}){return e?(0,g.jsx)(m.I,{...t,data:b[e]}):null}var y=r(89732),f=r(97677);const x=(0,i.cn)("ydb-entity-status-new"),w={[l.m.Red]:"danger",[l.m.Blue]:"info",[l.m.Green]:"success",[l.m.Grey]:"unknown",[l.m.Orange]:"orange",[l.m.Yellow]:"warning"},N={get[l.m.Red](){return(0,y.A)("title_red")},get[l.m.Yellow](){return(0,y.A)("title_yellow")},get[l.m.Orange](){return(0,y.A)("title_orange")},get[l.m.Green](){return(0,y.A)("title_green")},get[l.m.Grey](){return(0,y.A)("title_grey")},get[l.m.Blue](){return(0,y.A)("title_blue")}};function C({className:e,children:t}){return(0,g.jsx)(o.s,{gap:"2",wrap:"nowrap",alignItems:"center",className:x(null,e),children:t})}C.Label=function({children:e,status:t,withStatusName:r=!0,note:l,size:i="m",iconSize:d=14}){const c=w[t];return(0,g.jsx)(n.m,{title:f.D[t],disabled:Boolean(l),children:(0,g.jsx)(a.J,{theme:"orange"===c?void 0:c,icon:(0,g.jsx)(v,{size:d,status:t}),size:i,className:x({orange:"orange"===c}),children:(0,g.jsxs)(o.s,{gap:"2",wrap:"nowrap",children:[e,r?N[t]:null,l&&(0,g.jsx)(s.H,{className:x("note"),children:l})]})})})},C.displayName="EntityStatus"},42829:(e,t,r)=>{r.d(t,{D:()=>n});const n=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55340:(e,t,r)=>{r.d(t,{x:()=>u});var n=r(11363),a=r(95109),o=r(86782);const s="networkNodesTableSelectedColumns",l=["NodeId","NetworkHost","Connections","NetworkUtilization","SendThroughput","ReceiveThroughput","PingTime","ClockSkew"],i=["NodeId","NetworkHost"],d=["Host","DC","Rack","Uptime","ConnectStatus","NetworkUtilization","PingTime","ClockSkew"];var c=r(60712);function u({database:e,path:t,scrollContainerRef:r,additionalNodesProps:u}){return(0,c.jsx)(n.G,{path:t,database:e,scrollContainerRef:r,withPeerRoleFilter:Boolean(e),additionalNodesProps:u,columns:(h={database:e,getNodeRef:null===u||void 0===u?void 0:u.getNodeRef},[(0,a._E)(),(0,a.b8)(h),(0,a.uk)(),(0,a.OX)(),(0,a.jl)(),(0,a.fr)(),(0,a.kv)(),(0,a.SH)(),(0,a.H)(),(0,a.DH)(),(0,a.ui)(),(0,a.wN)(),(0,a.pt)()].map((e=>({...e,sortable:(0,o.sp)(e.name)})))),defaultColumnsIds:l,requiredColumnsIds:i,selectedColumnsKey:s,groupByParams:d});var h}},55974:(e,t,r)=>{r.d(t,{g:()=>y});var n=r(59284),a=r(18677),o=r(71153),s=r(48139),l=r(82521),i=r(47653),d=r(56999),c=r(77506),u=r(81288),h=r(48372);const p=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),m=(0,h.g4)("ydb-critical-action-dialog",{en:p});var g=r(60712);const b=(0,c.cn)("ydb-critical-dialog"),v=e=>{if((0,u.cH)(e)){if(403===e.status)return m("no-rights-error");if("string"===typeof e.data)return e.data;if((0,u._E)(e)&&e.data)return(0,g.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return m("default-error")};function y({visible:e,header:t,text:r,withRetry:d,retryButtonText:c,withCheckBox:u,onClose:h,onConfirm:p,onConfirmActionSuccess:y,onConfirmActionError:f}){const[x,w]=n.useState(!1),[N,C]=n.useState(),[j,S]=n.useState(!1),T=async e=>(w(!0),p(e).then((()=>{y(),h()})).catch((e=>{f(e),C(e)})).finally((()=>{w(!1)})));return(0,g.jsx)(l.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:h,onTransitionOutComplete:()=>{C(void 0),S(!1)},children:N?(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(l.l.Header,{caption:t}),(0,g.jsx)(l.l.Body,{className:b("body"),children:(0,g.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,g.jsx)("span",{className:b("error-icon"),children:(0,g.jsx)(a.A,{width:"24",height:"22"})}),v(N)]})}),(0,g.jsx)(l.l.Footer,{loading:!1,preset:"default",textButtonApply:d?c||m("button-retry"):void 0,textButtonCancel:m("button-close"),onClickButtonApply:()=>T(!0),onClickButtonCancel:h})]}):(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(l.l.Header,{caption:t}),(0,g.jsxs)(l.l.Body,{className:b("body"),children:[(0,g.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,g.jsx)("span",{className:b("warning-icon"),children:(0,g.jsx)(i.I,{data:o.A,size:24})}),r]}),u?(0,g.jsx)(s.S,{checked:j,onUpdate:S,children:m("checkbox-text")}):null]}),(0,g.jsx)(l.l.Footer,{loading:x,preset:"default",textButtonApply:m("button-confirm"),textButtonCancel:m("button-cancel"),propsButtonApply:{type:"submit",disabled:u&&!j},onClickButtonCancel:h,onClickButtonApply:()=>T()})]})})}},56999:(e,t,r)=>{r.d(t,{O:()=>w});var n=r(59284),a=r(45720),o=r(16929),s=r(71153),l=r(18677),i=r(80136),d=r(60461),c=r(78540),u=r(47653),h=r(74529),p=r(77506),m=r(41650);const g=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function b(e){return function(e){return!!e&&void 0!==g[e]}(e)?g[e]:"S_INFO"}var v=r(60712);const y=(0,p.cn)("kv-result-issues"),f=(0,p.cn)("kv-issues"),x=(0,p.cn)("kv-issue");function w({data:e,hideSeverity:t}){const[r,a]=n.useState(!1),o="string"===typeof e||null===e||void 0===e?void 0:e.issues,s=Array.isArray(o)&&o.length>0;return(0,v.jsxs)("div",{className:y(),children:[(0,v.jsxs)("div",{className:y("error-message"),children:[(()=>{let r;if("string"===typeof e)r=e;else{var a,o;const s=b(null===e||void 0===e||null===(a=e.error)||void 0===a?void 0:a.severity);r=(0,v.jsxs)(n.Fragment,{children:[t?null:(0,v.jsxs)(n.Fragment,{children:[(0,v.jsx)(k,{severity:s})," "]}),(0,v.jsx)("span",{className:y("error-message-text"),children:null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message})]})}return r})(),s&&(0,v.jsx)(i.$,{view:"normal",onClick:()=>a(!r),children:r?"Hide details":"Show details"})]}),s&&r&&(0,v.jsx)(N,{hideSeverity:t,issues:o})]})}function N({issues:e,hideSeverity:t}){const r=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var r;const n=null!==(r=t.severity)&&void 0!==r?r:10;return Math.min(e,n)}),10);return(0,v.jsx)("div",{className:f(null),children:null===e||void 0===e?void 0:e.map(((e,n)=>(0,v.jsx)(C,{hideSeverity:t,issue:e,expanded:e===r},n)))})}function C({issue:e,hideSeverity:t,level:r=0}){const[a,o]=n.useState(!0),s=b(e.severity),l=e.issues,c=Array.isArray(l)&&l.length>0,u=a?"bottom":"right";return(0,v.jsxs)("div",{className:x({leaf:!c,"has-issues":c}),children:[(0,v.jsxs)("div",{className:x("line"),children:[c&&(0,v.jsx)(i.$,{view:"flat-secondary",onClick:()=>o(!a),className:x("arrow-toggle"),children:(0,v.jsx)(d.I,{direction:u,size:16})}),t?null:(0,v.jsx)(k,{severity:s}),(0,v.jsx)(j,{issue:e}),e.issue_code?(0,v.jsxs)("span",{className:x("code"),children:["Code: ",e.issue_code]}):null]}),c&&a&&(0,v.jsx)("div",{className:x("issues"),children:(0,v.jsx)(S,{issues:l,level:r+1,expanded:a})})]})}function j({issue:e}){var t;const r=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,m.kf)(t.row))return"";const{row:r,column:n}=t;return(0,m.kf)(n)?`${r}:${n}`:`line ${r}`}(e),n=window.ydbEditor,a=()=>(0,v.jsxs)("span",{className:x("message"),children:[r&&(0,v.jsx)("span",{className:x("place-text"),title:"Position",children:r}),(0,v.jsx)("div",{className:x("message-text"),children:(0,v.jsx)(h.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:o,column:s}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,m.kf)(o)&&n))return a();return(0,v.jsx)(c.N,{href:"#",onClick:()=>{const e={lineNumber:o,column:null!==s&&void 0!==s?s:0};n.setPosition(e),n.revealPositionInCenterIfOutsideViewport(e),n.focus()},view:"primary",draggable:!1,children:a()})}function S(e){const{issues:t,level:r,expanded:n}=e;return(0,v.jsx)("div",{className:x("list"),children:t.map(((e,t)=>(0,v.jsx)(C,{issue:e,level:r,expanded:n},t)))})}const T={S_INFO:a.A,S_WARNING:o.A,S_ERROR:s.A,S_FATAL:l.A},F=(0,p.cn)("yql-issue-severity");function k({severity:e}){const t=e.slice(2).toLowerCase();return(0,v.jsxs)("span",{className:F({severity:t}),children:[(0,v.jsx)(u.I,{className:F("icon"),data:T[e]}),(0,v.jsx)("span",{className:F("title"),children:t})]})}},57428:(e,t,r)=>{r.d(t,{vs:()=>d,sp:()=>c,cO:()=>i});var n=r(46549),a=r(56839),o=r(48372);const s=JSON.parse('{"context_of":"of","context_cores":"cores"}'),l=(0,o.g4)("ydb-metrics",{en:s});function i({value:e,capacity:t}){const r=(0,a.j9)(e,t,void 0,"\n");return`${r[0]} ${l("context_of")} ${r[1]}`}function d({value:e,capacity:t}){let r=[];return r=t<1e4?[(0,a.ZV)(Math.round(e)),(0,a.ZV)(Math.round(t))]:(0,a.Nd)(e,t,void 0,"",!0),`${r[0]} ${l("context_of")} ${r[1]} ${l("context_cores")}`}function c({value:e,capacity:t}){const r=(0,n.fn)(t),a=(0,n.z3)({value:e,size:r,precision:2,withSpeedLabel:!1,withSizeLabel:!1}),o=(0,n.z3)({value:t,size:r,precision:2,withSpeedLabel:!0});return`${a} ${l("context_of")} ${o}`}},74529:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(59284),a=r(78540),o=r(77506),s=r(48372);const l=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),i=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,s.g4)("ydb-shorty-string",{ru:i,en:l});var c=r(60712);const u=(0,o.cn)("kv-shorty-string");function h({value:e="",limit:t=200,strict:r=!1,displayLength:o=!0,render:s=e=>e,onToggle:l,expandLabel:i=d("default_expand_label"),collapseLabel:h=d("default_collapse_label")}){const[p,m]=n.useState(!1),g=(p?h:i)+(o&&!p?d("chars_count",{count:e.length}):""),b=e.length>t+(r?0:g.length),v=p||!b?e:e.slice(0,t-4)+"\xa0...";return(0,c.jsxs)("div",{className:u(),children:[s(v),b?(0,c.jsx)(a.N,{className:u("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),m((e=>!e)),null===l||void 0===l||l()},children:g}):null]})}},78321:(e,t,r)=>{r.d(t,{b:()=>s,s:()=>l});var n=r(67028),a=r(76086),o=r(53627);function s(){const e=(0,n.WF)(),[t]=(0,o.iK)(a.g5);return Boolean(e&&t)}function l(){const e=(0,n.DY)(),[t]=(0,o.iK)(a.g5);return Boolean(e&&t)}},88616:(e,t,r)=>{r.d(t,{Q:()=>I});var n=r(59284),a=r(76938),o=r(88908),s=r(47653),l=r(13847),i=r(80987),d=r(22983),c=r(28539),u=r(10508),h=r(44508),p=r(43615),m=r(17594),g=r(41775),b=r(69326),v=r(80420),y=r(27775),f=r(41826),x=r(21545),w=r(6354),N=r(76086),C=r(12888),j=r(48372);const S=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),T=(0,j.g4)("ydb-tablets",{en:S});var F=r(60712);function k(e){const t=e.State===w.r.Stopped,r=(0,C.X)(),[n]=x.X.useKillTabletMutation(),o=e.TabletId;return o?(0,F.jsx)(d.B,{buttonView:"outlined",buttonTitle:T("dialog.kill-header"),dialogHeader:T("dialog.kill-header"),dialogText:T("dialog.kill-text"),onConfirmAction:()=>n({id:o}).unwrap(),buttonDisabled:t||!r,withPopover:!0,popoverContent:T(r?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","bottom"],popoverDisabled:!1,children:(0,F.jsx)(s.I,{data:a.A})}):null}function I({database:e,tablets:t,loading:r,error:a,scrollContainerRef:s,nodeId:d}){const[{tabletsSearch:x},w]=(0,i.useQueryParams)({tabletsSearch:i.StringParam}),[C,j]=n.useState(),S=n.useMemo((()=>function({database:e,nodeId:t}){const r=[{name:"Type",width:150,get header(){return T("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,F.jsxs)("span",{children:[e.Type," ",t?(0,F.jsx)(o.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return T("Tablet")},render:({row:t})=>t.TabletId?(0,F.jsx)(v.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):N.Pd},{name:"State",get header(){return T("State")},render:({row:e})=>(0,F.jsx)(y.i,{state:e.State})}];return void 0===t&&r.push({name:"NodeId",get header(){return T("Node ID")},render:({row:e})=>(0,l.isNil)(e.NodeId)?N.Pd:(0,F.jsx)(p.W,{id:e.NodeId}),align:"right"},{name:"fqdn",get header(){return T("Node FQDN")},render:({row:e})=>e.fqdn?(0,F.jsx)(u.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):N.Pd}),r.push({name:"Generation",get header(){return T("Generation")},align:"right"},{name:"Uptime",get header(){return T("Uptime")},render:({row:e})=>(0,F.jsx)(f.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,F.jsx)(k,{...e})}),r}({database:e,nodeId:d})),[e,d]),I=n.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==x&&void 0!==x?x:"")))),[t,x]);return(0,F.jsxs)(b.L,{fullHeight:!0,children:[(0,F.jsxs)(b.L.Controls,{children:[(0,F.jsx)(g.v,{placeholder:T("controls.search-placeholder"),onChange:e=>{w({tabletsSearch:e||void 0},"replaceIn")},value:null!==x&&void 0!==x?x:"",width:238}),(0,F.jsx)(c.T,{label:T("controls.entities-count-label"),loading:r,total:t.length,current:I.length})]}),a?(0,F.jsx)(h.o,{error:a}):null,(0,F.jsx)(b.L.Table,{scrollContainerRef:s,scrollDependencies:[x,C],loading:r,children:(0,F.jsx)(m.l,{columns:S,data:I,settings:N.N3,emptyDataMessage:T("noTabletsData"),onSortChange:j})})]})}},89732:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(48372);const a=JSON.parse('{"title_red":"Critical","title_blue":"Normal","title_green":"Good","title_grey":"Unknown","title_orange":"Caution","title_yellow":"Warning","context_red":"Some systems are failed and not available","context_yellow":"There are minor issues","context_orange":"Critical state, requires immediate attention","context_green":"Everything is working as expected","context_grey":"The condition cannot be determined","context_blue":"All good, some parts of the system are restoring"}'),o=(0,n.g4)("ydb-entity-status",{en:a})},95963:(e,t,r)=>{r.d(t,{v:()=>n.v});var n=r(41775)},97677:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(54090),a=r(89732);const o={get[n.m.Red](){return(0,a.A)("context_red")},get[n.m.Yellow](){return(0,a.A)("context_yellow")},get[n.m.Orange](){return(0,a.A)("context_orange")},get[n.m.Green](){return(0,a.A)("context_green")},get[n.m.Grey](){return(0,a.A)("context_grey")},get[n.m.Blue](){return(0,a.A)("context_blue")}}}}]);