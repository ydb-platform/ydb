(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[2048],{91816:(e,t,s)=>{"use strict";s.d(t,{b:()=>c});var n=s(68963),l=s(56711),a=s(24362),r=s(42587),o=s(75859);const i=(0,a.cn)("ydb-info-viewer-skeleton"),d=()=>(0,o.jsxs)("div",{className:i("label"),children:[(0,o.jsx)(l.O,{className:i("label__text")}),(0,o.jsx)("div",{className:i("label__dots")})]}),c=e=>{let{rows:t=8,className:s,delay:a=600}=e;const[c]=(0,r.$)(a);let u=(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(d,{}),(0,o.jsx)(l.O,{className:i("value")})]});return c||(u=null),(0,o.jsx)("div",{className:i(null,s),children:[...new Array(t)].map(((e,t)=>(0,o.jsx)("div",{className:i("row"),children:u},`skeleton-row-${t}`)))})}},12199:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});s(68963);var n=s(24362),l=s(75859);const a=(0,n.cn)("tag"),r=e=>{let{text:t,type:s}=e;return(0,l.jsx)("div",{className:a({type:s}),children:t})},o=(0,n.cn)("tags"),i=e=>{let{tags:t,tagsType:s,className:n=""}=e;return(0,l.jsx)("div",{className:o(null,n),children:t&&t.map(((e,t)=>(0,l.jsx)(r,{text:e,type:s},t)))})}},37070:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Cluster:()=>Qe});var n=s(68963),l=s(56711),a=s(8179),r=s(49352),o=s(86974),i=s(52846),d=s(50422),c=s(69214),u=s(74170),v=s(54665),m=s(77915),h=s(79061),p=s(24362),x=s(17096),g=s(94076),N=s(96027),j=s(19897),b=s(19812),f=s(17176),w=s(36985),y=s(26688),E=s(56350),C=s(68242),T=s(74221),k=s(2098),P=s(11551),O=s(47101),S=s(27102),A=s(80839),L=s(36313),M=s(43680),D=s.n(M),V=s(75850),Z=s(52317),z=s(53809);const G=(0,L.P1)((e=>e),(e=>z.Xv.endpoints.getTenantsInfo.select({clusterName:e}))),I=(0,L.P1)((e=>e),((e,t)=>G(t)),(e=>(0,A.Cx)(e,Z.Zy)),((e,t,s)=>{var n;const l=null!==(n=t(e).data)&&void 0!==n?n:[];return!s&&l.length>1?l.filter((e=>"Domain"!==e.Type)):l})),R=e=>e.tenants.searchValue,F=(0,L.P1)([I,A.qz,R],((e,t,s)=>{let n=((e,t)=>t===A.pu.ALL?e:e.filter((e=>e.Overall&&e.Overall!==V.K.Green)))(e,t);return n=((e,t)=>e.filter((e=>{const s=new RegExp(D()(t),"i");return s.test(e.Name||"")||s.test(e.controlPlaneName)})))(n,s),n}));var B=s(34301),$=s(95478),_=s(75859);const q=(0,p.cn)("tenants"),H=e=>{let{additionalTenantsProps:t}=e;const s=(0,x.zL)(),[l]=(0,x.Rj)(),{currentData:a,isFetching:r,error:o}=z.Xv.useGetTenantsInfoQuery({clusterName:S.qw},{pollingInterval:l}),i=r&&void 0===a,d=(0,x.ix)((e=>I(e,S.qw))),u=(0,x.ix)(R),v=(0,x.ix)((e=>F(e,S.qw))),m=(0,x.ix)(A.qz),h=e=>{s((0,A.M6)(e))},p=e=>{s((0,z.gI)(e))};return(0,_.jsxs)(O.l,{children:[(0,_.jsx)(O.l.Controls,{children:(0,_.jsxs)(n.Fragment,{children:[(0,_.jsx)(P.o,{value:u,onChange:p,placeholder:"Database name",className:q("search")}),(0,_.jsx)(T.T,{value:m,onChange:h}),(0,_.jsx)(w.C,{total:d.length,current:(null===v||void 0===v?void 0:v.length)||0,label:"Databases",loading:i})]})}),o?(0,_.jsx)(y.V,{error:o}):null,(0,_.jsx)(O.l.Table,{loading:i,children:a?(()=>{const e=[{name:"Name",header:"Database",render:e=>{var s;let{row:n}=e;const l=(e=>{var s,n;const l=null!==(s=e.MonitoringEndpoint)&&void 0!==s?s:e.backend;return null===t||void 0===t||null===(n=t.prepareTenantBackend)||void 0===n?void 0:n.call(t,l)})(n),a=Boolean(l);return(0,_.jsx)(c.A,{externalLink:a,className:q("name"),name:n.Name||"unknown database",withLeftTrim:!0,status:n.Overall,hasClipboardButton:!0,path:(0,$.Sj)({name:n.Name,backend:l}),additionalControls:null===t||void 0===t||null===(s=t.getMonitoringLink)||void 0===s?void 0:s.call(t,n.Name,n.Type)})},width:440,sortable:!0,defaultOrder:b.ZP.DESCENDING},{name:"controlPlaneName",header:"Name",render:e=>{let{row:t}=e;return t.controlPlaneName},width:200,sortable:!0,defaultOrder:b.ZP.DESCENDING},{name:"Type",width:200,resizeMinWidth:150,render:e=>{let{row:t}=e;return"Serverless"!==t.Type?t.Type:(0,_.jsxs)("div",{className:q("type"),children:[(0,_.jsx)("span",{className:q("type-value"),children:t.Type}),(0,_.jsx)(f.z,{className:q("type-button"),onClick:()=>p(t.sharedTenantName||""),children:"Show shared"})]})}},{name:"State",width:90,render:e=>{let{row:t}=e;return t.State?t.State.toLowerCase():"\u2014"},customStyle:()=>({textTransform:"capitalize"})},{name:"cpu",header:"CPU",width:80,render:e=>{let{row:t}=e;return t.cpu&&t.cpu>1e4?(0,B.LO)(t.cpu):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"memory",header:"Memory",width:120,render:e=>{let{row:t}=e;return t.memory?(0,B.q3)(t.memory):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"storage",header:"Storage",width:120,render:e=>{let{row:t}=e;return t.storage?(0,B.q3)(t.storage):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"nodesCount",header:"Nodes",width:100,render:e=>{let{row:t}=e;return t.nodesCount?(0,B.uf)(t.nodesCount):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"groupsCount",header:"Groups",width:100,render:e=>{let{row:t}=e;return t.groupsCount?(0,B.uf)(t.groupsCount):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"PoolStats",header:"Pools",width:100,resizeMinWidth:60,sortAccessor:e=>{let{PoolStats:t=[]}=e;return t.reduce(((e,t)=>e+(t.Usage||0)),0)},defaultOrder:b.ZP.DESCENDING,align:b.ZP.LEFT,render:e=>{let{row:t}=e;return(0,_.jsx)(C.m,{pools:t.PoolStats})}}];return 0===v.length&&m!==A.pu.ALL?(0,_.jsx)(E.Q,{name:"thumbsUp",width:"200"}):(0,_.jsx)(k.G,{columnsWidthLSKey:"databasesTableColumnsWidth",data:v,columns:e,settings:Z.LE,emptyDataMessage:"No such tenants"})})():null})]})};var U=s(79734),W=s(48897),Q=s(62776),X=s(3534),K=s(40067),Y=s(67359),J=s(51688),ee=s(92398);const te=[{name:"NodeId",header:"#",width:80,resizeMinWidth:80,align:b.ZP.LEFT,render:e=>{let{row:t}=e;return t.NodeId}},{name:"Host",render:e=>{var t;let{row:s}=e;const n=s.Endpoints&&(null===(t=s.Endpoints.find((e=>"http-mon"===e.Name)))||void 0===t?void 0:t.Address),l=s.Host&&`${s.Host}${n||""}`||"unknown",a=!(0,J.TA)(s)&&s.NodeId?(0,ee.a3)(s.NodeId):void 0;return(0,_.jsx)(c.A,{name:l,path:a,hasClipboardButton:!0,showStatus:!1})},width:400,align:b.ZP.LEFT},{name:"Endpoints",sortable:!1,render:e=>{let{row:t}=e;return t.Endpoints?t.Endpoints.map((e=>{let{Name:t,Address:s}=e;return`${t} ${s}`})).join(", "):"-"},width:300,align:b.ZP.LEFT},{name:"Uptime",header:"Uptime",sortAccessor:e=>{let{StartTime:t}=e;return t&&-t},width:120,align:b.ZP.LEFT,render:e=>{let{row:t}=e;return t.Uptime}},{name:"MemoryUsed",header:"Memory used",sortAccessor:e=>{let{MemoryUsed:t=0}=e;return Number(t)},defaultOrder:b.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.MemoryUsed?(0,B.td)(t.MemoryUsed):"\u2014"},width:120,align:b.ZP.RIGHT},{name:"MemoryLimit",header:"Memory limit",sortAccessor:e=>{let{MemoryLimit:t=0}=e;return Number(t)},defaultOrder:b.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.MemoryLimit?(0,B.td)(t.MemoryLimit):"\u2014"},width:120,align:b.ZP.RIGHT},{name:"PoolStats",header:"Pools",sortAccessor:e=>{let{PoolStats:t=[]}=e;return t.reduce(((e,t)=>e+(t.Usage||0)),0)},defaultOrder:b.ZP.DESCENDING,width:80,resizeMinWidth:60,render:e=>{let{row:t}=e;return t.PoolStats?(0,_.jsx)(C.m,{pools:t.PoolStats}):"\u2014"},align:b.ZP.LEFT},{name:"LoadAverage",header:"Load average",sortAccessor:e=>{let{LoadAveragePercents:t=[]}=e;return t[0]},defaultOrder:b.ZP.DESCENDING,width:140,resizeMinWidth:140,render:e=>{let{row:t}=e;return t.LoadAveragePercents&&t.LoadAveragePercents.length>0?(0,_.jsx)(Y.y,{value:t.LoadAveragePercents[0],percents:!0,capacity:100,colorizeProgress:!0}):"\u2014"},align:b.ZP.LEFT}],se=e=>{let{nodes:t}=e;return(0,_.jsx)(k.G,{columnsWidthLSKey:"versionsTableColumnsWidth",data:t,columns:te,settings:Z.LE})};var ne=s(84893),le=s(90861);const ae=(0,p.cn)("ydb-versions-nodes-tree-title"),re=e=>{let t,{title:s,nodes:n,items:l,versionColor:a,versionsValues:r}=e;return t=l?l.reduce(((e,t)=>t.nodes?e+t.nodes.length:e),0):n?n.length:0,(0,_.jsxs)("div",{className:ae("overview"),children:[(0,_.jsxs)("div",{className:ae("overview-container"),children:[a?(0,_.jsx)("div",{className:ae("version-color"),style:{background:a}}):null,s?(0,_.jsxs)("span",{className:ae("overview-title"),children:[s,(0,_.jsx)(le.m,{text:s,size:"s",className:ae("clipboard-button")})]}):null]}),(0,_.jsxs)("div",{className:ae("overview-info"),children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:ae("info-value"),children:t}),(0,_.jsx)("span",{className:ae("info-label",{margin:"left"}),children:"Nodes"})]}),r?(0,_.jsxs)("div",{className:ae("version-progress"),children:[(0,_.jsx)("span",{className:ae("info-label",{margin:"right"}),children:"Versions"}),(0,_.jsx)(ne.E,{size:"s",value:100,stack:r})]}):null]})]})},oe=(0,p.cn)("ydb-versions-grouped-node-tree"),ie=e=>{let{title:t,nodes:s,items:l,expanded:a=!1,versionColor:r,versionsValues:o,level:i=0}=e;const[d,c]=n.useState(!1);n.useEffect((()=>{c(a)}),[a]);const u=(0,_.jsx)(re,{title:t,nodes:s,items:l,versionColor:r,versionsValues:o}),v=()=>{c((e=>!e))};return l?(0,_.jsx)("div",{className:oe({"first-level":0===i}),children:(0,_.jsx)(K.L,{name:u,collapsed:!d,hasArrow:!0,onClick:v,onArrowClick:v,children:l.map(((e,t)=>(0,_.jsx)(ie,{title:e.title,nodes:e.nodes,expanded:a,versionColor:e.versionColor,level:i+1},t)))},t)}):(0,_.jsx)("div",{className:oe({"first-level":0===i}),children:(0,_.jsx)(K.L,{name:u,collapsed:!d,hasArrow:!0,onClick:v,onArrowClick:v,children:(0,_.jsx)("div",{className:oe("dt-wrapper"),children:(0,_.jsx)(se,{nodes:s||[]})})},t)})};var de=s(46754),ce=s.n(de),ue=s(30601);const ve=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const s=e.reduce(((e,t)=>(t.Version&&(e[t.Version]?e[t.Version]=e[t.Version]+1:e[t.Version]=1),e)),{});return Object.keys(s).map((n=>({title:n,version:n,color:null===t||void 0===t?void 0:t.get((0,ue.H)(n)),value:s[n]/e.length*100})))};function me(e,t,s){const n=null!==s&&void 0!==s?s:e.reduce(((e,t)=>e+t.count),0);return e.map((e=>({title:e.name,version:e.name,color:null===t||void 0===t?void 0:t.get(e.name),value:e.count/n*100})))}let he;!function(e){e.VERSION="Version",e.TENANT="Database",e.STORAGE="Storage"}(he||(he={}));const pe=(e,t)=>{var s;return(null===(s=e.title)||void 0===s?void 0:s.localeCompare(t.title||""))||-1},xe=(0,p.cn)("ydb-versions"),ge=e=>{let{versionToColor:t}=e;const[s]=(0,x.Rj)(),{currentData:l,isLoading:a}=X.k.useGetNodesQuery({tablets:!1},{pollingInterval:s}),r=null===l||void 0===l?void 0:l.Nodes,[o,i]=n.useState(he.VERSION),[d,c]=n.useState(!1),u=e=>{i(e)};if(a)return(0,_.jsx)(Q.a,{});const v=((e,t,s)=>{if(e&&e.length){if(s===he.VERSION){const s=ce()(e,"Version");return Object.keys(s).map((e=>{const n=s[e].filter((e=>{let{Tenants:t}=e;return Boolean(t)})),l=ce()(n,"Tenants"),a=Object.keys(l).map((e=>({title:e,nodes:l[e]}))).sort(pe);return a.length?{title:e,items:a,versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))}:null})).filter((e=>Boolean(e)))}{const s=e.filter((e=>{let{Tenants:t}=e;return Boolean(t)})),n=ce()(s,"Tenants");return Object.keys(n).map((e=>{const s=ve(n[e],t),l=ce()(n[e],"Version"),a=Object.keys(l).map((e=>({title:e,nodes:l[e],versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))})));return a.length?{title:e,items:a,versionsValues:s}:null})).filter((e=>Boolean(e))).sort(pe)}}})(r,t,o),m=((e,t)=>{if(!e||!e.length)return;const s=e.filter((e=>{let{Roles:t}=e;return null===t||void 0===t?void 0:t.includes("Storage")})),n=ce()(s,"Version");return Object.keys(n).map((e=>({title:e,nodes:n[e],versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))})))})(r,t),h=((e,t)=>{if(!e||!e.length)return;const s=e.filter((e=>{let{Roles:t}=e;return!t})),n=ce()(s,"Version");return Object.keys(n).map((e=>({title:e,nodes:n[e],versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))})))})(r,t),p=null!==m&&void 0!==m&&m.length?(0,_.jsxs)(n.Fragment,{children:[(0,_.jsx)("h3",{children:"Storage nodes"}),m.map((e=>{let{title:t,nodes:s,items:n,versionColor:l}=e;return(0,_.jsx)(ie,{title:t,nodes:s,items:n,versionColor:l},`storage-nodes-${t}`)}))]}):null,g=null!==v&&void 0!==v&&v.length?(0,_.jsxs)(n.Fragment,{children:[(0,_.jsx)("h3",{children:"Database nodes"}),(0,_.jsxs)("div",{className:xe("controls"),children:[(0,_.jsxs)("div",{className:xe("group"),children:[(0,_.jsx)("span",{className:xe("label"),children:"Group by:"}),(0,_.jsxs)(U.E,{value:o,onUpdate:u,children:[(0,_.jsx)(U.E.Option,{value:he.TENANT,children:he.TENANT}),(0,_.jsx)(U.E.Option,{value:he.VERSION,children:he.VERSION})]})]}),(0,_.jsx)(W.X,{className:xe("checkbox"),onChange:()=>c((e=>!e)),checked:d,children:"All expanded"})]}),v.map((e=>{let{title:t,nodes:s,items:n,versionColor:l,versionsValues:a}=e;return(0,_.jsx)(ie,{title:t,nodes:s,items:n,expanded:d,versionColor:l,versionsValues:a},`tenant-nodes-${t}`)}))]}):null,N=null!==h&&void 0!==h&&h.length?(0,_.jsxs)(n.Fragment,{children:[(0,_.jsx)("h3",{children:"Other nodes"}),h.map((e=>{let{title:t,nodes:s,items:n,versionColor:l,versionsValues:a}=e;return(0,_.jsx)(ie,{title:t,nodes:s,items:n,versionColor:l,versionsValues:a},`other-nodes-${t}`)}))]}):null;return(0,_.jsxs)("div",{className:xe("versions"),children:[p,g,N]})};var Ne=s(23373),je=s(91816);const be=(0,p.cn)("cluster-info");var fe=s(17095),we=s(32270),ye=s(94790),Ee=s(42784),Ce=s(27506);const Te=(0,p.cn)("tablet"),ke=e=>{var t;let{tablet:s={},tenantName:n}=e;const{TabletId:l,NodeId:a,Type:r}=s,o=null===(t=s.Overall)||void 0===t?void 0:t.toLowerCase(),i=l&&(0,v.fK)(l,{nodeId:a,tenantName:n,type:r});return(0,_.jsx)(ye.f,{className:Te("wrapper"),content:(0,_.jsx)(Ce.Fb,{data:s,className:Te("popup-content")}),children:(0,_.jsx)(u.h,{to:i,children:(0,_.jsx)(Ee.v,{className:Te({status:o}),text:(0,Z.qV)(s.Type)})})})};var Pe=s(12199),Oe=s(1558),Se=s(28164);const Ae=(0,p.cn)("ydb-cluster-versions-bar"),Le=e=>{let{versionsValues:t=[]}=e;return(0,_.jsxs)("div",{className:Ae(),children:[(0,_.jsx)(ne.E,{value:100,stack:t,size:"s"}),(0,_.jsx)("div",{className:Ae("versions"),children:t.map(((e,s)=>(0,_.jsx)("div",{className:Ae("version-title"),style:{color:e.color},title:e.version,children:`${e.version}${s===t.length-1?"":","}`},e.version)))})]})};var Me=s(30817);const De=JSON.parse('{"disk-type":"Disk Type","erasure":"Erasure","allocated":"Allocated","available":"Available","usage":"Usage","dc":"DC","tablets":"Tablets","databases":"Databases","nodes":"Nodes","nodes-state":"Nodes state","load":"Load","storage-size":"Storage size","storage-groups":"Storage groups, {{diskType}}","links":"Links","versions":"Versions","quantity":{"one":"{{count}} node","other":"{{count}} nodes","zero":"no nodes"}}'),Ve=(0,Me.wZ)("ydb-cluster",{en:De});var Ze=s(62206),ze=s(81854);const Ge=(0,p.cn)("ydb-disk-groups-stats"),Ie=e=>{let{stats:t}=e;return(0,_.jsx)("div",{className:Ge(),children:Object.values(t).map((e=>(0,_.jsx)(ye.f,{placement:["right"],content:(0,_.jsx)(Re,{stats:e}),children:(0,_.jsx)(Y.y,{className:Ge("bar"),value:e.createdGroups,capacity:e.totalGroups})},e.erasure)))})};function Re(e){let{stats:t}=e;const{diskType:s,erasure:n,allocatedSize:l,availableSize:a}=t,r=(0,ze.dT)(Math.max(l,a),2),o=(0,ze.td)({value:l,size:r}),i=(0,ze.td)({value:a,size:r}),d=Math.round(l/(l+a)*100),c=[{label:Ve("disk-type"),value:s},{label:Ve("erasure"),value:n},{label:Ve("allocated"),value:o},{label:Ve("available"),value:i},{label:Ve("usage"),value:d+"%"}];return(0,_.jsx)(Ze._P,{dots:!0,info:c,className:Ge("popup-content"),size:"s"})}const Fe=(0,p.cn)("ydb-nodes-state");function Be(e){let{state:t,children:s}=e;return(0,_.jsx)("div",{className:Fe({[t.toLowerCase()]:!0}),children:s})}const $e={Green:5,Blue:4,Yellow:3,Orange:2,Red:1,Grey:0},_e=(e,t)=>e.Type===Se.F.TxAllocator?1:t.Type===Se.F.TxAllocator?-1:0,qe=(e,t,s,l,a)=>{const r=[],o=(e=>{var t;return(0,Oe.j)(e)&&e.MapDataCenters?Object.entries(e.MapDataCenters).map((e=>{let[t,s]=e;return(0,_.jsxs)(n.Fragment,{children:[t,": ",(0,_.jsx)("span",{className:be("dc-count"),children:Ve("quantity",{count:s})})]},t)})):null===(t=e.DataCenters)||void 0===t?void 0:t.filter(Boolean)})(e);if(null!==o&&void 0!==o&&o.length&&r.push({label:Ve("dc"),value:(0,_.jsx)(Pe.$,{tags:o})}),e.SystemTablets){const t=e.SystemTablets.slice(0).sort(_e);r.push({label:Ve("tablets"),value:(0,_.jsx)("div",{className:be("system-tablets"),children:t.map(((e,t)=>(0,_.jsx)(ke,{tablet:e},t)))})})}if(e.Tenants&&r.push({label:Ve("databases"),value:e.Tenants}),r.push({label:Ve("nodes"),value:(0,_.jsx)(Y.y,{value:null===e||void 0===e?void 0:e.NodesAlive,capacity:null===e||void 0===e?void 0:e.NodesTotal})}),(0,Oe.j)(e)&&e.MapNodeStates){const t=Object.entries(e.MapNodeStates);t.sort(((e,t)=>$e[t[0]]-$e[e[0]]));const s=t.map((e=>{let[t,s]=e;return(0,_.jsx)(Be,{state:t,children:s},t)}));r.push({label:Ve("nodes-state"),value:(0,_.jsx)("div",{className:be("nodes-states"),children:s})})}r.push({label:Ve("load"),value:(0,_.jsx)(Y.y,{value:null===e||void 0===e?void 0:e.LoadAverage,capacity:null===e||void 0===e?void 0:e.NumberOfCpus})});const i=(e=>{if((0,Oe.j)(e)&&e.MapDataCenters){const{MapStorageTotal:t,MapStorageUsed:s}=e,n=new Set(Object.keys(null!==t&&void 0!==t?t:[]).concat(Object.keys(null!==s&&void 0!==s?s:[])));if(n.size>0)return Array.from(n).reduce(((e,n)=>(e[n]={used:null===s||void 0===s?void 0:s[n],total:null===t||void 0===t?void 0:t[n]},e)),{})}return{_default:{used:null===e||void 0===e?void 0:e.StorageUsed,total:null===e||void 0===e?void 0:e.StorageTotal}}})(e);return Object.entries(i).forEach((e=>{let[t,s]=e,n=Ve("storage-size");"_default"!==t&&(n+=`, ${t}`),r.push({label:n,value:(0,_.jsx)(Y.y,{value:s.used,capacity:s.total,formatValues:B.QO})})})),Object.keys(s).length&&r.push(...(e=>Object.keys(e).map((t=>({label:Ve("storage-groups",{diskType:t}),value:(0,_.jsx)(Ie,{stats:e[t]})}))))(s)),r.push(...l,{label:Ve("links"),value:(0,_.jsx)("div",{className:be("links"),children:a.map((e=>{let{title:t,url:s}=e;return(0,_.jsx)(we.j,{title:t,url:s},t)}))})},{label:Ve("versions"),value:(0,_.jsx)(Le,{versionsValues:t.filter((e=>"unknown"!==e.title))})}),r},He=e=>{let{cluster:t,versionToColor:s,groupsStats:l={},loading:a,error:r,additionalClusterProps:o={}}=e;const i=(0,x.ix)((e=>e.singleClusterMode)),d=((e,t)=>{const{currentData:s}=X.k.useGetNodesQuery((0,Oe.j)(e)?fe.CN:{tablets:!1,group:"Version"});return n.useMemo((()=>(0,Oe.j)(e)&&e.MapVersions?me(Object.entries(e.MapVersions).map((e=>{let[t,s]=e;return{name:t,count:s}})),t,e.NodesTotal):s?Array.isArray(s.NodeGroups)?me(s.NodeGroups,t,null===e||void 0===e?void 0:e.NodesTotal):ve(s.Nodes,t):[]),[s,t,e])})(t,s);let c=S.y3+"/internal";i&&!S.j4&&(c="/internal");const{info:u=[],links:v=[]}=o,m=qe(null!==t&&void 0!==t?t:{},d,l,u,[{title:Z.Ah,url:c},...v]);return(0,_.jsxs)("div",{className:be(),children:[r?(0,_.jsx)(y.V,{error:r,className:be("error")}):null,(0,_.jsx)("div",{className:be("info"),children:a?(0,_.jsx)(je.b,{className:be("skeleton"),rows:9}):r&&!t?null:(0,_.jsx)(Ne._,{dots:!0,info:m})})]})};var Ue=s(81003);const We=(0,p.cn)("cluster");function Qe(e){let{additionalClusterProps:t,additionalTenantsProps:s,additionalNodesProps:p,additionalVersionsProps:b}=e;const f=n.useRef(null),w=(0,x.zL)(),y=function(){const e=(0,x.zL)(),t=(0,x.ix)((e=>e.cluster.defaultClusterTab)),s=(0,o.$B)(v.ZP.cluster),{activeTab:l}=(null===s||void 0===s?void 0:s.params)||{};let a;a=(0,Ue.V2)(l)?l:t;return n.useEffect((()=>{a!==t&&e((0,m.LQ)(a))}),[a,t,e]),a}(),[{clusterName:E,backend:C}]=(0,i.useQueryParams)({clusterName:i.StringParam,backend:i.StringParam}),T=(0,x.ix)((e=>(0,m.le)(e,null!==E&&void 0!==E?E:void 0))),{data:{clusterData:k={},groupsStats:P}={},isLoading:O,error:S}=m.UM.useGetClusterInfoQuery(null!==E&&void 0!==E?E:void 0),A=S&&"object"===typeof S?S:void 0;n.useEffect((()=>{w((0,h.J)("cluster",{}))}),[w]);const L=n.useMemo((()=>null!==b&&void 0!==b&&b.getVersionToColorMap?null===b||void 0===b?void 0:b.getVersionToColorMap():(0,g.ZP)(null===k||void 0===k?void 0:k.Versions)),[b,k]),M=n.useMemo((()=>Ue._Y.find((e=>{let{id:t}=e;return t===y}))),[y]);return(0,_.jsxs)("div",{className:We(),ref:f,children:[(0,_.jsx)(r.ql,{defaultTitle:`${T} \u2014 YDB Monitoring`,titleTemplate:`%s \u2014 ${T} \u2014 YDB Monitoring`,children:M?(0,_.jsx)("title",{children:M.title}):null}),(0,_.jsx)("div",{className:We("header"),children:O?(0,_.jsx)(l.O,{className:We("title-skeleton")}):(0,_.jsx)(c.A,{size:"m",status:null===k||void 0===k?void 0:k.Overall,name:T,className:We("title")})}),(0,_.jsx)("div",{className:We("tabs"),children:(0,_.jsx)(a.m,{size:"l",allowNotSelected:!0,activeTab:y,items:Ue._Y,wrapTo:(e,t)=>{let{id:s}=e;const n=(0,Ue.B7)(s,{clusterName:E,backend:C});return(0,_.jsx)(u.h,{to:n,onClick:()=>{w((0,m.LQ)(s))},children:t},s)}})}),(0,_.jsx)("div",{className:We("sticky-wrapper"),children:(0,_.jsx)(d.q,{className:We("auto-refresh-control")})}),(0,_.jsxs)(o.rs,{children:[(0,_.jsx)(o.AW,{path:(0,v.Fz)((0,Ue.B7)(Ue.xu.overview)).pathname,children:(0,_.jsx)(He,{cluster:k,groupsStats:P,versionToColor:L,loading:O,error:A,additionalClusterProps:t})}),(0,_.jsx)(o.AW,{path:(0,v.Fz)((0,Ue.B7)(Ue.xu.tenants)).pathname,children:(0,_.jsx)(H,{additionalTenantsProps:s})}),(0,_.jsx)(o.AW,{path:(0,v.Fz)((0,Ue.B7)(Ue.xu.nodes)).pathname,children:(0,_.jsx)(N.G,{parentContainer:f.current,additionalNodesProps:p})}),(0,_.jsx)(o.AW,{path:(0,v.Fz)((0,Ue.B7)(Ue.xu.storage)).pathname,children:(0,_.jsx)(j.V,{parentContainer:f.current,additionalNodesProps:p})}),(0,_.jsx)(o.AW,{path:(0,v.Fz)((0,Ue.B7)(Ue.xu.versions)).pathname,children:(0,_.jsx)(ge,{versionToColor:L})}),(0,_.jsx)(o.AW,{render:()=>(0,_.jsx)(o.l_,{to:(0,v.Fz)((0,Ue.B7)(y))})})]})]})}},57225:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(68963);const l=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 2.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8.75 5a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 0 1.5 0V5Z",clipRule:"evenodd"}))},67585:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(68963);const l=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm1-9.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8 7.75a.75.75 0 0 1 .75.75V11a.75.75 0 0 1-1.5 0V8.5A.75.75 0 0 1 8 7.75Z",clipRule:"evenodd"}))},71549:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(68963);const l=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m3.003 4.702 4.22-2.025a1.796 1.796 0 0 1 1.554 0l4.22 2.025a.886.886 0 0 1 .503.8V6a8.55 8.55 0 0 1-3.941 7.201l-.986.631a1.063 1.063 0 0 1-1.146 0l-.986-.63A8.55 8.55 0 0 1 2.5 6v-.498c0-.341.196-.652.503-.8Zm3.57-3.377L2.354 3.35A2.387 2.387 0 0 0 1 5.502V6a10.05 10.05 0 0 0 4.632 8.465l.986.63a2.563 2.563 0 0 0 2.764 0l.986-.63A10.05 10.05 0 0 0 15 6v-.498c0-.918-.526-1.755-1.354-2.152l-4.22-2.025a3.296 3.296 0 0 0-2.852 0ZM9.5 7a1.5 1.5 0 0 1-.75 1.3v1.95a.75.75 0 0 1-1.5 0V8.3A1.5 1.5 0 1 1 9.5 7Z",clipRule:"evenodd"}))},71586:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(68963);const l=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.836 2.244c.962-1.665 3.366-1.665 4.328 0l4.917 8.505c.964 1.666-.239 3.751-2.164 3.751H3.083c-1.925 0-3.128-2.085-2.164-3.751l4.917-8.505ZM8 5a.75.75 0 0 1 .75.75v2a.75.75 0 1 1-1.5 0v-2A.75.75 0 0 1 8 5Zm1 5.75a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z",clipRule:"evenodd"}))},48897:(e,t,s)=>{"use strict";s.d(t,{X:()=>d});var n=s(68963),l=s(33180),a=s(24288);function r(e){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 17",width:"16",height:"16",fill:"currentColor"},e),n.createElement("path",{d:"M4 7h9v3H4z"}))}function o(e){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 10",width:"16",height:"16",fill:"currentColor"},e),n.createElement("path",{d:"M.49 5.385l1.644-1.644 4.385 4.385L4.874 9.77.49 5.385zm4.384 1.096L10.356 1 12 2.644 6.519 8.126 4.874 6.48v.001z"}))}const i=(0,s(36951).Ge)("checkbox"),d=n.forwardRef((function(e,t){const{size:s="m",indeterminate:d,disabled:c=!1,content:u,children:v,title:m,style:h,className:p,qa:x}=e,{checked:g,inputProps:N}=(0,l.O)(e),j=u||v,b=n.createElement("span",{className:i("indicator")},n.createElement("span",{className:i("icon"),"aria-hidden":!0},d?n.createElement(r,{className:i("icon-svg",{type:"dash"})}):n.createElement(o,{className:i("icon-svg",{type:"tick"})})),n.createElement("input",Object.assign({},N,{className:i("control")})),n.createElement("span",{className:i("outline")}));return n.createElement(a.J,{ref:t,title:m,style:h,size:s,disabled:c,className:i({size:s,disabled:c,indeterminate:d,checked:g},p),qa:x,control:b},j)}))},84893:(e,t,s)=>{"use strict";s.d(t,{E:()=>u});var n=s(68963);const l=(0,s(36951).Ge)("progress");function a(e){const{text:t,offset:s=0}=e;return t?n.createElement("div",{className:l("text-inner"),style:{transform:`translateX(calc(var(--g-flow-direction) * ${-s}%))`}},t):null}function r(e){let{item:t}=e;const{value:s,color:a,className:r,theme:o,title:i,content:d,loading:c}=t,u={loading:c};return"undefined"===typeof a&&(u.theme=o||"default"),Number.isFinite(s)?n.createElement("div",{className:l("item",u,r),style:{width:`${s}%`,backgroundColor:a},title:i},d):null}function o(e){return e<100?e-100:0}function i(e){const{theme:t,colorStops:s,colorStopsValue:n,value:l}=e;if(s){const e=s.find(((e,t)=>{const a="number"===typeof n?n:l,r=t>1?s[t-1].stop:0,o=t<s.length-1?e.stop:100;return a>=r&&a<=o}));return e?e.theme:t}return t}function d(e){const{stack:t,stackClassName:s,value:i,text:d}=e,c=o(i||function(e){return e.reduce(((e,t)=>{let{value:s}=t;return e+s}),0)}(t));return n.createElement("div",{className:l("stack",s),style:{transform:`translateX(calc(var(--g-flow-direction) * ${c}%))`}},n.createElement("div",{className:l("item"),style:{width:-c+"%"}}),t.map(((e,t)=>n.createElement(r,{key:t,item:e}))),n.createElement(a,{offset:c,text:d}))}function c(e){const{value:t,loading:s,text:r}=e,d=o(t);return Number.isFinite(t)?n.createElement("div",{className:l("item",{theme:i(e),loading:s}),style:{transform:`translateX(calc(var(--g-flow-direction) * ${d}%))`}},n.createElement(a,{offset:d,text:r})):null}const u=n.forwardRef((function(e,t){const{text:s="",theme:a="default",size:r="m",loading:o=!1,className:i,qa:u}=e,v=Object.assign(Object.assign({},e),{text:s,theme:a,size:r,loading:o});return n.createElement("div",{ref:t,className:l({size:r},i),"data-qa":u},n.createElement("div",{className:l("text")},s),function(e){return void 0!==e.stack}(v)?n.createElement(d,Object.assign({},v)):n.createElement(c,Object.assign({},v)))}))},56711:(e,t,s)=>{"use strict";s.d(t,{O:()=>a});var n=s(68963);const l=(0,s(36951).Ge)("skeleton");function a(e){let{className:t,style:s,qa:a}=e;return n.createElement("div",{className:l(null,t),style:s,"data-qa":a})}},27320:(e,t,s)=>{"use strict";s.d(t,{u:()=>c});var n=s(68963),l=s(48027),a=s(79004),r=s(44920),o=s(10288);const i=(0,s(36951).Ge)("tooltip"),d=["bottom","top"],c=e=>{const{children:t,content:s,disabled:c,placement:u=d,qa:v,id:m,className:h,style:p,disablePortal:x,contentClassName:g,openDelay:N=1e3,closeDelay:j}=e,[b,f]=n.useState(null),w=(0,a.p)(b,{openDelay:N,closeDelay:j,preventTriggerOnFocus:!0}),y=n.Children.only(t),E=y.ref,C=(0,l.c)(f,E);return n.createElement(n.Fragment,null,n.cloneElement(y,{ref:C}),b?n.createElement(r.G,{id:m,role:"tooltip",className:i(null,h),style:p,open:w&&!c,placement:u,anchorRef:{current:b},disablePortal:x,disableEscapeKeyDown:!0,disableOutsideClick:!0,disableLayer:!0,qa:v},n.createElement("div",{className:i("content",g)},n.createElement(o.x,{variant:"body-short",color:"complementary"},s))):null)}},56829:(e,t,s)=>{"use strict";s.d(t,{F:()=>l});var n=s(40797);function l(){return(0,n.T)().theme}},38626:e=>{e.exports=function(e,t,s,n){for(var l=-1,a=null==e?0:e.length;++l<a;){var r=e[l];t(n,r,s(r),e)}return n}},30277:(e,t,s)=>{var n=s(46067);e.exports=function(e,t,s,l){return n(e,(function(e,n,a){t(l,e,s(e),a)})),l}},81670:(e,t,s)=>{var n=s(38626),l=s(30277),a=s(67173),r=s(46296);e.exports=function(e,t){return function(s,o){var i=r(s)?n:l,d=t?t():{};return i(s,e,a(o,2),d)}}},46754:(e,t,s)=>{var n=s(69519),l=s(81670),a=Object.prototype.hasOwnProperty,r=l((function(e,t,s){a.call(e,s)?e[s].push(t):n(e,s,[t])}));e.exports=r},40067:(e,t,s)=>{"use strict";s.d(t,{L:()=>d});var n=s(75859),l=s(68963),a=s(30831),r=s(99879);const o="--ydb-tree-view-level",i=(0,r.G)("ydb-tree-view");function d(e){let{children:t,name:s,title:r,icon:d,collapsed:c=!0,active:u=!1,onClick:v,onArrowClick:m,hasArrow:h=!1,actions:p,additionalNodeElements:x,level:g}=e;const N=l.useCallback((e=>{if(!v)return;e.nativeEvent.composedPath().some((e=>e instanceof HTMLElement&&("BUTTON"===e.nodeName&&!e.hasAttribute("disabled")||e.hasAttribute("tabindex")&&e.tabIndex>-1)))||v()}),[v]),j=m||v;let b="tree-view_arrow",f="tree-view_children";return c&&(b+=" tree-view_arrow-collapsed",f+=" tree-view_children-collapsed"),(0,n.jsx)("div",{className:i(),style:{[o]:g},children:(0,n.jsxs)("div",{className:"tree-view",children:[(0,n.jsxs)("div",{className:`tree-view_item ${i("item",{active:u})}`,onClick:N,children:[(0,n.jsx)("button",{type:"button",className:`${b} ${i("arrow",{collapsed:c,hidden:!h})}`,disabled:!j,onClick:j}),(0,n.jsxs)("div",{className:i("content"),children:[d&&(0,n.jsx)("div",{className:i("icon"),children:d}),(0,n.jsx)("div",{className:i("text"),title:r,children:s}),p&&p.length>0&&(0,n.jsxs)("div",{className:i("actions"),children:[x,(0,n.jsx)(a.h,{defaultSwitcherProps:{view:"flat-secondary",size:"s",pin:"brick-brick"},items:p})]})]})]}),(0,n.jsx)("div",{className:`${f} ${i("container",{collapsed:c})}`,children:c?null:t})]})})}},99879:(e,t,s)=>{"use strict";s.d(t,{G:()=>n});const n=(0,s(5247).withNaming)({e:"__",m:"_"})}}]);