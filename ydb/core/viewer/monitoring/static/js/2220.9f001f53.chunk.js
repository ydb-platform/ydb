(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[2220],{91816:(e,t,s)=>{"use strict";s.d(t,{b:()=>d});var n=s(68963),a=s(56711),l=s(24362),r=s(42587),o=s(75859);const i=(0,l.cn)("ydb-info-viewer-skeleton"),c=()=>(0,o.jsxs)("div",{className:i("label"),children:[(0,o.jsx)(a.O,{className:i("label__text")}),(0,o.jsx)("div",{className:i("label__dots")})]}),d=e=>{let{rows:t=8,className:s,delay:l=600}=e;const[d]=(0,r.$)(l);let u=(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(c,{}),(0,o.jsx)(a.O,{className:i("value")})]});return d||(u=null),(0,o.jsx)("div",{className:i(null,s),children:[...new Array(t)].map(((e,t)=>(0,o.jsx)("div",{className:i("row"),children:u},"skeleton-row-".concat(t))))})}},12199:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var n=s(24362),a=s(75859);const l=(0,n.cn)("tag"),r=e=>{let{text:t,type:s}=e;return(0,a.jsx)("div",{className:l({type:s}),children:t})},o=(0,n.cn)("tags"),i=e=>{let{tags:t,tagsType:s,className:n=""}=e;return(0,a.jsx)("div",{className:o(null,n),children:t&&t.map(((e,t)=>(0,a.jsx)(r,{text:e,type:s},t)))})}},75807:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Cluster:()=>Be});var n=s(68963),a=s(56711),l=s(8179),r=s(49352),o=s(86974),i=s(52846),c=s(50422),d=s(69214),u=s(74170),m=s(54665),v=s(77915),h=s(79061),p=s(24362),g=s(17096),x=s(94076),N=s(96027),j=s(80588),b=s(19812),f=s(17176),w=s(36985),y=s(26688),E=s(56350),C=s(68242),T=s(74221),k=s(2098),P=s(11551),S=s(47101),O=s(27102),A=s(80839),L=s(36313),D=s(43680),V=s.n(D),Z=s(75850),z=s(52317),G=s(53809);const M=(0,L.P1)((e=>e),(e=>G.Xv.endpoints.getTenantsInfo.select({clusterName:e}))),I=(0,L.P1)((e=>e),((e,t)=>M(t)),(e=>(0,A.Cx)(e,z.Zy)),((e,t,s)=>{var n;const a=null!==(n=t(e).data)&&void 0!==n?n:[];return!s&&a.length>1?a.filter((e=>"Domain"!==e.Type)):a})),R=e=>e.tenants.searchValue,F=(0,L.P1)([I,A.qz,R],((e,t,s)=>{let n=((e,t)=>t===A.pu.ALL?e:e.filter((e=>e.Overall&&e.Overall!==Z.K.Green)))(e,t);return n=((e,t)=>e.filter((e=>{const s=new RegExp(V()(t),"i");return s.test(e.Name||"")||s.test(e.controlPlaneName)})))(n,s),n}));var B=s(34301),_=s(95478),q=s(75859);const H=(0,p.cn)("tenants"),U=e=>{let{additionalTenantsProps:t}=e;const s=(0,g.zL)(),[a]=(0,g.Rj)(),{currentData:l,isFetching:r,error:o}=G.Xv.useGetTenantsInfoQuery({clusterName:O.qw},{pollingInterval:a}),i=r&&void 0===l,c=(0,g.ix)((e=>I(e,O.qw))),u=(0,g.ix)(R),m=(0,g.ix)((e=>F(e,O.qw))),v=(0,g.ix)(A.qz),h=e=>{s((0,A.M6)(e))},p=e=>{s((0,G.gI)(e))};return(0,q.jsxs)(S.l,{children:[(0,q.jsx)(S.l.Controls,{children:(0,q.jsxs)(n.Fragment,{children:[(0,q.jsx)(P.o,{value:u,onChange:p,placeholder:"Database name",className:H("search")}),(0,q.jsx)(T.T,{value:v,onChange:h}),(0,q.jsx)(w.C,{total:c.length,current:(null===m||void 0===m?void 0:m.length)||0,label:"Databases",loading:i})]})}),o?(0,q.jsx)(y.V,{error:o}):null,(0,q.jsx)(S.l.Table,{loading:i,children:l?(()=>{const e=[{name:"Name",header:"Database",render:e=>{var s;let{row:n}=e;const a=(e=>{var s,n;const a=null!==(s=e.MonitoringEndpoint)&&void 0!==s?s:e.backend;return null===t||void 0===t||null===(n=t.prepareTenantBackend)||void 0===n?void 0:n.call(t,a)})(n),l=Boolean(a);return(0,q.jsx)(d.A,{externalLink:l,className:H("name"),name:n.Name||"unknown database",withLeftTrim:!0,status:n.Overall,hasClipboardButton:!0,path:(0,_.Sj)({name:n.Name,backend:a}),additionalControls:null===t||void 0===t||null===(s=t.getMonitoringLink)||void 0===s?void 0:s.call(t,n.Name,n.Type)})},width:440,sortable:!0,defaultOrder:b.ZP.DESCENDING},{name:"controlPlaneName",header:"Name",render:e=>{let{row:t}=e;return t.controlPlaneName},width:200,sortable:!0,defaultOrder:b.ZP.DESCENDING},{name:"Type",width:200,resizeMinWidth:150,render:e=>{let{row:t}=e;return"Serverless"!==t.Type?t.Type:(0,q.jsxs)("div",{className:H("type"),children:[(0,q.jsx)("span",{className:H("type-value"),children:t.Type}),(0,q.jsx)(f.z,{className:H("type-button"),onClick:()=>p(t.sharedTenantName||""),children:"Show shared"})]})}},{name:"State",width:90,render:e=>{let{row:t}=e;return t.State?t.State.toLowerCase():"\u2014"},customStyle:()=>({textTransform:"capitalize"})},{name:"cpu",header:"CPU",width:80,render:e=>{let{row:t}=e;return t.cpu&&t.cpu>1e4?(0,B.LO)(t.cpu):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"memory",header:"Memory",width:120,render:e=>{let{row:t}=e;return t.memory?(0,B.q3)(t.memory):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"storage",header:"Storage",width:120,render:e=>{let{row:t}=e;return t.storage?(0,B.q3)(t.storage):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"nodesCount",header:"Nodes",width:100,render:e=>{let{row:t}=e;return t.nodesCount?(0,B.uf)(t.nodesCount):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"groupsCount",header:"Groups",width:100,render:e=>{let{row:t}=e;return t.groupsCount?(0,B.uf)(t.groupsCount):"\u2014"},align:b.ZP.RIGHT,defaultOrder:b.ZP.DESCENDING},{name:"PoolStats",header:"Pools",width:100,resizeMinWidth:60,sortAccessor:e=>{let{PoolStats:t=[]}=e;return t.reduce(((e,t)=>e+(t.Usage||0)),0)},defaultOrder:b.ZP.DESCENDING,align:b.ZP.LEFT,render:e=>{let{row:t}=e;return(0,q.jsx)(C.m,{pools:t.PoolStats})}}];return 0===m.length&&v!==A.pu.ALL?(0,q.jsx)(E.Q,{name:"thumbsUp",width:"200"}):(0,q.jsx)(k.G,{columnsWidthLSKey:"databasesTableColumnsWidth",data:m,columns:e,settings:z.LE,emptyDataMessage:"No such tenants"})})():null})]})};var W=s(79734),Q=s(48897),X=s(62776),K=s(3534),J=s(40067),Y=s(67359),$=s(51688),ee=s(92398);const te=[{name:"NodeId",header:"#",width:80,resizeMinWidth:80,align:b.ZP.LEFT,render:e=>{let{row:t}=e;return t.NodeId}},{name:"Host",render:e=>{var t;let{row:s}=e;const n=s.Endpoints&&(null===(t=s.Endpoints.find((e=>"http-mon"===e.Name)))||void 0===t?void 0:t.Address),a=s.Host&&"".concat(s.Host).concat(n||"")||"unknown",l=!(0,$.TA)(s)&&s.NodeId?(0,ee.a3)(s.NodeId):void 0;return(0,q.jsx)(d.A,{name:a,path:l,hasClipboardButton:!0,showStatus:!1})},width:400,align:b.ZP.LEFT},{name:"Endpoints",sortable:!1,render:e=>{let{row:t}=e;return t.Endpoints?t.Endpoints.map((e=>{let{Name:t,Address:s}=e;return"".concat(t," ").concat(s)})).join(", "):"-"},width:300,align:b.ZP.LEFT},{name:"Uptime",header:"Uptime",sortAccessor:e=>{let{StartTime:t}=e;return t&&-t},width:120,align:b.ZP.LEFT,render:e=>{let{row:t}=e;return t.Uptime}},{name:"MemoryUsed",header:"Memory used",sortAccessor:e=>{let{MemoryUsed:t=0}=e;return Number(t)},defaultOrder:b.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.MemoryUsed?(0,B.td)(t.MemoryUsed):"\u2014"},width:120,align:b.ZP.RIGHT},{name:"MemoryLimit",header:"Memory limit",sortAccessor:e=>{let{MemoryLimit:t=0}=e;return Number(t)},defaultOrder:b.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.MemoryLimit?(0,B.td)(t.MemoryLimit):"\u2014"},width:120,align:b.ZP.RIGHT},{name:"PoolStats",header:"Pools",sortAccessor:e=>{let{PoolStats:t=[]}=e;return t.reduce(((e,t)=>e+(t.Usage||0)),0)},defaultOrder:b.ZP.DESCENDING,width:80,resizeMinWidth:60,render:e=>{let{row:t}=e;return t.PoolStats?(0,q.jsx)(C.m,{pools:t.PoolStats}):"\u2014"},align:b.ZP.LEFT},{name:"LoadAverage",header:"Load average",sortAccessor:e=>{let{LoadAveragePercents:t=[]}=e;return t[0]},defaultOrder:b.ZP.DESCENDING,width:140,resizeMinWidth:140,render:e=>{let{row:t}=e;return t.LoadAveragePercents&&t.LoadAveragePercents.length>0?(0,q.jsx)(Y.y,{value:t.LoadAveragePercents[0],percents:!0,capacity:100,colorizeProgress:!0}):"\u2014"},align:b.ZP.LEFT}],se=e=>{let{nodes:t}=e;return(0,q.jsx)(k.G,{columnsWidthLSKey:"versionsTableColumnsWidth",data:t,columns:te,settings:z.LE})};var ne=s(84893),ae=s(90861);const le=(0,p.cn)("ydb-versions-nodes-tree-title"),re=e=>{let t,{title:s,nodes:n,items:a,versionColor:l,versionsValues:r}=e;return t=a?a.reduce(((e,t)=>t.nodes?e+t.nodes.length:e),0):n?n.length:0,(0,q.jsxs)("div",{className:le("overview"),children:[(0,q.jsxs)("div",{className:le("overview-container"),children:[l?(0,q.jsx)("div",{className:le("version-color"),style:{background:l}}):null,s?(0,q.jsxs)("span",{className:le("overview-title"),children:[s,(0,q.jsx)(ae.m,{text:s,size:"s",className:le("clipboard-button")})]}):null]}),(0,q.jsxs)("div",{className:le("overview-info"),children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("span",{className:le("info-value"),children:t}),(0,q.jsx)("span",{className:le("info-label",{margin:"left"}),children:"Nodes"})]}),r?(0,q.jsxs)("div",{className:le("version-progress"),children:[(0,q.jsx)("span",{className:le("info-label",{margin:"right"}),children:"Versions"}),(0,q.jsx)(ne.E,{size:"s",value:100,stack:r})]}):null]})]})},oe=(0,p.cn)("ydb-versions-grouped-node-tree"),ie=e=>{let{title:t,nodes:s,items:a,expanded:l=!1,versionColor:r,versionsValues:o,level:i=0}=e;const[c,d]=n.useState(!1);n.useEffect((()=>{d(l)}),[l]);const u=(0,q.jsx)(re,{title:t,nodes:s,items:a,versionColor:r,versionsValues:o}),m=()=>{d((e=>!e))};return a?(0,q.jsx)("div",{className:oe({"first-level":0===i}),children:(0,q.jsx)(J.L,{name:u,collapsed:!c,hasArrow:!0,onClick:m,onArrowClick:m,children:a.map(((e,t)=>(0,q.jsx)(ie,{title:e.title,nodes:e.nodes,expanded:l,versionColor:e.versionColor,level:i+1},t)))},t)}):(0,q.jsx)("div",{className:oe({"first-level":0===i}),children:(0,q.jsx)(J.L,{name:u,collapsed:!c,hasArrow:!0,onClick:m,onArrowClick:m,children:(0,q.jsx)("div",{className:oe("dt-wrapper"),children:(0,q.jsx)(se,{nodes:s||[]})})},t)})};var ce=s(46754),de=s.n(ce),ue=s(30601);const me=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const s=e.reduce(((e,t)=>(t.Version&&(e[t.Version]?e[t.Version]=e[t.Version]+1:e[t.Version]=1),e)),{});return Object.keys(s).map((n=>({title:n,version:n,color:null===t||void 0===t?void 0:t.get((0,ue.H)(n)),value:s[n]/e.length*100})))};let ve;!function(e){e.VERSION="Version",e.TENANT="Database",e.STORAGE="Storage"}(ve||(ve={}));const he=(e,t)=>{var s;return(null===(s=e.title)||void 0===s?void 0:s.localeCompare(t.title||""))||-1},pe=(0,p.cn)("ydb-versions"),ge=e=>{let{versionToColor:t}=e;const[s]=(0,g.Rj)(),{currentData:a,isLoading:l}=K.k.useGetNodesQuery({tablets:!1},{pollingInterval:s}),r=null===a||void 0===a?void 0:a.Nodes,[o,i]=n.useState(ve.VERSION),[c,d]=n.useState(!1),u=e=>{i(e)};if(l)return(0,q.jsx)(X.a,{});const m=((e,t,s)=>{if(e&&e.length){if(s===ve.VERSION){const s=de()(e,"Version");return Object.keys(s).map((e=>{const n=s[e].filter((e=>{let{Tenants:t}=e;return Boolean(t)})),a=de()(n,"Tenants"),l=Object.keys(a).map((e=>({title:e,nodes:a[e]}))).sort(he);return l.length?{title:e,items:l,versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))}:null})).filter((e=>Boolean(e)))}{const s=e.filter((e=>{let{Tenants:t}=e;return Boolean(t)})),n=de()(s,"Tenants");return Object.keys(n).map((e=>{const s=me(n[e],t),a=de()(n[e],"Version"),l=Object.keys(a).map((e=>({title:e,nodes:a[e],versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))})));return l.length?{title:e,items:l,versionsValues:s}:null})).filter((e=>Boolean(e))).sort(he)}}})(r,t,o),v=((e,t)=>{if(!e||!e.length)return;const s=e.filter((e=>{let{Roles:t}=e;return null===t||void 0===t?void 0:t.includes("Storage")})),n=de()(s,"Version");return Object.keys(n).map((e=>({title:e,nodes:n[e],versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))})))})(r,t),h=((e,t)=>{if(!e||!e.length)return;const s=e.filter((e=>{let{Roles:t}=e;return!t})),n=de()(s,"Version");return Object.keys(n).map((e=>({title:e,nodes:n[e],versionColor:null===t||void 0===t?void 0:t.get((0,ue.H)(e))})))})(r,t),p=null!==v&&void 0!==v&&v.length?(0,q.jsxs)(n.Fragment,{children:[(0,q.jsx)("h3",{children:"Storage nodes"}),v.map((e=>{let{title:t,nodes:s,items:n,versionColor:a}=e;return(0,q.jsx)(ie,{title:t,nodes:s,items:n,versionColor:a},"storage-nodes-".concat(t))}))]}):null,x=null!==m&&void 0!==m&&m.length?(0,q.jsxs)(n.Fragment,{children:[(0,q.jsx)("h3",{children:"Database nodes"}),(0,q.jsxs)("div",{className:pe("controls"),children:[(0,q.jsxs)("div",{className:pe("group"),children:[(0,q.jsx)("span",{className:pe("label"),children:"Group by:"}),(0,q.jsxs)(W.E,{value:o,onUpdate:u,children:[(0,q.jsx)(W.E.Option,{value:ve.TENANT,children:ve.TENANT}),(0,q.jsx)(W.E.Option,{value:ve.VERSION,children:ve.VERSION})]})]}),(0,q.jsx)(Q.X,{className:pe("checkbox"),onChange:()=>d((e=>!e)),checked:c,children:"All expanded"})]}),m.map((e=>{let{title:t,nodes:s,items:n,versionColor:a,versionsValues:l}=e;return(0,q.jsx)(ie,{title:t,nodes:s,items:n,expanded:c,versionColor:a,versionsValues:l},"tenant-nodes-".concat(t))}))]}):null,N=null!==h&&void 0!==h&&h.length?(0,q.jsxs)(n.Fragment,{children:[(0,q.jsx)("h3",{children:"Other nodes"}),h.map((e=>{let{title:t,nodes:s,items:n,versionColor:a,versionsValues:l}=e;return(0,q.jsx)(ie,{title:t,nodes:s,items:n,versionColor:a,versionsValues:l},"other-nodes-".concat(t))}))]}):null;return(0,q.jsxs)("div",{className:pe("versions"),children:[p,x,N]})};var xe=s(94790),Ne=s(23373),je=s(91816),be=s(32270),fe=s(42784),we=s(27506);const ye=(0,p.cn)("tablet"),Ee=e=>{var t;let{tablet:s={},tenantName:n}=e;const{TabletId:a,NodeId:l,Type:r}=s,o=null===(t=s.Overall)||void 0===t?void 0:t.toLowerCase(),i=a&&(0,m.fK)(a,{nodeId:l,tenantName:n,type:r});return(0,q.jsx)(xe.f,{className:ye("wrapper"),content:(0,q.jsx)(we.Fb,{data:s,className:ye("popup-content")}),children:(0,q.jsx)(u.h,{to:i,children:(0,q.jsx)(fe.v,{className:ye({status:o}),text:(0,z.qV)(s.Type)})})})};var Ce=s(12199),Te=s(81854);const ke=(0,p.cn)("ydb-cluster-versions-bar"),Pe=e=>{let{versionsValues:t=[]}=e;return(0,q.jsxs)("div",{className:ke(),children:[(0,q.jsx)(ne.E,{value:100,stack:t,size:"s"}),(0,q.jsx)("div",{className:ke("versions"),children:t.map(((e,s)=>(0,q.jsx)("div",{className:ke("version-title"),style:{color:e.color},title:e.version,children:"".concat(e.version).concat(s===t.length-1?"":",")},e.version)))})]})};var Se=s(30817);const Oe=JSON.parse('{"disk-type":"Disk Type","erasure":"Erasure","allocated":"Allocated","available":"Available","usage":"Usage","dc":"DC","tablets":"Tablets","databases":"Databases","nodes":"Nodes","load":"Load","storage-size":"Storage size","storage-groups":"Storage groups, {{diskType}}","links":"Links","versions":"Versions"}'),Ae=JSON.parse('{"disk-type":"\u0422\u0438\u043f \u0434\u0438\u0441\u043a\u0430","erasure":"\u0420\u0435\u0436\u0438\u043c","allocated":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e","available":"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e","usage":"\u041f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u0435","dc":"\u0414\u0426","tablets":"\u0422\u0430\u0431\u043b\u0435\u0442\u043a\u0438","databases":"\u0411\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445","nodes":"\u0423\u0437\u043b\u044b","load":"\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430","storage-size":"\u0420\u0430\u0437\u043c\u0435\u0440 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430","storage-groups":"\u0413\u0440\u0443\u043f\u043f\u044b \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f, {{diskType}}","links":"\u0421\u0441\u044b\u043b\u043a\u0438","versions":"\u0412\u0435\u0440\u0441\u0438\u0438"}'),Le=(0,Se.wZ)("ydb-cluster",{ru:Ae,en:Oe});var De=s(28164);const Ve=(e,t)=>e.Type===De.F.TxAllocator?1:t.Type===De.F.TxAllocator?-1:0,Ze=(0,p.cn)("cluster-info"),ze=e=>{let{stats:t}=e;const{diskType:s,erasure:n,allocatedSize:a,availableSize:l}=t,r=(0,Te.dT)(Math.max(a,l),2),o=(0,Te.td)({value:a,size:r}),i=(0,Te.td)({value:l,size:r}),c=Math.round(a/(a+l)*100),d=[{label:Le("disk-type"),value:s},{label:Le("erasure"),value:n},{label:Le("allocated"),value:o},{label:Le("available"),value:i},{label:Le("usage"),value:c+"%"}];return(0,q.jsx)(Ne._,{dots:!0,info:d,className:Ze("groups-stats-popup-content"),size:"s"})},Ge=e=>{let{stats:t}=e;return(0,q.jsx)("div",{className:Ze("storage-groups-stats"),children:Object.values(t).map((e=>(0,q.jsx)(xe.f,{placement:["right"],content:(0,q.jsx)(ze,{stats:e}),children:(0,q.jsx)(Y.y,{className:Ze("groups-stats-bar"),value:e.createdGroups,capacity:e.totalGroups})},e.erasure)))})},Me=(e,t,s,n,a)=>{const l=[];if(e.DataCenters&&l.push({label:Le("dc"),value:(0,q.jsx)(Ce.$,{tags:e.DataCenters})}),e.SystemTablets){const t=e.SystemTablets.slice(0).sort(Ve);l.push({label:Le("tablets"),value:(0,q.jsx)("div",{className:Ze("system-tablets"),children:t.map(((e,t)=>(0,q.jsx)(Ee,{tablet:e},t)))})})}return e.Tenants&&l.push({label:Le("databases"),value:e.Tenants}),l.push({label:Le("nodes"),value:(0,q.jsx)(Y.y,{value:null===e||void 0===e?void 0:e.NodesAlive,capacity:null===e||void 0===e?void 0:e.NodesTotal})},{label:Le("load"),value:(0,q.jsx)(Y.y,{value:null===e||void 0===e?void 0:e.LoadAverage,capacity:null===e||void 0===e?void 0:e.NumberOfCpus})},{label:Le("storage-size"),value:(0,q.jsx)(Y.y,{value:null===e||void 0===e?void 0:e.StorageUsed,capacity:null===e||void 0===e?void 0:e.StorageTotal,formatValues:B.QO})}),Object.keys(s).length&&l.push(...(e=>Object.keys(e).map((t=>({label:Le("storage-groups",{diskType:t}),value:(0,q.jsx)(Ge,{stats:e[t]})}))))(s)),l.push(...n,{label:Le("links"),value:(0,q.jsx)("div",{className:Ze("links"),children:a.map((e=>{let{title:t,url:s}=e;return(0,q.jsx)(be.j,{title:t,url:s},t)}))})},{label:Le("versions"),value:(0,q.jsx)(Pe,{versionsValues:t})}),l},Ie=e=>{let{cluster:t,versionToColor:s,groupsStats:a={},loading:l,error:r,additionalClusterProps:o={}}=e;const i=(0,g.ix)((e=>e.singleClusterMode)),{currentData:c}=K.k.useGetNodesQuery({tablets:!1,group:"Version"}),d=n.useMemo((()=>{return c?Array.isArray(c.NodeGroups)?(e=c.NodeGroups,t=s,e.map((e=>({title:e.name,version:e.name,color:null===t||void 0===t?void 0:t.get(e.name),value:e.count})))):me(c.Nodes,s):[];var e,t}),[c,s]);let u=O.y3+"/internal";i&&!O.j4&&(u="/internal");const{info:m=[],links:v=[]}=o,h=Me(null!==t&&void 0!==t?t:{},d,a,m,[{title:z.Ah,url:u},...v]);return(0,q.jsxs)("div",{className:Ze(),children:[r?(0,q.jsx)(y.V,{error:r,className:Ze("error")}):null,(0,q.jsx)("div",{className:Ze("info"),children:l?(0,q.jsx)(je.b,{className:Ze("skeleton"),rows:9}):r&&!t?null:(0,q.jsx)(Ne._,{dots:!0,info:h})})]})};var Re=s(81003);const Fe=(0,p.cn)("cluster");function Be(e){let{additionalClusterProps:t,additionalTenantsProps:s,additionalNodesProps:p,additionalVersionsProps:b}=e;const f=n.useRef(null),w=(0,g.zL)(),y=function(){const e=(0,g.zL)(),t=(0,g.ix)((e=>e.cluster.defaultClusterTab)),s=(0,o.$B)(m.ZP.cluster),{activeTab:a}=(null===s||void 0===s?void 0:s.params)||{};let l;l=(0,Re.V2)(a)?a:t;return n.useEffect((()=>{l!==t&&e((0,v.LQ)(l))}),[l,t,e]),l}(),[{clusterName:E,backend:C}]=(0,i.useQueryParams)({clusterName:i.StringParam,backend:i.StringParam}),T=(0,g.ix)((e=>(0,v.le)(e,null!==E&&void 0!==E?E:void 0))),{data:{clusterData:k={},groupsStats:P}={},isLoading:S,error:O}=v.UM.useGetClusterInfoQuery(null!==E&&void 0!==E?E:void 0),A=O&&"object"===typeof O?O:void 0;n.useEffect((()=>{w((0,h.J)("cluster",{}))}),[w]);const L=n.useMemo((()=>null!==b&&void 0!==b&&b.getVersionToColorMap?null===b||void 0===b?void 0:b.getVersionToColorMap():(0,x.ZP)(null===k||void 0===k?void 0:k.Versions)),[b,k]),D=n.useMemo((()=>Re._Y.find((e=>{let{id:t}=e;return t===y}))),[y]);return(0,q.jsxs)("div",{className:Fe(),ref:f,children:[(0,q.jsx)(r.ql,{defaultTitle:"".concat(T," \u2014 YDB Monitoring"),titleTemplate:"%s \u2014 ".concat(T," \u2014 YDB Monitoring"),children:D?(0,q.jsx)("title",{children:D.title}):null}),(0,q.jsx)("div",{className:Fe("header"),children:S?(0,q.jsx)(a.O,{className:Fe("title-skeleton")}):(0,q.jsx)(d.A,{size:"m",status:null===k||void 0===k?void 0:k.Overall,name:T,className:Fe("title")})}),(0,q.jsx)("div",{className:Fe("tabs"),children:(0,q.jsx)(l.m,{size:"l",allowNotSelected:!0,activeTab:y,items:Re._Y,wrapTo:(e,t)=>{let{id:s}=e;const n=(0,Re.B7)(s,{clusterName:E,backend:C});return(0,q.jsx)(u.h,{to:n,onClick:()=>{w((0,v.LQ)(s))},children:t},s)}})}),(0,q.jsx)("div",{className:Fe("sticky-wrapper"),children:(0,q.jsx)(c.q,{className:Fe("auto-refresh-control")})}),(0,q.jsxs)(o.rs,{children:[(0,q.jsx)(o.AW,{path:(0,m.Fz)((0,Re.B7)(Re.xu.overview)).pathname,children:(0,q.jsx)(Ie,{cluster:k,groupsStats:P,versionToColor:L,loading:S,error:A,additionalClusterProps:t})}),(0,q.jsx)(o.AW,{path:(0,m.Fz)((0,Re.B7)(Re.xu.tenants)).pathname,children:(0,q.jsx)(U,{additionalTenantsProps:s})}),(0,q.jsx)(o.AW,{path:(0,m.Fz)((0,Re.B7)(Re.xu.nodes)).pathname,children:(0,q.jsx)(N.G,{parentContainer:f.current,additionalNodesProps:p})}),(0,q.jsx)(o.AW,{path:(0,m.Fz)((0,Re.B7)(Re.xu.storage)).pathname,children:(0,q.jsx)(j.V,{parentContainer:f.current,additionalNodesProps:p})}),(0,q.jsx)(o.AW,{path:(0,m.Fz)((0,Re.B7)(Re.xu.versions)).pathname,children:(0,q.jsx)(ge,{versionToColor:L})}),(0,q.jsx)(o.AW,{render:()=>(0,q.jsx)(o.l_,{to:(0,m.Fz)((0,Re.B7)(y))})})]})]})}},57225:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(68963);const a=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 2.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8.75 5a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 0 1.5 0V5Z",clipRule:"evenodd"}))},67585:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(68963);const a=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm1-9.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8 7.75a.75.75 0 0 1 .75.75V11a.75.75 0 0 1-1.5 0V8.5A.75.75 0 0 1 8 7.75Z",clipRule:"evenodd"}))},71549:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(68963);const a=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m3.003 4.702 4.22-2.025a1.796 1.796 0 0 1 1.554 0l4.22 2.025a.886.886 0 0 1 .503.8V6a8.55 8.55 0 0 1-3.941 7.201l-.986.631a1.063 1.063 0 0 1-1.146 0l-.986-.63A8.55 8.55 0 0 1 2.5 6v-.498c0-.341.196-.652.503-.8Zm3.57-3.377L2.354 3.35A2.387 2.387 0 0 0 1 5.502V6a10.05 10.05 0 0 0 4.632 8.465l.986.63a2.563 2.563 0 0 0 2.764 0l.986-.63A10.05 10.05 0 0 0 15 6v-.498c0-.918-.526-1.755-1.354-2.152l-4.22-2.025a3.296 3.296 0 0 0-2.852 0ZM9.5 7a1.5 1.5 0 0 1-.75 1.3v1.95a.75.75 0 0 1-1.5 0V8.3A1.5 1.5 0 1 1 9.5 7Z",clipRule:"evenodd"}))},71586:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(68963);const a=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.836 2.244c.962-1.665 3.366-1.665 4.328 0l4.917 8.505c.964 1.666-.239 3.751-2.164 3.751H3.083c-1.925 0-3.128-2.085-2.164-3.751l4.917-8.505ZM8 5a.75.75 0 0 1 .75.75v2a.75.75 0 1 1-1.5 0v-2A.75.75 0 0 1 8 5Zm1 5.75a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z",clipRule:"evenodd"}))},48897:(e,t,s)=>{"use strict";s.d(t,{X:()=>c});var n=s(68963),a=s(33180),l=s(24288);function r(e){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 17",width:"16",height:"16",fill:"currentColor"},e),n.createElement("path",{d:"M4 7h9v3H4z"}))}function o(e){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 10",width:"16",height:"16",fill:"currentColor"},e),n.createElement("path",{d:"M.49 5.385l1.644-1.644 4.385 4.385L4.874 9.77.49 5.385zm4.384 1.096L10.356 1 12 2.644 6.519 8.126 4.874 6.48v.001z"}))}const i=(0,s(36951).Ge)("checkbox"),c=n.forwardRef((function(e,t){const{size:s="m",indeterminate:c,disabled:d=!1,content:u,children:m,title:v,style:h,className:p,qa:g}=e,{checked:x,inputProps:N}=(0,a.O)(e),j=u||m,b=n.createElement("span",{className:i("indicator")},n.createElement("span",{className:i("icon"),"aria-hidden":!0},c?n.createElement(r,{className:i("icon-svg",{type:"dash"})}):n.createElement(o,{className:i("icon-svg",{type:"tick"})})),n.createElement("input",Object.assign({},N,{className:i("control")})),n.createElement("span",{className:i("outline")}));return n.createElement(l.J,{ref:t,title:v,style:h,size:s,disabled:d,className:i({size:s,disabled:d,indeterminate:c,checked:x},p),qa:g,control:b},j)}))},84893:(e,t,s)=>{"use strict";s.d(t,{E:()=>u});var n=s(68963);const a=(0,s(36951).Ge)("progress");function l(e){const{text:t,offset:s=0}=e;return t?n.createElement("div",{className:a("text-inner"),style:{transform:"translateX(calc(var(--g-flow-direction) * ".concat(-s,"%))")}},t):null}function r(e){let{item:t}=e;const{value:s,color:l,className:r,theme:o,title:i,content:c,loading:d}=t,u={loading:d};return"undefined"===typeof l&&(u.theme=o||"default"),Number.isFinite(s)?n.createElement("div",{className:a("item",u,r),style:{width:"".concat(s,"%"),backgroundColor:l},title:i},c):null}function o(e){return e<100?e-100:0}function i(e){const{theme:t,colorStops:s,colorStopsValue:n,value:a}=e;if(s){const e=s.find(((e,t)=>{const l="number"===typeof n?n:a,r=t>1?s[t-1].stop:0,o=t<s.length-1?e.stop:100;return l>=r&&l<=o}));return e?e.theme:t}return t}function c(e){const{stack:t,stackClassName:s,value:i,text:c}=e,d=o(i||function(e){return e.reduce(((e,t)=>{let{value:s}=t;return e+s}),0)}(t));return n.createElement("div",{className:a("stack",s),style:{transform:"translateX(calc(var(--g-flow-direction) * ".concat(d,"%))")}},n.createElement("div",{className:a("item"),style:{width:"".concat(-d,"%")}}),t.map(((e,t)=>n.createElement(r,{key:t,item:e}))),n.createElement(l,{offset:d,text:c}))}function d(e){const{value:t,loading:s,text:r}=e,c=o(t);return Number.isFinite(t)?n.createElement("div",{className:a("item",{theme:i(e),loading:s}),style:{transform:"translateX(calc(var(--g-flow-direction) * ".concat(c,"%))")}},n.createElement(l,{offset:c,text:r})):null}const u=n.forwardRef((function(e,t){const{text:s="",theme:l="default",size:r="m",loading:o=!1,className:i,qa:u}=e,m=Object.assign(Object.assign({},e),{text:s,theme:l,size:r,loading:o});return n.createElement("div",{ref:t,className:a({size:r},i),"data-qa":u},n.createElement("div",{className:a("text")},s),function(e){return void 0!==e.stack}(m)?n.createElement(c,Object.assign({},m)):n.createElement(d,Object.assign({},m)))}))},56711:(e,t,s)=>{"use strict";s.d(t,{O:()=>l});var n=s(68963);const a=(0,s(36951).Ge)("skeleton");function l(e){let{className:t,style:s,qa:l}=e;return n.createElement("div",{className:a(null,t),style:s,"data-qa":l})}},27320:(e,t,s)=>{"use strict";s.d(t,{u:()=>d});var n=s(68963),a=s(48027),l=s(79004),r=s(44920),o=s(10288);const i=(0,s(36951).Ge)("tooltip"),c=["bottom","top"],d=e=>{const{children:t,content:s,disabled:d,placement:u=c,qa:m,id:v,className:h,style:p,disablePortal:g,contentClassName:x,openDelay:N=1e3,closeDelay:j}=e,[b,f]=n.useState(null),w=(0,l.p)(b,{openDelay:N,closeDelay:j,preventTriggerOnFocus:!0}),y=n.Children.only(t),E=y.ref,C=(0,a.c)(f,E);return n.createElement(n.Fragment,null,n.cloneElement(y,{ref:C}),b?n.createElement(r.G,{id:v,role:"tooltip",className:i(null,h),style:p,open:w&&!d,placement:u,anchorRef:{current:b},disablePortal:g,disableEscapeKeyDown:!0,disableOutsideClick:!0,disableLayer:!0,qa:m},n.createElement("div",{className:i("content",x)},n.createElement(o.x,{variant:"body-short",color:"complementary"},s))):null)}},56829:(e,t,s)=>{"use strict";s.d(t,{F:()=>a});var n=s(40797);function a(){return(0,n.T)().theme}},38626:e=>{e.exports=function(e,t,s,n){for(var a=-1,l=null==e?0:e.length;++a<l;){var r=e[a];t(n,r,s(r),e)}return n}},30277:(e,t,s)=>{var n=s(46067);e.exports=function(e,t,s,a){return n(e,(function(e,n,l){t(a,e,s(e),l)})),a}},81670:(e,t,s)=>{var n=s(38626),a=s(30277),l=s(67173),r=s(46296);e.exports=function(e,t){return function(s,o){var i=r(s)?n:a,c=t?t():{};return i(s,e,l(o,2),c)}}},46754:(e,t,s)=>{var n=s(69519),a=s(81670),l=Object.prototype.hasOwnProperty,r=a((function(e,t,s){l.call(e,s)?e[s].push(t):n(e,s,[t])}));e.exports=r},40067:(e,t,s)=>{"use strict";s.d(t,{L:()=>c});var n=s(75859),a=s(68963),l=s(30831),r=s(99879);const o="--ydb-tree-view-level",i=(0,r.G)("ydb-tree-view");function c(e){let{children:t,name:s,title:r,icon:c,collapsed:d=!0,active:u=!1,onClick:m,onArrowClick:v,hasArrow:h=!1,actions:p,additionalNodeElements:g,level:x}=e;const N=a.useCallback((e=>{if(!m)return;e.nativeEvent.composedPath().some((e=>e instanceof HTMLElement&&("BUTTON"===e.nodeName&&!e.hasAttribute("disabled")||e.hasAttribute("tabindex")&&e.tabIndex>-1)))||m()}),[m]),j=v||m;let b="tree-view_arrow",f="tree-view_children";return d&&(b+=" tree-view_arrow-collapsed",f+=" tree-view_children-collapsed"),(0,n.jsx)("div",{className:i(),style:{[o]:x},children:(0,n.jsxs)("div",{className:"tree-view",children:[(0,n.jsxs)("div",{className:"".concat("tree-view_item"," ").concat(i("item",{active:u})),onClick:N,children:[(0,n.jsx)("button",{type:"button",className:"".concat(b," ").concat(i("arrow",{collapsed:d,hidden:!h})),disabled:!j,onClick:j}),(0,n.jsxs)("div",{className:i("content"),children:[c&&(0,n.jsx)("div",{className:i("icon"),children:c}),(0,n.jsx)("div",{className:i("text"),title:r,children:s}),p&&p.length>0&&(0,n.jsxs)("div",{className:i("actions"),children:[g,(0,n.jsx)(l.h,{defaultSwitcherProps:{view:"flat-secondary",size:"s",pin:"brick-brick"},items:p})]})]})]}),(0,n.jsx)("div",{className:"".concat(f," ").concat(i("container",{collapsed:d})),children:d?null:t})]})})}},99879:(e,t,s)=>{"use strict";s.d(t,{G:()=>n});const n=(0,s(5247).withNaming)({e:"__",m:"_"})}}]);