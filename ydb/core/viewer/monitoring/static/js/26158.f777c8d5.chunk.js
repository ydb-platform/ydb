(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[26158],{23536:(e,t,s)=>{var n=s(68814),i=/[\\^$.*+?()[\]{}|]/g,d=RegExp(i.source);e.exports=function(e){return(e=n(e))&&d.test(e)?e.replace(i,"\\$&"):e}},53807:(e,t,s)=>{"use strict";s.d(t,{O:()=>we});var n=s(60712),i=s(27738),d=s(80136),a=s(47653),l=s(59284),r=s(66821);const o=e=>l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),l.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10.5 6V5a2.5 2.5 0 0 0-5 0v1zM4 5v1a3 3 0 0 0-3 3v3a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3V5a4 4 0 0 0-8 0m6.5 2.5H12A1.5 1.5 0 0 1 13.5 9v3a1.5 1.5 0 0 1-1.5 1.5H4A1.5 1.5 0 0 1 2.5 12V9A1.5 1.5 0 0 1 4 7.5zm-1.75 2a.75.75 0 0 0-1.5 0v2a.75.75 0 0 0 1.5 0z",clipRule:"evenodd"}));var c=s(11882),u=s(79411),p=s(9701),m=s(711),I=s(88908),h=s(28735),f=s(65797),x=s(57650),y=s(66246),b=s(14044),g=s(32752),v=s(10417);const S=(0,v.om)("list-container-view"),B=l.forwardRef((function({as:e="div",role:t="listbox",children:s,id:i,className:d,fixedHeight:a,extraProps:l,qa:r,style:o},c){return(0,n.jsx)(g.s,{qa:r,as:e,direction:"column",ref:c,grow:!0,tabIndex:-1,id:i,role:t,style:o,className:S({"fixed-height":a},d),...l,children:s})})),C=e=>null!==e&&"object"===typeof e&&"data"in e,j=(0,v.om)("list-recursive-renderer");function w({id:e,itemSchema:t,list:s,...i}){const d=i.children(e,s.structure.idToFlattenIndex[e]);if(C(t)&&t.children){const a=!s.state.expandedById||!(e in s.state.expandedById)||s.state.expandedById[e];return(0,n.jsxs)("ul",{style:i.style,className:j(null,i.className),role:"group",children:[d,a&&Boolean(s.structure.groupsState[e]?.childrenIds)&&t.children.map(((t,d)=>(0,n.jsx)(w,{list:s,id:s.structure.groupsState[e].childrenIds[d],itemSchema:t,...i},d)))]})}return d}function k({containerRef:e,renderItem:t,list:s,...i}){return(0,n.jsx)(B,{ref:e,...i,children:s.structure.items.map(((e,i)=>(0,n.jsx)(w,{itemSchema:e,id:s.structure.rootIds[i],list:s,children:t},i)))})}const N=({list:e,multiple:t})=>({id:s})=>{e.state.disabledById[s]||(e.state.setActiveItemId(s),e.state.expandedById&&s in e.state.expandedById&&e.state.setExpanded?e.state.setExpanded((e=>({...e,[s]:!e[s]}))):e.state.setSelected((e=>({...t?e:{},[s]:!t||!e[s]}))))};var E=s(80702);const R="data-list-item",D={s:[22,44],m:[26,44],l:[34,52],xl:[44,62]},F=({containerRef:e,onItemClick:t,enabled:s,list:n})=>{const i=l.useCallback(((t,s=!0)=>{"number"===typeof t&&n.structure.visibleFlattenIds[t]&&(s&&((e,t)=>{if(document){const s=(t||document).querySelector(`[${R}="${e}"]`);s&&s.scrollIntoView?.({block:"nearest"})}})(n.structure.visibleFlattenIds[t],e?.current),n.state.setActiveItemId?.(n.structure.visibleFlattenIds[t]))}),[n.structure.visibleFlattenIds,n.state,e]),d=l.useCallback(((e,t,s=0)=>{e.preventDefault();const d="string"===typeof n.state.activeItemId?n.structure.visibleFlattenIds.findIndex((e=>e===n.state.activeItemId)):-1,a=(({list:e,index:t,step:s,disabledItemsById:n={}})=>{const i=e.length;let d=(t+i)%i;for(let a=0;a<i;a+=1){const t=e[d];if(t&&!n[t])return d;d=(d+i+s)%i}})({list:n.structure.visibleFlattenIds,index:(d>-1?d:s)+t,step:Math.sign(t),disabledItemsById:n.state.disabledById});i(a)}),[i,n.state.activeItemId,n.state.disabledById,n.structure.visibleFlattenIds]);l.useLayoutEffect((()=>{const i=e?.current;if(s||!i)return;const a=e=>{switch(e.key){case E.D.ARROW_DOWN:d(e,1,-1);break;case E.D.ARROW_UP:d(e,-1);break;case E.D.SPACEBAR:case E.D.ENTER:n.state.activeItemId&&!n.state.disabledById[n.state.activeItemId]&&(e.preventDefault(),t?.({id:n.state.activeItemId}))}};return i.addEventListener("keydown",a),()=>{i.removeEventListener("keydown",a)}}),[e,s,d,n.state.activeItemId,n.state.disabledById,t])};var P=s(32989),A=s(25569),T=s(78068),$=s(60461);const O=(0,v.om)("list-item-expand-icon"),M=({expanded:e,behavior:t="action",disabled:s})=>(0,n.jsx)($.I,{direction:z({behavior:t,expanded:e}),className:O(null,(0,T.$)({color:s?"hint":void 0})),size:16});function z({behavior:e,expanded:t}){return t&&"action"===e?"top":t&&"state"===e||t&&"state-inverse"===e||"action"===e?"bottom":"state"===e?"right":"state-inverse"===e?"left":"bottom"}const L=(0,v.om)("list-item-view"),q=e=>"object"===typeof e&&null!==e&&"title"in e,_=({children:e,indentation:t=1,className:s,...i})=>(0,n.jsx)(g.s,{width:16*t,className:L("slot",s),...i,children:e}),V=e=>e&&e>=1?(0,n.jsx)(_,{indentation:Math.floor(e)}):null,U=({startSlot:e,subtitle:t,endSlot:s,disabled:i,hasSelectionIcon:d,isGroup:l,indentation:r,expanded:o,selected:c,title:u,expandIconPlacement:p="start",renderExpandIcon:m=M})=>{const h=l?(0,n.jsx)(m,{behavior:"start"===p?"state":"action",expanded:o,disabled:i}):null;return(0,n.jsxs)(g.s,{alignItems:"center",justifyContent:"space-between",gap:"4",className:L("content"),children:[(0,n.jsxs)(g.s,{gap:"2",alignItems:"center",grow:!0,children:[d&&(0,n.jsx)(_,{children:c?(0,n.jsx)(a.I,{data:A.A,size:16,className:(0,T.$)({color:"info"})}):null}),V(r),"start"===p&&h,e,(0,n.jsxs)("div",{className:L("main-content"),children:["string"===typeof u?(0,n.jsx)(I.E,{ellipsis:!0,color:i?"hint":void 0,variant:l?"subheader-1":void 0,children:u}):u,"string"===typeof t?(0,n.jsx)(I.E,{ellipsis:!0,color:i?"hint":"secondary",children:t}):t]})]}),(0,n.jsxs)(g.s,{gap:"2",children:["end"===p&&h,s]})]})},W=l.forwardRef((function({id:e,as:t,size:s="m",active:i,selected:d,disabled:a,selectionViewType:l="multiple",activeOnHover:r,className:o,height:c,dragging:u,style:p,content:m,role:I="option",onClick:h,...f},x){const y=t||"li",b=a?void 0:h,g="boolean"===typeof r?r:Boolean(b),v={minHeight:`var(--g-list-item-height, ${c??D[s][Number(Boolean(!!q(m)&&m?.subtitle))]}px)`,...p};return(0,n.jsx)(y,{[R]:e,role:I,"aria-selected":d,onClick:b,className:L({active:u||i,selected:d&&"single"===l,activeOnHover:g,radius:s,size:s,dragging:u,clickable:Boolean(b)},(0,P.Y)({px:2},o)),style:v,ref:x,...f,children:q(m)?(0,n.jsx)(U,{...m,hasSelectionIcon:"multiple"===l,selected:d,disabled:a}):m})})),H=(0,v.om)("tree-list"),J=({qa:e,id:t,size:s="m",className:i,list:d,multiple:a,containerRef:r,renderItem:o,renderContainer:c=k,onItemClick:p,mapItemDataToContentProps:m})=>{const I=(0,u.u)(),h=t??I,f=l.useRef(null),x=r??f,y=l.useMemo((()=>{if(null===p)return;return(e,t)=>{const s={id:e.id,list:d};if(p)p?.(s,t);else{N({list:d,multiple:a})(s,t)}}}),[p,d,a]);F({containerRef:x,onItemClick:y,list:d});return c({qa:e,id:`list-${h}`,size:s,containerRef:x,className:H(null,i),list:d,renderItem:(t,i,l)=>{const r=(({qa:e,list:t,onItemClick:s,mapItemDataToContentProps:n,size:i="m",multiple:d=!1,id:a})=>{const l={...t.structure.itemsState[a],...t.structure.groupsState[a],isLastItem:a===t.structure.visibleFlattenIds[t.structure.visibleFlattenIds.length-1]},r={id:a,size:i,selected:Boolean(t.state.selectedById[a]),disabled:Boolean(t.state.disabledById?.[a]),active:a===t.state.activeItemId,onClick:s?e=>s({id:a},e):void 0,selectionViewType:Boolean(d)&&!l.childrenIds?"multiple":"single",content:{expanded:t.state.expandedById?.[a],indentation:l.indentation,isGroup:t.state.expandedById&&a in t.state.expandedById,...n(t.structure.itemsById[a])}};return e&&(r.qa=((e,t)=>`${e}-${t}`)(e,a)),{data:t.structure.itemsById[a],props:r,context:l}})({qa:e,id:t,size:s,multiple:a,mapItemDataToContentProps:m,onItemClick:y,list:d});return o?o({id:t,data:r.data,props:r.props,context:r.context,index:i,renderContainerProps:l,list:d}):(0,n.jsx)(W,{...r.props,...l})}})};var G=s(44900),Y=s(59706),K=s(11282);const Q=({item:e,groupedId:t,getItemId:s})=>{let n=t;return"function"===typeof s?n=s(C(e)?e.data:e):e&&"object"===typeof e&&"id"in e&&e.id&&(n=e.id),n},X=(e,t)=>t?`${t}-${e}`:`${e}`;function Z({items:e,expandedById:t,getItemId:s}){const n=l.useMemo((()=>function({items:e,getItemId:t,expandedById:s={}}){const n=[],i=(e,d,a,l)=>{const r=X(a,l),o=Q({groupedId:r,item:d,getItemId:t});return l||n.push(o),e.push(o),C(d)&&d.children&&(o in s&&!s[o]||e.push(...d.children.reduce(((e,t,s)=>i(e,t,s,o)),[]))),e},d=e.reduce(((e,t,s)=>i(e,t,s)),[]),a={};for(const[l,r]of d.entries())a[r]=l;return{rootIds:n,visibleFlattenIds:d,idToFlattenIndex:a}}({items:e,expandedById:t,getItemId:s})),[e,t,s]);return n}function ee({items:e,defaultExpandedState:t="expanded",getItemId:s}){const n={itemsById:{},groupsState:{},itemsState:{},initialState:{disabledById:{},selectedById:{},expandedById:{}}},i=({item:e,index:d,parentGroupedId:a,parentId:l})=>{const r=X(d,a),o=Q({groupedId:r,item:e,getItemId:s});l&&n.groupsState[l].childrenIds.push(o),n.itemsById[o]=e.data,n.itemsState[o]||(n.itemsState[o]={indentation:0}),"undefined"!==typeof l&&(n.itemsState[o].parentId=l),"undefined"!==typeof e.selected&&(n.initialState.selectedById[o]=e.selected),"undefined"!==typeof e.disabled&&(n.initialState.disabledById[o]=e.disabled),r&&(n.itemsState[o].indentation=(e=>e.split("-"))(r).length-1),e.children&&(n.groupsState[o]={childrenIds:[]},n.initialState.expandedById&&("undefined"===typeof e.expanded?n.initialState.expandedById[o]="expanded"===t:n.initialState.expandedById[o]=e.expanded),e.children.forEach(((e,t)=>{i({item:e,index:t,parentGroupedId:r,parentId:o})})))};return e.forEach(((e,t)=>C(e)?i({item:e,index:t}):(({item:e,index:t})=>{const i=Q({groupedId:String(t),item:e,getItemId:s});n.itemsById[i]=e,n.itemsState[i]||(n.itemsState[i]={indentation:0}),e&&"object"===typeof e&&("selected"in e&&"boolean"===typeof e.selected&&(n.initialState.selectedById[i]=e.selected),"disabled"in e&&"boolean"===typeof e.disabled&&(n.initialState.disabledById[i]=e.disabled))})({item:e,index:t}))),n}const te=({items:e,getItemId:t,defaultExpandedState:s="expanded",withExpandedState:n=!0,initialState:i,controlledState:d})=>{const{itemsById:a,groupsState:r,itemsState:o,initialState:c}=function({items:e,getItemId:t,defaultExpandedState:s}){const n=l.useRef(t).current;return l.useMemo((()=>ee({items:e,getItemId:n,defaultExpandedState:s})),[n,s,e])}({items:e,getItemId:t,defaultExpandedState:s}),u=(({initialState:e,withExpandedState:t})=>{const s=l.useRef(e),n=s.current!==e;s.current=e;const[i,d]=l.useState((()=>e?.disabledById??{})),[a,r]=l.useState((()=>e?.selectedById??{})),[o,c]=l.useState((()=>e?.expandedById??{})),[u,p]=l.useState((()=>e?.activeItemId));n&&(e?.disabledById&&d((t=>({...e.disabledById,...t}))),e?.selectedById&&r((t=>({...e.selectedById,...t}))),e?.expandedById&&c((t=>({...e.expandedById,...t}))),p((t=>t??e?.activeItemId)));const m={disabledById:i,selectedById:a,activeItemId:u,setDisabled:d,setSelected:r,setActiveItemId:p};return t&&(m.expandedById=o,m.setExpanded=c),m})({initialState:l.useMemo((()=>({expandedById:{...c.expandedById,...i?.expandedById},selectedById:{...c.selectedById,...i?.selectedById},disabledById:{...c.disabledById,...i?.disabledById},activeItemId:i?.activeItemId})),[c.disabledById,c.expandedById,c.selectedById,i?.activeItemId,i?.disabledById,i?.expandedById,i?.selectedById]),withExpandedState:n}),p=l.useMemo((()=>d?{...u,...d}:u),[d,u]),{visibleFlattenIds:m,idToFlattenIndex:I,rootIds:h}=Z({items:e,expandedById:p.expandedById,getItemId:t});return{state:p,structure:{rootIds:h,items:e,visibleFlattenIds:m,idToFlattenIndex:I,itemsById:a,groupsState:r,itemsState:o}}},se=({defaultValue:e=[],value:t,onUpdate:s})=>{const[n,i]=l.useState(e),d=t??n,a=!t;return l.useMemo((()=>{const e=d.reduce(((e,t)=>(e[t]=!0,e)),{});return{value:d,selectedById:e,setSelected:t=>{const n=(e=>Object.entries(e).reduce(((e,[t,s])=>(s&&e.push(t),e)),[]))("function"===typeof t?t(e):t);a?i(n):s?.(n)},setInnerValue:a?i:void 0}}),[s,a,d])},ne=(0,v.om)("tree-select"),ie=e=>(0,n.jsx)(W,{...e.props,...e.renderContainerProps}),de=l.forwardRef((function({id:e,qa:t,title:s,placement:i,slotBeforeListBody:d,slotAfterListBody:a,size:r="m",defaultOpen:o,width:c,containerRef:p,className:m,containerClassName:I,popupClassName:g,open:v,multiple:S,popupWidth:B,popupDisablePortal:C,items:j,value:w,defaultValue:k,placeholder:E,disabled:R=!1,withExpandedState:D=!0,defaultExpandedState:F="expanded",hasClear:P,errorMessage:A,errorPlacement:T,validationState:$,onClose:O,onOpenChange:M,onUpdate:z,renderControl:L,renderItem:q=ie,renderContainer:_,mapItemDataToContentProps:V,onFocus:U,onBlur:W,getItemId:H,onItemClick:Q},X){const Z=(0,K.I)(),ee=(0,u.u)(),de=e??ee,ae=`tree-select-popup-${de}`,le=l.useRef(null),re=l.useRef(null),oe=l.useRef(null),ce=p??oe,{errorMessage:ue,errorPlacement:pe,validationState:me}=(0,Y.Av)({errorMessage:A,errorPlacement:T||"outside",validationState:$}),Ie=(0,u.u)(),he="invalid"===me,fe=he&&Boolean(ue)&&"outside"===pe,xe=he&&Boolean(ue)&&"inside"===pe,ye=(0,h.N)(X,re),{toggleOpen:be,open:ge}=(0,x.F)({defaultOpen:o,onClose:O,onOpenChange:M,open:v}),{value:ve,selectedById:Se,setSelected:Be}=se({value:w,defaultValue:k,onUpdate:z}),Ce=te({controlledState:{selectedById:Se,setSelected:Be},items:j,getItemId:H,defaultExpandedState:F,withExpandedState:D}),je=l.useMemo((()=>{if(null===Q)return;return(e,t)=>{const s={id:e.id,list:Ce};if(Q)Q?.(s,t);else{N({list:Ce,multiple:S})(s,t);const n=Ce.state.expandedById&&e.id in Ce.state.expandedById;S||n||be(!1)}}}),[Q,Ce,S,be]);l.useLayoutEffect((()=>(ge&&ce.current?.focus({preventScroll:!0}),()=>Ce.state.setActiveItemId(void 0))),[ge]);const we=l.useCallback((()=>be(!1)),[be]),{focusWithinProps:ke}=(0,f.R)({onFocusWithin:U,onBlurWithin:l.useCallback((e=>{W?.(e),we()}),[we,W])}),Ne={list:Ce,open:ge,placeholder:E,toggleOpen:be,clearValue:()=>Ce.state.setSelected({}),ref:ye,size:r,value:ve,disabled:R,id:de,activeItemId:Ce.state.activeItemId,title:s,errorMessage:xe?ue:void 0,errorPlacement:pe,validationState:me,hasClear:P,isErrorVisible:he},Ee=L?L(Ne):(0,n.jsx)(y.Y,{...Ne,selectedOptionsContent:l.Children.toArray(ve.map((e=>e in Ce.structure.itemsById?V(Ce.structure.itemsById[e]).title:""))).join(", "),view:"normal",pin:"round-round",popupId:ae,selectId:de}),Re={..."max"===c&&{width:c}},De={};return"number"===typeof c&&(De.width=c),(0,n.jsxs)("div",{ref:le,...ke,className:ne(Re,m),style:De,children:[Ee,(0,n.jsxs)(b.t,{ref:le,className:ne("popup",{size:r},g),controlRef:re,width:B,placement:i,open:ge,handleClose:we,disablePortal:C,mobile:Z,id:ae,children:[d,(0,n.jsx)(J,{list:Ce,size:r,className:ne("list",I),qa:t,multiple:S,id:`list-${de}`,containerRef:ce,onItemClick:je,renderContainer:_,mapItemDataToContentProps:V,renderItem:q??ie}),a]}),(0,n.jsx)(G.o,{errorMessage:fe?ue:null,errorMessageId:Ie})]})}));var ae=s(79602),le=s(43781);function re(e,t){return!t||"object"!==typeof t||!("title"in t)||"string"!==typeof t.title||t.title.toLowerCase().includes((e||"").toLowerCase())}function oe({items:e,initialFilterValue:t="",filterItem:s,onFilterChange:n,filterItems:i,debounceTimeout:d=300}){const a=l.useRef(null),[r,o]=l.useState(t),[c,u]=l.useState(e),[p,m]=l.useState(e),I=l.useCallback(((e,t)=>{if(i)return()=>i(e,t);if(e){const n=s||re;return()=>function(e,t){const s=(e,n)=>{if(C(n)&&n.children){const i=n.children.reduce(s,[]);i.length?e.push({...n,data:n.data,children:i}):t(n.data)&&e.push({...n,data:n.data,children:[]})}else if(C(n)&&t(n.data)){const{children:t,...s}=n;e.push(s)}else!C(n)&&t(n)&&e.push(n);return e};return e.reduce(s,[])}(t,(t=>n(e,t)))}return()=>t}),[s,i]);e!==c&&(m(I(r,e)),u(e));const h=l.useCallback(le((t=>m(I(t,e))),d),[m,I,e,d]),{onFilterUpdate:f,reset:x}=l.useMemo((()=>({reset:()=>{o(t),n?.(t),h(t)},onFilterUpdate:e=>{o(e),n?.(e),h(e)}})),[h,t,n]);return{filterRef:a,filter:r,reset:x,items:p,onFilterUpdate:f}}var ce=s(3169);const ue=JSON.parse('{"button_apply":"Apply","button_reset":"Reset","button_switcher":"Columns"}'),pe=JSON.parse('{"button_apply":"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c","button_reset":"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c","button_switcher":"\u041a\u043e\u043b\u043e\u043d\u043a\u0438"}'),me=(0,ce.N)({en:ue,ru:pe},"TableColumnSetupInner"),Ie=(0,v.om)("inner-table-column-setup"),he=Ie("controls"),fe=Ie("filter-input"),xe=Ie("empty-placeholder"),ye={isDragDisabled:!0},be=e=>({title:e.title}),ge=(e,t)=>"string"!==typeof t.title||t.title.toLowerCase().includes(e.trim().toLowerCase()),ve=e=>{const{renderSwitcher:t,popupWidth:s,popupPlacement:h,items:f,onUpdate:x,sortable:y,renderControls:b,className:v,defaultItems:S=f,showResetButton:C,filterable:j,filterPlaceholder:w,filterEmptyMessage:k,filterSettings:N=ge,hideApplyButton:E}=e,[R,D]=l.useState(!1),[F,P]=l.useState(y),[A,T]=l.useState(y);y!==A&&(T(y),P(y));const[$,O]=(0,p.P)(E?f:void 0,f,E?x:void 0),[M,z]=l.useState(f);f!==M&&(z(f),E||O(f));const{t:L}=me.useTranslation(),q=oe({items:$,filterItem:N,debounceTimeout:0}),_=()=>{const e=$.map((({id:e,isSelected:t})=>({id:e,isSelected:t})));x(e),G(!1)},V=()=>(0,n.jsx)(d.$,{view:"action",width:"max",onClick:_,children:L("button_apply")}),U="function"===typeof C?C($):C,H=(({onDragEnd:e,renderControls:t})=>{const s=(0,u.u)();return({renderItem:i,list:d,containerRef:a,id:r,className:o})=>{const{stickyStartItemIdList:u,sortableItemIdList:p,stickyEndItemIdList:m}=((e,t)=>{let s=0;for(;s!==t.length;s++){const n=e[t[s]];if("left"!==n?.sticky&&"start"!==n?.sticky)break}let n=t.length;for(;0!==n;n--){const s=e[t[n-1]];if("right"!==s?.sticky&&"end"!==s?.sticky)break}return{stickyStartItemIdList:t.slice(0,s),sortableItemIdList:t.slice(s,n),stickyEndItemIdList:t.slice(n)}})(d.structure.itemsById,d.structure.visibleFlattenIds),I=u.map(((e,t)=>i(e,t,ye))),h=p.map(((e,t)=>i(e,t+u.length))),f=m.map(((e,t)=>i(e,I.length+h.length+t,ye)));return(0,n.jsxs)(l.Fragment,{children:[(0,n.jsxs)(B,{ref:a,id:r,className:o,children:[I,(0,n.jsx)(c.JY,{onDragEnd:e,children:(0,n.jsx)(c.gL,{droppableId:s,renderClone:(e,t,s)=>{const n={provided:e,snapshot:t};return i(d.structure.visibleFlattenIds[s.source.index],s.source.index,n)},children:e=>(0,n.jsxs)("div",{...e.droppableProps,ref:e.innerRef,children:[h,e.placeholder]})})}),f]}),(0,n.jsx)("div",{className:he,children:t()})]})}})({onDragEnd:({destination:e,source:t})=>{if(void 0!==e?.index&&e?.index!==t.index){const s=((e,t,s)=>{const n=[...e],[i]=n.splice(t,1);return n.splice(s,0,i),n})($,t.index,e.index);O(s)}},renderControls:()=>b?b({DefaultApplyButton:V,onApply:_}):(0,n.jsxs)(g.s,{gapRow:1,direction:"column",className:he,children:[U&&(0,n.jsx)(d.$,{onClick:()=>{E&&x(S),O(S)},width:"max",children:L("button_reset")}),!E&&(0,n.jsx)(V,{})]})}),J=(e=>({data:t,props:s,index:i,renderContainerProps:d})=>{const u=!1===e||!0===d?.isDragDisabled,p=u?void 0:(0,n.jsx)(a.I,{data:r.A,size:16}),m=t.isRequired?(0,n.jsx)(a.I,{data:o}):void 0,I=!t.isRequired&&s.selected,h={...s,selected:I,selectionViewType:t.isRequired?"single":"multiple",content:{...s.content,startSlot:m,endSlot:p}};if(u)return(0,l.createElement)(W,{...h,key:h.id});const f=(e,t)=>(0,n.jsx)(W,{...h,...e.draggableProps,...e.dragHandleProps,ref:e.innerRef,dragging:t.isDragging});return d?.provided&&d.snapshot?f(d.provided,d.snapshot):(0,n.jsx)(c.sx,{draggableId:s.id,index:i,isDragDisabled:u,children:f},`item-key-${s.id}`)})(F),G=e=>{D(e),!1===e&&(O(f),P(y),q.reset())},Y=l.useMemo((()=>(e=>{const t=[];return e.forEach((({id:e,isSelected:s})=>{s&&t.push(e)})),t})($)),[$]),K=(Q=k,()=>(0,n.jsx)(I.E,{className:xe,children:Q}));var Q;const X=j?(0,n.jsx)(ae.k,{size:"m",view:"clear",placeholder:w,value:q.filter,className:fe,onUpdate:e=>{q.onFilterUpdate(e),P(!e.length)},hasClear:!0}):null,Z=q.filter&&!q.items.length?K:H;return(0,n.jsx)(de,{className:Ie(null,v),mapItemDataToContentProps:be,multiple:!0,size:"l",open:R,value:Y,items:q.filter?q.items:$,onUpdate:e=>{const t=$.map((t=>({...t,isSelected:t.isRequired||e.includes(t.id)})));O(t)},popupWidth:s,onOpenChange:G,placement:h,slotBeforeListBody:X,renderContainer:Z,renderControl:({toggleOpen:e})=>{const s=(0,m.h)(e);return t?.({onClick:e,onKeyDown:s})||(0,n.jsxs)(d.$,{onClick:e,onKeyDown:s,children:[(0,n.jsx)(a.I,{data:i.A}),L("button_switcher")]})},renderItem:J})},Se=JSON.parse('{"button_switcher":"Columns"}'),Be=JSON.parse('{"button_switcher":"\u041a\u043e\u043b\u043e\u043d\u043a\u0438"}'),Ce=(0,ce.N)({en:Se,ru:Be},"TableColumnSetup"),je=(0,v.om)("table-column-setup"),we=e=>{const{switcher:t,renderSwitcher:s,disabled:l,popupWidth:r,popupPlacement:o,className:c,items:u,sortable:p=!0,showStatus:m,onUpdate:I,hideApplyButton:h}=e,{t:f}=Ce.useTranslation(),x=()=>{if(!m)return null;const e=`${u.reduce(((e,t)=>t.selected?e+1:e),0)}/${u.length}`;return(0,n.jsx)("span",{className:je("status"),children:e})},y=u.map((({id:e,title:t,required:s,selected:n,sticky:i})=>({id:e,title:t,isRequired:s,isSelected:n,sticky:i})));return(0,n.jsx)(ve,{hideApplyButton:h,items:y,onUpdate:e=>{I(e.map((({id:e,isSelected:t})=>{const s=u.find((t=>t.id===e));return{id:e,selected:t,title:s?.title,required:s?.required}})))},popupPlacement:o,popupWidth:r,renderSwitcher:e=>s?.(e)||t||(0,n.jsxs)(d.$,{disabled:l,onClick:e.onClick,children:[(0,n.jsx)(a.I,{data:i.A}),f("button_switcher"),x()]}),sortable:p,className:je(null,c)})}}}]);