(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[29006,94695],{2748:()=>{},5890:(e,t,a)=>{var n={"./simpleWorker":51929,"./simpleWorker.js":51929,"monaco-editor/esm/vs/base/common/worker/simpleWorker":51929,"monaco-editor/esm/vs/base/common/worker/simpleWorker.js":51929};function s(e){return Promise.resolve().then((()=>{if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a(n[e])}))}s.keys=()=>Object.keys(n),s.id=5890,e.exports=s},9204:(e,t,a)=>{var n={"./editorBaseApi":[73848],"./editorBaseApi.js":[73848],"./editorSimpleWorker":[16545],"./editorSimpleWorker.js":[16545],"./editorWorker":[10920],"./editorWorker.js":[10920],"./editorWorkerHost":[80718],"./editorWorkerHost.js":[80718],"./findSectionHeaders":[56691],"./findSectionHeaders.js":[56691],"./getIconClasses":[53068],"./getIconClasses.js":[53068],"./languageFeatureDebounce":[32500],"./languageFeatureDebounce.js":[32500],"./languageFeatures":[56942],"./languageFeatures.js":[56942],"./languageFeaturesService":[76007],"./languageFeaturesService.js":[76007],"./languageService":[17890],"./languageService.js":[17890],"./languagesAssociations":[99908],"./languagesAssociations.js":[99908],"./languagesRegistry":[69259],"./languagesRegistry.js":[69259],"./markerDecorations":[37550],"./markerDecorations.js":[37550],"./markerDecorationsService":[30707],"./markerDecorationsService.js":[30707],"./model":[23750],"./model.js":[23750],"./modelService":[16363],"./modelService.js":[16363],"./resolverService":[18938],"./resolverService.js":[18938],"./semanticTokensDto":[98232],"./semanticTokensDto.js":[98232],"./semanticTokensProviderStyling":[45538],"./semanticTokensProviderStyling.js":[45538],"./semanticTokensStyling":[74243],"./semanticTokensStyling.js":[74243],"./semanticTokensStylingService":[27004],"./semanticTokensStylingService.js":[27004],"./textModelSync/textModelSync.impl":[47443],"./textModelSync/textModelSync.impl.js":[47443],"./textModelSync/textModelSync.protocol":[28868,28868],"./textModelSync/textModelSync.protocol.js":[28868,28868],"./textResourceConfiguration":[90360],"./textResourceConfiguration.js":[90360],"./treeSitterParserService":[44432],"./treeSitterParserService.js":[44432],"./treeViewsDnd":[36723],"./treeViewsDnd.js":[36723],"./treeViewsDndService":[29100],"./treeViewsDndService.js":[29100],"./unicodeTextModelHighlighter":[74855],"./unicodeTextModelHighlighter.js":[74855],"monaco-editor/esm/vs/editor/common/services/editorBaseApi":[73848],"monaco-editor/esm/vs/editor/common/services/editorBaseApi.js":[73848],"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker":[16545],"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js":[16545],"monaco-editor/esm/vs/editor/common/services/editorWorker":[10920],"monaco-editor/esm/vs/editor/common/services/editorWorker.js":[10920],"monaco-editor/esm/vs/editor/common/services/editorWorkerHost":[80718],"monaco-editor/esm/vs/editor/common/services/editorWorkerHost.js":[80718],"monaco-editor/esm/vs/editor/common/services/findSectionHeaders":[56691],"monaco-editor/esm/vs/editor/common/services/findSectionHeaders.js":[56691],"monaco-editor/esm/vs/editor/common/services/getIconClasses":[53068],"monaco-editor/esm/vs/editor/common/services/getIconClasses.js":[53068],"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce":[32500],"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js":[32500],"monaco-editor/esm/vs/editor/common/services/languageFeatures":[56942],"monaco-editor/esm/vs/editor/common/services/languageFeatures.js":[56942],"monaco-editor/esm/vs/editor/common/services/languageFeaturesService":[76007],"monaco-editor/esm/vs/editor/common/services/languageFeaturesService.js":[76007],"monaco-editor/esm/vs/editor/common/services/languageService":[17890],"monaco-editor/esm/vs/editor/common/services/languageService.js":[17890],"monaco-editor/esm/vs/editor/common/services/languagesAssociations":[99908],"monaco-editor/esm/vs/editor/common/services/languagesAssociations.js":[99908],"monaco-editor/esm/vs/editor/common/services/languagesRegistry":[69259],"monaco-editor/esm/vs/editor/common/services/languagesRegistry.js":[69259],"monaco-editor/esm/vs/editor/common/services/markerDecorations":[37550],"monaco-editor/esm/vs/editor/common/services/markerDecorations.js":[37550],"monaco-editor/esm/vs/editor/common/services/markerDecorationsService":[30707],"monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js":[30707],"monaco-editor/esm/vs/editor/common/services/model":[23750],"monaco-editor/esm/vs/editor/common/services/model.js":[23750],"monaco-editor/esm/vs/editor/common/services/modelService":[16363],"monaco-editor/esm/vs/editor/common/services/modelService.js":[16363],"monaco-editor/esm/vs/editor/common/services/resolverService":[18938],"monaco-editor/esm/vs/editor/common/services/resolverService.js":[18938],"monaco-editor/esm/vs/editor/common/services/semanticTokensDto":[98232],"monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js":[98232],"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling":[45538],"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling.js":[45538],"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling":[74243],"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js":[74243],"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService":[27004],"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js":[27004],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl":[47443],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl.js":[47443],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol":[28868,28868],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js":[28868,28868],"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration":[90360],"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration.js":[90360],"monaco-editor/esm/vs/editor/common/services/treeSitterParserService":[44432],"monaco-editor/esm/vs/editor/common/services/treeSitterParserService.js":[44432],"monaco-editor/esm/vs/editor/common/services/treeViewsDnd":[36723],"monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js":[36723],"monaco-editor/esm/vs/editor/common/services/treeViewsDndService":[29100],"monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js":[29100],"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter":[74855],"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter.js":[74855]};function s(e){if(!a.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],s=t[0];return Promise.all(t.slice(1).map(a.e)).then((()=>a(s)))}s.keys=()=>Object.keys(n),s.id=9204,e.exports=s},29096:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Tenant:()=>Xx});var n=a(59284),s=a(61750),r=a(80987),i=a(64689),o=a(98167),l=a(61283),c=a(77506),d=a(60712);const u=(0,c.cn)("kv-split"),m=[0,100],p=[50,50];const h=function(e){const[t,a]=n.useState(),s=t=>{const{defaultSizePaneKey:a}=e;localStorage.setItem(a,t.join(","))};return n.useEffect((()=>{const{collapsedSizes:t,triggerCollapse:n}=e;if(n){const e=t||m;s(e),a(e)}}),[e.triggerCollapse]),n.useEffect((()=>{const{triggerExpand:t,defaultSizes:n}=e,r=n||p;t&&(s(r),a(r))}),[e.triggerExpand]),(0,d.jsx)(n.Fragment,{children:(0,d.jsx)(l.A,{direction:e.direction||"horizontal",sizes:t||(()=>{var t;const{defaultSizePaneKey:a,defaultSizes:n=p,initialSizes:s}=e;if(s)return s;return(null===(t=localStorage.getItem(a))||void 0===t?void 0:t.split(",").map(Number))||n})(),minSize:e.minSize||[0,0],onDrag:t=>{const{onSplitDragAdditional:a}=e;a&&a(),s(t)},className:u(null,e.direction||"horizontal"),gutterSize:8,onDragStart:()=>{const{onSplitStartDragAdditional:t}=e;t&&t(),a(void 0)},expandToMin:!0,children:e.children})})};var v=a(40174),g=a(21334);const y=g.F.injectEndpoints({endpoints:e=>({getOverview:e.query({queryFn:async({path:e,database:t,timeout:a},{signal:n})=>{try{return{data:await window.api.viewer.getDescribe({path:e,database:t,timeout:a},{signal:n})}}catch(s){return{error:s}}},serializeQueryArgs:({queryArgs:e})=>{const{database:t,path:a}=e;return{database:t,path:a}},keepUnusedDataFor:0,providesTags:["All","SchemaTree"]})})});var x=a(29078),f=a(76086),b=a(90182),j=a(81288),T=a(22680),S=a(52531),w=a(23871),N=a(52905),E=a(90053);const C=(0,c.cn)("ydb-drawer"),P=n.createContext({containerWidth:0,itemContainerRef:null,setContainerWidth:()=>{}}),I=({children:e,className:t})=>{const[a,s]=n.useState(0),r=n.useRef(null),i=n.useRef(null);n.useEffect((()=>{if(!r.current)return;const e=()=>{r.current&&s(r.current.clientWidth)};e();const t=new ResizeObserver(e);return t.observe(r.current),()=>{r.current&&t.disconnect()}}),[]);const o=n.useMemo((()=>({containerWidth:a,setContainerWidth:s,itemContainerRef:i})),[a]);return(0,d.jsx)(P.Provider,{value:o,children:(0,d.jsxs)("div",{ref:r,className:C("drawer-container",t),children:[e,(0,d.jsx)("div",{ref:i,className:C("item-container")})]})})};var D=a(67028),_=a(18517),A=a(24555),R=a(74321),k=a(44508),O=a(52248),M=a(90565),L=a(49818),q=a(56839),z=a(61758),F=a.n(z),U=a(92459),Q=a(58351);const $=(0,c.cn)("heatmap"),B={width:0,height:0},H=10,W=e=>{const[t,a]=n.useState(B),{tablets:s}=e,r=n.useRef(null),i=n.useRef(null);n.useEffect((()=>{const e=r.current,a=e.getContext("2d");a.clearRect(0,0,e.offsetWidth,e.offsetHeight),s.map(function(e){return(a,n)=>{const{columnsCount:s}=t,r=n%s*12,i=12*Math.floor(n/s);e.fillStyle=a.color||"grey",e.fillRect(r,i,H,H)}}(a))})),n.useLayoutEffect((()=>{const e=i.current;if(e){const t=e.offsetWidth-15,n=Math.floor(t/12),r=Math.ceil(s.length/n);a({width:t,height:12*r,columnsCount:n,rowsCount:r})}}),[]);const o=()=>{let e=r.current,t=0;for(;e;)t+=e.offsetTop,e=e.offsetParent;return t},l=()=>{let e=r.current,t=0;for(;e;)t+=e.offsetLeft,e=e.offsetParent;return t},c=(e,a)=>{const{columnsCount:n}=t,s=Math.floor(e/12);return n*Math.floor(a/12)+s},u=F()(((t,a)=>{const n=new CustomEvent("scroll");window.dispatchEvent(n);const r=e.parentRef.current,i=t-l()+r.scrollLeft,d=a-o()+r.scrollTop,u=c(i,d),m=s[u];if(m){const n={name:m.currentMetric,value:m.formattedValue};e.showTooltip(void 0,m,"tablet",n,{left:t-20,top:a-20})}else e.hideTooltip()}),20);return(0,d.jsx)("div",{ref:i,className:$("canvas-container"),onMouseLeave:()=>{setTimeout((()=>{e.hideTooltip()}),40)},children:(0,d.jsx)("canvas",{ref:r,width:t.width,height:t.height,onClick:t=>{const a=e.parentRef.current,n=t.clientX-l()+a.scrollLeft,r=t.clientY-o()+a.scrollTop,i=c(n,r),d=s[i];d&&window.open((e=>{const{TabletId:t}=e,a=window.location.hostname,n=(0,U.DM)(t);return`https://${[a,Q.P8,n].map((e=>e.startsWith("/")?e.slice(1):e)).filter(Boolean).join("/")}`})(d),"_blank")},onMouseMove:e=>u(e.clientX,e.clientY)})})},G={r:255,g:4,b:0},V={r:255,g:219,b:77},J={r:59,g:201,b:53},K={CPU:{min:0,max:1e6},Network:{min:0,max:1e9},Storage:{min:0,max:2e9},DataSize:{min:0,max:2e9},RowCount:{min:0},IndexSize:{min:0}},Y=e=>{const t=e.toString(16);return 1===t.length?`0${t}`:t},Z=(e,t,a)=>{if(1===e)return[t];if(2===e)return[t,a];const n=(t.r-a.r)/(e-1),s=(t.g-a.g)/(e-1),r=(t.b-a.b)/(e-1),i=[];for(let o=0;o<e;o++)i.push({r:Math.round(t.r-n*o),g:Math.round(t.g-s*o),b:Math.round(t.b-r*o)});return i.map((e=>(({r:e,g:t,b:a})=>`#${Y(e)}${Y(t)}${Y(a)}`)(e)))},X=e=>{const t=Math.floor(e/2),a=t+1;return[...Z(e%2===0?t:t+1,J,V),...Z(a,V,G).slice(1)]},ee=(e,t)=>{const a=new Set,n=K[e]||{};t.forEach((t=>{var n;a.add(Number(null===(n=t.metrics)||void 0===n?void 0:n[e]))})),Number.isInteger(n.min)&&a.add(n.min),Number.isInteger(n.max)&&a.add(n.max);const s=Array.from(a.values()).sort(((e,t)=>e-t));return{min:s[0],max:s[s.length-1]}},te=(0,c.cn)("histogram"),ae=e=>{const t=n.useRef(),{data:a={},maxCount:s}=e,{count:r,leftBound:i,rightBound:o,color:l}=a,c=r/s*100;return(0,d.jsx)("div",{ref:t,className:te("item"),style:{backgroundColor:l,height:`${c}%`},onMouseEnter:()=>{const a=t.current;e.showTooltip(a,{count:r,leftBound:i,rightBound:o},"histogram")},onMouseLeave:e.hideTooltip})},ne=e=>{const{tablets:t,currentMetric:a}=e,{min:n,max:s}=ee(a,t),r=X(50),i=(s-n)/50,o=r.map(((e,t)=>({color:e,count:0,leftBound:(0,q.ZV)(n+t*i),rightBound:(0,q.ZV)(n+(t+1)*i)})));let l=0;t.forEach((e=>{var t,n;const s=a&&Number(null===(t=e.metrics)||void 0===t?void 0:t[a]),r=Math.floor(s/i),c=(null===(n=o[r])||void 0===n?void 0:n.count)+1;c>l&&(l=c),o[r]={...o[r],count:c}}));return(0,d.jsx)("div",{className:te(),children:(0,d.jsxs)("div",{className:te("chart"),children:[Boolean(s)&&o.map(((t,a)=>(0,d.jsx)(ae,{data:t,maxCount:l,showTooltip:e.showTooltip,hideTooltip:e.hideTooltip},a))),(0,d.jsx)("div",{className:te("x-min"),children:(0,q.ZV)(n)}),(0,d.jsx)("div",{className:te("x-max"),children:(0,q.ZV)(s)}),(0,d.jsx)("div",{className:te("y-min"),children:"0"}),(0,d.jsx)("div",{className:te("y-max"),children:(0,q.ZV)(l)})]})})},se=(0,c.cn)("heatmap"),re=X(500),ie=({path:e,database:t})=>{const a=(0,b.YQ)(),s=n.createRef(),[r]=(0,b.Nt)(),{currentData:i,isFetching:o,error:l}=M.f1.useGetHeatmapTabletsInfoQuery({path:e,database:t},{pollingInterval:r}),c=o&&void 0===i,{tablets:u=[],metrics:m}=i||{},{sort:p,heatmap:h,currentMetric:v}=(0,b.N4)((e=>e.heatmap)),g=(...e)=>{a((0,L.DK)(...e))},y=()=>{a((0,L.w7)())},x=e=>{a((0,M.nd)({currentMetric:e[0]}))},f=()=>{a((0,M.nd)({sort:!p}))},j=()=>{a((0,M.nd)({heatmap:!h}))},T=()=>{const{min:e,max:t}=ee(v,u),a=u.map((a=>{var n;const s=v&&Number(null===(n=a.metrics)||void 0===n?void 0:n[v]),r=((e,t,a)=>0===a?0:Math.round((e-t)/(a-t)*499))(s,e,t),i=re[r];return{...a,color:i,value:s,formattedValue:(0,q.ZV)(s),currentMetric:v}})),n=p?a.sort(((e,t)=>Number(t.value)-Number(e.value))):a;return(0,d.jsx)("div",{ref:s,className:se("items"),children:(0,d.jsx)(W,{tablets:n,parentRef:s,showTooltip:g,hideTooltip:y})})};return c?(0,d.jsx)(O.a,{}):(()=>{const{min:e,max:t}=ee(v,u);let a;return l&&!i||(a=h?T():(0,d.jsx)(ne,{tablets:u,currentMetric:v,showTooltip:g,hideTooltip:y})),(0,d.jsxs)("div",{className:se(),children:[(0,d.jsxs)("div",{className:se("filters"),children:[(0,d.jsx)(A.l,{className:se("heatmap-select"),value:v?[v]:[],options:m,onUpdate:x,width:200}),(0,d.jsx)("div",{className:se("sort-checkbox"),children:(0,d.jsx)(R.S,{onUpdate:f,checked:p,children:"Sort"})}),(0,d.jsx)("div",{className:se("histogram-checkbox"),children:(0,d.jsx)(R.S,{onUpdate:j,checked:h,children:"Heatmap"})}),(0,d.jsxs)("div",{className:se("limits"),children:[(0,d.jsxs)("div",{className:se("limits-block"),children:[(0,d.jsx)("div",{className:se("limits-title"),children:"min:"}),(0,d.jsx)("div",{className:se("limits-value"),children:Number.isInteger(e)?(0,q.ZV)(e):"\u2014"})]}),(0,d.jsxs)("div",{className:se("limits-block"),children:[(0,d.jsx)("div",{className:se("limits-title"),children:"max:"}),(0,d.jsx)("div",{className:se("limits-value"),children:Number.isInteger(t)?(0,q.ZV)(t):"\u2014"})]}),(0,d.jsxs)("div",{className:se("limits-block"),children:[(0,d.jsx)("div",{className:se("limits-title"),children:"count:"}),(0,d.jsx)("div",{className:se("limits-value"),children:(0,q.ZV)(u.length)})]})]})]}),l?(0,d.jsx)(k.o,{error:l}):null,a]})})()};var oe=a(11363),le=a(59109),ce=a(17594),de=a(69326);const ue=g.F.injectEndpoints({endpoints:e=>({getOperationList:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.operation.getOperationList(e,{signal:t})}}catch(a){return{error:a}}},providesTags:["All"]}),cancelOperation:e.mutation({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.operation.cancelOperation(e,{signal:t})}}catch(a){return{error:a}}}}),forgetOperation:e.mutation({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.operation.forgetOperation(e,{signal:t})}}catch(a){return{error:a}}}})}),overrideExisting:"throw"});var me=a(28539),pe=a(95963),he=a(48372);const ve=JSON.parse('{"label_operations":"Operations","title_empty":"No operations data","pleaceholder_search":"Search operations","placeholder_kind":"Select operation kind","kind_ssBackgrounds":"SS/Backgrounds","kind_export_s3":"Export/S3","kind_export_yt":"Export/YT","kind_import_s3":"Import/S3","kind_buildIndex":"Build Index","column_operationId":"Operation ID","column_status":"Status","column_createdBy":"Created By","column_createTime":"Create Time","column_endTime":"End Time","column_duration":"Duration","label_duration-ongoing":"{{value}} (ongoing)","header_cancel":"Cancel operation","header_forget":"Forget operation","text_cancel":"The operation will be cancelled. Do you want to proceed?","text_forget":"The operation will be forgotten. Do you want to proceed?","text_forgotten":"The operation {{id}} has been forgotten","text_cancelled":"The operation {{id}} has been cancelled"}'),ge=(0,he.g4)("ydb-operations",{en:ve}),ye="id",xe="status",fe="created_by",be="create_time",je="end_time",Te="duration",Se={[ye]:ge("column_operationId"),[xe]:ge("column_status"),[fe]:ge("column_createdBy"),[be]:ge("column_createTime"),[je]:ge("column_endTime"),[Te]:ge("column_duration")},we=[{value:"export/s3",content:ge("kind_export_s3")},{value:"export/yt",content:ge("kind_export_yt")},{value:"import/s3",content:ge("kind_import_s3")},{value:"ss/backgrounds",content:ge("kind_ssBackgrounds")},{value:"buildindex",content:ge("kind_buildIndex")}],Ne=(0,c.cn)("operations");function Ee({kind:e,searchValue:t,entitiesCountCurrent:a,entitiesCountTotal:s,entitiesLoading:r,handleKindChange:i,handleSearchChange:o}){return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(pe.v,{value:t,onChange:o,placeholder:ge("pleaceholder_search"),className:Ne("search")}),(0,d.jsx)(A.l,{value:[e],width:150,options:we,onUpdate:e=>i(e[0])}),(0,d.jsx)(me.T,{label:ge("label_operations"),loading:r,total:s,current:a})]})}var Ce=a(14750),Pe=a(58272),Ie=a(45345),De=a(98089),_e=a(87184),Ae=a(60865),Re=a(99991),ke=a(22983),Oe=a(71661);let Me=function(e){return e.STATUS_CODE_UNSPECIFIED="STATUS_CODE_UNSPECIFIED",e.SUCCESS="SUCCESS",e.BAD_REQUEST="BAD_REQUEST",e.UNAUTHORIZED="UNAUTHORIZED",e.INTERNAL_ERROR="INTERNAL_ERROR",e.ABORTED="ABORTED",e.UNAVAILABLE="UNAVAILABLE",e.OVERLOADED="OVERLOADED",e.SCHEME_ERROR="SCHEME_ERROR",e.GENERIC_ERROR="GENERIC_ERROR",e.TIMEOUT="TIMEOUT",e.BAD_SESSION="BAD_SESSION",e.PRECONDITION_FAILED="PRECONDITION_FAILED",e.ALREADY_EXISTS="ALREADY_EXISTS",e.NOT_FOUND="NOT_FOUND",e.SESSION_EXPIRED="SESSION_EXPIRED",e.CANCELLED="CANCELLED",e.UNDETERMINED="UNDETERMINED",e.UNSUPPORTED="UNSUPPORTED",e.SESSION_BUSY="SESSION_BUSY",e.EXTERNAL_ERROR="EXTERNAL_ERROR",e}({});var Le=a(59625);const qe=function({name:e,title:t,type:a,content:n,autoHiding:s,className:r}){return Le.X.add({name:null!==e&&void 0!==e?e:"Request succeeded",title:null!==t&&void 0!==t?t:"Request succeeded",theme:"error"===a?"danger":"success",content:n,isClosable:!0,autoHiding:null!==s&&void 0!==s?s:"success"===a&&5e3,className:r})};var ze=a(73891);function Fe({database:e,refreshTable:t}){return[{name:ye,header:Se[ye],width:340,render:({row:e})=>e.id?(0,d.jsx)(Oe.s,{placement:["top","bottom"],content:e.id,children:e.id}):f.Pd},{name:xe,header:Se[xe],render:({row:e})=>e.status?(0,d.jsx)(De.E,{color:e.status===Me.SUCCESS?"positive":"danger",children:e.status}):f.Pd},{name:fe,header:Se[fe],render:({row:e})=>e.created_by?e.created_by:f.Pd},{name:be,header:Se[be],render:({row:e})=>e.create_time?(0,q.r6)((0,ze.ee)(e.create_time)):f.Pd,sortAccessor:e=>e.create_time?(0,ze.ee)(e.create_time):0},{name:je,header:Se[je],render:({row:e})=>e.end_time?(0,q.r6)((0,ze.ee)(e.end_time)):f.Pd,sortAccessor:e=>e.end_time?(0,ze.ee)(e.end_time):Number.MAX_SAFE_INTEGER},{name:Te,header:Se[Te],render:({row:e})=>{let t=0;if(!e.create_time)return f.Pd;const a=(0,ze.ee)(e.create_time);if(e.end_time){t=(0,ze.ee)(e.end_time)-a}else t=Date.now()-a;const n=t>f.Jg*f.KF?(0,Ce.p0)(t).format("hh:mm:ss"):(0,Ce.p0)(t).format("mm:ss");return e.end_time?n:ge("label_duration-ongoing",{value:n})},sortAccessor:e=>{if(!e.create_time)return 0;const t=(0,ze.ee)(e.create_time);if(e.end_time){return(0,ze.ee)(e.end_time)-t}return Date.now()-t}},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:a})=>(0,d.jsx)(Ue,{operation:a,database:e,refreshTable:t})}]}function Ue({operation:e,database:t,refreshTable:a}){const[n,{isLoading:s}]=ue.useCancelOperationMutation(),[r,{isLoading:i}]=ue.useForgetOperationMutation(),o=e.id;return o?(0,d.jsxs)(_e.s,{gap:"2",children:[(0,d.jsx)(Ae.m,{title:ge("header_forget"),placement:["left","auto"],children:(0,d.jsx)("div",{children:(0,d.jsx)(ke.B,{buttonView:"outlined",dialogHeader:ge("header_forget"),dialogText:ge("text_forget"),onConfirmAction:()=>r({id:o,database:t}).unwrap().then((()=>{qe({name:"Forgotten",title:ge("text_forgotten",{id:o}),type:"success"}),a()})),buttonDisabled:s,children:(0,d.jsx)(Re.I,{data:Pe.A})})})}),(0,d.jsx)(Ae.m,{title:ge("header_cancel"),placement:["right","auto"],children:(0,d.jsx)("div",{children:(0,d.jsx)(ke.B,{buttonView:"outlined",dialogHeader:ge("header_cancel"),dialogText:ge("text_cancel"),onConfirmAction:()=>n({id:o,database:t}).unwrap().then((()=>{qe({name:"Cancelled",title:ge("text_cancelled",{id:o}),type:"success"}),a()})),buttonDisabled:i,children:(0,d.jsx)(Re.I,{data:Ie.A})})})})]}):null}var Qe=a(370);const $e=Qe.z.enum(["ss/backgrounds","export/s3","export/yt","import/s3","buildindex"]).catch("buildindex");function Be({database:e}){var t;const[a]=(0,b.Nt)(),{kind:s,searchValue:i,pageSize:o,pageToken:l,handleKindChange:c,handleSearchChange:u}=function(){var e,t,a;const[n,s]=(0,r.useQueryParams)({kind:r.StringParam,search:r.StringParam,pageSize:r.NumberParam,pageToken:r.StringParam});return{kind:$e.parse(n.kind),searchValue:null!==(e=n.search)&&void 0!==e?e:"",pageSize:null!==(t=n.pageSize)&&void 0!==t?t:void 0,pageToken:null!==(a=n.pageToken)&&void 0!==a?a:void 0,handleKindChange:e=>{s({kind:e},"replaceIn")},handleSearchChange:e=>{s({search:e||void 0},"replaceIn")},handlePageSizeChange:e=>{s({pageSize:e},"replaceIn")},handlePageTokenChange:e=>{s({pageToken:e},"replaceIn")}}}(),{data:m,isLoading:p,error:h,refetch:v}=ue.useGetOperationListQuery({database:e,kind:s,page_size:o,page_token:l},{pollingInterval:a}),g=n.useMemo((()=>null!==m&&void 0!==m&&m.operations?m.operations.filter((e=>{var t;return null===(t=e.id)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase())})):[]),[null===m||void 0===m?void 0:m.operations,i]);return(0,j.Pq)(h)?(0,d.jsx)(le.O,{position:"left"}):(0,d.jsxs)(de.L,{children:[(0,d.jsx)(de.L.Controls,{children:(0,d.jsx)(Ee,{kind:s,searchValue:i,entitiesCountCurrent:g.length,entitiesCountTotal:null===m||void 0===m||null===(t=m.operations)||void 0===t?void 0:t.length,entitiesLoading:p,handleKindChange:c,handleSearchChange:u})}),h?(0,d.jsx)(k.o,{error:h}):null,(0,d.jsx)(de.L.Table,{loading:p,className:Ne("table"),children:m?(0,d.jsx)(ce.l,{columns:Fe({database:e,refreshTable:v}),columnsWidthLSKey:"selectedOperationColumns",data:g,emptyDataMessage:ge("title_empty")}):null})]})}var He=a(47199),We=a(71635),Ge=a(19228),Ve=a(11822);function Je(e){return`SELECT * FROM \`${e}\` LIMIT 0`}const Ke=g.F.injectEndpoints({endpoints:e=>({getViewSchema:e.query({queryFn:async({database:e,path:t,timeout:a})=>{try{var n,s;const r=await window.api.viewer.sendQuery({query:Je(t),database:e,action:"execute-scan",timeout:a},{withRetries:!0});return(0,Ve.We)(r)?{error:r}:{data:(null===r||void 0===r||null===(n=r.result)||void 0===n||null===(s=n[0])||void 0===s?void 0:s.columns)||[]}}catch(r){return{error:r}}},serializeQueryArgs:({queryArgs:e})=>{const{database:t,path:a}=e;return{database:t,path:a}},providesTags:["All","SchemaTree"]})}),overrideExisting:"throw"});let Ye=function(e){return e.EPathTypeInvalid="EPathTypeInvalid",e.EPathTypeDir="EPathTypeDir",e.EPathTypeTable="EPathTypeTable",e.EPathTypePersQueueGroup="EPathTypePersQueueGroup",e.EPathTypeSubDomain="EPathTypeSubDomain",e.EPathTypeTableIndex="EPathTypeTableIndex",e.EPathTypeExtSubDomain="EPathTypeExtSubDomain",e.EPathTypeColumnStore="EPathTypeColumnStore",e.EPathTypeColumnTable="EPathTypeColumnTable",e.EPathTypeCdcStream="EPathTypeCdcStream",e.EPathTypeExternalDataSource="EPathTypeExternalDataSource",e.EPathTypeExternalTable="EPathTypeExternalTable",e.EPathTypeView="EPathTypeView",e.EPathTypeReplication="EPathTypeReplication",e.EPathTypeTransfer="EPathTypeTransfer",e.EPathTypeResourcePool="EPathTypeResourcePool",e}({}),Ze=function(e){return e.EPathSubTypeEmpty="EPathSubTypeEmpty",e.EPathSubTypeSyncIndexImplTable="EPathSubTypeSyncIndexImplTable",e.EPathSubTypeAsyncIndexImplTable="EPathSubTypeAsyncIndexImplTable",e.EPathSubTypeStreamImpl="EPathSubTypeStreamImpl",e}({});let Xe=function(e){return e.ColumnCodecPlain="ColumnCodecPlain",e.ColumnCodecLZ4="ColumnCodecLZ4",e.ColumnCodecZSTD="ColumnCodecZSTD",e}({});let et=function(e){return e.METERING_MODE_RESERVED_CAPACITY="METERING_MODE_RESERVED_CAPACITY",e.METERING_MODE_REQUEST_UNITS="METERING_MODE_REQUEST_UNITS",e}({});const tt={[Ze.EPathSubTypeSyncIndexImplTable]:"index_table",[Ze.EPathSubTypeAsyncIndexImplTable]:"index_table",[Ze.EPathSubTypeStreamImpl]:void 0,[Ze.EPathSubTypeEmpty]:void 0},at={[Ye.EPathTypeInvalid]:void 0,[Ye.EPathTypeSubDomain]:"database",[Ye.EPathTypeExtSubDomain]:"database",[Ye.EPathTypeDir]:"directory",[Ye.EPathTypeColumnStore]:"directory",[Ye.EPathTypeTable]:"table",[Ye.EPathTypeTableIndex]:"index",[Ye.EPathTypeColumnTable]:"column_table",[Ye.EPathTypeCdcStream]:"stream",[Ye.EPathTypePersQueueGroup]:"topic",[Ye.EPathTypeExternalDataSource]:"external_data_source",[Ye.EPathTypeExternalTable]:"external_table",[Ye.EPathTypeView]:"view",[Ye.EPathTypeReplication]:"async_replication",[Ye.EPathTypeTransfer]:"transfer",[Ye.EPathTypeResourcePool]:"resource_pool"},nt={table:Ye.EPathTypeTable,index:Ye.EPathTypeTableIndex,column_table:Ye.EPathTypeColumnTable,external_table:Ye.EPathTypeExternalTable,view:Ye.EPathTypeView},st=(e=Ye.EPathTypeDir,t,a="directory")=>t&&tt[t]||at[e]||a,rt={[Ze.EPathSubTypeSyncIndexImplTable]:"Secondary Index Table",[Ze.EPathSubTypeAsyncIndexImplTable]:"Secondary Index Table",[Ze.EPathSubTypeStreamImpl]:void 0,[Ze.EPathSubTypeEmpty]:void 0},it={[Ye.EPathTypeInvalid]:void 0,[Ye.EPathTypeSubDomain]:"Database",[Ye.EPathTypeExtSubDomain]:"Database",[Ye.EPathTypeDir]:"Directory",[Ye.EPathTypeTable]:"Table",[Ye.EPathTypeTableIndex]:"Secondary Index",[Ye.EPathTypeColumnStore]:"Tablestore",[Ye.EPathTypeColumnTable]:"Column-oriented table",[Ye.EPathTypeCdcStream]:"Changefeed",[Ye.EPathTypePersQueueGroup]:"Topic",[Ye.EPathTypeExternalDataSource]:"External Data Source",[Ye.EPathTypeExternalTable]:"External Table",[Ye.EPathTypeView]:"View",[Ye.EPathTypeReplication]:"Async Replication",[Ye.EPathTypeTransfer]:"Transfer",[Ye.EPathTypeResourcePool]:"Resource Pool"},ot={UnknownTenantType:"Database",Domain:"Cluster Root",Dedicated:"Dedicated Database",Shared:"Shared Database",Serverless:"Serverless Database"},lt={[Ye.EPathTypeTable]:!0,[Ye.EPathTypeColumnTable]:!0,[Ye.EPathTypeExternalTable]:!0,[Ye.EPathTypeView]:!0,[Ye.EPathTypeInvalid]:!1,[Ye.EPathTypeDir]:!1,[Ye.EPathTypeSubDomain]:!1,[Ye.EPathTypeTableIndex]:!1,[Ye.EPathTypeExtSubDomain]:!1,[Ye.EPathTypeColumnStore]:!1,[Ye.EPathTypeCdcStream]:!1,[Ye.EPathTypePersQueueGroup]:!1,[Ye.EPathTypeExternalDataSource]:!1,[Ye.EPathTypeReplication]:!1,[Ye.EPathTypeTransfer]:!1,[Ye.EPathTypeResourcePool]:!1},ct=e=>{var t;return null!==(t=e&&lt[e])&&void 0!==t&&t},dt={[Ze.EPathSubTypeSyncIndexImplTable]:!0,[Ze.EPathSubTypeAsyncIndexImplTable]:!0,[Ze.EPathSubTypeStreamImpl]:!1,[Ze.EPathSubTypeEmpty]:!1},ut=e=>{var t;return null!==(t=e&&dt[e])&&void 0!==t&&t},mt={[Ye.EPathTypeColumnStore]:!0,[Ye.EPathTypeColumnTable]:!0,[Ye.EPathTypeInvalid]:!1,[Ye.EPathTypeDir]:!1,[Ye.EPathTypeTable]:!1,[Ye.EPathTypeSubDomain]:!1,[Ye.EPathTypeTableIndex]:!1,[Ye.EPathTypeExtSubDomain]:!1,[Ye.EPathTypeCdcStream]:!1,[Ye.EPathTypePersQueueGroup]:!1,[Ye.EPathTypeExternalDataSource]:!1,[Ye.EPathTypeExternalTable]:!1,[Ye.EPathTypeView]:!1,[Ye.EPathTypeReplication]:!1,[Ye.EPathTypeTransfer]:!1,[Ye.EPathTypeResourcePool]:!1},pt=e=>{var t;return null!==(t=e&&mt[e])&&void 0!==t&&t},ht={[Ye.EPathTypeSubDomain]:!0,[Ye.EPathTypeExtSubDomain]:!0,[Ye.EPathTypeInvalid]:!1,[Ye.EPathTypeDir]:!1,[Ye.EPathTypeColumnStore]:!1,[Ye.EPathTypeColumnTable]:!1,[Ye.EPathTypeTable]:!1,[Ye.EPathTypeTableIndex]:!1,[Ye.EPathTypeCdcStream]:!1,[Ye.EPathTypePersQueueGroup]:!1,[Ye.EPathTypeExternalDataSource]:!1,[Ye.EPathTypeExternalTable]:!1,[Ye.EPathTypeView]:!1,[Ye.EPathTypeReplication]:!1,[Ye.EPathTypeTransfer]:!1,[Ye.EPathTypeResourcePool]:!1},vt=e=>{var t;return null!==(t=e&&ht[e])&&void 0!==t&&t},gt={[Ze.EPathSubTypeSyncIndexImplTable]:!0,[Ze.EPathSubTypeAsyncIndexImplTable]:!0,[Ze.EPathSubTypeStreamImpl]:!0,[Ze.EPathSubTypeEmpty]:!1},yt={[Ye.EPathTypeCdcStream]:!1,[Ye.EPathTypePersQueueGroup]:!0,[Ye.EPathTypeExternalDataSource]:!0,[Ye.EPathTypeExternalTable]:!0,[Ye.EPathTypeView]:!0,[Ye.EPathTypeResourcePool]:!0,[Ye.EPathTypeReplication]:!0,[Ye.EPathTypeTransfer]:!0,[Ye.EPathTypeInvalid]:!1,[Ye.EPathTypeColumnStore]:!1,[Ye.EPathTypeColumnTable]:!1,[Ye.EPathTypeDir]:!1,[Ye.EPathTypeTable]:!1,[Ye.EPathTypeSubDomain]:!1,[Ye.EPathTypeTableIndex]:!1,[Ye.EPathTypeExtSubDomain]:!1},xt=(e,t)=>{var a;return null!==(a=t&&gt[t]||e&&yt[e])&&void 0!==a&&a},ft=e=>e===Ye.EPathTypeExternalTable,bt=e=>e===Ye.EPathTypeTable,jt=e=>e===Ye.EPathTypeView;var Tt=a(47665),St=a(24543);const wt=JSON.parse('{"column-title.id":"Id","column-title.name":"Name","column-title.type":"Type","column-title.notNull":"NotNull","column-title.autoIncrement":"AutoIncrement","column-title.defaultValue":"Default","column-title.family":"Family","column-title.media":"Media","column-title.compression":"Compression","primary-key.title":"Primary key:","partitioning-key.title":"Partitioning key:"}'),Nt=(0,he.g4)("ydb-schema-viewer",{en:wt}),Et=(0,c.cn)("schema-viewer");const Ct=({tableData:e,extended:t,type:a})=>{const n="primary"===a?function(e){return e.filter((e=>Boolean(void 0!==e.keyColumnIndex&&-1!==e.keyColumnIndex&&e.name))).sort(((e,t)=>e.keyColumnIndex-t.keyColumnIndex)).map((e=>e.name))}(e):function(e){return e.filter((e=>Boolean(void 0!==e.partitioningColumnIndex&&-1!==e.partitioningColumnIndex&&e.name))).sort(((e,t)=>e.partitioningColumnIndex-t.partitioningColumnIndex)).map((e=>e.name))}(e),s=t?3:n.length,r=n.slice(0,s),i=n.slice(s);return n.length>0?(0,d.jsxs)("div",{className:Et("keys",{summary:!t,type:a}),children:[(0,d.jsx)("div",{className:Et("keys-header"),children:Nt("primary"===a?"primary-key.title":"partitioning-key.title")}),(0,d.jsxs)("div",{className:Et("keys-values"),children:[" "+r.join(", "),i.length?(0,d.jsx)(St.u,{className:Et("more-badge"),placement:["bottom"],hasArrow:!1,pinOnClick:!0,content:(0,d.jsx)("div",{className:Et("popup-content"),children:i.map((e=>(0,d.jsx)("div",{className:Et("popup-item"),children:e},e)))}),children:(0,d.jsx)(Tt.J,{className:Et("keys-label"),children:`+${i.length}`})}):null]})]}):null};var Pt=a(4557);function It({data:e,name:t,header:a,sortable:n}){const s="string"===typeof a?a.length:t.length;let r=n?s+2:s;if(e)for(const i of e){let e=0;if(i[t]&&(e=String(i[t]).length),r=Math.max(r,e),10*r+20>=600)return 600}return 10*r+20}var Dt=a(34671);const _t="name",At="type",Rt="notNull",kt="autoIncrement",Ot="defaultValue",Mt="familyName",Lt="prefferedPoolKind",qt="columnCodec",zt={name:"id",get header(){return Nt("column-title.id")},width:60,align:Pt.Ay.RIGHT,render:({row:e})=>{const t=(0,d.jsx)(Re.I,{className:Et("key-icon"),size:12,data:Dt.A});return(0,d.jsxs)("span",{className:Et("id-wrapper"),children:[e.id,void 0===e.keyColumnIndex||-1===e.keyColumnIndex?null:t]})}},Ft={name:_t,get header(){return Nt("column-title.name")},width:120,render:({row:e})=>e.name},Ut={name:At,get header(){return Nt("column-title.type")},width:100,render:({row:e})=>e.type},Qt={name:Rt,get header(){return Nt("column-title.notNull")},width:100,defaultOrder:Pt.Ay.DESCENDING,render:({row:e})=>{if(e.notNull)return"\u2713"}},$t={name:kt,get header(){return Nt("column-title.autoIncrement")},width:100,defaultOrder:Pt.Ay.DESCENDING,render:({row:e})=>{if(e.autoIncrement)return"\u2713"}},Bt={name:Ot,get header(){return Nt("column-title.defaultValue")},width:100,render:({row:e})=>String(e.defaultValue)},Ht={name:Mt,get header(){return Nt("column-title.family")},width:100,render:({row:e})=>e.familyName},Wt={name:Lt,get header(){return Nt("column-title.media")},width:100,render:({row:e})=>e.prefferedPoolKind},Gt={name:qt,get header(){return Nt("column-title.compression")},width:130,render:({row:e})=>e.columnCodec};function Vt(e,t){if(!t)return e;const a=t.slice(0,100);return e.map((e=>({...e,width:It({data:a,name:e.name,header:"string"===typeof e.header?e.header:void 0,sortable:e.sortable||void 0===e.sortable})})))}function Jt(e={}){const t=function(e){var t,a,n;return null!==(t=null===e||void 0===e||null===(a=e.PartitionConfig)||void 0===a||null===(n=a.ColumnFamilies)||void 0===n?void 0:n.reduce(((e,t)=>t.Id?{...e,[t.Id]:t}:e),{}))&&void 0!==t?t:{}}(e),{Columns:a,KeyColumnNames:n}=e,s=null===a||void 0===a?void 0:a.map((e=>{var a,s,r,i;const{Id:o,Name:l,NotNull:c,Type:d,Family:u,DefaultFromSequence:m,DefaultFromLiteral:p}=e,h=null!==(a=null===n||void 0===n?void 0:n.findIndex((e=>e===l)))&&void 0!==a?a:-1,v=u?t[u].Name:void 0,g=u?null===(s=t[u].StorageConfig)||void 0===s||null===(r=s.Data)||void 0===r?void 0:r.PreferredPoolKind:void 0,y=u?function(e){if(e)return e===Xe.ColumnCodecPlain?"None":e.replace("ColumnCodec","").toLocaleLowerCase()}(t[u].ColumnCodec):void 0;return{id:o,name:l,keyColumnIndex:h,type:d,notNull:c,autoIncrement:Boolean(m),defaultValue:null!==(i=Object.values((null===p||void 0===p?void 0:p.value)||{})[0])&&void 0!==i?i:"-",familyName:v,prefferedPoolKind:g,columnCodec:y}}));return null!==s&&void 0!==s?s:[]}function Kt(e,t){const{Table:a,ColumnTableDescription:n,ExternalTableDescription:s}=(null===t||void 0===t?void 0:t.PathDescription)||{};return bt(e)?Jt(a):pt(e)?function(e={}){const{Schema:t={},Sharding:a={}}=e,{Columns:n,KeyColumnNames:s}=t,{HashSharding:r={}}=a,{Columns:i=[]}=r,o=null===n||void 0===n?void 0:n.map((e=>{var t,a;const{Id:n,Name:r,Type:o,NotNull:l}=e,c=null!==(t=null===s||void 0===s?void 0:s.findIndex((e=>e===r)))&&void 0!==t?t:-1,d=null!==(a=null===i||void 0===i?void 0:i.findIndex((e=>e===r)))&&void 0!==a?a:-1;return{id:n,name:r,keyColumnIndex:c,partitioningColumnIndex:d,type:o,notNull:l}}));return[...(null===o||void 0===o?void 0:o.filter((e=>-1!==e.keyColumnIndex)))||[],...(null===o||void 0===o?void 0:o.filter((e=>-1===e.keyColumnIndex)))||[]]}(n):ft(e)?function(e={}){const{Columns:t}=e;return(null===t||void 0===t?void 0:t.map((e=>{const{Id:t,Name:a,Type:n,NotNull:s}=e;return{id:t,name:a,type:n,notNull:s}})))||[]}(s):[]}function Yt(e){return(null===e||void 0===e?void 0:e.map((e=>{var t;return{type:null!==(t=e.type)&&void 0!==t&&t.endsWith("?")?e.type.slice(0,-1):e.type,name:e.name}})))||[]}const Zt=({type:e,path:t,tenantName:a,extended:s=!1})=>{const[r]=(0,b.Nt)(),i=s?r:void 0,{currentData:o,isFetching:l}=y.useGetOverviewQuery({path:t,database:a},{pollingInterval:i,skip:jt(e)}),{currentData:c,isFetching:u}=Ke.useGetViewSchemaQuery({path:t,database:a},{pollingInterval:i,skip:!jt(e)}),m=u&&void 0===c||l&&void 0===o,p=n.useMemo((()=>jt(e)?Yt(c):Kt(e,o)),[o,e,c]),h=n.useMemo((()=>p.some((e=>e.autoIncrement))),[p]),v=n.useMemo((()=>p.some((e=>e.defaultValue))),[p]),g=n.useMemo((()=>jt(e)?Vt([Ft,Ut],p):ft(e)||pt(e)?function(e){return Vt([zt,Ft,Ut,Qt],e)}(p):bt(e)?function(e,t,a,n){const s=[zt,Ft,Ut,Qt];return n&&s.push(Bt),t&&s.push(Ht,Wt,Gt),a&&s.push($t),Vt(s,e)}(p,s,h,v):[]),[e,s,h,v,p]);return m?(0,d.jsx)(Ge.Q,{}):(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:Et("keys-wrapper"),children:[(0,d.jsx)(Ct,{tableData:p,extended:s,type:"primary"}),(0,d.jsx)(Ct,{tableData:p,extended:s,type:"partitioning"})]}),(0,d.jsx)("div",{className:Et(),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:"schemaTableColumnsWidth",data:p,columns:g,settings:f.N3})})]})};var Xt=a(96589),ea=a(84375),ta=a(85589);const aa=JSON.parse('{"td-feature-flag":"Feature flag","td-default":"Default","td-current":"Current","enabled":"Enabled","disabled":"Disabled","flag-touched":"Flag is changed","search-placeholder":"Search by feature flag","search-empty":"Empty search result","no-data":"No data"}'),na=(0,he.g4)("ydb-diagnostics-configs",{en:aa}),sa=(0,c.cn)("ydb-diagnostics-configs"),ra=[{name:"Touched",header:"",render:({row:e})=>e.Current?(0,d.jsx)(ea.A,{content:na("flag-touched"),className:sa("icon-touched"),placement:"left",children:(0,d.jsx)(Re.I,{data:Xt.A})}):null,width:36,sortable:!1,resizeable:!1},{name:"Name",get header(){return na("td-feature-flag")},render:({row:e})=>e.Current?(0,d.jsx)("b",{children:e.Name}):e.Name,width:400,sortable:!0,sortAccessor:({Current:e,Name:t})=>Number(!e)+t.toLowerCase()},{name:"Default",get header(){return na("td-default")},render:({row:e})=>{switch(e.Default){case!0:return na("enabled");case!1:return na("disabled");default:return"-"}},width:100,sortable:!1,resizeable:!1},{name:"Current",get header(){return na("td-current")},render:({row:e})=>{var t;return(0,d.jsx)(ta.d,{disabled:!0,checked:(null!==(t=e.Current)&&void 0!==t?t:e.Default)||!1})},width:100,sortable:!1,resizeable:!1}],ia=({database:e})=>{const[t,a]=(0,r.useQueryParam)("search",r.StringParam),[n]=(0,b.Nt)(),{currentData:s=[],isLoading:i,error:o}=_.z6.useGetClusterConfigQuery({database:e},{pollingInterval:n}),l=null===t||void 0===t?void 0:t.toLocaleLowerCase(),c=l?s.filter((e=>e.Name.toLocaleLowerCase().includes(l))):s;return(0,d.jsxs)(de.L,{children:[(0,d.jsx)(de.L.Controls,{children:(0,d.jsx)(pe.v,{value:l,onChange:e=>{a(e||void 0,"replaceIn")},placeholder:na("search-placeholder")})}),(0,d.jsx)(de.L.Table,{loading:i,children:o?(0,d.jsx)(k.o,{error:o}):(0,d.jsx)(ce.l,{emptyDataMessage:na(l?"search-empty":"no-data"),columnsWidthLSKey:"featureFlagsColumnsWidth",columns:ra,data:c,settings:f.N3})})]})};var oa=a(23536),la=a.n(oa),ca=a(53850),da=a(46549);const ua=g.F.injectEndpoints({endpoints:e=>({getTopic:e.query({queryFn:async e=>{try{const t=await window.api.viewer.getTopic(e);return"object"!==typeof t?{error:{}}:{data:t}}catch(t){return{error:t}}},providesTags:["All"]}),getTopicData:e.query({queryFn:async e=>{try{return{data:await window.api.viewer.getTopicData({message_size_limit:100,...e})}}catch(t){return{error:t}}},keepUnusedDataFor:0})}),overrideExisting:"throw"}),ma=(0,ca.Mz)((e=>e),((e,t)=>t),((e,t)=>ua.endpoints.getTopic.select({path:e,database:t}))),pa=(0,ca.Mz)((e=>e),((e,t,a)=>ma(t,a)),((e,t)=>{var a;return null===(a=t(e).data)||void 0===a?void 0:a.topic_stats})),ha=(0,ca.Mz)((e=>e),((e,t,a)=>ma(t,a)),((e,t)=>{var a;return null===(a=t(e).data)||void 0===a?void 0:a.consumers})),va=(0,ca.Mz)(ha,(e=>null===e||void 0===e?void 0:e.map((e=>null===e||void 0===e?void 0:e.name)).filter((e=>void 0!==e)))),ga=(0,ca.Mz)(pa,(e=>{if(!e)return;const{store_size_bytes:t="0",min_last_write_time:a,max_write_time_lag:n,bytes_written:s}=e||{};return{storeSize:t,partitionsIdleTime:(0,ze.MC)(a),partitionsWriteLag:(0,ze.i6)(n),writeSpeed:(0,da.ey)(s)}})),ya=(0,ca.Mz)(ha,(e=>null===e||void 0===e?void 0:e.map((e=>{const{name:t,consumer_stats:a}=e||{},{min_partitions_last_read_time:n,max_read_time_lag:s,max_write_time_lag:r,bytes_read:i}=a||{};return{name:t,readSpeed:(0,da.ey)(i),writeLag:(0,ze.i6)(r),readLag:(0,ze.i6)(s),readIdleTime:(0,ze.MC)(n)}})))),xa=JSON.parse('{"averageSpeed":"Average speed","perMinute":"per minute","perHour":"per hour","perDay":"per day"}'),fa=JSON.parse('{"averageSpeed":"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c","perMinute":"\u0437\u0430 \u043c\u0438\u043d\u0443\u0442\u0443","perHour":"\u0437\u0430 \u0447\u0430\u0441","perDay":"\u0437\u0430 \u0434\u0435\u043d\u044c"}'),ba=(0,he.g4)("ydb-components-speed-multimeter",{ru:fa,en:xa}),ja=(0,c.cn)("speed-multimeter"),Ta=({data:e,speedSize:t="kb",withValue:a=!0,withPopover:s=!0})=>{const{perMinute:r=0,perHour:i=0,perDay:o=0}=e||{},l=[r,i,o],c=e=>(0,da.z3)({value:e,size:t,withSpeedLabel:!0}),u=[{value:c(r),label:ba("perMinute")},{value:c(i),label:ba("perHour")},{value:c(o),label:ba("perDay")}],[m,p]=n.useState(r),[h,v]=n.useState(a?0:void 0),[g,y]=n.useState(),x=(e,t)=>{p(e[t]),v(t),y(t)},f=e=>h===e,b=e=>g===e;return(0,d.jsx)("div",{className:ja(),children:(0,d.jsxs)("div",{className:ja("content"),children:[a&&(0,d.jsx)("div",{className:ja("displayed-value"),children:c(m)}),(0,d.jsx)(ea.A,{content:(0,d.jsxs)("div",{className:ja("popover-content"),children:[(0,d.jsx)("span",{className:ja("popover-header"),children:ba("averageSpeed")}),u.map(((e,t)=>{return(0,d.jsx)("span",{className:ja("popover-row",(a=f(t),a?{color:"primary"}:{color:"secondary"})),children:`${e.label}: ${e.value}`},t);var a}))]}),className:ja("popover-container"),placement:"bottom",disabled:!s,hasArrow:!0,size:"s",children:(0,d.jsx)("div",{className:ja("bars"),onMouseLeave:()=>{p(r),v(a?0:void 0),y(void 0)},children:(()=>{const e=Math.max(...l,0)||1;return l.map(((t,a)=>(0,d.jsx)("div",{className:ja("bar-container",{highlighted:b(a)}),onMouseEnter:x.bind(null,l,a),children:(0,d.jsx)("div",{className:ja("bar",{color:f(a)?"dark":"light"}),style:{width:100*t/e+"%"}})},a)))})()})})]})})},Sa=(0,c.cn)("ydb-diagnostics-consumers-topic-stats"),wa=({data:e})=>{const{writeSpeed:t,partitionsWriteLag:a,partitionsIdleTime:n}=e||{},s=[{label:"Write speed",value:(0,d.jsx)(Ta,{data:t})},{label:"Write lag",value:(0,q.lr)(a||0)},{label:"Write idle time",value:(0,q.lr)(n||0)}];return(0,d.jsx)("div",{className:Sa("wrapper"),children:s.map(((e,t)=>(0,d.jsxs)("div",{className:Sa("item"),children:[(0,d.jsx)("div",{className:Sa("label"),children:e.label}),(0,d.jsx)("div",{className:Sa("value"),children:e.value})]},t)))})};var Na=a(74309),Ea=a.n(Na),Ca=a(44294),Pa=a(54309),Ia=a(6170);const Da=({text:e,popoverContent:t,popoverClassName:a,className:n,contentClassName:s,buttonProps:r})=>(0,d.jsxs)("div",{className:n,children:[e,"\xa0",(0,d.jsx)(Ia.B,{className:a,buttonProps:r,content:t,contentClassName:s})]}),_a=70,Aa=54,Ra=268,ka="#ADE8F5",Oa="#f5be9d",Ma=({width:e,height:t,transform:a})=>(0,d.jsx)("path",{d:`M-${e/2} 0 c0 -${t}, ${e} -${t}, ${e} 0`,fill:"none",strokeDasharray:"4,6",stroke:"#28f",strokeWidth:"1.6",transform:a}),La=({width:e})=>(0,d.jsx)("path",{fill:"none",strokeWidth:"2",d:`M0 0 h${e} l-10 -5 m0 10 l10 -5`}),qa=()=>(0,d.jsxs)("g",{fill:"var(--g-color-text-primary)",fontSize:"12",children:[(0,d.jsx)("g",{transform:"translate(0, 27)",stroke:Oa,children:(0,d.jsx)(La,{width:203})}),(0,d.jsxs)("g",{transform:"translate(30, 0)",children:[(0,d.jsxs)("g",{transform:"translate(35, 27)",children:[(0,d.jsx)(Ma,{width:_a,height:15}),(0,d.jsx)("text",{x:"0",y:"-15",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"write lag"})})]}),(0,d.jsxs)("g",{transform:"translate(119, 27)",children:[(0,d.jsx)(Ma,{width:98,height:15}),(0,d.jsx)("text",{x:"0",y:"-15",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"write idle time"})})]})]}),(0,d.jsxs)("g",{transform:"translate(30, 0)",children:[(0,d.jsxs)("g",{transform:"translate(0, 27)",children:[(0,d.jsx)("use",{y:"-10",xlinkHref:"#check",stroke:Oa}),(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"create time"})})]}),(0,d.jsxs)("g",{transform:"translate(70, 27)",children:[(0,d.jsx)("use",{y:"-10",xlinkHref:"#check",stroke:Oa}),(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"write time"})})]}),(0,d.jsx)("g",{transform:"translate(168, 27)",children:(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"now"})})})]})]}),za=()=>(0,d.jsxs)("g",{fill:"var(--g-color-text-primary)",fontSize:"12",children:[(0,d.jsx)("g",{transform:"translate(0, 27)",stroke:ka,children:(0,d.jsx)(La,{width:Ra})}),(0,d.jsxs)("g",{transform:"translate(30, 0)",children:[(0,d.jsxs)("g",{transform:"translate(105, 27)",children:[(0,d.jsx)(Ma,{width:_a,height:15}),(0,d.jsx)("text",{x:"0",y:"-15",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"read lag"})})]}),(0,d.jsxs)("g",{transform:"translate(35, 27)",children:[(0,d.jsx)(Ma,{width:_a,height:15}),(0,d.jsx)("text",{x:"0",y:"-15",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"write lag"})})]}),(0,d.jsxs)("g",{transform:"translate(182, 27)",children:[(0,d.jsx)(Ma,{width:91,height:15}),(0,d.jsx)("text",{x:"0",y:"-15",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"read idle time"})})]})]}),(0,d.jsxs)("g",{transform:"translate(30, 27)",children:[(0,d.jsxs)("g",{transform:"translate(0, 0)",children:[(0,d.jsx)("use",{y:"-10",xlinkHref:"#check",stroke:ka}),(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"create time"})})]}),(0,d.jsxs)("g",{transform:"translate(70, 0)",children:[(0,d.jsx)("use",{y:"-10",xlinkHref:"#check",stroke:ka}),(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"write time"})})]}),(0,d.jsxs)("g",{transform:"translate(140, 0)",children:[(0,d.jsx)("use",{x:"-2",y:"-10",xlinkHref:"#check",stroke:ka}),(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"read time"})})]}),(0,d.jsx)("g",{transform:"translate(224, 0)",children:(0,d.jsx)("text",{x:"0",y:"20",textAnchor:"middle",children:(0,d.jsx)("tspan",{x:"0",dy:"0",children:"now"})})})]})]}),Fa=({id:e,fill:t})=>(0,d.jsx)("pattern",{id:e,x:"0",y:"0",width:"8",height:"8",patternUnits:"userSpaceOnUse",children:(0,d.jsx)("path",{d:"M0 5L5 0H8L0 8V5M5 8L8 5V8Z",fill:t})}),Ua=()=>(0,d.jsxs)("svg",{className:"paint",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 268 54",width:Ra,height:Aa,children:[(0,d.jsxs)("defs",{children:[(0,d.jsx)("g",{id:"check",children:(0,d.jsx)("path",{d:"M0 3 v14",strokeWidth:"2"})}),(0,d.jsx)(Fa,{id:"latest-read",fill:ka}),(0,d.jsx)(Fa,{id:"latest-write",fill:Oa})]}),(0,d.jsx)(qa,{})]}),Qa=()=>(0,d.jsxs)("svg",{className:"paint",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 268 54",width:Ra,height:Aa,children:[(0,d.jsxs)("defs",{children:[(0,d.jsx)("g",{id:"check",children:(0,d.jsx)("path",{d:"M0 3 v14",strokeWidth:"2"})}),(0,d.jsx)(Fa,{id:"latest-read",fill:ka}),(0,d.jsx)(Fa,{id:"latest-write",fill:Oa})]}),(0,d.jsx)(za,{})]}),$a=(0,c.cn)("ydb-lag-popover-content"),Ba=({text:e,type:t})=>(0,d.jsxs)("div",{className:$a({type:t}),children:[(0,d.jsx)("div",{className:$a("text"),children:e}),(0,d.jsx)("div",{children:"read"===t?(0,d.jsx)(Qa,{}):(0,d.jsx)(Ua,{})})]}),Ha=JSON.parse('{"noConsumersMessage.topic":"This topic has no consumers","noConsumersMessage.stream":"This changefeed has no consumers","lagsPopover.readLags":"Read lags statistics, maximum among all consumer partitions (time format dd hh:mm:ss)","table.emptyDataMessage":"No consumers match the current search","controls.search":"Consumer"}'),Wa=JSON.parse('{"noConsumersMessage.topic":"\u0423 \u044d\u0442\u043e\u0433\u043e \u0442\u043e\u043f\u0438\u043a\u0430 \u043d\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439","noConsumersMessage.stream":"\u0423 \u044d\u0442\u043e\u0433\u043e \u0441\u0442\u0440\u0438\u043c\u0430 \u043d\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439","lagsPopover.readLags":"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043b\u0430\u0433\u043e\u0432 \u0447\u0442\u0435\u043d\u0438\u044f, \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u0438 \u0432\u0441\u0435\u0445 \u043f\u0430\u0440\u0442\u0438\u0446\u0438\u0439 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044f (\u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u0434 \u0447\u0447:\u043c\u043c:\u0441\u0441)","table.emptyDataMessage":"\u041f\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u043e\u0438\u0441\u043a\u0443 \u043d\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439","controls.search":"Consumer"}'),Ga=(0,he.g4)("ydb-diagnostics-consumers",{ru:Wa,en:Ha}),Va="consumer",Ja="readSpeed",Ka="readLags",Ya={[Va]:"Consumer",[Ja]:"Read speed",[Ka]:"Read lags, duration"},Za="writeLag",Xa="readLag",en="readIdleTime",tn={[Za]:"write lag",[Xa]:"read lag",[en]:"read idle time"},an=(0,c.cn)("ydb-diagnostics-consumers-columns-header"),nn=()=>(0,d.jsx)(Da,{className:an("lags"),text:Ya[Ka],popoverContent:(0,d.jsx)(Ba,{text:Ga("lagsPopover.readLags"),type:"read"})}),sn=(0,c.cn)("ydb-diagnostics-consumers-columns"),rn=[{name:Va,header:Ya[Va],align:Pt.Ay.LEFT,render:({row:e})=>{if(!e.name)return"\u2013";const t=Ea().parse(location.search,{ignoreQueryPrefix:!0});return(0,d.jsx)(Ca.E,{to:(0,Pa.YL)({...t,[Pa.vh.diagnosticsTab]:S.iJ.partitions,selectedConsumer:e.name}),children:e.name})}},{name:Ja,header:Ya[Ja],align:Pt.Ay.RIGHT,resizeMinWidth:140,sortAccessor:e=>e.readSpeed.perMinute,render:({row:e})=>(0,d.jsx)(Ta,{data:e.readSpeed})},{name:Ka,header:(0,d.jsx)(nn,{}),className:sn("lags-header"),sub:[{name:Za,header:tn[Za],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.writeLag)},{name:Xa,header:tn[Xa],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.readLag)},{name:en,header:tn[en],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.readIdleTime)}]}],on=(0,c.cn)("ydb-diagnostics-consumers"),ln=({path:e,database:t,type:a})=>{const s=(e=>e===Ye.EPathTypeCdcStream)(a),[r,i]=n.useState(""),[o]=(0,b.Nt)(),{currentData:l,isFetching:c,error:u}=ua.useGetTopicQuery({path:e,database:t},{pollingInterval:o}),m=c&&void 0===l,p=(0,b.N4)((a=>ya(a,e,t))),h=(0,b.N4)((a=>ga(a,e,t))),v=n.useMemo((()=>{if(!p)return[];const e=new RegExp(la()(r),"i");return p.filter((t=>e.test(String(t.name))))}),[p,r]);return m?(0,d.jsx)(O.a,{size:"m"}):u||p&&p.length?(0,d.jsxs)("div",{className:on(),children:[(0,d.jsxs)("div",{className:on("controls"),children:[(0,d.jsx)(pe.v,{onChange:e=>{i(e)},placeholder:Ga("controls.search"),className:on("search"),value:r}),h&&(0,d.jsx)(wa,{data:h})]}),u?(0,d.jsx)(k.o,{error:u}):null,p?(0,d.jsx)("div",{className:on("table-wrapper"),children:(0,d.jsx)("div",{className:on("table-content"),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:"consumersColumnsWidth",wrapperClassName:on("table"),data:v,columns:rn,settings:f.N3,emptyDataMessage:Ga("table.emptyDataMessage")})})}):null]}):(0,d.jsx)("div",{children:Ga("noConsumersMessage."+(s?"stream":"topic"))})};var cn=a(96873),dn=a(84476),un=a(39439),mn=a.n(un);function pn({className:e,text:t,start:a,length:s,hasComa:r}){const i=r?(0,d.jsx)(n.Fragment,{children:",\xa0"}):null;if(s&&"number"===typeof a&&a>=0&&a<t.length){const r=t.substring(0,a),o=t.substring(a,a+s),l=t.substring(a+s);return(0,d.jsxs)(n.Fragment,{children:[r&&(0,d.jsx)("span",{className:e(),children:r}),(0,d.jsx)("span",{className:e({highlighted:!0}),children:o}),l&&(0,d.jsx)("span",{className:e(),children:l}),i]})}return(0,d.jsxs)("span",{className:e(),children:[t,i]})}function hn({className:e,text:t,starts:a,length:s,hasComa:r}){if(!s||!a.length){const a=r?(0,d.jsx)(n.Fragment,{children:",\xa0"}):null;return(0,d.jsxs)("span",{className:e(),children:[t,a]})}const i=[];for(let n=0,o=0;n<a.length&&o<t.length;++n){const l=n===a.length-1,c=a[n]+(l?t.length:s),u=t.substring(o,c);u&&i.push((0,d.jsx)(pn,{className:e,text:u,start:a[n]-o,length:s,hasComa:l&&r})),o=c}return(0,d.jsx)(n.Fragment,{children:i})}const vn=(0,c.cn)("ydb-json-viewer");function gn(e){const{collapsed:t,onToggle:a,path:n}=e;return(0,d.jsx)("span",{title:n,className:vn("collapsed"),children:(0,d.jsx)(dn.$,{onClick:a,view:"flat-secondary",size:"xs",children:(0,d.jsx)(dn.$.Icon,{children:(0,d.jsx)("span",{className:"unipika",children:t?"[+]":"[-]"})})})})}const yn=JSON.parse('{"action_collapse-all":"Collapse all","action_expand-all":"Expand all","action_next":"Next","action_back":"Back","description_search":"Search...","description_matched-rows":"Matched rows","description_full-value":"Full value","context_case-sensitive-search":"Case sensitive search enadled","context_case-sensitive-search-disabled":"Case sensitive search disabled","context_items-count":[" {{count}} item "," {{count}} items "," {{count}} items "," {{count}} items "]}'),xn=(0,he.g4)("ydb-json-viewer",{en:yn});var fn=a(61674);const bn=a.n(fn)()({}),jn={asHTML:!0,format:"json",compact:!1,escapeWhitespace:!0,showDecoded:!0,binaryAsHex:!1,indent:2};function Tn(e){let t;try{t=bn.converters.yson(e,jn)}catch(a){console.error(a),t={_error:"JSON is invalid"}}return t}function Sn(e){return n.useMemo((()=>Tn(e)),[e])}function wn(e){return t=>vn("filtered",t,e)}var Nn=a(70983);function En(e){const{row:{level:t,open:a,close:s,key:r,value:i,hasDelimiter:o,path:l,collapsed:c,depth:u},settings:m,onToggleCollapse:p,matched:h,filter:v,showFullText:g,index:y}=e,x=n.useCallback((()=>{l&&p(l)}),[l,p]),f=n.useCallback((()=>{g(y)}),[g,y]);return(0,d.jsxs)("div",{className:vn("cell","unipika"),children:[kn(t),l&&(0,d.jsx)(gn,{collapsed:c,path:l,onToggle:x}),(0,d.jsx)(Cn,{text:r,settings:m,matched:null===h||void 0===h?void 0:h.keyMatch,filter:v}),a&&(0,d.jsx)(An,{type:a,settings:m}),void 0!==u&&(0,d.jsx)("span",{className:"unipika",children:xn("context_items-count",{count:u})}),void 0!==i&&(0,d.jsx)(Pn,{text:i,settings:m,matched:null===h||void 0===h?void 0:h.valueMatch,filter:v,showFullText:f,maxValueWidth:e.maxValueWidth}),c&&void 0===u&&(0,d.jsx)("span",{className:"unipika",children:"..."}),s&&(0,d.jsx)(An,{type:s,settings:m,close:!0}),o&&(0,d.jsx)(_n,{text:","})]})}function Cn(e){const t=function(e){if(null===e||void 0===e||!e.text)return null;return Dn(e,vn("key"))}(e);return t?(0,d.jsxs)(n.Fragment,{children:[t,(0,d.jsx)(_n,{text:": "})]}):null}function Pn(e){var t;return(0,d.jsx)(n.Fragment,{children:In(e,vn("value",{type:null===(t=e.text)||void 0===t?void 0:t.$type}))})}function In(e,t){var a;return"string"===(null===(a=e.text)||void 0===a?void 0:a.$type)?Dn(e,t):function(e,t){const{text:a,filter:n,settings:s,matched:r}=e;let i=null;if(r&&n){const e=bn.format(a,{...s,asHTML:!1});i=(0,d.jsx)(hn,{className:wn(t),text:e,starts:r,length:null===n||void 0===n?void 0:n.length})}else i=a?function(e,t=jn){const a=bn.formatValue(e,{...jn,...t},0);return(0,d.jsx)("span",{className:"unipika",dangerouslySetInnerHTML:{__html:a}})}(a,s):void 0;return i||null}(e,vn("value"))}function Dn(e,t){const{text:a,settings:n=jn,matched:s=[],filter:r,showFullText:i,maxValueWidth:o=1/0}=e,l=bn.format(a,{...n,maxStringSize:10,asHTML:!1}),c=l.length,u=l.substring(1,Math.min(c-1,o+1)),m=u.length<l.length-2;let p=!1;if(m)for(let d=s.length-1;d>=0;--d)if(u.length<s[d]+((null===r||void 0===r?void 0:r.length)||0)){p=!0;break}return(0,d.jsxs)("span",{children:[(0,d.jsx)(hn,{className:wn(t),text:u,starts:s,length:null===r||void 0===r?void 0:r.length}),m&&(0,d.jsxs)("span",{className:vn("filtered",{highlighted:p,clickable:!0}),onClick:i,children:["\u2026",(0,d.jsx)(Re.I,{data:Nn.A})]})]})}function _n({text:e}){return(0,d.jsx)("span",{children:e})}function An(e){const{type:t,close:a}=e;switch(t){case"array":return(0,d.jsx)(_n,{text:a?"]":"["});case"object":return(0,d.jsx)(_n,{text:a?"}":"{"})}}const Rn={};function kn(e){let t=Rn[e];if(!t){const a=mn()(Array(3*e),"&nbsp;").join("");t=Rn[e]=(0,d.jsx)("span",{dangerouslySetInnerHTML:{__html:a}})}return t}var On=a(28664),Mn=a(59136),Ln=a(26195),qn=a(94630);const zn=n.forwardRef((function({matchIndex:e,matchedRows:t,value:a,onUpdate:s,onKeyDown:r,onNextMatch:i,onPrevMatch:o,caseSensitive:l,onUpdateCaseSensitive:c},u){const m=t.length,p=m?1+e%m:0;return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(On.k,{ref:u,className:vn("filter"),hasClear:!0,size:"m",type:"text",value:a,placeholder:xn("description_search"),onUpdate:s,autoFocus:!1,onKeyDown:r,endContent:(0,d.jsx)(Ae.m,{title:xn(l?"context_case-sensitive-search":"context_case-sensitive-search-disabled"),children:(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:c,selected:l,children:(0,d.jsx)(Re.I,{data:qn.A})})})}),(0,d.jsxs)(_e.s,{gap:1,wrap:"nowrap",children:[(0,d.jsx)(dn.$,{className:vn("match-btn"),view:"flat-secondary",title:xn("action_next"),onClick:i,disabled:!m,children:(0,d.jsx)(Re.I,{data:Mn.A})}),(0,d.jsx)(dn.$,{className:vn("match-btn"),view:"flat-secondary",title:xn("action_back"),onClick:o,disabled:!m,children:(0,d.jsx)(Re.I,{data:Ln.A})})]}),(0,d.jsxs)("span",{className:vn("match-counter"),title:xn("description_matched-rows"),children:[p," / ",m||0]})]})}));var Fn=a(2198);function Un({onClose:e,text:t,starts:a,length:n}){return(0,d.jsxs)(Fn.l,{open:!0,onClose:e,onOutsideClick:e=>{e.stopPropagation()},children:[(0,d.jsx)(Fn.l.Header,{caption:xn("description_full-value")}),(0,d.jsx)(Fn.l.Divider,{}),(0,d.jsx)(Fn.l.Body,{children:(0,d.jsx)(_e.s,{direction:"column",gap:2,width:"70vw",maxHeight:"80vh",children:(0,d.jsx)("div",{className:vn("full-value"),children:(0,d.jsx)(hn,{className:wn(),starts:a,text:t,length:n})})})})]})}function Qn(e,t){const a={dst:[],levels:[],path:[],collapsedState:(null===t||void 0===t?void 0:t.collapsedState)||{},matchedPath:"",collapsedPath:""};$n(e,0,a);const n=function(e,t,a){if(!t)return{};const n=Object.assign({},null===a||void 0===a?void 0:a.settings,{asHTML:!1}),s={};for(let r=0;r<e.length;++r){const{key:i,value:o}=e[r],l=ts(i,t,n,null===a||void 0===a?void 0:a.caseSensitive),c=ts(o,t,n,null===a||void 0===a?void 0:a.caseSensitive);(l||c)&&(s[r]=Object.assign({},l&&{keyMatch:l},c&&{valueMatch:c}))}return s}(a.dst,null===t||void 0===t?void 0:t.filter,{settings:null===t||void 0===t?void 0:t.settings,caseSensitive:null===t||void 0===t?void 0:t.caseSensitive});return{data:a.dst,searchIndex:n}}function $n(e,t,a){return function(e,t=0,a){const n=a.dst.length,{type:s}=a.levels[a.levels.length-1]||{},r=function(e){return"object"===e}(s)?n-1:a.dst.length,i=Jn(a),o=function(e){return"map"===e.$type||"list"===e.$type}(e);let l=0;if(i)Bn(e,t,a);else{l=function(e,t,a,n){let s=0;const r=e&&Jn(n);if(r)Bn(t,a,n);else switch(t.$type){case"map":!function(e,t,a){const n=Kn("object",t,a,e.$value.length);(function(e,t,a,n){for(let s=0;s<e.length;++s){const[r,i]=e[s],o={key:r,level:t};a.dst.push(o),Gn(r.$value,a),$n(i,t,a),++n.currentIndex,Vn(a)}})(e.$value,t+1,a,n),Yn("object",t,a)}(t,a,n),s=t.$value.length;break;case"list":!function(e,t,a){const{$value:n}=e,s=Kn("array",t,a,n.length);for(let r=0;r<n.length;++r)Gn(String(r),a),$n(n[r],t+1,a),++s.currentIndex,Vn(a);Yn("array",t,a)}(t,a,n),s=t.$value.length;break;case"string":Xn(function(e,t){const{$attributes:a,...n}=e;return{level:t,value:n}}(t,a),n);break;default:Xn(function(e,t){const{$attributes:a,...n}=e;return{level:t,value:n}}(t,a),n)}return s}(o,e,t,a)}o&&l&&(a.dst[r].depth=l,Wn(a,r))}(e,t,a)}function Bn(e,t,a){switch(e.$type){case"map":Hn("object",t,a,e.$value.length);break;case"list":Hn("array",t,a,e.$value.length)}}function Hn(e,t,a,n){Kn(e,t,a,0);const s=a.dst[a.dst.length-1];s.depth=n,s.collapsed=!0,Wn(a,a.dst.length-1),Yn(e,t,a)}function Wn(e,t){e.collapsedPath.length&&(e.dst[t].path=e.collapsedPath)}function Gn(e,t){t.path.push(e),t.collapsedPath=t.collapsedPath.length?t.collapsedPath+"/"+e:e}function Vn(e){const t=e.path.pop();void 0!==t&&(e.collapsedPath=e.collapsedPath.substring(0,e.collapsedPath.length-t.length-1))}function Jn(e){return Boolean(e.collapsedState[e.collapsedPath])}function Kn(e,t,a,n){const{dst:s}=a,r=es(s);null!==r&&void 0!==r&&r.key&&r.level===t?r.open=e:s.push({level:t,open:e});const i={type:e,length:n,currentIndex:0};return a.levels.push(i),i}function Yn(e,t,a){const n=a.levels.pop();if(n.type!==e)throw new Error(`The unipika tree cannot be converted to array, there is some mess with levels \n${JSON.stringify({type:e,level:t,info:n,ctx:a},null,2)}`);const s=a.dst[a.dst.length-1],r=s.level===t&&s.open===e,i=r?s:{level:t,close:e};Zn(a)&&(i.hasDelimiter=!0),r?i.close=e:a.dst.push(i)}function Zn(e){const{length:t,currentIndex:a}=e.levels[e.levels.length-1]||{};return void 0!==t&&a<t-1}function Xn(e,t){const a=es(t.dst);a&&!a.open?Object.assign(a,e,{level:a.level}):t.dst.push(e);const n=t.dst[t.dst.length-1];Zn(t)&&(n.hasDelimiter=!0)}function es(e){const t=e[e.length-1];return null===t||void 0===t||!t.key||null!==t&&void 0!==t&&t.close?null:t}function ts(e,t,a,n){if(!e)return;const s=[];let r=bn.formatValue(e,a);if(!r)return;r=String(r),"string"===e.$type&&(r=r.substring(1,r.length-1));let i=0,o=t;for(n||(r=r.toLowerCase(),o=t.toLowerCase());i>=0&&i<r.length;){const e=r.indexOf(o,i);if(-1===e)break;i=e+o.length,s.push(e)}return s.length?s:void 0}var as=a(85283),ns=a(24853);const ss={displayIndices:!1,dynamicRender:!0,sortable:!1,dynamicRenderMinSize:50};function rs(e){const{data:t}=Qn(e);return t.reduce(((e,{path:t})=>(t&&(e[t]=!0),e)),{})}function is(e,t,a,n){const s=Qn(e,{collapsedState:t,filter:a,caseSensitive:n});return Object.assign({},{flattenResult:s,matchedRows:Object.keys(s.searchIndex).map(Number)})}function os(e){const{value:t}=e;return function(e){return!("_error"in e)}(t)?(0,d.jsx)(ls,{...e,value:t}):t._error}function ls({tableSettings:e,value:t,unipikaSettings:a,search:s=!0,extraTools:r,collapsedInitially:i,maxValueWidth:o=100,toolbarClassName:l}){const[c,u]=(0,b.iK)(f.iD,!1),[m,p]=n.useState((()=>i?rs(t):{})),[h,v]=n.useState(""),[g,y]=n.useState((()=>is(t,m,h,c))),[x,j]=n.useState(-1),[T,S]=n.useState(),w=n.useRef(null),N=n.useRef(null),E=n.useMemo((()=>({...ss,dynamicInnerRef:w,...e})),[e]),C=({row:e,index:t})=>{const{flattenResult:{searchIndex:n}}=g;return(0,d.jsx)(En,{matched:n[t],row:e,settings:a,onToggleCollapse:P,filter:h,showFullText:L,index:t,maxValueWidth:o})},P=e=>{const t={...m};t[e]?delete t[e]:t[e]=!0,I({collapsedState:t})},I=(e,a)=>{const{collapsedState:n,matchIndex:s,filter:r,caseSensitive:i}=e;void 0!==n&&p(n),void 0!==s&&j(s),void 0!==r&&v(r);y(is(t,null!==n&&void 0!==n?n:m,null!==r&&void 0!==r?r:h,null!==i&&void 0!==i?i:c)),null===a||void 0===a||a()},D=()=>{I({collapsedState:{}},(()=>{R(null,0)}))},_=()=>{const e=rs(t);I({collapsedState:e})},A=e=>{I({filter:e,matchIndex:0},(()=>{R(null,0)}))},R=(e,t=1)=>{var a,n;const{matchedRows:s}=g;if(!s.length)return;let r=(x+t)%s.length;r<0&&(r=s.length+r),r!==x&&j(r),null===(a=w.current)||void 0===a||a.scrollTo(s[r]-6),null===(n=N.current)||void 0===n||n.focus()},k=()=>{R(null,-1)},O=e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey?k():R(null))},M=()=>{const e=!c;u(e),I({caseSensitive:e})},L=e=>{const{flattenResult:{searchIndex:t,data:a}}=g;S({value:a[e].value,searchInfo:t[e]})},q=()=>{S(void 0)};return(0,d.jsxs)("div",{className:vn(),children:[(0,d.jsxs)(_e.s,{gap:2,wrap:"nowrap",className:vn("toolbar",l),children:[(0,d.jsxs)(_e.s,{gap:1,wrap:"nowrap",children:[(0,d.jsx)(Ae.m,{title:xn("action_expand-all"),children:(0,d.jsx)(dn.$,{onClick:D,view:"flat-secondary",children:(0,d.jsx)(Re.I,{data:as.A})})}),(0,d.jsx)(Ae.m,{title:xn("action_collapse-all"),children:(0,d.jsx)(dn.$,{onClick:_,view:"flat-secondary",children:(0,d.jsx)(Re.I,{data:ns.A})})})]}),s&&(0,d.jsx)(zn,{onUpdate:A,matchIndex:x,matchedRows:g.matchedRows,value:h,ref:N,onKeyDown:O,onNextMatch:R,onPrevMatch:k,caseSensitive:c,onUpdateCaseSensitive:M}),(0,d.jsx)("span",{className:vn("extra-tools"),children:r})]}),(()=>{const e=[{name:"content",render:C,header:null}],{flattenResult:{data:t}}=g;return(0,d.jsx)("div",{className:vn("content"),children:(0,d.jsx)(Pt.Ay,{columns:e,data:t,theme:"yson",settings:E,rowClassName:()=>vn("row")})})})(),(()=>{const{value:e,searchInfo:t}=null!==T&&void 0!==T?T:{},n=bn.format(e,{...a,asHTML:!1});return e&&(0,d.jsx)(Un,{onClose:q,starts:(null===t||void 0===t?void 0:t.valueMatch)||[],text:n.substring(1,n.length-1),length:h.length})})()]})}const cs=(0,c.cn)("ydb-describe"),ds=({path:e,database:t})=>{const[a]=(0,b.Nt)(),{currentData:n,isFetching:s,error:r}=y.useGetOverviewQuery({path:e,database:t},{pollingInterval:a}),i=s&&void 0===n,o=Sn(n);return i?(0,d.jsx)(O.a,{size:"m"}):n||r?(0,d.jsxs)("div",{className:cs(),children:[r?(0,d.jsx)(k.o,{error:r}):null,n?(0,d.jsx)("div",{className:cs("result"),children:(0,d.jsx)(os,{value:o,extraTools:(0,d.jsx)(cn.b,{view:"flat-secondary",text:JSON.stringify(n)}),search:!0,collapsedInitially:!0})}):null]}):(0,d.jsx)("div",{className:cs("message-container"),children:"Empty"})};var us=a(60073);const ms=e=>{const{PathType:t,PathSubType:a}=(null===e||void 0===e?void 0:e.Self)||{};return n=t,(s=a)&&rt[s]||n&&it[n];var n,s},ps=e=>{var t;return null===e||void 0===e||null===(t=e.UserAttributes)||void 0===t?void 0:t.some((({Key:e,Value:t})=>"__async_replica"===e&&"true"===t))};var hs=a(5741),vs=a(82176);const gs=(0,vs.H)({values:{PathType:e=>null===e||void 0===e?void 0:e.substring(9),CreateStep:e=>(0,q.r6)(e,{defaultValue:f.Pd})},labels:{PathType:(0,hs.A)("common.type"),CreateStep:(0,hs.A)("common.created")}}),ys=({value:e,withSpeedLabel:t,...a})=>{const n=(0,da.z3)({value:e,withSpeedLabel:t,...a}),s=(0,da.z3)({value:e,withSpeedLabel:t,size:"b"});return(0,d.jsx)("span",{title:s,children:n})},xs=(e,t)=>e?(0,d.jsx)(ys,{value:e,...t}):null,fs=(0,vs.H)({values:{Type:e=>null===e||void 0===e?void 0:e.substring(10),State:e=>null===e||void 0===e?void 0:e.substring(11),KeyColumnNames:e=>null===e||void 0===e?void 0:e.join(", "),DataColumnNames:e=>null===e||void 0===e?void 0:e.join(", "),DataSize:xs},labels:{KeyColumnNames:"Columns",DataColumnNames:"Includes"}}),bs={[et.METERING_MODE_REQUEST_UNITS]:"request-units",[et.METERING_MODE_RESERVED_CAPACITY]:"reserved-capacity"},js=(0,vs.H)({values:{Partitions:e=>(0,q.ZV)((null===e||void 0===e?void 0:e.length)||0),PQTabletConfig:e=>{const t=Math.round(e.PartitionConfig.LifetimeSeconds/f.Jg*100)/100;return`${(0,q.ZV)(t)} hours`}},labels:{Partitions:"Partitions count",PQTabletConfig:"Retention"}}),Ts=(0,vs.H)({values:{Codecs:e=>e&&Object.values(e.Codecs||{}).join(", "),MeteringMode:e=>e&&bs[e]},labels:{MeteringMode:"Metering mode"}}),Ss=(0,vs.H)({values:{StorageLimitBytes:q.z3,WriteSpeedInBytesPerSecond:q.tC},labels:{StorageLimitBytes:"Retention storage",WriteSpeedInBytesPerSecond:"Partitions write speed"}}),ws=(0,vs.H)({values:{Mode:e=>null===e||void 0===e?void 0:e.substring(14),Format:e=>null===e||void 0===e?void 0:e.substring(16)}}),Ns=(0,vs.H)({values:{CPU:q.iM,Memory:xs,Storage:xs,Network:q.tC,ReadThroughput:q.tC,WriteThroughput:q.tC},defaultValueFormatter:q.ZV}),Es=(0,vs.H)({values:{FollowerCount:q.ZV},labels:{FollowerCountPerDataCenter:"FollowerCountPerDC"},defaultValueFormatter:e=>e&&String(e)}),Cs=(0,vs.H)({values:{FollowerCount:q.ZV,CrossDataCenterFollowerCount:q.ZV}}),Ps=(0,vs.H)({values:{DataSize:xs,IndexSize:xs,LastAccessTime:q.r6,LastUpdateTime:q.r6},defaultValueFormatter:q.ZV}),Is=new Set(["Type","State","DataSize","KeyColumnNames","DataColumnNames"]),Ds=({data:e})=>{var t;const a=ms(null===e||void 0===e?void 0:e.PathDescription);if(!e)return(0,d.jsxs)("div",{className:"error",children:["No ",a," data"]});const n=null===(t=e.PathDescription)||void 0===t?void 0:t.TableIndex,s=[];let r;for(r in n)Is.has(r)&&s.push(fs(r,null===n||void 0===n?void 0:n[r]));return(0,d.jsx)(us.z_,{title:a,info:s})};var _s=a(10508);const As=JSON.parse('{"external-objects.source-type":"Source Type","external-objects.data-source":"Data Source","external-objects.location":"Location","external-objects.auth-method":"Auth Method","external-objects.auth-method.none":"None","external-objects.auth-method.service-account":"Service Account","view.query-text":"Query Text"}'),Rs=(0,he.g4)("ydb-tenant-objects-info",{en:As}),ks=(0,c.cn)("ydb-external-data-source-info"),Os=e=>{var t,a,n,s;const r=[{label:Rs("external-objects.source-type"),value:null===(t=e.PathDescription)||void 0===t||null===(a=t.ExternalDataSourceDescription)||void 0===a?void 0:a.SourceType}],i=null===(n=e.PathDescription)||void 0===n||null===(s=n.Self)||void 0===s?void 0:s.CreateStep;var o,l;Number(i)&&r.push(gs("CreateStep",null===(o=e.PathDescription)||void 0===o||null===(l=o.Self)||void 0===l?void 0:l.CreateStep));return r},Ms=e=>{var t;const{Location:a,Auth:n}=(null===(t=e.PathDescription)||void 0===t?void 0:t.ExternalDataSourceDescription)||{};return[...Os(e),{label:Rs("external-objects.location"),value:(0,d.jsx)(_s.c,{name:a,showStatus:!1,hasClipboardButton:!0,clipboardButtonAlwaysVisible:!0,className:ks("location")})},{label:Rs("external-objects.auth-method"),value:null!==n&&void 0!==n&&n.ServiceAccount?Rs("external-objects.auth-method.service-account"):Rs("external-objects.auth-method.none")}]},Ls=({data:e,prepareData:t})=>{const a=ms(null===e||void 0===e?void 0:e.PathDescription);return e?(0,d.jsx)(us.z_,{title:a,info:t(e)}):(0,d.jsxs)("div",{className:"error",children:["No ",a," data"]})},qs=({data:e})=>(0,d.jsx)(Ls,{data:e,prepareData:Ms});var zs=a(10755),Fs=a(25196);const Us=(0,c.cn)("ydb-external-table-info"),Qs=(e,t)=>{var a,n;const{CreateStep:s}=(null===(a=e.PathDescription)||void 0===a?void 0:a.Self)||{},{SourceType:r,DataSourcePath:i}=(null===(n=e.PathDescription)||void 0===n?void 0:n.ExternalTableDescription)||{},o=null===i||void 0===i?void 0:i.split("/").pop(),l=[{label:Rs("external-objects.source-type"),value:r}];return Number(s)&&l.push(gs("CreateStep",s)),l.push({label:Rs("external-objects.data-source"),value:i&&(0,d.jsx)("span",{title:i,children:(0,d.jsx)(Fs.K,{title:o||"",url:t})})}),l},$s=(e,t)=>{var a,n;const s=null===(a=e.PathDescription)||void 0===a||null===(n=a.ExternalTableDescription)||void 0===n?void 0:n.Location;return[...Qs(e,t),{label:Rs("external-objects.location"),value:(0,d.jsx)(_s.c,{name:s,showStatus:!1,hasClipboardButton:!0,clipboardButtonAlwaysVisible:!0,className:Us("location")})}]},Bs=({data:e,prepareData:t})=>{var a,n;const s=(0,zs.zy)(),r=(0,U.mA)(s),i=(0,U.Ow)({...r,schema:null===e||void 0===e||null===(a=e.PathDescription)||void 0===a||null===(n=a.ExternalTableDescription)||void 0===n?void 0:n.DataSourcePath}),o=ms(null===e||void 0===e?void 0:e.PathDescription);return e?(0,d.jsx)(us.z_,{title:o,info:t(e,i)}):(0,d.jsxs)("div",{className:"error",children:["No ",o," data"]})},Hs=({data:e})=>(0,d.jsx)(Bs,{data:e,prepareData:$s});var Ws=a(94695),Gs=a(57439);const Vs=JSON.parse('{"no-data":"No data"}'),Js=(0,he.g4)("ydb-definition-list",{en:Vs}),Ks=(0,c.cn)("ydb-definition-list");function Ys({title:e,items:t,nameMaxWidth:a=220,copyPosition:n="outside",className:s,itemClassName:r,...i}){return(0,d.jsxs)("div",{className:Ks(null),children:[e?(0,d.jsx)("div",{className:Ks("title"),children:e}):null,t.length?(0,d.jsx)(Gs.u,{items:t,nameMaxWidth:a,copyPosition:n,className:Ks("properties-list",s),itemClassName:Ks("item",r),...i}):Js("no-data")]})}function Zs({data:e}){const t=ms(null===e||void 0===e?void 0:e.PathDescription);if(!e)return(0,d.jsxs)("div",{className:"error",children:["No ",t," data"]});const a=(e=>{var t,a;const n=null===(t=e.PathDescription)||void 0===t||null===(a=t.ViewDescription)||void 0===a?void 0:a.QueryText;return[{name:Rs("view.query-text"),copyText:n,content:n?(0,d.jsx)(Ws.YDBSyntaxHighlighter,{language:"yql",text:n}):null}]})(e);return(0,d.jsx)(Ys,{title:t,items:a})}function Xs({state:e}){return e?"StandBy"in e?(0,d.jsx)(Tt.J,{theme:"info",children:"Standby"}):"Paused"in e?(0,d.jsx)(Tt.J,{theme:"info",children:"Paused"}):"Done"in e?(0,d.jsx)(Tt.J,{theme:"success",children:"Done"}):"Error"in e?(0,d.jsx)(Tt.J,{theme:"danger",children:"Error"}):(0,d.jsx)(Tt.J,{size:"s",children:"Unknown"}):null}const er=JSON.parse('{"column.dstPath.name":"Dist","column.srcPath.name":"Source","everythingWithPrefix":"Everything with prefix:","noData":"No data.","title":"Replicated Paths"}'),tr=(0,he.g4)("ydb-diagnostics-async-replication-paths",{en:er}),ar=(0,c.cn)("ydb-async-replication-paths"),nr=[{name:tr("column.srcPath.name"),render:({row:e})=>e.SrcPath,sortAccessor:e=>e.SrcPath},{name:tr("column.dstPath.name"),render:({row:e})=>e.DstPath,sortAccessor:e=>e.DstPath}];function sr({config:e}){if(!e)return null;let t=tr("noData");var a,n;e.Everything&&(t=(0,d.jsxs)("span",{children:[tr("everythingWithPrefix")," ",(0,d.jsx)(De.E,{variant:"code-inline-2",children:null!==(a=null===(n=e.Everything)||void 0===n?void 0:n.DstPrefix)&&void 0!==a?a:"undefined"}),"."]}));return e.Specific&&(t=(0,d.jsx)(ce.l,{data:e.Specific.Targets,settings:f.jp,columns:nr})),(0,d.jsxs)("div",{className:ar(),children:[(0,d.jsx)("div",{className:ar("title"),children:tr("title")}),t]})}function rr({connection:e}){return e?e.StaticCredentials?(0,d.jsx)(Tt.J,{value:e.StaticCredentials.User,theme:"normal",children:"user"}):"OAuthToken"in e?"OAuth":"unknown":null}const ir=JSON.parse('{"credentials.label":"Credentials","noData":"No data for entity:","srcConnection.database.label":"Source Database Path","srcConnection.endpoint.label":"Source Cluster Endpoint","state.label":"State"}'),or=(0,he.g4)("ydb-diagnostics-async-replication-info",{en:ir});function lr({data:e}){var t,a;const n=ms(null===e||void 0===e?void 0:e.PathDescription);if(!e)return(0,d.jsxs)("div",{className:"error",children:[or("noData")," ",n]});const s=function(e){var t,a;const n=(null===(t=e.PathDescription)||void 0===t?void 0:t.ReplicationDescription)||{},s=n.State,r=(null===(a=n.Config)||void 0===a?void 0:a.SrcConnectionParams)||{},{Endpoint:i,Database:o}=r,l=[];s&&l.push({name:or("state.label"),content:(0,d.jsx)(Xs,{state:s})});i&&l.push({name:or("srcConnection.endpoint.label"),copyText:i,content:(0,d.jsx)(De.E,{variant:"code-inline-2",children:i})});o&&l.push({name:or("srcConnection.database.label"),copyText:o,content:(0,d.jsx)(De.E,{variant:"code-inline-2",children:o})});r&&l.push({name:or("credentials.label"),content:(0,d.jsx)(rr,{connection:r})});return l}(e);return(0,d.jsxs)(_e.s,{direction:"column",gap:"4",children:[(0,d.jsx)(Ys,{title:n,items:s}),(0,d.jsx)(sr,{config:null===(t=e.PathDescription)||void 0===t||null===(a=t.ReplicationDescription)||void 0===a?void 0:a.Config})]})}const cr=JSON.parse('{"writeLagPopover":"Write lag, maximum among all topic partitions","writeIdleTimePopover":"Write idle time, maximum among all topic partitions"}'),dr=JSON.parse('{"writeLagPopover":"\u041b\u0430\u0433 \u0437\u0430\u043f\u0438\u0441\u0438, \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u0438 \u0432\u0441\u0435\u0445 \u043f\u0430\u0440\u0442\u0438\u0446\u0438\u0439 \u0442\u043e\u043f\u0438\u043a\u0430","writeIdleTimePopover":"\u0412\u0440\u0435\u043c\u044f \u0431\u0435\u0437 \u0437\u0430\u043f\u0438\u0441\u0438, \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u0438 \u0432\u0441\u0435\u0445 \u043f\u0430\u0440\u0442\u0438\u0446\u0438\u0439 \u0442\u043e\u043f\u0438\u043a\u0430"}'),ur=(0,he.g4)("ydb-diagnostics-overview-topic-stats",{ru:dr,en:cr}),mr=(0,c.cn)("ydb-overview-topic-stats"),pr=e=>[{label:"Store size",value:(0,q.z3)(e.storeSize)},{label:(0,d.jsx)(Da,{text:"Write idle time",popoverContent:(0,d.jsx)(Ba,{text:ur("writeIdleTimePopover"),type:"write"})}),value:(0,ze.Bi)(e.partitionsIdleTime)},{label:(0,d.jsx)(Da,{text:"Write lag",popoverContent:(0,d.jsx)(Ba,{text:ur("writeLagPopover"),type:"write"})}),value:(0,ze.Bi)(e.partitionsWriteLag)},{label:"Average write speed",value:(0,d.jsx)(Ta,{data:e.writeSpeed,withValue:!1})}],hr=e=>{const t=e.writeSpeed;return[{label:"per minute",value:(0,q.tC)(t.perMinute)},{label:"per hour",value:(0,q.tC)(t.perHour)},{label:"per day",value:(0,q.tC)(t.perDay)}]},vr=({path:e,database:t})=>{const[a]=(0,b.Nt)(),{currentData:s,isFetching:r,error:i}=ua.useGetTopicQuery({path:e,database:t},{pollingInterval:a}),o=r&&void 0===s,l=(0,b.N4)((a=>ga(a,e,t)));if(o)return(0,d.jsx)("div",{className:mr(),children:(0,d.jsx)(O.a,{size:"s"})});const c=i||!l?(0,d.jsx)(k.o,{error:i}):null;return(0,d.jsxs)("div",{className:mr(),children:[(0,d.jsx)("div",{className:mr("title"),children:"Stats"}),c,l?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)("div",{className:mr("info"),children:(0,d.jsx)(us.z_,{info:pr(l),multilineLabels:!0})}),(0,d.jsx)("div",{className:mr("bytes-written"),children:(0,d.jsx)(us.z_,{info:hr(l)})})]}):null]})},gr=e=>{var t,a,n;if(!e)return[];const s=null===e||void 0===e||null===(t=e.PathDescription)||void 0===t?void 0:t.CdcStreamDescription,{Mode:r,Format:i}=s||{},o=(0,us.jl)(ws,{Mode:r,Format:i}),l=null===e||void 0===e||null===(a=e.PathDescription)||void 0===a||null===(n=a.Self)||void 0===n?void 0:n.CreateStep;return Number(l)&&o.unshift(gs("CreateStep",l)),o},yr=({path:e,database:t,data:a})=>{const n=ms(null===a||void 0===a?void 0:a.PathDescription);return a?(0,d.jsxs)("div",{children:[(0,d.jsx)(us.z_,{title:n,info:gr(a)}),(0,d.jsx)(vr,{path:e,database:t})]}):(0,d.jsxs)("div",{className:"error",children:["No ",n," data"]})},xr=JSON.parse('{"page.title":"Database","pages.query":"Query","pages.diagnostics":"Diagnostics","summary.navigation":"Navigation","summary.showPreview":"Show preview","summary.source-type":"Source Type","summary.data-source":"Data Source","summary.copySchemaPath":"Copy schema path","summary.type":"Type","summary.subtype":"SubType","summary.id":"Id","summary.version":"Version","summary.created":"Created","summary.data-size":"Data size","summary.row-count":"Row count","summary.partitions":"Partitions count","summary.paths":"Paths","summary.shards":"Shards","summary.state":"State","summary.mode":"Mode","summary.format":"Format","summary.retention":"Retention","label.read-only":"ReadOnly","actions.copied":"The path is copied to the clipboard","actions.notCopied":"Couldn\u2019t copy the path","actions.copyPath":"Copy path","actions.connectToDB":"Connect to DB","actions.dropIndex":"Drop index","actions.openPreview":"Open preview","actions.createTable":"Create table...","actions.createExternalTable":"Create external table...","actions.createTopic":"Create topic...","actions.createColumnTable":"Create column table...","actions.createAsyncReplication":"Create async replication...","actions.createTransfer":"Create transfer...","actions.createView":"Create view...","actions.dropTable":"Drop table...","actions.dropTopic":"Drop topic...","actions.dropView":"Drop view...","actions.alterTable":"Alter table...","actions.manageColumns":"Manage columns...","actions.manageAutoPartitioning":"Manage auto partitioning...","actions.addTableIndex":"Add index...","actions.createCdcStream":"Create changefeed...","actions.alterTopic":"Alter topic...","actions.selectQuery":"Select query...","actions.upsertQuery":"Upsert query...","actions.alterReplication":"Alter async replicaton...","actions.alterTransfer":"Alter transfer...","actions.dropReplication":"Drop async replicaton...","actions.dropTransfer":"Drop transfer...","actions.createDirectory":"Create directory","schema.tree.dialog.placeholder":"Relative path","schema.tree.dialog.invalid":"Invalid path","schema.tree.dialog.whitespace":"Whitespace is not allowed","schema.tree.dialog.empty":"Path is empty","schema.tree.dialog.header":"Create directory","schema.tree.dialog.description":"Inside","schema.tree.dialog.buttonCancel":"Cancel","schema.tree.dialog.buttonApply":"Create"}'),fr=(0,he.g4)("ydb-tenant",{en:xr});function br({data:e}){const t=ms(e);return ps(e)?(0,d.jsxs)(_e.s,{gap:1,wrap:"nowrap",children:[t," ",(0,d.jsx)(Tt.J,{children:fr("label.read-only")})]}):t}const jr=JSON.parse('{"tableStats":"Table Stats","tabletMetrics":"Tablet Metrics","partitionConfig":"Partition Config","label.ttl":"TTL for rows","value.ttl":"column: \'{{columnName}}\', expire after: {{expireTime}}","label.standalone":"Standalone","label.partitioning":"Partitioning","label.partitioning-by-size":"Partitioning by size","value.partitioning-by-size.enabled":"Enabled, split size: {{size}}","label.partitioning-by-load":"Partitioning by load","label.partitions-min":"Min number of partitions","label.partitions-max":"Max number of partitions","label.read-replicas":"Read replicas (followers)","label.bloom-filter":"Bloom filter","enabled":"Enabled","disabled":"Disabled"}'),Tr=(0,he.g4)("ydb-diagnostics-overview-table-info",{en:jr});var Sr=a(62091),wr=a.n(Sr),Nr=a(7435),Er=a(41650);const Cr=e=>{if(e.Enabled&&e.Enabled.ColumnName&&void 0!==e.Enabled.ExpireAfterSeconds){const t=Tr("value.ttl",{columnName:e.Enabled.ColumnName,expireTime:(0,ze.Bi)(1e3*e.Enabled.ExpireAfterSeconds,1)});return{label:Tr("label.ttl"),value:t}}};const Pr=(e,t)=>{if(!e)return{};const{PathDescription:a={}}=e,{TableStats:n={},TabletMetrics:s={},Table:{PartitionConfig:r={},TTLSettings:i}={},ColumnTableDescription:o={}}=a,{PartCount:l,RowCount:c,DataSize:u,IndexSize:m,ByKeyFilterSize:p,LastAccessTime:h,LastUpdateTime:v,ImmediateTxCompleted:g,PlannedTxCompleted:y,TxRejectedByOverload:x,TxRejectedBySpace:f,TxCompleteLagMsec:b,InFlightTxCount:j,RowUpdates:T,RowDeletes:S,RowReads:w,RangeReads:N,RangeReadRows:E}=n,{FollowerGroups:C,FollowerCount:P,CrossDataCenterFollowerCount:I}=r;let D=[];switch(t){case Ye.EPathTypeTable:D=((e,t)=>{var a;const{PartitioningPolicy:n={},FollowerGroups:s,EnableFilterByKey:r}=e,i=[],o=n.SizeToSplit&&Number(n.SizeToSplit)>0?Tr("value.partitioning-by-size.enabled",{size:(0,q.z3)(n.SizeToSplit)}):Tr("disabled"),l=null!==(a=n.SplitByLoadSettings)&&void 0!==a&&a.Enabled?Tr("enabled"):Tr("disabled");if(i.push({label:Tr("label.partitioning-by-size"),value:o},{label:Tr("label.partitioning-by-load"),value:l},{label:Tr("label.partitions-min"),value:(0,q.ZV)(n.MinPartitionsCount||0)}),n.MaxPartitionsCount&&i.push({label:Tr("label.partitions-max"),value:(0,q.ZV)(n.MaxPartitionsCount)}),s&&s.length){const{RequireAllDataCenters:e,FollowerCountPerDataCenter:t,FollowerCount:a}=s[0];let n;n=e&&t?`PER_AZ: ${a}`:`ANY_AZ: ${a}`,i.push({label:Tr("label.read-replicas"),value:n})}if(t){const e=Cr(t);e&&i.push(e)}return(0,Nr.f8)(r)&&i.push({label:Tr("label.bloom-filter"),value:Tr(r?"enabled":"disabled")}),i})(r,i);break;case Ye.EPathTypeColumnTable:D=function(e){var t,a;const n=[];var s;if(n.push({label:Tr("label.standalone"),value:String((s=e,!(s.SchemaPresetName&&void 0!==s.SchemaPresetId)))}),null!==(t=e.Sharding)&&void 0!==t&&null!==(a=t.HashSharding)&&void 0!==a&&a.Columns){const t=`PARTITION BY HASH(${e.Sharding.HashSharding.Columns.join(", ")})`;n.push({label:Tr("label.partitioning"),value:(0,d.jsx)(De.E,{variant:"code-2",wordBreak:"break-word",children:t})})}if(e.TtlSettings){const t=Cr(null===e||void 0===e?void 0:e.TtlSettings);t&&n.push(t)}return n}(o)}const _=(0,us.jl)(Ps,{PartCount:l,RowCount:c,DataSize:u,IndexSize:m});(0,Er.kf)(p)&&(r.EnableFilterByKey||Number(p)>0)&&_.push({label:"BloomFilterSize",value:xs(p)});const A=[_,(0,us.jl)(Ps,{LastAccessTime:h,LastUpdateTime:v}),(0,us.jl)(Ps,{ImmediateTxCompleted:g,PlannedTxCompleted:y,TxRejectedByOverload:x,TxRejectedBySpace:f,TxCompleteLagMsec:b,InFlightTxCount:j}),(0,us.jl)(Ps,{RowUpdates:T,RowDeletes:S,RowReads:w,RangeReads:N,RangeReadRows:E})],R=(0,us.jl)(Ns,wr()(s,["GroupReadIops","GroupReadThroughput","GroupWriteIops","GroupWriteThroughput"]));let k=[];return Array.isArray(C)&&C.length>0?k=(0,us.jl)(Es,C[0]):void 0!==P?k.push(Cs("FollowerCount",P)):void 0!==I&&k.push(Cs("CrossDataCenterFollowerCount",I)),{generalInfo:D,tableStatsInfo:A,tabletMetricsInfo:R,partitionConfigInfo:k}},Ir=(0,c.cn)("ydb-diagnostics-table-info"),Dr=({data:e,type:t})=>{const a=(0,d.jsx)(br,{data:null===e||void 0===e?void 0:e.PathDescription}),{generalInfo:s,tableStatsInfo:r,tabletMetricsInfo:i=[],partitionConfigInfo:o=[]}=n.useMemo((()=>Pr(e,t)),[e,t]);return(0,d.jsxs)("div",{className:Ir(),children:[(0,d.jsx)(us.z_,{info:s,title:a,className:Ir("info-block"),renderEmptyState:()=>(0,d.jsx)("div",{className:Ir("title"),children:a})}),(0,d.jsxs)("div",{className:Ir("row"),children:[r?(0,d.jsx)("div",{className:Ir("col"),children:r.map(((e,t)=>(0,d.jsx)(us.z_,{info:e,title:0===t?Tr("tableStats"):void 0,className:Ir("info-block"),renderEmptyState:()=>null},t)))}):null,i.length>0||o.length>0?(0,d.jsxs)("div",{className:Ir("col"),children:[(0,d.jsx)(us.z_,{info:i,title:Tr("tabletMetrics"),className:Ir("info-block"),renderEmptyState:()=>null}),(0,d.jsx)(us.z_,{info:o,title:Tr("partitionConfig"),className:Ir("info-block"),renderEmptyState:()=>null})]}):null]})]})},_r=e=>{var t;const a=null===e||void 0===e||null===(t=e.PathDescription)||void 0===t?void 0:t.PersQueueGroup;if(!a)return[];const{Partitions:n=[],PQTabletConfig:s={PartitionConfig:{LifetimeSeconds:0}}}=a,{Codecs:r,MeteringMode:i}=s,{WriteSpeedInBytesPerSecond:o,StorageLimitBytes:l}=s.PartitionConfig;return[...(0,us.jl)(js,{Partitions:n,PQTabletConfig:s}),...(0,us.jl)(Ss,{StorageLimitBytes:l,WriteSpeedInBytesPerSecond:o}),...(0,us.jl)(Ts,{Codecs:r,MeteringMode:i})]},Ar=({data:e,path:t,database:a})=>{const n=ms(null===e||void 0===e?void 0:e.PathDescription);if(!e)return(0,d.jsxs)("div",{className:"error",children:["No ",n," data"]});return(0,d.jsxs)("div",{children:[(0,d.jsx)(us.z_,{title:n,info:_r(e)}),(()=>{var n,s;return(null===(n=e.PathDescription)||void 0===n||null===(s=n.Self)||void 0===s?void 0:s.PathSubType)===Ze.EPathSubTypeStreamImpl?null:(0,d.jsx)(vr,{path:t,database:a})})()]})},Rr=g.F.injectEndpoints({endpoints:e=>({getReplication:e.query({queryFn:async e=>{try{const t=await window.api.viewer.getReplication(e);return"object"!==typeof t?{error:{}}:{data:t}}catch(t){return{error:t}}},providesTags:["All"]})}),overrideExisting:"throw"});function kr({connection:e}){return e?e.StaticCredentials?(0,d.jsx)(Tt.J,{value:e.StaticCredentials.User,theme:"normal",children:"user"}):"OAuthToken"in e?"OAuth":"unknown":null}const Or=JSON.parse('{"credentials.label":"Credentials","noData":"No data for entity:","srcConnection.database.label":"Source Database Path","srcConnection.endpoint.label":"Source Cluster Endpoint","state.label":"State","state.error":"Error","srcPath.label":"Source Topic","dstPath.label":"Destination Table","transformLambda.label":"Transformation Lambda"}'),Mr=(0,he.g4)("ydb-diagnostics-transfer-info",{en:Or});function Lr({path:e,database:t,data:a}){const n=ms(null===a||void 0===a?void 0:a.PathDescription);if(!a)return(0,d.jsxs)("div",{className:"error",children:[Mr("noData")," ",n]});const{data:s}=Rr.useGetReplicationQuery({path:e,database:t},{}),r=function(e,t){var a,n,s,r,i,o;const l=(null===(a=e.PathDescription)||void 0===a?void 0:a.ReplicationDescription)||{},c=l.State,u=(null===(n=l.Config)||void 0===n?void 0:n.SrcConnectionParams)||{},{Endpoint:m,Database:p}=u,h=null===(s=l.Config)||void 0===s||null===(r=s.TransferSpecific)||void 0===r?void 0:r.Target,v=null===h||void 0===h?void 0:h.SrcPath,g=null===h||void 0===h?void 0:h.DstPath,y=null===h||void 0===h?void 0:h.TransformLambda,x=[];c&&x.push({name:Mr("state.label"),content:(0,d.jsx)(Xs,{state:c})});null!==t&&void 0!==t&&null!==(i=t.error)&&void 0!==i&&i.issues&&null!==(o=t.error.issues[0])&&void 0!==o&&o.message&&x.push({name:Mr("state.error"),copyText:t.error.issues[0].message,content:(0,d.jsx)(De.E,{variant:"code-inline-2",color:"danger",children:t.error.issues[0].message})});m&&x.push({name:Mr("srcConnection.endpoint.label"),copyText:m,content:(0,d.jsx)(De.E,{variant:"code-inline-2",children:m})});p&&x.push({name:Mr("srcConnection.database.label"),copyText:p,content:(0,d.jsx)(De.E,{variant:"code-inline-2",children:p})});u&&x.push({name:Mr("credentials.label"),content:(0,d.jsx)(kr,{connection:u})});return x.push({name:Mr("srcPath.label"),copyText:v,content:(0,d.jsx)(De.E,{variant:"code-inline-2",children:v})}),x.push({name:Mr("dstPath.label"),copyText:g,content:(0,d.jsx)(De.E,{variant:"code-inline-2",children:g})}),x.push({name:Mr("transformLambda.label"),copyText:y,content:y?(0,d.jsx)(Ws.YDBSyntaxHighlighter,{language:"yql",text:y}):null}),x}(a,s);return(0,d.jsx)(_e.s,{direction:"column",gap:"4",children:(0,d.jsx)(Ys,{title:n,items:r})})}const qr=function({type:e,path:t,database:a}){const[s]=(0,b.Nt)(),{currentData:r,isFetching:i,error:o}=y.useGetOverviewQuery({path:t,database:a},{pollingInterval:s});return i&&void 0===r?(0,d.jsx)(O.a,{size:"m"}):(0,d.jsxs)(n.Fragment,{children:[o?(0,d.jsx)(k.o,{error:o}):null,o&&!r?null:(()=>{var n;const s=null!==r&&void 0!==r?r:void 0,i={[Ye.EPathTypeInvalid]:void 0,[Ye.EPathTypeDir]:void 0,[Ye.EPathTypeResourcePool]:void 0,[Ye.EPathTypeTable]:void 0,[Ye.EPathTypeSubDomain]:void 0,[Ye.EPathTypeTableIndex]:()=>(0,d.jsx)(Ds,{data:s}),[Ye.EPathTypeExtSubDomain]:void 0,[Ye.EPathTypeColumnStore]:void 0,[Ye.EPathTypeColumnTable]:void 0,[Ye.EPathTypeCdcStream]:()=>(0,d.jsx)(yr,{path:t,database:a,data:s}),[Ye.EPathTypePersQueueGroup]:()=>(0,d.jsx)(Ar,{data:s,path:t,database:a}),[Ye.EPathTypeExternalTable]:()=>(0,d.jsx)(Hs,{data:s}),[Ye.EPathTypeExternalDataSource]:()=>(0,d.jsx)(qs,{data:s}),[Ye.EPathTypeView]:()=>(0,d.jsx)(Zs,{data:s}),[Ye.EPathTypeReplication]:()=>(0,d.jsx)(lr,{data:s}),[Ye.EPathTypeTransfer]:()=>(0,d.jsx)(Lr,{path:t,database:a,data:s})};return e&&(null===(n=i[e])||void 0===n?void 0:n.call(i))||(0,d.jsx)(Dr,{data:s,type:e})})()]})};var zr,Fr=a(74417),Ur=a(91364);function Qr({href:e,className:t,size:a="xs"}){return(0,d.jsx)(dn.$,{href:e,target:"_blank",className:t,size:a,title:"Database logs",children:(0,d.jsx)(Re.I,{data:Ur.A})})}function $r(){return $r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},$r.apply(null,arguments)}const Br=function(e){return n.createElement("svg",$r({fill:"currentColor",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),zr||(zr=n.createElement("path",{d:"M14.195 11.375H3.125v-7.82a.328.328 0 00-.305-.305H1.805a.309.309 0 00-.305.305v9.14c0 .178.127.305.305.305h12.39a.309.309 0 00.305-.305V11.68a.328.328 0 00-.305-.305zm-3.25-5.688L8.812 7.11 6.63 4.24c-.127-.178-.38-.178-.508.026L3.937 7.922v2.64h9.75l-2.285-4.748c-.101-.177-.304-.228-.457-.127z"})))};function Hr({href:e,className:t,size:a="xs"}){return(0,d.jsx)(dn.$,{href:e,target:"_blank",className:t,size:a,title:"Monitoring dashboard",children:(0,d.jsx)(Re.I,{data:Br})})}var Wr=a(20680),Gr=a(28232),Vr=a(66643),Jr=a(40014),Kr=a(25533),Yr=a(90474);const Zr=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300"];function Xr(e){return null===e?f.Pd:(0,ze.Xo)((0,q.CR)((0,Er.y3)(e),2))}function ei(e){return null===e?f.Pd:(0,da.z3)({value:(0,Er.y3)(e),precision:3})}function ti(e){return null===e?f.Pd:Math.round(100*(0,Er.y3)(e))+"%"}const ai={"30m":30*f.r0,"1h":f.Jg,"1d":f.tt,"1w":7*f.tt},ni=JSON.parse('{"not-supported":"Charts are not supported on current ydb version"}'),si=(0,he.g4)("ydb-metric-chart",{en:ni}),ri=g.F.injectEndpoints({endpoints:e=>({getChartData:e.query({queryFn:async(e,{signal:t})=>{try{const a=await(async({database:e,metrics:t,timeFrame:a,maxDataPoints:n},{signal:s}={})=>{const r=t.map((e=>`target=${e.target}`)).join("&"),i=Math.round(Date.now()/1e3),o=i-ai[a];return window.api.viewer.getChartData({target:r,from:o,until:i,maxDataPoints:n,database:e},{signal:s})})(e,{signal:t});if(Array.isArray(a)){return{data:((e=[],t)=>{const a=e.map((({datapoints:e,target:a})=>{const n=t.find((e=>e.target===a));if(!n)return;const s=e.map((e=>e[0]));return{...n,data:s}})).filter((e=>void 0!==e));return{timeline:e[0].datapoints.map((e=>1e3*e[1])),metrics:a}})(a,e.metrics)}}return{error:new Error("string"===typeof a?si("not-supported"):a.error)}}catch(a){return{error:a}}},providesTags:["All"],keepUnusedDataFor:0})}),overrideExisting:"throw"}),ii=(0,c.cn)("ydb-metric-chart");Vr.W.set({plugins:[Kr.YagrPlugin]});const oi=(e,t={})=>{const{dataType:a,scaleRange:n,showLegend:s}=t,r=(e=>{switch(e){case"ms":return Xr;case"size":return ei;case"percent":return ti;default:return}})(a),i=!e.metrics.length,o=e.metrics.map(((e,t)=>{const a=e.color||Zr[t],n=function(e,t){const a=(0,Yr.Mj)(e);if(!a.isValid())throw new Error("Invalid color is passed");return a.alpha(t).toRgbString()}(a,.1);return{id:e.target,name:e.title||e.target,data:e.data,formatter:r,lineColor:a,color:n,legendColorKey:"lineColor"}}));return{data:{timeline:e.timeline,graphs:o},libraryConfig:{chart:{size:{padding:i?[10,0,10,0]:void 0},series:{type:"area",spanGaps:!0,lineWidth:1.5},select:{zoom:!1}},scales:{y:{type:"linear",range:"nice",min:(null===n||void 0===n?void 0:n.min)||0,max:null===n||void 0===n?void 0:n.max}},axes:{y:{values:r?(e,t)=>t.map(r):void 0}},tooltip:{show:!0,tracking:"sticky"},legend:{show:s}}}},li={timeline:[],metrics:[]},ci=({database:e,title:t,metrics:a,timeFrame:s="1h",autorefresh:r,width:i=400,height:o=i/1.5,chartOptions:l,onChartDataStatusChange:c,isChartVisible:u})=>{const{currentData:m,error:p,isFetching:h,status:v}=ri.useGetChartDataQuery({database:e,metrics:a,timeFrame:s,maxDataPoints:i/2},{pollingInterval:r}),g=h&&!m;n.useEffect((()=>null===c||void 0===c?void 0:c("fulfilled"===v?"success":"loading")),[v,c]);const y=oi(m||li,l);return(0,d.jsxs)("div",{className:ii(null),style:{height:o,width:i},children:[(0,d.jsx)("div",{className:ii("title"),children:t}),g?(0,d.jsx)(O.a,{}):u?(0,d.jsxs)("div",{className:ii("chart"),children:[(0,d.jsx)(Jr.Ay,{type:"yagr",data:y}),p?(0,d.jsx)(k.o,{className:ii("error"),error:p}):null]}):null]})},di=(0,c.cn)("ydb-timeframe-selector"),ui=({value:e,onChange:t,className:a})=>(0,d.jsx)("div",{className:di(null,a),children:Object.keys(ai).map((a=>(0,d.jsx)(dn.$,{view:"flat",selected:e===a,onClick:()=>t(a),children:a},a)))}),mi=(0,c.cn)("ydb-tenant-dashboard"),pi=({database:e,charts:t})=>{const[a,s]=n.useState(!0),[i="1h",o]=(0,r.useQueryParam)("timeframe",r.StringParam),[l]=(0,b.Nt)(),c=a?0:l,u=e=>{"success"===e&&s(!1)},m=1===t.length?872:428,p=428/1.5;return(0,d.jsxs)("div",{className:mi(null),style:{display:a?"none":void 0},children:[(0,d.jsx)("div",{className:mi("controls"),children:(0,d.jsx)(ui,{value:i,onChange:o})}),(0,d.jsx)("div",{className:mi("charts"),children:t.map((t=>{const n=t.metrics.map((({target:e})=>e)).join("&");return(0,d.jsx)(ci,{database:e,title:t.title,metrics:t.metrics,timeFrame:i,chartOptions:t.options,autorefresh:c,width:m,height:p,onChartDataStatusChange:u,isChartVisible:!a},n)}))})]})},hi=JSON.parse('{"no-data":"No data","no-pools-data":"No pools data","top-nodes.empty-data":"No such nodes","top-groups.empty-data":"No such groups","top":"Top","nodes":"nodes","shards":"shards","groups":"groups","queries":"queries","tables":"tables","by-pools-usage":"by pools usage","by-cpu-time":"by cpu time, {{executionPeriod}}","by-cpu-usage":"by cpu usage","by-load":"by load","by-memory":"by memory","by-usage":"by usage","by-size":"by size","cards.cpu-label":"CPU","cards.storage-label":"Storage","cards.memory-label":"Memory","charts.queries-per-second":"Queries per second","charts.transaction-latency":"Transactions latencies {{percentile}}","charts.cpu-usage":"CPU usage by pool","charts.storage-usage":"Tablet storage usage","charts.memory-usage":"Memory usage","storage.tablet-storage-title":"Tablet storage","storage.tablet-storage-description":"Size of user data and indexes stored in schema objects (tables, topics, etc.)","storage.db-storage-title":"Database storage","storage.db-storage-description":"Size of data stored in distributed storage with all overheads for redundancy","executed-last-hour":"executed in the last hour","column-header.process":"Process"}'),vi=(0,he.g4)("ydb-diagnostics-tenant-overview",{en:hi}),gi=[{title:vi("charts.queries-per-second"),metrics:[{target:"queries.requests",title:vi("charts.queries-per-second")}]},{title:vi("charts.transaction-latency",{percentile:""}),metrics:[{target:"queries.latencies.p50",title:"p50"},{target:"queries.latencies.p75",title:"p75"},{target:"queries.latencies.p90",title:"p90"},{target:"queries.latencies.p99",title:"p99"}],options:{dataType:"ms",showLegend:!0}}],yi=({database:e})=>(0,d.jsx)(pi,{database:e,charts:gi});var xi=a(67157);const fi=g.F.injectEndpoints({endpoints:e=>({getHealthcheckInfo:e.query({queryFn:async({database:e,maxLevel:t},{signal:a})=>{try{return{data:await window.api.viewer.getHealthcheckInfo({database:e,maxLevel:t},{signal:a})}}catch(n){return{error:n}}},providesTags:["All"]})}),overrideExisting:"throw"}),bi={RED:0,ORANGE:1,YELLOW:2,BLUE:3,GREEN:4},ji=e=>e.sort(((e,t)=>(bi[e.status]||0)-(bi[t.status]||0))),Ti=({issue:e,data:t})=>ji(t.filter((t=>e.reason&&-1!==e.reason.indexOf(t.id)))),Si=({data:e,roots:t})=>t?t.map((t=>{const a=Si({roots:Ti({issue:t,data:e}),data:e});return{...t,reasonsItems:a}})):[],wi=(0,ca.Mz)((e=>e),(e=>fi.endpoints.getHealthcheckInfo.select({database:e}))),Ni=(0,ca.Mz)((e=>e),((e,t)=>wi(t)),((e,t)=>{var a;return(null===(a=t(e).data)||void 0===a?void 0:a.issue_log)||[]})),Ei=(0,ca.Mz)(Ni,((e=[])=>{return ji((t=e).filter((e=>!t.find((t=>t.reason&&-1!==t.reason.indexOf(e.id))))));var t})),Ci=(0,ca.Mz)([Ni,Ei],((e=[],t=[])=>Si({data:e,roots:t}))),Pi=(0,ca.Mz)(Ni,((e=[])=>(e=>{const t={};for(const a of e)t[a.status]||(t[a.status]=0),t[a.status]++;return Object.entries(t).sort((([e],[t])=>(bi[e]||0)-(bi[t]||0)))})(e)));let Ii=function(e){return e.UNSPECIFIED="UNSPECIFIED",e.GOOD="GOOD",e.DEGRADED="DEGRADED",e.MAINTENANCE_REQUIRED="MAINTENANCE_REQUIRED",e.EMERGENCY="EMERGENCY",e}({}),Di=function(e){return e.UNSPECIFIED="UNSPECIFIED",e.GREY="GREY",e.GREEN="GREEN",e.BLUE="BLUE",e.YELLOW="YELLOW",e.ORANGE="ORANGE",e.RED="RED",e}({});var _i=a(63126),Ai=a(54090);const Ri={[Di.UNSPECIFIED]:Ai.m.Grey,[Di.GREY]:Ai.m.Grey,[Di.GREEN]:Ai.m.Green,[Di.BLUE]:Ai.m.Blue,[Di.YELLOW]:Ai.m.Yellow,[Di.ORANGE]:Ai.m.Orange,[Di.RED]:Ai.m.Red},ki=(0,c.cn)("issue-tree-item"),Oi=({status:e,message:t,type:a,onClick:n})=>(0,d.jsxs)("div",{className:ki(),onClick:n,children:[(0,d.jsx)("div",{className:ki("field",{status:!0}),children:(0,d.jsx)(_s.c,{mode:"icons",status:e,name:a})}),(0,d.jsx)("div",{className:ki("field",{message:!0}),children:t})]}),Mi=(0,c.cn)("issue-tree"),Li=({issueTree:e})=>{const[t,a]=n.useState({}),s=n.useCallback((e=>e?(0,d.jsx)("div",{className:Mi("info-panel"),children:(0,d.jsx)(os,{value:Tn(e)})}):null),[]),r=n.useCallback((e=>e.map((e=>{const{id:n}=e,{status:i,message:o,type:l,reasonsItems:c,level:u,...m}=e,p="undefined"===typeof t[n]||t[n],h=()=>{a((e=>({...e,[n]:!p})))};return(0,d.jsxs)(_i.G,{name:(0,d.jsx)(Oi,{status:Ri[i],message:o,type:l}),collapsed:p,hasArrow:!0,onClick:h,onArrowClick:h,level:u-1,children:[s(wr()(m,["reason"])),r(c||[])]},n)}))),[t,s]);return(0,d.jsx)("div",{className:Mi(),children:(0,d.jsx)("div",{className:Mi("block"),children:r([e])})})},qi=JSON.parse('{"title.healthcheck":"Healthcheck","label.update":"Update","label.show-details":"Show details","label.issues":"Issues:","status_message.ok":"No issues","no-data":"no healthcheck data"}'),zi=JSON.parse('{"title.healthcheck":"Healthcheck","label.update":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c","label.show-details":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0441\u0442\u0438","label.issues":"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u044b:","status_message.ok":"\u041d\u0435\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c","no-data":"\u043d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 healthcheck"}'),Fi=(0,he.g4)("ydb-diagnostics-healthcheck",{ru:zi,en:qi}),Ui=(0,c.cn)("healthcheck");function Qi({tenantName:e}){const[t]=(0,b.Nt)(),{name:a}=(0,xi.Zd)(),{issueTrees:s,loading:r,error:i}=((e,{autorefresh:t}={})=>{const{currentData:a,isFetching:n,error:s,refetch:r}=fi.useGetHealthcheckInfoQuery({database:e},{pollingInterval:t}),i=(null===a||void 0===a?void 0:a.self_check_result)||Ii.UNSPECIFIED,o=(0,b.N4)((t=>Pi(t,e)));return{issueTrees:(0,b.N4)((t=>Ci(t,e))),issuesStatistics:o,loading:void 0===a&&n,error:s,refetch:r,selfCheckResult:i}})(e,{autorefresh:"ydb_ru"===a?void 0:t});return(0,d.jsx)("div",{className:Ui("details"),children:(0,d.jsx)("div",{className:Ui("details-content-wrapper"),children:i?(0,d.jsx)(k.o,{error:i,defaultMessage:Fi("no-data")}):r?(0,d.jsx)(O.a,{size:"m"}):s&&s.length?(0,d.jsx)(n.Fragment,{children:s.map((e=>(0,d.jsx)(Li,{issueTree:e},e.id)))}):Fi("status_message.ok")})})}var $i=a(8861),Bi=a(73633),Hi=a(70825),Wi=a(43937),Gi=a(10800),Vi=a(71153);const Ji=(0,c.cn)("ydb-diagnostic-card");function Ki({children:e,className:t,active:a,size:n="m",interactive:s=!0}){return(0,d.jsx)("div",{className:Ji({active:a,size:n,interactive:s},t),children:e})}var Yi=a(52358);const Zi=(0,c.cn)("healthcheck"),Xi={[Ii.UNSPECIFIED]:Bi.A,[Ii.GOOD]:Hi.A,[Ii.DEGRADED]:Wi.A,[Ii.MAINTENANCE_REQUIRED]:Gi.A,[Ii.EMERGENCY]:Vi.A};function eo(e){const{tenantName:t,active:a}=e,[s]=(0,b.Nt)(),{metricsTab:r}=(0,b.N4)((e=>e.tenant)),{name:i}=(0,xi.Zd)(),o="ydb_ru"===i,{currentData:l,isFetching:c,error:u}=fi.useGetHealthcheckInfoQuery({database:t},{pollingInterval:o?void 0:s,skip:o}),[m,{currentData:p,isFetching:h}]=fi.useLazyGetHealthcheckInfoQuery();n.useEffect((()=>{"healthcheck"===r&&o&&m({database:t})}),[r,o,t,m]),n.useEffect((()=>{const e=()=>{o&&m({database:t})};return document.addEventListener("diagnosticsRefresh",e),()=>{document.removeEventListener("diagnosticsRefresh",e)}}),[t,o,m]);const v=c&&void 0===l||h&&void 0===p;return(0,d.jsxs)(Ki,{className:Zi("preview"),active:a,children:[(0,d.jsx)("div",{className:Zi("preview-header"),children:(0,d.jsxs)("div",{className:Zi("preview-title-wrapper"),children:[(0,d.jsx)("div",{className:Zi("preview-title"),children:Fi("title.healthcheck")}),o?(0,d.jsx)(ea.A,{content:"Healthcheck is disabled. Please update healthcheck manually.",placement:["top"],className:Zi("icon-wrapper"),children:()=>(0,d.jsx)(Re.I,{size:16,className:Zi("icon-warn"),data:Yi.A})}):null]})}),(()=>{if(u)return(0,d.jsx)(k.o,{error:u,defaultMessage:Fi("no-data")});if(v)return(0,d.jsx)(O.a,{size:"m"});const e=(null===l||void 0===l?void 0:l.self_check_result)||(null===p||void 0===p?void 0:p.self_check_result)||Ii.UNSPECIFIED,t=e.toLowerCase();return(0,d.jsx)("div",{className:Zi("preview-content"),children:(0,d.jsxs)("div",{className:Zi("preview-issue",{[t]:!0}),children:[(0,d.jsx)(Re.I,{className:Zi("preview-status-icon"),data:Xi[e]}),(0,d.jsx)("div",{className:Zi("self-check-status-indicator"),children:e.replace(/_/g," ")})]})})})()]})}var to=a(15132),ao=a(33775);const no=(0,c.cn)("ydb-metrics-card"),so=e=>{let t;return"Warning"===e&&(t=Ai.m.Yellow),"Danger"===e&&(t=Ai.m.Red),t?(0,d.jsx)(ao.k,{status:t,mode:"icons",size:"l"}):null};function ro({active:e,label:t,status:a,metrics:n}){return(0,d.jsxs)(Ki,{className:no({active:e}),active:e,children:[(0,d.jsxs)("div",{className:no("header"),children:[t&&(0,d.jsx)("div",{className:no("label"),children:t}),so(a)]}),(0,d.jsx)("div",{className:no("content"),children:n.map((({title:e,...t},a)=>(0,d.jsxs)("div",{className:no("metric"),children:[(0,d.jsx)("div",{className:no("metric-title"),children:e}),(0,d.jsx)(to.O,{size:"xs",colorizeProgress:!0,...t})]},a)))})]})}const io=(0,c.cn)("metrics-cards");function oo({poolsCpuStats:e,memoryStats:t,blobStorageStats:a,tabletStorageStats:n,tenantName:s}){const r=(0,zs.zy)(),{metricsTab:i}=(0,b.N4)((e=>e.tenant)),o=(0,U.mA)(r),l=e=>e===i?"":e,c={[S.pA.cpu]:(0,Pa.YL)({...o,[Pa.vh.metricsTab]:l(S.pA.cpu)}),[S.pA.storage]:(0,Pa.YL)({...o,[Pa.vh.metricsTab]:l(S.pA.storage)}),[S.pA.memory]:(0,Pa.YL)({...o,[Pa.vh.metricsTab]:l(S.pA.memory)}),[S.pA.healthcheck]:(0,Pa.YL)({...o,[Pa.vh.metricsTab]:l(S.pA.healthcheck)})};return(0,d.jsxs)("div",{className:io(),children:[(0,d.jsx)(N.N_,{to:c.cpu,className:io("tab"),children:(0,d.jsx)(lo,{poolsCpuStats:e,active:i===S.pA.cpu})}),(0,d.jsx)(N.N_,{to:c.storage,className:io("tab"),children:(0,d.jsx)(co,{blobStorageStats:a,tabletStorageStats:n,active:i===S.pA.storage})}),(0,d.jsx)(N.N_,{to:c.memory,className:io("tab"),children:(0,d.jsx)(uo,{memoryStats:t,active:i===S.pA.memory})}),(0,d.jsx)(N.N_,{to:c.healthcheck,className:io("tab"),children:(0,d.jsx)(eo,{tenantName:s,active:i===S.pA.healthcheck})})]})}function lo({poolsCpuStats:e=[],active:t}){let a=$i.u.Unspecified;const n=e.filter((e=>!("Batch"===e.name||"IO"===e.name))).map((e=>{const{name:t,usage:n,limit:s,used:r}=e,i=(0,Wr.sf)(n);return $i.Z[i]>$i.Z[a]&&(a=i),{title:t,value:r,capacity:s}}));return(0,d.jsx)(ro,{label:vi("cards.cpu-label"),active:t,metrics:n,status:a})}function co({blobStorageStats:e=[],tabletStorageStats:t,active:a}){let n=$i.u.Unspecified;const s=(t||e).map((e=>{const{name:t,used:a,limit:s,usage:r}=e,i=(0,Wr.sf)(r);return $i.Z[i]>$i.Z[n]&&(n=i),{title:t,value:a,capacity:s,formatValues:q.j9}}));return(0,d.jsx)(ro,{label:vi("cards.storage-label"),active:a,metrics:s,status:n})}function uo({active:e,memoryStats:t=[]}){let a=$i.u.Unspecified;const n=t.map((e=>{const{name:t,used:n,limit:s,usage:r}=e,i=(0,Wr.sf)(r);return $i.Z[i]>$i.Z[a]&&(a=i),{title:t,value:n,capacity:s,formatValues:q.j9}}));return(0,d.jsx)(ro,{label:vi("cards.memory-label"),active:e,metrics:n,status:a})}var mo=a(78762),po=a(86782),ho=a(15298),vo=a(40781);const go=(0,c.cn)("tenant-overview");function yo({title:e,error:t,loading:a,tableClassNameModifiers:s={},withData:r,children:i}){return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)("div",{className:go("title"),children:e}),t?(0,d.jsx)(k.o,{error:t}):null,(0,d.jsx)("div",{className:go("table",s),children:t&&!r?null:a?(0,d.jsx)(Ge.Q,{rows:f.Nz}):i})]})}var xo=a(82015);const fo=({prefix:e=vi("top"),entity:t,postfix:a,link:s,onClick:r})=>s?(0,d.jsxs)(n.Fragment,{children:[e," ",(0,d.jsx)(xo.E,{to:s,onClick:r,children:t})," ",a]}):`${e} ${t} ${a}`;function bo({tenantName:e,additionalNodesProps:t}){const a=(0,b.e4)(),[n]=(0,b.Nt)(),[s,r]=function(e){const t={...(0,mo.Nh)(e),width:void 0},a=[(0,mo.kv)(),(0,mo._E)(),t],n=a.map((e=>e.name));return[a,(0,vo.R)(n,po.fN)]}({getNodeRef:null===t||void 0===t?void 0:t.getNodeRef,database:e}),{currentData:i,isFetching:o,error:l}=ho.s.useGetNodesQuery({tenant:e,type:"any",sort:"-CPU",limit:f.Nz,tablets:!1,fieldsRequired:r},{pollingInterval:n}),c=o&&void 0===i,u=(null===i||void 0===i?void 0:i.Nodes)||[],m=fo({entity:vi("nodes"),postfix:vi("by-pools-usage"),link:(0,Pa.YL)({...a,[Pa.vh.diagnosticsTab]:S.iJ.nodes})});return(0,d.jsx)(yo,{title:m,loading:c,error:l,withData:Boolean(i),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:po.zO,data:u,columns:s,emptyDataMessage:vi("top-nodes.empty-data"),settings:f.jp})})}function jo({tenantName:e,additionalNodesProps:t}){const a=(0,b.e4)(),[n]=(0,b.Nt)(),[s,r]=function(e){const t={...(0,mo.Nh)(e),width:void 0},a=[(0,mo.fR)(),(0,mo._E)(),t,(0,mo.Rn)()],n=a.map((e=>e.name));return[a,(0,vo.R)(n,po.fN)]}({getNodeRef:null===t||void 0===t?void 0:t.getNodeRef,database:e}),{currentData:i,isFetching:o,error:l}=ho.s.useGetNodesQuery({tenant:e,type:"any",sort:"-LoadAverage",limit:f.Nz,tablets:!1,fieldsRequired:r},{pollingInterval:n}),c=o&&void 0===i,u=(null===i||void 0===i?void 0:i.Nodes)||[],m=fo({entity:vi("nodes"),postfix:vi("by-load"),link:(0,Pa.YL)({...a,[Pa.vh.diagnosticsTab]:S.iJ.nodes})});return(0,d.jsx)(yo,{title:m,loading:c,error:l,withData:Boolean(i),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:po.zO,data:u,columns:s,emptyDataMessage:vi("top-nodes.empty-data"),settings:f.jp})})}var To=a(12482),So=a(73289),wo=a(16332);const No=JSON.parse('{"action_cancel":"Cancel"}'),Eo=(0,he.g4)("ydb-confirmation-dialog",{en:No}),Co=(0,c.cn)("confirmation-dialog"),Po="confirmation-dialog";function Io({caption:e="",children:t,onConfirm:a,onClose:n,progress:s,textButtonApply:r,textButtonCancel:i,buttonApplyView:o="normal",className:l,renderButtons:c,open:u}){return(0,d.jsxs)(Fn.l,{className:Co(null,l),size:"s",onClose:n,disableOutsideClick:!0,open:u,children:[(0,d.jsx)(Fn.l.Header,{caption:(0,d.jsx)("span",{className:Co("caption"),children:e})}),(0,d.jsx)(Fn.l.Body,{children:t}),(0,d.jsx)(Fn.l.Footer,{onClickButtonApply:a,propsButtonApply:{view:o},textButtonApply:r,textButtonCancel:null!==i&&void 0!==i?i:Eo("action_cancel"),onClickButtonCancel:n,loading:s,renderButtons:c})]})}const Do=wo.vt((e=>{const t=wo.hS(),a=()=>{t.hide(),t.remove()};return(0,d.jsx)(Io,{...e,onConfirm:async()=>{var n;await(null===(n=e.onConfirm)||void 0===n?void 0:n.call(e)),t.resolve(!0),a()},onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.resolve(!1),a()},open:t.visible})}));wo.kz(Po,Do);var _o=a(40569),Ao=a(36894);function Ro(){const[e]=(0,b.iK)(f.ld,[]),t=(0,b.N4)(Ao.cu).toLowerCase();return t?e.filter((e=>e.body.toLowerCase().includes(t))):e}const ko=JSON.parse('{"action.save":"Save query","action.edit":"Edit query","action.save-as-new":"Save as new","action.edit-existing":"Edit existing","description":"The query will be saved in your browser","input-label":"Query name","input-placeholder":"Enter query name","button-apply":"Save","button-cancel":"Cancel","error.name-exists":"This name already exists","error.name-not-empty":"Name should not be empty"}'),Oo=(0,he.g4)("ydb-save-query-dialog",{en:ko}),Mo=(0,c.cn)("ydb-save-query");function Lo(e){const t=(0,b.YQ)();return n.useCallback((()=>{wo.Ay.show(Uo,e),t((0,Ao.gJ)())}),[t,e])}function qo({dialogProps:e,...t}){const a=Lo(e);return(0,d.jsx)(dn.$,{onClick:a,...t,children:Oo("action.save")})}function zo({buttonProps:e={}}){const t=(0,b.YQ)(),a=(0,b.N4)(Ao.aW),n=Lo(),s=()=>{t((0,Ao.Wg)(a)),t((0,So.Xb)(!1)),t((0,Ao.gJ)())};return a?(()=>{const t=[{action:s,text:Oo("action.edit-existing")},{action:n,text:Oo("action.save-as-new")}];return(0,d.jsx)(_o.r,{items:t,renderSwitcher:t=>(0,d.jsx)(dn.$,{...t,...e,children:Oo("action.edit")}),popupProps:{placement:"top"}})})():(0,d.jsx)(qo,{})}function Fo({onSuccess:e,onCancel:t,onClose:a,open:s}){const r=Ro(),i=(0,b.YQ)(),[o,l]=n.useState(""),[c,u]=n.useState(),m=()=>{i((0,Ao.NJ)("idle")),l(""),u(void 0),null===a||void 0===a||a()},p=()=>{null===t||void 0===t||t(),m()};return(0,d.jsxs)(Fn.l,{open:s,hasCloseButton:!1,size:"s",onClose:p,children:[(0,d.jsx)(Fn.l.Header,{caption:Oo("action.save")}),(0,d.jsxs)("form",{onSubmit:t=>{t.preventDefault();const a=(n=o)?r.some((e=>e.name.toLowerCase()===n.trim().toLowerCase()))?Oo("error.name-exists"):void 0:Oo("error.name-not-empty");var n;u(a),a||(i((0,Ao.Wg)(o)),i((0,So.Xb)(!1)),m(),null===e||void 0===e||e())},children:[(0,d.jsxs)(Fn.l.Body,{className:Mo("dialog-body"),children:[(0,d.jsx)("div",{className:Mo("dialog-row"),children:Oo("description")}),(0,d.jsxs)("div",{className:Mo("dialog-row"),children:[(0,d.jsx)("label",{htmlFor:"queryName",className:Mo("field-title","required"),children:Oo("input-label")}),(0,d.jsx)("div",{className:Mo("control-wrapper"),children:(0,d.jsx)(On.k,{id:"queryName",placeholder:Oo("input-placeholder"),value:o,onUpdate:e=>{l(e),u(void 0)},hasClear:!0,autoFocus:!0,autoComplete:!1,validationState:c?"invalid":void 0,errorMessage:c})})]})]}),(0,d.jsx)(Fn.l.Footer,{textButtonApply:Oo("button-apply"),textButtonCancel:Oo("button-cancel"),onClickButtonCancel:p,propsButtonApply:{type:"submit"}})]})]})}const Uo="save-query-dialog",Qo=wo.Ay.create((e=>{const t=wo.Ay.useModal();return(0,d.jsx)(Fo,{...e,onClose:()=>{var a;null===(a=e.onClose)||void 0===a||a.call(e),t.hide(),t.remove()},open:t.visible})}));wo.Ay.register(Uo,Qo);const $o=JSON.parse('{"action_apply":"Don\'t save","context_unsaved-changes-warning":"You have unsaved changes in query editor.\\nDo you want to proceed?"}'),Bo=(0,he.g4)("ydb-change-input-confirmation",{en:$o});function Ho(){const e=wo.Ay.useModal(Po),t=n.useCallback((()=>{e.hide(),e.remove()}),[e]),a=n.useCallback((()=>{e.resolve(!0),t()}),[e,t]),s=n.useCallback((()=>{e.resolve(!1),t()}),[t,e]),r=n.useMemo((()=>({onSuccess:a,onCancel:s})),[a,s]);return(0,d.jsx)(qo,{view:"action",size:"l",dialogProps:r})}async function Wo(){return await wo.Ay.show(Po,{id:Po,caption:Bo("context_unsaved-changes-warning"),textButtonApply:Bo("action_apply"),propsButtonApply:{view:"l"},renderButtons:(e,t)=>(0,d.jsxs)(n.Fragment,{children:[t,(0,d.jsx)(Ho,{}),e]})})}function Go(e){const t=(0,b.N4)(So.Wp),a=(0,b.N4)(So.TY),s=n.useMemo((()=>function(e){return async t=>{await Wo()&&e(t)}}(e)),[e]);return t&&a?s:e}const Vo=(0,c.cn)("kv-truncated-query"),Jo=({value:e="",maxQueryHeight:t=6,hasClipboardButton:a,clipboardButtonAlwaysVisible:s})=>{const r=e.split("\n");if(r.length>t){const i=r.slice(0,t).join("\n"),o="\n...\nThe request was truncated. Click on the line to show the full query on the query tab";return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(Ws.YDBSyntaxHighlighter,{language:"yql",className:Vo(),text:i,withClipboardButton:!!a&&{alwaysVisible:s,copyText:e,withLabel:!1}}),(0,d.jsx)("span",{className:Vo("message",{color:"secondary"}),children:o})]})}return(0,d.jsx)(Ws.YDBSyntaxHighlighter,{language:"yql",text:e,withClipboardButton:!!a&&{alwaysVisible:s,copyText:e,withLabel:!1}})};var Ko=a(70206),Yo=a.n(Ko);const Zo=e=>(Yo().str(e)>>>0).toString(16).toUpperCase().padStart(8,"0"),Xo={...f.N3,dynamicRenderType:"variable"},el=JSON.parse('{"cpu-time":"CPU Time","read-rows":"Read Rows","read-bytes":"Read Bytes","query-hash":"Query Hash","user":"User","start-time":"Start time","end-time":"End time","duration":"Duration","query-text":"Query text","application":"Application","request-units":"Request Units"}'),tl=(0,he.g4)("ydb-top-queries-columns",{en:el}),al="topQueriesColumnsWidth",nl="CPUTime",sl="QueryText",rl="EndTime",il="ReadRows",ol="ReadBytes",ll="UserSID",cl="OneLineQueryText",dl="QueryHash",ul="Duration",ml="QueryStartAt",pl="ApplicationName",hl="RequestUnits",vl=["QueryHash","CPUTime","QueryText","EndTime","Duration","ReadRows","ReadBytes","RequestUnits","UserSID"],gl=["CPUTime","QueryText"],yl=["QueryHash","UserSID","QueryStartAt","QueryText","ApplicationName"],xl=["QueryStartAt","QueryText"],fl={get CPUTime(){return tl("cpu-time")},get QueryText(){return tl("query-text")},get EndTime(){return tl("end-time")},get ReadRows(){return tl("read-rows")},get ReadBytes(){return tl("read-bytes")},get UserSID(){return tl("user")},get OneLineQueryText(){return tl("query-text")},get QueryHash(){return tl("query-hash")},get Duration(){return tl("duration")},get QueryStartAt(){return tl("start-time")},get ApplicationName(){return tl("application")},get RequestUnits(){return tl("request-units")}},bl={CPUTime:"CPUTimeUs",QueryText:void 0,EndTime:void 0,ReadRows:void 0,ReadBytes:"ReadBytes",UserSID:void 0,OneLineQueryText:void 0,QueryHash:void 0,Duration:"Duration",QueryStartAt:void 0,ApplicationName:void 0,RequestUnits:"RequestUnits"},jl={CPUTime:void 0,QueryText:void 0,EndTime:void 0,ReadRows:void 0,ReadBytes:void 0,UserSID:"UserSID",OneLineQueryText:void 0,QueryHash:void 0,Duration:void 0,QueryStartAt:"QueryStartAt",ApplicationName:"ApplicationName",RequestUnits:void 0};function Tl(e){return bl[e]}function Sl(e){return jl[e]}const wl=(0,c.cn)("kv-top-queries"),Nl={name:nl,header:fl.CPUTime,render:({row:e})=>{var t;return(0,ze.Xo)((0,ze.Jc)(null!==(t=e.CPUTimeUs)&&void 0!==t?t:void 0))},width:120,align:Pt.Ay.RIGHT},El={name:sl,header:fl.QueryText,render:({row:e})=>{var t;return(0,d.jsx)("div",{className:wl("query"),children:(0,d.jsx)(Jo,{value:null===(t=e.QueryText)||void 0===t?void 0:t.toString(),maxQueryHeight:6,hasClipboardButton:!0})})},width:500},Cl={name:rl,header:fl.EndTime,render:({row:e})=>(0,q.r6)(new Date(e.EndTime).getTime()),align:Pt.Ay.RIGHT,width:200},Pl={name:il,header:fl.ReadRows,render:({row:e})=>(0,q.ZV)(e.ReadRows),align:Pt.Ay.RIGHT,width:150},Il={name:ol,header:fl.ReadBytes,render:({row:e})=>(0,q.ZV)(e.ReadBytes),align:Pt.Ay.RIGHT,width:150},Dl={name:ll,header:fl.UserSID,render:({row:e})=>(0,d.jsx)("div",{className:wl("user-sid"),children:e.UserSID||"\u2013"}),align:Pt.Ay.LEFT,width:120},_l={name:cl,header:fl.OneLineQueryText,render:({row:e})=>{var t;return(0,d.jsx)(Ws.YDBSyntaxHighlighter,{language:"yql",text:(null===(t=e.QueryText)||void 0===t?void 0:t.toString())||"",withClipboardButton:{withLabel:!1}})},width:500},Al={name:dl,header:fl.QueryHash,render:({row:e})=>Zo(String(e.QueryText)),width:130},Rl={name:ul,header:fl.Duration,render:({row:e})=>{var t;return(0,ze.Xo)((0,ze.Jc)(null!==(t=e.Duration)&&void 0!==t?t:void 0))},align:Pt.Ay.RIGHT,width:150},kl={name:ml,header:fl.QueryStartAt,render:({row:e})=>(0,q.r6)(new Date(e.QueryStartAt).getTime()),resizeable:!1,width:160},Ol={name:hl,header:fl.RequestUnits,render:({row:e})=>(0,q.ZV)(e.RequestUnits),align:Pt.Ay.RIGHT,width:150},Ml={name:pl,header:fl.ApplicationName,render:({row:e})=>(0,d.jsx)("div",{className:wl("user-sid"),children:e.ApplicationName||"\u2013"})};function Ll({tenantName:e}){var t,a;const s=(0,b.YQ)(),r=(0,zs.zy)(),i=(0,zs.W6)(),o=(0,U.mA)(r),[l]=(0,b.Nt)(),c=n.useMemo((()=>[Al,_l,Nl]),[]),{currentData:u,isFetching:m,error:p}=To.Ke.useGetTopQueriesQuery({database:e,timeFrame:"hour",limit:f.Nz},{pollingInterval:l}),h=m&&void 0===u,v=(null===u||void 0===u||null===(t=u.resultSets)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.result)||[],g=Go(n.useCallback((e=>{const{QueryText:t}=e;s((0,So.iZ)({input:t})),s((0,So.Xb)(!1));const a=(0,U.mA)(r),n=(0,Pa.YL)({...a,[S.Dt]:S.Dg.query,[Pa.vh.queryTab]:S.tQ.newQuery});i.push(n)}),[s,i,r])),y=fo({entity:vi("queries"),postfix:vi("by-cpu-time",{executionPeriod:vi("executed-last-hour")}),onClick:()=>{s((0,To.TX)({from:void 0,to:void 0}))},link:(0,Pa.YL)({...o,[Pa.vh.diagnosticsTab]:S.iJ.topQueries})});return(0,d.jsx)(yo,{title:y,loading:h,error:(0,Ve.Cb)(p),withData:Boolean(u),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:al,data:v,columns:c,onRowClick:g,rowClassName:()=>go("top-queries-row"),settings:f.jp})})}var ql=a(34271);function zl(e,t){const a=`CAST(SUBSTRING(CAST(Path AS String), ${t.length}) AS Utf8) AS RelativePath`;return`${f.Zi}\nSELECT\n    ${a},\n    TabletId,\n    CPUCores,\nFROM \`.sys/partition_stats\`\nWHERE\n    Path='${e}'\n    OR Path LIKE '${e}/%'\nORDER BY CPUCores DESC\nLIMIT ${f.Nz}`}const Fl=g.F.injectEndpoints({endpoints:e=>({getTopShards:e.query({queryFn:async({database:e,path:t=""},{signal:a})=>{try{const n=await window.api.viewer.sendQuery({query:zl(t,e),database:e,action:"execute-scan"},{signal:a,withRetries:!0});return(0,Ve.We)(n)?{error:n}:{data:(0,Ve.fW)(n)}}catch(n){return{error:n||new Error("Unauthorized")}}},providesTags:["All"]})}),overrideExisting:"throw"}),Ul=["TabletId","Path","CPUCores"],Ql=({tenantName:e,path:t})=>{var a,n;const s=(0,ql.x)("ShardsTable"),r=(0,zs.zy)(),i=(0,U.mA)(r),[o]=(0,b.Nt)(),{currentData:l,isFetching:c,error:u}=Fl.useGetTopShardsQuery({database:e,path:t},{pollingInterval:o}),m=c&&void 0===l,p=(null===l||void 0===l||null===(a=l.resultSets)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.result)||[],h=fo({entity:vi("shards"),postfix:vi("by-cpu-usage"),link:(0,Pa.YL)({...i,[Pa.vh.diagnosticsTab]:S.iJ.topShards})});return(0,d.jsx)(yo,{title:h,loading:m,error:(0,Ve.Cb)(u),withData:Boolean(l),children:(0,d.jsx)(s,{data:p,schemaPath:e,database:e,columnsIds:Ul,settings:f.jp})})},$l=[{title:vi("charts.cpu-usage"),metrics:["IC","IO","Batch","User","System"].map((e=>({target:`resources.cpu.${e}.usage`,title:e}))),options:{dataType:"percent",scaleRange:{min:0,max:1},showLegend:!0}}];function Bl({tenantName:e,additionalNodesProps:t}){return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(pi,{database:e,charts:$l}),(0,d.jsx)(jo,{tenantName:e,additionalNodesProps:t}),(0,d.jsx)(bo,{tenantName:e,additionalNodesProps:t}),(0,d.jsx)(Ql,{tenantName:e,path:e}),(0,d.jsx)(Ll,{tenantName:e})]})}var Hl=a(73473);function Wl({tenantName:e,additionalNodesProps:t}){const a=(0,b.e4)(),[n]=(0,b.Nt)(),[s,r]=function(e){const t=[(0,mo._E)(),(0,mo.Nh)(e),(0,mo.jl)(),(0,mo.fR)(),(0,mo.iX)(),(0,mo.oz)(),(0,mo.qp)(e)],a=t.map((e=>e.name));return[t,(0,vo.R)(a,po.fN)]}({getNodeRef:null===t||void 0===t?void 0:t.getNodeRef,database:e}),{currentData:i,isFetching:o,error:l}=ho.s.useGetNodesQuery({tenant:e,type:"any",tablets:!0,sort:"-Memory",limit:f.Nz,fieldsRequired:r},{pollingInterval:n}),c=o&&void 0===i,u=(null===i||void 0===i?void 0:i.Nodes)||[],m=fo({entity:vi("nodes"),postfix:vi("by-memory"),link:(0,Pa.YL)({...a,[Pa.vh.diagnosticsTab]:S.iJ.nodes})});return(0,d.jsx)(yo,{title:m,loading:c,error:l,withData:Boolean(i),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:po.zO,data:u,columns:s,emptyDataMessage:vi("top-nodes.empty-data"),settings:f.jp})})}const Gl=[{title:vi("charts.memory-usage"),metrics:[{target:"resources.memory.used_bytes",title:vi("charts.memory-usage")}],options:{dataType:"size"}}];function Vl({tenantName:e,memoryStats:t,memoryUsed:a,memoryLimit:s}){return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(pi,{database:e,charts:Gl}),(0,d.jsx)("div",{className:go("title"),children:"Memory details"}),(0,d.jsx)("div",{className:go("memory-info"),children:t?(0,d.jsx)(Hl.S,{formatValues:q.vX,stats:t}):(0,d.jsx)(to.O,{value:a,capacity:s,formatValues:q.vX,colorizeProgress:!0})}),(0,d.jsx)(Wl,{tenantName:e})]})}var Jl=a(18863),Kl=a(10174),Yl=a(74006),Zl=a(74319);function Xl({tenant:e}){const t=(0,b.e4)(),a=(0,D.Pm)(),n=(0,D.YA)(),[s]=(0,b.Nt)(),[r,i]=function(){const e=(0,Yl.k)(),t=e.map((e=>e.name));return[e,(0,vo.R)(t,Zl.YX)]}(),{currentData:o,isFetching:l,error:c}=Kl.S.useGetStorageGroupsInfoQuery({tenant:e,sort:"-Usage",with:"all",limit:f.Nz,shouldUseGroupsHandler:n,fieldsRequired:i},{pollingInterval:s,skip:!a}),u=l&&void 0===o,m=(null===o||void 0===o?void 0:o.groups)||[],p=fo({entity:vi("groups"),postfix:vi("by-usage"),link:(0,Pa.YL)({...t,[Pa.vh.diagnosticsTab]:S.iJ.storage})});return(0,d.jsx)(yo,{title:p,loading:u||!a,error:c,withData:Boolean(o),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:Zl.qK,data:m,columns:r,settings:f.jp})})}var ec=a(91135);const tc=g.F.injectEndpoints({endpoints:e=>({getTopTables:e.query({queryFn:async({database:e},{signal:t})=>{try{const a=await window.api.viewer.sendQuery({query:`${f.Zi}\nSELECT\n    Path, SUM(DataSize) as Size\nFROM \`.sys/partition_stats\`\nGROUP BY Path\nORDER BY Size DESC\nLIMIT ${f.Nz}\n`,database:e,action:"execute-scan"},{signal:t,withRetries:!0});return(0,Ve.We)(a)?{error:a}:{data:(0,Ve.fW)(a)}}catch(a){return{error:a||"Unauthorized"}}},providesTags:["All"]})}),overrideExisting:"throw"});function ac({database:e}){var t,a;const[n]=(0,b.Nt)(),{currentData:s,error:r,isFetching:i}=tc.useGetTopTablesQuery({database:e},{pollingInterval:n}),o=i&&void 0===s,l=(null===s||void 0===s||null===(t=s.resultSets)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.result)||[],c=[{name:"Size",width:100,render:({row:e})=>(e=>{const t=(0,da.fn)(null!==l&&void 0!==l&&l.length?Number(l[0].Size):0);return(0,da.z3)({value:e,size:t,precision:1})})(Number(e.Size)),align:Pt.Ay.RIGHT},{name:"Path",width:700,render:({row:e})=>e.Path?(0,d.jsx)(Oe.s,{content:e.Path,children:(0,d.jsx)(ec.I,{path:String(e.Path),children:e.Path})}):null}],u=fo({entity:vi("tables"),postfix:vi("by-size")});return(0,d.jsx)(yo,{title:u,loading:o,error:(0,Ve.Cb)(r),withData:Boolean(s),children:(0,d.jsx)(ce.l,{columnsWidthLSKey:"topTablesTableColumnsWidth",data:l,columns:c,settings:f.jp})})}const nc=[{title:vi("charts.storage-usage"),metrics:[{target:"resources.storage.used_bytes",title:vi("charts.storage-usage")}],options:{dataType:"size"}}];function sc({tenantName:e,metrics:t}){const{blobStorageUsed:a,tabletStorageUsed:s,blobStorageLimit:r,tabletStorageLimit:i}=t,o=[{label:(0,d.jsx)(Da,{text:vi("storage.tablet-storage-title"),popoverContent:vi("storage.tablet-storage-description")}),value:(0,d.jsx)(to.O,{value:s,capacity:i,formatValues:q.j9,colorizeProgress:!0})},{label:(0,d.jsx)(Da,{text:vi("storage.db-storage-title"),popoverContent:vi("storage.db-storage-description")}),value:(0,d.jsx)(to.O,{value:a,capacity:r,formatValues:q.j9,colorizeProgress:!0})}];return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(pi,{database:e,charts:nc}),(0,d.jsx)(Jl.z,{className:go("storage-info"),title:"Storage details",info:o}),(0,d.jsx)(ac,{database:e}),(0,d.jsx)(Xl,{tenant:e})]})}function rc({tenantName:e,additionalTenantProps:t,additionalNodesProps:a}){var n,s,r,i;const{metricsTab:o}=(0,b.N4)((e=>e.tenant)),[l]=(0,b.Nt)(),c=(0,Gr.H)(),{currentData:u,isFetching:m}=_.z6.useGetTenantInfoQuery({path:e,clusterName:c},{pollingInterval:l}),p=m&&void 0===u,{Name:h,Type:v,Overall:g}=u||{},x=(j=v)&&ot[j];var j;const{currentData:T}=y.useGetOverviewQuery({path:e,database:e},{pollingInterval:l}),{Tables:w,Topics:N}=(null===T||void 0===T||null===(n=T.PathDescription)||void 0===n||null===(s=n.DomainDescription)||void 0===s?void 0:s.DiskSpaceUsage)||{},E=[null===w||void 0===w?void 0:w.TotalSize,null===N||void 0===N?void 0:N.DataSize].reduce(((e,t)=>t?e+Number(t):e),0),C={...u,Metrics:{...null===u||void 0===u?void 0:u.Metrics,Storage:String(E)}},{blobStorage:P,tabletStorage:I,blobStorageLimit:D,tabletStorageLimit:A,poolsStats:R,memoryStats:k,blobStorageStats:O,tabletStorageStats:M}=(0,Wr.uI)(C),L={blobStorageUsed:P,blobStorageLimit:D,tabletStorageUsed:I,tabletStorageLimit:A};if(p)return(0,d.jsx)("div",{className:go("loader"),children:(0,d.jsx)(Fr.a,{size:"m"})});const q=null===t||void 0===t||null===(r=t.getMonitoringLink)||void 0===r?void 0:r.call(t,h,v),z=null===t||void 0===t||null===(i=t.getLogsLink)||void 0===i?void 0:i.call(t,h);return(0,d.jsxs)("div",{className:go(),children:[(0,d.jsxs)("div",{className:go("info"),children:[(0,d.jsx)("div",{className:go("top-label"),children:x}),(0,d.jsxs)(_e.s,{alignItems:"center",gap:"1",className:go("top"),children:[(0,d.jsx)("div",{className:go("tenant-name-wrapper"),children:(0,d.jsx)(_s.c,{status:g,name:h||f.oK,withLeftTrim:!0,hasClipboardButton:Boolean(u),clipboardButtonAlwaysVisible:!0})}),(0,d.jsxs)(_e.s,{gap:"2",children:[q&&(0,d.jsx)(Hr,{href:q}),z&&(0,d.jsx)(Qr,{href:z})]})]}),(0,d.jsx)(oo,{poolsCpuStats:R,memoryStats:k,blobStorageStats:O,tabletStorageStats:M,tenantName:e})]}),(()=>{switch(o){case S.pA.cpu:return(0,d.jsx)(Bl,{tenantName:e,additionalNodesProps:a});case S.pA.storage:return(0,d.jsx)(sc,{tenantName:e,metrics:L});case S.pA.memory:return(0,d.jsx)(Vl,{tenantName:e,memoryUsed:C.MemoryUsed,memoryLimit:C.MemoryLimit,memoryStats:C.MemoryStats});case S.pA.healthcheck:return(0,d.jsx)(Qi,{tenantName:e});default:return(0,d.jsx)(yi,{database:e})}})()]})}const ic=(0,c.cn)("kv-detailed-overview");const oc=function(e){const{type:t,tenantName:a,path:n,additionalTenantProps:s,additionalNodesProps:r}=e,i=a===n;return(0,d.jsx)("div",{className:ic(),children:i?(0,d.jsx)("div",{className:ic("section"),children:(0,d.jsx)(rc,{tenantName:a,additionalTenantProps:s,additionalNodesProps:r})}):(0,d.jsx)(qr,{type:t,path:n,database:a})})},lc={id:S.iJ.overview,title:"Info"},cc={id:S.iJ.schema,title:"Schema"},dc={id:S.iJ.topQueries,title:"Queries"},uc={id:S.iJ.topShards,title:"Top shards"},mc={id:S.iJ.nodes,title:"Nodes"},pc={id:S.iJ.tablets,title:"Tablets"},hc={id:S.iJ.storage,title:"Storage"},vc={id:S.iJ.network,title:"Network"},gc={id:S.iJ.describe,title:"Describe"},yc={id:S.iJ.hotKeys,title:"Hot keys"},xc={id:S.iJ.graph,title:"Graph"},fc={id:S.iJ.consumers,title:"Consumers"},bc={id:S.iJ.partitions,title:"Partitions"},jc={id:S.iJ.topicData,title:"Data"},Tc=[lc,pc,gc],Sc=[lc,pc,gc],wc=[lc,dc,uc,mc,pc,hc,vc,gc,{id:S.iJ.configs,title:"Configs"},{id:S.iJ.operations,title:"Operations"}],Nc=[lc,cc,uc,mc,xc,pc,yc,gc],Ec=[lc,cc,uc,mc,pc,gc],Cc=[lc,uc,mc,gc],Pc=[lc,fc,bc,mc,gc],Ic=[lc,mc,pc,gc],Dc=[lc,fc,bc,jc,mc,pc,gc],_c=[lc,gc],Ac=[lc,cc,gc],Rc=[lc,cc,gc],kc={[Ye.EPathTypeInvalid]:void 0,[Ye.EPathTypeSubDomain]:wc,[Ye.EPathTypeExtSubDomain]:wc,[Ye.EPathTypeColumnStore]:wc,[Ye.EPathTypeTable]:Nc,[Ye.EPathTypeColumnTable]:Ec,[Ye.EPathTypeDir]:Cc,[Ye.EPathTypeTableIndex]:Cc,[Ye.EPathTypeCdcStream]:Pc,[Ye.EPathTypePersQueueGroup]:Dc,[Ye.EPathTypeExternalDataSource]:_c,[Ye.EPathTypeExternalTable]:Ac,[Ye.EPathTypeView]:Rc,[Ye.EPathTypeReplication]:Tc,[Ye.EPathTypeTransfer]:Sc,[Ye.EPathTypeResourcePool]:Cc},Oc={[Ze.EPathSubTypeStreamImpl]:Ic,[Ze.EPathSubTypeSyncIndexImplTable]:void 0,[Ze.EPathSubTypeAsyncIndexImplTable]:void 0,[Ze.EPathSubTypeEmpty]:void 0},Mc=(e,t,a)=>{let n=(t?Oc[t]:void 0)||(e?kc[e]:void 0)||Cc;var s;return!(e=>e===Ye.EPathTypePersQueueGroup)(e)||null!==a&&void 0!==a&&a.hasTopicData?(vt(e)||null!==a&&void 0!==a&&a.isTopLevel)&&(n=wc,null===a||void 0===a||!a.hasFeatureFlags)?n.filter((e=>e.id!==S.iJ.configs)):n:null===(s=n)||void 0===s?void 0:s.filter((e=>e.id!==S.iJ.topicData))},Lc=()=>{const[e]=(0,r.useQueryParams)({database:r.StringParam,schema:r.StringParam,backend:r.StringParam,clusterName:r.StringParam});return n.useCallback(((t,a)=>(0,Pa.YL)({...e,[Pa.vh.diagnosticsTab]:t,...a})),[e])};var qc=a(81240),zc=a(80604);const Fc=g.F.injectEndpoints({endpoints:e=>({getHotKeys:e.query({queryFn:async({path:e,database:t},{signal:a})=>{try{var n;const s=await window.api.viewer.getHotKeys({path:e,database:t,enableSampling:!0},{signal:a});if(Array.isArray(s.hotkeys))return{data:s.hotkeys};await Promise.race([new Promise((e=>{setTimeout(e,5e3)})),new Promise(((e,t)=>{a.addEventListener("abort",t)}))]);return{data:null!==(n=(await window.api.viewer.getHotKeys({path:e,database:t,enableSampling:!1},{signal:a})).hotkeys)&&void 0!==n?n:null}}catch(s){return{error:s}}},providesTags:["All"]})}),overrideExisting:"throw"}),Uc=JSON.parse('{"hot-keys-collecting":"Please wait a little while we are collecting hot keys samples...","no-data":"No information about hot keys","help":"Hot keys contains a list of table primary key values that are accessed most often. Sample is collected upon request to the tab during 5s time interval. Samples column indicates how many requests to the particular key value were registered during collection phase."}'),Qc=(0,he.g4)("ydb-hot-keys",{en:Uc});var $c;function Bc(){return Bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Bc.apply(null,arguments)}const Hc=function(e){return n.createElement("svg",Bc({viewBox:"0 0 12 7",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},e),$c||($c=n.createElement("path",{d:"M8 7h3V5h1V2H6.66C6.085.79 4.86 0 3.5 0 1.57 0 0 1.57 0 3.5S1.57 7 3.5 7c1.36 0 2.59-.79 3.16-2H8v2zm2-1H9V4H5.97l-.115.335a2.5 2.5 0 110-1.67L5.97 3H11v1h-1v2zM3.5 5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM3 3.5a.5.5 0 111 0 .5.5 0 01-1 0z"})))},Wc=(0,c.cn)("ydb-hot-keys"),Gc="accessSample";function Vc({path:e,database:t}){var a,s;const{currentData:r,isFetching:i,error:o}=Fc.useGetHotKeysQuery({path:e,database:t}),l=i&&void 0===r,[c]=(0,b.Nt)(),{currentData:u,isLoading:m}=y.useGetOverviewQuery({path:e,database:t},{pollingInterval:c}),p=null===u||void 0===u||null===(a=u.PathDescription)||void 0===a||null===(s=a.Table)||void 0===s?void 0:s.KeyColumnNames,h=n.useMemo((()=>((e=[])=>[...e.map(((e,t)=>({name:e,header:(0,d.jsxs)("div",{className:Wc("primary-key-column"),children:[(0,d.jsx)(Re.I,{data:Hc,width:12,height:7}),e]}),render:({row:e})=>e.keyValues[t],align:Pt.Ay.RIGHT,sortable:!1}))),{name:Gc,header:"Samples",render:({row:e})=>e.accessSample,align:Pt.Ay.RIGHT,sortable:!1}])(p)),[p]);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(Jc,{}),l||m?(0,d.jsx)("div",{children:Qc("hot-keys-collecting")}):o?(0,d.jsx)(k.o,{error:o}):r?(0,d.jsx)(ce.l,{wrapperClassName:Wc("table"),columns:h,data:r,settings:f.N3,initialSortOrder:{columnId:Gc,order:Pt.Ay.DESCENDING}}):(0,d.jsx)("div",{children:Qc("no-data")})]})}function Jc(){const[e,t]=(0,b.iK)(f.Gj);return e?null:(0,d.jsxs)(zc.Z,{theme:"info",view:"filled",type:"container",className:Wc("help-card"),children:[Qc("help"),(0,d.jsx)(dn.$,{className:Wc("help-card__close-button"),view:"flat",onClick:()=>t(!0),children:(0,d.jsx)(Re.I,{data:qc.A,size:18})})]})}var Kc=a(78524),Yc=a(9252);const Zc=g.F.injectEndpoints({endpoints:e=>({getNetworkInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.viewer.getNetwork({path:e,database:e},{signal:t})}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"});var Xc=a(88610),ed=a(29819);const td=(0,c.cn)("node-network");function ad(){}function nd({nodeId:e,connected:t,capacity:a,rack:s,status:r,onClick:i=ad,onMouseEnter:o=ad,onMouseLeave:l=ad,showID:c,isBlurred:u}){const m=n.useRef(null),p=r||function(e=0,t=0){const a=Math.floor(e/t*100);return 100===a?Ai.m.Green:a>=70?Ai.m.Yellow:a>=1?Ai.m.Red:Ai.m.Grey}(t,a);return(0,d.jsx)("div",{ref:m,className:td({[p.toLowerCase()]:!0,id:c,blur:u}),onMouseEnter:()=>{o(m.current,{nodeId:e,connected:t,capacity:a,rack:s},"node")},onMouseLeave:()=>{l()},onClick:()=>i(e),children:c?e:null})}const sd=e=>null===e||void 0===e?void 0:e.reduce(((e,t)=>t.Connected?e+1:e),0);var rd,id,od,ld,cd,dd,ud,md,pd,hd,vd,gd,yd,xd,fd;function bd(){return bd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},bd.apply(null,arguments)}const jd=function(e){return n.createElement("svg",bd({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 221 204"},e),rd||(rd=n.createElement("path",{d:"M68.46 2.529v25.227c0 1.227.876 2.278 2.102 2.511 16.643 2.979 29.14 17.812 28.498 35.448-.642 18.045-15.359 32.703-33.345 33.403-17.636.643-32.41-11.854-35.448-28.44a2.562 2.562 0 00-2.51-2.102H2.528c-1.519 0-2.687 1.285-2.512 2.745 3.446 32.703 31.243 58.106 64.939 57.814 35.155-.292 63.829-29.024 64.121-64.18.292-33.695-25.17-61.492-57.873-64.938-1.46-.175-2.744.993-2.744 2.512z",fill:"#EBF2FA"})),id||(id=n.createElement("path",{d:"M22.736 18.354l17.811 17.812c.876.876 2.278.992 3.329.233 4.146-3.095 9.052-5.197 14.366-6.19 1.226-.233 2.102-1.226 2.102-2.511V2.528a2.502 2.502 0 00-2.803-2.51C44.46 1.418 32.488 6.674 22.91 14.674c-1.168.935-1.226 2.628-.175 3.68zm-9.403 6.133C6.093 33.83 1.303 45.16.02 57.54c-.176 1.46 1.05 2.745 2.51 2.745H27.7a2.562 2.562 0 002.511-2.103c.818-4.672 2.628-9.051 5.14-12.847a2.642 2.642 0 00-.293-3.212L17.13 24.312c-1.05-1.11-2.861-.993-3.796.175zm67.275 107.392h32.995c1.868 0 3.387 1.518 3.445 3.445v65.231a3.451 3.451 0 01-3.445 3.445H80.608a3.452 3.452 0 01-3.446-3.445v-65.231a3.451 3.451 0 013.446-3.445zm77.844 27.097h-32.878a3.514 3.514 0 00-3.503 3.504v37.959a3.514 3.514 0 003.503 3.504h32.878a3.515 3.515 0 003.504-3.504V162.48a3.515 3.515 0 00-3.504-3.504zm12.205 18.28h32.586a3.639 3.639 0 013.621 3.62v19.388a3.639 3.639 0 01-3.621 3.621h-32.586a3.639 3.639 0 01-3.62-3.621v-19.388a3.638 3.638 0 013.62-3.62z",fill:"#EBF2FA"})),od||(od=n.createElement("path",{d:"M134.275 171.532h-113c-5.84 0-10.628-4.789-10.628-10.629v-73.23c0-5.84 4.788-10.629 10.628-10.629h112.941c5.84 0 10.629 4.789 10.629 10.629v73.23c.058 5.899-4.731 10.629-10.57 10.629v0z",stroke:"#2EE5C0",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round"})),ld||(ld=n.createElement("path",{d:"M21.625 90.769a3.037 3.037 0 100-6.074 3.037 3.037 0 000 6.074zM31.494 90.769a3.037 3.037 0 100-6.074 3.037 3.037 0 000 6.074zM41.363 90.769a3.037 3.037 0 100-6.074 3.037 3.037 0 000 6.074z",fill:"#2EE5C0"})),cd||(cd=n.createElement("path",{d:"M10.822 98.592h133.673",stroke:"#2EE5C0",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round"})),dd||(dd=n.createElement("path",{d:"M184.555 149.164L57.89 156.172c-4.263.234-7.767-3.037-7.767-7.3V51.114c0-4.263 3.504-7.533 7.767-7.3l126.665 7.008c3.27.176 5.898 3.33 5.898 7.008v84.327c0 3.679-2.628 6.832-5.898 7.007z",fill:"#027BF3"})),ud||(ud=n.createElement("path",{d:"M65.13 54.151c0 1.986-1.576 3.504-3.562 3.387-1.985-.058-3.562-1.752-3.562-3.737 0-1.986 1.635-3.504 3.562-3.387 1.927.058 3.562 1.752 3.562 3.737zm11.506.466a3.38 3.38 0 01-3.504 3.388c-1.927-.059-3.504-1.753-3.504-3.68a3.38 3.38 0 013.504-3.387c1.927.117 3.504 1.752 3.504 3.68zm7.825 3.855c1.869.117 3.387-1.402 3.387-3.329 0-1.927-1.518-3.562-3.387-3.62-1.927-.117-3.445 1.401-3.445 3.328 0 1.927 1.576 3.562 3.445 3.62z",fill:"#fff"})),md||(md=n.createElement("path",{d:"M75.467 142.974V85.277c-3.971-.525-8.584-.409-13.899.7v57.64l13.899-.643zM88.84 90.651v51.799l-11.096.467v-57.23c4.322.934 7.942 2.745 11.096 4.964zm13.431 13.899a1.618 1.618 0 01-.146-.176 1.487 1.487 0 00-.146-.175c-.42-.51-.841-1.026-1.265-1.546-2.875-3.522-5.874-7.197-9.538-10.25v49.93l11.095-.467V104.55zm13.432 5.722c-3.913-.058-7.709-.701-11.096-3.445v34.922l11.096-.468v-31.009zm13.431-.409c-2.764-.173-5.529.006-8.246.181-.957.062-1.907.123-2.849.169v30.951l11.095-.467v-30.834zm24.002 29.841l-8.234.35v-22.191c8.176 9.285 8.234 21.841 8.234 21.841zM140.113 113.6a19.774 19.774 0 012.453 1.927v24.644l-11.096.467v-30.483c2.92.467 5.782 1.46 8.643 3.445z",fill:"#00236B"})),pd||(pd=n.createElement("path",{d:"M55.745 76.436a2 2 0 103.123 2.499l-3.123-2.499zm5.766-4.006l1.575-1.233a2 2 0 00-3.136-.017l1.561 1.25zm2.63 6.605a2 2 0 103.15-2.465l-3.15 2.465zm107.94 53.502a2 2 0 00-2.499 3.123l2.499-3.123zm4.006 5.766l1.214 1.59a1.999 1.999 0 00.036-3.151l-1.25 1.561zm-6.644 2.557a1.999 1.999 0 102.427 3.179l-2.427-3.179zM58.868 78.935l4.205-5.256-3.123-2.499-4.205 5.256 3.123 2.499zm1.068-5.273l4.205 5.373 3.15-2.465-4.205-5.373-3.15 2.465zm109.646 61.998l5.256 4.205 2.499-3.123-5.256-4.205-2.499 3.123zm5.292 1.054l-5.431 4.146 2.427 3.179 5.431-4.146-2.427-3.179zM147.137 69.146a2 2 0 10-.149 3.998l.149-3.998zm29.634 5.107a2 2 0 10.149-3.997l-.149 3.997zm-29.657 5.404a2 2 0 00-.102 3.999l.102-3.999zm29.681 4.758a2 2 0 00.102-3.999l-.102 4zm-29.72 5.928a2 2 0 10-.023 4l.023-4zm29.759 4.176a2 2 0 10.024-4l-.024 4zm-29.846-21.375l29.783 1.11.149-3.998-29.783-1.11-.149 3.998zm.024 10.512l29.783.76.102-4-29.783-.759-.102 3.999zm.04 10.687l29.782.176.024-4-29.783-.175-.023 4zM143.442 71.202a2.458 2.458 0 01-2.57 2.453c-1.401-.058-2.569-1.285-2.569-2.686 0-1.402 1.168-2.57 2.569-2.453 1.46.058 2.57 1.285 2.57 2.686zm.001 10.396a2.458 2.458 0 01-2.57 2.453c-1.401-.059-2.569-1.285-2.569-2.686 0-1.46 1.168-2.57 2.569-2.453 1.46.058 2.57 1.284 2.57 2.686zm-2.57 12.848a2.458 2.458 0 002.57-2.453c0-1.402-1.11-2.628-2.57-2.686-1.401-.117-2.569 1.05-2.569 2.452s1.168 2.628 2.569 2.687z",fill:"#fff"})),hd||(hd=n.createElement("path",{opacity:.2,d:"M190.452 91.875V57.771c0-3.68-2.628-6.833-5.899-7.008l-23.651-1.285a35.18 35.18 0 00-1.752 10.98c0 17.635 12.79 31.826 28.09 31.65 1.051.06 2.16-.058 3.212-.233z",fill:"#00236B"})),vd||(vd=n.createElement("path",{d:"M220.645 58.883c0-16.585-11.621-30.775-26.454-31.651-15.3-.876-28.089 12.672-28.089 30.308s12.789 31.827 28.089 31.652c14.833-.117 26.454-13.724 26.454-30.309z",fill:"#FF4645"})),gd||(gd=n.createElement("path",{d:"M215.329 40.372c-4.788-7.475-12.38-12.614-21.14-13.14v31.01l21.14-17.87z",fill:"#FC0"})),yd||(yd=n.createElement("path",{d:"M215.329 40.372l-21.14 17.87 26.455.642c0-6.89-1.986-13.315-5.315-18.512z",fill:"#00236B"})),xd||(xd=n.createElement("path",{d:"M194.248 58.24V27.233c-15.301-.876-28.09 12.672-28.09 30.308l28.09.7z",fill:"#FF4645"})),fd||(fd=n.createElement("path",{d:"M161.151 14.734a2 2 0 10-4 0h4zm-4 4.204a2 2 0 004 0h-4zm4 8.876a2 2 0 10-4 0h4zm-4 4.555a2 2 0 004 0h-4zm10.819-6.816a2 2 0 000-4v4zm-4.263-4a2 2 0 100 4v-4zm-9.169 4a2 2 0 100-4v4zm-4.263-4a2 2 0 000 4v-4zm6.876-6.82v4.205h4v-4.204h-4zm0 13.08v4.556h4v-4.555h-4zm10.819-6.26h-4.263v4h4.263v-4zm-13.432 0h-4.263v4h4.263v-4z",fill:"#2EE5C0"})))},Td=(0,c.cn)("network");function Sd({tenantName:e}){var t,a;const[s]=(0,b.Nt)(),r=(0,b.N4)(Xc.yV),i=(0,b.YQ)(),[o,l]=n.useState(),[c,u]=n.useState(!1),[m,p]=n.useState(!1),{currentData:h,isFetching:v,error:g}=Zc.useGetNetworkInfoQuery(e,{pollingInterval:s});if(v&&void 0===h)return(0,d.jsx)("div",{className:"loader",children:(0,d.jsx)(Fr.a,{size:"l"})});const y=h,x=null!==(t=(null===y||void 0===y?void 0:y.Tenants)&&y.Tenants[0].Nodes)&&void 0!==t?t:[];if(!g&&0===x.length)return(0,d.jsx)("div",{className:"error",children:"no nodes data"});const f=Nd(x,"NodeType"),j=o?Nd(null!==(a=o.Peers)&&void 0!==a?a:[],"NodeType"):{};return(0,d.jsxs)("div",{className:Td(),children:[g?(0,d.jsx)(k.o,{error:g}):null,x.length>0?(0,d.jsx)("div",{className:Td("inner"),children:(0,d.jsxs)("div",{className:Td("nodes-row"),children:[(0,d.jsxs)("div",{className:Td("left"),children:[(0,d.jsx)("div",{className:Td("controls-wrapper"),children:(0,d.jsxs)("div",{className:Td("controls"),children:[(0,d.jsx)(Yc.k,{value:r,onChange:e=>{i((0,Xc.$u)(e))},className:Td("problem-filter")}),(0,d.jsx)("div",{className:Td("checkbox-wrapper"),children:(0,d.jsx)(R.S,{onUpdate:()=>{u(!c)},checked:c,children:"ID"})}),(0,d.jsx)("div",{className:Td("checkbox-wrapper"),children:(0,d.jsx)(R.S,{onUpdate:()=>{p(!m)},checked:m,children:"Racks"})})]})}),(0,d.jsx)(wd,{nodes:f,showId:c,showRacks:m,clickedNode:o,onClickNode:l})]}),(0,d.jsx)("div",{className:Td("right"),children:o?(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:Td("label"),children:["Connectivity of node"," ",(0,d.jsx)(N.N_,{className:Td("link"),to:(0,ed.vI)(o.NodeId),children:o.NodeId})," ","to other nodes"]}),(0,d.jsx)("div",{className:Td("nodes-row"),children:(0,d.jsx)(wd,{nodes:j,isRight:!0,showId:c,showRacks:m,clickedNode:o,onClickNode:l})})]}):(0,d.jsxs)("div",{className:Td("placeholder"),children:[(0,d.jsx)("div",{className:Td("placeholder-img"),children:(0,d.jsx)(Re.I,{data:jd,width:221,height:204})}),(0,d.jsx)("div",{className:Td("placeholder-text"),children:"Select node to see its connectivity to other nodes"})]})})]})}):null]})}function wd({nodes:e,isRight:t,showId:a,showRacks:n,clickedNode:s,onClickNode:r}){const i=(0,b.N4)(Xc.yV),o=(0,b.YQ)();let l=0;const c=Object.keys(e).map(((c,u)=>{const m=Nd(e[c],"Rack");return(0,d.jsxs)("div",{className:Td("nodes-container",{right:t}),children:[(0,d.jsxs)("div",{className:Td("nodes-title"),children:[c," nodes"]}),(0,d.jsx)("div",{className:Td("nodes"),children:n?Object.keys(m).map(((e,n)=>(0,d.jsxs)("div",{className:Td("rack-column"),children:[(0,d.jsx)("div",{className:Td("rack-index"),children:"undefined"===e?"?":e}),m[e].map(((e,n)=>{let c,u;return!t&&"Peers"in e&&e.Peers&&(c=Object.keys(e.Peers).length,u=sd(e.Peers)),i===Xc.s$.PROBLEMS&&c!==u||i===Xc.s$.ALL||t?(l++,(0,d.jsx)(nd,{nodeId:e.NodeId,showID:a,rack:e.Rack,status:"ConnectStatus"in e?e.ConnectStatus:void 0,capacity:c,connected:u,onMouseEnter:(...e)=>{o((0,L.DK)(...e))},onMouseLeave:()=>{o((0,L.w7)())},onClick:t?void 0:()=>{r(s&&e.NodeId===s.NodeId?void 0:e)},isBlurred:!t&&s&&s.NodeId!==e.NodeId},n)):null}))]},n))):e[c].map(((e,n)=>{let c,u;const m=e&&"Peers"in e?e.Peers:void 0;return!t&&"Peers"in e&&e.Peers&&(c=e.Peers.length,u=sd(m)),i===Xc.s$.PROBLEMS&&c!==u||i===Xc.s$.ALL||t?(l++,(0,d.jsx)(nd,{nodeId:e.NodeId,showID:a,rack:e.Rack,status:"ConnectStatus"in e?e.ConnectStatus:void 0,capacity:null===m||void 0===m?void 0:m.length,connected:u,onMouseEnter:(...e)=>{o((0,L.DK)(...e))},onMouseLeave:()=>{o((0,L.w7)())},onClick:t?void 0:()=>{r(s&&e.NodeId===s.NodeId?void 0:e)},isBlurred:!t&&s&&s.NodeId!==e.NodeId},n)):null}))})]},u)}));return i===Xc.s$.PROBLEMS&&0===l?(0,d.jsx)(Kc.v,{name:"thumbsUp",width:"200"}):c}function Nd(e,t){return e.reduce(((e,a)=>(e[a[t]]?e[a[t]].push(a):e[a[t]]=[a],e)),{})}const Ed=["NodeId","Host","Connections","NetworkUtilization","SendThroughput","ReceiveThroughput","PingTime","ClockSkew"],Cd=["NodeId"],Pd=["Host","DC","Rack","Uptime","ConnectStatus","NetworkUtilization","PingTime","ClockSkew"];function Id({database:e,path:t,scrollContainerRef:a,additionalNodesProps:n}){const s=(0,D.Pm)(),r=(0,D.WF)(),[i]=(0,b.iK)(f.g5),l=r&&i;return(0,d.jsx)(o.r,{loading:!s,children:(()=>{return l?(0,d.jsx)(oe.G,{path:t,database:e,scrollContainerRef:a,withPeerRoleFilter:!0,additionalNodesProps:n,columns:(s={database:e,getNodeRef:null===n||void 0===n?void 0:n.getNodeRef},[(0,mo._E)(),(0,mo.Nh)(s,{statusForIcon:"ConnectStatus"}),(0,mo.uk)(),(0,mo.OX)(),(0,mo.jl)(),(0,mo.fr)(),(0,mo.kv)(),(0,mo.SH)(),(0,mo.H)(),(0,mo.DH)(),(0,mo.ui)(),(0,mo.wN)(),(0,mo.pt)()].map((e=>({...e,sortable:(0,po.sp)(e.name)})))),defaultColumnsIds:Ed,requiredColumnsIds:Cd,selectedColumnsKey:"networkNodesTableSelectedColumns",groupByParams:Pd}):(0,d.jsx)(Sd,{tenantName:e});var s})()})}var Dd=a(44992),_d=a(24600),Ad=a(47058),Rd=a(69775),kd=a(41775);const Od=JSON.parse('{"lagsPopover.writeLags":"Write lags statistics (time format dd hh:mm:ss)","lagsPopover.readLags":"Read lags statistics (time format dd hh:mm:ss)","headers.unread":"End offset - Last read offset","headers.uncommited":"End offset - Committed offset","controls.consumerSelector":"Consumer:","controls.consumerSelector.emptyOption":"No consumer","controls.partitionSearch":"Partition ID","controls.generalSearch":"Host, Host ID, Reader, Read Session ID","table.emptyDataMessage":"No partitions match the current search","noConsumersMessage.topic":"This topic has no consumers","noConsumersMessage.stream":"This changefeed has no consumers"}'),Md=JSON.parse('{"lagsPopover.writeLags":"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043b\u0430\u0433\u043e\u0432 \u0437\u0430\u043f\u0438\u0441\u0438 (\u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u0434 \u0447\u0447:\u043c\u043c:\u0441\u0441)","lagsPopover.readLags":"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043b\u0430\u0433\u043e\u0432 \u0447\u0442\u0435\u043d\u0438\u044f (\u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u0434 \u0447\u0447:\u043c\u043c:\u0441\u0441)","headers.unread":"End offset - Last read offset","headers.uncommited":"End offset - Committed offset","controls.consumerSelector":"\u0427\u0438\u0442\u0430\u0442\u0435\u043b\u044c:","controls.consumerSelector.emptyOption":"\u041d\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044f","controls.partitionSearch":"Partition ID","controls.generalSearch":"Host, Host ID, Reader, Read Session ID","table.emptyDataMessage":"\u041f\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u043e\u0438\u0441\u043a\u0443 \u043d\u0435\u0442 \u043f\u0430\u0440\u0442\u0438\u0446\u0438\u0439","noConsumersMessage.topic":"\u0423 \u044d\u0442\u043e\u0433\u043e \u0442\u043e\u043f\u0438\u043a\u0430 \u043d\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439","noConsumersMessage.stream":"\u0423 \u044d\u0442\u043e\u0433\u043e \u0441\u0442\u0440\u0438\u043c\u0430 \u043d\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"}'),Ld=(0,he.g4)("ydb-diagnostics-partitions",{ru:Md,en:Od}),qd={PARTITION_ID:"partitionId",STORE_SIZE:"storeSize",WRITE_SPEED:"writeSpeed",READ_SPEED:"readSpeed",WRITE_LAGS:"writeLags",READ_LAGS:"readLags",UNCOMMITED_MESSAGES:"uncommitedMessages",UNREAD_MESSAGES:"unreadMessages",START_OFFSET:"startOffset",END_OFFSET:"endOffset",COMMITED_OFFSET:"commitedOffset",READ_SESSION_ID:"readSessionId",READER_NAME:"readerName",PARTITION_HOST:"partitionHost",CONNECTION_HOST:"connectionHost"},zd={[qd.PARTITION_ID]:"Partition ID",[qd.STORE_SIZE]:"Store size",[qd.WRITE_SPEED]:"Write speed",[qd.READ_SPEED]:"Read speed",[qd.WRITE_LAGS]:"Write lags, duration",[qd.READ_LAGS]:"Read lags, duration",[qd.UNCOMMITED_MESSAGES]:"Uncommited messages",[qd.UNREAD_MESSAGES]:"Unread messages",[qd.START_OFFSET]:"Start offset",[qd.END_OFFSET]:"End offset",[qd.COMMITED_OFFSET]:"Commited offset",[qd.READ_SESSION_ID]:"Read session ID",[qd.READER_NAME]:"Reader name",[qd.PARTITION_HOST]:"Partition host",[qd.CONNECTION_HOST]:"Connection host"},Fd="partitionWriteLag",Ud="partitionWriteIdleTime",Qd={[Fd]:"write lag",[Ud]:"write idle time"},$d="consumerWriteLag",Bd="consumerReadLag",Hd="consumerReadIdleTime",Wd={[$d]:"write lag",[Bd]:"read lag",[Hd]:"read idle time"},Gd=[qd.PARTITION_ID,qd.STORE_SIZE,qd.WRITE_SPEED,qd.WRITE_LAGS,qd.START_OFFSET,qd.END_OFFSET,qd.PARTITION_HOST],Vd=Object.values(qd),Jd=({consumers:e,selectedConsumer:t,onSelectedConsumerChange:a,selectDisabled:s,partitions:r,onSearchChange:i,hiddenColumns:o,onHiddenColumnsChange:l,initialColumnsIds:c})=>{const[u,m]=n.useState(""),[p,h]=n.useState("");n.useEffect((()=>{if(!r)return;const e=new RegExp(la()(p),"i"),t=new RegExp(la()(u),"i"),a=r.filter((a=>{const{partitionId:n,readerName:s,readSessionId:r,partitionNodeId:i,connectionNodeId:o,partitionHost:l,connectionHost:c}=a,d=e.test(String(n)),u=[s,r,i,o,l,c].filter(Boolean).map(String),m=0===u.length||u.some((e=>t.test(e)));return d&&m}));i(a)}),[p,u,r,i]);const v=n.useMemo((()=>{const t=e&&e.length?e.map((e=>({value:e,content:e}))):[];return[{value:"",content:Ld("controls.consumerSelector.emptyOption")},...t]}),[e]),g=n.useMemo((()=>{const e=[];for(const t of c){const a=t===qd.PARTITION_ID,n={title:zd[t],selected:Boolean(!o.includes(t)),id:t,required:a,sticky:a?"start":void 0};a?e.unshift(n):e.push(n)}return e}),[c,o]),y=e=>(0,d.jsx)("div",{className:lu("select-option",{empty:""===e.value}),children:e.content});return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(A.l,{className:lu("consumer-select"),label:Ld("controls.consumerSelector"),options:v,value:[t||""],onUpdate:e=>{a(e[0]||void 0)},filterable:e&&e.length>5,disabled:s||!e||!e.length,renderOption:y,renderSelectedOption:y}),(0,d.jsx)(kd.v,{onChange:e=>{h(e)},placeholder:Ld("controls.partitionSearch"),className:lu("search",{partition:!0}),value:p}),(0,d.jsx)(kd.v,{onChange:e=>{m(e)},placeholder:Ld("controls.generalSearch"),className:lu("search",{general:!0}),value:u}),(0,d.jsx)(Rd.O,{popupWidth:242,items:g,showStatus:!0,onUpdate:e=>{const t=[...o];e.forEach((e=>{e.selected||o.includes(e.id)?e.selected&&o.includes(e.id)&&t.splice(o.indexOf(e.id)):t.push(e.id)})),l(t)},sortable:!1},"TableColumnSetup")]})},Kd=(0,c.cn)("ydb-multiline-table-header");function Yd({title:e}){return e?(0,d.jsx)("div",{className:Kd(),children:e}):null}const Zd=(0,c.cn)("ydb-diagnostics-partitions-columns-header"),Xd=()=>(0,d.jsx)("div",{className:Zd("read-session"),children:zd[qd.READ_SESSION_ID]}),eu=()=>(0,d.jsx)(Da,{className:Zd("lags"),text:zd[qd.WRITE_LAGS],popoverContent:(0,d.jsx)(Ba,{text:Ld("lagsPopover.writeLags"),type:"write"})}),tu=()=>(0,d.jsx)(Da,{className:Zd("lags"),text:zd[qd.READ_LAGS],popoverContent:(0,d.jsx)(Ba,{text:Ld("lagsPopover.readLags"),type:"read"})}),au=()=>(0,d.jsx)(Da,{className:Zd("messages"),text:zd[qd.UNREAD_MESSAGES],popoverContent:(0,d.jsx)("div",{className:Zd("messages-popover-content"),children:Ld("headers.unread")})}),nu=()=>(0,d.jsx)(Da,{className:Zd("messages"),text:zd[qd.UNCOMMITED_MESSAGES],popoverContent:(0,d.jsx)("div",{className:Zd("messages-popover-content"),children:Ld("headers.uncommited")})}),su=(0,c.cn)("ydb-diagnostics-partitions-columns"),ru=[{name:qd.PARTITION_ID,header:(0,d.jsx)(Yd,{title:zd[qd.PARTITION_ID]}),sortAccessor:e=>(0,Er.kf)(e.partitionId)&&Number(e.partitionId),align:Pt.Ay.LEFT,render:({row:e})=>(0,d.jsx)(ou,{id:String(e.partitionId)})},{name:qd.STORE_SIZE,header:(0,d.jsx)(Yd,{title:zd[qd.STORE_SIZE]}),sortAccessor:e=>(0,Er.kf)(e.storeSize)&&Number(e.storeSize),align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.z3)(e.storeSize)},{name:qd.WRITE_SPEED,header:zd[qd.WRITE_SPEED],align:Pt.Ay.LEFT,resizeMinWidth:140,sortAccessor:e=>e.writeSpeed.perMinute,render:({row:e})=>(0,d.jsx)(Ta,{data:e.writeSpeed})},{name:qd.READ_SPEED,header:zd[qd.READ_SPEED],align:Pt.Ay.LEFT,resizeMinWidth:140,sortAccessor:e=>{var t;return null===(t=e.readSpeed)||void 0===t?void 0:t.perMinute},render:({row:e})=>(0,d.jsx)(Ta,{data:e.readSpeed})},{name:qd.WRITE_LAGS,header:(0,d.jsx)(eu,{}),className:su("lags-header"),sub:[{name:Fd,header:Qd[Fd],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.partitionWriteLag)},{name:Ud,header:Qd[Ud],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.partitionWriteIdleTime)}]},{name:qd.READ_LAGS,header:(0,d.jsx)(tu,{}),className:su("lags-header"),sub:[{name:$d,header:Wd[$d],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.consumerWriteLag)},{name:Bd,header:Wd[Bd],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.consumerReadLag)},{name:Hd,header:Wd[Hd],align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.lr)(e.consumerReadIdleTime)}]},{name:qd.UNCOMMITED_MESSAGES,header:(0,d.jsx)(nu,{}),align:Pt.Ay.RIGHT,render:({row:e})=>e.uncommitedMessages},{name:qd.UNREAD_MESSAGES,header:(0,d.jsx)(au,{}),align:Pt.Ay.RIGHT,render:({row:e})=>e.unreadMessages},{name:qd.START_OFFSET,header:(0,d.jsx)(Yd,{title:zd[qd.START_OFFSET]}),sortAccessor:e=>(0,Er.kf)(e.startOffset)&&Number(e.startOffset),align:Pt.Ay.RIGHT,render:({row:e})=>e.startOffset},{name:qd.END_OFFSET,header:(0,d.jsx)(Yd,{title:zd[qd.END_OFFSET]}),sortAccessor:e=>(0,Er.kf)(e.endOffset)&&Number(e.endOffset),align:Pt.Ay.RIGHT,render:({row:e})=>e.endOffset},{name:qd.COMMITED_OFFSET,header:(0,d.jsx)(Yd,{title:zd[qd.COMMITED_OFFSET]}),sortAccessor:e=>(0,Er.kf)(e.commitedOffset)&&Number(e.commitedOffset),align:Pt.Ay.RIGHT,render:({row:e})=>e.commitedOffset},{name:qd.READ_SESSION_ID,header:(0,d.jsx)(Xd,{}),align:Pt.Ay.LEFT,width:150,render:({row:e})=>e.readSessionId?(0,d.jsx)(_s.c,{name:e.readSessionId,showStatus:!1,hasClipboardButton:!0}):"\u2013"},{name:qd.READER_NAME,header:(0,d.jsx)(Yd,{title:zd[qd.READER_NAME]}),align:Pt.Ay.LEFT,width:150,render:({row:e})=>e.readerName?(0,d.jsx)(_s.c,{name:e.readerName,showStatus:!1,hasClipboardButton:!0}):"\u2013"},{name:qd.PARTITION_HOST,header:(0,d.jsx)(Yd,{title:zd[qd.PARTITION_HOST]}),align:Pt.Ay.LEFT,width:200,render:({row:e})=>e.partitionNodeId&&e.partitionHost?(0,d.jsx)(_s.c,{name:e.partitionHost,path:(0,ed.vI)(e.partitionNodeId),showStatus:!1,hasClipboardButton:!0}):"\u2013"},{name:qd.CONNECTION_HOST,header:(0,d.jsx)(Yd,{title:zd[qd.CONNECTION_HOST]}),align:Pt.Ay.LEFT,width:200,render:({row:e})=>e.connectionNodeId&&e.connectionHost?(0,d.jsx)(_s.c,{name:e.connectionHost,path:(0,ed.vI)(e.connectionNodeId),showStatus:!1,hasClipboardButton:!0}):"\u2013"}],iu=ru.filter((e=>Gd.includes(e.name)));function ou({id:e}){const t=Lc(),a=(0,D._p)();return(0,d.jsx)(_s.c,{name:e,path:a?t(S.iJ.topicData,{selectedPartition:e}):void 0,showStatus:!1})}const lu=(0,c.cn)("ydb-diagnostics-partitions"),cu=({path:e,database:t})=>{const a=(0,b.YQ)(),[s,r]=n.useState([]),i=(0,b.N4)((a=>va(a,e,t))),[o]=(0,b.Nt)(),{selectedConsumer:l}=(0,b.N4)((e=>e.partitions)),{currentData:c,isFetching:u,error:m}=ua.useGetTopicQuery({path:e,database:t}),p=u&&void 0===c,{currentData:h,isFetching:v,error:g}=_d.m.useGetNodesListQuery(void 0),y=v&&void 0===h,x=(0,b.N4)(_d.K),[j,T]=(0,b.iK)(f.bs),[S,w]=(e=>{const[t,a]=n.useState([]),[s,r]=n.useState([]);return n.useEffect((()=>{e?(a(ru),r(Vd)):(a(iu),r(Gd))}),[e]),[t,s]})(l),N=p?Dd.hT:{path:e,database:t,consumerName:l},{currentData:E,isFetching:C,error:P}=Ad.aD.useGetPartitionsQuery(N,{pollingInterval:o}),I=C&&void 0===E,D=E,_=n.useMemo((()=>((e=[],t)=>null===e||void 0===e?void 0:e.map((e=>{var a,n;const s=e.partitionNodeId&&t?null===(a=t.get(e.partitionNodeId))||void 0===a?void 0:a.Host:void 0,r=e.connectionNodeId&&t?null===(n=t.get(e.connectionNodeId))||void 0===n?void 0:n.Host:void 0;return{...e,partitionHost:s,connectionHost:r}})))(D,x)),[D,x]);n.useEffect((()=>{const e=!p&&!i,t=l&&i&&!i.includes(l);(e||t)&&a((0,Ad.WD)(void 0))}),[a,p,l,i]);const A=n.useMemo((()=>S.filter((e=>!j.includes(e.name)))),[S,j]),R=e=>{T(e)},O=e=>{a((0,Ad.WD)(e))},M=p||y||I,L=g||m||P;return(0,d.jsxs)(de.L,{className:lu(),children:[(0,d.jsx)(de.L.Controls,{children:(0,d.jsx)(Jd,{consumers:i,selectedConsumer:l,onSelectedConsumerChange:O,selectDisabled:Boolean(L)||M,partitions:_,onSearchChange:r,hiddenColumns:j,onHiddenColumnsChange:R,initialColumnsIds:w})}),(0,d.jsxs)(de.L.Table,{children:[L?(0,d.jsx)(k.o,{error:L}):null,E?M?(0,d.jsx)(Ge.Q,{className:lu("loader")}):(0,d.jsx)(ce.l,{columnsWidthLSKey:"partitionsColumnsWidth",wrapperClassName:lu("table"),data:s,columns:A,settings:f.N3,emptyDataMessage:Ld("table.emptyDataMessage")}):null]})]})};var du=a(44433),uu=a(13847),mu=a(80247),pu=a(98392),hu=a(55929),vu=a(46700);const gu=JSON.parse('{"description_copy":"Copy link to clipboard","description_copied":"Copied to clipboard"}'),yu=(0,he.g4)("ydb-copy-link-button",{en:gu}),xu=(0,c.cn)("ydb-copy-link-button"),fu=e=>{const{size:t="m",hasTooltip:a=!0,status:n,closeDelay:s,title:r,...i}=e,o=null!==r&&void 0!==r?r:yu("description_copy");return(0,d.jsx)(Ae.m,{title:"success"===n?yu("description_copied"):o,disabled:!a,closeDelay:s,children:(0,d.jsx)(dn.$,{view:"flat",size:t,...i,children:(0,d.jsx)(dn.$.Icon,{className:xu("icon"),children:(0,d.jsx)(Re.I,{data:hu.A,size:16})})})})};function bu(e){const{text:t,...a}=e,s=n.useRef(),[r,i]=n.useState(void 0),[o,l]=n.useState(!1),c=1200;n.useEffect((()=>window.clearTimeout(s.current)),[]);const u=n.useCallback((()=>{l(!1),i(c),window.clearTimeout(s.current),s.current=window.setTimeout((()=>{l(!0)}),1e3)}),[c]);return(0,d.jsx)(vu.$,{text:t,timeout:c,onCopy:u,children:e=>(0,d.jsx)(fu,{...a,closeDelay:r,hasTooltip:!o,status:e})})}const ju=(0,c.cn)("ydb-drawer"),Tu=({isVisible:e,onClose:t,children:a,drawerId:s="drawer",storageKey:r="drawer-width",defaultWidth:i,direction:o="right",className:l,detectClickOutside:c=!1,isPercentageWidth:u})=>{const[m,p]=n.useState((()=>{const e=localStorage.getItem(r);return(0,Er.kf)(e)?Number(e):i})),h=n.useRef(null),{containerWidth:v,itemContainerRef:g}=(()=>{const e=n.useContext(P);if(void 0===e)throw Error("useDrawerContext must be used within a DrawerContextProvider");return e})(),y=n.useMemo((()=>u&&v>0?Math.round(v*(m||60)/100):m||600),[v,u,m]);n.useEffect((()=>{if(!c)return;const a=a=>{!a._capturedInsideDrawer&&a.isTrusted&&e&&h.current&&!h.current.contains(a.target)&&t()};return document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}}),[e,t,c]);const x=null===g||void 0===g?void 0:g.current;return x?(0,d.jsx)(pu.Z,{container:x,children:(0,d.jsx)(mu._,{onEscape:t,onVeilClick:t,hideVeil:!0,className:ju("container",l),children:(0,d.jsx)(mu.l,{id:s,visible:e,resizable:!0,maxResizeWidth:v,width:u?y:m,onResize:e=>{if(u&&v>0){const t=Math.round(e/v*100);p(t),localStorage.setItem(r,t.toString())}else p(e),localStorage.setItem(r,e.toString())},direction:o,className:ju("item"),ref:c?h:void 0,children:(0,d.jsx)("div",{className:ju("click-handler"),onClickCapture:e=>{e.nativeEvent._capturedInsideDrawer=!0},children:a})})})}):null},Su=({children:e,renderDrawerContent:t,isDrawerVisible:a,onCloseDrawer:s,drawerId:r,storageKey:i,defaultWidth:o,direction:l,className:c,detectClickOutside:u,isPercentageWidth:m,drawerControls:p=[],title:h,headerClassName:v})=>{n.useEffect((()=>()=>{s()}),[s]);return(0,d.jsxs)(n.Fragment,{children:[e,(0,d.jsx)(Tu,{isVisible:a,onClose:s,drawerId:r,storageKey:i,defaultWidth:o,direction:l,className:c,detectClickOutside:u,isPercentageWidth:m,children:a?(0,d.jsxs)("div",{className:ju("content-wrapper"),children:[(()=>{const e=[];for(const t of p)switch(t.type){case"close":e.push((0,d.jsx)(Ae.m,{title:"Close",children:(0,d.jsx)(dn.$,{view:"flat",onClick:s,children:(0,d.jsx)(Re.I,{data:qc.A,size:16})})},"close"));break;case"copyLink":e.push((0,d.jsx)(bu,{text:t.link},"copyLink"));break;case"custom":e.push((0,d.jsx)(n.Fragment,{children:t.node},t.key))}return(0,d.jsxs)(_e.s,{justifyContent:"space-between",alignItems:"center",className:ju("header-wrapper",v),children:[(0,d.jsx)(De.E,{variant:"subheader-2",children:h}),(0,d.jsx)(_e.s,{className:ju("controls"),children:e})]})})(),t()]}):null})]})};var wu=a(43951);const Nu={...Xo,disableSortReset:!0,externalSort:!0};function Eu(e){const t=[];var a,n;(e.QueryText&&t.push({label:tl("query-hash"),value:Zo(String(e.QueryText))}),void 0!==e.CPUTimeUs)&&t.push({label:tl("cpu-time"),value:(0,ze.Xo)((0,ze.Jc)(null!==(a=e.CPUTimeUs)&&void 0!==a?a:void 0))});void 0!==e.Duration&&t.push({label:tl("duration"),value:(0,ze.Xo)((0,ze.Jc)(null!==(n=e.Duration)&&void 0!==n?n:void 0))});return void 0!==e.ReadBytes&&t.push({label:tl("read-bytes"),value:(0,q.ZV)(e.ReadBytes)}),void 0!==e.RequestUnits&&t.push({label:tl("request-units"),value:(0,q.ZV)(e.RequestUnits)}),e.EndTime&&t.push({label:tl("end-time"),value:(0,q.r6)(new Date(e.EndTime).getTime())}),void 0!==e.ReadRows&&t.push({label:tl("read-rows"),value:(0,q.ZV)(e.ReadRows)}),e.UserSID&&t.push({label:tl("user"),value:e.UserSID}),e.ApplicationName&&t.push({label:tl("application"),value:e.ApplicationName}),e.QueryStartAt&&t.push({label:tl("start-time"),value:(0,q.r6)(new Date(e.QueryStartAt).getTime())}),t}const Cu=JSON.parse('{"no-data":"No data","filter.text.placeholder":"Search by query text or userSID...","mode_top":"Top","mode_running":"Running","timeframe_hour":"Per hour","timeframe_minute":"Per minute","query-details.title":"Query","query-details.open-in-editor":"Open in Editor","query-details.close":"Close","query-details.query.title":"Query Text","query-details.not-found.title":"Not found","query-details.not-found.description":"This query no longer exists"}'),Pu=(0,he.g4)("ydb-diagnostics-top-queries",{en:Cu});var Iu;function Du(){return Du=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Du.apply(null,arguments)}const _u=function(e){return n.createElement("svg",Du({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},e),Iu||(Iu=n.createElement("g",{fill:"none",fillRule:"evenodd"},n.createElement("g",{fill:"currentColor",fillRule:"nonzero"},n.createElement("path",{d:"M72.844 36.587a1 1 0 011.414.017c2.607 2.67 4.53 5.866 5.672 9.573C84.845 62.124 74.557 73 50 73S15.155 62.124 20.07 46.177c1.122-3.641 2.998-6.79 5.535-9.432a1 1 0 011.442 1.386c-2.323 2.418-4.036 5.296-5.066 8.635C17.502 61.297 26.681 71 50 71s32.498-9.703 28.019-24.234c-1.048-3.4-2.805-6.32-5.192-8.765a1 1 0 01.017-1.414z"}),n.createElement("path",{d:"M84.876 52.008a1 1 0 01.363 1.963l-.115.021-8 1a1 1 0 01-.363-1.963l.115-.021 8-1zm-8.838 5.717a1 1 0 011.123-.712l.114.025 7 2a1 1 0 01-.436 1.95l-.114-.026-7-2a1 1 0 01-.687-1.237zM15.128 52.008a1 1 0 00-.37 1.962l.114.022 7.733 1a1 1 0 00.371-1.962l-.115-.022-7.733-1zM23.425 57.715a1 1 0 00-1.13-.7l-.114.026-6.732 2a1 1 0 00.455 1.944l.114-.026 6.733-2a1 1 0 00.674-1.244zM69.857 19.01a1 1 0 01.951.401c3.511 4.821 4.55 11.746 3.18 20.74a1 1 0 11-1.977-.302c1.241-8.148.416-14.366-2.42-18.683l-.051-.075-.093.018c-4.025.803-7.448 3.451-10.29 8.011l-.243.396a1 1 0 01-1.074.46C54.91 29.324 52.296 29 50 29c-2.296 0-4.91.324-7.84.976a1 1 0 01-1.074-.46c-2.807-4.666-6.193-7.42-10.18-8.331l-.447-.094-.05.075c-2.771 4.219-3.623 10.253-2.502 18.13l.082.553a1 1 0 11-1.978.302c-1.37-8.994-.33-15.919 3.18-20.74a1 1 0 01.952-.4c4.84.7 8.902 3.617 12.161 8.678l.117.184.6-.12c2.338-.46 4.488-.71 6.449-.748L50 27c2.102 0 4.428.251 6.98.753l.598.12.118-.184c3.176-4.931 7.114-7.827 11.79-8.62l.37-.059z"})),n.createElement("path",{fill:"currentColor",fillRule:"nonzero",d:"M36.744 52.332l.185.21a30.417 30.417 0 011.891 2.432c.47.674.88 1.33 1.216 1.96.617 1.158.964 2.185.964 3.09C41 62.774 38.76 65 36 65s-5-2.226-5-4.976c0-.905.347-1.932.964-3.09.336-.63.746-1.286 1.216-1.959a30.417 30.417 0 012.076-2.643 1 1 0 011.488 0zM36 54.552c-.404.5-.804 1.028-1.18 1.567a17.597 17.597 0 00-1.09 1.756c-.478.894-.73 1.641-.73 2.15C33 61.665 34.342 63 36 63s3-1.334 3-2.976c0-.508-.252-1.255-.73-2.15a17.597 17.597 0 00-1.09-1.755A28.101 28.101 0 0036 54.552zm10.769 10.087a1 1 0 11-1.538-1.278C46.473 61.868 48.172 61 50 61c1.828 0 3.527.868 4.769 2.36a1 1 0 11-1.538 1.28C52.355 63.585 51.208 63 50 63c-1.208 0-2.355.586-3.231 1.64zm-15.114-14a1 1 0 01.69-1.878c.724.266 1.587.413 2.495.413 1.456 0 2.775-.38 3.557-.972a1 1 0 111.206 1.596c-1.156.874-2.897 1.376-4.763 1.376-1.14 0-2.235-.186-3.185-.536zm28.742-.841a1 1 0 111.206-1.596c.782.592 2.101.972 3.558.972.908 0 1.77-.147 2.494-.413a1 1 0 11.69 1.877c-.95.35-2.045.536-3.184.536-1.867 0-3.608-.502-4.764-1.376z"}))))},Au=(0,c.cn)("kv-top-queries"),Ru=({onClose:e})=>(0,d.jsxs)(_e.s,{justifyContent:"center",alignItems:"center",direction:"column",className:Au("not-found-container"),children:[(0,d.jsx)(Re.I,{data:_u,size:100}),(0,d.jsx)(De.E,{variant:"subheader-2",className:Au("not-found-title"),children:Pu("query-details.not-found.title")}),(0,d.jsx)(De.E,{variant:"body-1",color:"complementary",className:Au("not-found-description"),children:Pu("query-details.not-found.description")}),(0,d.jsx)(dn.$,{size:"m",view:"normal",className:Au("not-found-close"),onClick:e,children:Pu("query-details.close")})]});var ku=a(968);const Ou=(0,c.cn)("ydb-query-details"),Mu=({queryText:e,infoItems:t,onOpenInEditor:a})=>(0,d.jsx)(_e.s,{direction:"column",className:Ou(),children:(0,d.jsxs)(_e.s,{direction:"column",className:Ou("content"),children:[(0,d.jsx)(us.z_,{info:t}),(0,d.jsxs)("div",{className:Ou("query-content"),children:[(0,d.jsxs)("div",{className:Ou("query-header"),children:[(0,d.jsx)("div",{className:Ou("query-title"),children:Pu("query-details.query.title")}),(0,d.jsxs)(dn.$,{view:"flat-secondary",size:"m",onClick:a,className:Ou("editor-button"),children:[(0,d.jsx)(Re.I,{data:ku.A,size:16}),Pu("query-details.open-in-editor")]})]}),(0,d.jsx)(Ws.YDBSyntaxHighlighter,{language:"yql",text:e,withClipboardButton:{alwaysVisible:!0,withLabel:!1}})]})]})}),Lu=({row:e,onClose:t})=>{const a=(0,b.YQ)(),s=(0,zs.zy)(),r=(0,zs.W6)(),i=n.useCallback((()=>{if(e){const t=e.QueryText;a((0,So.iZ)({input:t})),a((0,So.Xb)(!1));const n=(0,U.mA)(s),i=(0,Pa.YL)({...n,[S.Dt]:S.Dg.query,[Pa.vh.queryTab]:S.tQ.newQuery});r.push(i)}}),[a,r,s,e]);return e?(0,d.jsx)(Mu,{queryText:e.QueryText,infoItems:Eu(e),onOpenInEditor:i}):(0,d.jsx)(Ru,{onClose:t})},qu={encode:e=>{if(void 0!==e&&null!==e&&Array.isArray(e))return encodeURIComponent(JSON.stringify(e))},decode:e=>{if("string"!==typeof e||!e)return[];try{return JSON.parse(decodeURIComponent(e))}catch{return[]}}};function zu(e){const{paramName:t,schema:a,defaultSort:s}=e,[i,o]=(0,r.useQueryParam)(t,qu);return{sortParam:n.useMemo((()=>{if(!i||!Array.isArray(i)||0===i.length)return[s];const e=i.filter((e=>{try{return a.parse(e.columnId),!0}catch{return!1}}));return e.length?e:[s]}),[i,a,s]),updateSortParam:n.useCallback((e=>{o(e||[],"replaceIn")}),[o])}}const Fu=Qe.z.enum([ml,ll,pl]).catch(ml),Uu={columnId:ml,order:Pt.Ay.DESCENDING};const Qu=(0,c.cn)("kv-top-queries"),$u=({tenantName:e,renderQueryModeControl:t,handleTextSearchUpdate:a})=>{var s,r;const[i]=(0,b.Nt)(),o=(0,b.N4)((e=>e.executeTopQueries)),[l,c]=n.useState(void 0),u=n.useMemo((()=>[Al,Dl,kl,El,Ml].map((e=>{return{...e,sortable:(t=e.name,Boolean(Sl(t)))};var t}))),[]),{columnsToShow:m,columnsToSelect:p,setColumns:h}=(0,wu.K)(u,"runningQueriesSelectedColumns",fl,yl,xl),{tableSort:v,handleTableSort:g,backendSort:y}=function(){var e,t;const{sortParam:a,updateSortParam:s}=zu({paramName:"runningSort",schema:Fu,defaultSort:Uu}),[r,i]=(0,b.GY)({initialSortColumn:(null===a||void 0===a||null===(e=a[0])||void 0===e?void 0:e.columnId)||Uu.columnId,initialSortOrder:(null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.order)||Uu.order,multiple:!0,onSort:s});return{tableSort:r,handleTableSort:i,backendSort:n.useMemo((()=>(0,b.JN)(r,Sl)),[r])}}(),{currentData:x,isFetching:f,isLoading:j,error:T}=To.Ke.useGetRunningQueriesQuery({database:e,filters:o,sortOrder:y},{pollingInterval:i}),S=null===x||void 0===x||null===(s=x.resultSets)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.result,w=void 0!==l,N=n.useCallback((()=>{c(void 0)}),[c]),E=n.useCallback((()=>(0,d.jsx)(Lu,{row:l,onClose:N})),[l,N]),C=n.useCallback(((e,t,a)=>{null===a||void 0===a||a.stopPropagation(),c(e)}),[c]),P=n.useRef(null);n.useEffect((()=>{var e;w&&(null===(e=P.current)||void 0===e||e.blur())}),[w]);const I=n.useMemo((()=>[{type:"close"}]),[]);return(0,d.jsx)(Su,{isDrawerVisible:w,onCloseDrawer:N,renderDrawerContent:E,drawerId:"running-query-details",storageKey:"running-queries-drawer-width",detectClickOutside:!0,isPercentageWidth:!0,title:Pu("query-details.title"),drawerControls:I,children:(0,d.jsxs)(de.L,{children:[(0,d.jsxs)(de.L.Controls,{children:[t(),(0,d.jsx)(pe.v,{value:o.text,onChange:a,placeholder:Pu("filter.text.placeholder"),className:Qu("search"),inputRef:P}),(0,d.jsx)(Rd.O,{popupWidth:200,items:p,showStatus:!0,onUpdate:h,sortable:!1})]}),T?(0,d.jsx)(k.o,{error:(0,Ve.Cb)(T)}):null,(0,d.jsx)(de.L.Table,{loading:j,children:(0,d.jsx)(ce.l,{emptyDataMessage:Pu("no-data"),columnsWidthLSKey:"runningQueriesColumnsWidth",columns:m,data:S||[],loading:f&&void 0===x,settings:Nu,onRowClick:C,rowClassName:e=>Qu("row",{active:(0,uu.isEqual)(e,l)}),sortOrder:v,onSort:g})})]})})};var Bu=a(33167);const Hu=JSON.parse('{"date-format":"MM/DD/YYYY","date-time-format":"MM/DD/YYYY HH:mm"}'),Wu=JSON.parse('{"date-format":"DD.MM.YYYY","date-time-format":"DD.MM.YYYY HH:mm"}'),Gu=(0,he.g4)("ydb-date-range",{ru:Wu,en:Hu});function Vu(e){var t,a,n,s;return"relative"===(null===e||void 0===e||null===(t=e.start)||void 0===t?void 0:t.type)&&"relative"===(null===e||void 0===e||null===(a=e.end)||void 0===a?void 0:a.type)?"s":"relative"===(null===e||void 0===e||null===(n=e.start)||void 0===n?void 0:n.type)||"relative"===(null===e||void 0===e||null===(s=e.end)||void 0===s?void 0:s.type)?"m":"l"}const Ju=(0,c.cn)("date-range"),Ku=({from:e,to:t,className:a,defaultValue:s,onChange:r})=>{const i=n.useCallback((e=>null===r||void 0===r?void 0:r(function(e){var t,a,n,s,r,i;return{from:"relative"===(null===e||void 0===e||null===(t=e.start)||void 0===t?void 0:t.type)?e.start.value.toString():String(null===(a=(0,Ce.bQ)(null===e||void 0===e||null===(n=e.start)||void 0===n?void 0:n.value))||void 0===a?void 0:a.valueOf()),to:"relative"===(null===e||void 0===e||null===(s=e.end)||void 0===s?void 0:s.type)?e.end.value.toString():String(null===(r=(0,Ce.bQ)(null===e||void 0===e||null===(i=e.end)||void 0===i?void 0:i.value))||void 0===r?void 0:r.valueOf())}}(e))),[r]),o=n.useMemo((()=>{if(e||t)return function(e){var t,a;const n=(0,Ce.eP)(null!==(t=e.from)&&void 0!==t?t:""),s=(0,Ce.eP)(null!==(a=e.to)&&void 0!==a?a:"");return{start:e.from?{type:n?"relative":"absolute",value:n?e.from:(0,Ce.bQ)(Number(e.from))}:null,end:e.to?{type:s?"relative":"absolute",value:s?e.to:(0,Ce.bQ)(Number(e.to))}:null}}({from:e,to:t})}),[e,t]),l=Intl.DateTimeFormat().resolvedOptions().timeZone,c=o||s;return(0,d.jsx)("div",{className:Ju(null,a),children:(0,d.jsx)(Bu.k,{withPresets:!0,className:Ju("range-input",{[Vu(c)]:!0}),timeZone:l,value:c,allowNullableValues:!0,size:"m",format:Gu("date-time-format"),onUpdate:i,placeholder:`${Gu("date-time-format")} - ${Gu("date-time-format")}`,withApplyButton:!0})})},Yu={hour:"hour",minute:"minute"},Zu=[{value:Yu.hour,content:Pu("timeframe_hour")},{value:Yu.minute,content:Pu("timeframe_minute")}],Xu={start:{value:"now-6h",type:"relative"},end:{value:"now",type:"relative"}};function em(e){const t=Zo(String(e.QueryText));return{rank:String(e.Rank),intervalEnd:String(e.IntervalEnd),endTime:String(e.EndTime),queryHash:t}}const tm=Qe.z.enum([nl,ul,il,ol,sl]).catch(nl),am={columnId:nl,order:Pt.Ay.DESCENDING};const nm=(0,c.cn)("kv-top-queries"),sm=({tenantName:e,timeFrame:t,renderQueryModeControl:a,handleTimeFrameChange:s,handleDateRangeChange:i,handleTextSearchUpdate:o})=>{var l,c;const[u]=(0,b.Nt)(),m=(0,b.N4)((e=>e.executeTopQueries)),[p,h]=n.useState(void 0),v=n.useMemo((()=>[Al,Nl,Rl,Il,Ol,El,Cl,Pl,Dl].map((e=>{return{...e,sortable:(t=e.name,Boolean(Tl(t))),defaultOrder:Pt.Ay.DESCENDING};var t}))),[]),{columnsToShow:g,columnsToSelect:y,setColumns:x}=(0,wu.K)(v,"topQueriesSelectedColumns",fl,vl,gl),{tableSort:f,handleTableSort:j,backendSort:T}=function(){var e,t;const{sortParam:a,updateSortParam:s}=zu({paramName:"topSort",schema:tm,defaultSort:am}),[r,i]=(0,b.GY)({initialSortColumn:(null===a||void 0===a||null===(e=a[0])||void 0===e?void 0:e.columnId)||am.columnId,initialSortOrder:(null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.order)||am.order,multiple:!0,fixedOrderType:Pt.Ay.DESCENDING,onSort:s});return{tableSort:r,handleTableSort:i,backendSort:n.useMemo((()=>(0,b.JN)(r,Tl)),[r])}}(),{currentData:S,isFetching:w,isLoading:N,error:E}=To.Ke.useGetTopQueriesQuery({database:e,filters:m,sortOrder:T,timeFrame:t},{pollingInterval:u}),C=null===S||void 0===S||null===(l=S.resultSets)||void 0===l||null===(c=l[0])||void 0===c?void 0:c.result;!function(e,t){const[a,s]=(0,r.useQueryParams)({selectedRow:r.StringParam});n.useEffect((()=>{if(t&&a.selectedRow){const n=JSON.parse(decodeURIComponent(a.selectedRow)),r=t.find((e=>{const t=em(e);return t.rank===n.rank&&t.intervalEnd===n.intervalEnd&&t.endTime===n.endTime&&n.queryHash===t.queryHash}));e(r||null),s({selectedRow:void 0})}}),[a.selectedRow,s,t,e])}(h,C);const P=n.useCallback((()=>{h(void 0)}),[h]),I=void 0!==p,D=n.useCallback((()=>p?function(e){const t=em(e),a=new URL(window.location.href),n=new URLSearchParams(a.search);return n.set("selectedRow",encodeURIComponent(JSON.stringify({rank:t.rank||void 0,intervalEnd:t.intervalEnd||void 0,endTime:t.endTime||void 0,queryHash:t.queryHash||void 0}))),a.search=n.toString(),a.toString()}(p):""),[p]),_=n.useCallback((()=>(0,d.jsx)(Lu,{row:p,onClose:P})),[p,P]),R=n.useCallback(((e,t,a)=>{null===a||void 0===a||a.stopPropagation(),h(e)}),[h]),O=n.useRef(null);n.useEffect((()=>{var e;I&&(null===(e=O.current)||void 0===e||e.blur())}),[I]);const M=n.useMemo((()=>[{type:"copyLink",link:D()},{type:"close"}]),[D]);return(0,d.jsx)(Su,{isDrawerVisible:I,onCloseDrawer:P,renderDrawerContent:_,drawerId:"query-details",storageKey:"kv-top-queries-drawer-width",detectClickOutside:!0,isPercentageWidth:!0,title:Pu("query-details.title"),drawerControls:M,children:(0,d.jsxs)(de.L,{children:[(0,d.jsxs)(de.L.Controls,{children:[a(),(0,d.jsx)(A.l,{options:Zu,value:[t],onUpdate:s}),(0,d.jsx)(Ku,{from:m.from,to:m.to,onChange:i,defaultValue:Xu}),(0,d.jsx)(pe.v,{value:m.text,inputRef:O,onChange:o,placeholder:Pu("filter.text.placeholder"),className:nm("search")}),(0,d.jsx)(Rd.O,{popupWidth:200,items:y,showStatus:!0,onUpdate:x,sortable:!1})]}),E?(0,d.jsx)(k.o,{error:(0,Ve.Cb)(E)}):null,(0,d.jsx)(de.L.Table,{loading:N,children:(0,d.jsx)(ce.l,{emptyDataMessage:Pu("no-data"),columnsWidthLSKey:al,columns:g,data:C||[],loading:w&&void 0===S,settings:Nu,onRowClick:R,rowClassName:e=>nm("row",{active:(0,uu.isEqual)(e,p)}),sortOrder:f,onSort:j})})]})})},rm={top:"top",running:"running"},im=[{value:rm.top,get content(){return Pu("mode_top")}},{value:rm.running,get content(){return Pu("mode_running")}}],om=Qe.z.nativeEnum(rm).catch(rm.top),lm=Qe.z.nativeEnum(Yu).catch(Yu.hour),cm=({tenantName:e})=>{const t=(0,b.YQ)(),[a=rm.top,s]=(0,r.useQueryParam)("queryMode",r.StringParam),[i=Yu.hour,o]=(0,r.useQueryParam)("timeFrame",r.StringParam),l=om.parse(a),c=lm.parse(i),u=l===rm.top,m=e=>{t((0,To.TX)({text:e}))},p=n.useCallback((()=>(0,d.jsx)(du.a,{options:im,value:l,onUpdate:s})),[l,s]);return u?(0,d.jsx)(sm,{tenantName:e,timeFrame:c,renderQueryModeControl:p,handleTimeFrameChange:e=>{o(e[0],"replaceIn")},handleDateRangeChange:e=>{t((0,To.TX)(e))},handleTextSearchUpdate:m}):(0,d.jsx)($u,{tenantName:e,renderQueryModeControl:p,handleTextSearchUpdate:m})};var dm=a(46496),um=a(87747);const mm=JSON.parse('{"no-data":"No data","filters.mode.immediate":"Immediate","filters.mode.history":"Historical","description":"Historical data only tracks shards with CPU load over 70%"}'),pm=JSON.parse('{"no-data":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445","filters.mode.immediate":"\u041c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u044b\u0435","filters.mode.history":"\u0418\u0441\u0442\u043e\u0440\u0438\u0447\u0435\u0441\u043a\u0438\u0435","description":"\u0418\u0441\u0442\u043e\u0440\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043e \u0448\u0430\u0440\u0434\u0430\u0445 \u0441 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439 CPU \u0432\u044b\u0448\u0435 70%"}'),hm=(0,he.g4)("ydb-diagnostics-top-shards",{ru:pm,en:mm}),vm={start:{value:"now-1h",type:"relative"},end:{value:"now",type:"relative"}},gm=({value:e,onChange:t})=>{const a=e.mode===um.h.Immediate?void 0:e.from,s=e.mode===um.h.Immediate?void 0:e.to;return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)(du.a,{value:e.mode,onUpdate:e=>{if(!((e,t)=>Object.values(e).includes(t))(um.h,e)){const t=Object.values(um.h).join(", ");throw new Error(`Unexpected TopShards mode "${e}". Should be one of: ${t}`)}t({mode:e})},children:[(0,d.jsx)(du.a.Option,{value:um.h.Immediate,children:hm("filters.mode.immediate")}),(0,d.jsx)(du.a.Option,{value:um.h.History,children:hm("filters.mode.history")})]}),(0,d.jsx)(Ku,{from:a,to:s,onChange:e=>{t({mode:um.h.History,...e})},defaultValue:vm})]})};var ym=a(49228);const xm=(0,c.cn)("top-shards"),fm={...f.N3,dynamicRender:!1,externalSort:!0,disableSortReset:!0,defaultOrder:-1};function bm(e){return e.to="now",e.from="now-1h",e}const jm=({tenantName:e,path:t})=>{var a,s;const r=(0,ql.x)("ShardsTable"),i=(0,b.YQ)(),[o]=(0,b.Nt)(),l=(0,b.N4)((e=>e.shardsWorkload)),[c,u]=n.useState((()=>{const e={...l};return e.mode||(e.mode=um.h.Immediate),e.from||e.to||bm(e),e})),{tableSort:m,handleTableSort:p,backendSort:h}=function(){const[e,t]=(0,b.GY)({initialSortColumn:ym.Fk.CPUCores,fixedOrderType:-1,multiple:!0}),a=n.useMemo((()=>(0,b.JN)(e,ym.LK)),[e]);return{tableSort:e,handleTableSort:t,backendSort:a}}(),{currentData:v,isFetching:g,error:y}=dm.Xx.useSendShardQueryQuery({database:e,path:t,sortOrder:h,filters:c},{pollingInterval:o}),x=g&&void 0===v,f=(null===v||void 0===v||null===(a=v.resultSets)||void 0===a||null===(s=a[0])||void 0===s?void 0:s.result)||[],j=e=>{const t={...e};if(!l.from&&!l.to&&!e.from&&!e.to)switch(e.mode){case um.h.Immediate:t.from=t.to=void 0;break;case um.h.History:bm(t)}i((0,dm.rF)(e)),u((e=>({...e,...t})))},T=n.useMemo((()=>{let e;return e=c.mode===um.h.History?["Path","CPUCores","DataSize","TabletId","NodeId","PeakTime","InFlightTxCount","IntervalEnd"]:["Path","CPUCores","DataSize","TabletId","NodeId","InFlightTxCount"],e}),[c.mode]);return(0,d.jsxs)(de.L,{children:[(0,d.jsx)(de.L.Controls,{children:(0,d.jsx)(gm,{value:c,onChange:j})}),c.mode===um.h.History&&(0,d.jsx)("div",{className:xm("hint"),children:hm("description")}),y?(0,d.jsx)(k.o,{error:(0,Ve.Cb)(y)}):null,(0,d.jsx)(de.L.Table,{loading:x,children:y&&!f?null:(0,d.jsx)(r,{database:e,schemaPath:t,columnsIds:T,data:f,settings:fm,onSort:p,sortOrder:m})})]})};var Tm=a(41012),Sm=a(31819),wm=a(72976);const Nm=function({disabled:e,view:t="flat-secondary"}){const a=(0,b.YQ)();return(0,d.jsx)(dn.$,{onClick:()=>{a((0,wm.Jf)())},view:t,disabled:e,title:"Fullscreen",children:(0,d.jsx)(Re.I,{data:Sm.A})})};var Em;function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Cm.apply(null,arguments)}const Pm=function(e){return n.createElement("svg",Cm({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},e),Em||(Em=n.createElement("path",{fill:"currentColor",d:"M13.383 6.5a.309.309 0 00.305-.305V5.18a.328.328 0 00-.305-.305H11.25V2.742a.328.328 0 00-.305-.304H9.93a.309.309 0 00-.305.304v3.149c0 .355.254.609.61.609h3.148zm-7.008-.61V2.743a.328.328 0 00-.305-.304H5.055a.309.309 0 00-.305.304v2.133H2.617a.309.309 0 00-.304.305v1.015c0 .178.126.305.304.305h3.149c.33 0 .609-.254.609-.61zm0 7.618v-3.149c0-.33-.28-.609-.61-.609H2.618a.309.309 0 00-.304.305v1.015c0 .178.126.305.304.305H4.75v2.133c0 .178.127.305.305.305H6.07a.309.309 0 00.305-.305zm4.875 0v-2.133h2.133a.309.309 0 00.305-.305v-1.015a.328.328 0 00-.305-.305h-3.149c-.355 0-.609.28-.609.61v3.148c0 .178.127.305.305.305h1.015a.309.309 0 00.305-.305z"})))};var Im;const Dm=(0,c.cn)("ydb-fullscreen"),_m=null!==(Im=document.getElementById("fullscreen-root"))&&void 0!==Im?Im:void 0;const Am=function({children:e,className:t}){const a=(0,b.N4)((e=>e.fullscreen)),s=(0,b.YQ)(),r=n.useCallback((()=>{s((0,wm.sM)())}),[s]);n.useEffect((()=>{const e=e=>{"Escape"===e.key&&r()};return document.addEventListener("keydown",e,!1),()=>{document.removeEventListener("keydown",e,!1)}}),[r]);const[i,o]=n.useState(null);n.useEffect((()=>{const e=document.createElement("div");return null===_m||void 0===_m||_m.appendChild(e),e.style.display="contents",o(e),()=>{o(null),e.remove()}}),[]);const l=n.useRef(null);return n.useLayoutEffect((()=>{var e;i&&(a?null===_m||void 0===_m||_m.appendChild(i):null===(e=l.current)||void 0===e||e.appendChild(i))}),[i,a]),i?(0,d.jsx)("div",{ref:l,style:{display:"contents"},children:(0,d.jsx)(pu.Z,{container:i,children:(0,d.jsxs)("div",{className:Dm({fullscreen:a},t),children:[(0,d.jsx)(dn.$,{onClick:r,view:"raised",className:Dm("close-button"),children:(0,d.jsx)(Re.I,{data:Pm})}),(0,d.jsx)("div",{className:Dm("content"),children:e})]})})}):null};var Rm=a(62783),km=a(42265),Om=a(81101),Mm=a(10731),Lm=a(97218),qm=a(80563),zm=a(98934),Fm=a(10662),Um=a(65809);const Qm=JSON.parse('{"label_offset":"Offset","label_partition":"Partition ID","label_timestamp-create":"Timestamp Create","label_timestamp-write":"Timestamp Write","label_ts_diff":"Write Lag","label_key":"Key","label_metadata":"Metadata","label_message":"Message","label_size":"Size","label_original-size":"Original Size","label_codec":"Codec","label_producerid":"ProducerID","label_seqno":"SeqNo","label_partition-id":"Partition ID: ","context_ts-diff":"Timestamp Write - Timestamp Create, ms","label_full-value":"Full value","label_from":"From: ","label_nothing-found":"Nothing found","description_nothing-found":"Make the filter less strict or start over","action_show-all":"Reset filter","label_by-offset":"By offset","label_by-timestamp":"By timestamp","action_scroll-down":"Scroll to the end","action_scroll-selected":"Scroll to selected offset","action_scroll-up":"Scroll to the start","description_failed-decode":"Failed to decode message","description_truncated":"[truncated]","context_message-not-found":"Message with offset {{offset}} not found","context_get-data-error":"Failed to get message","label_download":"Save message to file","label_truncated":"Truncated {{size}}","description_not-loaded-message":"Message was not fetched in table due to problems with big messages.\\nYou can view it in side panel by clicking on Offset","description_removed-message":"Message was deleted due to retention","description_last-messages":"Only last 50 000 messages from any partition are displayed"}'),$m=(0,he.g4)("ydb-diagnostics-topic-data",{en:Qm}),Bm="partition",Hm="offset",Wm="timestampCreate",Gm="timestampWrite",Vm="tsDiff",Jm="metadata",Km="message",Ym="size",Zm="originalSize",Xm="codec",ep="producerID",tp="seqNo",ap={get TIMESTAMP(){return $m("label_by-timestamp")},get OFFSET(){return $m("label_by-offset")}},np=(0,r.createEnumParam)(["TIMESTAMP","OFFSET"]),sp=(0,r.withDefault)(np,"TIMESTAMP");function rp(){const[{selectedPartition:e,selectedOffset:t,startTimestamp:a,topicDataFilter:s,activeOffset:i},o]=(0,r.useQueryParams)({selectedPartition:r.StringParam,selectedOffset:r.StringParam,startTimestamp:r.NumberParam,topicDataFilter:sp,activeOffset:r.StringParam}),l=n.useCallback((e=>{o({selectedPartition:e},"replaceIn")}),[o]),c=n.useCallback((e=>{o({selectedOffset:e},"replaceIn")}),[o]),d=n.useCallback((e=>{o({activeOffset:e},"replaceIn")}),[o]);return{selectedPartition:e,selectedOffset:t,startTimestamp:a,topicDataFilter:s,activeOffset:i,handleSelectedPartitionChange:l,handleSelectedOffsetChange:c,handleStartTimestampChange:n.useCallback((e=>{o({startTimestamp:e},"replaceIn")}),[o]),handleTopicDataFilterChange:n.useCallback((e=>{o({topicDataFilter:e},"replaceIn")}),[o]),handleActiveOffsetChange:d}}const ip=(0,c.cn)("ydb-diagnostics-topic-data"),op={get offset(){return $m("label_offset")},get partition(){return $m("label_partition")},get timestampCreate(){return $m("label_timestamp-create")},get timestampWrite(){return $m("label_timestamp-write")},get tsDiff(){return $m("label_ts_diff")},get key(){return $m("label_key")},get metadata(){return $m("label_metadata")},get message(){return $m("label_message")},get size(){return $m("label_size")},get originalSize(){return $m("label_original-size")},get codec(){return $m("label_codec")},get producerID(){return $m("label_producerid")},get seqNo(){return $m("label_seqno")}},lp={0:"RAW",1:"GZIP",2:"LZOP",3:"ZSTD"};function cp({columnsToSelect:e,handleSelectedColumnsUpdate:t,startOffset:a,endOffset:s,partitions:r,partitionsLoading:i,partitionsError:o,scrollToOffset:l,truncatedData:c}){const{selectedPartition:u,handleSelectedPartitionChange:m,handleSelectedOffsetChange:p,handleStartTimestampChange:h}=rp(),v=null===r||void 0===r?void 0:r.map((({partitionId:e})=>({content:String(e),value:String(e)}))),g=n.useCallback((e=>{m(e[0]),p(void 0),h(void 0)}),[m,h,p]);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(A.l,{className:ip("partition-select"),label:$m("label_partition-id"),options:v,value:u?[u]:void 0,onUpdate:g,filterable:r&&r.length>5,disabled:!r||!r.length,errorPlacement:"inside",errorMessage:(0,Um.$)(o),error:Boolean(o),loading:i}),(0,d.jsx)(dp,{scrollToOffset:l}),!(0,uu.isNil)(a)&&!(0,uu.isNil)(s)&&(0,d.jsxs)(_e.s,{gap:1,children:[(0,d.jsxs)(De.E,{color:"secondary",whiteSpace:"nowrap",children:[(0,q.ZV)(a),"\u2014",(0,q.ZV)(s-1)]}),c&&(0,d.jsx)(zm.H,{children:$m("description_last-messages")})]}),(0,d.jsx)(Rd.O,{popupWidth:242,items:e,showStatus:!0,onUpdate:t,sortable:!1})]})}function dp({scrollToOffset:e}){const{selectedOffset:t,startTimestamp:a,topicDataFilter:s,activeOffset:r,handleSelectedOffsetChange:i,handleStartTimestampChange:o,handleTopicDataFilterChange:l}=rp(),c=n.useRef(null),u=!(0,uu.isNil)(r);n.useEffect((()=>{var e;u&&(null===(e=c.current)||void 0===e||e.blur())}),[u]);const m=n.useCallback((e=>{"TIMESTAMP"===e?i(void 0):o(void 0),l(e)}),[l,i,o]),p=n.useCallback((e=>{i(e)}),[i]),h=n.useCallback((e=>{let t;if(e){const{value:a,type:n}=e;if("absolute"===n)t=a.valueOf();else if("relative"===n){const e=(0,Ce.bQ)(a);t=e?e.valueOf():void 0}}o(t)}),[o]),v=(0,Ce.bQ)(Number(a));return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)(du.a,{value:s,onUpdate:m,children:[(0,d.jsx)(du.a.Option,{value:"TIMESTAMP",children:ap.TIMESTAMP}),(0,d.jsx)(du.a.Option,{value:"OFFSET",children:ap.OFFSET})]}),"OFFSET"===s&&(0,d.jsx)(Fm.i,{controlRef:c,className:ip("offset-input"),value:t?String(t):"",onUpdate:p,label:$m("label_from"),placeholder:$m("label_offset"),type:"number",debounce:600,endContent:(0,d.jsx)(Ae.m,{title:$m("action_scroll-selected"),children:(0,d.jsx)(dn.$,{disabled:(0,uu.isNil)(t)||""===t,className:ip("scroll-button"),view:"flat-action",size:"xs",onClick:()=>{t&&e((0,Er.y3)(t))},children:(0,d.jsx)(Re.I,{size:14,data:qm.A})})}),autoFocus:!0}),"TIMESTAMP"===s&&(0,d.jsx)(Lm.x,{format:"YYYY-MM-DD HH:mm:ss",placeholder:"YYYY-MM-DD HH:mm:ss",hasClear:!0,isDateUnavailable:e=>e.isAfter((0,Ce.bQ)()),label:$m("label_from"),onUpdate:h,defaultValue:v?{type:"absolute",value:v}:null,className:ip("date-picker")})]})}var up=a(92159),mp=a(74529);function pp(e,t){const a=document.createElement("a");a.href=e,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}const hp=(e,t,a)=>{const n=new Blob([e],{type:a}),s=URL.createObjectURL(n);pp(s,t),URL.revokeObjectURL(s)},vp=(0,c.cn)("ydb-diagnostics-message-details"),gp=1e7;function yp({children:e,title:t,className:a,renderToolbar:n}){return(0,d.jsxs)(_e.s,{direction:"column",className:vp("section",a),children:[(0,d.jsxs)(_e.s,{className:vp("section-title-wrapper"),justifyContent:"space-between",alignItems:"center",children:[t,null===n||void 0===n?void 0:n()]}),(0,d.jsx)("div",{className:vp("section-content"),children:(0,d.jsx)("div",{className:vp("section-scroll-container"),children:e})})]})}function xp({offset:e,size:t,message:a}){const s=(0,b.N4)((e=>e.fullscreen)),{preparedMessage:r,decodedMessage:i,convertedMessage:o}=n.useMemo((()=>{let e,n=a,s=a;try{s=atob(a)}catch(r){console.warn(r)}try{const e=JSON.parse(s);n=e&&"object"===typeof e?e:s}catch(r){console.warn(r)}return"object"===typeof n&&(0,Er.y3)(t)<=1e6?e=Tn(n):n&&"object"===typeof n&&(n=JSON.stringify(n,null,2)),{preparedMessage:n,decodedMessage:s,convertedMessage:e}}),[a,t]),l=Boolean(o)?(0,d.jsx)(os,{collapsedInitially:!0,value:o,maxValueWidth:50,toolbarClassName:vp("json-viewer-toolbar")},String(s)):(0,d.jsx)("div",{className:vp("string-message"),children:(0,d.jsx)(mp.A,{value:r,limit:2e3},String(s))}),c=(0,Er.y3)(t)>gp;return(0,d.jsx)(yp,{title:(0,d.jsx)(fp,{truncated:c}),renderToolbar:()=>(0,d.jsxs)(_e.s,{gap:1,children:[(0,d.jsx)(Ae.m,{title:$m("label_download"),children:(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:t=>{t.stopPropagation(),hp(i,`topic-message-${null!==e&&void 0!==e?e:"unknown-offset"}`)},children:(0,d.jsx)(Re.I,{data:up.A})})}),(0,d.jsx)(cn.b,{view:"flat-secondary",text:i})]}),className:vp("message"),children:l})}function fp({truncated:e}){return(0,d.jsxs)("span",{children:[$m("label_message"),e&&(0,d.jsxs)(n.Fragment,{children:[" ",(0,d.jsxs)(De.E,{color:"secondary",children:["[",$m("label_truncated",{size:(0,Er.IG)(gp)}),"]"]})]})]})}var bp=a(23900),jp=a(94420);const Tp=(0,c.cn)("ydb-diagnostics-topic-data-columns"),Sp={name:Hm,header:op[Hm],align:Pt.Ay.LEFT,render:({row:e})=>{const{Offset:t,removed:a,notLoaded:n}=e;return(0,d.jsx)(Lp,{offset:t,removed:a,notLoaded:n})},width:100},wp={name:Wm,header:(0,d.jsx)(Yd,{title:op[Wm]}),align:Pt.Ay.LEFT,render:({row:{CreateTimestamp:e}})=>e?(0,d.jsx)(_s.c,{showStatus:!1,renderName:()=>(0,d.jsx)(Mp,{timestamp:e}),name:(0,q.Ey)(e),hasClipboardButton:!0}):f.Pd,width:220},Np={name:Gm,header:(0,d.jsx)(Yd,{title:op[Gm]}),align:Pt.Ay.LEFT,render:({row:{WriteTimestamp:e}})=>e?(0,d.jsx)(_s.c,{showStatus:!1,renderName:()=>(0,d.jsx)(Mp,{timestamp:e}),name:(0,q.Ey)(e),hasClipboardButton:!0}):f.Pd,width:220},Ep={name:Vm,header:op[Vm],align:Pt.Ay.RIGHT,render:({row:{TimestampDiff:e}})=>(0,d.jsx)(qp,{value:e}),width:110,note:$m("context_ts-diff")},Cp={name:Jm,header:op[Jm],align:Pt.Ay.LEFT,render:({row:{MessageMetadata:e}})=>{if(!e)return f.Pd;const t=e.map((({Key:e="",Value:t=""})=>`${e}: ${t}`));return t.join(", ")},width:200},Pp={name:Km,header:op[Km],align:Pt.Ay.LEFT,render:({row:{Message:e,OriginalSize:t}})=>(0,d.jsx)(zp,{message:e,size:t}),width:500},Ip={name:Ym,header:op[Ym],align:Pt.Ay.RIGHT,render:({row:{StorageSize:e}})=>(0,d.jsx)(Fp,{size:e}),width:100},Dp={name:Zm,header:(0,d.jsx)(Yd,{title:op[Zm]}),align:Pt.Ay.RIGHT,render:({row:e})=>(0,q.z3)(e.OriginalSize),width:100},_p={name:Xm,header:op[Xm],align:Pt.Ay.RIGHT,render:({row:{Codec:e}})=>{var t;return(0,uu.isNil)(e)?f.Pd:null!==(t=lp[e])&&void 0!==t?t:e},width:70},Ap={name:ep,header:op[ep],align:Pt.Ay.LEFT,render:({row:e})=>e.ProducerId?(0,d.jsx)(_s.c,{showStatus:!1,name:e.ProducerId,hasClipboardButton:!0}):f.Pd,width:100},Rp={name:tp,header:op[tp],align:Pt.Ay.RIGHT,render:({row:e})=>e.SeqNo?(0,d.jsx)(_s.c,{showStatus:!1,name:e.SeqNo,hasClipboardButton:!0}):f.Pd,width:100};const kp=["offset","timestampCreate","tsDiff","message"],Op=["offset"];function Mp({timestamp:e}){if(!e)return f.Pd;const t=(0,q.Ey)(e).split("."),a=t.pop();return(0,d.jsxs)(De.E,{variant:"body-2",children:[t.join("."),(0,d.jsxs)(De.E,{color:"secondary",variant:"body-2",children:[".",a]})]})}function Lp({offset:e,removed:t,notLoaded:a}){const n=Lc(),{handleActiveOffsetChange:s}=rp();if((0,uu.isNil)(e))return f.Pd;if(t)return(0,d.jsx)(Ae.m,{title:$m("description_removed-message"),placement:"right",children:(0,d.jsx)(De.E,{className:Tp("offset",{removed:!0}),variant:"body-2",children:e})});const r=n(S.iJ.topicData,{activeOffset:String(e)});return(0,d.jsxs)(N.N_,{to:r,onClick:t=>{t.stopPropagation(),t.preventDefault();const a=String(e);s(a)},className:Tp("offset",{link:!0}),children:[(0,d.jsx)(De.E,{variant:"body-2",color:"info",children:e}),a&&(0,d.jsx)(ea.A,{content:(0,d.jsx)(De.E,{className:Tp("help"),children:$m("description_not-loaded-message")}),className:Tp("help-popover"),children:(0,d.jsx)(De.E,{color:"secondary",className:Tp("help-popover"),children:(0,d.jsx)(Re.I,{data:jp.A})})})]})}function qp({value:e,baseColor:t="primary",variant:a="body-2"}){if((0,uu.isNil)(e))return f.Pd;const n=(0,Er.y3)(e);return(0,d.jsx)(De.E,{variant:a,color:n>=1e5?"danger":t,children:(0,ze.Xo)(n)})}function zp({message:e,size:t}){if((0,uu.isNil)(e))return f.Pd;let a,n=!1;try{a=atob(e)}catch{a=$m("description_failed-decode"),n=!0}const s=(0,Er.y3)(t)>100;return(0,d.jsxs)(De.E,{variant:"body-2",color:n?"secondary":"primary",className:Tp("message",{invalid:n}),children:[a,s&&(0,d.jsxs)(De.E,{color:"secondary",className:Tp("truncated"),children:[" ",$m("description_truncated")]})]})}function Fp({size:e}){return(0,q.z3)(e)}function Up(e,t=f.Pd){return(0,uu.isNil)(e)?t:e}const Qp={name:Bm,header:op[Bm],render:()=>(0,d.jsx)(Vp,{})},$p={name:Hm,header:op[Hm],render:({row:e})=>Up(e.Offset)},Bp={name:Wm,header:op[Wm],render:({row:e})=>(0,d.jsx)(Mp,{timestamp:e.CreateTimestamp})},Hp={name:Gm,header:op[Gm],render:({row:e})=>(0,d.jsx)(Mp,{timestamp:e.WriteTimestamp})},Wp={name:ep,header:op[ep],render:({row:e})=>Up(e.ProducerId)},Gp={name:tp,header:op[tp],render:({row:e})=>Up(e.SeqNo)};function Vp(){const{selectedPartition:e}=rp();return e}const Jp=[Qp,$p,Bp,Hp,Ep,Cp,Pp,Ip,Dp,_p,Wp,Gp],Kp=[[{name:Bm},{name:Hm},{name:Ym}],[{name:Wm,copy:e=>(0,q.Ey)(e.CreateTimestamp)},{name:Gm,copy:e=>(0,q.Ey)(e.WriteTimestamp)},{name:Vm}],[{name:Zm},{name:Xm},{name:ep,copy:e=>e.ProducerId},{name:tp,copy:e=>e.SeqNo}]];function Yp({messageData:e}){return(0,d.jsx)(_e.s,{direction:"column",gap:3,className:vp("details"),children:Kp.map(((t,a)=>(0,d.jsx)(bp.u,{className:vp("list"),nameMaxWidth:200,children:t.map((t=>{var a,n;const s=Jp.find((e=>e.name===t.name)),r=null===(a=t.copy)||void 0===a?void 0:a.call(t,e);return(0,d.jsx)(bp.u.Item,{name:null===s||void 0===s?void 0:s.header,copyText:r,children:null===s||void 0===s||null===(n=s.render)||void 0===n?void 0:n.call(s,{row:e})},t.name)}))},a)))})}function Zp({data:e}){return(0,d.jsx)(yp,{title:$m("label_metadata"),children:(0,d.jsx)(bp.u,{nameMaxWidth:200,className:vp("message-meta"),children:e.map((e=>(0,d.jsx)(bp.u.Item,{name:e.Key,copyText:e.Value,children:e.Value},e.Key)))})})}function Xp({database:e,path:t}){var a;const{selectedPartition:s,activeOffset:r}=rp(),i=n.useMemo((()=>{if((0,uu.isNil)(s)||(0,uu.isNil)(r))return Dd.hT;const a={database:e,path:t,partition:s,limit:1,message_size_limit:gp},n=(0,Er.y3)(r);return a.offset=n,a.last_offset=n+1,a}),[s,r,e,t]),{currentData:l,error:c,isFetching:u}=ua.useGetTopicDataQuery(i),m=null===l||void 0===l||null===(a=l.Messages)||void 0===a?void 0:a[0],p=()=>{const e=null===m||void 0===m?void 0:m.MessageMetadata;return e?(0,d.jsx)(Zp,{data:e}):null},h=()=>{const e=null===m||void 0===m?void 0:m.Message;return e?(0,d.jsx)(xp,{message:e,offset:m.Offset,size:m.OriginalSize}):null};return(0,d.jsx)(o.r,{loading:u,children:(0,d.jsx)("div",{className:vp(),children:(()=>{var e;const t=(0,j.cH)(c),a=t&&404===c.status,n=l&&!(null!==(e=l.Messages)&&void 0!==e&&e.length);if(Boolean(n||a))return(0,d.jsxs)(_e.s,{direction:"column",grow:"grow",alignItems:"center",justifyContent:"center",height:"100%",children:[(0,d.jsx)(De.E,{variant:"subheader-2",children:$m("context_message-not-found",{offset:r})}),(0,d.jsx)(Re.I,{data:_u,size:100})]});if(c){let e=$m("context_get-data-error");return t&&"string"===typeof c.data?e=c.data:t&&c.statusText&&(e=c.statusText),(0,d.jsx)(De.E,{color:"danger",variant:"body-2",children:e})}return(0,d.jsxs)(_e.s,{direction:"column",gap:4,children:[m?(0,d.jsx)(Yp,{messageData:m}):null,p(),h()]})})()})})}const eh={data:[],total:0,found:0};const th=({setBoundOffsets:e,baseOffset:t=0})=>async({limit:a,offset:n,filters:s})=>{if(!s)return eh;const{partition:r,isEmpty:i,...o}=s;if((0,uu.isNil)(r)||""===r||i)return eh;const l=t+n,c={...o,partition:r,limit:a,last_offset:l+a,message_size_limit:100};c.offset=l;const d=await window.api.viewer.getTopicData(c),{start:u,end:m,messages:p}=function(e,t){const{StartOffset:a,EndOffset:n,Messages:s=[]}=e,r=(0,Er.y3)(a),i=(0,Er.y3)(n),o=[],l=Math.min(20,Math.max(i-t,0));let c=0,d=0;for(;d<l;){const e=t+d,a=s[c];e<r?o.push({Offset:e,removed:!0}):(0,uu.isNil)(null===a||void 0===a?void 0:a.Offset)||String(a.Offset)!==String(e)?o.push({Offset:e,notLoaded:!0}):(o.push(a),c++),d++}return{start:r,end:i,messages:o}}(d,l);e({startOffset:u,endOffset:m});const h=m-t;return{data:p,total:h,found:h}},ah=[Sp,wp,Np,Ep,Cp,Pp,Ip,Dp,_p,Ap,Rp];function nh({scrollContainerRef:e,path:t,database:a}){const[s]=(0,b.Nt)(),[r,i]=n.useState(),[o,l]=n.useState(),[c,u]=n.useState(0),[m,p]=n.useState(!1),[h,v]=n.useState(),[g,y]=n.useState(!1),[x,f]=n.useState();n.useRef().current=r;const{selectedPartition:j,selectedOffset:T,startTimestamp:S,topicDataFilter:w,activeOffset:N,handleSelectedOffsetChange:E,handleStartTimestampChange:C,handleSelectedPartitionChange:P,handleActiveOffsetChange:I}=rp();n.useEffect((()=>()=>{P(void 0),E(void 0),C(void 0)}),[P,E,C]);const D=n.useMemo((()=>{if((0,uu.isNil)(j))return Dd.hT;const e={database:a,path:t,partition:j,limit:1};return S?e.read_timestamp=S:e.offset=(0,Er.y3)(T),e}),[j,T,S,a,t]),{currentData:_,error:A,isFetching:R}=ua.useGetTopicDataQuery(D),{data:k,isLoading:O,error:M}=Ad.aD.useGetPartitionsQuery({path:t,database:a},{pollingInterval:s}),L=n.useRef(j);n.useEffect((()=>{const e=j!==L.current,t=null===k||void 0===k?void 0:k.find((({partitionId:e})=>e===j));if(t){let n=x;if(x&&!e||(n=(0,Er.y3)(t.endOffset),f(n)),!h||e){var a;const e=(0,Er.y3)(t.startOffset),s=Math.max((null!==(a=n)&&void 0!==a?a:0)-5e4,e);y(s!==e),v(s)}}e&&(L.current=j)}),[j,k,x,h]),n.useEffect((()=>{if(k&&k.length&&(0,uu.isNil)(j)){const e=k[0].partitionId;P((0,uu.isNil)(e)?void 0:String(e))}}),[k,j,P]);const{columnsToShow:q,columnsToSelect:z,setColumns:F}=(0,wu.K)(ah,"topicDataSelectedColumns",op,kp,Op),U=n.useCallback((({startOffset:e,endOffset:t})=>{i(e),l(t)}),[]);n.useEffect((()=>{var e,t;R||!_&&!A||(null!==_&&void 0!==_&&null!==(e=_.Messages)&&void 0!==e&&e.length||!_&&!A?p(!1):_&&null!==(t=_.Messages)&&void 0!==t&&t.length&&!A||p(!0),_&&U({startOffset:(0,Er.y3)(_.StartOffset),endOffset:(0,Er.y3)(_.EndOffset)}))}),[R,_,A,U]);const Q=n.useMemo((()=>({path:t,database:a,partition:null!==j&&void 0!==j?j:"",isEmpty:m})),[t,a,j,m]),$=n.useCallback((()=>{E(void 0),C(void 0),"TIMESTAMP"===w&&u((e=>e+1))}),[E,C,w]),B=n.useCallback((t=>{var a;const n=(t-(null!==h&&void 0!==h?h:0))*Rm.U3,s=Math.max(0,n);null===(a=e.current)||void 0===a||a.scrollTo({top:s,behavior:"instant"})}),[h,e]),H=n.useRef(N);n.useEffect((()=>{if(R)return;let e;if((0,uu.isNil)(H.current)){const t=null===_||void 0===_?void 0:_.Messages;null!==t&&void 0!==t&&t.length&&(e=(0,Er.y3)(t[0].Offset))}else e=(0,Er.y3)(H.current),H.current=void 0;(0,uu.isNil)(e)||B(e)}),[_,R,B]);const W=n.useCallback((()=>(0,d.jsx)(cp,{columnsToSelect:z,handleSelectedColumnsUpdate:F,partitions:k,partitionsLoading:O,partitionsError:M,startOffset:r,endOffset:o,truncatedData:g,scrollToOffset:B},c)),[z,c,o,k,M,O,B,F,r,g]),G=n.useMemo((()=>th({setBoundOffsets:U,baseOffset:h})),[h,U]),V=n.useCallback((()=>{I(void 0)}),[I]),J=n.useCallback((()=>(0,d.jsx)(Am,{children:(0,d.jsx)(Xp,{database:a,path:t})})),[a,t]);return!(0,uu.isNil)(h)&&!(0,uu.isNil)(x)&&(0,d.jsx)(Su,{isDrawerVisible:!(0,uu.isNil)(N),onCloseDrawer:V,renderDrawerContent:J,drawerId:"topic-data-details",storageKey:"topic-data-details-drawer-width",detectClickOutside:!0,isPercentageWidth:!0,drawerControls:[{type:"copyLink",link:window.location.href},{type:"custom",node:(0,d.jsx)(Nm,{disabled:Boolean(A),view:"flat"}),key:"fullscreen"},{type:"close"}],title:$m("label_message"),headerClassName:ip("drawer-header"),children:(0,d.jsx)(km.o,{controls:W(),table:(0,d.jsx)(Rm.k5,{columnsWidthLSKey:"topicDataColumnsWidth",scrollContainerRef:e,columns:q,fetchData:G,initialEntitiesCount:x-h,limit:20,renderErrorMessage:Om.$,renderEmptyDataMessage:()=>{const e=T||S;return(0,d.jsx)(Mm.U,{title:$m("label_nothing-found"),message:$m("description_nothing-found"),onShowAll:e?$:void 0,showAll:$m("action_show-all"),image:(0,d.jsx)(Tm.oN,{width:230,height:230})})},filters:Q,tableName:"topicData",rowHeight:Rm.U3,keepCache:!1,getRowClassName:e=>ip("row",{active:Boolean(String(e.Offset)===T||String(e.Offset)===N),removed:e.removed})}),tableWrapperProps:{scrollContainerRef:e,scrollDependencies:[h,x,Q]},noBatching:!0})})}const sh=(0,c.cn)("kv-tenant-diagnostics");const rh=function(e){const t=n.useRef(null),a=(0,b.YQ)(),{diagnosticsTab:r=S.iJ.overview}=(0,b.N4)((e=>e.tenant)),i=Lc(),o=vt(e.type)?e.path:e.tenantName,l=(0,D._Q)(),c=(0,D._p)(),u=Mc(e.type,e.subType,{hasFeatureFlags:l,hasTopicData:c,isTopLevel:e.path===e.tenantName});let m=u.find((e=>e.id===r));return m||(m=u[0]),n.useEffect((()=>{m&&m.id!==r&&a((0,_.WO)(m.id))}),[m,r,a]),(0,d.jsxs)("div",{className:sh(),children:[m?(0,d.jsx)(s.mg,{children:(0,d.jsx)("title",{children:m.title})}):null,(()=>{var e;return(0,d.jsx)("div",{className:sh("header-wrapper"),children:(0,d.jsxs)("div",{className:sh("tabs"),children:[(0,d.jsx)(w.t,{size:"l",items:u,activeTab:null===(e=m)||void 0===e?void 0:e.id,wrapTo:({id:e},t)=>{const a=i(e);return(0,d.jsx)(N.N_,{to:a,className:sh("tab"),children:t},e)},allowNotSelected:!0}),(0,d.jsx)(E.E,{onManualRefresh:()=>{const e=new CustomEvent("diagnosticsRefresh");document.dispatchEvent(e)}})]})})})(),(0,d.jsx)(I,{children:(0,d.jsx)("div",{className:sh("page-wrapper"),ref:t,children:(()=>{var a;const{type:n,path:s}=e;switch(null===(a=m)||void 0===a?void 0:a.id){case S.iJ.overview:return(0,d.jsx)(oc,{type:n,tenantName:o,path:s,additionalTenantProps:e.additionalTenantProps,additionalNodesProps:e.additionalNodesProps});case S.iJ.schema:return(0,d.jsx)(Zt,{path:s,tenantName:o,type:n,extended:!0});case S.iJ.topQueries:return(0,d.jsx)(cm,{tenantName:o});case S.iJ.topShards:return(0,d.jsx)(jm,{tenantName:o,path:s});case S.iJ.nodes:return(0,d.jsx)(oe.G,{path:s,database:o,additionalNodesProps:e.additionalNodesProps,scrollContainerRef:t});case S.iJ.tablets:return(0,d.jsx)(We.C,{scrollContainerRef:t,path:s,database:o});case S.iJ.storage:return(0,d.jsx)(He.z,{database:o,scrollContainerRef:t});case S.iJ.network:return(0,d.jsx)(Id,{path:s,database:o,additionalNodesProps:e.additionalNodesProps,scrollContainerRef:t});case S.iJ.describe:return(0,d.jsx)(ds,{path:s,database:o});case S.iJ.hotKeys:return(0,d.jsx)(Vc,{path:s,database:o});case S.iJ.graph:return(0,d.jsx)(ie,{path:s,database:o});case S.iJ.consumers:return(0,d.jsx)(ln,{path:s,database:o,type:n});case S.iJ.partitions:return(0,d.jsx)(cu,{path:s,database:o});case S.iJ.topicData:return(0,d.jsx)(nh,{path:s,database:o,scrollContainerRef:t},s);case S.iJ.configs:return(0,d.jsx)(ia,{database:o});case S.iJ.operations:return(0,d.jsx)(Be,{database:o});default:return(0,d.jsx)("div",{children:"No data..."})}})()})})]})},ih=JSON.parse('{"controls.query-mode-selector_type":"Query type:","tabs.newQuery":"Editor","tabs.history":"History","tabs.saved":"Saved","history.empty":"History is empty","history.empty-search":"Search result is empty","saved.empty":"There are no saved queries","delete-dialog.header":"Delete query","delete-dialog.question":"Are you sure you want to delete query","delete-dialog.delete":"Delete","delete-dialog.cancel":"Cancel","preview.title":"Preview","preview.not-available":"Preview is not available","preview.close":"Close preview","preview.truncated":"truncated","method-description.script":"For YQL-scripts combining DDL and DML.\\nAPI call: schema.scripting","method-description.scan":"Read-only queries, potentially reading a lot of data.\\nAPI call: table.ExecuteScan","method-description.data":"DML queries for changing and fetching data in serialization mode.\\nAPI call: table.executeDataQuery","method-description.query":"Any query. An experimental API call supposed to replace all existing methods.\\nAPI Call: query.ExecuteScript","method-description.pg":"Queries in postgresql syntax.\\nAPI call: query.ExecuteScript","transaction-mode-description.serializable":"Provides the strictest isolation level for custom transactions","transaction-mode-description.onlinero":"Each read operation in the transaction is reading the data that is most recent at execution time","transaction-mode-description.stalero":"Read operations within a transaction may return results that are slightly out-of-date (lagging by fractions of a second)","transaction-mode-description.snapshot":"All the read operations within a transaction access the database snapshot. All the data reads are consistent","transaction-mode-description.implicit":"No transaction","tracing-level-description.basic":"Spans of main component operations","tracing-level-description.detailed":"Highest detail applicable for diagnosing problems in production","tracing-level-description.diagnostic":"Detailed debugging information for developers","tracing-level-description.off":"No tracing","tracing-level-description.toplevel":"Lowest detail, no more than two spans per request to the component","tracing-level-description.trace":"Very detailed debugging information","statistics-mode-description.none":"Don\'t collect statistics","statistics-mode-description.basic":"Collect statistics","statistics-mode-description.full":"Collect statistics and query plan","statistics-mode-description.profile":"Collect statistics for individual tasks","action.send-query":"Send query","action.send-selected-query":"Send selected query","action.previous-query":"Previous query in history","action.next-query":"Next query in history","action.save-query":"Save query","action.stop":"Stop","action.run":"Run","action.explain":"Explain","action.open-shortcuts":"Open Keyboard Shortcuts Panel","filter.text.placeholder":"Search by query text...","gear.tooltip":"Query execution settings have been changed for ","banner.query-settings.message":"Query was executed with modified settings: ","banner.query-stopped.message":"Data is not up to date because the request was not completed.","banner.query-stopped.never-show":"Never show again","toaster.stop-error":"Something went wrong. Unable to stop request processing. Please wait.","history.queryText":"Query text","history.endTime":"End time","history.duration":"Duration"}'),oh=(0,he.g4)("ydb-query-editor",{en:ih}),lh=(0,c.cn)("ydb-queries-history");const ch=function({changeUserInput:e}){const t=(0,b.YQ)(),a=(0,b.N4)(So.py),n=(0,b.N4)(So.jY),s=[...a].reverse(),r=Go((a=>{e({input:a.queryText}),t((0,So.Xb)(!1)),t((0,_.sH)(S.tQ.newQuery))})),i=[{name:"queryText",header:oh("history.queryText"),render:({row:e})=>(0,d.jsx)("div",{className:lh("query"),children:(0,d.jsx)(Jo,{value:e.queryText,maxQueryHeight:6})}),sortable:!1,width:600},{name:"EndTime",header:oh("history.endTime"),render:({row:e})=>e.endTime?(0,q.r6)(e.endTime.toString()):"-",align:"right",width:200,sortable:!1},{name:"Duration",header:oh("history.duration"),render:({row:e})=>e.durationUs?(0,ze.Xo)((0,ze.Jc)(e.durationUs)):"-",align:"right",width:150,sortable:!1}];return(0,d.jsxs)(de.L,{className:lh(),children:[(0,d.jsx)(de.L.Controls,{children:(0,d.jsx)(pe.v,{value:n,onChange:e=>{t((0,So.Ni)(e))},placeholder:oh("filter.text.placeholder"),className:lh("search")})}),(0,d.jsx)(de.L.Table,{children:(0,d.jsx)(ce.l,{columnsWidthLSKey:"queriesHistoryTableColumnsWidth",columns:i,data:s,settings:Xo,emptyDataMessage:oh(n?"history.empty-search":"history.empty"),onRowClick:e=>r(e),rowClassName:()=>lh("table-row")})})]})};var dh=a(72093);function uh(e,t){const a=new Map(Object.entries(e)),n=new Map(Object.entries(t));return Array.from(a.keys()).filter((e=>a.has(e)&&void 0!==a.get(e)&&a.get(e)!==n.get(e)))}const mh=JSON.parse('{"action.settings":"Query settings","form.query-mode":"Query type","form.timeout":"Timeout","form.transaction-mode":"Transaction mode","form.statistics-mode":"Statistics collection mode","form.tracing-level":"Tracing level","form.limit-rows":"Limit rows","button-done":"Save","tooltip_plan-to-svg-statistics":"Statistics option is set to \\"Full\\" due to the enabled \\"Execution plan\\" experiment.\\n To disable it, go to the \\"Experiments\\" section in the user settings.","button-cancel":"Cancel","form.timeout.seconds":"sec","form.limit.rows":"rows","form.timeout.disabled":"Not available to turn off in this query type","form.validation.timeout":"Must be positive","form.validation.limitRows":"Must be between 1 and 100000","description.default":" (default)","docs":"Documentation"}'),ph=JSON.parse('{"action.settings":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430","form.query-mode":"\u0422\u0438\u043f \u0437\u0430\u043f\u0440\u043e\u0441\u0430","form.timeout":"\u0422\u0430\u0439\u043c\u0430\u0443\u0442","form.transaction-mode":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u0438","form.statistics-mode":"\u0420\u0435\u0436\u0438\u043c \u0441\u0431\u043e\u0440\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438","form.tracing-level":"Tracing level","form.limit-rows":"\u041b\u0438\u043c\u0438\u0442 \u0441\u0442\u0440\u043e\u043a","tooltip_plan-to-svg-statistics":"\u041e\u043f\u0446\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u0432 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \\"Full\\" \u0438\u0437-\u0437\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u043e\u0433\u043e \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430 \\"Execution plan\\".\\n \u0427\u0442\u043e\u0431\u044b \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0435\u0433\u043e, \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b \\"Experiments\\" \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.","button-done":"\u0413\u043e\u0442\u043e\u0432\u043e","button-cancel":"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c","form.timeout.seconds":"\u0441\u0435\u043a","form.limit.rows":"\u0441\u0442\u0440\u043e\u043a","form.timeout.disabled":"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0442\u0438\u043f\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430","form.validation.timeout":"\u0422\u0430\u0439\u043c\u0430\u0443\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c","form.validation.limitRows":"\u041b\u0438\u043c\u0438\u0442 \u0441\u0442\u0440\u043e\u043a \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043c\u0435\u0436\u0434\u0443 1 \u0438 100000","description.default":" (default)","docs":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f"}'),hh=(0,he.g4)("ydb-query-settings-dialog",{en:mh,ru:ph}),vh=[{value:Ve.Wg.implicit,content:Ve._d[Ve.Wg.implicit],text:oh("transaction-mode-description.implicit"),isDefault:!0},{value:Ve.Wg.serializable,content:Ve._d[Ve.Wg.serializable],text:oh("transaction-mode-description.serializable")},{value:Ve.Wg.onlinero,content:Ve._d[Ve.Wg.onlinero],text:oh("transaction-mode-description.onlinero")},{value:Ve.Wg.stalero,content:Ve._d[Ve.Wg.stalero],text:oh("transaction-mode-description.stalero")},{value:Ve.Wg.snapshot,content:Ve._d[Ve.Wg.snapshot],text:oh("transaction-mode-description.snapshot")}],gh=[{value:Ve.ei.query,content:Ve.om[Ve.ei.query],text:oh("method-description.query"),isDefault:!0},{value:Ve.ei.script,content:Ve.om[Ve.ei.script],text:oh("method-description.script")},{value:Ve.ei.scan,content:Ve.om[Ve.ei.scan],text:oh("method-description.scan")},{value:Ve.ei.data,content:Ve.om[Ve.ei.data],text:oh("method-description.data")},{value:Ve.ei.pg,content:Ve.om[Ve.ei.pg],text:oh("method-description.pg")}],yh=[{value:Ve.pE.none,content:Ve.Pn[Ve.pE.none],text:oh("statistics-mode-description.none"),isDefault:!0},{value:Ve.pE.basic,content:Ve.Pn[Ve.pE.basic],text:oh("statistics-mode-description.basic")},{value:Ve.pE.full,content:Ve.Pn[Ve.pE.full],text:oh("statistics-mode-description.full")},{value:Ve.pE.profile,content:Ve.Pn[Ve.pE.profile],text:oh("statistics-mode-description.profile")}],xh=[{value:Ve.PB.off,content:Ve.PX[Ve.PB.off],text:oh("tracing-level-description.off"),isDefault:!0},{value:Ve.PB.toplevel,content:Ve.PX[Ve.PB.toplevel],text:oh("tracing-level-description.toplevel")},{value:Ve.PB.basic,content:Ve.PX[Ve.PB.basic],text:oh("tracing-level-description.basic")},{value:Ve.PB.detailed,content:Ve.PX[Ve.PB.detailed],text:oh("tracing-level-description.detailed")},{value:Ve.PB.diagnostic,content:Ve.PX[Ve.PB.diagnostic],text:oh("tracing-level-description.diagnostic")},{value:Ve.PB.trace,content:Ve.PX[Ve.PB.trace],text:oh("tracing-level-description.trace")}],fh={transactionMode:{title:hh("form.transaction-mode"),options:vh},queryMode:{title:hh("form.query-mode"),options:gh},statisticsMode:{title:hh("form.statistics-mode"),options:yh},tracingLevel:{title:hh("form.tracing-level"),options:xh},timeout:{title:hh("form.timeout")},limitRows:{title:hh("form.limit-rows")}};function bh({currentSettings:e,defaultSettings:t}){const a=uh(e,t),n={};return a.forEach((t=>{const a=fh[t],s=e[t];if("options"in a){var r;const e=null===(r=a.options.find((e=>e.value===s)))||void 0===r?void 0:r.content;e&&(n[a.title]=e)}else s&&(n[a.title]=String(s))})),n}var jh=a(80967);const Th=()=>{const[e,t]=(0,jh.i)(f.fr);let a;try{a=Ve.id.parse(e)}catch{a=void 0}return[a,t]};var Sh=a(95312);const wh=()=>{const[e,t]=(0,jh.i)(f.YQ),[a]=Th(),[n]=(0,Sh.X)(),s=a?uh(a,Ve.jU):[],r=n?uh(n,Ve.jU):[],i=s.includes("transactionMode")||s.includes("queryMode"),o=a?bh({currentSettings:a,defaultSettings:Ve.jU}):{},l=n?bh({currentSettings:n,defaultSettings:Ve.jU}):{},c=e&&Date.now()-e<1e3*f.Du;return{isBannerShown:i&&!c,closeBanner:()=>t(Date.now()),resetBanner:()=>t(void 0),changedCurrentSettings:r,changedCurrentSettingsDescriptions:l,changedLastExecutionSettings:s,changedLastExecutionSettingsDescriptions:o}};var Nh=a(53472);let Eh=function(e){return e.triggerCollapse="triggerCollapse",e.triggerExpand="triggerExpand",e.clear="clear",e}({});const Ch=e=>{localStorage.setItem(e,"true")},Ph=e=>{localStorage.removeItem(e)};function Ih(e){return function(t,a){switch(a){case Eh.triggerCollapse:return Ch(e),{...t,triggerCollapse:!0,triggerExpand:!1,collapsed:!0};case Eh.triggerExpand:return Ph(e),{...t,triggerCollapse:!1,triggerExpand:!0,collapsed:!1};case Eh.clear:return Ph(e),{triggerCollapse:!1,triggerExpand:!1,collapsed:!1};default:return t}}}const Dh=(0,c.cn)("kv-pane-visibility-button");function _h({onCollapse:e,onExpand:t,isCollapsed:a,initialDirection:s="top",className:r}){return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(Ae.m,{title:"Collapse",children:(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:e,className:Dh({hidden:a,type:"collapse"},r),children:(0,d.jsx)(Re.I,{data:Nh.A,className:Dh({[s]:!0})})})}),(0,d.jsx)(Ae.m,{title:"Expand",children:(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:t,className:Dh({hidden:!a,type:"expand"},r),children:(0,d.jsx)(Re.I,{data:Nh.A,className:Dh({[s]:!0},"rotate")})})})]})}const Ah=(0,c.cn)("ydb-preview");function Rh({path:e,quantity:t=0,truncated:a,renderResult:n,loading:s,error:r}){const i=(0,b.YQ)(),l=()=>{i((0,x.o)(!1))};return(0,d.jsx)(o.r,{loading:s,children:(0,d.jsxs)("div",{className:Ah(),children:[(0,d.jsxs)(_e.s,{justifyContent:"space-between",alignItems:"center",className:Ah("header"),children:[(0,d.jsxs)(_e.s,{gap:1,children:[oh("preview.title"),(0,d.jsxs)(De.E,{color:"secondary",variant:"body-2",children:[a?`${oh("preview.truncated")} `:"","(",t,")"]}),(0,d.jsx)("div",{className:Ah("table-name"),children:e})]}),(0,d.jsxs)("div",{className:Ah("controls-left"),children:[(0,d.jsx)(Nm,{disabled:Boolean(r)}),(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:l,title:oh("preview.close"),children:(0,d.jsx)(Re.I,{data:qc.A,size:18})})]})]}),(0,d.jsx)(Am,{children:(0,d.jsx)("div",{className:Ah("result"),children:r?(0,d.jsx)("div",{className:Ah("message-container","error"),children:(0,Ve.Cb)(r)}):null===n||void 0===n?void 0:n()})})]})})}const kh=n.memo((function(e){const{className:t,value:a}=e,n=(0,b.YQ)();return(0,d.jsx)("span",{className:zh("cell",t),onClick:e=>n((0,L.DK)(e.target,a,"cell")),children:a})})),Oh=JSON.parse('{"empty":"Table is empty"}'),Mh=JSON.parse('{"empty":"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u0443\u0441\u0442\u0430\u044f"}'),Lh=(0,he.g4)("ydb-query-result-table",{ru:Mh,en:Oh}),qh={...f.N3,stripedRows:!0,sortable:!1,displayIndices:!0},zh=(0,c.cn)("ydb-query-result-table"),Fh=(e,t)=>t,Uh=(e,t)=>t+1,Qh=e=>{const{columns:t,data:a,settings:s}=e,r=n.useMemo((()=>t?((e,t)=>{if(!e.length)return[];const a=null===t||void 0===t?void 0:t.slice(0,100);return e.map((({name:e,type:t})=>{const n=(0,Ve.nh)(t);return{name:e,width:It({data:a,name:e}),align:"number"===n?Pt.Ay.RIGHT:Pt.Ay.LEFT,render:({row:t})=>(0,d.jsx)(kh,{value:String(t[e])})}}))})(t,a):(e=>{if(null===e||void 0===e||!e.length)return[];const t=null===e||void 0===e?void 0:e.slice(0,100);return Object.keys(e[0]).map((a=>({name:a,width:It({data:t,name:a}),align:(0,Er.kf)(e[0][a])?Pt.Ay.RIGHT:Pt.Ay.LEFT,render:({row:e})=>(0,d.jsx)(kh,{value:String(e[a])})})))})(a)),[a,t]),i=n.useMemo((()=>({...qh,...s})),[s]);return Array.isArray(a)?r.length?(0,d.jsx)(ce.l,{data:a,columns:r,settings:i,rowKey:Fh,visibleRowIndex:Uh,wrapperClassName:zh("table-wrapper")}):(0,d.jsx)("div",{className:zh("message"),children:Lh("empty")}):null},$h=g.F.injectEndpoints({endpoints:e=>({sendQuery:e.query({queryFn:async({query:e,database:t,action:a,limitRows:n},{signal:s})=>{try{const r=await window.api.viewer.sendQuery({query:e,database:t,action:a,limit_rows:n},{signal:s,withRetries:!0});return(0,Ve.We)(r)?{error:r}:{data:(0,Ve.fW)(r)}}catch(r){return{error:r||new Error("Unauthorized")}}},providesTags:["PreviewData"]})}),overrideExisting:"throw"});function Bh({database:e,path:t,type:a}){var n,s,r;const i=`select * from \`${t}\` limit 101`,{currentData:o,isFetching:l,error:c}=$h.useSendQueryQuery({database:e,query:i,action:ft(a)?"execute-query":"execute-scan",limitRows:100},{refetchOnMountOrArgChange:!0}),u=l&&void 0===o,m=null!==(n=null===o||void 0===o||null===(s=o.resultSets)||void 0===s?void 0:s[0])&&void 0!==n?n:{};return(0,d.jsx)(Rh,{path:t,renderResult:()=>(0,d.jsx)(Qh,{data:m.result,columns:m.columns}),loading:u,error:c,truncated:m.truncated,quantity:null===(r=m.result)||void 0===r?void 0:r.length})}const Hh=JSON.parse('{"label_partition-id":"Partition ID: {{id}}","label_offsets-range":"offsets: {{start}} - {{end}}"}'),Wh=(0,he.g4)("ydb-preview",{en:Hh}),Gh=[{name:Hm,header:op[Hm],render:({row:{Offset:e}})=>(0,uu.isNil)(e)?f.Pd:e,sortable:!1},{name:Wm,header:op[Wm],render:({row:{CreateTimestamp:e,TimestampDiff:t}})=>(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(Mp,{timestamp:e}),(0,d.jsx)("br",{}),(0,d.jsx)(qp,{value:t,baseColor:"secondary",variant:"body-1"})]}),width:200,sortable:!1},{name:Km,header:op[Km],render:({row:{Message:e,OriginalSize:t}})=>(0,d.jsx)(zp,{message:e,size:t}),width:500,sortable:!1},{name:Ym,header:op[Ym],render:({row:{StorageSize:e}})=>(0,d.jsx)(Fp,{size:e}),align:"right",width:100,sortable:!1}];function Vh({messages:e}){return(0,d.jsx)(ce.l,{data:e,columns:Gh,settings:f.N3,rowKey:(e,t)=>{var a;return null!==(a=e.Offset)&&void 0!==a?a:t},wrapperClassName:Ah("table-wrapper"),emptyDataMessage:"No data"})}function Jh({database:e,path:t}){var a,s;const{data:r,isLoading:i,error:o}=Ad.aD.useGetPartitionsQuery({path:t,database:e}),l=n.useMemo((()=>null===r||void 0===r?void 0:r[0]),[r]),c=n.useMemo((()=>{const a=null===l||void 0===l?void 0:l.partitionId;if(!l||(0,uu.isNil)(a))return Dd.hT;return{database:e,path:t,partition:String(a),limit:100,offset:(0,Er.y3)(l.endOffset)-100,message_size_limit:100}}),[e,t,l]),{currentData:u,error:m,isFetching:p}=ua.useGetTopicDataQuery(c),h=i||p&&void 0===u,v=n.useMemo((()=>{if(l)return{start:(0,Er.y3)(l.startOffset),end:(0,Er.y3)(l.endOffset)-1}}),[l]),g=n.useCallback((()=>{var e,t;return(0,d.jsxs)(_e.s,{direction:"column",children:[(0,d.jsxs)(_e.s,{className:Ah("partition-info"),alignItems:"center",gap:2,children:[!(0,uu.isNil)(null===l||void 0===l?void 0:l.partitionId)&&(0,d.jsx)(De.E,{variant:"body-2",children:Wh("label_partition-id",{id:l.partitionId})}),v&&(0,d.jsxs)(De.E,{variant:"body-2",color:"secondary",children:["(",Wh("label_offsets-range",v),")"]})]}),u&&(0,d.jsx)(Vh,{messages:null!==(e=null===(t=u.Messages)||void 0===t?void 0:t.toReversed())&&void 0!==e?e:[]})]})}),[v,l,u]),y=(0,Er.y3)(null===u||void 0===u?void 0:u.EndOffset)-(0,Er.y3)(null===u||void 0===u?void 0:u.StartOffset);return(0,d.jsx)(Rh,{path:t,renderResult:g,loading:h,error:o||m,truncated:y>100,quantity:null!==(a=null===u||void 0===u||null===(s=u.Messages)||void 0===s?void 0:s.length)&&void 0!==a?a:0})}function Kh(e){const{type:t,subType:a}=e,n=ct(t),s=t===Ye.EPathTypePersQueueGroup,r=a===Ze.EPathSubTypeStreamImpl,i=(0,D._p)();if(n)return(0,d.jsx)(Bh,{...e});if(s&&!r&&i)return(0,d.jsx)(Jh,{...e});return(0,d.jsx)(Rh,{...e,renderResult:()=>(0,d.jsx)("div",{className:Ah("message-container"),children:oh("preview.not-available")})})}const Yh=g.F.injectEndpoints({endpoints:e=>({cancelQuery:e.mutation({queryFn:async({queryId:e,database:t},{signal:a})=>{try{const n=await window.api.viewer.sendQuery({database:t,action:"cancel-query",query_id:e},{signal:a});if((0,Ve.We)(n))return{error:n};return{data:(0,Ve.fW)(n)}}catch(n){return{error:n}}}})}),overrideExisting:"throw"});var Zh=a(13066);async function Xh(e){var t;let a=1;const n=async()=>{if(!window.ydbEditor){if(!a)return!1;await new Promise((e=>{window.setTimeout(e,100)})),a-=1,n()}return!0};await n()?null===(t=window.ydbEditor)||void 0===t||t.trigger(void 0,"insertSnippetToEditor",e):console.error("Monaco editor not found")}function ev(e){return e.replace(/\$/g,"\\$")}const tv=e=>`-- docs: https://ydb.tech/en/docs/yql/reference/syntax/create_table\nCREATE TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}/my_row_table\``:"${1:my_row_table}"} (\n    category_id Uint64 NOT NULL,\n    id Uint64,\n    expire_at Datetime,\n    updated_on Datetime,\n    name Text,\n    \`binary-payload\` Bytes,\n    attributes JsonDocument,\n    -- uncomment to add a secondary index\n    -- INDEX idx_row_table_id GLOBAL SYNC ON ( id ) COVER ( name, attributes ), -- Secondary indexes docs https://ydb.tech/en/docs/yql/reference/syntax/create_table#secondary_index\n    PRIMARY KEY (category_id, id)\n) \nWITH (\n    AUTO_PARTITIONING_BY_SIZE = ENABLED,\n    AUTO_PARTITIONING_PARTITION_SIZE_MB = 2048,\n    AUTO_PARTITIONING_BY_LOAD = ENABLED,\n    AUTO_PARTITIONING_MIN_PARTITIONS_COUNT = 4,\n    AUTO_PARTITIONING_MAX_PARTITIONS_COUNT = 1024\n    -- uncomment to create a table with predefined partitions\n    -- , UNIFORM_PARTITIONS = 4 -- The number of partitions for uniform initial table partitioning.\n                            -- The primary key's first column must have type Uint64 or Uint32.\n                            -- A created table is immediately divided into the specified number of partitions\n    -- uncomment to launch read only replicas in every AZ\n    -- , READ_REPLICAS_SETTINGS = 'PER_AZ:1' -- Enable read replicas for stale read, launch one replica in every availability zone\n    -- uncomment to enable ttl\n    -- , TTL = Interval("PT1H") ON expire_at -- Enable background deletion of expired rows https://ydb.tech/en/docs/concepts/ttl\n    -- uncomment to create a table with a bloom filter\n    -- , KEY_BLOOM_FILTER = ENABLED -- With a Bloom filter, you can more efficiently determine\n                               -- if some keys are missing in a table when making multiple single queries by the primary key.\n)`,av=e=>`-- docs: https://ydb.tech/en/docs/yql/reference/syntax/create_table#olap-tables\nCREATE TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}/my_column_table\``:"${1:my_column_table}"} (\n    id Int64 NOT NULL,\n    author Text,\n    title Text,\n    body Text,\n    PRIMARY KEY (id)\n)\nPARTITION BY HASH(id)\nWITH (STORE = COLUMN)`,nv=()=>'-- docs: https://ydb.tech/docs/en/yql/reference/syntax/create-async-replication\nCREATE OBJECT secret_name (TYPE SECRET) WITH value="secret_value";\n\nCREATE ASYNC REPLICATION my_replication\nFOR ${1:<original_table>} AS ${2:replica_table} --[, `/remote_database/another_table_name` AS `another_local_table_name` ...]\nWITH (\n    CONNECTION_STRING="${3:grpcs://mydb.ydb.tech:2135/?database=/remote_database}",\n    TOKEN_SECRET_NAME = "secret_name"\n    -- ENDPOINT="mydb.ydb.tech:2135",\n    -- DATABASE=`/remote_database`,\n    -- USER="user",\n    -- PASSWORD_SECRET_NAME="your_password"\n);',sv=()=>'-- docs: https://ydb.tech/docs/en/yql/reference/syntax/create-transfer\nCREATE OBJECT secret_name (TYPE SECRET) WITH value="secret_value";\n\n\\$l = (\\$x) -> {\n    return [\n        <|\n            offset:\\$x._offset,\n            message:\\$x._data\n        |>\n    ];\n};\n\nCREATE TRANSFER my_transfer\nFROM ${1:<original_topic>} TO ${2:<target_table>} USING \\$l\nWITH (\n    CONNECTION_STRING="${3:grpcs://mydb.ydb.tech:2135/?database=/remote_database}",\n    TOKEN_SECRET_NAME = "secret_name"\n    -- ENDPOINT="mydb.ydb.tech:2135",\n    -- DATABASE=`/remote_database`,\n    -- USER="user",\n    -- PASSWORD_SECRET_NAME="your_password"\n);',rv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/alter_table/\n\nALTER TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"}\n    -- RENAME TO new_table_name\n    -- DROP COLUMN some_existing_column\n\${2:ADD COLUMN numeric_column Int32};`,iv=e=>`-- documentation about partitioning https://ydb.tech/docs/en/concepts/datamodel/table#partitioning\n\nALTER TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"} SET \n(\n    AUTO_PARTITIONING_BY_LOAD = ENABLED, -- If a partition consumes more than 50% of the CPU for a few dozens of seconds, it is enqueued for splitting.\n    AUTO_PARTITIONING_BY_SIZE = ENABLED, --  If a partition size exceeds the value specified by the AUTO_PARTITIONING_PARTITION_SIZE_MB  parameter, it is enqueued for splitting.\n    AUTO_PARTITIONING_PARTITION_SIZE_MB = 2048,\n    AUTO_PARTITIONING_MIN_PARTITIONS_COUNT = 10, -- Partitions are merged only if their actual number exceeds the value specified by this parameter.\n    AUTO_PARTITIONING_MAX_PARTITIONS_COUNT = 100 -- Partitions are split only if their number doesn't exceed the value specified by this parameter.\n)`,ov=e=>{var t;const a=null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${2:<my_table>}";return`SELECT ${(null===e||void 0===e||null===(t=e.schemaData)||void 0===t?void 0:t.map((e=>{var t;return"`"+ev(null!==(t=e.name)&&void 0!==t?t:"")+"`"})).join(", "))||"${1:*}"}\nFROM ${a}\n${null!==e&&void 0!==e&&e.relativePath?"":"WHERE ${3:Key1 = 1}\nORDER BY ${4:Key1}\n"}LIMIT \${5:10};`},lv=e=>{var t;return`UPSERT INTO ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"}\n( ${(null===e||void 0===e||null===(t=e.schemaData)||void 0===t?void 0:t.map((e=>{var t;return`\`${ev(null!==(t=e.name)&&void 0!==t?t:"")}\``})).join(", "))||"${2:id, name}"} )\nVALUES ( ${null!==e&&void 0!==e&&e.schemaData?"${3: }":'${3:1, "foo"}'} );`},cv=e=>`DROP EXTERNAL TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:my_table}"};`,dv=e=>{const t=null===e||void 0===e?void 0:e.relativePath.split("/").slice(0,-1).join("/");return`CREATE EXTERNAL TABLE ${t?`\`${ev(t)}/my_external_table\``:"${1:<my_external_table>}"} (\n    column1 Int,\n    column2 Int\n) WITH (\n    DATA_SOURCE="${null!==e&&void 0!==e&&e.relativePath?`${ev(e.relativePath)}`:"${2:<path_to_data_source>}"}",\n    LOCATION="",\n    FORMAT="json_as_string",\n    \`file_pattern\`=""\n);`},uv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/create-topic\nCREATE TOPIC ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}/my_topic\``:"${1:my_topic}"} (\n    CONSUMER consumer1,\n    CONSUMER consumer2 WITH (read_from = Datetime('1970-01-01T00:00:00Z')) -- Sets up the message write time starting from which the consumer will receive data.\n                                                                           -- Value type: Datetime OR Timestamp OR integer (unix-timestamp in the numeric format). \n                                                                           -- Default value: now\n) WITH (\n    min_active_partitions = 1, -- Minimum number of topic partitions.\n    partition_count_limit = 0, -- Maximum number of active partitions in the topic. 0 is interpreted as unlimited.\n    retention_period = Interval('PT18H'), -- Data retention period in the topic. Value type: Interval.\n    retention_storage_mb = 0, -- Limit on the maximum disk space occupied by the topic data. \n                              -- When this value is exceeded, the older data is cleared, like under a retention policy. \n                              -- 0 is interpreted as unlimited.\n    partition_write_speed_bytes_per_second = 1048576, -- Maximum allowed write speed per partition.\n    partition_write_burst_bytes = 0 -- Write quota allocated for write bursts. \n                                    -- When set to zero, the actual write_burst value is equalled to \n                                    -- the quota value (this allows write bursts of up to one second).\n);`,mv=e=>`-- docs: https://ydb.tech/en/docs/yql/reference/syntax/alter_topic\nALTER TOPIC ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_topic>}"}\n    ADD CONSUMER new_consumer WITH (read_from = Datetime('1970-01-01T00:00:00Z')), -- Sets up the message write time starting from which the consumer will receive data.\n                                                                                   -- Value type: Datetime OR Timestamp OR integer (unix-timestamp in the numeric format).\n                                                                                   -- Default value: now\n    ALTER CONSUMER consumer1 SET (read_from = Datetime('1970-01-01T00:00:00Z')),\n    DROP CONSUMER consumer2,\n    SET (\n        min_active_partitions = 1, -- Minimum number of topic partitions.\n        partition_count_limit = 0, -- Maximum number of active partitions in the topic. 0 is interpreted as unlimited.\n        retention_period = Interval('PT18H'), -- Data retention period in the topic. Value type: Interval.\n        retention_storage_mb = 0, -- Limit on the maximum disk space occupied by the topic data. \n                                  -- When this value is exceeded, the older data is cleared, like under a retention policy. \n                                  -- 0 is interpreted as unlimited.\n        partition_write_speed_bytes_per_second = 1048576, -- Maximum allowed write speed per partition.\n        partition_write_burst_bytes = 0 -- Write quota allocated for write bursts. \n                                        -- When set to zero, the actual write_burst value is equalled to\n                                        -- the quota value (this allows write bursts of up to one second).\n    );`,pv=e=>`DROP TOPIC ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_topic>}"};`,hv=e=>`CREATE VIEW ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}/my_view\``:"${1:my_view}"} WITH (security_invoker = TRUE) AS SELECT 1;`,vv=e=>`DROP VIEW ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_view>}"};`,gv=e=>`DROP ASYNC REPLICATION ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_replication>}"};`,yv=e=>`DROP TRANSFER ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_transfer>}"};`,xv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/alter-async-replication\nALTER ASYNC REPLICATION ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_replication>}"} SET (STATE = "DONE", FAILOVER_MODE = "FORCE");`,fv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/alter-transfer\n\n\\$l = (\\$x) -> {\n    return [\n        <|\n            offset:\\$x._offset,\n            message:\\$x._data\n        |>\n    ];\n};\n\nALTER TRANSFER ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_transfer>}"} \nSET USING \\$l;`,bv=e=>`ALTER TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"} ADD INDEX \${2:index_name} GLOBAL ON (\${3:<column_name>});`,jv=e=>{const t=null===e||void 0===e?void 0:e.relativePath.split("/").pop(),a=null===e||void 0===e?void 0:e.relativePath.split("/").slice(0,-1).join("/");return`ALTER TABLE ${a?`\`${ev(a)}\``:"${1:<my_table>}"} DROP INDEX ${ev(null!==t&&void 0!==t?t:"")||"${2:<index_name>}"};`},Tv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/alter_table/changefeed\nALTER TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"} ADD CHANGEFEED \${2:changefeed_name} WITH (\n    MODE = \${3:'UPDATES'}, -- KEYS_ONLY, UPDATES, NEW_IMAGE, OLD_IMAGE, or NEW_AND_OLD_IMAGES\n    FORMAT = \${4:'JSON'}, -- JSON or DEBEZIUM_JSON\n    VIRTUAL_TIMESTAMPS = \${5:TRUE}, -- true or false\n    RETENTION_PERIOD = \${6:Interval('PT12H')}, -- Interval value, e.g., Interval('PT24H')\n    -- TOPIC_MIN_ACTIVE_PARTITIONS: The number of topic partitions. By default, the number of topic partitions is equal to the number of table partitions\n    INITIAL_SCAN = \${8:TRUE} -- true or false\n)\n\n-- MODE options:\n--   KEYS_ONLY: Only the primary key components and change flag are written.\n--   UPDATES: Updated column values that result from updates are written.\n--   NEW_IMAGE: Any column values resulting from updates are written.\n--   OLD_IMAGE: Any column values before updates are written.\n--   NEW_AND_OLD_IMAGES: A combination of NEW_IMAGE and OLD_IMAGE modes.`,Sv=()=>"-- docs: https://ydb.tech/docs/en/yql/reference/syntax/create-group\nCREATE GROUP ${1:group_name}\n-- group_name: The name of the group. It may contain lowercase Latin letters and digits.",wv=()=>"-- docs: https://ydb.tech/docs/en/yql/reference/syntax/create-user\nCREATE USER ${1:user_name} PASSWORD ${2:'password'}\n-- user_name: The name of the user. It may contain lowercase Latin letters and digits.\n-- option: The password of the user:\n    -- PASSWORD 'password' creates a user with the password password. The ENCRYPTED option is always enabled.\n    -- PASSWORD NULL creates a user with an empty password.",Nv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/delete\nDELETE FROM ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"}\nWHERE \${2:Key1 = 1};`,Ev=()=>"-- docs: https://ydb.tech/docs/en/yql/reference/syntax/drop-group\nDROP GROUP ${1:<group_name>}\n\n-- IF EXISTS: Suppress an error if the group doesn't exist.\n-- group_name: The name of the group to be deleted.",Cv=()=>"-- docs: https://ydb.tech/docs/en/yql/reference/syntax/drop-user\nDROP USER ${1:<user_name>}\n\n-- IF EXISTS: Suppress an error if the user doesn't exist.\n-- user_name: The name of the user to be deleted.",Pv=e=>`GRANT \${1:<permission_name>}\nON ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(null===e||void 0===e?void 0:e.relativePath)}\``:"${2:<path_to_scheme_object>}"}\nTO \${3:<role_name>}\n\n-- permission_name: The name of the access right to schema objects that needs to be assigned.\n-- path_to_scheme_object: The path to the schema object for which rights are being granted.\n-- role_name: The name of the user or group to whom rights on the schema object are being granted.\n-- WITH GRANT OPTION: Using this construct gives the user or group of users the right to manage access rights - \n--                    to assign or revoke certain rights. This construct has functionality similar to granting \n--                    the "ydb.access.grant" or GRANT right. A subject with the ydb.access.grant right cannot \n--                    grant rights broader than they possess themselves.`,Iv=e=>`REVOKE \${1:<permission_name>}\nON ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(null===e||void 0===e?void 0:e.relativePath)}\``:"${2:<path_to_scheme_object>}"}\nFROM \${3:<role_name>}\n\n-- permission_name: The name of the access right to schema objects that needs to be revoked.\n-- path_to_scheme_object: The path to the schema object from which rights are being revoked.\n-- role_name: The name of the user or group from whom rights on the schema object are being revoked.\n-- GRANT OPTION FOR: Using this construct revokes the user's or group's right to manage access rights.\n--                   All previously granted rights by this user remain in effect.\n--                   This construct has functionality similar to revoking the "ydb.access.grant" or GRANT right.`,Dv=e=>`-- docs: https://ydb.tech/docs/en/yql/reference/syntax/update\nUPDATE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"}\nSET \${2:Column1 = 'foo', Column2 = 'bar'}\nWHERE \${3:Key1 = 1};`,_v=e=>`DROP TABLE ${null!==e&&void 0!==e&&e.relativePath?`\`${ev(e.relativePath)}\``:"${1:<my_table>}"};`,Av=JSON.parse('{"button.new-sql":"New query","action.create-row-table":"Create row table","action.create-column-table":"Create column table","action.create-external-table":"Create external table","action.upsert-to-table":"Upsert into table","action.update-table":"Update table","action.alter-table":"Alter table","action.select-rows":"Select from a table","action.delete-rows":"Delete rows","action.drop-table":"Drop table","action.add-index":"Add index","action.drop-index":"Drop index","action.drop-external-table":"Drop external table","menu.tables":"Tables","menu.topics":"Topics","menu.capture":"Change data capture","menu.replication":"Async replication","menu.transfer":"Transfer","menu.users":"Users","action.create-topic":"Create Topic","action.drop-topic":"Drop Topic","action.alter-topic":"Alter Topic","action.create-cdc-stream":"Create changefeed","action.create-async-replication":"Create async replication","action.create-transfer":"Create transfer","action.create-user":"Create user","action.create-group":"Create group","action.drop-user":"Drop user","action.drop-group":"Drop group","action.grant-privilege":"Grant privilege","action.revoke-privilege":"Revoke privilege","action.alter-async-replication":"Alter async replication","action.drop-async-replication":"Drop async replication","action.alter-transfer":"Alter transfer","action.drop-transfer":"Drop transfer"}'),Rv=(0,he.g4)("ydb-new-sql",{en:Av});function kv(){const e=(e=>{const t=t=>()=>{e(t())};return{createRowTable:t(tv),createColumnTable:t(av),createAsyncReplication:t(nv),alterAsyncReplication:t(xv),dropAsyncReplication:t(gv),createTransfer:t(sv),alterTransfer:t(fv),dropTransfer:t(yv),alterTable:t(rv),selectQuery:t(ov),upsertQuery:t(lv),createExternalTable:t(dv),dropExternalTable:t(cv),createTopic:t(uv),alterTopic:t(mv),dropTopic:t(pv),createView:t(hv),dropTable:t(_v),deleteRows:t(Nv),updateTable:t(Dv),createUser:t(wv),createGroup:t(Sv),createCdcStream:t(Tv),grantPrivilege:t(Pv),revokePrivilege:t(Iv),dropUser:t(Cv),dropGroup:t(Ev),addTableIndex:t(bv),dropTableIndex:t(jv)}})(Go(n.useCallback((e=>{Xh(e)}),[]))),t=[{text:Rv("menu.tables"),items:[{text:Rv("action.create-row-table"),action:e.createRowTable},{text:Rv("action.create-column-table"),action:e.createColumnTable},{text:Rv("action.create-external-table"),action:e.createExternalTable},{text:Rv("action.upsert-to-table"),action:e.upsertQuery},{text:Rv("action.update-table"),action:e.updateTable},{text:Rv("action.alter-table"),action:e.alterTable},{text:Rv("action.select-rows"),action:e.selectQuery},{text:Rv("action.delete-rows"),action:e.deleteRows},{text:Rv("action.drop-table"),action:e.dropTable},{text:Rv("action.drop-external-table"),action:e.dropExternalTable},{text:Rv("action.add-index"),action:e.addTableIndex},{text:Rv("action.drop-index"),action:e.dropTableIndex}]},{text:Rv("menu.topics"),items:[{text:Rv("action.create-topic"),action:e.createTopic},{text:Rv("action.alter-topic"),action:e.alterTopic},{text:Rv("action.drop-topic"),action:e.dropTopic}]},{text:Rv("menu.replication"),items:[{text:Rv("action.create-async-replication"),action:e.createAsyncReplication},{text:Rv("action.alter-async-replication"),action:e.alterAsyncReplication},{text:Rv("action.drop-async-replication"),action:e.dropAsyncReplication}]},{text:Rv("menu.transfer"),items:[{text:Rv("action.create-transfer"),action:e.createTransfer},{text:Rv("action.alter-transfer"),action:e.alterTransfer},{text:Rv("action.drop-transfer"),action:e.dropTransfer}]},{text:Rv("menu.capture"),items:[{text:Rv("action.create-cdc-stream"),action:e.createCdcStream}]},{text:Rv("menu.users"),items:[{text:Rv("action.create-user"),action:e.createUser},{text:Rv("action.create-group"),action:e.createGroup},{text:Rv("action.drop-user"),action:e.dropUser},{text:Rv("action.drop-group"),action:e.dropGroup},{text:Rv("action.grant-privilege"),action:e.grantPrivilege},{text:Rv("action.revoke-privilege"),action:e.revokePrivilege}]}];return(0,d.jsx)(_o.r,{items:t,renderSwitcher:e=>(0,d.jsxs)(dn.$,{...e,children:[Rv("button.new-sql"),(0,d.jsx)(dn.$.Icon,{children:(0,d.jsx)(Zh.A,{})})]}),popupProps:{placement:"top"}})}const Ov=g.F.injectEndpoints({endpoints:e=>({getCodeAssistSuggestions:e.query({queryFn:async e=>{try{if(window.api.codeAssist){return{data:await window.api.codeAssist.getCodeAssistSuggestions(e)}}throw new Error("Method is not implemented.")}catch{return{data:{items:[]}}}}}),acceptSuggestion:e.mutation({queryFn:async e=>{try{if(window.api.codeAssist){return{data:await window.api.codeAssist.sendCodeAssistTelemetry({Accepted:{AcceptedText:e.acceptedText,ConvertedText:e.acceptedText,Timestamp:Date.now(),RequestId:e.requestId}})}}throw new Error("Method is not implemented.")}catch(t){return{error:t}}}}),discardSuggestion:e.mutation({queryFn:async e=>{try{if(window.api.codeAssist){return{data:await window.api.codeAssist.sendCodeAssistTelemetry({Discarded:{RequestId:e.requestId,Timestamp:Date.now(),DiscardReason:"OnCancel",DiscardedText:e.suggestionText,CacheHitCount:e.hitCount}})}}throw new Error("Method is not implemented.")}catch(t){return{error:t}}}}),ignoreSuggestion:e.mutation({queryFn:async e=>{try{if(window.api.codeAssist){return{data:await window.api.codeAssist.sendCodeAssistTelemetry({Ignored:{RequestId:e.requestId,Timestamp:Date.now(),IgnoredText:e.suggestionText}})}}throw new Error("Method is not implemented.")}catch(t){return{error:t}}}}),sendUserQueriesData:e.mutation({queryFn:async e=>{try{if(window.api.codeAssist){return{data:await window.api.codeAssist.sendCodeAssistOpenTabs(e)}}throw new Error("Method is not implemented.")}catch(t){return{error:t}}}})}),overrideExisting:"throw"}),Mv={automaticLayout:!0,selectOnLineNumbers:!0,minimap:{enabled:!1},fixedOverflowWidgets:!0};const Lv=new class{constructor(){this.query=void 0,this.query=null}registerQuery(e){this.query=e}abortQuery(){this.query&&(this.query.abort(),this.query=null)}};var qv=a(54503),zv=a(90851),Fv=a(27738),Uv=a(1155);const Qv=(0,c.cn)("ydb-query-settings-description"),$v=({querySettings:e,prefix:t})=>(0,d.jsxs)("div",{className:Qv("message"),children:[t,Object.entries(e).map((([e,t],a,n)=>(0,d.jsxs)("span",{className:Qv("description-item"),children:[`${e}: ${t}`,a<n.length-1?", ":null]},a)))]}),Bv=(0,c.cn)("ydb-query-editor-button"),Hv={Run:e=>(0,d.jsxs)(dn.$,{...e,className:Bv("run-button"),children:[(0,d.jsx)(Re.I,{data:qv.A,size:16}),oh("action.run")]}),Stop:e=>(0,d.jsxs)(dn.$,{...e,className:Bv("stop-button",{error:e.error}),children:[(0,d.jsx)(Re.I,{data:Ie.A,size:16}),oh("action.stop")]}),Explain:e=>(0,d.jsxs)(dn.$,{...e,className:Bv("explain-button"),children:[(0,d.jsx)(Re.I,{data:zv.A,size:16}),oh("action.explain")]}),Settings:({onClick:e,isLoading:t})=>{const{changedCurrentSettings:a,changedCurrentSettingsDescriptions:n}=wh(),s=a.length>0?{view:"outlined-info",selected:!0}:null;return(0,d.jsx)(Uv.m,{disabled:0===a.length,content:(0,d.jsx)($v,{prefix:oh("gear.tooltip"),querySettings:n}),openDelay:0,placement:["top-start"],children:(0,d.jsxs)(dn.$,{onClick:e,loading:t,className:Bv("gear-button"),...s,children:[(0,d.jsx)(Re.I,{data:Fv.A,size:16}),s?(0,d.jsxs)("div",{className:Bv("changed-settings"),children:["(",a.length,")"]}):null]})})}},Wv=(0,c.cn)("ydb-query-editor-controls"),Gv=({type:e,isHighlighted:t,isLoading:a,isStoppable:n,controlsDisabled:s,onActionClick:r,renderStopButton:i})=>{if(n&&a&&t)return i();const o="run"===e?Hv.Run:Hv.Explain;return(0,d.jsx)(o,{onClick:r,disabled:s,loading:a,view:t?"action":void 0})},Vv=({disabled:e,isLoading:t,highlightedAction:a,queryId:s,tenantName:r,isStreamingEnabled:i,handleSendExecuteClick:o,onSettingsButtonClick:l,handleGetExplainQueryClick:c})=>{const u=(0,b.N4)(So.Wp),[m,p]=Yh.useCancelQueryMutation(),[h,v]=n.useState(t),g=n.useRef(null),y=n.useRef(null),[x,f]=n.useState(!1),j=n.useCallback((async()=>{try{i?Lv.abortQuery():s&&await m({queryId:s,database:r}).unwrap()}catch{qe({name:"stop-error",title:"",content:oh("toaster.stop-error"),type:"error",autoHiding:5e3}),f(!0),y.current&&window.clearTimeout(y.current),y.current=window.setTimeout((()=>{f(!1)}),500)}}),[i,s,m,r]),T="execute"===a,S="explain"===a,w=n.useCallback((()=>{g.current&&window.clearTimeout(g.current),v(!1),g.current=window.setTimeout((()=>{v(!0)}),400)}),[]),N=n.useCallback((()=>{o(u),w()}),[o,u,w]),E=n.useCallback((()=>{c(u),w()}),[c,u,w]);n.useEffect((()=>()=>{g.current&&window.clearTimeout(g.current),y.current&&window.clearTimeout(y.current)}),[]);const C=e||!u,P=()=>(0,d.jsx)(Hv.Stop,{loading:p.isLoading,error:x,onClick:j,view:"action"});return(0,d.jsxs)("div",{className:Wv(),children:[(0,d.jsxs)("div",{className:Wv("left"),children:[(0,d.jsx)(Gv,{type:"run",isHighlighted:T,isLoading:t,isStoppable:h,controlsDisabled:C,onActionClick:N,renderStopButton:P}),(0,d.jsx)(Gv,{type:"explain",isHighlighted:S,isLoading:t,isStoppable:h,controlsDisabled:C,onActionClick:E,renderStopButton:P}),(0,d.jsx)(Hv.Settings,{onClick:l,isLoading:t})]}),(0,d.jsxs)("div",{className:Wv("right"),children:[(0,d.jsx)(kv,{}),(0,d.jsx)(zo,{buttonProps:{disabled:e}})]})]})};var Jv=a(64280),Kv=a(5744),Yv=a(80953);function Zv(e){var t;if(function(e){return"object"===typeof e&&null!==e&&"name"in e&&"AbortError"===e.name}(e))return!0;if((0,j.cH)(e)&&e.isCancelled)return!0;const a=(0,Ve.KH)(e);return(0,Ve.We)(a)&&"Query was cancelled"===(null===(t=a.error)||void 0===t?void 0:t.message)}const Xv=(0,c.cn)("kv-query-execution-status"),eg=({className:e,error:t,loading:a})=>{let s,r,i,o;const{startTime:l,endTime:c}=(0,b.N4)(So.$u),[u,m]=n.useState(l?(c||Date.now())-l:0),p=Zv(t),h=n.useCallback((()=>{if(l){const e=c||Date.now();m(e-l)}}),[c,l]);n.useEffect((()=>{let e;return h(),a?e=setInterval(h,f.KF):clearInterval(e),()=>{clearInterval(e)}}),[a,h]);const v=n.useMemo((()=>u>f.Jg*f.KF?(0,Ce.p0)(u).format("hh:mm:ss"):(0,Ce.p0)(u).format("mm:ss")),[u]);if(a)i="info",o="info-heavy",s=(0,d.jsx)(Yv.t,{size:"xs"}),r="Running";else if((0,j.F0)(t)&&"ECONNABORTED"===t.code)i="danger",o="danger-heavy",s=(0,d.jsx)(Re.I,{data:Jv.A}),r="Connection aborted";else if(p)i="warning",o="warning-heavy",s=(0,d.jsx)(Re.I,{data:Ie.A,className:Xv("result-status-icon",{error:!0})}),r="Stopped";else{const e=Boolean(t);i=e?"danger":"success",o=e?"danger-heavy":"positive-heavy",s=(0,d.jsx)(Re.I,{data:e?Gi.A:Kv.A,className:Xv("result-status-icon",{error:e})}),r=e?"Failed":"Completed"}return(0,d.jsx)(Tt.J,{theme:i,size:"m",className:Xv(null,e),icon:s,value:v,children:(0,d.jsx)(De.E,{color:o,children:r})})};var tg=a(6156);const ag=(0,c.cn)("ydb-query-settings-banner");function ng(){const{isBannerShown:e,changedLastExecutionSettingsDescriptions:t,closeBanner:a}=wh();return e?(0,d.jsx)(tg.F,{className:ag(),theme:"info",align:"baseline",style:{paddingTop:11,paddingBottom:11},message:(0,d.jsx)($v,{prefix:oh("banner.query-settings.message"),querySettings:t}),onClose:a}):null}const sg=(0,c.cn)("ydb-query-stopped-banner");function rg(){const[e,t]=(0,b.iK)(f.J0),a=n.useCallback((()=>{t(!0)}),[t]);return e?null:(0,d.jsx)(tg.F,{className:sg(),theme:"normal",align:"center",style:{paddingTop:11,paddingBottom:11},message:(0,d.jsx)("div",{className:sg("message"),children:oh("banner.query-stopped.message")}),layout:"horizontal",actions:(0,d.jsx)(tg.F.Actions,{children:(0,d.jsx)(tg.F.Action,{view:"normal",onClick:a,children:oh("banner.query-stopped.never-show")})})})}function ig(e){return e.replaceAll("\\","\\\\").replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("\t","\\t")}var og=a(6376);const lg=(0,c.cn)("ydb-query-ast"),cg={automaticLayout:!0,selectOnLineNumbers:!0,readOnly:!0,minimap:{enabled:!1},wrappingIndent:"indent"};function dg({ast:e,theme:t}){return(0,d.jsx)("div",{className:lg(),children:(0,d.jsx)(og.default,{language:"s-expression",value:e,options:cg,theme:`vs-${t}`})})}var ug=a(73253);function mg(e){const t=n.useRef(null),a=n.useId(),{data:s,opts:r,shapes:i}=e;return n.useEffect((()=>{const e=t.current;if(!e)return;e.innerHTML="",e.style.setProperty("width","100vw"),e.style.setProperty("height","100vh");const a=(0,ug.og)(e.id,s,r,i);return a.render(),e.style.setProperty("width","100%"),e.style.setProperty("height","100%"),()=>{a.destroy()}}),[s,r,i]),(0,d.jsx)("div",{id:a,ref:t,style:{overflow:"auto"}})}const pg={renderNodeTitle:e=>{const t=e.name.split("|");return t.length>1?t[1]:e.name},textOverflow:"normal",initialZoomFitsCanvas:!0},hg={node:ug.SO};function vg(e){return(0,d.jsx)(mg,{...e,opts:pg,shapes:hg})}const gg=JSON.parse('{"description.graph-is-not-supported":"Graph can not be rendered","description.empty-result":"There is no {{activeSection}} for the request","action.result":"Result","action.stats":"Stats","action.schema":"Computation Graph","action.explain-plan":"Explain","action.json":"JSON","action.ast":"AST","action.copy":"Copy {{activeSection}}","trace":"Trace","title.truncated":"Truncated","title.result":"Result","tooltip_actions":"Actions","text_open-execution-plan":"Open Execution Plan","text_open-execution-plan_description":"New tab","text_download":"Download Execution Plan","text_download_description":"SVG","text_diagnostics":"Download Diagnostics","text_diagnostics_description":"JSON","text_error-plan-svg":"Error: {{error}}","error.title":"Query Failed","error.description":"An error occurred, please see the Result tab for details","stopped.title":"Query stopped","stopped.description":"Query was stopped"}'),yg=(0,he.g4)("ydb-execute-result",{en:gg}),xg=(0,c.cn)("ydb-query-result-stub-message");function fg({message:e}){return(0,d.jsx)("div",{className:xg(null),children:e})}const bg=(0,c.cn)("ydb-query-explain-graph");function jg({explain:e={},theme:t}){const{links:a,nodes:s}=e,r=n.useMemo((()=>({links:a,nodes:s})),[a,s]);return function(e){return Boolean(e.links&&e.nodes&&e.nodes.length)}(r)?(0,d.jsx)("div",{className:bg("canvas-container"),children:(0,d.jsx)(vg,{data:r},t)}):(0,d.jsx)(fg,{message:yg("description.graph-is-not-supported")})}var Tg=a(7450);const Sg=(0,c.cn)("query-info-dropdown");var wg=a(112);const Ng=g.F.injectEndpoints({endpoints:e=>({planToSvgQuery:e.query({queryFn:async({plan:e,database:t},{signal:a})=>{try{return{data:await window.api.viewer.planToSvg({database:t,plan:e},{signal:a})}}catch(n){return{error:n}}}})}),overrideExisting:"throw"}),Eg=JSON.parse('{"unknown-error":"An unknown error occurred"}'),Cg=(0,he.g4)("ydb-errors",{en:Eg});function Pg({title:e,description:t}){return(0,d.jsxs)("div",{className:Sg("menu-item-content"),children:[(0,d.jsx)(De.E,{variant:"body-1",children:e}),(0,d.jsx)(De.E,{variant:"body-1",color:"secondary",children:t})]})}function Ig({queryResultsInfo:e,database:t,hasPlanToSvg:a,error:s}){const[r,i]=n.useState(null),[o,{isLoading:l}]=Ng.useLazyPlanToSvgQueryQuery();n.useEffect((()=>()=>{r&&URL.revokeObjectURL(r)}),[r]);return{isLoading:l,items:n.useMemo((()=>{const n=[],l=e.plan;if(l&&a){const e=()=>r?Promise.resolve(r):o({plan:l,database:t}).unwrap().then((e=>{const t=new Blob([e],{type:"image/svg+xml"}),a=URL.createObjectURL(t);return i(a),a})).catch((e=>{const t=function(e){if("string"===typeof e)return e;if(!e)return Cg("unknown-error");if((0,j.TX)(e))return e.message;if((0,j.cH)(e)){if(e.data&&"object"===typeof e.data&&"message"in e.data&&"string"===typeof e.data.message)return e.data.message;if("string"===typeof e.data)return e.data}return e instanceof Error?e.message:JSON.stringify(e)}(e);return qe({title:yg("text_error-plan-svg",{error:t}),name:"plan-svg-error",type:"error"}),null})),a=()=>{e().then((e=>{e&&window.open(e,"_blank")}))},s=()=>{e().then((e=>{e&&pp(e,"query-plan.svg")}))};n.push([{text:(0,d.jsx)(Pg,{title:yg("text_open-execution-plan"),description:yg("text_open-execution-plan_description")}),icon:(0,d.jsx)(wg.A,{className:Sg("icon")}),action:a,className:Sg("menu-item")},{text:(0,d.jsx)(Pg,{title:yg("text_download"),description:yg("text_download_description")}),icon:(0,d.jsx)(up.A,{className:Sg("icon")}),action:s,className:Sg("menu-item")}])}if(e){const a=()=>{const a=s?(0,Ve.KH)(s):void 0;((e,t)=>{const a=JSON.stringify(e,null,2);hp(a,`${t}.json`,"application/json")})({...e,database:t,...a&&{error:a}},`query-diagnostics-${(new Date).getTime()}`)};n.push([{text:(0,d.jsx)(Pg,{title:yg("text_diagnostics"),description:yg("text_diagnostics_description")}),icon:(0,d.jsx)(up.A,{className:Sg("icon")}),action:a,className:Sg("menu-item")}])}return n}),[e,a,r,o,t,s])}}function Dg({queryResultsInfo:e,database:t,hasPlanToSvg:a,error:n}){const{isLoading:s,items:r}=Ig({queryResultsInfo:e,database:t,hasPlanToSvg:a,error:n});return r.length?(0,d.jsx)(_o.r,{popupProps:{placement:["bottom-end","left"]},switcherWrapperClassName:Sg("query-info-switcher-wrapper"),renderSwitcher:e=>(0,d.jsx)(Ae.m,{title:yg("tooltip_actions"),children:(0,d.jsx)(dn.$,{view:"flat-secondary",loading:s,disabled:s,...e,children:(0,d.jsx)(dn.$.Icon,{children:(0,d.jsx)(Tg.A,{})})})}),items:r,size:"xl"}):null}const _g=(0,c.cn)("ydb-query-json-viewer");function Ag({data:e}){const t=Sn(e);return(0,d.jsx)("div",{className:_g(),children:(0,d.jsx)("div",{className:_g("tree"),children:(0,d.jsx)(os,{value:t})})})}var Rg=a(56999);const kg=(0,c.cn)("ydb-query-result-error");function Og({error:e}){const t=(0,Ve.KH)(e);return!t||Zv(e)?null:(0,j.TX)(e)?(0,d.jsx)("div",{className:kg("message"),children:e.message}):"object"===typeof t?(0,d.jsx)("div",{className:kg("message"),children:(0,d.jsx)(Rg.O,{data:t})}):(0,d.jsx)("div",{className:kg("message"),children:t})}const Mg=(0,c.cn)("ydb-query-result-sets-viewer");function Lg(e){const{selectedResultSet:t,setSelectedResultSet:a,resultSets:n,error:s}=e,r=null===n||void 0===n?void 0:n[t];return(0,d.jsxs)("div",{className:Mg("result-wrapper"),children:[e.error?(0,d.jsx)(Og,{error:s}):null,null!==n&&void 0!==n&&n.length?(null===n||void 0===n?void 0:n.length)>1?(()=>{const e=(null===n||void 0===n?void 0:n.map(((e,t)=>{var a,s;const r=null===n||void 0===n?void 0:n[t];return{id:String(t),title:(0,d.jsxs)(_e.s,{gap:2,alignItems:"center",children:[(0,d.jsx)(De.E,{children:`Result #${t+1}${null!==n&&void 0!==n&&null!==(a=n[t])&&void 0!==a&&a.truncated?"(T)":""}`}),(0,d.jsx)(De.E,{color:"secondary",children:(null===(s=r.result)||void 0===s?void 0:s.length)||0})]})}})))||[];return(0,d.jsx)(w.t,{className:Mg("tabs"),size:"l",items:e,activeTab:String(t),onSelectTab:e=>a(Number(e))})})():(()=>{var e;const t=null===n||void 0===n?void 0:n[0];return(0,d.jsxs)(_e.s,{gap:2,alignItems:"center",className:Mg("title"),children:[(0,d.jsx)(De.E,{children:null!==t&&void 0!==t&&t.truncated?"Truncated":"Result"}),(0,d.jsx)(De.E,{color:"secondary",children:(null===t||void 0===t||null===(e=t.result)||void 0===e?void 0:e.length)||0})]})})():null,r?(0,d.jsx)("div",{className:Mg("result"),children:(0,d.jsx)(Qh,{settings:e.tableSettings,data:r.result,columns:r.columns})}):null]})}var qg=a(36590),zg=a(79737),Fg=a(79685);const Ug=(0,c.cn)("ydb-query-simplified-plan");function Qg({value:e,formatter:t}){if(!(0,Er.kf)(e))return;const a=t(Number(e));return(0,d.jsx)("div",{className:Ug("metrics-cell"),children:a})}var $g=a(33705);const Bg={Table:"var(--g-color-text-info)",Predicate:"var(--g-color-text-positive)",Condition:"var(--g-color-text-utility)"};function Hg(e){return e in Bg?Bg[e]:"var(--g-color-text-secondary)"}function Wg(e={}){const t=[],a=Object.entries(e);if(1===a.length){const e=a[0][1],n=Hg(a[0][0]);t.push((0,d.jsx)("span",{style:{color:n},children:(0,q.vN)(e)},"param"))}else{const a=function(e){const t=[],{Table:a,Predicate:n,Condition:s,...r}=e;return a&&t.push(["Table",a]),n&&t.push(["Predicate",n]),s&&t.push(["Condition",s]),t.concat(Object.entries(r))}(e);for(let e=0;e<a.length;e++){const[n,s]=a[e],r=Hg(n);e>0&&t.push(", "),t.push((0,d.jsxs)("span",{style:{color:r},children:[n,": ",(0,q.vN)(s)]},e))}}return t}function Gg({params:e}){return e?(0,d.jsxs)("span",{className:Ug("operation-params"),children:["(",Wg(e),")"]}):null}function Vg({modifiers:e,left:t}){return(0,d.jsx)("div",{className:Ug("divider",e),style:{left:t}})}function Jg({row:e,depth:t=0,params:a}){const{name:s,operationParams:r,lines:i=""}=a,o=e.getLeafRows().length>0&&e.getIsExpanded(),l=n.useMemo((()=>function(e,t){const a=e.split(".").map(Number),n=[];for(let s=0;s<a.length;s++)s===a.length-1&&0!==s&&(a[s]?n.push((0,d.jsx)(Vg,{modifiers:{horizontal:!0},left:10+25*(s-1)},"last")):n.push((0,d.jsx)(Vg,{modifiers:{last:!0},left:9+25*(s-1)},"last"))),s===a.length-1&&t&&n.push((0,d.jsx)(Vg,{modifiers:{first:!0},left:9+25*s},"first")),a[s]&&n.push((0,d.jsx)(Vg,{left:9+25*(s-1)},s));return n}(i,o)),[i,o]);return(0,d.jsxs)("div",{style:{paddingLeft:25*t},className:Ug("operation-name"),children:[l,(0,d.jsxs)(_e.s,{gap:1,alignItems:"center",className:Ug("operation-content"),children:[e.getCanExpand()&&(0,d.jsx)(dn.$,{view:"flat",size:"xs",onClick:e.getToggleExpandedHandler(),children:(0,d.jsx)(dn.$.Icon,{children:(0,d.jsx)($g.I,{direction:e.getIsExpanded()?"bottom":"right",size:14})})}),(0,d.jsx)("div",{className:Ug("operation-name-content"),children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:Ug("operation-name"),children:s}),"\xa0",(0,d.jsx)(Gg,{params:r})]})})]})]})}function Kg(e){return(0,d.jsx)(Qg,{value:e.getValue(),formatter:e=>e<1e8?(0,Fg.p)(e).format():(0,Er.z0)(e,1)})}const Yg=[{accessorKey:"name",accessorFn:function(e){return{name:e.name,operationParams:e.operationParams,lines:e.lines}},header:()=>(0,d.jsx)(zg.A,{children:"Operation"}),size:600,cell:e=>(0,d.jsx)(Jg,{row:e.row,depth:e.row.depth,params:e.getValue()})},{accessorKey:"aCpu",header:()=>(0,d.jsx)(zg.A,{children:"A-Cpu"}),size:90,minSize:90,cell:function(e){return(0,d.jsx)(Qg,{value:e.getValue(),formatter:e=>(0,ze.Xo)(Math.round(e))})},meta:{align:"right",verticalAlign:"top"}},{accessorKey:"aRows",header:()=>(0,d.jsx)(zg.A,{children:"A-Rows"}),size:90,minSize:90,cell:Kg,meta:{align:"right",verticalAlign:"top"}},{accessorKey:"eCost",header:()=>(0,d.jsx)(zg.A,{children:"E-Cost"}),size:90,minSize:90,cell:Kg,meta:{align:"right",verticalAlign:"top"}},{accessorKey:"eRows",header:()=>(0,d.jsx)(zg.A,{children:"E-Rows"}),size:90,minSize:90,cell:Kg,meta:{align:"right",verticalAlign:"top"}},{accessorKey:"eSize",header:()=>(0,d.jsx)(zg.A,{children:"E-Size"}),size:90,minSize:90,cell:Kg,meta:{align:"right",verticalAlign:"top"}}];function Zg({plan:e}){const t=n.useMemo((()=>function(e,t=""){if(!e)return[];const a=[{items:e,prefix:t,parentIndex:-1,parentArray:[]}],n=[];for(;a.length>0;){const{items:e,prefix:t,parentIndex:s,parentArray:r}=a.pop(),i=[];for(let n=0;n<e.length;n++){const s={...e[n]},r=n<e.length-1?1:0;let o=`${t}.${r}`;t||(o=String(r)),s.lines=o,i.push(s),s.children&&a.push({items:s.children,prefix:o,parentIndex:n,parentArray:i})}-1===s?n.push(...i):r[s].children=i}return n}(e)),[e]),[a,s]=n.useState(!0),r=(0,qg.K)({columns:Yg,data:t,getSubRows:e=>e.children,enableExpanding:!0,onExpandedChange:s,state:{expanded:a},enableColumnResizing:!0,columnResizeMode:"onChange"});return(0,d.jsx)(zg.X,{wrapperClassName:Ug(),table:r,stickyHeader:!0,width:"max"})}function Xg({traceId:e}){const{traceView:t}=(0,xi.Zd)(),a=null!==t&&void 0!==t&&t.url?(n=t.url,s={traceId:e},n.replace(/\${(\w+)}/g,((e,t)=>s[t]||e))):"";var n,s;return a?(0,d.jsxs)(dn.$,{view:"flat-info",href:a,target:"_blank",children:[yg("trace"),(0,d.jsx)(dn.$.Icon,{children:(0,d.jsx)(wg.A,{})})]}):null}const ey=(0,c.cn)("ydb-query-result"),ty="result",ay="schema",ny="simplified",sy="json",ry="stats",iy="ast",oy={get result(){return yg("action.result")},get schema(){return yg("action.schema")},get simplified(){return yg("action.explain-plan")},get json(){return yg("action.json")},get stats(){return yg("action.stats")},get ast(){return yg("action.ast")}},ly=["result","schema","simplified","stats"],cy=["schema","simplified","json","ast"];function dy({result:e,resultType:t="execute",isResultsCollapsed:a,theme:s,tenantName:r,queryText:i,tableSettings:l,onCollapseResults:c,onExpandResults:u}){var m;const p=(0,b.YQ)(),h="execute"===t,v="explain"===t,[g,y]=n.useState(0),[x,j]=n.useState((()=>h?ty:ay)),[T]=(0,b.iK)(f.lr),{error:S,isLoading:w,data:N={}}=e,{preparedPlan:E,simplifiedPlan:C,stats:P,resultSets:I,ast:D}=N;n.useEffect((()=>{"execute"!==t||ly.includes(x)||j("result"),"explain"!==t||cy.includes(x)||j("schema")}),[x,t]);const _=n.useMemo((()=>{let e=[];return h?e=ly:v&&(e=cy),e.map((e=>({value:e,content:oy[e]})))}),[h,v]);n.useEffect((()=>()=>{p((0,wm.sM)())}),[p]);const A=e=>{j(e)},R=()=>{switch(x){case ty:{var e;const t=null===N||void 0===N||null===(e=N.resultSets)||void 0===e?void 0:e[g],a=function(e){if(null===e||void 0===e||!e.length)return"";const t=Object.keys(e[0]),a=[t.map(ig).join("\t")];for(const n of e){const e=[];for(const a of t){const t=n[a];e.push(ig("object"===typeof t?JSON.stringify(t):`${t}`))}a.push(e.join("\t"))}return a.join("\n")}(null===t||void 0===t?void 0:t.result);return a}case sy:return null===E||void 0===E?void 0:E.pristine;case ny:return null===C||void 0===C?void 0:C.pristine;case ry:return P;case iy:return D;default:return}},k=()=>{if(w)return null;const e=R(),t=(0,q.vN)(e);return t?(0,d.jsx)(cn.b,{text:t,view:"flat-secondary",title:yg("action.copy",{activeSection:x})}):null},O=()=>(0,d.jsx)(fg,{message:yg("description.empty-result",{activeSection:oy[x]})}),M=e=>(0,d.jsxs)(_e.s,{justifyContent:"center",alignItems:"center",width:"100%",gap:8,children:[(0,d.jsx)(Kc.v,{name:"error",className:ey("illustration")}),(0,d.jsxs)(_e.s,{direction:"column",gap:2,children:[(0,d.jsx)(De.E,{variant:"subheader-2",children:yg(e?"stopped.title":"error.title")}),(0,d.jsx)(De.E,{color:"complementary",children:yg(e?"stopped.description":"error.description")})]})]}),L=Zv(S);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:ey("controls"),children:[(0,d.jsxs)("div",{className:ey("controls-left"),children:[_.length&&x?(0,d.jsx)(du.a,{options:_,value:x,onUpdate:A}):null,(0,d.jsx)(eg,{error:S,loading:w}),null!==N&&void 0!==N&&N.traceId&&h?(0,d.jsx)(Xg,{traceId:N.traceId}):null]}),(0,d.jsxs)("div",{className:ey("controls-right"),children:[w||Zv(S)?null:(0,d.jsx)(Dg,{queryResultsInfo:{queryText:i,ast:N.ast,stats:N.stats,plan:N.plan},error:S,database:r,hasPlanToSvg:Boolean((null===N||void 0===N?void 0:N.plan)&&T&&h)}),k(),(0,d.jsx)(Nm,{}),(0,d.jsx)(_h,{onCollapse:c,onExpand:u,isCollapsed:a,initialDirection:"bottom"})]})]}),w||L?null:(0,d.jsx)(ng,{}),L&&null!==(m=N.resultSets)&&void 0!==m&&m.length?(0,d.jsx)(rg,{}):null,(0,d.jsx)(o.r,{loading:w&&(!N.resultSets||"result"!==x),children:(0,d.jsx)(Am,{className:ey("result"),children:(()=>{const e=Zv(S);return x===ty?!S||!e||null!==I&&void 0!==I&&I.length?(0,d.jsx)(Lg,{resultSets:I,error:S,selectedResultSet:g,tableSettings:l,setSelectedResultSet:y}):M(e):S?h||e?M(e):(0,d.jsx)(Og,{error:S}):x===ay?null!==E&&void 0!==E&&null!==(t=E.nodes)&&void 0!==t&&t.length?(0,d.jsx)(jg,{theme:s,explain:E}):O():x===sy?null!==E&&void 0!==E&&E.pristine?(0,d.jsx)(Ag,{data:null===E||void 0===E?void 0:E.pristine}):O():x===ny?null!==C&&void 0!==C&&null!==(a=C.plan)&&void 0!==a&&a.length?(0,d.jsx)(Zg,{plan:C.plan}):O():x===ry?P?(0,d.jsx)(Ag,{data:P}):O():x===iy?D?(0,d.jsx)(dg,{ast:D,theme:s}):O():null;var t,a})()})})]})}var uy=a(16122),my=a(23971);const py=()=>-1,hy=(0,c.cn)("ydb-query-settings-select");function vy(e){return(0,d.jsx)("div",{className:hy("selector"),children:(0,d.jsx)(A.l,{id:e.id,disabled:e.disabled,options:e.settingOptions,value:[e.setting],onUpdate:t=>{e.onUpdateSetting(t[0])},getOptionHeight:py,popupClassName:hy("popup"),renderOption:e=>(0,d.jsxs)("div",{className:hy("item",{type:e.value}),children:[(0,d.jsxs)("div",{className:hy("item-title"),children:[e.content,e.isDefault?hh("description.default"):""]}),e.text&&(0,d.jsx)("span",{className:hy("item-description"),children:e.text})]}),width:"max"})})}const gy=(0,c.cn)("ydb-timeout-label");function yy({isDisabled:e,isChecked:t,onToggle:a}){const[n]=(0,b.iK)(f.kO);return n?(0,d.jsxs)("div",{className:gy("switch-title"),children:[(0,d.jsx)(ta.d,{disabled:e,checked:t,onUpdate:a,className:gy("switch"),content:fh.timeout.title}),e&&(0,d.jsx)(zm.H,{className:gy("question-icon"),placement:"bottom-start",children:hh("form.timeout.disabled")})]}):(0,d.jsx)("label",{htmlFor:"timeout",className:gy("label-title"),children:fh.timeout.title})}const xy=(0,c.cn)("ydb-query-settings-timeout");function fy({id:e,value:t,onChange:a,onToggle:s,validationState:r,errorMessage:i,isDisabled:o}){const l=n.useCallback((e=>{const t=e.target.value?Number(e.target.value):void 0;a(t)}),[a]),c=null!==t;return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(yy,{isDisabled:o,isChecked:c,onToggle:s}),c&&(0,d.jsx)("div",{className:xy("control-wrapper"),children:(0,d.jsx)(On.k,{id:e,type:"number",value:(null===t||void 0===t?void 0:t.toString())||"",onChange:l,className:xy("input"),placeholder:"60",validationState:r,errorMessage:i,errorPlacement:"inside",endContent:(0,d.jsx)("span",{className:xy("postfix"),children:hh("form.timeout.seconds")})})})]})}const by=(0,c.cn)("ydb-query-settings-dialog");function jy(){const e=(0,b.YQ)(),t=(0,b.N4)(Ao.xM),[a,s]=(0,b.XS)(),r=n.useCallback((()=>{e((0,Ao.NJ)("idle"))}),[e]),i=n.useCallback((e=>{s(e),r()}),[r,s]);return(0,d.jsxs)(Fn.l,{open:"settings"===t,size:"s",onClose:r,className:by(),hasCloseButton:!1,children:[(0,d.jsx)(Fn.l.Header,{caption:hh("action.settings")}),(0,d.jsx)(Ty,{initialValues:a,onSubmit:i,onClose:r})]})}function Ty({initialValues:e,onSubmit:t,onClose:a}){const{control:n,handleSubmit:s,setValue:r,watch:i,formState:{errors:o}}=(0,my.mN)({defaultValues:e,resolver:(0,uy.u)(Ve.id)}),[l]=(0,b.iK)(f.lr),c=(0,D.Oi)(),u=i("timeout"),m=i("queryMode");return(0,d.jsxs)("form",{onSubmit:s(t),children:[(0,d.jsxs)(Fn.l.Body,{className:by("dialog-body"),children:[(0,d.jsxs)(_e.s,{direction:"row",alignItems:"flex-start",className:by("dialog-row"),children:[(0,d.jsx)("label",{htmlFor:"queryMode",className:by("field-title"),children:fh.queryMode.title}),(0,d.jsx)("div",{className:by("control-wrapper",{queryMode:!0}),children:(0,d.jsx)(my.xI,{name:"queryMode",control:n,render:({field:e})=>(0,d.jsx)(vy,{id:"queryMode",setting:e.value,onUpdateSetting:t=>{e.onChange(t),"query"!==t&&null===u?r("timeout",""):"query"===t&&r("timeout",null)},settingOptions:fh.queryMode.options})})})]}),c&&(0,d.jsxs)(_e.s,{direction:"row",alignItems:"flex-start",className:by("dialog-row"),children:[(0,d.jsx)("label",{htmlFor:"tracingLevel",className:by("field-title"),children:fh.tracingLevel.title}),(0,d.jsx)("div",{className:by("control-wrapper"),children:(0,d.jsx)(my.xI,{name:"tracingLevel",control:n,render:({field:e})=>(0,d.jsx)(vy,{id:"tracingLevel",setting:e.value,onUpdateSetting:e.onChange,settingOptions:fh.tracingLevel.options})})})]}),(0,d.jsxs)(_e.s,{direction:"row",alignItems:"flex-start",className:by("dialog-row"),children:[(0,d.jsx)("label",{htmlFor:"transactionMode",className:by("field-title"),children:fh.transactionMode.title}),(0,d.jsx)("div",{className:by("control-wrapper",{transactionMode:!0}),children:(0,d.jsx)(my.xI,{name:"transactionMode",control:n,render:({field:e})=>(0,d.jsx)(vy,{id:"transactionMode",setting:e.value,onUpdateSetting:e.onChange,settingOptions:fh.transactionMode.options})})})]}),(0,d.jsxs)(_e.s,{direction:"row",alignItems:"flex-start",className:by("dialog-row"),children:[(0,d.jsx)("label",{htmlFor:"statisticsMode",className:by("field-title"),children:fh.statisticsMode.title}),(0,d.jsx)(Uv.m,{className:by("statistics-mode-tooltip"),disabled:!l,openDelay:0,content:hh("tooltip_plan-to-svg-statistics"),children:(0,d.jsx)("div",{className:by("control-wrapper",{statisticsMode:!0}),children:(0,d.jsx)(my.xI,{name:"statisticsMode",control:n,render:({field:e})=>(0,d.jsx)(vy,{id:"statisticsMode",disabled:l,setting:e.value,onUpdateSetting:e.onChange,settingOptions:fh.statisticsMode.options})})})})]}),(0,d.jsxs)(_e.s,{direction:"row",alignItems:"flex-start",className:by("dialog-row"),children:[(0,d.jsx)("label",{htmlFor:"limitRows",className:by("field-title"),children:fh.limitRows.title}),(0,d.jsx)("div",{className:by("control-wrapper"),children:(0,d.jsx)(my.xI,{name:"limitRows",control:n,render:({field:e})=>{var t,a;return(0,d.jsx)(On.k,{id:"limitRows",type:"number",...e,value:null===(t=e.value)||void 0===t?void 0:t.toString(),className:by("limit-rows"),placeholder:"10000",validationState:o.limitRows?"invalid":void 0,errorMessage:null===(a=o.limitRows)||void 0===a?void 0:a.message,errorPlacement:"inside",endContent:(0,d.jsx)("span",{className:by("postfix"),children:hh("form.limit.rows")})})}})})]}),(0,d.jsx)(_e.s,{direction:"row",alignItems:"flex-start",className:by("dialog-row"),children:(0,d.jsx)(my.xI,{name:"timeout",control:n,render:({field:e})=>{var t;return(0,d.jsx)(fy,{id:"timeout",value:"string"===typeof e.value?void 0:e.value,onChange:e.onChange,onToggle:t=>e.onChange(t?"":null),validationState:o.timeout?"invalid":void 0,errorMessage:null===(t=o.timeout)||void 0===t?void 0:t.message,isDisabled:m!==Ve.ei.query})}})})]}),(0,d.jsx)(Fn.l.Footer,{textButtonApply:hh("button-done"),textButtonCancel:hh("button-cancel"),onClickButtonCancel:a,propsButtonApply:{type:"submit"},renderButtons:(e,t)=>(0,d.jsxs)("div",{className:by("buttons-container"),children:[(0,d.jsx)(dn.$,{href:"https://ydb.tech/docs",target:"_blank",view:"outlined",size:"l",children:hh("docs")}),(0,d.jsxs)("div",{className:by("main-buttons"),children:[t,e]})]})})]})}var Sy=a(52400);const wy=(0,a(99006)._)((async()=>({Editor:(await Promise.resolve().then(a.bind(a,6376))).default})),"Editor");var Ny=a(41614),Ey=a(67913);const Cy=JSON.parse('{"context_syntax-error":"Syntax error"}'),Py=(0,he.g4)("ydb-monaco",{en:Cy}),Iy=(0,uu.debounce)((function(){var e;const t=null===(e=window.ydbEditor)||void 0===e?void 0:e.getModel();if(!t)return void console.error("unable to retrieve model when highlighting errors");const a=(0,Ny.kh)(t.getValue()).errors;if(!a.length)return void _y();const n=a.map((e=>({message:Py("context_syntax-error"),source:e.message,severity:Ey.MarkerSeverity.Error,startLineNumber:e.startLine,startColumn:e.startColumn+1,endLineNumber:e.endLine,endColumn:e.endColumn+1})));Ey.editor.setModelMarkers(t,"ydb",n)}),500);function Dy(){const e=(t=Iy,n.useEffect((()=>()=>{t.cancel()}),[t]),t);var t;return n.useCallback((()=>{_y(),e()}),[e])}function _y(){Ey.editor.removeAllMarkers("ydb")}const Ay="navigation";function Ry({changeUserInput:e,theme:t,handleSendExecuteClick:a,handleGetExplainQueryClick:s}){const r=(0,b.N4)(So.Wp),i=(0,b.YQ)(),[o,l]=n.useState(),c=(0,b.N4)(So.py),[u]=(0,b.iK)(f.bz),m=function(){const[e]=(0,b.iK)(f.LK),[t]=(0,b.iK)(f.IO);return n.useMemo((()=>{const a=Boolean(e);return{quickSuggestions:a,suggestOnTriggerCharacters:a,acceptSuggestionOnEnter:t?"on":"off",...Mv}}),[e,t])}(),p=Dy(),[h]=(0,b.iK)(f.zk),v=(0,b.A5)((()=>c&&0!==c.length?c[c.length-1].queryText:"")),g=(0,b.A5)((()=>{h===Ve.x5.explain?s(r):a(r)})),{monacoGhostConfig:y,prepareUserQueriesCache:x}=function(){const[e]=Ov.useLazyGetCodeAssistSuggestionsQuery(),[t]=Ov.useAcceptSuggestionMutation(),[a]=Ov.useDiscardSuggestionMutation(),[s]=Ov.useIgnoreSuggestionMutation(),[r]=Ov.useSendUserQueriesDataMutation(),i=(0,b.N4)(So.py),o=Ro(),l=n.useCallback((async t=>e(t).unwrap()),[e]),c=n.useCallback((async e=>t(e).unwrap()),[t]),d=n.useCallback((async e=>a(e).unwrap()),[a]),u=n.useCallback((async e=>s(e).unwrap()),[s]),m=n.useMemo((()=>[...i.map(((e,t)=>({name:`query${t}.yql`,text:e.queryText}))),...o.map((e=>({name:e.name,text:e.body})))]),[i,o]);return{prepareUserQueriesCache:n.useCallback((async()=>{const e=m.map(((e,t)=>({FileName:e.name||`query${t}.yql`,Text:e.text})));try{return await r(e).unwrap()}catch{return{items:[]}}}),[r,m]),monacoGhostConfig:n.useMemo((()=>({api:{getCodeAssistSuggestions:l},eventHandlers:{onCompletionAccept:c,onCompletionDecline:d,onCompletionIgnore:u},config:{language:"yql"}})),[l,c,d,u])}}();n.useEffect((()=>(o&&u&&(o.register(y),x()),()=>{null===o||void 0===o||o.unregister()})),[u,y,o,x]);return(0,d.jsx)(wy,{language:"yql",value:r,options:m,onChange:t=>{p(),e({input:t}),i((0,So.Xb)(!0))},editorDidMount:(e,t)=>{window.ydbEditor=e;const n=function(e){const{KeyMod:t,KeyCode:a}=e,n=t.CtrlCmd;return{sendQuery:n|a.Enter,sendSelectedQuery:n|t.Shift|e.KeyCode.Enter,selectPreviousQuery:n|a.UpArrow,selectNextQuery:n|a.DownArrow,saveQuery:n|a.KeyS,saveSelectedQuery:n|t.Shift|a.KeyS,shortcutsHotkey:n|a.KeyK}}(t);t.editor.registerCommand("insertSnippetToEditor",((t,a)=>{const n=e.getContribution("snippetController2");n&&(e.focus(),e.setValue(""),n.insert(a),i((0,So.Xb)(!1)))})),window.api.codeAssist&&l((0,Sy._z)(e)),function(e){const t=F()((()=>{e.layout()}),100);e.layout(),window.addEventListener("resize",t),e.onDidDispose((()=>{window.removeEventListener("resize",t)}))}(e),function(e,t){ky(e.getValue(),t()),e.onDidChangeModelContent((()=>{ky(e.getValue(),t())})),e.onDidDispose((()=>{window.onbeforeunload=null}))}(e,v),e.focus(),e.addAction({id:"sendQuery",label:oh("action.send-query"),keybindings:[n.sendQuery],precondition:void 0,keybindingContext:void 0,contextMenuGroupId:Ay,contextMenuOrder:1,run:()=>g()});const s=e.createContextKey("canSendSelectedText",!1);e.onDidChangeCursorSelection((({selection:e,secondarySelections:t})=>{const a=e.selectionStartLineNumber!==e.positionLineNumber||e.selectionStartColumn!==e.positionColumn,n=t.length>0;s.set(a&&!n)})),e.addAction({id:"sendSelectedQuery",label:oh("action.send-selected-query"),keybindings:[n.sendSelectedQuery],precondition:"canSendSelectedText",contextMenuGroupId:Ay,contextMenuOrder:1,run:e=>{const t=e.getSelection(),n=e.getModel();if(t&&n){const e=n.getValueInRange({startLineNumber:t.getSelectionStart().lineNumber,startColumn:t.getSelectionStart().column,endLineNumber:t.getPosition().lineNumber,endColumn:t.getPosition().column});a(e,!0)}}}),e.addAction({id:"previous-query",label:oh("action.previous-query"),keybindings:[n.selectPreviousQuery],contextMenuGroupId:Ay,contextMenuOrder:2,run:()=>{i((0,So.JK)())}}),e.addAction({id:"next-query",label:oh("action.next-query"),keybindings:[n.selectNextQuery],contextMenuGroupId:Ay,contextMenuOrder:3,run:()=>{i((0,So.tS)())}}),e.addAction({id:"save-query",label:oh("action.save-query"),keybindings:[n.saveQuery],run:()=>{wo.Ay.show(Uo)}}),e.addAction({id:"openKeyboardShortcutsPanel",label:oh("action.open-shortcuts"),keybindings:[n.shortcutsHotkey],contextMenuGroupId:Ay,contextMenuOrder:4,run:()=>{const e=new CustomEvent("openKeyboardShortcutsPanel");window.dispatchEvent(e)}})},theme:`vs-${t}`,editorWillUnmount:()=>{window.ydbEditor=void 0}})}function ky(e,t){const a=!!e&&e!==t;window.onbeforeunload=a?e=>{e.preventDefault(),e.returnValue=""}:null}const Oy=(0,c.cn)("query-editor"),My={triggerExpand:!1,triggerCollapse:!1,collapsed:!0};function Ly(e){const t=(0,b.YQ)(),{tenantName:a,path:s,type:r,theme:i,changeUserInput:o,subType:l}=e,c=(0,b.N4)(So.yJ),u=(0,b.N4)(So.wf),m=(0,b.N4)(So.py),p=(0,b.N4)(So.Kz),v=(0,b.N4)(x.Ab),g=Boolean(u),[y]=(0,b.XS)(),j=(0,D.Oi)(),[T,S]=Th(),{resetBanner:w}=wh(),[N,E]=(0,b.iK)(f.zk),[C,P]=n.useState(""),[I]=(0,b.iK)(f.kO),_=(0,D.j2)()&&I&&y.queryMode===Ve.ei.query,[A]=So.JO.useUseSendQueryMutation(),[R]=So.JO.useUseStreamQueryMutation(),k=n.useMemo((()=>_?{displayIndices:{maxIndex:(y.limitRows||Ve.jU.limitRows)+1}}:void 0),[_,y.limitRows]);n.useEffect((()=>{c!==a&&t((0,So.Id)(a))}),[t,a,c]);const[O,M]=n.useReducer(Ih(f.GV),My);n.useEffect((()=>{M(Eh.triggerCollapse)}),[]),n.useEffect((()=>{M(v||g?Eh.triggerExpand:Eh.triggerCollapse)}),[v,g]);const L=(0,b.A5)(((e,n)=>{E(Ve.x5.execute),P(e),(0,uu.isEqual)(T,y)||(w(),S(y));const s=(0,dh.A)();if(_){const t=R({actionType:"execute",query:e,database:a,querySettings:y,enableTracingLevel:j});Lv.registerQuery(t)}else{const t=A({actionType:"execute",query:e,database:a,querySettings:y,enableTracingLevel:j,queryId:s});Lv.registerQuery(t)}var r;(t((0,x.o)(!1)),n)||(e!==(null===(r=m[p])||void 0===r?void 0:r.queryText)&&t((0,So.nO)({queryText:e,queryId:s})),t((0,So.Xb)(!1)));M(Eh.triggerExpand)})),q=()=>{t((0,Ao.NJ)("settings"))},z=(0,b.A5)((e=>{E(Ve.x5.explain),P(e),(0,uu.isEqual)(T,y)||(w(),S(y));const n=(0,dh.A)(),s=A({actionType:"explain",query:e,database:a,querySettings:y,enableTracingLevel:j,queryId:n});Lv.registerQuery(s),t((0,x.o)(!1)),M(Eh.triggerExpand)}));return(0,d.jsxs)("div",{className:Oy(),children:[(0,d.jsxs)(h,{direction:"vertical",defaultSizePaneKey:f.l_,triggerCollapse:O.triggerCollapse,triggerExpand:O.triggerExpand,minSize:[0,52],collapsedSizes:[100,0],onSplitStartDragAdditional:()=>{M(Eh.clear)},children:[(0,d.jsxs)("div",{className:Oy("pane-wrapper",{top:!0}),children:[(0,d.jsx)("div",{className:Oy("monaco-wrapper"),children:(0,d.jsx)("div",{className:Oy("monaco"),children:(0,d.jsx)(Ry,{changeUserInput:o,theme:i,handleSendExecuteClick:L,handleGetExplainQueryClick:z})})}),(0,d.jsx)(Vv,{handleSendExecuteClick:L,onSettingsButtonClick:q,isLoading:Boolean(null===u||void 0===u?void 0:u.isLoading),handleGetExplainQueryClick:z,highlightedAction:N,tenantName:a,queryId:null===u||void 0===u?void 0:u.queryId,isStreamingEnabled:_})]}),(0,d.jsx)("div",{className:Oy("pane-wrapper"),children:(0,d.jsx)(qy,{resultVisibilityState:O,onExpandResultHandler:()=>{M(Eh.triggerExpand)},onCollapseResultHandler:()=>{M(Eh.triggerCollapse)},type:r,subType:l,theme:i,result:u,tenantName:a,path:s,showPreview:v,queryText:C,tableSettings:k},null===u||void 0===u?void 0:u.queryId)})]}),(0,d.jsx)(jy,{})]})}function qy({resultVisibilityState:e,onExpandResultHandler:t,onCollapseResultHandler:a,type:n,subType:s,theme:r,result:i,tenantName:o,path:l,showPreview:c,queryText:u,tableSettings:m}){return c?(0,d.jsx)(Kh,{database:o,path:l,type:n,subType:s}):i?(0,d.jsx)(dy,{result:i,resultType:null===i||void 0===i?void 0:i.type,theme:r,tenantName:o,isResultsCollapsed:e.collapsed,tableSettings:m,onExpandResults:t,onCollapseResults:a,queryText:u}):null}const zy=[{id:S.tQ.newQuery,title:oh("tabs.newQuery")},{id:S.tQ.history,title:oh("tabs.history")},{id:S.tQ.saved,title:oh("tabs.saved")}],Fy=({className:e,activeTab:t})=>{const a=(0,zs.zy)(),n=(0,U.mA)(a);return(0,d.jsx)("div",{className:e,children:(0,d.jsx)(w.t,{size:"l",allowNotSelected:!0,activeTab:t,items:zy,wrapTo:({id:e},t)=>{const a=(0,Pa.YL)({...n,[Pa.vh.queryTab]:e});return(0,d.jsx)(xo.E,{to:a,children:t},e)}})})};var Uy=a(65872),Qy=a(64470);const $y=(0,c.cn)("ydb-saved-queries"),By=({visible:e,queryName:t,onCancelClick:a,onConfirmClick:n})=>(0,d.jsxs)(Fn.l,{open:e,hasCloseButton:!1,size:"s",onClose:a,onEnterKeyDown:n,children:[(0,d.jsx)(Fn.l.Header,{caption:oh("delete-dialog.header")}),(0,d.jsxs)(Fn.l.Body,{className:$y("dialog-body"),children:[oh("delete-dialog.question"),(0,d.jsx)("span",{className:$y("dialog-query-name"),children:` ${t}?`})]}),(0,d.jsx)(Fn.l.Footer,{textButtonApply:oh("delete-dialog.delete"),textButtonCancel:oh("delete-dialog.cancel"),onClickButtonCancel:a,onClickButtonApply:n})]}),Hy=({changeUserInput:e})=>{const t=Ro(),a=(0,b.YQ)(),s=(0,b.N4)(Ao.cu),[r,i]=n.useState(!1),[o,l]=n.useState(""),c=()=>{i(!1),l("")},u=Go(n.useCallback((({queryText:t,queryName:n})=>{e({input:t}),a((0,So.Xb)(!1)),a((0,Ao.JP)(n)),a((0,_.sH)(S.tQ.newQuery))}),[e,a])),m=[{name:"name",header:"Name",render:({row:e})=>(0,d.jsx)("div",{className:$y("query-name"),children:e.name}),width:200},{name:"body",header:"Query Text",render:({row:e})=>{return(0,d.jsxs)("div",{className:$y("query"),children:[(0,d.jsx)("div",{className:$y("query-body"),children:(0,d.jsx)(Jo,{value:e.body,maxQueryHeight:6})}),(0,d.jsxs)("span",{className:$y("controls"),children:[(0,d.jsx)(dn.$,{view:"flat-secondary",children:(0,d.jsx)(Re.I,{data:Uy.A})}),(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:(t=e.name,e=>{e.stopPropagation(),i(!0),l(t)}),children:(0,d.jsx)(Re.I,{data:Qy.A})})]})]});var t},sortable:!1,resizeMinWidth:650}];return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)(de.L,{className:$y(),children:[(0,d.jsx)(de.L.Controls,{children:(0,d.jsx)(pe.v,{onChange:e=>{a((0,Ao.ys)(e))},placeholder:oh("filter.text.placeholder"),className:$y("search")})}),(0,d.jsx)(de.L.Table,{children:(0,d.jsx)(ce.l,{columnsWidthLSKey:"savedQueriesTableColumnsWidth",columns:m,data:t,settings:Xo,emptyDataMessage:oh(s?"history.empty-search":"saved.empty"),rowClassName:()=>$y("row"),onRowClick:e=>u({queryText:e.body,queryName:e.name}),initialSortOrder:{columnId:"name",order:Pt.Ay.ASCENDING}})})]}),(0,d.jsx)(By,{visible:r,queryName:o,onCancelClick:()=>{c()},onConfirmClick:()=>{c(),a((0,Ao.fu)(o)),l("")}})]})},Wy=(0,c.cn)("ydb-query"),Gy=e=>{const t=(0,b.YQ)(),{queryTab:a=S.tQ.newQuery}=(0,b.N4)((e=>e.tenant)),r=e=>{t((0,So.iZ)(e))},i=n.useMemo((()=>zy.find((({id:e})=>e===a))),[a]);return(0,d.jsxs)("div",{className:Wy(),children:[i?(0,d.jsx)(s.mg,{children:(0,d.jsx)("title",{children:i.title})}):null,(0,d.jsx)(Fy,{className:Wy("tabs"),activeTab:a}),(0,d.jsx)("div",{className:Wy("content"),children:(()=>{switch(a){case S.tQ.newQuery:return(0,d.jsx)(Ly,{changeUserInput:r,...e});case S.tQ.history:return(0,d.jsx)(ch,{changeUserInput:r});case S.tQ.saved:return(0,d.jsx)(Hy,{changeUserInput:r});default:return null}})()})]})};var Vy=a(46649),Jy=a(93844);const Ky=["query","diagnostics"],Yy={query:Vy.A,diagnostics:Jy.A};const Zy=(0,c.cn)("ydb-tenant-navigation"),Xy=({id:e,title:t,icon:a})=>({value:e,content:(0,d.jsxs)("span",{className:Zy("item"),children:[(0,d.jsx)(Re.I,{data:a,size:16,className:Zy("icon")}),(0,d.jsx)("span",{className:Zy("text"),children:t})]})}),ex=()=>{const e=function(){const e=(0,zs.W6)(),t=(0,zs.zy)(),a=(0,U.mA)(t),[,s]=(0,b.iK)(f.Mt),{tenantPage:r}=(0,b.N4)((e=>e.tenant)),i=n.useMemo((()=>{if(t.pathname!==U.Ay.tenant)return[];const n=Ky.map((t=>{const n=S.Dg[t],i=(0,Pa.YL)({...a,[S.Dt]:n});return{id:n,title:fr(`pages.${t}`),icon:Yy[t],path:i,current:r===n,onForward:()=>{s(n),e.push(i)}}}));return n}),[r,s,t.pathname,e,a]);return i}();return(0,d.jsx)("div",{className:Zy(),children:(0,d.jsx)(du.a,{width:"auto",onUpdate:t=>{const a=e.find((e=>e.id===t));null===a||void 0===a||a.onForward()},size:"l",className:Zy("body"),value:(e.find((e=>e.current))||e[0]).id,options:e.map(Xy)})})},tx=(0,c.cn)("object-general");const ax=function(e){const t=(0,T.i)(),{tenantPage:a}=(0,b.N4)((e=>e.tenant));return(0,d.jsxs)("div",{className:tx(),children:[(0,d.jsx)(ex,{}),(()=>{const{type:n,subType:s,additionalTenantProps:r,additionalNodesProps:i,tenantName:o,path:l}=e;return a===S.Dg.query?(0,d.jsx)(Gy,{tenantName:o,path:l,theme:t,type:n,subType:s}):(0,d.jsx)(rh,{type:n,subType:s,tenantName:o,path:l,additionalTenantProps:r,additionalNodesProps:i})})()]})};var nx=a(1956);const sx=g.F.injectEndpoints({endpoints:e=>({getSchemaAcl:e.query({queryFn:async({path:e,database:t},{signal:a})=>{try{const n=await window.api.viewer.getSchemaAcl({path:e,database:t},{signal:a});return{data:{acl:n.Common.ACL,effectiveAcl:n.Common.EffectiveACL,owner:n.Common.Owner,interruptInheritance:n.Common.InterruptInheritance}}}catch(n){return{error:n}}},providesTags:["SchemaTree"]})}),overrideExisting:"throw"}),rx=JSON.parse('{"title_rights":"Access Rights","title_effective-rights":"Effective Access Rights","title_owner":"Owner","title_interupt-inheritance":"Interrupt inheritance","description_empty":"No Acl data"}'),ix=(0,he.g4)("ydb-acl",{en:rx}),ox=(0,c.cn)("ydb-acl"),lx=["access","type","inheritance"],cx={access:"Access",type:"Access type",inheritance:"Inheritance type"},dx=new Set(["Object","Container"]);function ux({value:e}){const t="string"===typeof e?[e]:e;return(0,d.jsx)("div",{className:ox("definition-content"),children:t.map((e=>(0,d.jsx)("span",{children:e},e)))})}function mx(e){if(!e||!e.length)return[];const t=function(e){return e.map((e=>{const{AccessRules:t=[],AccessRights:a=[],AccessType:n,InheritanceType:s,Subject:r}=e,i=t.concat(a),o="Allow"===n?void 0:n;let l;return((null===s||void 0===s?void 0:s.length)!==dx.size||s.some((e=>!dx.has(e))))&&(l=s),{access:i.length?i:void 0,type:o,inheritance:l,Subject:r}}))}(e);return t.map((({Subject:e,...t})=>{const a=Object.entries(t).filter((([e,t])=>Boolean(t)));return 1===a.length&&"access"===a[0][0]?{name:e,content:(0,d.jsx)(ux,{value:a[0][1]}),multilineName:!0}:{label:(0,d.jsx)("span",{className:ox("group-label"),children:e}),items:lx.map((e=>{const a=t[e];if(a)return{name:cx[e],content:(0,d.jsx)(ux,{value:a}),multilineName:!0}})).filter(Nr.f8)}}))}const px=({path:e,database:t})=>{const{currentData:a,isFetching:s,error:r}=sx.useGetSchemaAclQuery({path:e,database:t}),i=s&&!a,{acl:o,effectiveAcl:l,owner:c,interruptInheritance:u}=a||{},m=mx(o),p=mx(l),h=function(e){const t=(a=e,a&&a.endsWith("@staff")&&!a.startsWith("svc_")?a.split("@")[0]:a);var a;return t?[{name:t,content:ix("title_owner"),multilineName:!0}]:[]}(c),v=u?[{name:ix("title_interupt-inheritance"),content:(0,d.jsx)(Re.I,{data:nx.A,size:20}),multilineName:!0}]:[];if(i)return(0,d.jsx)(O.a,{});if(r)return(0,d.jsx)(k.o,{error:r});if(!o&&!c&&!l)return(0,d.jsx)(n.Fragment,{children:ix("description_empty")});const g=h.concat(m);return(0,d.jsxs)("div",{className:ox(),children:[(0,d.jsx)(hx,{items:v}),(0,d.jsx)(hx,{items:g,title:ix("title_rights")}),(0,d.jsx)(hx,{items:p,title:ix("title_effective-rights")})]})};function hx({items:e,title:t}){return e.length?(0,d.jsxs)(n.Fragment,{children:[t&&(0,d.jsx)("div",{className:ox("list-title"),children:t}),(0,d.jsx)(Gs.u,{items:e,nameMaxWidth:200,className:ox("result",{"no-title":!t}),responsive:!0})]}):null}var vx=a(87285);const gx=(e,t,a)=>{const{setActivePath:n}=a;return{openPreview:()=>{t(g.F.util.invalidateTags(["PreviewData"])),t((0,x.o)(!0)),t((0,_.es)(S.Dg.query)),t((0,_.sH)(S.tQ.newQuery)),n(e)}}},yx=(e,t)=>(0,d.jsx)(dn.$,{view:"flat-secondary",onClick:e.openPreview,title:fr("actions.openPreview"),size:t||"s",children:(0,d.jsx)(Re.I,{data:vx.A})}),xx=(e,t,a,n)=>(s,r,i)=>{const o=gx(s,e,t),l=yx(o,a),c=(null===i||void 0===i?void 0:i.subType)===Ze.EPathSubTypeStreamImpl;return{async_replication:void 0,transfer:void 0,database:void 0,directory:void 0,resource_pool:void 0,table:l,column_table:l,index_table:void 0,topic:n&&!c?l:void 0,stream:void 0,index:void 0,external_table:l,external_data_source:void 0,view:l}[r]},fx=(e,t,a)=>(n,s)=>{const r=gx(n,e,t);return{preview:yx(r,a)}[s]};var bx=a(89974),jx=a(3228);const Tx=5*f.KF,Sx=g.F.injectEndpoints({endpoints:e=>({getTableSchemaData:e.query({queryFn:async({path:e,tenantName:t,type:a},{dispatch:n})=>{try{if(jt(a)){const a=await n(Ke.endpoints.getViewSchema.initiate({database:t,path:e,timeout:Tx}));if((0,Ve.We)(a))return{error:a};return{data:Yt(a.data)}}const s=await n(y.endpoints.getOverview.initiate({path:e,database:t,timeout:Tx}));return{data:Kt(a,s.data)}}catch(s){return{error:s}}}})})});var wx=a(51016),Nx=a(49917),Ex=a(32133),Cx=a.n(Ex);function Px(e,t){const a=e.replace(/^\/+|\/+$/g,""),n=t.replace(/^\/+|\/+$/g,"");if(!a.startsWith(n))return a||"/";if(a===n)return`/${a}`;let s=a.slice(n.length);return s=s.replace(/^\/+/,"")||"/",s}function Ix(e,t){return t===Ye.EPathTypeDir&&(2===e.split("/").length&&e.startsWith("/"))}const Dx=({text:e,action:t,isLoading:a})=>({text:(0,d.jsxs)(_e.s,{justifyContent:"space-between",alignItems:"center",children:[e,a&&(0,d.jsx)(Yv.t,{size:"xs"})]}),action:t,disabled:a}),_x=(e,t,a="")=>(n,s)=>{const r=((e,t,a)=>{const{setActivePath:n,showCreateDirectoryDialog:s,getConfirmation:r,getConnectToDBDialog:i,schemaData:o}=a,l=a=>()=>{const s=()=>{t((0,_.es)(S.Dg.query)),t((0,_.sH)(S.tQ.newQuery)),n(e.path),Xh(a({...e,schemaData:o}))};r?r().then((e=>{e&&s()})):s()};return{createDirectory:s?()=>{s(e.path)}:void 0,getConnectToDBDialog:()=>null===i||void 0===i?void 0:i({database:e.path}),createTable:l(tv),createColumnTable:l(av),createAsyncReplication:l(nv),alterAsyncReplication:l(xv),dropAsyncReplication:l(gv),createTransfer:l(sv),alterTransfer:l(fv),dropTransfer:l(yv),alterTable:l(rv),dropTable:l(_v),manageAutoPartitioning:l(iv),selectQuery:l(ov),upsertQuery:l(lv),createExternalTable:l(dv),dropExternalTable:l(cv),selectQueryFromExternalTable:l(ov),createTopic:l(uv),alterTopic:l(mv),dropTopic:l(pv),createView:l(hv),dropView:l(vv),dropIndex:l(jv),addTableIndex:l(bv),createCdcStream:l(Tv),copyPath:()=>{try{Cx()(e.relativePath),qe({name:"Copied",title:fr("actions.copied"),type:"success"})}catch{qe({name:"Not copied",title:fr("actions.notCopied"),type:"error"})}}}})({path:n,relativePath:Px(n,a),tenantName:a,type:s},e,t),i={text:fr("actions.copyPath"),action:r.copyPath,iconEnd:(0,d.jsx)(wx.A,{})},o={text:fr("actions.connectToDB"),action:r.getConnectToDBDialog,iconEnd:(0,d.jsx)(Nx.A,{})},l=[{text:fr("actions.createTable"),action:r.createTable},{text:fr("actions.createColumnTable"),action:r.createColumnTable},{text:fr("actions.createAsyncReplication"),action:r.createAsyncReplication},{text:fr("actions.createTransfer"),action:r.createTransfer},{text:fr("actions.createTopic"),action:r.createTopic},{text:fr("actions.createView"),action:r.createView}],c={text:fr("actions.alterTable"),items:[{text:fr("actions.manageColumns"),action:r.alterTable},{text:fr("actions.manageAutoPartitioning"),action:r.manageAutoPartitioning}]},u=[[i,o],l],m=[[i],l];if(r.createDirectory){const e={text:fr("actions.createDirectory"),action:r.createDirectory};u.splice(1,0,[e]),m.splice(1,0,[e])}const p=[[i],[c,{text:fr("actions.dropTable"),action:r.dropTable},Dx({text:fr("actions.selectQuery"),action:r.selectQuery,isLoading:t.isSchemaDataLoading}),Dx({text:fr("actions.upsertQuery"),action:r.upsertQuery,isLoading:t.isSchemaDataLoading}),{text:fr("actions.addTableIndex"),action:r.addTableIndex},{text:fr("actions.createCdcStream"),action:r.createCdcStream}]],h=[[i],[c,{text:fr("actions.dropTable"),action:r.dropTable},{text:fr("actions.selectQuery"),action:r.selectQuery},{text:fr("actions.upsertQuery"),action:r.upsertQuery}]],v=[[i],[{text:fr("actions.alterTopic"),action:r.alterTopic},{text:fr("actions.dropTopic"),action:r.dropTopic}]],g=[[i],[{text:fr("actions.selectQuery"),action:r.selectQueryFromExternalTable}],[{text:fr("actions.dropTable"),action:r.dropExternalTable}]],y=[[i],[{text:fr("actions.createExternalTable"),action:r.createExternalTable}]],x=[[i],[{text:fr("actions.selectQuery"),action:r.selectQuery}],[{text:fr("actions.dropView"),action:r.dropView}]],f=[i];return{async_replication:[[i],[{text:fr("actions.alterReplication"),action:r.alterAsyncReplication},{text:fr("actions.dropReplication"),action:r.dropAsyncReplication}]],transfer:[[i],[{text:fr("actions.alterTransfer"),action:r.alterTransfer},{text:fr("actions.dropTransfer"),action:r.dropTransfer}]],database:u,directory:m,resource_pool:f,table:p,column_table:h,index_table:f,topic:v,stream:f,index:[[i,{text:fr("actions.dropIndex"),action:r.dropIndex}]],external_table:g,external_data_source:y,view:x}[s]},Ax=(0,c.cn)("ydb-schema-create-directory-dialog"),Rx="relativePath";function kx({open:e,onClose:t,database:a,parentPath:s,onSuccess:r}){const[i,o]=n.useState(""),[l,c]=n.useState(""),[u,m]=x.sM.useCreateDirectoryMutation(),p=()=>{o(""),m.reset()},h=()=>{t(),c(""),p()};return(0,d.jsxs)(Fn.l,{open:e,onClose:h,size:"s",children:[(0,d.jsx)(Fn.l.Header,{caption:fr("schema.tree.dialog.header")}),(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=(n=l)?/\s/.test(n)?fr("schema.tree.dialog.whitespace"):"":fr("schema.tree.dialog.empty");var n;o(t),t||u({database:a,path:`${s}/${l}`}).unwrap().then((()=>{h(),r(l)}))},children:[(0,d.jsxs)(Fn.l.Body,{children:[(0,d.jsxs)("label",{htmlFor:Rx,className:Ax("label"),children:[(0,d.jsx)("span",{className:Ax("description"),children:fr("schema.tree.dialog.description")}),`${s}/`]}),(0,d.jsx)("div",{className:Ax("input-wrapper"),children:(0,d.jsx)(On.k,{placeholder:fr("schema.tree.dialog.placeholder"),value:l,onUpdate:e=>{c(e),p()},autoFocus:!0,hasClear:!0,autoComplete:!1,disabled:m.isLoading,validationState:i?"invalid":void 0,id:Rx,errorMessage:i})}),m.isError&&(0,d.jsx)(k.o,{error:m.error,defaultMessage:fr("schema.tree.dialog.invalid")})]}),(0,d.jsx)(Fn.l.Footer,{loading:m.isLoading,textButtonApply:fr("schema.tree.dialog.buttonApply"),textButtonCancel:fr("schema.tree.dialog.buttonCancel"),onClickButtonCancel:h,propsButtonApply:{type:"submit"}})]})]})}const Ox=n.createContext(void 0),Mx=n.createContext(void 0);function Lx({children:e}){const[t,a]=n.useState("");return(0,d.jsx)(Ox.Provider,{value:t,children:(0,d.jsx)(Mx.Provider,{value:a,children:e})})}function qx(){const e=n.useContext(Mx);if(void 0===e)throw new Error("useDispatchTreeKey must be used within a TreeKeyProvider");return e}function zx(e){const t=(0,D.Ii)(),{rootPath:a,rootName:s,rootType:r,currentPath:i,onActivePathUpdate:o}=e,l=(0,b.YQ)(),c=(0,b.N4)(So.Wp),u=(0,b.N4)(So.TY),[m,{currentData:p,isFetching:h}]=Sx.useLazyGetTableSchemaDataQuery(),v=(0,D._p)(),[g,y]=n.useState(!1),[f,j]=n.useState(""),T=qx(),S=function(){const e=n.useContext(Ox);if(void 0===e)throw new Error("useTreeKey must be used within a TreeKeyProvider");return e}(),w=Ix(a,r)?"database":st(r);n.useEffect((()=>{null!==i&&void 0!==i&&i.startsWith(a)||o(a)}),[i,o,a]);const N=e=>{j(e),y(!0)},E=n.useMemo((()=>_x(l,{setActivePath:o,showCreateDirectoryDialog:t?N:void 0,getConfirmation:c&&u?Wo:void 0,getConnectToDBDialog:jx.S,schemaData:p,isSchemaDataLoading:h},a)),[p,t,l,c,h,u,o,a]);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(kx,{onClose:()=>{y(!1)},open:g,database:a,parentPath:f,onSuccess:e=>{const t=`${f}/${e}`;o(t),T(t)}}),(0,d.jsx)(bx.F,{rootState:{path:a,name:s,type:w,collapsed:!1},fetchPath:async e=>{let t;for(;;){const n=l(x.sM.endpoints.getSchema.initiate({path:e,database:a},{forceRefetch:!0})),{data:s,originalArgs:r}=await n;if(n.unsubscribe(),(null===r||void 0===r?void 0:r.path)===e){t=null===s||void 0===s?void 0:s[e];break}}if(!t)throw new Error(`no describe data about path ${e}`);const{PathDescription:{Children:n=[]}={}}=t;return n.map((e=>{const{Name:t="",PathType:a,PathSubType:n,ChildrenExist:s}=e,r=xt(a,n)||(0,Nr.f8)(s)&&!s;return{name:t,type:st(a,n),expandable:!r,meta:{subType:n}}}))},getActions:E,onActionsOpenToggle:({path:e,type:t,isOpen:n})=>{const s=nt[t];return n&&s&&m({path:e,tenantName:a,type:s}),[]},renderAdditionalNodeElements:xx(l,{setActivePath:o},void 0,v),activePath:i,onActivePathUpdate:o,cache:!1,virtualize:!0},S)]})}const Fx=JSON.parse('{"title_navigation":"Navigation","field_source-type":"Source Type","field_data-source":"Data Source","action_copySchemaPath":"Copy schema path","action_openInDiagnostics":"Open in Diagnostics","field_type":"Type","field_subtype":"SubType","field_id":"Id","field_version":"Version","field_created":"Created","field_data-size":"Data size","field_row-count":"Row count","field_partitions":"Partitions count","field_paths":"Paths","field_shards":"Shards","field_state":"State","field_mode":"Mode","field_format":"Format","field_retention":"Retention"}'),Ux=(0,he.g4)("ydb-object-summary",{en:Fx}),Qx=(0,c.cn)("ydb-object-summary");function $x({tenantName:e,path:t}){var a;const{data:n={},isLoading:s}=(0,x.Tn)({path:e,database:e}),i=null===n||void 0===n||null===(a=n.PathDescription)||void 0===a?void 0:a.Self,[,o]=(0,r.useQueryParam)("schema",r.StringParam);return!i&&s?(0,d.jsx)("div",{children:(0,d.jsx)(O.a,{})}):(0,d.jsxs)("div",{className:Qx("tree-wrapper"),children:[(0,d.jsx)("div",{className:Qx("tree-header"),children:Ux("title_navigation")}),(0,d.jsx)("div",{className:Qx("tree"),children:i?(0,d.jsx)(zx,{rootPath:e,rootName:(l=i.Name,c=e,l?l.startsWith("/")?l:`/${l}`:c.startsWith("/")?c:`/${c}`),rootType:i.PathType,currentPath:t,onActivePathUpdate:o}):null})]});var l,c}var Bx=a(16963);function Hx(){const e=(0,b.YQ)(),{diagnosticsTab:t,tenantPage:a}=(0,b.N4)((e=>e.tenant)),n=a===S.Dg.diagnostics&&t===S.iJ.schema;return(0,d.jsx)("div",{children:!n&&(0,d.jsx)(dn.$,{title:Ux("action_openInDiagnostics"),onClick:()=>{e((0,_.es)(S.Dg.diagnostics)),e((0,_.WO)(S.iJ.schema))},size:"s",children:(0,d.jsx)(Re.I,{data:Bx.A,size:14})})})}var Wx=a(8873),Gx=a(97091);function Vx(){const e=qx(),t=(0,b.YQ)();return(0,d.jsx)(Ae.m,{title:"Refresh",children:(0,d.jsx)(dn.$,{className:Qx("refresh-button"),view:"flat-secondary",onClick:()=>{e((0,Gx.Ak)()),t(g.F.util.invalidateTags(["SchemaTree"]))},children:(0,d.jsx)(Re.I,{data:Wx.A})})})}const Jx=()=>({triggerExpand:!1,triggerCollapse:!1,collapsed:Boolean(localStorage.getItem(f.hh))});function Kx({type:e,subType:t,tenantName:a,path:s,onCollapseSummary:i,onExpandSummary:o,isCollapsed:l}){var c;const u=(0,b.YQ)(),[,m]=(0,r.useQueryParam)("schema",r.StringParam),[p,v]=n.useReducer(Ih(f.hh),void 0,Jx),{summaryTab:g=S.ml.overview}=(0,b.N4)((e=>e.tenant)),x=(0,zs.zy)(),j=Ea().parse(x.search,{ignoreQueryPrefix:!0}),{currentData:T}=y.useGetOverviewQuery({path:s,database:a}),E=null===T||void 0===T||null===(c=T.PathDescription)||void 0===c?void 0:c.Self;n.useEffect((()=>{const t=ct(e);!e||t||Pa.x$.find((e=>e.id===g))||u((0,_.Mj)(S.ml.overview))}),[u,e,g]);const C=()=>{const t=ct(e)?[...Pa.x$,...Pa.nb]:Pa.x$;return(0,d.jsx)("div",{className:Qx("tabs"),children:(0,d.jsxs)(_e.s,{className:Qx("tabs-inner"),justifyContent:"space-between",alignItems:"center",children:[(0,d.jsx)(w.t,{size:"l",items:t,activeTab:g,wrapTo:({id:e},t)=>{const a=(0,Pa.YL)({...j,[Pa.vh.summaryTab]:e});return(0,d.jsx)(N.N_,{to:a,className:Qx("tab"),children:t},e)},allowNotSelected:!0}),g===S.ml.schema&&(0,d.jsx)(Hx,{})]})})},P=()=>{switch(g){case S.ml.acl:return(0,d.jsx)(px,{path:s,database:a});case S.ml.schema:return(0,d.jsx)(Zt,{type:e,path:s,tenantName:a});default:return(()=>{var e;if(!E)return;const{CreateStep:t,PathType:a,PathSubType:r,PathId:i,PathVersion:o}=E,l=[],c=Ix(s,a)?"Domain":null===a||void 0===a?void 0:a.replace(/^EPathType/,"");l.push({name:Ux("field_type"),content:c}),r!==Ze.EPathSubTypeEmpty&&l.push({name:Ux("field_subtype"),content:null===r||void 0===r?void 0:r.replace(/^EPathSubType/,"")}),l.push({name:Ux("field_id"),content:i}),l.push({name:Ux("field_version"),content:o}),Number(t)&&l.push({name:Ux("field_created"),content:(0,q.r6)(t)});const{PathDescription:u}=T;if(null!==u&&void 0!==u&&u.TableStats){const{DataSize:e,RowCount:t}=u.TableStats;l.push({name:Ux("field_data-size"),content:xs(e)},{name:Ux("field_row-count"),content:(0,q.ZV)(t)})}const m=()=>{var e;const{PathsInside:t,ShardsInside:a,PathsLimit:n,ShardsLimit:s}=null!==(e=null===u||void 0===u?void 0:u.DomainDescription)&&void 0!==e?e:{};let r=(0,q.ZV)(t),i=(0,q.ZV)(a);return r&&n&&(r=`${r} / ${(0,q.ZV)(n)}`),i&&s&&(i=`${i} / ${(0,q.ZV)(s)}`),[{name:Ux("field_paths"),content:r},{name:Ux("field_shards"),content:i}]},p={[Ye.EPathTypeInvalid]:void 0,[Ye.EPathTypeDir]:void 0,[Ye.EPathTypeResourcePool]:void 0,[Ye.EPathTypeTable]:()=>{var e;return[{name:Ux("field_partitions"),content:null===u||void 0===u||null===(e=u.TablePartitions)||void 0===e?void 0:e.length}]},[Ye.EPathTypeSubDomain]:m,[Ye.EPathTypeTableIndex]:void 0,[Ye.EPathTypeExtSubDomain]:m,[Ye.EPathTypeColumnStore]:()=>{var e,t;return[{name:Ux("field_partitions"),content:null===u||void 0===u||null===(e=u.ColumnStoreDescription)||void 0===e||null===(t=e.ColumnShards)||void 0===t?void 0:t.length}]},[Ye.EPathTypeColumnTable]:()=>{var e,t,a;return[{name:Ux("field_partitions"),content:null===u||void 0===u||null===(e=u.ColumnTableDescription)||void 0===e||null===(t=e.Sharding)||void 0===t||null===(a=t.ColumnShards)||void 0===a?void 0:a.length}]},[Ye.EPathTypeCdcStream]:()=>{const{Mode:e,Format:t}=(null===u||void 0===u?void 0:u.CdcStreamDescription)||{};return[{name:Ux("field_mode"),content:null===e||void 0===e?void 0:e.replace(/^ECdcStreamMode/,"")},{name:Ux("field_format"),content:null===t||void 0===t?void 0:t.replace(/^ECdcStreamFormat/,"")}]},[Ye.EPathTypePersQueueGroup]:()=>{var e,t,a;const n=null===u||void 0===u?void 0:u.PersQueueGroup,s=null===n||void 0===n||null===(e=n.PQTabletConfig)||void 0===e||null===(t=e.PartitionConfig)||void 0===t?void 0:t.LifetimeSeconds;return[{name:Ux("field_partitions"),content:null===n||void 0===n||null===(a=n.Partitions)||void 0===a?void 0:a.length},{name:Ux("field_retention"),content:s&&(0,q.Pt)(s)}]},[Ye.EPathTypeExternalTable]:()=>{var e,t;const a=(0,U.Ow)({...j,schema:null===u||void 0===u||null===(e=u.ExternalTableDescription)||void 0===e?void 0:e.DataSourcePath}),{SourceType:n,DataSourcePath:s}=(null===u||void 0===u?void 0:u.ExternalTableDescription)||{},r=(null===s||void 0===s||null===(t=s.match(/([^/]*)\/*$/))||void 0===t?void 0:t[1])||"";return[{name:Ux("field_source-type"),content:n},{name:Ux("field_data-source"),content:s&&(0,d.jsx)("span",{title:s,children:(0,d.jsx)(Fs.K,{title:r||"",url:a})})}]},[Ye.EPathTypeExternalDataSource]:()=>{var e;return[{name:Ux("field_source-type"),content:null===u||void 0===u||null===(e=u.ExternalDataSourceDescription)||void 0===e?void 0:e.SourceType}]},[Ye.EPathTypeView]:void 0,[Ye.EPathTypeReplication]:()=>{var e;const t=null===u||void 0===u||null===(e=u.ReplicationDescription)||void 0===e?void 0:e.State;return t?[{name:Ux("field_state"),content:(0,d.jsx)(Xs,{state:t})}]:[]},[Ye.EPathTypeTransfer]:()=>{var e;const t=null===u||void 0===u||null===(e=u.ReplicationDescription)||void 0===e?void 0:e.State;return t?[{name:Ux("field_state"),content:(0,d.jsx)(Xs,{state:t})}]:[]}},h=a&&(null===(e=p[a])||void 0===e?void 0:e.call(p))||[];l.push(...h);const v=l.filter((e=>e.content)).map((e=>({...e,content:(0,d.jsx)("div",{className:Qx("overview-item-content"),children:e.content})})));return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)("div",{className:Qx("overview-title"),children:(0,d.jsx)(br,{data:u})}),(0,d.jsx)(bp.u,{responsive:!0,children:v.map((e=>(0,d.jsx)(bp.u.Item,{name:e.name,children:e.content},e.name)))})]})})()}},I=()=>{v(Eh.triggerCollapse)},D=()=>{v(Eh.triggerExpand)},A=()=>{v(Eh.clear)},R=Px(s,a),k=()=>{const a=ct(e)&&!ut(t);return(0,d.jsxs)(n.Fragment,{children:[a&&fx(u,{setActivePath:m},"m")(s,"preview"),(0,d.jsx)(cn.b,{text:R,view:"flat-secondary",title:Ux("action_copySchemaPath")}),(0,d.jsx)(_h,{onCollapse:I,onExpand:D,isCollapsed:p.collapsed,initialDirection:"bottom"})]})},O=()=>{const{Status:t,Reason:a}=null!==T&&void 0!==T?T:{};if(e){let t=e.replace("EPathType","");return Ix(s,e)&&(t="domain"),(0,d.jsx)("div",{className:Qx("entity-type"),children:t})}let n;return t&&a&&(n=`${t}: ${a}`),(0,d.jsx)("div",{className:Qx("entity-type",{error:!0}),children:(0,d.jsx)(Ia.B,{content:n,offset:{left:0}})})};return(0,d.jsx)(Lx,{children:(0,d.jsxs)("div",{className:Qx(),children:[(0,d.jsx)("div",{className:Qx({hidden:l}),children:(0,d.jsxs)(h,{direction:"vertical",defaultSizePaneKey:f.ED,onSplitStartDragAdditional:A,triggerCollapse:p.triggerCollapse,triggerExpand:p.triggerExpand,minSize:[200,52],collapsedSizes:[100,0],children:[(0,d.jsx)($x,{tenantName:a,path:s}),(0,d.jsxs)("div",{className:Qx("info"),children:[(0,d.jsxs)("div",{className:Qx("sticky-top"),children:[(0,d.jsxs)("div",{className:Qx("info-header"),children:[(0,d.jsxs)("div",{className:Qx("info-title"),children:[O(),(0,d.jsx)("div",{className:Qx("path-name"),children:R})]}),(0,d.jsx)("div",{className:Qx("info-controls"),children:k()})]}),C()]}),(0,d.jsx)("div",{className:Qx("overview-wrapper"),children:P()})]})]})}),(0,d.jsxs)(_e.s,{className:Qx("actions"),gap:.5,children:[!l&&(0,d.jsx)(Vx,{}),(0,d.jsx)(_h,{onCollapse:i,onExpand:o,isCollapsed:l,initialDirection:"left"})]})]})})}const Yx=(0,c.cn)("tenant-page"),Zx=()=>({triggerExpand:!1,triggerCollapse:!1,collapsed:Boolean(localStorage.getItem(f.jX))});function Xx(e){var t,l,c,u,m,p,g,T,S,w;const[N,E]=n.useReducer(Ih(f.jX),void 0,Zx),[{database:C,name:P,schema:I},D]=(0,r.useQueryParams)({database:r.StringParam,name:r.StringParam,schema:r.StringParam});n.useEffect((()=>{P&&!C&&D({database:P,name:void 0},"replaceIn")}),[C,P,D]);const _=null!==C&&void 0!==C?C:P;if(!_)throw new Error("Tenant name is not defined");const A=n.useRef();n.useEffect((()=>{if(A.current!==_){(async()=>{const{registerYQLCompletionItemProvider:e}=await a.e(50245).then(a.bind(a,50245));e(_)})().catch(console.error),A.current=_}}),[_]);const R=(0,b.YQ)();n.useEffect((()=>{R((0,v.g)("tenant",{tenantName:_}))}),[_,R]);const k=null!==I&&void 0!==I?I:_,{currentData:O,error:M,isLoading:L}=y.useGetOverviewQuery({path:k,database:_}),q=(0,b.N4)((e=>(0,x.Tp)(e,k,_))),z=null!==(t=null===O||void 0===O||null===(l=O.PathDescription)||void 0===l||null===(c=l.Self)||void 0===c?void 0:c.PathType)&&void 0!==t?t:null===q||void 0===q||null===(u=q.PathDescription)||void 0===u||null===(m=u.Self)||void 0===m?void 0:m.PathType,F=null!==(p=null===O||void 0===O||null===(g=O.PathDescription)||void 0===g||null===(T=g.Self)||void 0===T?void 0:T.PathSubType)&&void 0!==p?p:null===q||void 0===q||null===(S=q.PathDescription)||void 0===S||null===(w=S.Self)||void 0===w?void 0:w.PathSubType,U=(0,j.Pq)(M),[Q,$]=n.useState(!0);Q&&!L&&$(!1);const B=k||fr("page.title");return(0,d.jsxs)("div",{className:Yx(),children:[(0,d.jsx)(s.mg,{defaultTitle:`${B} \u2014 YDB Monitoring`,titleTemplate:`%s \u2014 ${B} \u2014 YDB Monitoring`}),(0,d.jsx)(o.r,{loading:Q,children:(0,d.jsx)(i.A,{error:U?M:void 0,children:(0,d.jsxs)(h,{defaultSizePaneKey:f.jQ,defaultSizes:[25,75],triggerCollapse:N.triggerCollapse,triggerExpand:N.triggerExpand,minSize:[36,200],onSplitStartDragAdditional:()=>{E(Eh.clear)},children:[(0,d.jsx)(Kx,{type:z,subType:F,tenantName:_,path:k,onCollapseSummary:()=>{E(Eh.triggerCollapse)},onExpandSummary:()=>{E(Eh.triggerExpand)},isCollapsed:N.collapsed}),(0,d.jsx)("div",{className:Yx("main"),children:(0,d.jsx)(ax,{type:z,subType:F,additionalTenantProps:e.additionalTenantProps,additionalNodesProps:e.additionalNodesProps,tenantName:_,path:k})})]})})})]})}},52246:()=>{},52248:(e,t,a)=>{"use strict";a.d(t,{a:()=>n.a});var n=a(47334)},66574:()=>{},71635:(e,t,a)=>{"use strict";a.d(t,{C:()=>y});var n=a(44992),s=a(53850),r=a(62060),i=a.n(r),o=a(21334),l=a(24600);const c=o.F.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.viewer.getTabletsInfo(e,{signal:t})}}catch(a){return{error:a}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),d=(0,s.Mz)((e=>e),(e=>c.endpoints.getTabletsInfo.select(e)),{argsMemoize:s.i5,argsMemoizeOptions:{equalityCheck:i()}}),u=(0,s.Mz)((e=>e),((e,t)=>d(t)),((e,t)=>t(e).data)),m=(0,s.Mz)(((e,t)=>u(e,t)),(e=>(0,l.K)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{var a;const n=void 0===e.NodeId||null===(a=t.get(e.NodeId))||void 0===a?void 0:a.Host;return{...e,fqdn:n}})):e.TabletStateInfo:[]));var p=a(7435),h=a(90182),v=a(88616),g=a(60712);function y({nodeId:e,path:t,database:a,onlyActive:s,scrollContainerRef:r}){const[i]=(0,h.Nt)();let o={};const l=s?"(State!=Dead)":void 0;(0,p.f8)(e)?o={nodeId:e,database:a,filter:l}:t&&(o={path:t,database:a,filter:l});const{isLoading:d,error:u}=c.useGetTabletsInfoQuery(0===Object.keys(o).length?n.hT:o,{pollingInterval:i}),y=(0,h.N4)((e=>m(e,o)));return(0,g.jsx)(v.Q,{scrollContainerRef:r,tablets:y,database:a,loading:d,error:u})}},79737:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,X:()=>l});var n=a(5874),s=a(77506),r=a(60712);const i=(0,s.cn)("ydb-table");function o({children:e,className:t}){return(0,r.jsx)("div",{className:i("table-header-content",t),children:e})}function l({className:e,width:t,wrapperClassName:a,...s}){return(0,r.jsx)("div",{className:i(null,a),children:(0,r.jsx)(n.W,{headerCellClassName:({column:e})=>{var t;const a=null===(t=e.columnDef.meta)||void 0===t?void 0:t.align;return i("table-header-cell",{align:a})},cellClassName:e=>{var t,a;const n=null===e||void 0===e||null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.align,s=null===e||void 0===e||null===(a=e.column.columnDef.meta)||void 0===a?void 0:a.verticalAlign;return i("table-cell",{align:n,"vertical-align":s})},className:i("table",{width:t},e),...s})})}},94695:(e,t,a)=>{"use strict";a.r(t),a.d(t,{YDBSyntaxHighlighter:()=>f});var n=a(59284),s=a(96873),r=a(97091),i=a(96298);const o=(0,a(48372).g4)("ydb-syntax-highlighter",{en:{copy:"Copy"}});const l=(0,a(77506).cn)("ydb-syntax-highlighter");var c=a(22680),d=a(32138),u=a(62422);const m={...d.A,'pre[class*="language-"]':{...d.A['pre[class*="language-"]'],background:"transparent",margin:0},'code[class*="language-"]':{...d.A['code[class*="language-"]'],background:"transparent",color:"var(--g-color-text-primary)",whiteSpace:"pre-wrap"},comment:{color:"#969896"},string:{color:"#a31515"},tablepath:{color:"#338186"},function:{color:"#7a3e9d"},udf:{color:"#7a3e9d"},type:{color:"#4d932d"},boolean:{color:"#608b4e"},constant:{color:"#608b4e"},variable:{color:"#001188"}},p={...u.A,'pre[class*="language-"]':{...u.A['pre[class*="language-"]'],background:"transparent",margin:0},'code[class*="language-"]':{...u.A['code[class*="language-"]'],background:"transparent",color:"var(--g-color-text-primary)",whiteSpace:"pre-wrap"},comment:{color:"#969896"},string:{color:"#ce9178"},tablepath:{color:"#338186"},function:{color:"#9e7bb0"},udf:{color:"#9e7bb0"},type:{color:"#6A8759"},boolean:{color:"#608b4e"},constant:{color:"#608b4e"},variable:{color:"#74b0df"}},h={...p,'pre[class*="language-"]':{...p['pre[class*="language-"]'],background:u.A['pre[class*="language-"]'].background,scrollbarColor:"var(--g-color-scroll-handle) transparent"},'code[class*="language-"]':{...p['code[class*="language-"]'],whiteSpace:"pre"}},v={...m,'pre[class*="language-"]':{...m['pre[class*="language-"]'],background:"var(--g-color-base-misc-light)",scrollbarColor:"var(--g-color-scroll-handle) transparent"},'code[class*="language-"]':{...m['code[class*="language-"]'],whiteSpace:"pre"}};var g=a(43733);function y(e){e.languages.yql={comment:[{pattern:/--.*$/m,greedy:!0},{pattern:/\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0}],tablepath:{pattern:/(`[\w/]+`\s*\.\s*)?`[^`]+`/,greedy:!0},string:[{pattern:/'(?:\\[\s\S]|[^\\'])*'/,greedy:!0},{pattern:/"(?:\\[\s\S]|[^\\"])*"/,greedy:!0},{pattern:/@@(?:[^@]|@(?!@))*@@/,greedy:!0}],variable:[{pattern:/\$[a-zA-Z_]\w*/,greedy:!0}],function:{pattern:new RegExp(`\\b(?:${g.XB.join("|")})\\b`,"i"),greedy:!0},keyword:{pattern:new RegExp(`\\b(?:${g.RE.join("|")})\\b`,"i"),greedy:!0},udf:{pattern:/[A-Za-z_]\w*::[A-Za-z_]\w*/,greedy:!0},type:{pattern:new RegExp(`\\b(?:${g.to.join("|")})\\b`,"i"),greedy:!0},boolean:{pattern:/\b(?:true|false|null)\b/i,greedy:!0},number:{pattern:/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/i,greedy:!0},operator:{pattern:/[-+*/%<>!=&|^~]+|\b(?:and|or|not|is|like|ilike|rlike|in|between)\b/i,greedy:!0},punctuation:{pattern:/[;[\](){}.,]/,greedy:!0}}}y.displayName="yql",y.aliases=["yql"];var x=a(60712);function f({text:e,language:t,className:d,transparentBackground:u=!0,withClipboardButton:g}){const[f,b]=n.useState(""),j=function(e){const t=(0,c.i)(),a="dark"===t||"dark-hc"===t;return e?a?p:m:a?h:v}(u);n.useEffect((()=>{!async function(){await async function(e){if("yql"===e)i.A.registerLanguage("yql",y);else{const{default:t}=await a(99648)(`./${e}`);i.A.registerLanguage(e,t)}}(t),b((0,r.Ak)())}()}),[t]);let T={};return g&&"object"===typeof g&&g.alwaysVisible&&(T=g.withLabel?{paddingRight:80}:{paddingRight:40}),(0,x.jsxs)("div",{className:l(null,d),children:[g?(0,x.jsx)("div",{className:l("sticky-container"),onClick:e=>e.stopPropagation(),children:(0,x.jsx)(s.b,{view:"flat-secondary",size:"s",className:l("copy",{visible:"object"===typeof g&&g.alwaysVisible}),text:"object"===typeof g&&g.copyText||e,children:"object"===typeof g&&!1===g.withLabel?null:o("copy")})}):null,(0,x.jsx)(i.A,{language:t,style:j,customStyle:{height:"100%",...T},children:e},f)]})}},99648:(e,t,a)=>{var n={"./":[84745,84745],"./abap":[67191,67191],"./abap.js":[67191,67191],"./abnf":[36754,36754],"./abnf.js":[36754,36754],"./actionscript":[69712,69712],"./actionscript.js":[69712,69712],"./ada":[87357,87357],"./ada.js":[87357,87357],"./agda":[61250,61250],"./agda.js":[61250,61250],"./al":[68220,68220],"./al.js":[68220,68220],"./antlr4":[73064,73064],"./antlr4.js":[73064,73064],"./apacheconf":[72401,72401],"./apacheconf.js":[72401,72401],"./apex":[94129,94129],"./apex.js":[94129,94129],"./apl":[98958,98958],"./apl.js":[98958,98958],"./applescript":[68990,68990],"./applescript.js":[68990,68990],"./aql":[84027,84027],"./aql.js":[84027,84027],"./arduino":[173,173],"./arduino.js":[173,173],"./arff":[82714,82714],"./arff.js":[82714,82714],"./asciidoc":[68818,68818],"./asciidoc.js":[68818,68818],"./asm6502":[1073,1073],"./asm6502.js":[1073,1073],"./asmatmel":[6197,6197],"./asmatmel.js":[6197,6197],"./aspnet":[55534,55534],"./aspnet.js":[55534,55534],"./autohotkey":[51400,51400],"./autohotkey.js":[51400,51400],"./autoit":[25007,25007],"./autoit.js":[25007,25007],"./avisynth":[80397,80397],"./avisynth.js":[80397,80397],"./avro-idl":[44391,44391],"./avro-idl.js":[44391,44391],"./bash":[80719,80719],"./bash.js":[80719,80719],"./basic":[51255,51255],"./basic.js":[51255,51255],"./batch":[85393,85393],"./batch.js":[85393,85393],"./bbcode":[78112,78112],"./bbcode.js":[78112,78112],"./bicep":[86814,86814],"./bicep.js":[86814,86814],"./birb":[66824,66824],"./birb.js":[66824,66824],"./bison":[11338,11338],"./bison.js":[11338,11338],"./bnf":[80555,80555],"./bnf.js":[80555,80555],"./brainfuck":[3534,3534],"./brainfuck.js":[3534,3534],"./brightscript":[9426,9426],"./brightscript.js":[9426,9426],"./bro":[91880,91880],"./bro.js":[91880,91880],"./bsl":[40388,40388],"./bsl.js":[40388,40388],"./c":[4664,4664],"./c.js":[4664,4664],"./cfscript":[79247,79247],"./cfscript.js":[79247,79247],"./chaiscript":[75523,75523],"./chaiscript.js":[75523,75523],"./cil":[99753,99753],"./cil.js":[99753,99753],"./clike":[31423,31423],"./clike.js":[31423,31423],"./clojure":[21989,21989],"./clojure.js":[21989,21989],"./cmake":[9930,9930],"./cmake.js":[9930,9930],"./cobol":[30226,30226],"./cobol.js":[30226,30226],"./coffeescript":[85622,85622],"./coffeescript.js":[85622,85622],"./concurnas":[30229,30229],"./concurnas.js":[30229,30229],"./coq":[25604,25604],"./coq.js":[25604,25604],"./core":[44846,44846],"./core.js":[44846,44846],"./cpp":[81571,81571],"./cpp.js":[81571,81571],"./crystal":[61747,61747],"./crystal.js":[61747,61747],"./csharp":[46306,46306],"./csharp.js":[46306,46306],"./cshtml":[17830,17830],"./cshtml.js":[17830,17830],"./csp":[23039,23039],"./csp.js":[23039,23039],"./css":[16242,16242],"./css-extras":[93696,93696],"./css-extras.js":[93696,93696],"./css.js":[16242,16242],"./csv":[7773,7773],"./csv.js":[7773,7773],"./cypher":[74394,74394],"./cypher.js":[74394,74394],"./d":[45517,45517],"./d.js":[45517,45517],"./dart":[79204,79204],"./dart.js":[79204,79204],"./dataweave":[62595,62595],"./dataweave.js":[62595,62595],"./dax":[31584,31584],"./dax.js":[31584,31584],"./dhall":[5254,5254],"./dhall.js":[5254,5254],"./diff":[73026,73026],"./diff.js":[73026,73026],"./django":[14382,14382],"./django.js":[14382,14382],"./dns-zone-file":[72188,72188],"./dns-zone-file.js":[72188,72188],"./docker":[6785,6785],"./docker.js":[6785,6785],"./dot":[59786,59786],"./dot.js":[59786,59786],"./ebnf":[55990,55990],"./ebnf.js":[55990,55990],"./editorconfig":[71266,71266],"./editorconfig.js":[71266,71266],"./eiffel":[93890,93890],"./eiffel.js":[93890,93890],"./ejs":[59605,59605],"./ejs.js":[59605,59605],"./elixir":[87138,87138],"./elixir.js":[87138,87138],"./elm":[88269,88269],"./elm.js":[88269,88269],"./erb":[69854,69854],"./erb.js":[69854,69854],"./erlang":[13470,13470],"./erlang.js":[13470,13470],"./etlua":[42912,42912],"./etlua.js":[42912,42912],"./excel-formula":[54861,54861],"./excel-formula.js":[54861,54861],"./factor":[16038,16038],"./factor.js":[16038,16038],"./false":[58666,58666],"./false.js":[58666,58666],"./firestore-security-rules":[66809,66809],"./firestore-security-rules.js":[66809,66809],"./flow":[80017,80017],"./flow.js":[80017,80017],"./fortran":[2251,2251],"./fortran.js":[2251,2251],"./fsharp":[85623,85623],"./fsharp.js":[85623,85623],"./ftl":[93691,93691],"./ftl.js":[93691,93691],"./gap":[35569,35569],"./gap.js":[35569,35569],"./gcode":[74729,74729],"./gcode.js":[74729,74729],"./gdscript":[91545,91545],"./gdscript.js":[91545,91545],"./gedcom":[69500,69500],"./gedcom.js":[69500,69500],"./gherkin":[15931,15931],"./gherkin.js":[15931,15931],"./git":[3061,3061],"./git.js":[3061,3061],"./glsl":[16097,16097],"./glsl.js":[16097,16097],"./gml":[72737,72737],"./gml.js":[72737,72737],"./gn":[2656,2656],"./gn.js":[2656,2656],"./go":[1431,1431],"./go-module":[88432,88432],"./go-module.js":[88432,88432],"./go.js":[1431,1431],"./graphql":[71588,71588],"./graphql.js":[71588,71588],"./groovy":[92551,92551],"./groovy.js":[92551,92551],"./haml":[4243,4243],"./haml.js":[4243,4243],"./handlebars":[22609,22609],"./handlebars.js":[22609,22609],"./haskell":[37677,37677],"./haskell.js":[37677,37677],"./haxe":[29193,29193],"./haxe.js":[29193,29193],"./hcl":[44866,44866],"./hcl.js":[44866,44866],"./hlsl":[24458,24458],"./hlsl.js":[24458,24458],"./hoon":[58457,58457],"./hoon.js":[58457,58457],"./hpkp":[3738,3738],"./hpkp.js":[3738,3738],"./hsts":[82505,82505],"./hsts.js":[82505,82505],"./http":[20053,20053],"./http.js":[20053,20053],"./ichigojam":[32670,32670],"./ichigojam.js":[32670,32670],"./icon":[92868,92868],"./icon.js":[92868,92868],"./icu-message-format":[88810,88810],"./icu-message-format.js":[88810,88810],"./idris":[93672,93672],"./idris.js":[93672,93672],"./iecst":[83005,83005],"./iecst.js":[83005,83005],"./ignore":[37747,37747],"./ignore.js":[37747,37747],"./index":[84745,84745],"./index.js":[84745,84745],"./inform7":[81327,81327],"./inform7.js":[81327,81327],"./ini":[61387,61387],"./ini.js":[61387,61387],"./io":[28125,28125],"./io.js":[28125,28125],"./j":[9511,9511],"./j.js":[9511,9511],"./java":[56421,56421],"./java.js":[56421,56421],"./javadoc":[85595,85595],"./javadoc.js":[85595,85595],"./javadoclike":[52036,52036],"./javadoclike.js":[52036,52036],"./javascript":[29866,29866],"./javascript.js":[29866,29866],"./javastacktrace":[83012,83012],"./javastacktrace.js":[83012,83012],"./jexl":[95264,95264],"./jexl.js":[95264,95264],"./jolie":[56026,56026],"./jolie.js":[56026,56026],"./jq":[62888,40507],"./jq.js":[62888,40507],"./js-extras":[84960,84960],"./js-extras.js":[84960,84960],"./js-templates":[79972,79972],"./js-templates.js":[79972,79972],"./jsdoc":[10242,10242],"./jsdoc.js":[10242,10242],"./json":[82315,82315],"./json.js":[82315,82315],"./json5":[57320,57320],"./json5.js":[57320,57320],"./jsonp":[88987,88987],"./jsonp.js":[88987,88987],"./jsstacktrace":[91087,91087],"./jsstacktrace.js":[91087,91087],"./jsx":[10064,10064],"./jsx.js":[10064,10064],"./julia":[6528,6528],"./julia.js":[6528,6528],"./keepalived":[29043,29043],"./keepalived.js":[29043,29043],"./keyman":[85776,85776],"./keyman.js":[85776,85776],"./kotlin":[85664,85664],"./kotlin.js":[85664,85664],"./kumir":[29461,29461],"./kumir.js":[29461,29461],"./kusto":[4617,4617],"./kusto.js":[4617,4617],"./latex":[30573,30573],"./latex.js":[30573,30573],"./latte":[84307,84307],"./latte.js":[84307,84307],"./less":[17880,17880],"./less.js":[17880,17880],"./lilypond":[23882,23882],"./lilypond.js":[23882,23882],"./liquid":[50045,50045],"./liquid.js":[50045,50045],"./lisp":[81869,81869],"./lisp.js":[81869,81869],"./livescript":[90504,90504],"./livescript.js":[90504,90504],"./llvm":[47472,47472],"./llvm.js":[47472,47472],"./log":[68527,68527],"./log.js":[68527,68527],"./lolcode":[98559,98559],"./lolcode.js":[98559,98559],"./lua":[71515,71515],"./lua.js":[71515,71515],"./magma":[33436,33436],"./magma.js":[33436,33436],"./makefile":[9177,9177],"./makefile.js":[9177,9177],"./markdown":[43028,43028],"./markdown.js":[43028,43028],"./markup":[66593,66593],"./markup-templating":[73863,73863],"./markup-templating.js":[73863,73863],"./markup.js":[66593,66593],"./matlab":[72020,72020],"./matlab.js":[72020,72020],"./maxscript":[42396,42396],"./maxscript.js":[42396,42396],"./mel":[16795,16795],"./mel.js":[16795,16795],"./mermaid":[35958,35958],"./mermaid.js":[35958,35958],"./mizar":[73442,73442],"./mizar.js":[73442,73442],"./mongodb":[5411,5411],"./mongodb.js":[5411,5411],"./monkey":[49788,49788],"./monkey.js":[49788,49788],"./moonscript":[4887,4887],"./moonscript.js":[4887,4887],"./n1ql":[25101,25101],"./n1ql.js":[25101,25101],"./n4js":[57708,57708],"./n4js.js":[57708,57708],"./nand2tetris-hdl":[78710,78710],"./nand2tetris-hdl.js":[78710,78710],"./naniscript":[70190,70190],"./naniscript.js":[70190,70190],"./nasm":[92008,92008],"./nasm.js":[92008,92008],"./neon":[90529,90529],"./neon.js":[90529,90529],"./nevod":[93771,93771],"./nevod.js":[93771,93771],"./nginx":[68377,68377],"./nginx.js":[68377,68377],"./nim":[31177,31177],"./nim.js":[31177,31177],"./nix":[16758,16758],"./nix.js":[16758,16758],"./nsis":[19702,19702],"./nsis.js":[19702,19702],"./objectivec":[34693,34693],"./objectivec.js":[34693,34693],"./ocaml":[89033,89033],"./ocaml.js":[89033,89033],"./opencl":[38718,38718],"./opencl.js":[38718,38718],"./openqasm":[76603,76603],"./openqasm.js":[76603,76603],"./oz":[72788,72788],"./oz.js":[72788,72788],"./parigp":[92816,92816],"./parigp.js":[92816,92816],"./parser":[63782,63782],"./parser.js":[63782,63782],"./pascal":[39705,39705],"./pascal.js":[39705,39705],"./pascaligo":[20600,20600],"./pascaligo.js":[20600,20600],"./pcaxis":[54597,54597],"./pcaxis.js":[54597,54597],"./peoplecode":[42791,42791],"./peoplecode.js":[42791,42791],"./perl":[34156,34156],"./perl.js":[34156,34156],"./php":[30249,30249],"./php-extras":[9493,9493],"./php-extras.js":[9493,9493],"./php.js":[30249,30249],"./phpdoc":[26327,26327],"./phpdoc.js":[26327,26327],"./plsql":[52541,52541],"./plsql.js":[52541,52541],"./powerquery":[90330,90330],"./powerquery.js":[90330,90330],"./powershell":[17500,17500],"./powershell.js":[17500,17500],"./processing":[5530,5530],"./processing.js":[5530,5530],"./prolog":[63025,85406],"./prolog.js":[63025,85406],"./promql":[1146,1146],"./promql.js":[1146,1146],"./properties":[47108,47108],"./properties.js":[47108,47108],"./protobuf":[81014,81014],"./protobuf.js":[81014,81014],"./psl":[96410,96410],"./psl.js":[96410,96410],"./pug":[54781,54781],"./pug.js":[54781,54781],"./puppet":[51159,51159],"./puppet.js":[51159,51159],"./pure":[26411,26411],"./pure.js":[26411,26411],"./purebasic":[57469,57469],"./purebasic.js":[57469,57469],"./purescript":[10132,10132],"./purescript.js":[10132,10132],"./python":[81243,81243],"./python.js":[81243,81243],"./q":[4018,4018],"./q.js":[4018,4018],"./qml":[19791,19791],"./qml.js":[19791,19791],"./qore":[81940,81940],"./qore.js":[81940,81940],"./qsharp":[60464,60464],"./qsharp.js":[60464,60464],"./r":[10815,10815],"./r.js":[10815,10815],"./racket":[90367,90367],"./racket.js":[90367,90367],"./reason":[65633,65633],"./reason.js":[65633,65633],"./regex":[56054,56054],"./regex.js":[56054,56054],"./rego":[94102,94102],"./rego.js":[94102,94102],"./renpy":[42111,42111],"./renpy.js":[42111,42111],"./rest":[34119,34119],"./rest.js":[34119,34119],"./rip":[70858,70858],"./rip.js":[70858,70858],"./roboconf":[54651,54651],"./roboconf.js":[54651,54651],"./robotframework":[10525,10525],"./robotframework.js":[10525,10525],"./ruby":[17981,17981],"./ruby.js":[17981,17981],"./rust":[8215,8215],"./rust.js":[8215,8215],"./sas":[21996,21996],"./sas.js":[21996,21996],"./sass":[71107,71107],"./sass.js":[71107,71107],"./scala":[30499,30499],"./scala.js":[30499,30499],"./scheme":[4554,4554],"./scheme.js":[4554,4554],"./scss":[96017,96017],"./scss.js":[96017,96017],"./shell-session":[56174,56174],"./shell-session.js":[56174,56174],"./smali":[3149,3149],"./smali.js":[3149,3149],"./smalltalk":[86472,86472],"./smalltalk.js":[86472,86472],"./smarty":[87429,87429],"./smarty.js":[87429,87429],"./sml":[37605,37605],"./sml.js":[37605,37605],"./solidity":[54520,54520],"./solidity.js":[54520,54520],"./solution-file":[61741,61741],"./solution-file.js":[61741,61741],"./soy":[47660,47660],"./soy.js":[47660,47660],"./sparql":[57016,57016],"./sparql.js":[57016,57016],"./splunk-spl":[19026,19026],"./splunk-spl.js":[19026,19026],"./sqf":[20535,20535],"./sqf.js":[20535,20535],"./sql":[87233,87233],"./sql.js":[87233,87233],"./squirrel":[65206,65206],"./squirrel.js":[65206,65206],"./stan":[29769,29769],"./stan.js":[29769,29769],"./stylus":[55651,55651],"./stylus.js":[55651,55651],"./supported-languages":[70289,70289],"./supported-languages.js":[70289,70289],"./swift":[46134,46134],"./swift.js":[46134,46134],"./systemd":[9614,9614],"./systemd.js":[9614,9614],"./t4-cs":[71672,71672],"./t4-cs.js":[71672,71672],"./t4-templating":[84587,84587],"./t4-templating.js":[84587,84587],"./t4-vb":[5282,5282],"./t4-vb.js":[5282,5282],"./tap":[83896,83896],"./tap.js":[83896,83896],"./tcl":[27950,27950],"./tcl.js":[27950,27950],"./textile":[42384,42384],"./textile.js":[42384,42384],"./toml":[37385,37385],"./toml.js":[37385,37385],"./tremor":[55528,55528],"./tremor.js":[55528,55528],"./tsx":[30850,30850],"./tsx.js":[30850,30850],"./tt2":[82399,82399],"./tt2.js":[82399,82399],"./turtle":[70695,70695],"./turtle.js":[70695,70695],"./twig":[98268,98268],"./twig.js":[98268,98268],"./typescript":[82066,82066],"./typescript.js":[82066,82066],"./typoscript":[3980,3980],"./typoscript.js":[3980,3980],"./unrealscript":[47153,47153],"./unrealscript.js":[47153,47153],"./uorazor":[56761,56761],"./uorazor.js":[56761,56761],"./uri":[83075,83075],"./uri.js":[83075,83075],"./v":[50875,50875],"./v.js":[50875,50875],"./vala":[42615,42615],"./vala.js":[42615,42615],"./vbnet":[21742,21742],"./vbnet.js":[21742,21742],"./velocity":[48914,48914],"./velocity.js":[48914,48914],"./verilog":[37963,37963],"./verilog.js":[37963,37963],"./vhdl":[80067,80067],"./vhdl.js":[80067,80067],"./vim":[67105,67105],"./vim.js":[67105,67105],"./visual-basic":[94810,94810],"./visual-basic.js":[94810,94810],"./warpscript":[11192,11192],"./warpscript.js":[11192,11192],"./wasm":[99341,99341],"./wasm.js":[99341,99341],"./web-idl":[5393,5393],"./web-idl.js":[5393,5393],"./wiki":[91249,91249],"./wiki.js":[91249,91249],"./wolfram":[19233,19233],"./wolfram.js":[19233,19233],"./wren":[89015,89015],"./wren.js":[89015,89015],"./xeora":[97440,97440],"./xeora.js":[97440,97440],"./xml-doc":[52527,52527],"./xml-doc.js":[52527,52527],"./xojo":[35803,35803],"./xojo.js":[35803,35803],"./xquery":[69997,69997],"./xquery.js":[69997,69997],"./yaml":[84578,84578],"./yaml.js":[84578,84578],"./yang":[35596,35596],"./yang.js":[35596,35596],"./zig":[43979,43979],"./zig.js":[43979,43979]};function s(e){if(!a.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],s=t[0];return a.e(t[1]).then((()=>a(s)))}s.keys=()=>Object.keys(n),s.id=99648,e.exports=s}}]);