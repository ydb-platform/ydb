"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[31381],{9252:(e,t,n)=>{n.d(t,{k:()=>l});var r=n(44433),a=n(88610),o=n(60712);const l=({value:e,onChange:t,className:n})=>(0,o.jsxs)(r.a,{value:e,onUpdate:t,className:n,children:[(0,o.jsx)(r.a.Option,{value:a.s$.ALL,children:a.s$.ALL}),(0,o.jsx)(r.a.Option,{value:a.s$.PROBLEMS,children:a.s$.PROBLEMS})]})},11363:(e,t,n)=>{n.d(t,{G:()=>oe});var r=n(59284),a=n(86782),o=n(12888),l=n(98167),s=n(67028),i=n(69063),d=n(88610);function u(){const e=(0,i.YQ)();return{problemFilter:(0,i.N4)(d.yV),handleProblemFilterChange:t=>{e((0,d.$u)(t))}}}var c=n(78034),p=n(80987),m=n(48372);const h=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),g=(0,m.g4)("ydb-nodes",{en:h}),b=["database","static","other","any"],y={get database(){return g("database")},get static(){return g("static")},get other(){return g("other")},get any(){return g("any")}};const v="nodesTableSelectedColumns",x=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],f=["NodeId"],w=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function C(e,t){return t?e:e.filter((e=>"SystemState"!==e))}function N(e){var t;const[n,r]=(0,p.useQueryParams)({uptimeFilter:p.StringParam,peerRole:p.StringParam,search:p.StringParam,nodesGroupBy:p.StringParam}),a=c.Bm.parse(n.uptimeFilter),o=null!==(t=n.search)&&void 0!==t?t:"",l=(i=n.peerRole,b.find((e=>e===i)));var i;const d=(0,s.DM)(),u=function(e,t,n){return C(t,n).find((t=>t===e))}(n.nodesGroupBy,null!==e&&void 0!==e?e:[],d);return{uptimeFilter:a,searchValue:o,peerRoleFilter:l,groupByParam:u,handleSearchQueryChange:e=>{r({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{r({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{r({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{r({nodesGroupBy:e},"replaceIn")}}}var j=n(44508),S=n(42265),T=n(15298),F=n(43951),I=n(71708),R=n(62710),P=n(98089),_=n(69775),A=n(24555),B=n(28539),k=n(9252),G=n(95963),E=n(64934),D=n(44433),L=n(60712);function O({value:e="database",onChange:t}){return(0,L.jsx)(D.a,{value:e,onUpdate:t,children:b.map((e=>(0,L.jsx)(D.a.Option,{value:e,children:y[e]},e)))})}const U=(0,n(77506).cn)("ydb-nodes"),q=e=>U("node",{unavailable:(0,c.X7)(e)});function H({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:n,columnsToSelect:o,handleSelectedColumnsUpdate:l,entitiesCountCurrent:i,entitiesCountTotal:d,entitiesLoading:c}){const{searchValue:p,uptimeFilter:m,peerRoleFilter:h,groupByParam:b,handleSearchQueryChange:y,handleUptimeFilterChange:v,handlePeerRoleFilterChange:x,handleGroupByParamChange:f}=N(t),{problemFilter:w,handleProblemFilterChange:j}=u(),S=(0,s.DM)(),T=function(e,t){return C(e,t).map((e=>({value:e,content:(0,a.kn)(e)})))}(t,S),F=(0,s.WF)(),I=n&&F;return(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(G.v,{onChange:y,placeholder:g("controls_search-placeholder"),width:238,value:p}),S&&e?null:(0,L.jsx)(k.k,{value:w,onChange:j}),e?null:(0,L.jsx)(E.j,{value:m,onChange:v}),I?(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(P.E,{variant:"body-2",children:g("controls_peer-role-label")}),(0,L.jsx)(O,{value:h,onChange:x})]}):null,(0,L.jsx)(_.O,{popupWidth:200,items:o,showStatus:!0,onUpdate:l,sortable:!1}),e?(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(P.E,{variant:"body-2",children:g("controls_group-by-placeholder")}),(0,L.jsx)(A.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:b?[b]:void 0,onUpdate:e=>{f(e[0])},options:T,className:U("group-by-select"),popupClassName:U("group-by-popup")})]}):null,(0,L.jsx)(B.T,{current:i,total:d,label:g("nodes"),loading:c})]})}var V=n(78524),$=n(62783),M=n(81101),W=n(11906),z=n(69464),K=n(40781);const Q=async e=>{const{type:t="any",storage:n=!1,limit:r,offset:o,sortParams:l,filters:s,columnsIds:i}=e,{sortOrder:d,columnId:u}=null!==l&&void 0!==l?l:{},{path:p,database:m,searchValue:h,problemFilter:g,uptimeFilter:b,peerRoleFilter:y,filterGroup:v,filterGroupBy:x}=null!==s&&void 0!==s?s:{},f=(0,a.kU)(u),w=f?(0,z.T)(f,d):void 0,C=(0,K.R)(i,a.fN),N=await window.api.viewer.getNodes({type:t,storage:n,limit:r,offset:o,sort:w,path:p,database:m,filter:h,problems_only:(0,c.AB)(g),uptime:(0,c.Fo)(b),filter_peer_role:y,filter_group:v,filter_group_by:x,fieldsRequired:C}),j=(0,W.N)(N);return{data:j.Nodes||[],found:j.FoundNodes||0,total:j.TotalNodes||0}};function Y({path:e,database:t,searchValue:n,problemFilter:o,uptimeFilter:l,peerRoleFilter:s,filterGroup:i,filterGroupBy:d,columns:u,scrollContainerRef:p,initialEntitiesCount:m}){const h=r.useMemo((()=>({path:e,database:t,searchValue:n,problemFilter:o,uptimeFilter:l,peerRoleFilter:s,filterGroup:i,filterGroupBy:d})),[e,t,n,o,l,s,i,d]);return(0,L.jsx)($.k5,{columnsWidthLSKey:a.zO,scrollContainerRef:p,columns:u,fetchData:Q,initialEntitiesCount:m,renderErrorMessage:M.$,renderEmptyDataMessage:()=>"All"!==o||l!==c.cW.All?(0,L.jsx)(V.v,{name:"thumbsUp",width:"200"}):g("empty.default"),getRowClassName:q,filters:h,tableName:"nodes"})}const J=r.memo((function({name:e,count:t,isExpanded:n,path:r,database:a,searchValue:o,peerRoleFilter:l,groupByParam:s,columns:i,scrollContainerRef:d,onIsExpandedChange:u}){return(0,L.jsx)(I.Q,{title:e,count:t,entityName:g("nodes"),expanded:n,onIsExpandedChange:u,children:(0,L.jsx)(S.o,{initialState:{sortParams:void 0},table:(0,L.jsx)(Y,{path:r,database:a,searchValue:o,problemFilter:"All",uptimeFilter:c.cW.All,peerRoleFilter:l,filterGroup:e,filterGroupBy:s,initialEntitiesCount:t,columns:i,scrollContainerRef:d}),tableWrapperProps:{scrollContainerRef:d}})},e)}));function X({path:e,database:t,scrollContainerRef:n,withPeerRoleFilter:o,columns:l,defaultColumnsIds:s,requiredColumnsIds:d,selectedColumnsKey:u,groupByParams:c}){const{searchValue:p,peerRoleFilter:m,groupByParam:h}=N(c),[b]=(0,i.Nt)(),{columnsToShow:y,columnsToSelect:v,setColumns:x}=(0,F.K)(l,u,a.uG,s,d),{currentData:f,isFetching:w,error:C}=T.s.useGetNodesQuery({path:e,database:t,filter:p,filter_peer_role:m,group:h,limit:0},{pollingInterval:b}),I=void 0===f&&w,{NodeGroups:P,FoundNodes:_=0,TotalNodes:A=0}=f||{},{expandedGroups:B,setIsGroupExpanded:k}=(0,R.$)(P),G=r.useMemo((()=>({foundEntities:_,totalEntities:A,isInitialLoad:I,sortParams:void 0})),[_,A,I]);return(0,L.jsx)(S.o,{initialState:G,controls:(0,L.jsx)(H,{groupByParams:c,withPeerRoleFilter:o,columnsToSelect:v,handleSelectedColumnsUpdate:x,entitiesCountCurrent:_,entitiesCountTotal:A,entitiesLoading:I,withGroupBySelect:!0}),error:C?(0,L.jsx)(j.o,{error:C}):null,table:null!==P&&void 0!==P&&P.length?P.map((({name:r,count:a})=>{const o=B[r];return(0,L.jsx)(J,{name:r,count:a,isExpanded:o,path:e,database:t,searchValue:p,peerRoleFilter:m,groupByParam:h,columns:y,scrollContainerRef:n,onIsExpandedChange:k},r)})):g("no-nodes-groups"),tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[p,h,P,m],loading:I,className:U("groups-wrapper")}})}var Z=n(49554);function ee({withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:n,columnsToSelect:r,handleSelectedColumnsUpdate:a}){const{tableState:o}=(0,Z.WV)();return(0,L.jsx)(H,{withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:n,columnsToSelect:r,handleSelectedColumnsUpdate:a,entitiesCountCurrent:o.foundEntities,entitiesCountTotal:o.totalEntities,entitiesLoading:o.isInitialLoad})}function te({path:e,database:t,scrollContainerRef:n,withPeerRoleFilter:r,columns:o,defaultColumnsIds:l,requiredColumnsIds:i,selectedColumnsKey:d,groupByParams:c}){const{searchValue:p,uptimeFilter:m,peerRoleFilter:h}=N(c),{problemFilter:g}=u(),b=(0,s.Ye)(),{columnsToShow:y,columnsToSelect:v,setColumns:x}=(0,F.K)(o,d,a.uG,l,i);return(0,L.jsx)(S.o,{controls:(0,L.jsx)(ee,{withGroupBySelect:b,groupByParams:c,withPeerRoleFilter:r,columnsToSelect:v,handleSelectedColumnsUpdate:x}),table:(0,L.jsx)(Y,{path:e,database:t,searchValue:p,problemFilter:g,uptimeFilter:m,peerRoleFilter:h,columns:y,scrollContainerRef:n}),tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[p,g,m,h]}})}function ne(e){const{uptimeFilter:t,groupByParam:n,handleUptimeFilterChange:a}=N(e.groupByParams),{problemFilter:o,handleProblemFilterChange:i}=u(),d=(0,s.Pm)(),p=(0,s.Ye)();r.useEffect((()=>{!p||"All"===o&&t===c.cW.All||(i("All"),a(c.cW.All))}),[i,a,o,t,p]);return(0,L.jsx)(l.r,{loading:!d,children:p&&n?(0,L.jsx)(X,{...e}):(0,L.jsx)(te,{...e})})}var re=n(78762);function ae(e){return[(0,re._E)(),(0,re.Nh)(e),(0,re.eT)(),(0,re.uk)(),(0,re.OX)(),(0,re.jl)(),(0,re.fr)(),(0,re.kv)(),(0,re.pH)(),(0,re.iX)(),(0,re.ID)(),(0,re.Rn)(),(0,re.qp)(e)].map((e=>({...e,sortable:(0,a.sp)(e.name)})))}function oe({path:e,database:t,scrollContainerRef:n,additionalNodesProps:l,withPeerRoleFilter:s,columns:i=ae({database:t,getNodeRef:null===l||void 0===l?void 0:l.getNodeRef}),defaultColumnsIds:d=x,requiredColumnsIds:u=f,selectedColumnsKey:c=v,groupByParams:p=w}){const m=(0,o.X)(),h=r.useMemo((()=>m?i:i.filter((e=>!(0,a.xd)(e.name)))),[i,m]);return(0,L.jsx)(ne,{path:e,database:t,scrollContainerRef:n,withPeerRoleFilter:s,columns:h,defaultColumnsIds:d,requiredColumnsIds:u,selectedColumnsKey:c,groupByParams:p})}},11906:(e,t,n)=>{n.d(t,{N:()=>a});var r=n(78034);const a=e=>{var t;const n=(e.Nodes||[]).map((e=>{const{SystemState:t,...n}=e;return{...n,...(0,r.q1)(t)}}));return{Nodes:n,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||n.length,FoundNodes:Number(e.FoundNodes)}}},15298:(e,t,n)=>{n.d(t,{s:()=>o});var r=n(21334),a=n(11906);const o=r.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const n=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,a.N)(n)}}catch(n){return{error:n}}},providesTags:["All"]})}),overrideExisting:"throw"})},21545:(e,t,n)=>{n.d(t,{X:()=>a});var r=n(78034);const a=n(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:n},{signal:a})=>{try{const[o,l,s]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:n},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({signal:a})]),i=(0,r.nN)(s),d=Object.keys(l).reduce(((e,t)=>{var n;const r=null===(n=l[t])||void 0===n?void 0:n.TabletStateInfo;return null===r||void 0===r||r.forEach((n=>{var r;const{ChangeTime:a,Generation:o,State:l,Leader:s,FollowerId:d}=n,u=i&&t?null===(r=i.get(Number(t)))||void 0===r?void 0:r.Host:void 0;e.push({nodeId:t,generation:o,changeTime:a,state:l,leader:s,followerId:d,fqdn:u})})),e}),[]),{TabletStateInfo:u=[]}=o,c=void 0===n?u.find((e=>e.Leader)):u.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===n})),{TabletId:p}=c||{};return{data:{id:p,data:c,history:d}}}catch(o){return{error:o}}},providesTags:(e,t,n)=>["All",{type:"Tablet",id:n.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const n=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:r,PathId:a}=e;return{data:(null===n||void 0===n?void 0:n.Path)||`${r}:${a}`}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:n})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:n})}}catch(r){return{error:r}}},providesTags:(e,t,n)=>["All",{type:"Tablet",id:n.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,n)=>[{type:"Tablet",id:n.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(n){return{error:n}}},invalidatesTags:(e,t,n)=>[{type:"Tablet",id:n.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(n){return{error:n}}},invalidatesTags:(e,t,n)=>[{type:"Tablet",id:n.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,n)=>{n.d(t,{B:()=>d});var r=n(59284),a=n(84476),o=n(84375),l=n(55974),s=n(42829),i=n(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:n,dialogHeader:d,dialogText:u,retryButtonText:c,buttonDisabled:p=!1,buttonView:m="action",buttonTitle:h,buttonClassName:g,withPopover:b=!1,popoverContent:y,popoverPlacement:v="right",popoverDisabled:x=!0}){const[f,w]=r.useState(!1),[C,N]=r.useState(!1),[j,S]=r.useState(!1),T=()=>(0,i.jsx)(a.$,{onClick:()=>w(!0),view:m,disabled:p,loading:!p&&C,className:g,title:h,children:e});return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)(l.g,{visible:f,header:d,text:u,withRetry:j,retryButtonText:c,onConfirm:async e=>{N(!0),await t(e)},onConfirmActionSuccess:async()=>{S(!1);try{await(null===n||void 0===n?void 0:n())}finally{N(!1)}},onConfirmActionError:e=>{S((0,s.D)(e)),N(!1)},onClose:()=>{w(!1)}}),b?(0,i.jsx)(o.A,{content:y,placement:v,disabled:x,children:T()}):T()]})}},27775:(e,t,n)=>{n.d(t,{i:()=>l});var r=n(47665),a=n(58267),o=n(60712);function l({state:e}){return(0,o.jsx)(r.J,{theme:(0,a._)(e),children:e})}},28539:(e,t,n)=>{n.d(t,{T:()=>r.T});var r=n(53755)},37477:(e,t,n)=>{n.d(t,{c:()=>N});n(59284);var r=n(60865),a=n(47665),o=n(87184),l=n(98934),s=n(54090),i=n(77506),d=n(43937),u=n(36388),c=n(94420),p=n(70825),m=n(49917),h=n(99991),g=n(60712);const b={[s.m.Blue]:d.A,[s.m.Yellow]:u.A,[s.m.Orange]:c.A,[s.m.Red]:u.A,[s.m.Green]:p.A,[s.m.Grey]:m.A};function y({status:e,...t}){return e?(0,g.jsx)(h.I,{...t,data:b[e]}):null}var v=n(89732),x=n(97677);const f=(0,i.cn)("ydb-entity-status-new"),w={[s.m.Red]:"danger",[s.m.Blue]:"info",[s.m.Green]:"success",[s.m.Grey]:"unknown",[s.m.Orange]:"orange",[s.m.Yellow]:"warning"},C={get[s.m.Red](){return(0,v.A)("title_red")},get[s.m.Yellow](){return(0,v.A)("title_yellow")},get[s.m.Orange](){return(0,v.A)("title_orange")},get[s.m.Green](){return(0,v.A)("title_green")},get[s.m.Grey](){return(0,v.A)("title_grey")},get[s.m.Blue](){return(0,v.A)("title_blue")}};function N({className:e,children:t}){return(0,g.jsx)(o.s,{gap:"2",wrap:"nowrap",alignItems:"center",className:f(null,e),children:t})}N.Label=function({children:e,status:t,withStatusName:n=!0,note:s,size:i="m",iconSize:d=14}){const u=w[t];return(0,g.jsx)(r.m,{title:x.D[t],disabled:Boolean(s),children:(0,g.jsx)(a.J,{theme:"orange"===u?void 0:u,icon:(0,g.jsx)(y,{size:d,status:t}),size:i,className:f({orange:"orange"===u}),children:(0,g.jsxs)(o.s,{gap:"2",wrap:"nowrap",children:[e,n?C[t]:null,s&&(0,g.jsx)(l.H,{children:s})]})})})},N.displayName="EntityStatus"},42829:(e,t,n)=>{n.d(t,{D:()=>r});const r=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55340:(e,t,n)=>{n.d(t,{x:()=>c});var r=n(11363),a=n(78762),o=n(86782);const l="networkNodesTableSelectedColumns",s=["NodeId","NetworkHost","Connections","NetworkUtilization","SendThroughput","ReceiveThroughput","PingTime","ClockSkew"],i=["NodeId","NetworkHost"],d=["Host","DC","Rack","Uptime","ConnectStatus","NetworkUtilization","PingTime","ClockSkew"];var u=n(60712);function c({database:e,path:t,scrollContainerRef:n,additionalNodesProps:c}){return(0,u.jsx)(r.G,{path:t,database:e,scrollContainerRef:n,withPeerRoleFilter:Boolean(e),additionalNodesProps:c,columns:(p={database:e,getNodeRef:null===c||void 0===c?void 0:c.getNodeRef},[(0,a._E)(),(0,a.b8)(p),(0,a.uk)(),(0,a.OX)(),(0,a.jl)(),(0,a.fr)(),(0,a.kv)(),(0,a.SH)(),(0,a.H)(),(0,a.DH)(),(0,a.ui)(),(0,a.wN)(),(0,a.pt)()].map((e=>({...e,sortable:(0,o.sp)(e.name)})))),defaultColumnsIds:s,requiredColumnsIds:i,selectedColumnsKey:l,groupByParams:d});var p}},55974:(e,t,n)=>{n.d(t,{g:()=>v});var r=n(59284),a=n(18677),o=n(71153),l=n(74321),s=n(2198),i=n(99991),d=n(56999),u=n(77506),c=n(81288),p=n(48372);const m=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),h=(0,p.g4)("ydb-critical-action-dialog",{en:m});var g=n(60712);const b=(0,u.cn)("ydb-critical-dialog"),y=e=>{if((0,c.cH)(e)){if(403===e.status)return h("no-rights-error");if("string"===typeof e.data)return e.data;if((0,c._E)(e)&&e.data)return(0,g.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return h("default-error")};function v({visible:e,header:t,text:n,withRetry:d,retryButtonText:u,withCheckBox:c,onClose:p,onConfirm:m,onConfirmActionSuccess:v,onConfirmActionError:x}){const[f,w]=r.useState(!1),[C,N]=r.useState(),[j,S]=r.useState(!1),T=async e=>(w(!0),m(e).then((()=>{v(),p()})).catch((e=>{x(e),N(e)})).finally((()=>{w(!1)})));return(0,g.jsx)(s.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:p,onTransitionExited:()=>{N(void 0),S(!1)},children:C?(0,g.jsxs)(r.Fragment,{children:[(0,g.jsx)(s.l.Header,{caption:t}),(0,g.jsx)(s.l.Body,{className:b("body"),children:(0,g.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,g.jsx)("span",{className:b("error-icon"),children:(0,g.jsx)(a.A,{width:"24",height:"22"})}),y(C)]})}),(0,g.jsx)(s.l.Footer,{loading:!1,preset:"default",textButtonApply:d?u||h("button-retry"):void 0,textButtonCancel:h("button-close"),onClickButtonApply:()=>T(!0),onClickButtonCancel:p})]}):(0,g.jsxs)(r.Fragment,{children:[(0,g.jsx)(s.l.Header,{caption:t}),(0,g.jsxs)(s.l.Body,{className:b("body"),children:[(0,g.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,g.jsx)("span",{className:b("warning-icon"),children:(0,g.jsx)(i.I,{data:o.A,size:24})}),n]}),c?(0,g.jsx)(l.S,{checked:j,onUpdate:S,children:h("checkbox-text")}):null]}),(0,g.jsx)(s.l.Footer,{loading:f,preset:"default",textButtonApply:h("button-confirm"),textButtonCancel:h("button-cancel"),propsButtonApply:{type:"submit",disabled:c&&!j},onClickButtonCancel:p,onClickButtonApply:()=>T()})]})})}},56999:(e,t,n)=>{n.d(t,{O:()=>w});var r=n(59284),a=n(45720),o=n(16929),l=n(71153),s=n(18677),i=n(84476),d=n(33705),u=n(67884),c=n(99991),p=n(74529),m=n(77506),h=n(41650);const g=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function b(e){return function(e){return!!e&&void 0!==g[e]}(e)?g[e]:"S_INFO"}var y=n(60712);const v=(0,m.cn)("kv-result-issues"),x=(0,m.cn)("kv-issues"),f=(0,m.cn)("kv-issue");function w({data:e,hideSeverity:t}){const[n,a]=r.useState(!1),o="string"===typeof e||null===e||void 0===e?void 0:e.issues,l=Array.isArray(o)&&o.length>0;return(0,y.jsxs)("div",{className:v(),children:[(0,y.jsxs)("div",{className:v("error-message"),children:[(()=>{let n;if("string"===typeof e)n=e;else{var a,o;const l=b(null===e||void 0===e||null===(a=e.error)||void 0===a?void 0:a.severity);n=(0,y.jsxs)(r.Fragment,{children:[t?null:(0,y.jsxs)(r.Fragment,{children:[(0,y.jsx)(I,{severity:l})," "]}),(0,y.jsx)("span",{className:v("error-message-text"),children:null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message})]})}return n})(),l&&(0,y.jsx)(i.$,{view:"normal",onClick:()=>a(!n),children:n?"Hide details":"Show details"})]}),l&&n&&(0,y.jsx)(C,{hideSeverity:t,issues:o})]})}function C({issues:e,hideSeverity:t}){const n=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var n;const r=null!==(n=t.severity)&&void 0!==n?n:10;return Math.min(e,r)}),10);return(0,y.jsx)("div",{className:x(null),children:null===e||void 0===e?void 0:e.map(((e,r)=>(0,y.jsx)(N,{hideSeverity:t,issue:e,expanded:e===n},r)))})}function N({issue:e,hideSeverity:t,level:n=0}){const[a,o]=r.useState(!0),l=b(e.severity),s=e.issues,u=Array.isArray(s)&&s.length>0,c=a?"bottom":"right";return(0,y.jsxs)("div",{className:f({leaf:!u,"has-issues":u}),children:[(0,y.jsxs)("div",{className:f("line"),children:[u&&(0,y.jsx)(i.$,{view:"flat-secondary",onClick:()=>o(!a),className:f("arrow-toggle"),children:(0,y.jsx)(d.I,{direction:c,size:16})}),t?null:(0,y.jsx)(I,{severity:l}),(0,y.jsx)(j,{issue:e}),e.issue_code?(0,y.jsxs)("span",{className:f("code"),children:["Code: ",e.issue_code]}):null]}),u&&a&&(0,y.jsx)("div",{className:f("issues"),children:(0,y.jsx)(S,{issues:s,level:n+1,expanded:a})})]})}function j({issue:e}){var t;const n=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,h.kf)(t.row))return"";const{row:n,column:r}=t;return(0,h.kf)(r)?`${n}:${r}`:`line ${n}`}(e),r=window.ydbEditor,a=()=>(0,y.jsxs)("span",{className:f("message"),children:[n&&(0,y.jsx)("span",{className:f("place-text"),title:"Position",children:n}),(0,y.jsx)("div",{className:f("message-text"),children:(0,y.jsx)(p.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:o,column:l}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,h.kf)(o)&&r))return a();return(0,y.jsx)(u.N,{href:"#",extraProps:{draggable:!1},onClick:()=>{const e={lineNumber:o,column:null!==l&&void 0!==l?l:0};r.setPosition(e),r.revealPositionInCenterIfOutsideViewport(e),r.focus()},view:"primary",children:a()})}function S(e){const{issues:t,level:n,expanded:r}=e;return(0,y.jsx)("div",{className:f("list"),children:t.map(((e,t)=>(0,y.jsx)(N,{issue:e,level:n,expanded:r},t)))})}const T={S_INFO:a.A,S_WARNING:o.A,S_ERROR:l.A,S_FATAL:s.A},F=(0,m.cn)("yql-issue-severity");function I({severity:e}){const t=e.slice(2).toLowerCase();return(0,y.jsxs)("span",{className:F({severity:t}),children:[(0,y.jsx)(c.I,{className:F("icon"),data:T[e]}),(0,y.jsx)("span",{className:F("title"),children:t})]})}},74529:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(59284),a=n(67884),o=n(77506),l=n(48372);const s=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),i=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,l.g4)("ydb-shorty-string",{ru:i,en:s});var u=n(60712);const c=(0,o.cn)("kv-shorty-string");function p({value:e="",limit:t=200,strict:n=!1,displayLength:o=!0,render:l=e=>e,onToggle:s,expandLabel:i=d("default_expand_label"),collapseLabel:p=d("default_collapse_label")}){const[m,h]=r.useState(!1),g=(m?p:i)+(o&&!m?d("chars_count",{count:e.length}):""),b=e.length>t+(n?0:g.length),y=m||!b?e:e.slice(0,t-4)+"\xa0...";return(0,u.jsxs)("div",{className:c(),children:[l(y),b?(0,u.jsx)(a.N,{className:c("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),h((e=>!e)),null===s||void 0===s||s()},children:g}):null]})}},78321:(e,t,n)=>{n.d(t,{b:()=>l,s:()=>s});var r=n(67028),a=n(76086),o=n(69063);function l(){const e=(0,r.WF)(),[t]=(0,o.iK)(a.g5);return Boolean(e&&t)}function s(){const e=(0,r.DY)(),[t]=(0,o.iK)(a.g5);return Boolean(e&&t)}},88616:(e,t,n)=>{n.d(t,{Q:()=>R});var r=n(59284),a=n(76938),o=n(98089),l=n(99991),s=n(80987),i=n(22983),d=n(28539),u=n(10508),c=n(44508),p=n(44294),m=n(17594),h=n(41775),g=n(69326),b=n(80420),y=n(27775),v=n(41826),x=n(21545),f=n(6354),w=n(76086),C=n(12888),N=n(29819),j=n(48372);const S=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),T=(0,j.g4)("ydb-tablets",{en:S});var F=n(60712);function I(e){const t=e.State===f.r.Stopped,n=(0,C.X)(),[r]=x.X.useKillTabletMutation(),o=e.TabletId;return o?(0,F.jsx)(i.B,{buttonView:"outlined",buttonTitle:T("dialog.kill-header"),dialogHeader:T("dialog.kill-header"),dialogText:T("dialog.kill-text"),onConfirmAction:()=>r({id:o}).unwrap(),buttonDisabled:t||!n,withPopover:!0,popoverContent:T(n?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,F.jsx)(l.I,{data:a.A})}):null}function R({database:e,tablets:t,loading:n,error:a,scrollContainerRef:l,nodeId:i}){const[{tabletsSearch:x},f]=(0,s.useQueryParams)({tabletsSearch:s.StringParam}),[C,j]=r.useState(),S=r.useMemo((()=>function({database:e,nodeId:t}){const n=[{name:"Type",width:150,get header(){return T("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,F.jsxs)("span",{children:[e.Type," ",t?(0,F.jsx)(o.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return T("Tablet")},render:({row:t})=>t.TabletId?(0,F.jsx)(b.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):w.Pd},{name:"State",get header(){return T("State")},render:({row:e})=>(0,F.jsx)(y.i,{state:e.State})}];return void 0===t&&n.push({name:"NodeId",get header(){return T("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,N.vI)(e.NodeId);return(0,F.jsx)(p.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return T("Node FQDN")},render:({row:e})=>e.fqdn?(0,F.jsx)(u.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,F.jsx)("span",{children:"\u2014"})}),n.push({name:"Generation",get header(){return T("Generation")},align:"right"},{name:"Uptime",get header(){return T("Uptime")},render:({row:e})=>(0,F.jsx)(v.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,F.jsx)(I,{...e})}),n}({database:e,nodeId:i})),[e,i]),R=r.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==x&&void 0!==x?x:"")))),[t,x]);return(0,F.jsxs)(g.L,{fullHeight:!0,children:[(0,F.jsxs)(g.L.Controls,{children:[(0,F.jsx)(h.v,{placeholder:T("controls.search-placeholder"),onChange:e=>{f({tabletsSearch:e||void 0},"replaceIn")},value:null!==x&&void 0!==x?x:"",width:238}),(0,F.jsx)(d.T,{label:T("controls.entities-count-label"),loading:n,total:t.length,current:R.length})]}),a?(0,F.jsx)(c.o,{error:a}):null,(0,F.jsx)(g.L.Table,{scrollContainerRef:l,scrollDependencies:[x,C],loading:n,children:(0,F.jsx)(m.l,{columns:S,data:R,settings:w.N3,emptyDataMessage:T("noTabletsData"),onSortChange:j})})]})}},89732:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(48372);const a=JSON.parse('{"title_red":"Critical","title_blue":"Normal","title_green":"Good","title_grey":"Unknown","title_orange":"Caution","title_yellow":"Warning","context_red":"Some systems are failed and not available","context_yellow":"There are minor issues","context_orange":"Critical state, requires immediate attention","context_green":"Everything is working as expected","context_grey":"The condition cannot be determined","context_blue":"All good, some parts of the system are restoring"}'),o=(0,r.g4)("ydb-entity-status",{en:a})},95963:(e,t,n)=>{n.d(t,{v:()=>r.v});var r=n(41775)},97677:(e,t,n)=>{n.d(t,{D:()=>o});var r=n(54090),a=n(89732);const o={get[r.m.Red](){return(0,a.A)("context_red")},get[r.m.Yellow](){return(0,a.A)("context_yellow")},get[r.m.Orange](){return(0,a.A)("context_orange")},get[r.m.Green](){return(0,a.A)("context_green")},get[r.m.Grey](){return(0,a.A)("context_grey")},get[r.m.Blue](){return(0,a.A)("context_blue")}}}}]);