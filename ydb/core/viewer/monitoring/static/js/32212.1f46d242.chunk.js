"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[32212],{3685:(e,s,a)=>{a.d(s,{$:()=>o});var t=a(54090),l=a(77506),i=a(33775),n=a(60712);const r=(0,l.cn)("ydb-entity-page-title");function o({entityName:e,status:s=t.m.Grey,id:a,className:l}){return(0,n.jsxs)("div",{className:r(null,l),children:[(0,n.jsx)("span",{className:r("prefix"),children:e}),(0,n.jsx)(i.k,{className:r("icon"),status:s,size:"s"}),a]})}},32212:(e,s,a)=>{a.r(s),a.d(s,{Node:()=>Je});var t=a(59284),l=a(96727),i=a(29859),n=a(66212),r=a(4980),o=a(61750),d=a(10755),c=a(80987),u=a(3685),v=a(44508),p=a(32752),h=a(77506),m=a(23942),g=a(18863),b=a(25196),f=a(60712);const j=(0,h.cn)("ydb-pool-usage"),N=e=>{let s="green";return e>60&&e<=80?s="yellow":e>80&&(s="red"),s},x=({data:e={}})=>{const{Threads:s,Name:a="Unknown",Usage:t=0}=e,l=t&&s,i=Math.floor(100*t),n=i>100?100:i;return(0,f.jsxs)("div",{className:j(),children:[(0,f.jsxs)("div",{className:j("info"),children:[(0,f.jsx)("div",{className:j("pool-name"),children:a}),l&&(0,f.jsxs)("div",{className:j("value"),children:[(0,f.jsxs)("div",{className:j("percents"),children:[i<1?"<1":i,"%"]}),(0,f.jsxs)("div",{className:j("threads"),children:["(\xd7",s,")"]})]})]}),(0,f.jsx)("div",{className:j("visual"),children:(0,f.jsx)("div",{className:j("usage-line",{type:N(n)}),style:{width:`${n}%`}})})]})};var k=a(15132),I=a(41826),y=a(48372);const S=JSON.parse('{"database":"Database","uptime":"Uptime","version":"Version","dc":"DC","rack":"Rack","links":"Links","la-interval-1m":"1 min","la-interval-5m":"5 min","la-interval-15m":"15 min","developer-ui":"Developer UI","no-data":"No data","title.common-info":"Common info","title.endpoints":"Endpoints","title.roles":"Roles","title.pools":"Pools","title.load-average":"Load average"}'),D=(0,y.g4)("ydb-node-info",{en:S}),w=(0,h.cn)("full-node-viewer"),T=({node:e,className:s})=>{var a,t,l,i,n;const r=(0,m.n)(e),o=[];null!==e&&void 0!==e&&null!==(a=e.Tenants)&&void 0!==a&&a.length&&o.push({label:D("database"),value:e.Tenants[0]}),o.push({label:D("version"),value:null===e||void 0===e?void 0:e.Version},{label:D("uptime"),value:(0,f.jsx)(I.p,{StartTime:null===e||void 0===e?void 0:e.StartTime,DisconnectTime:null===e||void 0===e?void 0:e.DisconnectTime})},{label:D("dc"),value:(null===e||void 0===e?void 0:e.DataCenterDescription)||(null===e||void 0===e?void 0:e.DC)}),null!==e&&void 0!==e&&e.Rack&&o.push({label:D("rack"),value:null===e||void 0===e?void 0:e.Rack}),r&&o.push({label:D("links"),value:(0,f.jsx)(b.K,{url:r,title:D("developer-ui")})});const d=null===e||void 0===e||null===(t=e.Endpoints)||void 0===t?void 0:t.map((({Name:e,Address:s})=>({label:e,value:s}))),c=null===e||void 0===e||null===(l=e.LoadAveragePercents)||void 0===l?void 0:l.map(((e,s)=>{return{label:(a=s,[D("la-interval-1m"),D("la-interval-5m"),D("la-interval-15m")][a]),value:(0,f.jsx)(k.O,{value:e,percents:!0,colorizeProgress:!0,capacity:100})};var a}));return e?(0,f.jsx)("div",{className:w(null,s),children:(0,f.jsxs)(p.s,{wrap:!0,gap:4,children:[(0,f.jsxs)(p.s,{direction:"column",gap:2,children:[(0,f.jsx)(g.z,{title:D("title.common-info"),className:w("section"),info:o}),d&&d.length?(0,f.jsx)(g.z,{title:D("title.endpoints"),className:w("section"),info:d}):null]}),(0,f.jsxs)(p.s,{direction:"column",gap:2,children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:w("section-title"),children:D("title.pools")}),(0,f.jsx)("div",{className:w("section",{pools:!0}),children:null===e||void 0===e||null===(i=e.PoolStats)||void 0===i?void 0:i.map(((e,s)=>(0,f.jsx)(x,{data:e},s)))})]}),(0,f.jsx)(g.z,{title:D("title.load-average"),className:w("section",{average:!0}),info:c})]}),e.Roles&&e.Roles.length?(0,f.jsx)(p.s,{direction:"column",gap:2,children:(0,f.jsxs)("div",{className:w("section"),children:[(0,f.jsx)("div",{className:w("section-title"),children:D("title.roles")}),null===e||void 0===e||null===(n=e.Roles)||void 0===n?void 0:n.map((e=>(0,f.jsx)("div",{className:w("role"),children:e},e)))]})}):null]})}):(0,f.jsx)("div",{className:"error",children:D("no-data")})};var P=a(42655),z=a(44294),R=a(58389),C=a(92459),E=a(67028),A=a(40174),U=a(21334),V=a(78034);const _=e=>{var s;if(null===(s=e.SystemStateInfo)||void 0===s||!s.length)return{};const a=e.SystemStateInfo[0];return(0,V.q1)(a)},L=U.F.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async({nodeId:e,database:s},{signal:a})=>{try{const t=await window.api.viewer.getNodeInfo({nodeId:e,database:s},{signal:a});return{data:_(t)}}catch(t){return{error:t}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async({nodeId:e},{signal:s})=>{try{return{data:await window.api.viewer.getStorageInfo({nodeId:e},{signal:s})}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"});var O=a(47779),F=a(12888),M=a(81188),$=a(61323),G=a(1349),q=a(71635),W=a(370);const H=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page","tabs.storage":"Storage","tabs.structure":"Structure","tabs.tablets":"Tablets","tabs.threads":"Threads","tabs.configs":"Configs","node":"Node","fqdn":"FQDN","dc":"DC"}'),K=(0,y.g4)("ydb-node-page",{en:H}),Q={storage:"storage",tablets:"tablets",structure:"structure",threads:"threads",configs:"configs"},X=[{id:Q.storage,get title(){return K("tabs.storage")}},{id:Q.structure,get title(){return K("tabs.structure")}},{id:Q.tablets,get title(){return K("tabs.tablets")}},{id:Q.threads,get title(){return K("tabs.threads")}},{id:Q.configs,get title(){return K("tabs.configs")}}],Z=W.z.nativeEnum(Q).catch(Q.tablets),B={database:c.StringParam,pdiskId:c.StringParam,vdiskId:c.StringParam};var J=a(905),Y=a.n(J),ee=a(52248),se=a(53850),ae=a(56839),te=a(27295);const le=(0,se.Mz)((e=>e),(e=>L.endpoints.getNodeStructure.select({nodeId:e}))),ie=(0,se.Mz)((e=>e),((e,s)=>le(s)),((e,s)=>s(e).data)),ne=(0,se.Mz)(((e,s)=>Number(s)),((e,s)=>ie(e,s)),((e,s)=>{const a=null===s||void 0===s?void 0:s.StoragePools,t={};null===a||void 0===a||a.forEach((s=>{const a=s.Groups;null===a||void 0===a||a.forEach((a=>{var l;const i=null===(l=a.VDisks)||void 0===l?void 0:l.filter((s=>s.NodeId===e)).map(te.WT);null===i||void 0===i||i.forEach((a=>{var l;const i=(0,ae.U9)(a.VDiskId),n=null===(l=a.PDisk)||void 0===l?void 0:l.PDiskId;t[String(n)]||(t[String(n)]={vDisks:{},...a.PDisk}),t[String(n)].vDisks[i]={...a,PDiskId:n,NodeId:e,StoragePoolName:s.Name}}))}))}));return Object.keys(t).reduce(((e,s)=>{const a=t[s].vDisks,l=Object.keys(a).reduce(((e,s,t)=>(e.push({...a[s],id:s,order:t}),e)),[]);return e[s]={...t[s],vDisks:l},e}),{})}));var re=a(112),oe=a(45720),de=a(4557),ce=a(80136),ue=a(47653),ve=a(58611),pe=a(60461),he=a(45659),me=a(33775),ge=a(67808),be=a(54090),fe=a(67375),je=a(7435),Ne=a(76086),xe=a(31684);const ke=(0,h.cn)("kv-node-structure");function Ie({label:e,value:s,className:a}){return(0,f.jsxs)("span",{className:ke("pdisk-title-item",a),children:[e&&(0,f.jsxs)("span",{className:ke("pdisk-title-item-label"),children:[e,":"]}),(0,f.jsx)("span",{className:ke("pdisk-title-item-value"),children:s})]})}const ye=(0,h.cn)("kv-node-structure");var Se=function(e){return e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info",e}(Se||{});const De={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function we({pDiskId:e,selectedVdiskId:s,nodeId:a,withDeveloperUILink:t}){return[{name:Se.slotId,header:De[Se.slotId],width:100,render:({row:l})=>{const i=l.VDiskSlotId;let n=null;return(0,je.f8)(a)&&(0,je.f8)(e)&&(0,je.f8)(i)&&(n=(0,xe.Wg)({nodeId:a,pDiskId:e,vDiskSlotId:i})),(0,f.jsxs)("div",{className:ye("vdisk-id",{selected:l.id===s}),children:[(0,f.jsx)("span",{children:i}),n&&t?(0,f.jsx)(ce.$,{size:"s",className:ye("external-button",{hidden:!0}),href:n,target:"_blank",title:K("vdisk.developer-ui-button-title"),children:(0,f.jsx)(ue.I,{data:re.A})}):null]})},align:de.Ay.LEFT},{name:Se.VDiskState,header:De[Se.VDiskState],width:70,render:({row:e})=>(0,f.jsx)(me.k,{status:e.VDiskState===fe.W.OK?be.m.Green:be.m.Red}),sortAccessor:e=>e.VDiskState===fe.W.OK?1:0,align:de.Ay.CENTER},{name:Se.Size,header:De[Se.Size],width:170,render:({row:e})=>(0,f.jsx)(k.O,{value:e.AllocatedSize,capacity:Number(e.AllocatedSize)+Number(e.AvailableSize),formatValues:ae.vX,colorizeProgress:!0}),sortAccessor:e=>Number(e.AllocatedSize),align:de.Ay.CENTER},{name:Se.Info,header:De[Se.Info],width:70,render:({row:e})=>(0,f.jsx)(ve.A,{placement:["right"],content:(0,f.jsx)(ge.E,{data:e,withTitle:!0,withVDiskPageLink:!0,className:ye("vdisk-details")}),children:(0,f.jsx)(ce.$,{view:"flat-secondary",className:ye("vdisk-details-button",{selected:e.id===s}),children:(0,f.jsx)(ue.I,{data:oe.A,size:18})})}),sortable:!1}]}function Te({id:e,data:s,selectedVdiskId:a,nodeId:l,unfolded:i}){const n=(0,F.X)(),[r,o]=t.useState(null!==i&&void 0!==i&&i),{TotalSize:d=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:p,vDisks:h}=s,m=Number(d),g=Number(c);return(0,f.jsxs)("div",{className:ye("pdisk"),id:e,children:[(0,f.jsxs)("div",{className:ye("pdisk-header"),children:[(0,f.jsxs)("div",{className:ye("pdisk-title-wrapper"),children:[(0,f.jsx)(me.k,{status:u}),(0,f.jsx)(Ie,{label:"PDiskID",value:v,className:ye("pdisk-title-id")}),(0,f.jsx)(Ie,{value:p,className:ye("pdisk-title-type")}),(0,f.jsx)(k.O,{value:m-g,capacity:m,formatValues:ae.vX,colorizeProgress:!0,className:ye("pdisk-title-size")}),(0,f.jsx)(Ie,{label:"VDisks",value:h.length})]}),(0,f.jsx)(ce.$,{onClick:r?()=>{o(!1)}:()=>{o(!0)},view:"flat-secondary",children:(0,f.jsx)(pe.I,{direction:r?"top":"bottom"})})]}),r&&(Y()(s)?(0,f.jsx)("div",{children:"No information about PDisk"}):(0,f.jsxs)("div",{children:[(0,f.jsx)(he.Q,{pDisk:s,nodeId:l,className:ye("pdisk-details"),withPDiskPageLink:!0}),(0,f.jsxs)("div",{className:ye("vdisks-container"),children:[(0,f.jsx)("div",{className:ye("vdisks-header"),children:"VDisks"}),(0,f.jsx)(de.Ay,{theme:"yandex-cloud",data:h,columns:we({nodeId:l,pDiskId:v,selectedVdiskId:a,withDeveloperUILink:n}),settings:{...Ne.N3,dynamicRender:!1},rowClassName:e=>e.id===a?ye("selected-vdisk"):""})]})]}))]})}const Pe=(0,h.cn)("kv-node-structure");function ze({type:e,id:s}){return`${e}-${s}`}const Re=function({nodeId:e,className:s}){const a=(0,O.N4)((s=>ne(s,e))),[l]=(0,O.Nt)(),{currentData:i,isFetching:n,error:r}=L.useGetNodeStructureQuery({nodeId:e},{pollingInterval:l}),o=n&&void 0===i,[{pdiskId:d,vdiskId:u}]=(0,c.useQueryParams)({pdiskId:c.StringParam,vdiskId:c.StringParam}),p=t.useRef(null),h=t.useRef(!1);return t.useEffect((()=>{if(!Y()(a)&&!h.current&&p.current&&d){const s=document.getElementById(ze({type:"pdisk",id:d}));let t=0;if(u){var e;const s=null===(e=a[d])||void 0===e?void 0:e.vDisks,l=null===s||void 0===s?void 0:s.find((e=>e.id===u)),i=l?document.querySelector(".data-table"):void 0,n=(null===l||void 0===l?void 0:l.order)||0;i&&(t+=i.offsetTop+40*n)}s&&(p.current.scrollTo({behavior:"smooth",top:t||s.offsetTop}),h.current=!0)}}),[a,d,u]),(0,f.jsxs)("div",{className:Pe(),ref:p,children:[r?(0,f.jsx)(v.o,{error:r,className:Pe("error")}):null,(0,f.jsx)("div",{className:s,children:o?(0,f.jsx)(ee.a,{size:"m"}):r&&!i?null:(()=>{const s=Object.keys(a);return s.length>0?s.map((s=>(0,f.jsx)(Te,{data:a[s],id:ze({type:"pdisk",id:s}),unfolded:d===s,selectedVdiskId:u,nodeId:e},s))):"There is no information about node structure."})()})]})};var Ce=a(17594),Ee=a(69326),Ae=a(78491),Ue=a(41650),Ve=a(88908);const _e=(0,h.cn)("cpu-usage-bar");function Le({systemUsage:e=0,userUsage:s=0,className:a}){const t=e+s,l=Math.round(100*e),i=Math.round(100*s),n=Math.round(100*t);return(0,f.jsxs)(p.s,{gap:2,className:_e(null,a),children:[(0,f.jsx)("div",{className:_e("progress"),children:(0,f.jsx)(k.O,{value:n,percents:!0,colorizeProgress:!0,capacity:100,className:_e("progress")})}),(0,f.jsxs)(Ve.E,{color:"secondary",children:["(Sys: ",l,"%, U: ",i,"%)"]})]})}var Oe=a(96344),Fe=a(8979);const Me=(0,h.cn)("ydb-thread-states-bar"),$e=e=>{switch(e.toUpperCase()){case"R":return"var(--g-color-base-positive-medium)";case"S":return"var(--g-color-base-info-medium)";case"D":return"var(--g-color-base-warning-medium)";case"Z":case"T":case"X":return"var(--g-color-base-danger-medium)";default:return"var(--g-color-base-misc-medium)"}},Ge=e=>{switch(e.toUpperCase()){case"R":return"success";case"S":return"info";case"D":return"warning";case"Z":case"T":case"X":return"danger";default:return"misc"}},qe=e=>{switch(e.toUpperCase()){case"R":return"Running";case"S":return"Sleeping";case"D":return"Uninterruptible sleep";case"Z":return"Zombie";case"T":return"Stopped";case"X":return"Dead";default:return"Unknown"}};function We({states:e={},totalThreads:s,className:a}){const t=s||Object.values(e).reduce(((e,s)=>e+s),0);if(0===t)return Ne.Pd;const l=Object.entries(e).filter((([,e])=>e>0)),i=Object.entries(e).map((([e,s])=>({theme:Ge(e),value:s/t*100})));return(0,f.jsxs)("div",{className:Me(null,a),children:[(0,f.jsx)(Oe.k,{stack:i,size:"s"}),(0,f.jsx)(p.s,{gap:2,children:l.map((([e,s])=>(0,f.jsx)(Fe.m,{title:qe(e),children:(0,f.jsxs)(p.s,{gap:1,alignItems:"center",children:[(0,f.jsx)("div",{className:Me("legend-color"),style:{backgroundColor:$e(e)}}),(0,f.jsxs)(Ve.E,{color:"secondary",variant:"caption-2",children:[e,": ",s]})]})},e)))})]})}const He=JSON.parse('{"field_pool-name":"Pool Name","field_thread-count":"Threads","field_cpu-usage":"CPU Usage","field_minor-page-faults":"Minor Page Faults","field_major-page-faults":"Major Page Faults","field_thread-states":"Thread States","value_unknown":"Unknown","alert_no-thread-data":"No thread pool information available","description_cpu-usage":"System usage + user usage"}'),Ke=(0,y.g4)("ydb-threads",{en:He}),Qe=[{name:"Name",header:Ke("field_pool-name"),render:({row:e})=>e.Name||Ke("value_unknown"),width:200},{name:"Threads",header:Ke("field_thread-count"),render:({row:e})=>(0,ae.ZV)(e.Threads),align:de.Ay.RIGHT,width:100},{name:"CpuUsage",header:(0,f.jsx)(Ae.$,{header:Ke("field_cpu-usage"),note:Ke("description_cpu-usage")}),render:({row:e})=>(0,f.jsx)(Le,{systemUsage:e.SystemUsage,userUsage:e.UserUsage}),sortAccessor:e=>(0,Ue.y3)(e.SystemUsage)+(0,Ue.y3)(e.UserUsage),width:200},{name:"MinorPageFaults",header:Ke("field_minor-page-faults"),render:({row:e})=>(0,ae.ZV)(e.MinorPageFaults),align:de.Ay.RIGHT,width:145},{name:"MajorPageFaults",header:Ke("field_major-page-faults"),render:({row:e})=>(0,ae.ZV)(e.MajorPageFaults),align:de.Ay.RIGHT,width:145},{name:"States",header:Ke("field_thread-states"),render:({row:e})=>(0,f.jsx)(We,{states:e.States,totalThreads:e.Threads}),sortable:!1,width:250}],Xe="threadsTableColumnsWidth";function Ze({nodeId:e,className:s,scrollContainerRef:a}){const[t]=(0,O.Nt)(),{currentData:l,isLoading:i,error:n}=L.useGetNodeInfoQuery({nodeId:e},{pollingInterval:t}),r=(null===l||void 0===l?void 0:l.Threads)||[];return(0,f.jsxs)(Ee.L,{fullHeight:!0,className:s,children:[n?(0,f.jsx)(v.o,{error:n}):null,(0,f.jsx)(Ee.L.Table,{scrollContainerRef:a,children:(0,f.jsx)(Ce.l,{columnsWidthLSKey:Xe,data:r,columns:Qe,settings:Ne.N3,emptyDataMessage:Ke("alert_no-thread-data"),isLoading:i})})]})}const Be=(0,h.cn)("node");function Je(){var e,s;const a=t.useRef(null),l=(0,F.b)(),i=(0,E.RK)(),n=l&&i,o=(0,O.YQ)(),u=(0,d.W5)(C.Ay.node),p=null===u||void 0===u?void 0:u.params.id,h=null===u||void 0===u?void 0:u.params.activeTab,[{database:m}]=(0,c.useQueryParams)(B),g=Z.parse(h),[b]=(0,O.Nt)(),j=p?{nodeId:p,database:null===m||void 0===m?void 0:m.toString()}:r.hT,{currentData:N,isLoading:x,error:k}=L.useGetNodeInfoQuery(j,{pollingInterval:b}),I=(0,E.Pm)(),y=(0,E.c2)(),S=x||!I,D=(0,V.wH)(N),w=null===N||void 0===N||null===(e=N.Threads)||void 0===e?void 0:e.length,{activeTab:T,nodeTabs:P}=t.useMemo((()=>{var e;const s=[];D||s.push("storage"),n||s.push("configs"),y&&s.push("structure"),w||s.push("threads");const a=X.filter((e=>!s.includes(e.id)));return{activeTab:null!==(e=a.find((({id:e})=>e===g)))&&void 0!==e?e:a[0],nodeTabs:a}}),[D,y,g,w,n]),z=null===m||void 0===m?void 0:m.toString(),R=null===N||void 0===N||null===(s=N.Tenants)||void 0===s?void 0:s[0];return t.useEffect((()=>{x||o((0,A.g)("node",{database:z,databaseName:R,nodeRole:D?"Storage":"Compute",nodeId:p}))}),[o,z,p,x,D,R]),(0,f.jsxs)("div",{className:Be(null),ref:a,children:[(0,f.jsx)(Ye,{node:N,activeTabTitle:T.title}),(0,f.jsx)(es,{node:N,loading:S}),(0,f.jsx)(ss,{node:N}),k?(0,f.jsx)(v.o,{error:k,className:Be("error")}):null,(0,f.jsx)(as,{node:N,loading:S}),p?(0,f.jsx)(ts,{nodeId:p,database:z,activeTabId:T.id,tabs:P,parentContainer:a}):null]})}function Ye({node:e,activeTabTitle:s}){const{appTitle:a}=(0,M.J)(),t=null!==e&&void 0!==e&&e.Host?e.Host:K("node");return(0,f.jsx)(o.mg,{titleTemplate:`%s \u2014 ${t} \u2014 ${a}`,defaultTitle:`${t} \u2014 ${a}`,children:(0,f.jsx)("title",{children:s})})}function es({node:e,loading:s}){const a=null!==e&&void 0!==e&&e.Host?`${K("fqdn")}: ${e.Host}`:void 0,t=null!==e&&void 0!==e&&e.DC?`${K("dc")}: ${e.DC}`:void 0;return(0,f.jsx)(R.B,{loading:s,items:[a,t],className:Be("meta")})}function ss({node:e}){return(0,f.jsx)(u.$,{entityName:K("node"),status:null===e||void 0===e?void 0:e.SystemState,id:null===e||void 0===e?void 0:e.NodeId,className:Be("title")})}function as({node:e,loading:s}){return s?(0,f.jsx)(P.y,{className:Be("info"),rows:10}):(0,f.jsx)(T,{node:e,className:Be("info")})}function ts({nodeId:e,database:s,activeTabId:a,tabs:r,parentContainer:o}){return(0,f.jsxs)(t.Fragment,{children:[(0,f.jsx)("div",{className:Be("tabs"),children:(0,f.jsx)(l.f,{value:a,children:(0,f.jsx)(i.w,{className:Be("tab-list"),size:"l",children:r.map((({id:a,title:t})=>{const l=(0,C.vI)({id:e,activeTab:a},{database:s});return(0,f.jsx)(n.o,{value:a,children:(0,f.jsx)(z.E,{to:l,as:"tab",children:t})},a)}))})})}),(()=>{switch(a){case"storage":return(0,f.jsx)(G.z,{database:s,nodeId:e,scrollContainerRef:o,viewContext:{nodeId:e}});case"tablets":return(0,f.jsx)(q.C,{scrollContainerRef:o,nodeId:e,database:s,onlyActive:!0});case"structure":return(0,f.jsx)(Re,{nodeId:e});case"threads":return(0,f.jsx)(Ze,{nodeId:e,scrollContainerRef:o,className:Be("treads")});case"configs":return(0,f.jsx)($.U,{database:s,scrollContainerRef:o});default:return!1}})()]})}},42655:(e,s,a)=>{a.d(s,{y:()=>c});var t=a(59284),l=a(1608),i=a(77506),n=a(66781),r=a(60712);const o=(0,i.cn)("ydb-info-viewer-skeleton"),d=()=>(0,r.jsxs)("div",{className:o("label"),children:[(0,r.jsx)(l.E,{className:o("label__text")}),(0,r.jsx)("div",{className:o("label__dots")})]}),c=({rows:e=8,className:s,delay:a=600})=>{const[i]=(0,n.y)(a);let c=(0,r.jsxs)(t.Fragment,{children:[(0,r.jsx)(d,{}),(0,r.jsx)(l.E,{className:o("value")})]});return i||(c=null),(0,r.jsx)("div",{className:o(null,s),children:[...new Array(e)].map(((e,s)=>(0,r.jsx)("div",{className:o("row"),children:c},`skeleton-row-${s}`)))})}},45659:(e,s,a)=>{a.d(s,{Q:()=>g});var t=a(32752),l=a(7435),i=a(46549),n=a(56839),r=a(31684),o=a(12888),d=a(18863),c=a(25196),u=a(59753),v=a(15132),p=a(33775),h=a(50672),m=a(60712);function g({pDisk:e,nodeId:s,withPDiskPageLink:a,className:g}){const b=(0,o.X)(),[f,j,N,x]=function({pDisk:e,nodeId:s,withPDiskPageLink:a,isUserAllowedToMakeChanges:o}){const{PDiskId:d,Path:g,Guid:b,Category:f,Type:j,Device:N,Realtime:x,State:k,SerialNumber:I,TotalSize:y,AllocatedSize:S,AllocatedPercent:D,StatusV2:w,NumActiveSlots:T,ExpectedSlotCount:P,LogUsedSize:z,LogTotalSize:R,SystemSize:C,SharedWithOs:E}=e||{},A=[];(0,l.f8)(f)&&A.push({label:(0,h.D)("type"),value:j}),(0,l.f8)(g)&&A.push({label:(0,h.D)("path"),value:g}),(0,l.f8)(b)&&A.push({label:(0,h.D)("guid"),value:b}),I&&A.push({label:(0,h.D)("serial-number"),value:I}),E&&A.push({label:(0,h.D)("shared-with-os"),value:(0,h.D)("yes")});const U=[];(0,l.f8)(w)&&U.push({label:(0,h.D)("drive-status"),value:w}),(0,l.f8)(k)&&U.push({label:(0,h.D)("state"),value:k}),(0,l.f8)(N)&&U.push({label:(0,h.D)("device"),value:(0,m.jsx)(p.k,{status:N})}),(0,l.f8)(x)&&U.push({label:(0,h.D)("realtime"),value:(0,m.jsx)(p.k,{status:x})});const V=[];V.push({label:(0,h.D)("space"),value:(0,m.jsx)(v.O,{value:S,capacity:y,formatValues:n.vX,colorizeProgress:!0})}),isNaN(Number(D))||V.push({label:(0,h.D)("usage"),value:`${D}%`}),(0,l.f8)(T)&&(0,l.f8)(P)&&V.push({label:(0,h.D)("slots"),value:(0,m.jsx)(v.O,{value:T,capacity:P})}),(0,l.f8)(z)&&(0,l.f8)(R)&&V.push({label:(0,h.D)("log-size"),value:(0,m.jsx)(v.O,{value:z,capacity:R,formatValues:n.vX})}),(0,l.f8)(C)&&V.push({label:(0,h.D)("system-size"),value:(0,i.z3)({value:C})});const _=[];if((a||o)&&(0,l.f8)(d)&&(0,l.f8)(s)){const e=(0,r.ar)({nodeId:s,pDiskId:d});_.push({label:(0,h.D)("links"),value:(0,m.jsxs)(t.s,{wrap:"wrap",gap:2,children:[a&&(0,m.jsx)(u.L,{pDiskId:d,nodeId:s}),o&&(0,m.jsx)(c.K,{title:(0,h.D)("developer-ui"),url:e})]})})}return[A,U,V,_]}({pDisk:e,nodeId:s,withPDiskPageLink:a,isUserAllowedToMakeChanges:b});return(0,m.jsxs)(t.s,{className:g,gap:2,direction:"row",wrap:!0,children:[(0,m.jsxs)(t.s,{direction:"column",gap:2,width:500,children:[(0,m.jsx)(d.z,{info:f,renderEmptyState:()=>null}),(0,m.jsx)(d.z,{info:N,renderEmptyState:()=>null})]}),(0,m.jsxs)(t.s,{direction:"column",gap:2,width:500,children:[(0,m.jsx)(d.z,{info:j,renderEmptyState:()=>null}),(0,m.jsx)(d.z,{info:x,renderEmptyState:()=>null})]})]})}},52248:(e,s,a)=>{a.d(s,{a:()=>t.a});var t=a(47334)},58389:(e,s,a)=>{a.d(s,{B:()=>u});var t=a(32752),l=a(77506),i=a(90053),n=a(70043),r=a(60712);const o=(0,l.cn)("ydb-page-meta"),d="\xa0\xa0\xb7\xa0\xa0";function c({items:e,loading:s}){return(0,r.jsx)("div",{className:o("info"),children:s?(0,r.jsx)(n.E,{className:o("skeleton")}):e.filter((e=>Boolean(e))).join(d)})}function u({className:e,...s}){return(0,r.jsxs)(t.s,{gap:1,alignItems:"center",justifyContent:"space-between",className:o(null,e),children:[(0,r.jsx)(c,{...s}),(0,r.jsx)(i.E,{})]})}},67808:(e,s,a)=>{a.d(s,{E:()=>x});a(59284);var t=a(32752),l=a(13847),i=a(92459),n=a(67375),r=a(77506),o=a(56839),d=a(31684),c=a(7187),u=a(12888),v=a(41650),p=a(60073),h=a(44294),m=a(25196),g=a(15132),b=a(33775),f=a(39110),j=a(60712);const N=(0,r.cn)("ydb-vdisk-info");function x({data:e,withVDiskPageLink:s,withTitle:a,className:r,wrap:c}){var x,I;const y=(0,u.X)(),S=(0,i.Z$)(),{AllocatedSize:D,SizeLimit:w,AllocatedPercent:T,DiskSpace:P,FrontQueues:z,Guid:R,Replicated:C,ReplicationProgress:E,ReplicationSecondsRemaining:A,Donors:U,VDiskState:V,VDiskSlotId:_,Kind:L,SatisfactionRank:O,HasUnreadableBlobs:F,IncarnationGuid:M,InstanceGuid:$,StoragePoolName:G,ReadThroughput:q,WriteThroughput:W,PDiskId:H,StringifiedId:K,NodeId:Q}=e||{},X=[];var Z,B;((0,l.isNil)(G)||X.push({label:(0,f.r)("pool-name"),value:G}),(0,l.isNil)(V)||X.push({label:(0,f.r)("state-status"),value:V}),Number(D)>=0&&Number(w)>=0&&X.push({label:(0,f.r)("size"),value:(0,j.jsx)(g.O,{value:D,capacity:w,formatValues:o.vX,colorizeProgress:!0})}),isNaN(Number(T))||X.push({label:(0,f.r)("usage"),value:`${T}%`}),(0,l.isNil)(P)||X.push({label:(0,f.r)("space-status"),value:(0,j.jsx)(b.k,{status:P})}),(0,l.isNil)(z)||X.push({label:(0,f.r)("front-queues"),value:(0,j.jsx)(b.k,{status:z})}),(0,l.isNil)(null===O||void 0===O||null===(x=O.FreshRank)||void 0===x?void 0:x.Flag))||X.push({label:(0,f.r)("fresh-rank-satisfaction"),value:(0,j.jsx)(b.k,{status:null===O||void 0===O||null===(Z=O.FreshRank)||void 0===Z?void 0:Z.Flag})});(0,l.isNil)(null===O||void 0===O||null===(I=O.LevelRank)||void 0===I?void 0:I.Flag)||X.push({label:(0,f.r)("level-rank-satisfaction"),value:(0,j.jsx)(b.k,{status:null===O||void 0===O||null===(B=O.LevelRank)||void 0===B?void 0:B.Flag})});(0,l.isNil)(q)||X.push({label:(0,f.r)("read-throughput"),value:(0,v.O4)(q)}),(0,l.isNil)(W)||X.push({label:(0,f.r)("write-throughput"),value:(0,v.O4)(W)});const J=[];if((0,l.isNil)(C)||J.push({label:(0,f.r)("replication-status"),value:C?(0,f.r)("yes"):(0,f.r)("no")}),!1===C&&V===n.W.OK&&((0,l.isNil)(E)||J.push({label:(0,f.r)("replication-progress"),value:(0,j.jsx)(g.O,{value:Math.round(100*E),percents:!0,colorizeProgress:!0,capacity:100})}),!(0,l.isNil)(A))){const e=(0,o.YS)(A);e&&J.push({label:(0,f.r)("replication-time-remaining"),value:e})}if((0,l.isNil)(_)||J.push({label:(0,f.r)("slot-id"),value:_}),!(0,l.isNil)(H)){const e=(0,l.isNil)(Q)?void 0:(0,i.Ck)(H,Q),s=e?(0,j.jsx)(h.E,{to:e,children:H}):H;J.push({label:(0,f.r)("label_pdisk-id"),value:s})}if((0,l.isNil)(L)||J.push({label:(0,f.r)("kind"),value:L}),(0,l.isNil)(R)||J.push({label:(0,f.r)("guid"),value:R}),(0,l.isNil)(M)||J.push({label:(0,f.r)("incarnation-guid"),value:M}),(0,l.isNil)($)||J.push({label:(0,f.r)("instance-guid"),value:$}),(0,l.isNil)(F)||J.push({label:(0,f.r)("has-unreadable-blobs"),value:F?(0,f.r)("yes"):(0,f.r)("no")}),!1===C&&V===n.W.OK&&null!==U&&void 0!==U&&U.length){const e=U.map(((e,s)=>{const{StringifiedId:a,NodeId:t}=e;if(!a||!t)return null;const l=S({nodeId:t,vDiskId:a});return(0,j.jsx)(h.E,{to:l,children:a},s)})).filter(Boolean);e.length&&J.push({label:(0,f.r)("donors"),value:(0,j.jsx)(t.s,{direction:"column",gap:1,children:e})})}const Y=[],ee=S({nodeId:Q,vDiskId:K});if(s&&ee&&Y.push((0,j.jsx)(m.K,{title:(0,f.r)("vdisk-page"),url:ee,external:!1},ee)),y&&!(0,l.isNil)(Q)&&!(0,l.isNil)(_)&&!(0,l.isNil)(H)){const e=(0,d.Wg)({nodeId:Q,pDiskId:H,vDiskSlotId:_});Y.push((0,j.jsx)(m.K,{title:(0,f.r)("developer-ui"),url:e},e))}Y.length&&J.push({label:(0,f.r)("links"),value:(0,j.jsx)(t.s,{wrap:"wrap",gap:2,children:Y})});const se=e&&a?(0,j.jsx)(k,{data:e}):null;return(0,j.jsxs)(t.s,{className:r,gap:2,direction:c?"row":"column",wrap:c,children:[(0,j.jsx)(p.z_,{title:se,info:X,renderEmptyState:()=>null,className:N("info")}),(0,j.jsx)(p.z_,{info:J,renderEmptyState:()=>null,className:N("info")})]})}function k({data:e}){return(0,j.jsxs)("div",{className:N("title"),children:[(0,f.r)("vdiks-title"),(0,j.jsx)(b.k,{status:(0,c.XY)(e.Severity)}),e.StringifiedId]})}},70043:(e,s,a)=>{a.d(s,{E:()=>n});var t=a(1608),l=a(66781),i=a(60712);const n=({delay:e=600,className:s})=>{const[a]=(0,l.y)(e);return a?(0,i.jsx)(t.E,{className:s}):null}},71635:(e,s,a)=>{a.d(s,{C:()=>x});var t=a(59284),l=a(4980),i=a(13847),n=a(53850),r=a(62060),o=a.n(r),d=a(21334),c=a(24600);const u=d.F.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,{signal:s})=>{try{return{data:await window.api.viewer.getTabletsInfo(e,{signal:s})}}catch(a){return{error:a}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),v=(0,n.Mz)((e=>e),(e=>u.endpoints.getTabletsInfo.select(e)),{argsMemoize:n.i5,argsMemoizeOptions:{equalityCheck:o()}}),p=(0,n.Mz)((e=>e),((e,s)=>v(s)),((e,s)=>s(e).data)),h=(0,n.Mz)(((e,s)=>p(e,s)),((e,s)=>(0,c.K)(e,s.database)),((e,s)=>null!==e&&void 0!==e&&e.TabletStateInfo?s?e.TabletStateInfo.map((e=>{var a;const t=void 0===e.NodeId||null===(a=s.get(e.NodeId))||void 0===a?void 0:a.Host;return{...e,fqdn:t}})):e.TabletStateInfo:[]));var m=a(6354),g=a(7435),b=a(47779),f=a(88616),j=a(60712);const N=[m.r.Created,m.r.ResolveStateStorage,m.r.Candidate,m.r.BlockBlobStorage,m.r.RebuildGraph,m.r.WriteZeroEntry,m.r.Restored,m.r.Discover,m.r.Lock,m.r.Active,m.r.ResolveLeader,m.r.Terminating];function x({nodeId:e,path:s,database:a,databaseFullPath:n,onlyActive:r,scrollContainerRef:o}){const[d]=(0,b.Nt)();let c={};const v=r?`(State=[${N.join(",")}])`:void 0,p=t.useMemo((()=>{if(!(0,i.isNil)(s)&&!(0,i.isNil)(n))return{path:s,databaseFullPath:n}}),[s,n]);(0,g.f8)(e)?c={nodeId:e,database:a,filter:v}:p&&(c={path:p,database:a,filter:v});const{isLoading:m,error:x}=u.useGetTabletsInfoQuery(0===Object.keys(c).length?l.hT:c,{pollingInterval:d}),k=(0,b.N4)((e=>h(e,c)));return(0,j.jsx)(f.Q,{scrollContainerRef:o,tablets:k,loading:m,error:x,nodeId:e})}},78491:(e,s,a)=>{a.d(s,{$:()=>n});var t=a(32752),l=a(20263),i=a(60712);function n({header:e,note:s}){return(0,i.jsxs)(t.s,{gap:1,alignItems:"center",children:[e,(0,i.jsx)(l.H,{popoverProps:{placement:["right","left"]},children:s})]})}}}]);