"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[34100],{9252:(e,t,r)=>{r.d(t,{k:()=>s});var a=r(74281),n=r(88610),o=r(60712);const s=({value:e,onChange:t,className:r})=>(0,o.jsxs)(a.x,{value:e,onUpdate:t,className:r,children:[(0,o.jsx)(a.x.Option,{value:n.s$.ALL,children:n.s$.ALL}),(0,o.jsx)(a.x.Option,{value:n.s$.PROBLEMS,children:n.s$.PROBLEMS})]})},11363:(e,t,r)=>{r.d(t,{G:()=>se});var a=r(59284),n=r(86782),o=r(67028),s=r(12888),l=r(98167),i=r(53627),d=r(88610);function u(){const e=(0,i.YQ)();return{problemFilter:(0,i.N4)(d.yV),handleProblemFilterChange:t=>{e((0,d.$u)(t))}}}var c=r(78034),h=r(80987),p=r(48372);const m=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),g=(0,p.g4)("ydb-nodes",{en:m}),b=["database","static","other","any"],v={get database(){return g("database")},get static(){return g("static")},get other(){return g("other")},get any(){return g("any")}};const y="nodesTableSelectedColumns",f=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],x=["NodeId"],w=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function N(e,t){return t?e:e.filter((e=>"SystemState"!==e))}function C(e,t){var r;const[a,n]=(0,h.useQueryParams)({uptimeFilter:h.StringParam,peerRole:h.StringParam,search:h.StringParam,nodesGroupBy:h.StringParam}),l=(0,s.b)(),i=c.Bm.parse(a.uptimeFilter),d=null!==(r=a.search)&&void 0!==r?r:"";let u;t&&(u=l?function(e,t){var r;return null!==(r=b.find((t=>t===e)))&&void 0!==r?r:t}(a.peerRole,"database"):"database");const p=(0,o.DM)(),m=function(e,t,r){return N(t,r).find((t=>t===e))}(a.nodesGroupBy,null!==e&&void 0!==e?e:[],p);return{uptimeFilter:i,searchValue:d,peerRoleFilter:u,groupByParam:m,handleSearchQueryChange:e=>{n({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{n({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{n({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{n({nodesGroupBy:e},"replaceIn")}}}var j=r(13847),S=r(44508),F=r(42265),T=r(10671),P=r(15298),k=r(43951),I=r(71708),R=r(62710),_=r(88908),A=r(12207),B=r(28539),D=r(9252),G=r(95963),E=r(64934),W=r(74281),O=r(60712);function L({value:e="database",onChange:t}){return(0,O.jsx)(W.x,{value:e,onUpdate:t,children:b.map((e=>(0,O.jsx)(W.x.Option,{value:e,children:v[e]},e)))})}const V=(0,r(77506).cn)("ydb-nodes"),$=e=>V("node",{unavailable:(0,c.X7)(e)});function q({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:r,entitiesCountCurrent:l,entitiesCountTotal:i,entitiesLoading:d}){const{searchValue:c,uptimeFilter:h,peerRoleFilter:p,groupByParam:m,handleSearchQueryChange:b,handleUptimeFilterChange:v,handlePeerRoleFilterChange:y,handleGroupByParamChange:f}=C(t,r),{problemFilter:x,handleProblemFilterChange:w}=u(),j=(0,s.b)(),S=(0,o.DM)(),F=function(e,t){return N(e,t).map((e=>({value:e,content:(0,n.kn)(e)})))}(t,S),T=(0,o.WF)(),P=r&&T&&j;return(0,O.jsxs)(a.Fragment,{children:[(0,O.jsx)(G.v,{onChange:b,placeholder:g("controls_search-placeholder"),width:238,value:c}),S&&e?null:(0,O.jsx)(D.k,{value:x,onChange:w}),e?null:(0,O.jsx)(E.j,{value:h,onChange:v}),P?(0,O.jsxs)(a.Fragment,{children:[(0,O.jsx)(_.E,{variant:"body-2",children:g("controls_peer-role-label")}),(0,O.jsx)(L,{value:p,onChange:y})]}):null,e?(0,O.jsxs)(a.Fragment,{children:[(0,O.jsx)(_.E,{variant:"body-2",children:g("controls_group-by-placeholder")}),(0,O.jsx)(A.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:m?[m]:void 0,onUpdate:e=>{f(e[0])},options:F,className:V("group-by-select"),popupClassName:V("group-by-popup")})]}):null,(0,O.jsx)(B.T,{current:l,total:i,label:g("nodes"),loading:d})]})}var M=r(78524),H=r(62783),U=r(81101),z=r(11906),K=r(69464),Q=r(40781);const Y=async e=>{const{type:t="any",storage:r=!1,limit:a,offset:o,sortParams:s,filters:l,columnsIds:i}=e,{sortOrder:d,columnId:u}=null!==s&&void 0!==s?s:{},{path:h,databaseFullPath:p,database:m,searchValue:g,problemFilter:b,uptimeFilter:v,peerRoleFilter:y,filterGroup:f,filterGroupBy:x}=null!==l&&void 0!==l?l:{},w=(0,n.kU)(u),N=w?(0,K.T)(w,d):void 0,C=(0,Q.R)(i,n.fN),S=(0,j.isNil)(h)||(0,j.isNil)(p)?void 0:{path:h,databaseFullPath:p},F=await window.api.viewer.getNodes({type:t,storage:r,limit:a,offset:o,sort:N,path:S,database:m,filter:g,problems_only:(0,c.AB)(b),uptime:(0,c.Fo)(v),filter_peer_role:y,filter_group:f,filter_group_by:x,fieldsRequired:C}),T=(0,z.N)(F);return{data:T.Nodes||[],found:T.FoundNodes||0,total:T.TotalNodes||0}};function J({path:e,database:t,databaseFullPath:r,searchValue:o,problemFilter:s,uptimeFilter:l,peerRoleFilter:i,filterGroup:d,filterGroupBy:u,columns:h,scrollContainerRef:p,initialEntitiesCount:m}){const b=a.useMemo((()=>({path:e,databaseFullPath:r,database:t,searchValue:o,problemFilter:s,uptimeFilter:l,peerRoleFilter:i,filterGroup:d,filterGroupBy:u})),[e,r,t,o,s,l,i,d,u]);return(0,O.jsx)(H.k5,{columnsWidthLSKey:n.zO,scrollContainerRef:p,columns:h,fetchData:Y,initialEntitiesCount:m,renderErrorMessage:U.$,renderEmptyDataMessage:()=>"All"!==s||l!==c.cW.All?(0,O.jsx)(M.v,{name:"thumbsUp",width:"200"}):g("empty.default"),getRowClassName:$,filters:b,tableName:"nodes"})}const X=a.memo((function({name:e,count:t,isExpanded:r,path:a,database:n,databaseFullPath:o,searchValue:s,peerRoleFilter:l,groupByParam:i,columns:d,scrollContainerRef:u,onIsExpandedChange:h}){return(0,O.jsx)(I.Q,{title:e,count:t,entityName:g("nodes"),expanded:r,onIsExpandedChange:h,children:(0,O.jsx)(F.o,{initialState:{sortParams:void 0},table:(0,O.jsx)(J,{path:a,databaseFullPath:o,database:n,searchValue:s,problemFilter:"All",uptimeFilter:c.cW.All,peerRoleFilter:l,filterGroup:e,filterGroupBy:i,initialEntitiesCount:t,columns:d,scrollContainerRef:u}),tableWrapperProps:{scrollContainerRef:u}})},e)}));function Z({path:e,databaseFullPath:t,database:r,scrollContainerRef:o,withPeerRoleFilter:s,columns:l,defaultColumnsIds:d,requiredColumnsIds:u,selectedColumnsKey:c,groupByParams:h}){const{searchValue:p,peerRoleFilter:m,groupByParam:b}=C(h,s),[v]=(0,i.Nt)(),{columnsToShow:y,columnsToSelect:f,setColumns:x}=(0,k.K)(l,c,n.uG,d,u),w=a.useMemo((()=>{if(!(0,j.isNil)(e)&&!(0,j.isNil)(t))return{path:e,databaseFullPath:t}}),[e,t]),{currentData:N,isFetching:I,error:_}=P.s.useGetNodesQuery({path:w,database:r,filter:p,filter_peer_role:m,group:b,limit:0},{pollingInterval:v}),A=void 0===N&&I,{NodeGroups:B,FoundNodes:D=0,TotalNodes:G=0}=N||{},{expandedGroups:E,setIsGroupExpanded:W}=(0,R.$)(B),L=a.useMemo((()=>({foundEntities:D,totalEntities:G,isInitialLoad:A,sortParams:void 0})),[D,G,A]);return(0,O.jsx)(F.o,{initialState:L,controls:(0,O.jsx)(q,{groupByParams:h,withPeerRoleFilter:s,entitiesCountCurrent:D,entitiesCountTotal:G,entitiesLoading:A,withGroupBySelect:!0}),extraControls:(0,O.jsx)(T.O,{popupWidth:200,items:f,showStatus:!0,onUpdate:x,sortable:!1}),error:_?(0,O.jsx)(S.o,{error:_}):null,table:null!==B&&void 0!==B&&B.length?B.map((({name:a,count:n})=>{const s=E[a];return(0,O.jsx)(X,{name:a,count:n,isExpanded:s,path:e,databaseFullPath:t,database:r,searchValue:p,peerRoleFilter:m,groupByParam:b,columns:y,scrollContainerRef:o,onIsExpandedChange:W},a)})):g("no-nodes-groups"),tableWrapperProps:{scrollContainerRef:o,scrollDependencies:[p,b,B,m],loading:A,className:V("groups-wrapper")}})}var ee=r(49554);function te({withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:r}){const{tableState:a}=(0,ee.WV)();return(0,O.jsx)(q,{withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:r,entitiesCountCurrent:a.foundEntities,entitiesCountTotal:a.totalEntities,entitiesLoading:a.isInitialLoad})}function re({path:e,database:t,databaseFullPath:r,scrollContainerRef:a,withPeerRoleFilter:s,columns:l,defaultColumnsIds:i,requiredColumnsIds:d,selectedColumnsKey:c,groupByParams:h}){const{searchValue:p,uptimeFilter:m,peerRoleFilter:g}=C(h,s),{problemFilter:b}=u(),v=(0,o.Ye)(),{columnsToShow:y,columnsToSelect:f,setColumns:x}=(0,k.K)(l,c,n.uG,i,d);return(0,O.jsx)(F.o,{controls:(0,O.jsx)(te,{withGroupBySelect:v,groupByParams:h,withPeerRoleFilter:s}),extraControls:(0,O.jsx)(T.O,{popupWidth:200,items:f,showStatus:!0,onUpdate:x,sortable:!1}),table:(0,O.jsx)(J,{path:e,database:t,databaseFullPath:r,searchValue:p,problemFilter:b,uptimeFilter:m,peerRoleFilter:g,columns:y,scrollContainerRef:a}),tableWrapperProps:{scrollContainerRef:a,scrollDependencies:[p,b,m,g]}})}function ae(e){const{uptimeFilter:t,groupByParam:r,handleUptimeFilterChange:n}=C(e.groupByParams,e.withPeerRoleFilter),{problemFilter:s,handleProblemFilterChange:i}=u(),d=(0,o.Pm)(),h=(0,o.Ye)();a.useEffect((()=>{!h||"All"===s&&t===c.cW.All||(i("All"),n(c.cW.All))}),[i,n,s,t,h]);return(0,O.jsx)(l.r,{loading:!d,children:h&&r?(0,O.jsx)(Z,{...e}):(0,O.jsx)(re,{...e})})}var ne=r(95109);function oe(e){return[(0,ne._E)(),(0,ne.Nh)(e),(0,ne.eT)(),(0,ne.uk)(),(0,ne.OV)(),(0,ne.OX)(),(0,ne.jl)(),(0,ne.fr)(),(0,ne.kv)(),(0,ne.pH)(),(0,ne.iX)(),(0,ne.ID)(),(0,ne.Rn)(),(0,ne.qp)(e)].map((e=>({...e,sortable:(0,n.sp)(e.name)})))}function se({path:e,database:t,databaseFullPath:r,scrollContainerRef:l,additionalNodesProps:i,withPeerRoleFilter:d,columns:u=oe({database:t,getNodeRef:null===i||void 0===i?void 0:i.getNodeRef}),defaultColumnsIds:c=f,requiredColumnsIds:h=x,selectedColumnsKey:p=y,groupByParams:m=w}){const g=(0,o.Z9)(),b=a.useMemo((()=>g?u:u.filter((e=>e.name!==n.vg.PileName))),[g,u]),v=a.useMemo((()=>g?c.includes(n.vg.PileName)?c:[...c,n.vg.PileName]:c),[g,c]),N=(0,s.X)(),C=(0,s.b)(),j=a.useMemo((()=>{if(N)return b;const e=b.filter((e=>!(0,n.xd)(e.name)));return C?e:e.filter((e=>!(0,n.ri)(e.name)))}),[b,N,C]),S=a.useMemo((()=>g&&m?m.includes("PileName")?m:[...m,"PileName"]:m),[g,m]);return(0,O.jsx)(ae,{path:e,databaseFullPath:r,database:t,scrollContainerRef:l,withPeerRoleFilter:d,columns:j,defaultColumnsIds:v,requiredColumnsIds:h,selectedColumnsKey:p,groupByParams:S})}},11906:(e,t,r)=>{r.d(t,{N:()=>n});var a=r(78034);const n=e=>{var t;const r=(e.Nodes||[]).map((e=>{const{SystemState:t,...r}=e;return{...r,...(0,a.q1)(t)}}));return{Nodes:r,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||r.length,FoundNodes:Number(e.FoundNodes)}}},14221:()=>{},15298:(e,t,r)=>{r.d(t,{s:()=>o});var a=r(21334),n=r(11906);const o=a.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const r=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,n.N)(r)}}catch(r){return{error:r}}},providesTags:["All"]})}),overrideExisting:"throw"})},18836:(e,t,r)=>{r.d(t,{s:()=>s,v:()=>o});var a=r(56839),n=r(35736);function o({colorizeProgress:e=!0,warningThreshold:t,dangerThreshold:r,inverseColorize:o=!1,fillWidth:s}){const l=Math.max(s,.5);return{status:(0,n.w)({fillWidth:s,warningThreshold:t,dangerThreshold:r,colorizeProgress:e,inverseColorize:o}),percents:(0,a.l9)(s/100),fill:l}}function s({value:e,capacity:t,legendFormatter:r,...a}){const n=parseFloat(String(e)),s=parseFloat(String(t));let l=n/s*100||0;l=l>100?100:l;const i=r({value:n,capacity:s});return{...o({fillWidth:l,...a}),legend:i}}},21049:(e,t,r)=>{r.d(t,{e:()=>m});var a=r(59284),n=r(32752),o=r(88908),s=r(20263),l=r(77506),i=r(60712);function d({cx:e,cy:t,r:r,stroke:a,strokeWidth:n,strokeDasharray:o,strokeDashoffset:s,strokeLinecap:l="butt",fill:d="none",className:u}){return(0,i.jsx)("circle",{cx:e,cy:t,r:r,fill:d,stroke:a,strokeWidth:n,strokeDasharray:o,strokeDashoffset:s,strokeLinecap:l,className:u})}const u={small:{width:65,strokeWidth:12,textVariant:"subheader-1"},medium:{width:100,strokeWidth:16,textVariant:"subheader-2"},large:{width:130,strokeWidth:20,textVariant:"subheader-3"}},c=.75;const h=(0,l.cn)("ydb-doughnut-metrics"),p=a.createContext("medium");function m({status:e,fillWidth:t,children:r,className:a,size:n="medium"}){const o=u[n],s=(o.width-o.strokeWidth)/2,l=function(e){return 2*Math.PI*e}(s),m=l*c,g=o.width/2,b=o.width/2,v=function(e,t){if(e<=0)return"0 0";const r=Math.min(e,100)/100*t;return`${r} ${t-r}`}(t,l),y=function(e,t){if(e<=100)return"0 0";const r=(e-100)/100*t;return`${r} ${t-r}`}(t,l),f=t>100;return(0,i.jsx)(p.Provider,{value:n,children:(0,i.jsxs)("div",{className:h({status:e},a),children:[(0,i.jsxs)("svg",{width:o.width,height:o.width,className:h("doughnut"),children:[(0,i.jsx)(d,{cx:g,cy:b,r:s,stroke:"var(--doughnut-backdrop-color)",strokeWidth:o.strokeWidth}),(0,i.jsx)(d,{cx:g,cy:b,r:s,stroke:"var(--doughnut-color)",strokeWidth:o.strokeWidth,strokeDasharray:v,strokeDashoffset:m,className:h("progress-circle")}),f&&(0,i.jsx)(d,{cx:g,cy:b,r:s,stroke:"var(--doughnut-overlap-color)",strokeWidth:o.strokeWidth,strokeDasharray:y,strokeDashoffset:m,className:h("overlap-circle")})]}),(0,i.jsx)("div",{className:h("text-wrapper"),children:r})]})})}m.Legend=function({children:e,variant:t="subheader-3",color:r="primary",note:a,noteIconSize:l="m"}){return(0,i.jsxs)(n.s,{gap:1,alignItems:"center",children:[(0,i.jsx)(o.E,{variant:t,color:r,className:h("legend"),as:"div",children:e}),a&&(0,i.jsx)(s.H,{iconSize:l,className:h("legend-note"),popoverProps:{placement:"right"},children:a})]})},m.Value=function({children:e,variant:t}){const r=a.useContext(p),n=t||u[r].textVariant;return(0,i.jsx)(o.E,{variant:n,className:h("value"),children:e})}},21545:(e,t,r)=>{r.d(t,{X:()=>n});var a=r(78034);const n=r(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:r},{signal:n})=>{try{const[o,s,l]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:r},{signal:n}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:n}),window.api.viewer.getNodesList({database:t},{signal:n})]),i=(0,a.nN)(l),d=Object.keys(s).reduce(((e,t)=>{var r;const a=null===(r=s[t])||void 0===r?void 0:r.TabletStateInfo;return null===a||void 0===a||a.forEach((r=>{var a;const{ChangeTime:n,Generation:o,State:s,Leader:l,FollowerId:d}=r,u=i&&t?null===(a=i.get(Number(t)))||void 0===a?void 0:a.Host:void 0;e.push({nodeId:t,generation:o,changeTime:n,state:s,leader:l,followerId:d,fqdn:u})})),e}),[]),{TabletStateInfo:u=[]}=o,c=void 0===r?u.find((e=>e.Leader)):u.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===r})),{TabletId:h}=c||{};return{data:{id:h,data:c,history:d}}}catch(o){return{error:o}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e,database:t},{signal:r})=>{try{const a=await window.api.viewer.getTabletDescribe(e,t,{signal:r}),{SchemeShard:n,PathId:o}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${n}:${o}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:r})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:r})}}catch(a){return{error:a}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,r)=>{r.d(t,{B:()=>d});var a=r(59284),n=r(80136),o=r(58611),s=r(55974),l=r(42829),i=r(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:r,dialogHeader:d,dialogText:u,retryButtonText:c,buttonDisabled:h=!1,buttonView:p="action",buttonTitle:m,buttonClassName:g,withPopover:b=!1,popoverContent:v,popoverPlacement:y="right",popoverDisabled:f=!0}){const[x,w]=a.useState(!1),[N,C]=a.useState(!1),[j,S]=a.useState(!1),F=()=>(0,i.jsx)(n.$,{onClick:()=>w(!0),view:p,disabled:h,loading:!h&&N,className:g,title:m,children:e});return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsx)(s.g,{visible:x,header:d,text:u,withRetry:j,retryButtonText:c,onConfirm:async e=>{C(!0),await t(e)},onConfirmActionSuccess:async()=>{S(!1);try{await(null===r||void 0===r?void 0:r())}finally{C(!1)}},onConfirmActionError:e=>{S((0,l.D)(e)),C(!1)},onClose:()=>{w(!1)}}),b?(0,i.jsx)(o.A,{content:v,placement:y,disabled:f,children:F()}):F()]})}},27775:(e,t,r)=>{r.d(t,{i:()=>s});var a=r(52443),n=r(58267),o=r(60712);function s({state:e}){return(0,o.jsx)(a.J,{theme:(0,n._)(e),children:e})}},28539:(e,t,r)=>{r.d(t,{T:()=>a.T});var a=r(53755)},37477:(e,t,r)=>{r.d(t,{c:()=>C});r(59284);var a=r(8979),n=r(52443),o=r(32752),s=r(20263),l=r(54090),i=r(77506),d=r(43937),u=r(36388),c=r(94420),h=r(70825),p=r(49917),m=r(47653),g=r(60712);const b={[l.m.Blue]:d.A,[l.m.Yellow]:u.A,[l.m.Orange]:c.A,[l.m.Red]:u.A,[l.m.Green]:h.A,[l.m.Grey]:p.A};function v({status:e,...t}){return e?(0,g.jsx)(m.I,{...t,data:b[e]}):null}var y=r(89732),f=r(97677);const x=(0,i.cn)("ydb-entity-status-new"),w={[l.m.Red]:"danger",[l.m.Blue]:"info",[l.m.Green]:"success",[l.m.Grey]:"unknown",[l.m.Orange]:"orange",[l.m.Yellow]:"warning"},N={get[l.m.Red](){return(0,y.A)("title_red")},get[l.m.Yellow](){return(0,y.A)("title_yellow")},get[l.m.Orange](){return(0,y.A)("title_orange")},get[l.m.Green](){return(0,y.A)("title_green")},get[l.m.Grey](){return(0,y.A)("title_grey")},get[l.m.Blue](){return(0,y.A)("title_blue")}};function C({className:e,children:t}){return(0,g.jsx)(o.s,{gap:"2",wrap:"nowrap",alignItems:"center",className:x(null,e),children:t})}C.Label=function({children:e,status:t,withStatusName:r=!0,note:l,size:i="m",iconSize:d=14}){const u=w[t];return(0,g.jsx)(a.m,{title:f.D[t],disabled:Boolean(l),children:(0,g.jsx)(n.J,{theme:"orange"===u?void 0:u,icon:(0,g.jsx)(v,{size:d,status:t}),size:i,className:x({orange:"orange"===u}),children:(0,g.jsxs)(o.s,{gap:"2",wrap:"nowrap",children:[e,r?N[t]:null,l&&(0,g.jsx)(s.H,{className:x("note"),children:l})]})})})},C.displayName="EntityStatus"},42829:(e,t,r)=>{r.d(t,{D:()=>a});const a=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55340:(e,t,r)=>{r.d(t,{x:()=>c});var a=r(11363),n=r(95109),o=r(86782);const s="networkNodesTableSelectedColumns",l=["NodeId","NetworkHost","Connections","NetworkUtilization","SendThroughput","ReceiveThroughput","PingTime","ClockSkew"],i=["NodeId","NetworkHost"],d=["Host","DC","Rack","Uptime","ConnectStatus","NetworkUtilization","PingTime","ClockSkew"];var u=r(60712);function c({database:e,databaseFullPath:t,path:r,scrollContainerRef:c,additionalNodesProps:h}){return(0,u.jsx)(a.G,{path:r,database:e,databaseFullPath:t,scrollContainerRef:c,withPeerRoleFilter:Boolean(e),additionalNodesProps:h,columns:(p={database:e,getNodeRef:null===h||void 0===h?void 0:h.getNodeRef},[(0,n._E)(),(0,n.b8)(p),(0,n.uk)(),(0,n.OX)(),(0,n.jl)(),(0,n.fr)(),(0,n.kv)(),(0,n.SH)(),(0,n.H)(),(0,n.DH)(),(0,n.ui)(),(0,n.wN)(),(0,n.pt)()].map((e=>({...e,sortable:(0,o.sp)(e.name)})))),defaultColumnsIds:l,requiredColumnsIds:i,selectedColumnsKey:s,groupByParams:d});var p}},55974:(e,t,r)=>{r.d(t,{g:()=>y});var a=r(59284),n=r(18677),o=r(71153),s=r(48139),l=r(71989),i=r(47653),d=r(56999),u=r(77506),c=r(81288),h=r(48372);const p=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),m=(0,h.g4)("ydb-critical-action-dialog",{en:p});var g=r(60712);const b=(0,u.cn)("ydb-critical-dialog"),v=e=>{if((0,c.cH)(e)){if(403===e.status)return m("no-rights-error");if("string"===typeof e.data)return e.data;if((0,c._E)(e)&&e.data)return(0,g.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return m("default-error")};function y({visible:e,header:t,text:r,withRetry:d,retryButtonText:u,withCheckBox:c,onClose:h,onConfirm:p,onConfirmActionSuccess:y,onConfirmActionError:f}){const[x,w]=a.useState(!1),[N,C]=a.useState(),[j,S]=a.useState(!1),F=async e=>(w(!0),p(e).then((()=>{y(),h()})).catch((e=>{f(e),C(e)})).finally((()=>{w(!1)})));return(0,g.jsx)(l.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:h,onTransitionOutComplete:()=>{C(void 0),S(!1)},children:N?(0,g.jsxs)(a.Fragment,{children:[(0,g.jsx)(l.l.Header,{caption:t}),(0,g.jsx)(l.l.Body,{className:b("body"),children:(0,g.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,g.jsx)("span",{className:b("error-icon"),children:(0,g.jsx)(n.A,{width:"24",height:"22"})}),v(N)]})}),(0,g.jsx)(l.l.Footer,{loading:!1,preset:"default",textButtonApply:d?u||m("button-retry"):void 0,textButtonCancel:m("button-close"),onClickButtonApply:()=>F(!0),onClickButtonCancel:h})]}):(0,g.jsxs)(a.Fragment,{children:[(0,g.jsx)(l.l.Header,{caption:t}),(0,g.jsxs)(l.l.Body,{className:b("body"),children:[(0,g.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,g.jsx)("span",{className:b("warning-icon"),children:(0,g.jsx)(i.I,{data:o.A,size:24})}),r]}),c?(0,g.jsx)(s.S,{checked:j,onUpdate:S,children:m("checkbox-text")}):null]}),(0,g.jsx)(l.l.Footer,{loading:x,preset:"default",textButtonApply:m("button-confirm"),textButtonCancel:m("button-cancel"),propsButtonApply:{type:"submit",disabled:c&&!j},onClickButtonCancel:h,onClickButtonApply:()=>F()})]})})}},56999:(e,t,r)=>{r.d(t,{O:()=>w});var a=r(59284),n=r(45720),o=r(16929),s=r(71153),l=r(18677),i=r(80136),d=r(60461),u=r(78540),c=r(47653),h=r(74529),p=r(77506),m=r(41650);const g=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function b(e){return function(e){return!!e&&void 0!==g[e]}(e)?g[e]:"S_INFO"}var v=r(60712);const y=(0,p.cn)("kv-result-issues"),f=(0,p.cn)("kv-issues"),x=(0,p.cn)("kv-issue");function w({data:e,hideSeverity:t}){const[r,n]=a.useState(!1),o="string"===typeof e||null===e||void 0===e?void 0:e.issues,s=Array.isArray(o)&&o.length>0;return(0,v.jsxs)("div",{className:y(),children:[(0,v.jsxs)("div",{className:y("error-message"),children:[(()=>{let r;if("string"===typeof e)r=e;else{var n,o;const s=b(null===e||void 0===e||null===(n=e.error)||void 0===n?void 0:n.severity);r=(0,v.jsxs)(a.Fragment,{children:[t?null:(0,v.jsxs)(a.Fragment,{children:[(0,v.jsx)(P,{severity:s})," "]}),(0,v.jsx)("span",{className:y("error-message-text"),children:null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message})]})}return r})(),s&&(0,v.jsx)(i.$,{view:"normal",onClick:()=>n(!r),children:r?"Hide details":"Show details"})]}),s&&r&&(0,v.jsx)(N,{hideSeverity:t,issues:o})]})}function N({issues:e,hideSeverity:t}){const r=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var r;const a=null!==(r=t.severity)&&void 0!==r?r:10;return Math.min(e,a)}),10);return(0,v.jsx)("div",{className:f(null),children:null===e||void 0===e?void 0:e.map(((e,a)=>(0,v.jsx)(C,{hideSeverity:t,issue:e,expanded:e===r},a)))})}function C({issue:e,hideSeverity:t,level:r=0}){const[n,o]=a.useState(!0),s=b(e.severity),l=e.issues,u=Array.isArray(l)&&l.length>0,c=n?"bottom":"right";return(0,v.jsxs)("div",{className:x({leaf:!u,"has-issues":u}),children:[(0,v.jsxs)("div",{className:x("line"),children:[u&&(0,v.jsx)(i.$,{view:"flat-secondary",onClick:()=>o(!n),className:x("arrow-toggle"),children:(0,v.jsx)(d.I,{direction:c,size:16})}),t?null:(0,v.jsx)(P,{severity:s}),(0,v.jsx)(j,{issue:e}),e.issue_code?(0,v.jsxs)("span",{className:x("code"),children:["Code: ",e.issue_code]}):null]}),u&&n&&(0,v.jsx)("div",{className:x("issues"),children:(0,v.jsx)(S,{issues:l,level:r+1,expanded:n})})]})}function j({issue:e}){var t;const r=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,m.kf)(t.row))return"";const{row:r,column:a}=t;return(0,m.kf)(a)?`${r}:${a}`:`line ${r}`}(e),a=window.ydbEditor,n=()=>(0,v.jsxs)("span",{className:x("message"),children:[r&&(0,v.jsx)("span",{className:x("place-text"),title:"Position",children:r}),(0,v.jsx)("div",{className:x("message-text"),children:(0,v.jsx)(h.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:o,column:s}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,m.kf)(o)&&a))return n();return(0,v.jsx)(u.N,{href:"#",onClick:()=>{const e={lineNumber:o,column:null!==s&&void 0!==s?s:0};a.setPosition(e),a.revealPositionInCenterIfOutsideViewport(e),a.focus()},view:"primary",draggable:!1,children:n()})}function S(e){const{issues:t,level:r,expanded:a}=e;return(0,v.jsx)("div",{className:x("list"),children:t.map(((e,t)=>(0,v.jsx)(C,{issue:e,level:r,expanded:a},t)))})}const F={S_INFO:n.A,S_WARNING:o.A,S_ERROR:s.A,S_FATAL:l.A},T=(0,p.cn)("yql-issue-severity");function P({severity:e}){const t=e.slice(2).toLowerCase();return(0,v.jsxs)("span",{className:T({severity:t}),children:[(0,v.jsx)(c.I,{className:T("icon"),data:F[e]}),(0,v.jsx)("span",{className:T("title"),children:t})]})}},57428:(e,t,r)=>{r.d(t,{vs:()=>i,cO:()=>l});r(46549);var a=r(56839),n=r(48372);const o=JSON.parse('{"context_of":"of","context_cores":"cores"}'),s=(0,n.g4)("ydb-metrics",{en:o});function l({value:e,capacity:t}){const r=(0,a.j9)(e,t,void 0,"\n");return`${r[0]} ${s("context_of")} ${r[1]}`}function i({value:e,capacity:t}){let r=[];return r=t<1e4?[(0,a.ZV)(Math.round(e)),(0,a.ZV)(Math.round(t))]:(0,a.Nd)(e,t,void 0,"",!0),`${r[0]} ${s("context_of")} ${r[1]} ${s("context_cores")}`}},74529:(e,t,r)=>{r.d(t,{A:()=>h});var a=r(59284),n=r(78540),o=r(77506),s=r(48372);const l=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),i=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,s.g4)("ydb-shorty-string",{ru:i,en:l});var u=r(60712);const c=(0,o.cn)("kv-shorty-string");function h({value:e="",limit:t=200,strict:r=!1,displayLength:o=!0,render:s=e=>e,onToggle:l,expandLabel:i=d("default_expand_label"),collapseLabel:h=d("default_collapse_label")}){const[p,m]=a.useState(!1),g=(p?h:i)+(o&&!p?d("chars_count",{count:e.length}):""),b=e.length>t+(r?0:g.length),v=p||!b?e:e.slice(0,t-4)+"\xa0...";return(0,u.jsxs)("div",{className:c(),children:[s(v),b?(0,u.jsx)(n.N,{className:c("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),m((e=>!e)),null===l||void 0===l||l()},children:g}):null]})}},78321:(e,t,r)=>{r.d(t,{b:()=>s,s:()=>l});var a=r(67028),n=r(76086),o=r(53627);function s(){const e=(0,a.WF)(),[t]=(0,o.iK)(n.g5);return Boolean(e&&t)}function l(){const e=(0,a.DY)(),[t]=(0,o.iK)(n.g5);return Boolean(e&&t)}},88616:(e,t,r)=>{r.d(t,{Q:()=>k});var a=r(59284),n=r(76938),o=r(88908),s=r(47653),l=r(13847),i=r(80987),d=r(22983),u=r(28539),c=r(10508),h=r(44508),p=r(43615),m=r(17594),g=r(59134),b=r(69326),v=r(74591),y=r(27775),f=r(41826),x=r(21545),w=r(6354),N=r(76086),C=r(12888),j=r(48372);const S=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),F=(0,j.g4)("ydb-tablets",{en:S});var T=r(60712);function P(e){const t=e.State===w.r.Stopped,r=(0,C.X)(),[a]=x.X.useKillTabletMutation(),o=e.TabletId;return o?(0,T.jsx)(d.B,{buttonView:"outlined",buttonTitle:F("dialog.kill-header"),dialogHeader:F("dialog.kill-header"),dialogText:F("dialog.kill-text"),onConfirmAction:()=>a({id:o}).unwrap(),buttonDisabled:t||!r,withPopover:!0,popoverContent:F(r?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","bottom"],popoverDisabled:!1,children:(0,T.jsx)(s.I,{data:n.A})}):null}function k({database:e,tablets:t,loading:r,error:n,scrollContainerRef:s,nodeId:d}){const[{tabletsSearch:x},w]=(0,i.useQueryParams)({tabletsSearch:i.StringParam}),[C,j]=a.useState(),S=a.useMemo((()=>function({database:e,nodeId:t}){const r=[{name:"Type",width:150,get header(){return F("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,T.jsxs)("span",{children:[e.Type," ",t?(0,T.jsx)(o.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return F("Tablet")},render:({row:t})=>t.TabletId?(0,T.jsx)(v.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):N.Pd},{name:"State",get header(){return F("State")},render:({row:e})=>(0,T.jsx)(y.i,{state:e.State})}];return void 0===t&&r.push({name:"NodeId",get header(){return F("Node ID")},render:({row:e})=>(0,l.isNil)(e.NodeId)?N.Pd:(0,T.jsx)(p.W,{id:e.NodeId}),align:"right"},{name:"fqdn",get header(){return F("Node FQDN")},render:({row:e})=>e.fqdn?(0,T.jsx)(c.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):N.Pd}),r.push({name:"Generation",get header(){return F("Generation")},align:"right"},{name:"Uptime",get header(){return F("Uptime")},render:({row:e})=>(0,T.jsx)(f.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,T.jsx)(P,{...e})}),r}({database:e,nodeId:d})),[e,d]),k=a.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==x&&void 0!==x?x:"")))),[t,x]);return(0,T.jsxs)(b.L,{fullHeight:!0,children:[(0,T.jsxs)(b.L.Controls,{children:[(0,T.jsx)(g.v,{placeholder:F("controls.search-placeholder"),onChange:e=>{w({tabletsSearch:e||void 0},"replaceIn")},value:null!==x&&void 0!==x?x:"",width:238}),(0,T.jsx)(u.T,{label:F("controls.entities-count-label"),loading:r,total:t.length,current:k.length})]}),n?(0,T.jsx)(h.o,{error:n}):null,(0,T.jsx)(b.L.Table,{scrollContainerRef:s,scrollDependencies:[x,C],loading:r,children:(0,T.jsx)(m.l,{columns:S,data:k,settings:N.N3,emptyDataMessage:F("noTabletsData"),onSortChange:j})})]})}},89732:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(48372);const n=JSON.parse('{"title_red":"Critical","title_blue":"Normal","title_green":"Good","title_grey":"Unknown","title_orange":"Caution","title_yellow":"Warning","context_red":"Some systems are failed and not available","context_yellow":"There are minor issues","context_orange":"Critical state, requires immediate attention","context_green":"Everything is working as expected","context_grey":"The condition cannot be determined","context_blue":"All good, some parts of the system are restoring"}'),o=(0,a.g4)("ydb-entity-status",{en:n})},89898:(e,t,r)=>{r.d(t,{e:()=>i,g:()=>d});var a=r(59284),n=r(77506),o=(r(14221),r(60712));const s=(0,n.cn)("ydb-drawer"),l=a.createContext({containerWidth:0,itemContainerRef:null,setContainerWidth:()=>{}}),i=({children:e,className:t})=>{const[r,n]=a.useState(0),i=a.useRef(null),d=a.useRef(null);a.useEffect((()=>{if(!i.current)return;const e=()=>{i.current&&n(i.current.clientWidth)};e();const t=new ResizeObserver(e);return t.observe(i.current),()=>{i.current&&t.disconnect()}}),[]);const u=a.useMemo((()=>({containerWidth:r,setContainerWidth:n,itemContainerRef:d})),[r]);return(0,o.jsx)(l.Provider,{value:u,children:(0,o.jsxs)("div",{ref:i,className:s("drawer-container",t),children:[e,(0,o.jsx)("div",{ref:d,className:s("item-container")})]})})},d=()=>{const e=a.useContext(l);if(void 0===e)throw Error("useDrawerContext must be used within a DrawerContextProvider");return e}},95963:(e,t,r)=>{r.d(t,{v:()=>a.v});var a=r(59134)},97677:(e,t,r)=>{r.d(t,{D:()=>o});var a=r(54090),n=r(89732);const o={get[a.m.Red](){return(0,n.A)("context_red")},get[a.m.Yellow](){return(0,n.A)("context_yellow")},get[a.m.Orange](){return(0,n.A)("context_orange")},get[a.m.Green](){return(0,n.A)("context_green")},get[a.m.Grey](){return(0,n.A)("context_grey")},get[a.m.Blue](){return(0,n.A)("context_blue")}}}}]);