"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[352],{94790:(e,s,t)=>{t.d(s,{f:()=>a});var i=t(68963),o=t(44920),n=t(75859);const a=e=>{let{children:s,content:t,className:a,pinOnClick:l,hasArrow:r=!0,placement:d=["top","bottom"],...c}=e;const[u,m]=i.useState(!1),[p,v]=i.useState(!1),h=i.useRef(null);return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(o.G,{anchorRef:h,open:p||u,placement:d,hasArrow:r,onOutsideClick:()=>{v(!1)},...c,children:t}),(0,n.jsx)("span",{className:a,ref:h,onClick:l?()=>{v(!0)}:void 0,onMouseEnter:()=>{m(!0)},onMouseLeave:()=>{m(!1)},children:s})]})}},30832:(e,s,t)=>{t.d(s,{a:()=>l});var i=t(24362),o=t(98366),n=t(75859);const a=(0,i.cn)("ydb-entity-page-title");function l(e){let{entityName:s,status:t,id:i,className:l}=e;return(0,n.jsxs)("div",{className:a(null,l),children:[(0,n.jsx)("span",{className:a("prefix"),children:s}),(0,n.jsx)(o.J,{className:a("icon"),status:t,size:"s"}),i]})}},91816:(e,s,t)=>{t.d(s,{b:()=>c});var i=t(68963),o=t(56711),n=t(24362),a=t(42587),l=t(75859);const r=(0,n.cn)("ydb-info-viewer-skeleton"),d=()=>(0,l.jsxs)("div",{className:r("label"),children:[(0,l.jsx)(o.O,{className:r("label__text")}),(0,l.jsx)("div",{className:r("label__dots")})]}),c=e=>{let{rows:s=8,className:t,delay:n=600}=e;const[c]=(0,a.$)(n);let u=(0,l.jsxs)(i.Fragment,{children:[(0,l.jsx)(d,{}),(0,l.jsx)(o.O,{className:r("value")})]});return c||(u=null),(0,l.jsx)("div",{className:r(null,t),children:[...new Array(s)].map(((e,s)=>(0,l.jsx)("div",{className:r("row"),children:u},"skeleton-row-".concat(s))))})}},8659:(e,s,t)=>{t.d(s,{P:()=>N});var i=t(54665),o=t(14146),n=t(17880),a=t(5922),l=t(81854),r=t(24362),d=t(34301),c=t(48169),u=t(17096),m=t(69214),p=t(23373),v=t(32270),h=t(67359),g=t(30817);const D=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),k=(0,g.wZ)("ydb-pDisk-info",{en:D});var b=t(75859);const x=(0,r.cn)("ydb-pdisk-info");function N(e){let{pDisk:s,nodeId:t,withPDiskPageLink:r,className:g}=e;const D=(0,u.ix)(o.VH),N=(0,n.X_)(),[y,j,f,S]=function(e){let{pDisk:s,nodeId:t,withPDiskPageLink:o,isUserAllowedToMakeChanges:n}=e;const{PDiskId:r,Path:u,Guid:p,Category:g,Type:D,Device:N,Realtime:y,State:j,SerialNumber:f,TotalSize:S,AllocatedSize:I,StatusV2:w,NumActiveSlots:T,ExpectedSlotCount:E,LogUsedSize:P,LogTotalSize:C,SystemSize:M,SharedWithOs:z}=s||{},O=[];(0,a.D)(g)&&O.push({label:k("type"),value:D}),(0,a.D)(u)&&O.push({label:k("path"),value:u}),(0,a.D)(p)&&O.push({label:k("guid"),value:p}),f&&O.push({label:k("serial-number"),value:f}),(0,a.D)(z)&&O.push({label:k("shared-with-os"),value:k("yes")});const _=[];(0,a.D)(w)&&_.push({label:k("drive-status"),value:w}),(0,a.D)(j)&&_.push({label:k("state"),value:j}),(0,a.D)(N)&&_.push({label:k("device"),value:(0,b.jsx)(m.A,{status:N})}),(0,a.D)(y)&&_.push({label:k("realtime"),value:(0,b.jsx)(m.A,{status:y})});const A=[];A.push({label:k("space"),value:(0,b.jsx)(h.y,{value:I,capacity:S,formatValues:d.q3,colorizeProgress:!0})}),(0,a.D)(T)&&(0,a.D)(E)&&A.push({label:k("slots"),value:(0,b.jsx)(h.y,{value:T,capacity:E})}),(0,a.D)(P)&&(0,a.D)(C)&&A.push({label:k("log-size"),value:(0,b.jsx)(h.y,{value:P,capacity:C,formatValues:d.q3})}),(0,a.D)(M)&&A.push({label:k("system-size"),value:(0,l.td)({value:M})});const L=[];if((o||n)&&(0,a.D)(r)&&(0,a.D)(t)){const e=(0,i.ds)(r,t),s=(0,c.ok)({nodeId:t,pDiskId:r});L.push({label:k("links"),value:(0,b.jsxs)("span",{className:x("links"),children:[o&&(0,b.jsx)(v.j,{title:k("pdisk-page"),url:e,external:!1}),n&&(0,b.jsx)(v.j,{title:k("developer-ui"),url:s})]})})}return[O,_,A,L]}({pDisk:s,nodeId:t,withPDiskPageLink:r&&N,isUserAllowedToMakeChanges:D});return(0,b.jsxs)("div",{className:x("wrapper",g),children:[(0,b.jsxs)("div",{className:x("col"),children:[(0,b.jsx)(p._,{info:y,renderEmptyState:()=>null}),(0,b.jsx)(p._,{info:f,renderEmptyState:()=>null})]}),(0,b.jsxs)("div",{className:x("col"),children:[(0,b.jsx)(p._,{info:j,renderEmptyState:()=>null}),(0,b.jsx)(p._,{info:S,renderEmptyState:()=>null})]})]})}},27174:(e,s,t)=>{t.d(s,{B:()=>m});var i=t(77796),o=t(24362),n=t(50422),a=t(56711),l=t(42587),r=t(75859);const d=e=>{let{delay:s=600,className:t}=e;const[i]=(0,l.$)(s);return i?(0,r.jsx)(a.O,{className:t}):null},c=(0,o.cn)("ydb-page-meta");function u(e){let{items:s,loading:t}=e;return(0,r.jsx)("div",{className:c("info"),children:t?(0,r.jsx)(d,{className:c("skeleton")}):s.filter((e=>Boolean(e))).join("\xa0\xa0\xb7\xa0\xa0")})}function m(e){let{className:s,...t}=e;return(0,r.jsxs)(i.k,{gap:1,alignItems:"center",justifyContent:"space-between",className:c(null,s),children:[(0,r.jsx)(u,{...t}),(0,r.jsx)(n.q,{})]})}},22692:(e,s,t)=>{t.d(s,{h:()=>l});var i=t(56711),o=t(24362),n=t(75859);const a=(0,o.cn)("table-skeleton"),l=e=>{let{rows:s=2,className:t}=e;return(0,n.jsxs)("div",{className:a(null,t),children:[(0,n.jsxs)("div",{className:a("row"),children:[(0,n.jsx)(i.O,{className:a("col-1")}),(0,n.jsx)(i.O,{className:a("col-2")}),(0,n.jsx)(i.O,{className:a("col-3")}),(0,n.jsx)(i.O,{className:a("col-4")}),(0,n.jsx)(i.O,{className:a("col-5")})]}),[...new Array(s)].map(((e,s)=>(0,n.jsx)("div",{className:a("row"),children:(0,n.jsx)(i.O,{className:a("col-full")})},"skeleton-row-".concat(s))))]})}},11537:(e,s,t)=>{t.r(s),t.d(s,{PDiskPage:()=>Se});var i=t(68963),o=t(3475),n=t(88776),a=t(8179),l=t(17095),r=t(49352),d=t(52846),c=t(95408),u=t(65070),m=t(30832),p=t(26688),v=t(91816),h=t(68036),g=t(8659),D=t(27174),k=t(54665),b=t(905),x=t(14146),N=t(79061),y=t(11431),j=t(92666),f=t(5922),S=t(3764),I=t(51688),w=t(92092);const T=b.h.injectEndpoints({endpoints:e=>({getPdiskInfo:e.query({queryFn:async(e,s)=>{let{nodeId:t,pDiskId:i}=e,{signal:o}=s;try{const e=function(e){var s,t,i;let[o={},n]=e;const{BSC:a={},Whiteboard:l={}}=o||{},{PDisk:r={},VDisks:d=[]}=l,{PDisk:c={}}=a,u=(0,S.b)(r,c),{LogUsedSize:m,LogTotalSize:p,TotalSize:v,SystemSize:h,ExpectedSlotCount:g,EnforcedDynamicSlotSize:D}=u;let k;(0,f.D)(p)&&(k={SlotType:"log",Used:Number(m),Total:Number(p),UsagePercent:100*Number(m)/Number(p),Severity:1,SlotData:{LogUsedSize:m,LogTotalSize:p,SystemSize:h}});const b=d.map(S.w).sort(((e,s)=>Number(s.VDiskSlotId)-Number(e.VDiskSlotId))).map((e=>{var s;return{SlotType:"vDisk",Id:null===(s=e.VDiskId)||void 0===s?void 0:s.GroupID,Title:e.StoragePoolName,Severity:e.Severity,Used:Number(e.AllocatedSize),Total:Number(e.TotalSize),UsagePercent:e.AllocatedPercent,SlotData:e}}));let x=[];if(g&&g>b.length){const e=g-b.length;let s=Number(D);if(isNaN(s)){const t=b.reduce(((e,s)=>s.Total?e+s.Total:e),0);s=(Number(v)-t-Number(p))/e}x=(0,f.c$)(e).map((()=>({SlotType:"empty",Total:s,Severity:1,SlotData:{Size:s}})))}const N=[...b,...x];k&&N.unshift(k);const y=null===(s=n.SystemStateInfo)||void 0===s?void 0:s[0],j=(0,I.Ns)(y);return{...u,NodeId:null!==(t=u.NodeId)&&void 0!==t?t:j.NodeId,NodeHost:j.Host,NodeType:null===(i=j.Roles)||void 0===i?void 0:i[0],NodeDC:j.DC,SlotItems:N}}(await Promise.all([window.api.getPDiskInfo({nodeId:t,pDiskId:i},{signal:o}),window.api.getNodeInfo(t,{signal:o})]));return{data:e}}catch(n){return{error:n}}},providesTags:(e,s,t)=>["All",{type:"PDiskData",id:(0,j.CH)(t.nodeId,t.pDiskId)}]}),getStorageInfo:e.query({queryFn:async(e,s)=>{let{nodeId:t,pDiskId:i}=e,{signal:o}=s;try{const e=function(e,s,t){var i;const o=[];return null===(i=e.StoragePools)||void 0===i||i.forEach((e=>{var i;return null===(i=e.Groups)||void 0===i?void 0:i.forEach((i=>{var n;(null===(n=i.VDisks)||void 0===n?void 0:n.some((e=>{var i,o,n,a;const l=null!==(i=e.PDiskId)&&void 0!==i?i:null===(o=e.PDisk)||void 0===o?void 0:o.PDiskId,r=null!==(n=e.NodeId)&&void 0!==n?n:null===(a=e.PDisk)||void 0===a?void 0:a.NodeId;return l===Number(s)&&r===Number(t)})))&&o.push((0,w.mD)(i,e))}))})),o}(await window.api.getStorageInfo({nodeId:t,version:y.w.v1},{signal:o}),i,t);return{data:e}}catch(n){return{error:n}}},providesTags:(e,s,t)=>["All",{type:"PDiskData",id:(0,j.CH)(t.nodeId,t.pDiskId)}]})}),overrideExisting:"throw"});var E=t(24362),P=t(17096),C=t(57542),M=t(30831),z=t(68330),O=t(17176),_=t(86793),A=t(45743),L=t(30817);const R=JSON.parse('{"fqdn":"FQDN","pdisk":"PDisk","node":"Node","groups":"Groups","disk-distribution":"Disk distribution","empty-slot":"Empty slot","log":"Log","label.log-size":"Log Size","label.system-size":"System Size","label.slot-size":"Slot Size","no-slots-data":"No slots data","restart-pdisk-button":"Restart PDisk","force-restart-pdisk-button":"Restart anyway","restart-pdisk-not-allowed":"You don\'t have enough rights to restart PDisk","restart-pdisk-dialog-header":"Restart PDisk","restart-pdisk-dialog-text":"PDisk will be restarted. Do you want to proceed?","decommission-none":"None","decommission-imminent":"Imminent","decommission-pending":"Pending","decommission-rejected":"Rejected","decommission-label":"{{decommission}} decommission","decommission-button":"Decommission","decommission-change-not-allowed":"You don\'t have enough rights to change PDisk decommission","decommission-dialog-title":"Change decommission status","decommission-dialog-force-change":"Change anyway","decommission-dialog-imminent-warning":"This will start imminent decommission. Existing slots will be moved from the disk","decommission-dialog-pending-warning":"This will start pending decommission. Decommission will be planned for this disk, but will not start immediatelly. Existing slots will not be moved from the disk, but no new slots will be allocated on it","decommission-dialog-rejected-warning":"This will start rejected decommission. No slots from other disks are placed on this disk in the process of decommission","decommission-dialog-none-warning":"This will reset decommission mode, allowing the disk to  be used by the storage"}'),U=(0,L.wZ)("ydb-pDisk-page",{en:R});var V,H,G,q;function B(){return B=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},B.apply(this,arguments)}const J=function(e){return i.createElement("svg",B({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 17",fill:"none"},e),V||(V=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.378 7.771c.717 0 1.298.614 1.298 1.372v.914c0 .758-.581 1.372-1.298 1.372H3.46c-.716 0-1.297-.614-1.297-1.372v-.914c0-.758.58-1.372 1.297-1.372h6.92zm.77-1.248L9.935 3.958a1.292 1.292 0 00-1.16-.758H5.063c-.491 0-.94.294-1.16.758L2.69 6.523c.243-.08.501-.123.77-.123h6.918c.268 0 .527.043.77.123zm1.825 1.87V10.057c0 1.515-1.162 2.743-2.595 2.743H3.46c-1.433 0-2.594-1.228-2.594-2.743V8.393c0-.71.156-1.41.456-2.044l1.421-3.004c.44-.93 1.338-1.516 2.32-1.516h3.713c.982 0 1.88.587 2.32 1.516l1.421 3.004c.3.635.457 1.335.457 2.044zm-5.19.521c-.358 0-.648.307-.648.686 0 .379.29.686.649.686h2.162c.358 0 .649-.307.649-.686 0-.379-.29-.686-.65-.686H7.785z",fill:"currentColor",fillOpacity:.85})),H||(H=i.createElement("path",{d:"M15.25 11.428c0 2.15-1.639 3.822-3.574 3.822-1.935 0-3.574-1.671-3.574-3.822 0-2.15 1.639-3.821 3.574-3.821 1.935 0 3.574 1.671 3.574 3.821z",fill:"var(--g-color-base-background)",stroke:"currentColor",strokeWidth:1.5})),G||(G=i.createElement("path",{d:"M11.676 16.5c2.69 0 4.824-2.297 4.824-5.072 0-2.774-2.134-5.071-4.824-5.071s-4.824 2.297-4.824 5.071c0 2.775 2.134 5.072 4.824 5.072z",stroke:"var(--g-color-base-background)"})),q||(q=i.createElement("path",{d:"M12.973 10.057L10.378 12.8m0-2.743l2.595 2.743",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))};var F=t(75859);const W=(0,E.cn)("ydb-pdisk-decommission-button");function Z(e){return"DECOMMIT_IMMINENT"===e?U("decommission-dialog-imminent-warning"):"DECOMMIT_PENDING"===e?U("decommission-dialog-pending-warning"):"DECOMMIT_REJECTED"===e?U("decommission-dialog-rejected-warning"):"DECOMMIT_NONE"===e?U("decommission-dialog-none-warning"):void 0}function Y(e){let{decommission:s,onConfirmAction:t,onConfirmActionSuccess:o,buttonDisabled:n,popoverDisabled:a}=e;const[l,r]=i.useState(),[d,c]=i.useState(!1),[u,m]=i.useState(!1),p=function(e,s){return[{text:U("decommission-none"),action:()=>s("DECOMMIT_NONE"),hidden:!e||"DECOMMIT_NONE"===e||"DECOMMIT_UNSET"===e},{text:U("decommission-pending"),action:()=>s("DECOMMIT_PENDING"),hidden:"DECOMMIT_PENDING"===e},{text:U("decommission-rejected"),action:()=>s("DECOMMIT_REJECTED"),hidden:"DECOMMIT_REJECTED"===e},{text:U("decommission-imminent"),theme:"danger",action:()=>s("DECOMMIT_IMMINENT"),hidden:"DECOMMIT_IMMINENT"===e}]}(s,r);return(0,F.jsxs)(i.Fragment,{children:[(0,F.jsx)(M.h,{renderSwitcher:e=>(0,F.jsx)(Q,{popoverDisabled:a,loading:d,disabled:n,...e}),items:p,popupProps:{className:W("popup")}}),(0,F.jsx)(_.g,{visible:Boolean(l),header:U("decommission-dialog-title"),text:Z(l),withRetry:u,retryButtonText:U("decommission-dialog-force-change"),onConfirm:async e=>{c(!0),await t(l,e)},onConfirmActionSuccess:async()=>{m(!1),await(0,f.Dc)(5e3);try{await o()}finally{c(!1)}},onConfirmActionError:e=>{m((0,A.q)(e)),c(!1)},onClose:()=>{r(void 0)}})]})}function Q(e){let{popoverDisabled:s,...t}=e;return(0,F.jsx)(z.J,{content:U("decommission-change-not-allowed"),placement:"right",disabled:s,children:(0,F.jsxs)(O.z,{view:"normal",className:W("button"),...t,children:[(0,F.jsx)(n.J,{data:J}),U("decommission-button"),(0,F.jsx)(n.J,{data:C.Z})]})})}var $=t(14979);function K(e){return U("decommission-label",{decommission:e})}function X(e){let{decommission:s}=e;return"DECOMMIT_IMMINENT"===s?(0,F.jsx)($._,{theme:"danger",size:"m",children:K(U("decommission-imminent"))}):"DECOMMIT_PENDING"===s?(0,F.jsx)($._,{theme:"warning",size:"m",children:K(U("decommission-pending"))}):"DECOMMIT_REJECTED"===s?(0,F.jsx)($._,{theme:"normal",size:"m",children:K(U("decommission-rejected"))}):null}var ee=t(2098),se=t(22692),te=t(52317),ie=t(77382),oe=t(46393);function ne(e){var s;let{pDiskId:t,nodeId:i}=e;const[o]=(0,P.Rj)(),n=T.useGetStorageInfoQuery({pDiskId:t,nodeId:i},{pollingInterval:o}),a=n.isFetching&&void 0===n.currentData,l=null!==(s=n.currentData)&&void 0!==s?s:[],r=(0,oe.M)();return a?(0,F.jsx)(se.h,{}):(0,F.jsx)(ee.G,{columnsWidthLSKey:ie.Ty,data:l,columns:r,settings:te.LE})}var ae=t(94790),le=t(1796),re=t(62206),de=t(74170),ce=t(67359),ue=t(22200),me=t(81854),pe=t(34301);const ve=(0,E.cn)("ydb-pdisk-space-distribution"),he=40;function ge(e){let{data:s}=e;const{SlotItems:t}=s,{PDiskId:i,NodeId:o}=s,n=he*((null===t||void 0===t?void 0:t.length)||1);return null!==t&&void 0!==t&&t.length?(0,F.jsx)("div",{className:ve(null),style:{height:n,minHeight:n},children:(0,F.jsx)(le.p,{className:ve("pdisk-bar"),severity:s.Severity,diskAllocatedPercent:s.AllocatedPercent,content:null===t||void 0===t?void 0:t.map(((e,s)=>(0,F.jsx)(De,{item:e,pDiskId:i,nodeId:o},s))),faded:!0})}):U("no-slots-data")}function De(e){let{item:s,pDiskId:t,nodeId:i}=e;return(0,F.jsx)("div",{className:ve("slot-wrapper"),style:{flexGrow:Number(s.Total)||1},children:(()=>{if("vDisk"===s.SlotType){var e;const o=(0,f.D)(null===(e=s.SlotData)||void 0===e?void 0:e.VDiskSlotId)&&(0,f.D)(t)&&(0,f.D)(i)?(0,k.By)(s.SlotData.VDiskSlotId,t,i):void 0;return(0,F.jsx)(ae.f,{content:(0,F.jsx)(ue.K,{data:s.SlotData,withTitle:!0}),contentClassName:ve("vdisk-popup"),placement:["right","top"],children:(0,F.jsx)(de.h,{to:o,children:(0,F.jsx)(le.p,{className:ve("slot"),severity:s.Severity,diskAllocatedPercent:s.UsagePercent,content:(0,F.jsx)(ke,{id:s.Id,title:s.Title,used:s.Used,total:s.Total})})})})}return function(e){return"log"===e.SlotType}(s)?(0,F.jsx)(ae.f,{content:(0,F.jsx)(be,{data:s.SlotData}),contentClassName:ve("vdisk-popup"),placement:["right","top"],children:(0,F.jsx)(le.p,{className:ve("slot"),severity:s.Severity,diskAllocatedPercent:s.UsagePercent,content:(0,F.jsx)(ke,{title:U("log"),used:s.Used,total:s.Total})})}):function(e){return"empty"===e.SlotType}(s)?(0,F.jsx)(ae.f,{content:(0,F.jsx)(xe,{data:s.SlotData}),contentClassName:ve("vdisk-popup"),placement:["right","top"],children:(0,F.jsx)(le.p,{className:ve("slot"),severity:s.Severity,empty:!0,content:(0,F.jsx)(ke,{title:U("empty-slot"),used:s.Total})})}):null})()})}function ke(e){let{id:s,title:t,used:i,total:o}=e;return(0,F.jsxs)("div",{className:ve("slot-content"),children:[(0,F.jsxs)("span",{children:[(0,f.D)(s)?(0,F.jsx)("span",{className:ve("slot-id"),children:s}):null,t]}),(0,F.jsx)("span",{className:ve("slot-size"),children:(()=>{const[e,s]=(0,pe.q3)(i,o);return o?"".concat(e," / ").concat(s):e})()})]})}function be(e){let{data:s}=e;const{LogTotalSize:t,LogUsedSize:i,SystemSize:o}=s,n=[{label:U("label.log-size"),value:(0,F.jsx)(ce.y,{value:i,capacity:t,formatValues:pe.q3})}];return(0,f.D)(o)&&n.push({label:U("label.system-size"),value:(0,me.td)({value:o})}),(0,F.jsx)(re._P,{title:U("log"),info:n})}function xe(e){let{data:s}=e;const{Size:t}=s,i=[{label:U("label.slot-size"),value:(0,me.td)({value:t})}];return(0,F.jsx)(re._P,{title:U("empty-slot"),info:i})}const Ne=(0,E.cn)("ydb-pdisk-page"),ye={diskDistribution:"diskDistribution",groups:"groups"},je=[{id:ye.diskDistribution,get title(){return U("disk-distribution")}},{id:ye.groups,get title(){return U("groups")}}],fe=c.z.nativeEnum(ye).catch(ye.diskDistribution);function Se(){const e=(0,P.zL)(),s=(0,P.ix)(x.VH),[{nodeId:t,pDiskId:c,activeTab:y}]=(0,d.useQueryParams)({activeTab:d.StringParam,nodeId:d.StringParam,pDiskId:d.StringParam}),S=(0,f.D)(t)&&(0,f.D)(c),I=fe.parse(y);i.useEffect((()=>{e((0,N.J)("pDisk",{nodeId:t,pDiskId:c}))}),[e,t,c]);const[w]=(0,P.Rj)(),E=S?{nodeId:t,pDiskId:c}:l.CN,C=T.useGetPdiskInfoQuery(E,{pollingInterval:w}),M=C.isFetching&&void 0===C.currentData,z=C.currentData,{NodeHost:O,NodeId:_,NodeType:A,NodeDC:L,Severity:R,DecommitStatus:V}=z||{},H=async e=>{if(S){const s=await window.api.restartPDisk({nodeId:t,pDiskId:c,force:e});if(!1===(null===s||void 0===s?void 0:s.result)){throw{statusText:s.error,retryPossible:s.forceRetryPossible}}}},G=async(e,s)=>{if(S){const i=await window.api.changePDiskStatus({nodeId:t,pDiskId:c,force:s,decommissionStatus:e});if(!1===(null===i||void 0===i?void 0:i.result)){throw{statusText:i.error,retryPossible:i.forceRetryPossible}}}},q=()=>{S&&e(b.h.util.invalidateTags([{type:"PDiskData",id:(0,j.CH)(t,c)}]))};return(0,F.jsxs)("div",{className:Ne(null),children:[(()=>{const e=c?"".concat(U("pdisk")," ").concat(c):U("pdisk"),s=O||U("node");return(0,F.jsx)(r.ql,{titleTemplate:"%s - ".concat(e," \u2014 ").concat(s," \u2014 YDB Monitoring"),defaultTitle:"".concat(e," \u2014 ").concat(s," \u2014 YDB Monitoring")})})(),(()=>{const e=O?"".concat(U("fqdn"),": ").concat(O):void 0,s=_?"".concat(U("node"),": ").concat(_):void 0;return(0,F.jsx)(D.B,{loading:M,items:[e,s,A,L],className:Ne("meta")})})(),(0,F.jsxs)("div",{className:Ne("title"),children:[(0,F.jsx)(m.a,{entityName:U("pdisk"),status:(0,j.b2)(R),id:(0,j.CH)(t,c)}),(0,F.jsx)(X,{decommission:V})]}),(0,F.jsxs)("div",{className:Ne("controls"),children:[(0,F.jsxs)(u.U,{onConfirmAction:H,onConfirmActionSuccess:q,buttonDisabled:!S||!s,buttonView:"normal",dialogHeader:U("restart-pdisk-dialog-header"),dialogText:U("restart-pdisk-dialog-text"),retryButtonText:U("force-restart-pdisk-button"),withPopover:!0,popoverContent:U("restart-pdisk-not-allowed"),popoverDisabled:s,children:[(0,F.jsx)(n.J,{data:o.Z}),U("restart-pdisk-button")]}),(0,F.jsx)(Y,{decommission:V,onConfirmAction:G,onConfirmActionSuccess:q,buttonDisabled:!S||!s,popoverDisabled:s})]}),C.error?(0,F.jsx)(p.V,{error:C.error}):null,M?(0,F.jsx)(v.b,{className:Ne("info"),rows:10}):(0,F.jsx)(g.P,{pDisk:z,nodeId:t,className:Ne("info")}),(0,F.jsx)("div",{className:Ne("tabs"),children:(0,F.jsx)(a.m,{size:"l",items:je,activeTab:I,wrapTo:(e,s)=>{let{id:i}=e;const o=S?(0,k.ds)(c,t,{activeTab:i}):void 0;return(0,F.jsx)(h.h,{to:o,children:s},i)}})}),(()=>{switch(I){case"diskDistribution":return z?(0,F.jsx)(ge,{data:z}):null;case"groups":return S?(0,F.jsx)(ne,{nodeId:t,pDiskId:c}):null;default:return null}})()]})}},3475:(e,s,t)=>{t.d(s,{Z:()=>o});var i=t(68963);const o=e=>i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),i.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.5 6.5 0 1 1-6.445 7.348.75.75 0 1 1 1.487-.194A5.001 5.001 0 1 0 4.43 4.5h1.32a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 2 5.25v-3a.75.75 0 0 1 1.5 0v1.06A6.48 6.48 0 0 1 8 1.5Z",clipRule:"evenodd"}))}}]);