"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[3556],{66498:(e,t,a)=>{a.d(t,{a:()=>s.a});var s=a(41989)},50377:(e,t,a)=>{a.d(t,{P:()=>k});var s=a(79777),i=a(46878),l=a(65e3),n=a(25665),r=a(10142),d=a(99294),o=a(14075),c=a(70340),u=a(55842),v=a(43862),p=a(90808),h=a(20760),m=a(73287),b=a(37711);const g=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),x=(0,b.wZ)("ydb-pDisk-info",{en:g});var j=a(10161);const N=(0,d.cn)("ydb-pdisk-info");function k(e){let{pDisk:t,nodeId:a,withPDiskPageLink:d,className:b}=e;const g=(0,u.ix)(l.VH),[k,y,I,f]=function(e){let{pDisk:t,nodeId:a,withPDiskPageLink:s,isUserAllowedToMakeChanges:l}=e;const{PDiskId:d,Path:u,Guid:v,Category:b,Type:g,Device:k,Realtime:y,State:I,SerialNumber:f,TotalSize:w,AllocatedSize:D,StatusV2:S,NumActiveSlots:T,ExpectedSlotCount:P,LogUsedSize:z,LogTotalSize:V,SystemSize:A,SharedWithOs:C}=t||{},E=[];(0,n.D)(b)&&E.push({label:x("type"),value:g}),(0,n.D)(u)&&E.push({label:x("path"),value:u}),(0,n.D)(v)&&E.push({label:x("guid"),value:v}),f&&E.push({label:x("serial-number"),value:f}),(0,n.D)(C)&&E.push({label:x("shared-with-os"),value:x("yes")});const q=[];(0,n.D)(S)&&q.push({label:x("drive-status"),value:S}),(0,n.D)(I)&&q.push({label:x("state"),value:I}),(0,n.D)(k)&&q.push({label:x("device"),value:(0,j.jsx)(m.J,{status:k})}),(0,n.D)(y)&&q.push({label:x("realtime"),value:(0,j.jsx)(m.J,{status:y})});const R=[];R.push({label:x("space"),value:(0,j.jsx)(h.y,{value:D,capacity:w,formatValues:o.q3,colorizeProgress:!0})}),(0,n.D)(T)&&(0,n.D)(P)&&R.push({label:x("slots"),value:(0,j.jsx)(h.y,{value:T,capacity:P})}),(0,n.D)(z)&&(0,n.D)(V)&&R.push({label:x("log-size"),value:(0,j.jsx)(h.y,{value:z,capacity:V,formatValues:o.q3})}),(0,n.D)(A)&&R.push({label:x("system-size"),value:(0,r.td)({value:A})});const L=[];if((s||l)&&(0,n.D)(d)&&(0,n.D)(a)){const e=(0,i.ds)(d,a),t=(0,c.ok)({nodeId:a,pDiskId:d});L.push({label:x("links"),value:(0,j.jsxs)("span",{className:N("links"),children:[s&&(0,j.jsx)(p.j,{title:x("pdisk-page"),url:e,external:!1}),l&&(0,j.jsx)(p.j,{title:x("developer-ui"),url:t})]})})}return[E,q,R,L]}({pDisk:t,nodeId:a,withPDiskPageLink:d,isUserAllowedToMakeChanges:g});return(0,j.jsxs)(s.k,{className:b,gap:2,direction:"row",wrap:!0,children:[(0,j.jsxs)(s.k,{direction:"column",gap:2,width:500,children:[(0,j.jsx)(v._,{info:k,renderEmptyState:()=>null}),(0,j.jsx)(v._,{info:I,renderEmptyState:()=>null})]}),(0,j.jsxs)(s.k,{direction:"column",gap:2,width:500,children:[(0,j.jsx)(v._,{info:y,renderEmptyState:()=>null}),(0,j.jsx)(v._,{info:f,renderEmptyState:()=>null})]})]})}},76217:(e,t,a)=>{a.d(t,{P:()=>b});var s=a(83797),i=a(2194),l=a(46878),n=a(65e3),r=a(70340),d=a(55842),o=a(61168),c=a(62508),u=a(90808),v=a(37711);const p=JSON.parse('{"field_links":"Links","context_developer-ui":"Developer UI"}'),h=(0,v.wZ)("ydb-tablet-name-wrapper",{en:p});var m=a(10161);function b(e){let{tabletId:t,database:a}=e;const v=(0,d.ix)(n.VH),p=(0,l.fK)(t,{tenantName:a});return(0,m.jsx)(o.l,{disabled:!v,content:(0,m.jsx)(s.w,{responsive:!0,children:(0,m.jsx)(s.w.Item,{name:h("field_links"),children:(0,m.jsx)(u.j,{title:h("context_developer-ui"),url:(0,r.wz)(t)})})}),placement:["top","bottom"],behavior:i.x.Immediate,children:(0,m.jsx)(c.A,{name:t.toString(),path:p,hasClipboardButton:!0,showStatus:!1})})}},59907:(e,t,a)=>{a.d(t,{f:()=>n});var s=a(2634),i=a(55973),l=a(10161);function n(e){let{state:t}=e;return(0,l.jsx)(s._,{theme:(0,i.KR)(t),children:t})}},13618:(e,t,a)=>{a.d(t,{$:()=>d});a(34706);var s=a(79777),i=a(99294),l=a(10161);const n=(0,i.cn)("tag"),r=e=>{let{text:t,type:a}=e;return(0,l.jsx)("div",{className:n({type:a}),children:t})},d=e=>{let{tags:t,tagsType:a,className:i="",gap:n=1}=e;return(0,l.jsx)(s.k,{className:i,gap:n,wrap:"wrap",alignItems:"center",children:t&&t.map(((e,t)=>(0,l.jsx)(r,{text:e,type:a},t)))})}},33100:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>ke,STORAGE_ROLE:()=>Ne});var s=a(34706),i=a(72555),l=a(42152),n=a(55783),r=a(26836),d=a(74003),o=a(15152),c=a(14561),u=a(99294),v=a(70340),p=a(62508),h=a(13618),m=a(10161);const b=(0,u.cn)("basic-node-viewer"),g=e=>{let t,{node:a,additionalNodesProps:i,className:l}=e;return null!==i&&void 0!==i&&i.getNodeRef?t=i.getNodeRef(a)+"internal":a.NodeId&&(t=(0,v.wq)(a.NodeId)+"internal"),(0,m.jsx)("div",{className:b(null,l),children:a?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:b("title"),children:"Node"}),(0,m.jsx)(p.A,{status:a.SystemState,name:a.Host}),t&&(0,m.jsx)("a",{rel:"noopener noreferrer",className:b("link",{external:!0}),href:t,target:"_blank",children:(0,m.jsx)(c.J,{data:o.Z})}),(0,m.jsxs)("div",{className:b("id"),children:[(0,m.jsx)("label",{className:b("label"),children:"NodeID"}),(0,m.jsx)("label",{children:a.NodeId})]}),a.DC&&(0,m.jsx)(h.$,{tags:[a.DC]}),a.Roles&&(0,m.jsx)(h.$,{tags:a.Roles,tagsType:"blue"})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var x=a(15327),j=a(27810),N=a(43862);const k=(0,u.cn)("ydb-pool-usage"),y=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},I=e=>{let{data:t={}}=e;const{Threads:a,Name:s="Unknown",Usage:i=0}=t,l=i&&a,n=Math.floor(100*i),r=n>100?100:n;return(0,m.jsxs)("div",{className:k(),children:[(0,m.jsxs)("div",{className:k("info"),children:[(0,m.jsx)("div",{className:k("pool-name"),children:s}),l&&(0,m.jsxs)("div",{className:k("value"),children:[(0,m.jsxs)("div",{className:k("percents"),children:[n<1?"<1":n,"%"]}),(0,m.jsxs)("div",{className:k("threads"),children:["(\xd7",a,")"]})]})]}),(0,m.jsx)("div",{className:k("visual"),children:(0,m.jsx)("div",{className:k("usage-line",{type:y(r)}),style:{width:`${r}%`}})})]})};var f=a(20760);const w=(0,u.cn)("full-node-viewer"),D=e=>{var t,a,s,i;let{node:l,className:n}=e;const r=null===l||void 0===l||null===(t=l.Endpoints)||void 0===t?void 0:t.map((e=>{let{Name:t,Address:a}=e;return{label:t,value:a}})),d=[];null!==l&&void 0!==l&&null!==(a=l.Tenants)&&void 0!==a&&a.length&&d.push({label:"Database",value:l.Tenants[0]}),d.push({label:"Version",value:null===l||void 0===l?void 0:l.Version},{label:"Uptime",value:null===l||void 0===l?void 0:l.Uptime},{label:"DC",value:(null===l||void 0===l?void 0:l.DataCenterDescription)||(null===l||void 0===l?void 0:l.DC)},{label:"Rack",value:null===l||void 0===l?void 0:l.Rack});const o=null===l||void 0===l||null===(s=l.LoadAveragePercents)||void 0===s?void 0:s.map(((e,t)=>({label:j.x5[t],value:(0,m.jsx)(f.y,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,m.jsx)("div",{className:`${w()} ${n}`,children:l?(0,m.jsxs)("div",{className:w("common-info"),children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:w("section-title"),children:"Pools"}),(0,m.jsx)("div",{className:w("section",{pools:!0}),children:null===l||void 0===l||null===(i=l.PoolStats)||void 0===i?void 0:i.map(((e,t)=>(0,m.jsx)(I,{data:e},t)))})]}),r&&r.length&&(0,m.jsx)(N._,{title:"Endpoints",className:w("section"),info:r}),(0,m.jsx)(N._,{title:"Common info",className:w("section"),info:d}),(0,m.jsx)(N._,{title:"Load average",className:w("section",{average:!0}),info:o})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var S=a(66498),T=a(46878),P=a(39202),z=a(85709),V=a(78759),A=a(96183);const C=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,A.Ns)(a)},E=V.h.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{const e=await window.api.getNodeInfo(a,{signal:s});return{data:C(e)}}catch(i){return{error:i}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{return{data:await window.api.getStorageInfo({nodeId:a},{signal:s})}}catch(i){return{error:i}}},providesTags:["All"]})}),overrideExisting:"throw"});var q=a(55842),R=a(92025),L=a(28265),_=a(75544),O=a(55102),U=a.n(O),F=a(99495),J=a(67386),Z=a(14075),G=a(84953);const H=(0,J.P1)((e=>e),(e=>E.endpoints.getNodeStructure.select({nodeId:e}))),$=(0,J.P1)((e=>e),((e,t)=>H(t)),((e,t)=>t(e).data)),M=(0,J.P1)(((e,t)=>Number(t)),((e,t)=>$(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,s={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var i;const l=null===(i=a.VDisks)||void 0===i?void 0:i.filter((t=>t.NodeId===e)).map(G.w);null===l||void 0===l||l.forEach((a=>{const i=(0,Z.a2)(a.VDiskId),l=(0,G.b)(a.PDisk),n=l.PDiskId;s[String(n)]||(s[String(n)]={vDisks:{},...l}),s[String(n)].vDisks[i]={...a,PDiskId:n,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(s).reduce(((e,t)=>{const a=s[t].vDisks,i=Object.keys(a).reduce(((e,t,s)=>(e.push({...a[t],id:t,order:s}),e)),[]);return e[t]={...s[t],vDisks:i},e}),{})}));var B=a(29254),K=a(71624),Q=a(72616),Y=a(16318),X=a(81778),W=a(50377),ee=a(73287),te=a(49263),ae=a(77468),se=a(38392),ie=a(25665),le=a(37711);const ne=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),re=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),de=(0,le.wZ)("ydb-node-page",{en:ne,ru:re}),oe=(0,u.cn)("kv-node-structure");function ce(e){let{label:t,value:a,className:s}=e;return(0,m.jsxs)("span",{className:oe("pdisk-title-item",s),children:[t&&(0,m.jsxs)("span",{className:oe("pdisk-title-item-label"),children:[t,":"]}),(0,m.jsx)("span",{className:oe("pdisk-title-item-value"),children:a})]})}const ue=(0,u.cn)("kv-node-structure");var ve;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(ve||(ve={}));const pe={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function he(e){let{pDiskId:t,selectedVdiskId:a,nodeId:s}=e;return[{name:ve.slotId,header:pe[ve.slotId],width:100,render:e=>{let{row:i}=e;const l=i.VDiskSlotId;let n=null;return(0,ie.D)(s)&&(0,ie.D)(t)&&(0,ie.D)(l)&&(n=(0,v.yf)({nodeId:s,pDiskId:t,vDiskSlotId:l})),(0,m.jsxs)("div",{className:ue("vdisk-id",{selected:i.id===a}),children:[(0,m.jsx)("span",{children:l}),n&&(0,m.jsx)(Q.z,{size:"s",className:ue("external-button",{hidden:!0}),href:n,target:"_blank",title:de("vdisk.developer-ui-button-title"),children:(0,m.jsx)(c.J,{data:o.Z})})]})},align:K.ZP.LEFT},{name:ve.VDiskState,header:pe[ve.VDiskState],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(ee.J,{status:t.VDiskState===se.H.OK?ae.K.Green:ae.K.Red})},sortAccessor:e=>e.VDiskState===se.H.OK?1:0,align:K.ZP.CENTER},{name:ve.Size,header:pe[ve.Size],width:170,render:e=>{let{row:t}=e;return(0,m.jsx)(f.y,{value:t.AllocatedSize,capacity:Number(t.AllocatedSize)+Number(t.AvailableSize),formatValues:Z.q3,colorizeProgress:!0})},sortAccessor:e=>Number(e.AllocatedSize),align:K.ZP.CENTER},{name:ve.Info,header:pe[ve.Info],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(Y.J,{placement:["right"],content:(0,m.jsx)(te.K,{data:t,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:ue("vdisk-details"),children:(0,m.jsx)(Q.z,{view:"flat-secondary",className:ue("vdisk-details-button",{selected:t.id===a}),children:(0,m.jsx)(c.J,{data:B.Z,size:18})})})},sortable:!1}]}function me(e){let{id:t,data:a,selectedVdiskId:i,nodeId:l,unfolded:n}=e;const[r,d]=s.useState(null!==n&&void 0!==n&&n),{TotalSize:o=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:p,vDisks:h}=a,b=Number(o),g=Number(c);return(0,m.jsxs)("div",{className:ue("pdisk"),id:t,children:[(0,m.jsxs)("div",{className:ue("pdisk-header"),children:[(0,m.jsxs)("div",{className:ue("pdisk-title-wrapper"),children:[(0,m.jsx)(ee.J,{status:u}),(0,m.jsx)(ce,{label:"PDiskID",value:v,className:ue("pdisk-title-id")}),(0,m.jsx)(ce,{value:p,className:ue("pdisk-title-type")}),(0,m.jsx)(f.y,{value:b-g,capacity:b,formatValues:Z.q3,colorizeProgress:!0,className:ue("pdisk-title-size")}),(0,m.jsx)(ce,{label:"VDisks",value:h.length})]}),(0,m.jsx)(Q.z,{onClick:r?()=>{d(!1)}:()=>{d(!0)},view:"flat-secondary",children:(0,m.jsx)(X.F,{direction:r?"top":"bottom"})})]}),r&&(U()(a)?(0,m.jsx)("div",{children:"No information about PDisk"}):(0,m.jsxs)("div",{children:[(0,m.jsx)(W.P,{pDisk:a,nodeId:l,className:ue("pdisk-details"),withPDiskPageLink:!0}),(0,m.jsxs)("div",{className:ue("vdisks-container"),children:[(0,m.jsx)("div",{className:ue("vdisks-header"),children:"VDisks"}),(0,m.jsx)(K.ZP,{theme:"yandex-cloud",data:h,columns:he({nodeId:l,pDiskId:v,selectedVdiskId:i}),settings:{...j.LE,dynamicRender:!1},rowClassName:e=>e.id===i?ue("selected-vdisk"):""})]})]}))]})}const be=(0,u.cn)("kv-node-structure");function ge(e){let{type:t,id:a}=e;return`${t}-${a}`}const xe=function(e){let{nodeId:t,className:a}=e;const i=(0,q.ix)((e=>M(e,t))),[l]=(0,q.Rj)(),{currentData:n,isFetching:r,error:d}=E.useGetNodeStructureQuery({nodeId:t},{pollingInterval:l}),o=r&&void 0===n,[{pdiskId:c,vdiskId:u}]=(0,F.useQueryParams)({pdiskId:F.StringParam,vdiskId:F.StringParam}),v=s.useRef(null),p=s.useRef(!1);return s.useEffect((()=>{if(!U()(i)&&!p.current&&v.current&&c){const t=document.getElementById(ge({type:"pdisk",id:c}));let a=0;if(u){var e;const t=null===(e=i[c])||void 0===e?void 0:e.vDisks,s=null===t||void 0===t?void 0:t.find((e=>e.id===u)),l=s?document.querySelector(".data-table"):void 0,n=(null===s||void 0===s?void 0:s.order)||0;l&&(a+=l.offsetTop+40*n)}t&&(v.current.scrollTo({behavior:"smooth",top:a||t.offsetTop}),p.current=!0)}}),[i,c,u]),(0,m.jsxs)("div",{className:be(),ref:v,children:[d?(0,m.jsx)(x.V,{error:d,className:be("error")}):null,(0,m.jsx)("div",{className:a,children:o?(0,m.jsx)(S.a,{size:"m"}):d&&!n?null:(()=>{const e=Object.keys(i);return e.length>0?e.map((e=>(0,m.jsx)(me,{data:i[e],id:ge({type:"pdisk",id:e}),unfolded:c===e,selectedVdiskId:u,nodeId:t},e))):"There is no information about node structure."})()})]})},je=(0,u.cn)("node"),Ne="Storage";function ke(e){var t,a;const o=s.useRef(null),c=(0,q.zL)(),u=(0,n.TH)(),v=null!==(t=(0,n.$B)(T.ZP.node))&&void 0!==t?t:Object.create(null),{id:p,activeTab:h}=v.params,{tenantName:b}=(0,T.mB)(u),[j]=(0,q.Rj)(),{currentData:N,isFetching:k,error:y}=E.useGetNodeInfoQuery({nodeId:p},{pollingInterval:j}),I=k&&void 0===N,f=N,w=(0,P.rU)(),V=(0,P.X_)(),{activeTabVerified:A,nodeTabs:C}=s.useMemo((()=>{var e;let t=(null===f||void 0===f||null===(e=f.Roles)||void 0===e?void 0:e.find((e=>e===Ne)))?_.ZJ:_.ZJ.filter((e=>e.id!==_.P_));V&&(t=t.filter((e=>e.id!==_.pV)));const a=t.map((e=>({...e,title:e.name})));let s=a.find((e=>{let{id:t}=e;return t===h}));return s||(s=a[0]),{activeTabVerified:s,nodeTabs:a}}),[h,f,V]),O=(null===f||void 0===f||null===(a=f.Tenants)||void 0===a?void 0:a[0])||(null===b||void 0===b?void 0:b.toString());let U;if(f){var F;const e=!(null!==f&&void 0!==f&&null!==(F=f.Tenants)&&void 0!==F&&F[0]);U=e?"Storage":"Compute"}s.useEffect((()=>{c((0,z.J)("node",{tenantName:O,nodeRole:U,nodeId:p}))}),[c,O,p,U]);const J=()=>{switch(A.id){case _.P_:return(0,m.jsx)("div",{className:je("storage"),children:(0,m.jsx)(R.V,{nodeId:p,parentRef:o})});case _.IA:return(0,m.jsx)(L.J,{nodeId:p,database:O,className:je("node-page-wrapper")});case _.pV:return(0,m.jsx)(xe,{className:je("node-page-wrapper"),nodeId:p});case _.mD:return(0,m.jsx)(D,{node:f,className:je("overview-wrapper")});default:return!1}};return I||!w?(0,m.jsx)(S.a,{size:"l"}):f?(0,m.jsxs)("div",{className:je(null,e.className),ref:o,children:[(0,m.jsx)(l.ql,{titleTemplate:`%s \u2014 ${f.Host} \u2014 YDB Monitoring`,defaultTitle:`${f.Host} \u2014 YDB Monitoring`,children:(0,m.jsx)("title",{children:A.title})}),(0,m.jsx)(g,{node:f,additionalNodesProps:e.additionalNodesProps,className:je("header")}),y?(0,m.jsx)(x.V,{error:y,className:je("error")}):null,(0,m.jsxs)("div",{className:je("tabs"),children:[(0,m.jsx)(i.m,{size:"l",items:C,activeTab:A.id,wrapTo:(e,t)=>{let{id:a}=e;return(0,m.jsx)(r.rU,{to:(0,T.ax)(T.ZP.node,{id:p,activeTab:a},{tenantName:O}),className:je("tab"),children:t},a)},allowNotSelected:!0}),(0,m.jsx)(d.q,{})]}),(0,m.jsx)("div",{className:je("content"),children:J()})]}):y?(0,m.jsx)(x.V,{error:y}):(0,m.jsx)("div",{className:"error",children:"no node data"})}},72427:(e,t,a)=>{a.d(t,{O:()=>D});var s=a(73878),i=a(23795),l=a(14561),n=a(55982),r=a(62508),d=a(67653),o=a(74116),c=a(22877),u=a(76217),v=a(59907),p=a(65e3),h=a(6215),m=a(9038),b=a(27810),g=a(14075),x=a(55842),j=a(75544),N=a(37711);const k=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),y=(0,N.wZ)("ydb-tablets",{en:k});var I=a(10161);function f(e){let{database:t}=e;return[{name:"Type",width:150,get header(){return y("Type")},render:e=>{let{row:t}=e;const a=!1===t.Leader;return(0,I.jsxs)("span",{children:[t.Type," ",a?(0,I.jsx)(i.x,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return y("Tablet")},render:e=>{let{row:a}=e;return a.TabletId?(0,I.jsx)(u.P,{tabletId:a.TabletId,database:t}):b.jX}},{name:"State",get header(){return y("State")},render:e=>{let{row:t}=e;return(0,I.jsx)(v.f,{state:t.State})}},{name:"NodeId",get header(){return y("Node ID")},render:e=>{let{row:t}=e;const a=void 0===t.NodeId?void 0:(0,j.a3)(t.NodeId);return(0,I.jsx)(d.h,{to:a,children:t.NodeId})},align:"right"},{name:"fqdn",get header(){return y("Node FQDN")},render:e=>{let{row:t}=e;return t.fqdn?(0,I.jsx)(r.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,I.jsx)("span",{children:"\u2014"})}},{name:"Generation",get header(){return y("Generation")},align:"right"},{name:"Uptime",get header(){return y("Uptime")},render:e=>{let{row:t}=e;return(0,g.fG)(t.ChangeTime)},sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:e=>{let{row:t}=e;return(0,I.jsx)(w,{...t})}}]}function w(e){const t=e.State===m.g.Stopped,a=(0,x.ix)(p.VH),[i]=h._.useKillTabletMutation(),r=e.TabletId;return r?(0,I.jsx)(n.U,{buttonView:"outlined",dialogHeader:y("dialog.kill-header"),dialogText:y("dialog.kill-text"),onConfirmAction:()=>i({id:r}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:y("controls.kill-not-allowed"),popoverDisabled:a,children:(0,I.jsx)(l.J,{data:s.Z})}):null}function D(e){let{database:t,tablets:a,className:s,loading:i}=e;return i?(0,I.jsx)(c.h,{}):(0,I.jsx)(o.G,{wrapperClassName:s,columns:f({database:t}),data:a,settings:b.LE,emptyDataMessage:y("noTabletsData")})}},28265:(e,t,a)=>{a.d(t,{J:()=>j});var s=a(64485),i=a(15327),l=a(67386),n=a(74647),r=a.n(n),d=a(78759),o=a(4969);const c=d.h.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,t)=>{let{signal:a}=t;try{return{data:await window.api.getTabletsInfo(e,{signal:a})}}catch(s){return{error:s}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),u=(0,l.P1)((e=>e),(e=>c.endpoints.getTabletsInfo.select(e)),{argsMemoize:l.PP,argsMemoizeOptions:{equalityCheck:r()}}),v=(0,l.P1)((e=>e),((e,t)=>u(t)),((e,t)=>t(e).data)),p=(0,l.P1)(((e,t)=>v(e,t)),(e=>(0,o.s)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]));var h=a(99294),m=a(55842),b=a(72427),g=a(10161);const x=(0,h.cn)("tablets");function j(e){let{nodeId:t,path:a,database:l,className:n}=e;const[r]=(0,m.Rj)();let d={};const o=void 0===t?void 0:String(t);void 0!==o?d={nodeId:o,database:l}:a&&(d={path:a,database:l});const{currentData:u,isFetching:v,error:h}=c.useGetTabletsInfoQuery(0===Object.keys(d).length?s.CN:d,{pollingInterval:r}),j=v&&void 0===u,N=(0,m.ix)((e=>p(e,d)));return(0,g.jsxs)("div",{className:x(null,n),children:[h?(0,g.jsx)(i.V,{error:h}):null,u||j?(0,g.jsx)(b.O,{tablets:N,database:l,loading:j}):null]})}},6215:(e,t,a)=>{a.d(t,{_:()=>i});var s=a(96183);const i=a(78759).h.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async(e,t)=>{let{id:a,database:i}=e,{signal:l}=t;try{const[e,t,n]=await Promise.all([window.api.getTablet({id:a,database:i},{signal:l}),window.api.getTabletHistory({id:a,database:i},{signal:l}),window.api.getNodesList({signal:l})]),r=(0,s.Xs)(n),d=Object.keys(t).reduce(((e,a)=>{var s;const i=null===(s=t[a])||void 0===s?void 0:s.TabletStateInfo;if(i&&i.length){const t=i.find((e=>e.Leader))||i[0],{ChangeTime:s,Generation:l,State:n,Leader:d,FollowerId:o}=t,c=r&&a?r.get(Number(a)):void 0;"Dead"!==n&&e.push({nodeId:a,generation:l,changeTime:s,state:n,leader:d,followerId:o,fqdn:c})}return e}),[]),{TabletStateInfo:o=[]}=e,[c={}]=o,{TabletId:u}=c;return{data:{id:u,data:c,history:d}}}catch(n){return{error:n}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async(e,t)=>{let{tenantId:a}=e,{signal:s}=t;try{const e=await window.api.getTabletDescribe(a,{signal:s}),{SchemeShard:t,PathId:i}=a;return{data:(null===e||void 0===e?void 0:e.Path)||`${t}:${i}`}}catch(i){return{error:i}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async(e,t)=>{let{id:a,hiveId:s}=e,{signal:i}=t;try{return{data:await window.api.getTabletFromHive({id:a,hiveId:s},{signal:i})}}catch(l){return{error:l}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async e=>{let{id:t}=e;try{return{data:await window.api.killTablet(t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.stopTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.resumeTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},73878:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(34706);const i=e=>s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.501 6.501 0 0 0-6.445 5.649.75.75 0 1 0 1.488.194A5.001 5.001 0 0 1 11.57 4.5h-1.32a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 .75-.75v-3a.75.75 0 0 0-1.5 0v1.06A6.48 6.48 0 0 0 8 1.5Zm-5.25 13a.75.75 0 0 1-.75-.75v-3a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H4.43a5.001 5.001 0 0 0 8.528-2.843.75.75 0 1 1 1.487.194A6.501 6.501 0 0 1 3.5 12.691v1.059a.75.75 0 0 1-.75.75Z",clipRule:"evenodd"}))}}]);