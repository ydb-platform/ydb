"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[3779],{90053:(e,s,t)=>{t.d(s,{E:()=>h});var r=t(8873),a=t(84476),l=t(24555),n=t(21334),o=t(77506),i=t(90182),c=t(48372);const d=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),u=(0,c.g4)("ydb-diagnostics-autorefresh-control",{en:d});var v=t(60712);const m=(0,o.cn)("auto-refresh-control");function h({className:e}){const s=(0,i.YQ)(),[t,o]=(0,i.Nt)();return(0,v.jsxs)("div",{className:m(null,e),children:[(0,v.jsx)(a.$,{view:"flat-secondary",onClick:()=>{s(n.F.util.invalidateTags(["All"]))},extraProps:{"aria-label":u("Refresh")},children:(0,v.jsx)(a.$.Icon,{children:(0,v.jsx)(r.A,{})})}),(0,v.jsxs)(l.l,{value:[String(t)],onUpdate:e=>{o(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,v.jsx)(l.l.Option,{value:"0",children:u("None")}),(0,v.jsx)(l.l.Option,{value:"15000",children:u("15 sec")}),(0,v.jsx)(l.l.Option,{value:"60000",children:u("1 min")}),(0,v.jsx)(l.l.Option,{value:"120000",children:u("2 min")}),(0,v.jsx)(l.l.Option,{value:"300000",children:u("5 min")})]})]})}},52248:(e,s,t)=>{t.d(s,{a:()=>r.a});var r=t(47334)},15132:(e,s,t)=>{t.d(s,{O:()=>v});var r=t(38501),a=t(77506),l=t(56839),n=t(35736),o=t(41650),i=t(60712);const c=(0,a.cn)("progress-viewer"),d=e=>(0,l.ZV)((0,l.CR)(Number(e),2)),u=(e,s)=>[d(e),d(s)];function v({value:e,capacity:s,formatValues:t=u,percents:a,className:l,size:d="xs",colorizeProgress:v,inverseColorize:m,warningThreshold:h,dangerThreshold:N,hideCapacity:g}){const p=(0,r.D)();let S=Math.round(parseFloat(String(e))/parseFloat(String(s))*100)||0;S=S>100?100:S;let f=e,b=s,x="/";a?(f=S+"%",b="",x=""):t&&([f,b]=t(Number(e),Number(s)));const E=(0,n.w)({fillWidth:S,warningThreshold:h,dangerThreshold:N,colorizeProgress:v,inverseColorize:m});v&&!(0,o.kf)(s)&&(S=100);const j={width:S+"%"};return(0,o.kf)(e)?(0,i.jsxs)("div",{className:c({size:d,theme:p,status:E},l),children:[(0,i.jsx)("div",{className:c("line"),style:j}),(0,i.jsx)("span",{className:c("text"),children:(0,o.kf)(s)&&!g?`${f} ${x} ${b}`:f})]}):(0,i.jsx)("div",{className:`${c({size:d})} ${l} error`,children:"no data"})}},17594:(e,s,t)=>{t.d(s,{l:()=>c});var r=t(69024),a=t(4557),l=t(77506),n=t(16819),o=t(60712);const i=(0,l.cn)("ydb-resizeable-data-table");function c({columnsWidthLSKey:e,columns:s,settings:t,wrapperClassName:l,...c}){const[d,u]=(0,n.a)(e),v=(0,r.j)(s,d),m={...t,defaultResizeable:!0};return(0,o.jsx)("div",{className:i(null,l),children:(0,o.jsx)(a.Ay,{theme:"yandex-cloud",columns:v,onResize:u,settings:m,...c})})}},41775:(e,s,t)=>{t.d(s,{v:()=>i});var r=t(59284),a=t(28664),l=t(77506),n=t(60712);const o=(0,l.cn)("ydb-search"),i=({onChange:e,value:s="",width:t,className:l,debounce:i=200,placeholder:c})=>{const[d,u]=r.useState(s),v=r.useRef();r.useEffect((()=>{u((e=>e!==s?s:e))}),[s]);return(0,n.jsx)(a.k,{hasClear:!0,autoFocus:!0,style:{width:t},className:o(null,l),placeholder:c,value:d,onUpdate:s=>{u(s),window.clearTimeout(v.current),v.current=window.setTimeout((()=>{null===e||void 0===e||e(s)}),i)}})}},95963:(e,s,t)=>{t.d(s,{v:()=>r.v});var r=t(41775)},48288:(e,s,t)=>{t.r(s),t.d(s,{Clusters:()=>se});var r=t(59284),a=t(4557),l=t(24555),n=t(69775),o=t(61750),i=t(90053),c=t(44508),d=t(52248),u=t(17594),v=t(95963),m=t(39567),h=t(23536),N=t.n(h);const g=e=>e.clusters.clusterName,p=e=>e.clusters.status,S=e=>e.clusters.service,f=e=>e.clusters.version,b=(e,s)=>0===s.length||e.status&&s.includes(e.status),x=(e,s)=>0===s.length||e.service&&s.includes(e.service),E=(e,s)=>0===s.length||s.some((s=>{var t,r;return null===(t=e.cluster)||void 0===t||null===(r=t.Versions)||void 0===r?void 0:r.some((e=>e.startsWith(s)))})),j=(e,s="")=>{var t;if(!s)return!0;const r=s.toLowerCase(),a=r.split(" "),l=(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().match(/[^\d\s]+|\d+|[^-\s]+|[^_\s]+/g))||[],n=a.every((s=>{const t=N()(s),r=new RegExp(`^${t}|[\\s\\-_]${t}`,"i");return e.title&&r.test(e.title)||l.some((e=>e.startsWith(s)))})),o=e.preparedVersions.some((e=>e.version.includes(r))),i=Boolean(e.hosts&&e.hosts[r]);return n||o||i};var T=t(76086),O=t(90182),C=t(43951),w=t(38596),A=t(15132),_=t(56839),y=t(48372);const R=JSON.parse('{"controls_status-select-label":"Status:","controls_service-select-label":"Service:","controls_version-select-label":"Version:","controls_search-placeholder":"Cluster name, version, host","controls_select-placeholder":"All","statistics_clusters":"Clusters","statistics_hosts":"Hosts","statistics_tenants":"Tenants","statistics_nodes":"Nodes","statistics_load":"Load","statistics_storage":"Storage","tooltip_no-cluster-data":"No cluster data","page_title":"Clusters"}'),I=JSON.parse('{"controls_status-select-label":"\u0421\u0442\u0430\u0442\u0443\u0441:","controls_service-select-label":"\u0421\u0435\u0440\u0432\u0438\u0441:","controls_version-select-label":"\u0412\u0435\u0440\u0441\u0438\u044f:","controls_search-placeholder":"\u0418\u043c\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432\u0435\u0440\u0441\u0438\u044f \u0438\u043b\u0438 \u0445\u043e\u0441\u0442","controls_select-placeholder":"\u0412\u0441\u0435","statistics_clusters":"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b","statistics_hosts":"\u0425\u043e\u0441\u0442\u044b","statistics_tenants":"\u0411\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445","statistics_nodes":"\u0423\u0437\u043b\u044b","statistics_load":"\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430","statistics_storage":"\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435","tooltip_no-cluster-data":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430","page_title":"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b"}'),D=(0,y.g4)("ydb-clusters-page",{ru:I,en:R});var z=t(77506);const L=(0,z.cn)("clusters");var k=t(60712);const V=({count:e,stats:s})=>{const{NodesTotal:t,NodesAlive:r,Hosts:a,Tenants:l,LoadAverage:n,NumberOfCpus:o,StorageUsed:i,StorageTotal:c}=s;return(0,k.jsxs)("div",{className:L("aggregation"),children:[(0,k.jsxs)("div",{className:L("aggregation-value-container"),children:[(0,k.jsx)("span",{className:L("aggregation-label"),children:D("statistics_clusters")}),e]}),(0,k.jsxs)("div",{className:L("aggregation-value-container"),children:[(0,k.jsx)("span",{className:L("aggregation-label"),children:D("statistics_hosts")}),a]}),(0,k.jsxs)("div",{className:L("aggregation-value-container"),children:[(0,k.jsx)("span",{className:L("aggregation-label"),children:D("statistics_tenants")}),l]}),(0,k.jsxs)("div",{className:L("aggregation-value-container"),children:[(0,k.jsx)("span",{className:L("aggregation-label"),children:D("statistics_nodes")}),(0,k.jsx)(A.O,{size:"ns",value:r,capacity:t,colorizeProgress:!0,inverseColorize:!0})]}),(0,k.jsxs)("div",{className:L("aggregation-value-container"),children:[(0,k.jsx)("span",{className:L("aggregation-label"),children:D("statistics_load")}),(0,k.jsx)(A.O,{size:"ns",value:n,capacity:o,colorizeProgress:!0})]}),(0,k.jsxs)("div",{className:L("aggregation-value-container"),children:[(0,k.jsx)("span",{className:L("aggregation-label"),children:D("statistics_storage")}),(0,k.jsx)(A.O,{size:"ns",value:i,capacity:c,formatValues:_.j9,colorizeProgress:!0})]})]})};var U=t(6170),G=t(67884),W=t(18143),P=t(96873),$=t(34271);const H=(0,z.cn)("kv-user");function M({login:e,className:s}){const t=(0,$.x)("StaffCard");return(0,k.jsx)("div",{className:H(null,s),children:(0,k.jsx)(t,{login:e,children:(0,k.jsx)("div",{className:H("name"),children:e})})})}var B=t(31684),F=t(69446),q=t(87842);const K="selectedColumns",J={TITLE:"title",VERSIONS:"versions",DC:"dc",SERVICE:"service",STATUS:"status",NODES:"nodes",LOAD:"load",STORAGE:"storage",HOSTS:"hosts",TENANTS:"tenants",OWNER:"owner",DESCRIPTION:"description",BALANCER:"balancer"},Q=[J.TITLE,J.VERSIONS,J.SERVICE,J.STATUS,J.NODES,J.LOAD,J.STORAGE,J.HOSTS,J.TENANTS,J.OWNER,J.BALANCER],X={[J.TITLE]:"Cluster",[J.VERSIONS]:"Versions",[J.DC]:"DC",[J.SERVICE]:"Service",[J.STATUS]:"Status",[J.NODES]:"Nodes",[J.LOAD]:"Load",[J.STORAGE]:"Storage",[J.HOSTS]:"Hosts",[J.TENANTS]:"Tenants",[J.OWNER]:"Owner",[J.DESCRIPTION]:"Description",[J.BALANCER]:"Balancer"},Y="clustersTableColumnsWidth",Z=(0,k.jsx)("span",{className:L("empty-cell"),children:"\u2014"}),ee=[{name:J.TITLE,header:X[J.TITLE],width:230,render:({row:e})=>{var s,t;const{balancer:r,name:a,use_embedded_ui:l}=e,n=r&&(0,F.PG)(r),o=l&&n?(0,B.t1)(n):(0,q.a)(void 0,{backend:n,clusterName:a}),i=null===(s=e.cluster)||void 0===s?void 0:s.Overall;return(0,k.jsxs)("div",{className:L("cluster"),children:[i?(0,k.jsx)(G.N,{href:o,children:(0,k.jsx)("div",{className:L("cluster-status",{type:i&&i.toLowerCase()})})}):(0,k.jsx)("div",{className:L("cluster-status"),children:(0,k.jsx)(U.B,{content:(0,k.jsx)("span",{className:L("tooltip-content"),children:(null===(t=e.cluster)||void 0===t?void 0:t.error)||D("tooltip_no-cluster-data")}),offset:{left:0}})}),(0,k.jsx)("div",{className:L("cluster-name"),children:(0,k.jsx)(G.N,{href:o,children:e.title})})]})},defaultOrder:a.Ay.ASCENDING},{name:J.VERSIONS,header:X[J.VERSIONS],width:300,defaultOrder:a.Ay.DESCENDING,sortAccessor:({preparedVersions:e})=>e.map((e=>e.version.replace(/^[0-9]\+\./g,""))).sort(((e,s)=>e.localeCompare(s)))[0]||void 0,render:({row:e})=>{const{preparedVersions:s,versions:t=[],balancer:a,name:l}=e;if(!t.length||t.some((e=>!e.version)))return Z;const n=t.reduce(((e,s)=>e+s.count),0),o=t.map((e=>{var t;return{value:e.count/n*100,color:null===(t=s.find((s=>s.version===e.version)))||void 0===t?void 0:t.color}})),i=a&&(0,F.PG)(a);return s.length>0&&(0,k.jsx)(G.N,{className:L("cluster-versions"),href:(0,q.a)(q.Bi.versions,{backend:i,clusterName:l}),children:(0,k.jsxs)(r.Fragment,{children:[s.map(((e,s)=>(0,k.jsx)("div",{className:L("cluster-version"),style:{color:e.color},title:e.version,children:e.version},s))),(0,k.jsx)(W.k,{size:"s",value:100,stack:o})]})})}},{name:J.DC,header:X[J.DC],width:120,sortable:!1,render:({row:e})=>{const s=e.cluster&&e.cluster.DataCenters||[];return(0,k.jsx)("div",{className:L("cluster-dc"),children:s.join(", ")||Z})}},{name:J.SERVICE,header:X[J.SERVICE],width:100,sortable:!0},{name:J.STATUS,header:X[J.STATUS],width:150,sortable:!0},{name:J.NODES,header:X[J.NODES],resizeMinWidth:170,defaultOrder:a.Ay.DESCENDING,sortAccessor:({cluster:e={}})=>{const{NodesTotal:s=0}=e;return s},render:({row:e})=>{const{NodesAlive:s=0,NodesTotal:t=0,Overall:r}=e.cluster||{};return r?(0,k.jsx)(A.O,{value:s,capacity:t}):Z}},{name:J.LOAD,header:X[J.LOAD],resizeMinWidth:170,defaultOrder:a.Ay.DESCENDING,sortAccessor:({cluster:e})=>null===e||void 0===e?void 0:e.NumberOfCpus,render:({row:e})=>{const{LoadAverage:s=0,NumberOfCpus:t=0,Overall:r}=e.cluster||{};return r?(0,k.jsx)(A.O,{value:s,capacity:t}):Z}},{name:J.STORAGE,header:X[J.STORAGE],resizeMinWidth:170,defaultOrder:a.Ay.DESCENDING,sortAccessor:({cluster:e})=>Number(null===e||void 0===e?void 0:e.StorageTotal),render:({row:e})=>{const{StorageUsed:s=0,StorageTotal:t=0,Overall:r}=e.cluster||{};return r?(0,k.jsx)(A.O,{value:s,capacity:t,formatValues:_.ki}):Z}},{name:J.HOSTS,header:X[J.HOSTS],width:80,defaultOrder:a.Ay.DESCENDING,sortAccessor:({cluster:e})=>Number(null===e||void 0===e?void 0:e.Hosts)||0,render:({row:e})=>{var s;return Number(null===(s=e.cluster)||void 0===s?void 0:s.Hosts)||Z}},{name:J.TENANTS,header:X[J.TENANTS],width:80,defaultOrder:a.Ay.DESCENDING,sortAccessor:({cluster:e})=>Number(null===e||void 0===e?void 0:e.Tenants)||0,render:({row:e})=>{var s;return Number(null===(s=e.cluster)||void 0===s?void 0:s.Tenants)||Z}},{name:J.OWNER,header:X[J.OWNER],sortable:!1,width:120,render:({row:e})=>{var s;const t=null===(s=e.owner)||void 0===s?void 0:s.split(", ");return null!==t&&void 0!==t&&t.length?t.map((e=>(0,k.jsx)(M,{login:e},e))):Z}},{name:J.DESCRIPTION,header:X[J.DESCRIPTION],sortable:!1,width:150,render:({row:e})=>e.description?(0,k.jsx)("div",{className:L("description"),children:e.description}):Z},{name:J.BALANCER,header:X[J.BALANCER],sortable:!1,width:290,render:({row:e})=>{if(!e.balancer)return Z;const s=(0,F.Zd)(e.balancer);return(0,k.jsxs)("div",{className:L("balancer-cell"),children:[(0,k.jsx)("div",{className:L("balancer-text"),children:s}),(0,k.jsx)(P.b,{size:"s",text:s,className:L("balancer-icon")})]})}}];function se(){const[e]=(0,O.Nt)(),s=m.ub.useGetClustersListQuery(void 0,{pollingInterval:e}),t=(0,O.YQ)(),h=(0,O.N4)(g),N=(0,O.N4)(p),A=(0,O.N4)(S),_=(0,O.N4)(f),{columnsToShow:y,columnsToSelect:R,setColumns:I}=(0,C.K)(ee,K,X,Q,[J.TITLE]),z=s.data,{servicesToSelect:U,versions:G}=r.useMemo((()=>{const e=new Set,s=new Set;return(null!==z&&void 0!==z?z:[]).forEach((t=>{var r,a;t.service&&e.add(t.service),null===(r=t.cluster)||void 0===r||null===(a=r.Versions)||void 0===a||a.forEach((e=>{s.add((0,w.U)(e))}))})),{servicesToSelect:Array.from(e).map((e=>({value:e,content:e}))),versions:Array.from(s).map((e=>({value:e,content:e})))}}),[z]),W=r.useMemo((()=>function(e,s){return e.filter((e=>b(e,s.status)&&x(e,s.service)&&E(e,s.version)&&j(e,s.clusterName)))}(null!==z&&void 0!==z?z:[],{clusterName:h,status:N,service:A,version:_})),[h,z,A,N,_]),P=r.useMemo((()=>function(e){let s=0,t=0,r=0,a=0,l=0,n=0,o=0;const i=new Set;return e.filter((({cluster:e})=>!(null!==e&&void 0!==e&&e.error))).forEach((({cluster:e,hosts:c={}})=>{s+=(null===e||void 0===e?void 0:e.NodesTotal)||0,t+=(null===e||void 0===e?void 0:e.NodesAlive)||0,Object.keys(c).forEach((e=>i.add(e))),o+=Number(null===e||void 0===e?void 0:e.Tenants)||0,r+=Number(null===e||void 0===e?void 0:e.LoadAverage)||0,a+=(null===e||void 0===e?void 0:e.NumberOfCpus)||0,l+=null!==e&&void 0!==e&&e.StorageUsed?Math.floor(parseInt(e.StorageUsed,10)):0,n+=null!==e&&void 0!==e&&e.StorageTotal?Math.floor(parseInt(e.StorageTotal,10)):0})),{NodesTotal:s,NodesAlive:t,Hosts:i.size,Tenants:o,LoadAverage:r,NumberOfCpus:a,StorageUsed:l,StorageTotal:n}}(W)),[W]),$=r.useMemo((()=>Array.from(new Set((null!==z&&void 0!==z?z:[]).map((e=>e.status)).filter(Boolean))).sort().map((e=>({value:e,content:e})))),[z]);return(0,k.jsxs)("div",{className:L(),children:[(0,k.jsx)(o.mg,{children:(0,k.jsx)("title",{children:D("page_title")})}),(0,k.jsx)(V,{stats:P,count:W.length}),(0,k.jsxs)("div",{className:L("controls"),children:[(0,k.jsx)("div",{className:L("control",{wide:!0}),children:(0,k.jsx)(v.v,{placeholder:D("controls_search-placeholder"),onChange:e=>{t((0,m.Fe)({clusterName:e}))},value:h})}),(0,k.jsx)("div",{className:L("control"),children:(0,k.jsx)(l.l,{multiple:!0,filterable:!0,hasClear:!0,placeholder:D("controls_select-placeholder"),label:D("controls_status-select-label"),value:N,options:$,onUpdate:e=>{t((0,m.Fe)({status:e}))},width:"max"})}),(0,k.jsx)("div",{className:L("control"),children:(0,k.jsx)(l.l,{multiple:!0,filterable:!0,hasClear:!0,placeholder:D("controls_select-placeholder"),label:D("controls_service-select-label"),value:A,options:U,onUpdate:e=>{t((0,m.Fe)({service:e}))},width:"max"})}),(0,k.jsx)("div",{className:L("control"),children:(0,k.jsx)(l.l,{multiple:!0,filterable:!0,hasClear:!0,placeholder:D("controls_select-placeholder"),label:D("controls_version-select-label"),value:_,options:G,onUpdate:e=>{t((0,m.Fe)({version:e}))},width:"max"})}),(0,k.jsx)("div",{className:L("control"),children:(0,k.jsx)(n.O,{popupWidth:242,items:R,showStatus:!0,onUpdate:I,sortable:!1},"TableColumnSetup")}),(0,k.jsx)(i.E,{className:L("autorefresh")})]}),s.isError?(0,k.jsx)(c.o,{error:s.error,className:L("error")}):null,s.isLoading?(0,k.jsx)(d.a,{size:"l"}):null,s.fulfilledTimeStamp?(0,k.jsx)("div",{className:L("table-wrapper"),children:(0,k.jsx)("div",{className:L("table-content"),children:(0,k.jsx)(u.l,{columnsWidthLSKey:Y,wrapperClassName:L("table"),data:W,columns:y,settings:{...T.N3,dynamicRender:!1},initialSortOrder:{columnId:J.TITLE,order:a.Ay.ASCENDING}})})}):null]})}},43951:(e,s,t)=>{t.d(s,{K:()=>l});var r=t(59284),a=t(59001);const l=(e,s,t,l,n)=>{const[o,i]=r.useState((()=>a.f.readUserSettingsValue(s,l)));return{columnsToShow:r.useMemo((()=>e.filter((e=>{const s=e.name,t=o.includes(s),r=null===n||void 0===n?void 0:n.includes(s);return t||r}))),[e,n,o]),columnsToSelect:r.useMemo((()=>e.map((e=>e.name)).map((e=>{const s=null===n||void 0===n?void 0:n.includes(e),r=o.includes(e);return{id:e,title:t[e],selected:s||r,required:s,sticky:s?"start":void 0}}))),[e,t,n,o]),setColumns:r.useCallback((e=>{const t=e.filter((e=>e.selected)).map((e=>e.id));a.f.setUserSettingsValue(s,t),i(t)}),[s])}}},16819:(e,s,t)=>{t.d(s,{a:()=>n});var r=t(59284),a=t(69024),l=t(59001);const n=e=>{const s=r.useCallback((()=>e?l.f.readUserSettingsValue(e,{}):{}),[e]),t=r.useCallback((s=>{e&&l.f.setUserSettingsValue(e,s)}),[e]);return(0,a.a)({saveSizes:t,getSizes:s})}},35736:(e,s,t)=>{t.d(s,{w:()=>a});var r=t(76086);function a({inverseColorize:e,warningThreshold:s=r.Hh,dangerThreshold:t=r.Ed,colorizeProgress:a,fillWidth:l}){let n=e?"danger":"good";return a&&(l>s&&l<=t?n="warning":l>t&&(n=e?"good":"danger")),n}},6170:(e,s,t)=>{t.d(s,{B:()=>c});var r=t(59284),a=t(73633),l=t(84375),n=t(99991);const o=(0,t(98192).om)("help-popover"),i=16;function c(e){var s;return r.createElement(l.A,Object.assign({},e,{className:o(null,e.className)}),r.createElement("button",Object.assign({ref:e.buttonRef,type:"button"},e.buttonProps,{className:o("button",null===(s=e.buttonProps)||void 0===s?void 0:s.className)}),r.createElement(n.I,{data:a.A,size:i})))}},98192:(e,s,t)=>{t.d(s,{CU:()=>a,om:()=>l});var r=t(82435);const a="gc-",l=((0,r.withNaming)({e:"__",m:"_",v:"_"}),(0,r.withNaming)({n:a,e:"__",m:"_",v:"_"}))},18143:(e,s,t)=>{t.d(s,{k:()=>u});var r=t(59284);const a=(0,t(69220).om)("progress");function l(e){const{text:s,offset:t=0}=e;return s?r.createElement("div",{className:a("text-inner"),style:{transform:`translateX(calc(var(--g-flow-direction) * ${-t}%))`}},s):null}function n({item:e}){const{value:s,color:t,className:l,theme:n,title:o,content:i,loading:c}=e,d={loading:c};return"undefined"===typeof t&&(d.theme=n||"default"),Number.isFinite(s)?r.createElement("div",{className:a("item",d,l),style:{width:`${s}%`,backgroundColor:t},title:o},i):null}function o(e){return e<100?e-100:0}function i(e){const{theme:s,colorStops:t,colorStopsValue:r,value:a}=e;if(t){const e=t.find(((e,s)=>{const l="number"===typeof r?r:a,n=s>1?t[s-1].stop:0,o=s<t.length-1?e.stop:100;return l>=n&&l<=o}));return e?e.theme:s}return s}function c(e){const{stack:s,stackClassName:t,value:i,text:c}=e,d=o(i||function(e){return e.reduce(((e,{value:s})=>e+s),0)}(s));return r.createElement("div",{className:a("stack",t),style:{transform:`translateX(calc(var(--g-flow-direction) * ${d}%))`}},r.createElement("div",{className:a("item"),style:{width:-d+"%"}}),s.map(((e,s)=>r.createElement(n,{key:s,item:e}))),r.createElement(l,{offset:d,text:c}))}function d(e){const{value:s,loading:t,text:n}=e,c=o(s);return Number.isFinite(s)?r.createElement("div",{className:a("item",{theme:i(e),loading:t}),style:{transform:`translateX(calc(var(--g-flow-direction) * ${c}%))`}},r.createElement(l,{offset:c,text:n})):null}const u=r.forwardRef((function(e,s){const{text:t="",theme:l="default",size:n="m",loading:o=!1,className:i,qa:u}=e,v=Object.assign(Object.assign({},e),{text:t,theme:l,size:n,loading:o});return r.createElement("div",{ref:s,className:a({size:n},i),"data-qa":u},r.createElement("div",{className:a("text")},t),function(e){return void 0!==e.stack}(v)?r.createElement(c,Object.assign({},v)):r.createElement(d,Object.assign({},v)))}))}}]);