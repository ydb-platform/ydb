(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[4130],{23536:(e,t,n)=>{var i=n(68814),s=/[\\^$.*+?()[\]{}|]/g,a=RegExp(s.source);e.exports=function(e){return(e=i(e))&&a.test(e)?e.replace(s,"\\$&"):e}},38501:(e,t,n)=>{"use strict";n.d(t,{D:()=>s});var i=n(46878);function s(){return(0,i.w)().theme}},69775:(e,t,n)=>{"use strict";n.d(t,{O:()=>Ce});var i=n(59284),s=n(27738),a=n(84476),d=n(99991),l=n(66821);const r=e=>i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),i.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10.5 6V5a2.5 2.5 0 0 0-5 0v1zM4 5v1a3 3 0 0 0-3 3v3a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3V5a4 4 0 0 0-8 0m6.5 2.5H12A1.5 1.5 0 0 1 13.5 9v3a1.5 1.5 0 0 1-1.5 1.5H4A1.5 1.5 0 0 1 2.5 12V9A1.5 1.5 0 0 1 4 7.5zm-1.75 2a.75.75 0 0 0-1.5 0v2a.75.75 0 0 0 1.5 0z",clipRule:"evenodd"}));var o=n(53202),c=n(90826),u=n(46734),m=n(98089),p=n(32084),I=n(51301),v=n(92609),b=n(19884),g=n(93628),f=n(27145),y=n(87184),h=n(69220);const x=(0,h.om)("list-container-view"),S=i.forwardRef((function({as:e="div",role:t="listbox",children:n,id:s,className:a,fixedHeight:d,extraProps:l,qa:r,style:o},c){return i.createElement(y.s,Object.assign({qa:r,as:e,direction:"column",ref:c,grow:!0,tabIndex:-1,id:s,role:t,style:o,className:x({"fixed-height":d},a)},l),n)})),B=e=>null!==e&&"object"===typeof e&&"data"in e,E=(0,h.om)("list-recursive-renderer");function C(e){var t,{id:n,itemSchema:s,list:a}=e,d=(0,f.Tt)(e,["id","itemSchema","list"]);const l=d.children(n,a.structure.idToFlattenIndex[n]);if(B(s)&&s.children){const e=!a.state.expandedById||!(n in a.state.expandedById)||a.state.expandedById[n];return i.createElement("ul",{style:d.style,className:E(null,d.className),role:"group"},l,e&&Boolean(null===(t=a.structure.groupsState[n])||void 0===t?void 0:t.childrenIds)&&s.children.map(((e,t)=>i.createElement(C,Object.assign({list:a,id:a.structure.groupsState[n].childrenIds[t],itemSchema:e,key:t},d)))))}return l}function O(e){var{containerRef:t,renderItem:n,list:s}=e,a=(0,f.Tt)(e,["containerRef","renderItem","list"]);return i.createElement(S,Object.assign({ref:t},a),s.structure.items.map(((e,t)=>i.createElement(C,{key:t,itemSchema:e,id:s.structure.rootIds[t],list:s},n))))}const w=({list:e,multiple:t})=>({id:n})=>{e.state.disabledById[n]||(e.state.setActiveItemId(n),e.state.expandedById&&n in e.state.expandedById&&e.state.setExpanded?e.state.setExpanded((e=>Object.assign(Object.assign({},e),{[n]:!e[n]}))):e.state.setSelected((e=>Object.assign(Object.assign({},t?e:{}),{[n]:!t||!e[n]}))))};var j=n(359);const k="data-list-item",N={s:[22,44],m:[26,44],l:[34,52],xl:[44,62]},R=({containerRef:e,onItemClick:t,enabled:n,list:s})=>{const a=i.useCallback(((t,n=!0)=>{var i,a;"number"===typeof t&&s.structure.visibleFlattenIds[t]&&(n&&((e,t)=>{var n;if(document){const i=(t||document).querySelector(`[${k}="${e}"]`);i&&(null===(n=i.scrollIntoView)||void 0===n||n.call(i,{block:"nearest"}))}})(s.structure.visibleFlattenIds[t],null===e||void 0===e?void 0:e.current),null===(a=(i=s.state).setActiveItemId)||void 0===a||a.call(i,s.structure.visibleFlattenIds[t]))}),[s.structure.visibleFlattenIds,s.state,e]),d=i.useCallback(((e,t,n=0)=>{e.preventDefault();const i="string"===typeof s.state.activeItemId?s.structure.visibleFlattenIds.findIndex((e=>e===s.state.activeItemId)):-1,d=(({list:e,index:t,step:n,disabledItemsById:i={}})=>{const s=e.length;let a=(t+s)%s;for(let d=0;d<s;d+=1){const t=e[a];if(t&&!i[t])return a;a=(a+s+n)%s}})({list:s.structure.visibleFlattenIds,index:(i>-1?i:n)+t,step:Math.sign(t),disabledItemsById:s.state.disabledById});a(d)}),[a,s.state.activeItemId,s.state.disabledById,s.structure.visibleFlattenIds]);i.useLayoutEffect((()=>{const i=null===e||void 0===e?void 0:e.current;if(n||!i)return;const a=e=>{switch(e.key){case j.D.ARROW_DOWN:d(e,1,-1);break;case j.D.ARROW_UP:d(e,-1);break;case j.D.SPACEBAR:case j.D.ENTER:s.state.activeItemId&&!s.state.disabledById[s.state.activeItemId]&&(e.preventDefault(),null===t||void 0===t||t({id:s.state.activeItemId}))}};return i.addEventListener("keydown",a),()=>{i.removeEventListener("keydown",a)}}),[e,n,d,s.state.activeItemId,s.state.disabledById,t])};var D=n(46423),F=n(25569),P=n(63365),T=n(33705);const $=(0,h.om)("list-item-expand-icon"),A=({expanded:e,behavior:t="action",disabled:n})=>i.createElement(T.I,{direction:z({behavior:t,expanded:e}),className:$(null,(0,P.$)({color:n?"hint":void 0})),size:16});function z({behavior:e,expanded:t}){return t&&"action"===e?"top":t&&"state"===e||t&&"state-inverse"===e||"action"===e?"bottom":"state"===e?"right":"state-inverse"===e?"left":"bottom"}const M=(0,h.om)("list-item-view"),L=e=>"object"===typeof e&&null!==e&&"title"in e,q=e=>{var{children:t,indentation:n=1,className:s}=e,a=(0,f.Tt)(e,["children","indentation","className"]);return i.createElement(y.s,Object.assign({width:16*n,className:M("slot",s)},a),t)},_=({startSlot:e,subtitle:t,endSlot:n,disabled:s,hasSelectionIcon:a,isGroup:l,indentation:r,expanded:o,selected:c,title:u,expandIconPlacement:p="start",renderExpandIcon:I=A})=>{const v=l?i.createElement(I,{behavior:"start"===p?"state":"action",expanded:o,disabled:s}):null;return i.createElement(y.s,{alignItems:"center",justifyContent:"space-between",gap:"4",className:M("content")},i.createElement(y.s,{gap:"2",alignItems:"center",grow:!0},a&&i.createElement(q,null,c?i.createElement(d.I,{data:F.A,size:16,className:(0,P.$)({color:"info"})}):null),(e=>e&&e>=1?i.createElement(q,{indentation:Math.floor(e)}):null)(r),"start"===p&&v,e,i.createElement("div",{className:M("main-content")},"string"===typeof u?i.createElement(m.E,{ellipsis:!0,color:s?"hint":void 0,variant:l?"subheader-1":void 0},u):u,"string"===typeof t?i.createElement(m.E,{ellipsis:!0,color:s?"hint":"secondary"},t):t)),i.createElement(y.s,{gap:"2"},"end"===p&&v,n))},V=i.forwardRef((function(e,t){var{id:n,as:s,size:a="m",active:d,selected:l,disabled:r,selectionViewType:o="multiple",activeOnHover:c,className:u,height:m,dragging:p,style:I,content:v,role:b="option",onClick:g}=e,y=(0,f.Tt)(e,["id","as","size","active","selected","disabled","selectionViewType","activeOnHover","className","height","dragging","style","content","role","onClick"]);const h=s||"li",x=r?void 0:g,S="boolean"===typeof c?c:Boolean(x),B=Object.assign({minHeight:`var(--g-list-item-height, ${null!==m&&void 0!==m?m:N[a][Number(Boolean(!!L(v)&&(null===v||void 0===v?void 0:v.subtitle)))]}px)`},I);return i.createElement(h,Object.assign({[k]:n,role:b,"aria-selected":l,onClick:x,className:M({active:p||d,selected:l&&"single"===o,activeOnHover:S,radius:a,size:a,dragging:p,clickable:Boolean(x)},(0,D.Y)({px:2},u)),style:B,ref:t},y),L(v)?i.createElement(_,Object.assign({},v,{hasSelectionIcon:"multiple"===o,selected:l,disabled:r})):v)})),U=(0,h.om)("tree-list"),W=({qa:e,id:t,size:n="m",className:s,list:a,multiple:d,containerRef:l,renderItem:r,renderContainer:o=O,onItemClick:u,mapItemDataToContentProps:m})=>{const p=(0,c.u)(),I=null!==t&&void 0!==t?t:p,v=i.useRef(null),b=null!==l&&void 0!==l?l:v,g=i.useMemo((()=>{if(null===u)return;return(e,t)=>{const n={id:e.id,list:a};if(u)null===u||void 0===u||u(n,t);else{w({list:a,multiple:d})(n,t)}}}),[u,a,d]);R({containerRef:b,onItemClick:g,list:a});return o({qa:e,id:`list-${I}`,size:n,containerRef:b,className:U(null,s),list:a,renderItem:(t,s,l)=>{const o=(({qa:e,list:t,onItemClick:n,mapItemDataToContentProps:i,size:s="m",multiple:a=!1,id:d})=>{var l,r;const o=Object.assign(Object.assign(Object.assign({},t.structure.itemsState[d]),t.structure.groupsState[d]),{isLastItem:d===t.structure.visibleFlattenIds[t.structure.visibleFlattenIds.length-1]}),c={id:d,size:s,selected:Boolean(t.state.selectedById[d]),disabled:Boolean(null===(l=t.state.disabledById)||void 0===l?void 0:l[d]),active:d===t.state.activeItemId,onClick:n?e=>n({id:d},e):void 0,selectionViewType:Boolean(a)&&!o.childrenIds?"multiple":"single",content:Object.assign({expanded:null===(r=t.state.expandedById)||void 0===r?void 0:r[d],indentation:o.indentation,isGroup:t.state.expandedById&&d in t.state.expandedById},i(t.structure.itemsById[d]))};return e&&(c.qa=((e,t)=>`${e}-${t}`)(e,d)),{data:t.structure.itemsById[d],props:c,context:o}})({qa:e,id:t,size:n,multiple:d,mapItemDataToContentProps:m,onItemClick:g,list:a});return r?r({id:t,data:o.data,props:o.props,context:o.context,index:s,renderContainerProps:l,list:a}):i.createElement(V,Object.assign({},o.props,l))}})};var H=n(63246),J=n(34379),G=n(46819);const Y=({item:e,groupedId:t,getItemId:n})=>{let i=t;return"function"===typeof n?i=n(B(e)?e.data:e):e&&"object"===typeof e&&"id"in e&&e.id&&(i=e.id),i},K=(e,t)=>t?`${t}-${e}`:`${e}`;function Q({items:e,expandedById:t,getItemId:n}){const s=i.useMemo((()=>function({items:e,getItemId:t,expandedById:n={}}){const i=[],s=(e,a,d,l)=>{const r=K(d,l),o=Y({groupedId:r,item:a,getItemId:t});return l||i.push(o),e.push(o),B(a)&&a.children&&(o in n&&!n[o]||e.push(...a.children.reduce(((e,t,n)=>s(e,t,n,o)),[]))),e},a=e.reduce(((e,t,n)=>s(e,t,n)),[]),d={};for(const[l,r]of a.entries())d[r]=l;return{rootIds:i,visibleFlattenIds:a,idToFlattenIndex:d}}({items:e,expandedById:t,getItemId:n})),[e,t,n]);return s}function X({items:e,defaultExpandedState:t="expanded",getItemId:n}){const i={itemsById:{},groupsState:{},itemsState:{},initialState:{disabledById:{},selectedById:{},expandedById:{}}},s=({item:e,index:a,parentGroupedId:d,parentId:l})=>{const r=K(a,d),o=Y({groupedId:r,item:e,getItemId:n});l&&i.groupsState[l].childrenIds.push(o),i.itemsById[o]=e.data,i.itemsState[o]||(i.itemsState[o]={indentation:0}),"undefined"!==typeof l&&(i.itemsState[o].parentId=l),"undefined"!==typeof e.selected&&(i.initialState.selectedById[o]=e.selected),"undefined"!==typeof e.disabled&&(i.initialState.disabledById[o]=e.disabled),r&&(i.itemsState[o].indentation=(e=>e.split("-"))(r).length-1),e.children&&(i.groupsState[o]={childrenIds:[]},i.initialState.expandedById&&("undefined"===typeof e.expanded?i.initialState.expandedById[o]="expanded"===t:i.initialState.expandedById[o]=e.expanded),e.children.forEach(((e,t)=>{s({item:e,index:t,parentGroupedId:r,parentId:o})})))};return e.forEach(((e,t)=>B(e)?s({item:e,index:t}):(({item:e,index:t})=>{const s=Y({groupedId:String(t),item:e,getItemId:n});i.itemsById[s]=e,i.itemsState[s]||(i.itemsState[s]={indentation:0}),e&&"object"===typeof e&&("selected"in e&&"boolean"===typeof e.selected&&(i.initialState.selectedById[s]=e.selected),"disabled"in e&&"boolean"===typeof e.disabled&&(i.initialState.disabledById[s]=e.disabled))})({item:e,index:t}))),i}const Z=({items:e,getItemId:t,defaultExpandedState:n="expanded",withExpandedState:s=!0,initialState:a,controlledState:d})=>{const{itemsById:l,groupsState:r,itemsState:o,initialState:c}=function({items:e,getItemId:t,defaultExpandedState:n}){const s=i.useRef(t).current;return i.useMemo((()=>X({items:e,getItemId:s,defaultExpandedState:n})),[s,n,e])}({items:e,getItemId:t,defaultExpandedState:n}),u=(({initialState:e,withExpandedState:t})=>{const n=i.useRef(e),s=n.current!==e;n.current=e;const[a,d]=i.useState((()=>{var t;return null!==(t=null===e||void 0===e?void 0:e.disabledById)&&void 0!==t?t:{}})),[l,r]=i.useState((()=>{var t;return null!==(t=null===e||void 0===e?void 0:e.selectedById)&&void 0!==t?t:{}})),[o,c]=i.useState((()=>{var t;return null!==(t=null===e||void 0===e?void 0:e.expandedById)&&void 0!==t?t:{}})),[u,m]=i.useState((()=>null===e||void 0===e?void 0:e.activeItemId));s&&((null===e||void 0===e?void 0:e.disabledById)&&d((t=>Object.assign(Object.assign({},e.disabledById),t))),(null===e||void 0===e?void 0:e.selectedById)&&r((t=>Object.assign(Object.assign({},e.selectedById),t))),(null===e||void 0===e?void 0:e.expandedById)&&c((t=>Object.assign(Object.assign({},e.expandedById),t))),m((t=>null!==t&&void 0!==t?t:null===e||void 0===e?void 0:e.activeItemId)));const p={disabledById:a,selectedById:l,activeItemId:u,setDisabled:d,setSelected:r,setActiveItemId:m};return t&&(p.expandedById=o,p.setExpanded=c),p})({initialState:i.useMemo((()=>({expandedById:Object.assign(Object.assign({},c.expandedById),null===a||void 0===a?void 0:a.expandedById),selectedById:Object.assign(Object.assign({},c.selectedById),null===a||void 0===a?void 0:a.selectedById),disabledById:Object.assign(Object.assign({},c.disabledById),null===a||void 0===a?void 0:a.disabledById),activeItemId:null===a||void 0===a?void 0:a.activeItemId})),[c.disabledById,c.expandedById,c.selectedById,null===a||void 0===a?void 0:a.activeItemId,null===a||void 0===a?void 0:a.disabledById,null===a||void 0===a?void 0:a.expandedById,null===a||void 0===a?void 0:a.selectedById]),withExpandedState:s}),m=i.useMemo((()=>d?Object.assign(Object.assign({},u),d):u),[d,u]),{visibleFlattenIds:p,idToFlattenIndex:I,rootIds:v}=Q({items:e,expandedById:m.expandedById,getItemId:t});return{state:m,structure:{rootIds:v,items:e,visibleFlattenIds:p,idToFlattenIndex:I,itemsById:l,groupsState:r,itemsState:o}}},ee=({defaultValue:e=[],value:t,onUpdate:n})=>{const[s,a]=i.useState(e),d=null!==t&&void 0!==t?t:s,l=!t;return i.useMemo((()=>{const e=d.reduce(((e,t)=>(e[t]=!0,e)),{});return{value:d,selectedById:e,setSelected:t=>{const i=(e=>Object.entries(e).reduce(((e,[t,n])=>(n&&e.push(t),e)),[]))("function"===typeof t?t(e):t);l?a(i):null===n||void 0===n||n(i)},setInnerValue:l?a:void 0}}),[n,l,d])},te=(0,h.om)("tree-select"),ne=e=>i.createElement(V,Object.assign({},e.props,e.renderContainerProps)),ie=i.forwardRef((function({id:e,qa:t,title:n,placement:s,slotBeforeListBody:a,slotAfterListBody:d,size:l="m",defaultOpen:r,width:o,containerRef:u,className:m,containerClassName:f,popupClassName:y,open:h,multiple:x,popupWidth:S,popupDisablePortal:B,items:E,value:C,defaultValue:O,placeholder:j,disabled:k=!1,withExpandedState:N=!0,defaultExpandedState:R="expanded",hasClear:D,errorMessage:F,errorPlacement:P,validationState:T,onClose:$,onOpenChange:A,onUpdate:z,renderControl:M,renderItem:L=ne,renderContainer:q,mapItemDataToContentProps:_,onFocus:V,onBlur:U,getItemId:Y,onItemClick:K},Q){const X=(0,G.I)(),ie=(0,c.u)(),se=null!==e&&void 0!==e?e:ie,ae=`tree-select-popup-${se}`,de=i.useRef(null),le=i.useRef(null),re=i.useRef(null),oe=null!==u&&void 0!==u?u:re,{errorMessage:ce,errorPlacement:ue,validationState:me}=(0,J.Av)({errorMessage:F,errorPlacement:P||"outside",validationState:T}),pe=(0,c.u)(),Ie="invalid"===me,ve=Ie&&Boolean(ce)&&"outside"===ue,be=Ie&&Boolean(ce)&&"inside"===ue,ge=(0,p.N)(Q,le),{toggleOpen:fe,open:ye}=(0,v.F)({defaultOpen:r,onClose:$,onOpenChange:A,open:h}),{value:he,selectedById:xe,setSelected:Se}=ee({value:C,defaultValue:O,onUpdate:z}),Be=Z({controlledState:{selectedById:xe,setSelected:Se},items:E,getItemId:Y,defaultExpandedState:R,withExpandedState:N}),Ee=i.useMemo((()=>{if(null===K)return;return(e,t)=>{const n={id:e.id,list:Be};if(K)null===K||void 0===K||K(n,t);else{w({list:Be,multiple:x})(n,t);const i=Be.state.expandedById&&e.id in Be.state.expandedById;x||i||fe(!1)}}}),[K,Be,x,fe]);i.useLayoutEffect((()=>{var e;return ye&&(null===(e=oe.current)||void 0===e||e.focus({preventScroll:!0})),()=>Be.state.setActiveItemId(void 0)}),[ye]);const Ce=i.useCallback((()=>fe(!1)),[fe]),{focusWithinProps:Oe}=(0,I.R)({onFocusWithin:V,onBlurWithin:i.useCallback((e=>{null===U||void 0===U||U(e),Ce()}),[Ce,U])}),we={list:Be,open:ye,placeholder:j,toggleOpen:fe,clearValue:()=>Be.state.setSelected({}),ref:ge,size:l,value:he,disabled:k,id:se,activeItemId:Be.state.activeItemId,title:n,errorMessage:be?ce:void 0,errorPlacement:ue,validationState:me,hasClear:D,isErrorVisible:Ie},je=M?M(we):i.createElement(b.Y,Object.assign({},we,{selectedOptionsContent:i.Children.toArray(he.map((e=>e in Be.structure.itemsById?_(Be.structure.itemsById[e]).title:""))).join(", "),view:"normal",pin:"round-round",popupId:ae,selectId:se})),ke=Object.assign({},"max"===o&&{width:o}),Ne={};return"number"===typeof o&&(Ne.width=o),i.createElement("div",Object.assign({ref:de},Oe,{className:te(ke,m),style:Ne}),je,i.createElement(g.t,{ref:de,className:te("popup",{size:l},y),controlRef:le,width:S,placement:s,open:ye,handleClose:Ce,disablePortal:B,mobile:X,id:ae},a,i.createElement(W,{list:Be,size:l,className:te("list",f),qa:t,multiple:x,id:`list-${se}`,containerRef:oe,onItemClick:Ee,renderContainer:q,mapItemDataToContentProps:_,renderItem:null!==L&&void 0!==L?L:ne}),d),i.createElement(H.o,{errorMessage:ve?ce:null,errorMessageId:pe}))}));var se=n(28664),ae=n(43781),de=n.n(ae);function le(e,t){return!t||"object"!==typeof t||!("title"in t)||"string"!==typeof t.title||t.title.toLowerCase().includes((e||"").toLowerCase())}function re({items:e,initialFilterValue:t="",filterItem:n,onFilterChange:s,filterItems:a,debounceTimeout:d=300}){const l=i.useRef(null),[r,o]=i.useState(t),[c,u]=i.useState(e),[m,p]=i.useState(e),I=i.useCallback(((e,t)=>{if(a)return()=>a(e,t);if(e){const i=n||le;return()=>function(e,t){const n=(e,i)=>{if(B(i)&&i.children){const s=i.children.reduce(n,[]);s.length?e.push(Object.assign(Object.assign({},i),{data:i.data,children:s})):t(i.data)&&e.push(Object.assign(Object.assign({},i),{data:i.data,children:[]}))}else if(B(i)&&t(i.data)){const{children:t}=i,n=(0,f.Tt)(i,["children"]);e.push(n)}else!B(i)&&t(i)&&e.push(i);return e};return e.reduce(n,[])}(t,(t=>i(e,t)))}return()=>t}),[n,a]);e!==c&&(p(I(r,e)),u(e));const v=i.useCallback(de()((t=>p(I(t,e))),d),[p,I,e,d]),{onFilterUpdate:b,reset:g}=i.useMemo((()=>({reset:()=>{o(t),null===s||void 0===s||s(t),v(t)},onFilterUpdate:e=>{o(e),null===s||void 0===s||s(e),v(e)}})),[v,t,s]);return{filterRef:l,filter:r,reset:g,items:m,onFilterUpdate:b}}var oe=n(72837);const ce=JSON.parse('{"button_apply":"Apply","button_reset":"Reset","button_switcher":"Columns"}'),ue=JSON.parse('{"button_apply":"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c","button_reset":"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c","button_switcher":"\u041a\u043e\u043b\u043e\u043d\u043a\u0438"}'),me=(0,oe.N)({en:ce,ru:ue},"TableColumnSetupInner"),pe=(0,h.om)("inner-table-column-setup"),Ie=pe("controls"),ve=pe("filter-input"),be=pe("empty-placeholder"),ge={isDragDisabled:!0},fe=e=>({title:e.title}),ye=(e,t)=>"string"!==typeof t.title||t.title.toLowerCase().includes(e.trim().toLowerCase()),he=e=>{const{renderSwitcher:t,popupWidth:n,popupPlacement:p,items:I,onUpdate:v,sortable:b,renderControls:g,className:f,defaultItems:h=I,showResetButton:x,filterable:B,filterPlaceholder:E,filterEmptyMessage:C,filterSettings:O=ye}=e,[w,j]=i.useState(!1),[k,N]=i.useState(b),[R,D]=i.useState(b);b!==R&&(D(b),N(b));const[F,P]=i.useState(I),[T,$]=i.useState(I);I!==T&&($(I),P(I));const A=re({items:F,filterItem:O,debounceTimeout:0}),z=()=>{const e=F.map((({id:e,isSelected:t})=>({id:e,isSelected:t})));v(e),U(!1)},M=()=>i.createElement(a.$,{view:"action",width:"max",onClick:z},me("button_apply")),L="function"===typeof x?x(F):x,q=(({onDragEnd:e,renderControls:t})=>{const n=(0,c.u)();return({renderItem:s,list:a,containerRef:d,id:l,className:r})=>{const{stickyStartItemIdList:c,sortableItemIdList:u,stickyEndItemIdList:m}=((e,t)=>{let n=0;for(;n!==t.length;n++){const i=e[t[n]];if("left"!==(null===i||void 0===i?void 0:i.sticky)&&"start"!==(null===i||void 0===i?void 0:i.sticky))break}let i=t.length;for(;0!==i;i--){const n=e[t[i-1]];if("right"!==(null===n||void 0===n?void 0:n.sticky)&&"end"!==(null===n||void 0===n?void 0:n.sticky))break}return{stickyStartItemIdList:t.slice(0,n),sortableItemIdList:t.slice(n,i),stickyEndItemIdList:t.slice(i)}})(a.structure.itemsById,a.structure.visibleFlattenIds),p=c.map(((e,t)=>s(e,t,ge))),I=u.map(((e,t)=>s(e,t+c.length))),v=m.map(((e,t)=>s(e,p.length+I.length+t,ge)));return i.createElement(i.Fragment,null,i.createElement(S,{ref:d,id:l,className:r},p,i.createElement(o.JY,{onDragEnd:e},i.createElement(o.gL,{droppableId:n,renderClone:(e,t,n)=>{const i={provided:e,snapshot:t};return s(a.structure.visibleFlattenIds[n.source.index],n.source.index,i)}},(e=>i.createElement("div",Object.assign({},e.droppableProps,{ref:e.innerRef}),I,e.placeholder)))),v),i.createElement("div",{className:Ie},t()))}})({onDragEnd:({destination:e,source:t})=>{void 0!==(null===e||void 0===e?void 0:e.index)&&(null===e||void 0===e?void 0:e.index)!==t.index&&P((n=>((e,t,n)=>{const i=[...e],[s]=i.splice(t,1);return i.splice(n,0,s),i})(n,t.index,e.index)))},renderControls:()=>g?g({DefaultApplyButton:M,onApply:z}):i.createElement(y.s,{gapRow:1,direction:"column",className:Ie},L&&i.createElement(a.$,{onClick:()=>{P(h)},width:"max"},me("button_reset")),i.createElement(M,null))}),_=(e=>({data:t,props:n,index:s,renderContainerProps:a})=>{const c=!1===e||!0===(null===a||void 0===a?void 0:a.isDragDisabled),u=c?void 0:i.createElement(d.I,{data:l.A,size:16}),m=t.isRequired?i.createElement(d.I,{data:r}):void 0,p=!t.isRequired&&n.selected,I=Object.assign(Object.assign({},n),{selected:p,selectionViewType:t.isRequired?"single":"multiple",content:Object.assign(Object.assign({},n.content),{startSlot:m,endSlot:u})});if(c)return i.createElement(V,Object.assign({},I,{key:I.id}));const v=(e,t)=>i.createElement(V,Object.assign({},I,e.draggableProps,e.dragHandleProps,{ref:e.innerRef,dragging:t.isDragging}));return(null===a||void 0===a?void 0:a.provided)&&a.snapshot?v(a.provided,a.snapshot):i.createElement(o.sx,{draggableId:n.id,index:s,key:`item-key-${n.id}`,isDragDisabled:c},v)})(k),U=e=>{j(e),!1===e&&(P(I),N(b),A.reset())},W=i.useMemo((()=>(e=>{const t=[];return e.forEach((({id:e,isSelected:n})=>{n&&t.push(e)})),t})(F)),[F]),H=(J=C,()=>i.createElement(m.E,{className:be},J));var J;const G=B?i.createElement(se.k,{size:"m",view:"clear",placeholder:E,value:A.filter,className:ve,onUpdate:e=>{A.onFilterUpdate(e),N(!e.length)},hasClear:!0}):null,Y=A.filter&&!A.items.length?H:q;return i.createElement(ie,{className:pe(null,f),mapItemDataToContentProps:fe,multiple:!0,size:"l",open:w,value:W,items:A.filter?A.items:F,onUpdate:e=>{P((t=>t.map((t=>Object.assign(Object.assign({},t),{isSelected:t.isRequired||e.includes(t.id)})))))},popupWidth:n,onOpenChange:U,placement:p,slotBeforeListBody:G,renderContainer:Y,renderControl:({toggleOpen:e})=>{const n=(0,u.h)(e);return(null===t||void 0===t?void 0:t({onClick:e,onKeyDown:n}))||i.createElement(a.$,{onClick:e,extraProps:{onKeyDown:n}},i.createElement(d.I,{data:s.A}),me("button_switcher"))},renderItem:_})},xe=JSON.parse('{"button_switcher":"Columns"}'),Se=JSON.parse('{"button_switcher":"\u041a\u043e\u043b\u043e\u043d\u043a\u0438"}'),Be=(0,oe.N)({en:xe,ru:Se},"TableColumnSetup"),Ee=(0,h.om)("table-column-setup"),Ce=e=>{const{switcher:t,renderSwitcher:n,disabled:l,popupWidth:r,popupPlacement:o,className:c,items:u,sortable:m=!0,showStatus:p,onUpdate:I}=e,v=u.map((({id:e,title:t,required:n,selected:i,sticky:s})=>({id:e,title:t,isRequired:n,isSelected:i,sticky:s})));return i.createElement(he,{items:v,onUpdate:e=>{I(e.map((({id:e,isSelected:t})=>{const n=u.find((t=>t.id===e));return{id:e,selected:t,title:null===n||void 0===n?void 0:n.title,required:null===n||void 0===n?void 0:n.required}})))},popupPlacement:o,popupWidth:r,renderSwitcher:e=>(null===n||void 0===n?void 0:n(e))||t||i.createElement(a.$,{disabled:l,onClick:e.onClick},i.createElement(d.I,{data:s.A}),Be("button_switcher"),(()=>{if(!p)return null;const e=`${u.reduce(((e,t)=>t.selected?e+1:e),0)}/${u.length}`;return i.createElement("span",{className:Ee("status")},e)})()),sortable:m,className:Ee(null,c)})}}}]);