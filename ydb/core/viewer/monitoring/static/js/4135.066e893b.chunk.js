"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[4135],{89516:(e,i,s)=>{s.d(i,{a:()=>a});var t=s(99294),d=s(73287),o=s(10161);const n=(0,t.cn)("ydb-entity-page-title");function a(e){let{entityName:i,status:s,id:t,className:a}=e;return(0,o.jsxs)("div",{className:n(null,a),children:[(0,o.jsx)("span",{className:n("prefix"),children:i}),(0,o.jsx)(d.J,{className:n("icon"),status:s,size:"s"}),t]})}},21711:(e,i,s)=>{s.d(i,{b:()=>c});var t=s(34706),d=s(5194),o=s(99294),n=s(83658),a=s(10161);const l=(0,o.cn)("ydb-info-viewer-skeleton"),r=()=>(0,a.jsxs)("div",{className:l("label"),children:[(0,a.jsx)(d.O,{className:l("label__text")}),(0,a.jsx)("div",{className:l("label__dots")})]}),c=e=>{let{rows:i=8,className:s,delay:o=600}=e;const[c]=(0,n.$)(o);let v=(0,a.jsxs)(t.Fragment,{children:[(0,a.jsx)(r,{}),(0,a.jsx)(d.O,{className:l("value")})]});return c||(v=null),(0,a.jsx)("div",{className:l(null,s),children:[...new Array(i)].map(((e,i)=>(0,a.jsx)("div",{className:l("row"),children:v},`skeleton-row-${i}`)))})}},84573:(e,i,s)=>{s.d(i,{B:()=>c});var t=s(79777),d=s(99294),o=s(74003),n=s(43464),a=s(10161);const l=(0,d.cn)("ydb-page-meta");function r(e){let{items:i,loading:s}=e;return(0,a.jsx)("div",{className:l("info"),children:s?(0,a.jsx)(n.O,{className:l("skeleton")}):i.filter((e=>Boolean(e))).join("\xa0\xa0\xb7\xa0\xa0")})}function c(e){let{className:i,...s}=e;return(0,a.jsxs)(t.k,{gap:1,alignItems:"center",justifyContent:"space-between",className:l(null,i),children:[(0,a.jsx)(r,{...s}),(0,a.jsx)(o.q,{})]})}},43464:(e,i,s)=>{s.d(i,{O:()=>n});var t=s(5194),d=s(83658),o=s(10161);const n=e=>{let{delay:i=600,className:s}=e;const[n]=(0,d.$)(i);return n?(0,o.jsx)(t.O,{className:s}):null}},49038:(e,i,s)=>{s.r(i),s.d(i,{VDiskPage:()=>C});var t=s(34706);const d=e=>t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.28 4.78a.75.75 0 0 0 0-1.06l-2.5-2.5a.75.75 0 1 0-1.06 1.06L6.94 3.5H1.75a.75.75 0 1 0 0 1.5h5.19L5.72 6.22a.75.75 0 1 0 1.06 1.06l2.5-2.5Zm-.06 3.94-2.5 2.5a.75.75 0 0 0 0 1.06l2.5 2.5a.75.75 0 1 0 1.06-1.06L9.06 12.5h5.19a.75.75 0 0 0 0-1.5H9.06l1.22-1.22a.75.75 0 1 0-1.06-1.06ZM14 4.25a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0ZM3.75 13.5a1.75 1.75 0 1 0 0-3.5 1.75 1.75 0 0 0 0 3.5Z",clipRule:"evenodd"}));var o=s(14561),n=s(64485),a=s(42152),l=s(99495),r=s(55982),c=s(89516),v=s(15327),u=s(21711),D=s(84573),k=s(49263),p=s(78759),g=s(65e3),m=s(39202),I=s(85709),x=s(53458),N=s(26612),h=s(96183);const f=p.h.injectEndpoints({endpoints:e=>({getVDiskData:e.query({queryFn:async(e,i)=>{let{nodeId:s,pDiskId:t,vDiskSlotId:d}=e,{signal:o}=i;try{const e=function(e){var i,s,t,d,o,n,a;let[l,r,c]=e;const v=null===(i=l.VDiskStateInfo)||void 0===i?void 0:i[0],u=(0,N.se)(v),D=null===(s=r.PDiskStateInfo)||void 0===s?void 0:s[0],k=(0,N.TD)(D),p=null===(t=c.SystemStateInfo)||void 0===t?void 0:t[0],g=(0,h.Ns)(p),m=null!==(d=null!==(o=u.NodeId)&&void 0!==o?o:k.NodeId)&&void 0!==d?d:g.NodeId,I=g.Host,x=null===(n=g.Roles)||void 0===n?void 0:n[0],f=g.DC,j=null!==(a=u.PDiskId)&&void 0!==a?a:k.PDiskId,y=k.Type;return{...u,NodeId:m,NodeHost:I,NodeType:x,NodeDC:f,PDiskId:j,PDiskType:y}}(await Promise.all([window.api.getVDiskInfo({nodeId:s,pDiskId:t,vDiskSlotId:d},{signal:o}),window.api.getNodeWhiteboardPDiskInfo({nodeId:s,pDiskId:t},{signal:o}),window.api.getNodeInfo(s,{signal:o})]));return{data:e}}catch(n){return{error:n}}},providesTags:(e,i,s)=>["All",{type:"VDiskData",id:(0,x.FR)(s.nodeId,s.pDiskId,s.vDiskSlotId)}]})}),overrideExisting:"throw"});var j=s(25665),y=s(99294),w=s(55842),b=s(58095),S=s(37711);const V=JSON.parse('{"fqdn":"FQDN","node":"Node","pdisk":"PDisk","vdisk":"VDisk","storage":"Storage","evict-vdisk-button":"Evict VDisk","force-evict-vdisk-button":"Evict anyway","evict-vdisk-dialog-header":"Evict VDisk","evict-vdisk-dialog-text":"VDisk will be evicted. Do you want to proceed?","evict-vdisk-not-allowed":"You don\'t have enough rights to evict VDisk"}'),$=(0,S.wZ)("ydb-vDisk-page",{en:V});var P=s(10161);const T=(0,y.cn)("ydb-vdisk-page");function C(){const e=(0,w.zL)(),i=t.useRef(null),s=(0,w.ix)(g.VH),N=(0,m.X_)(),[{nodeId:h,pDiskId:y,vDiskSlotId:S}]=(0,l.useQueryParams)({nodeId:l.StringParam,pDiskId:l.StringParam,vDiskSlotId:l.StringParam});t.useEffect((()=>{e((0,I.J)("vDisk",{nodeId:h,pDiskId:y,vDiskSlotId:S}))}),[e,h,y,S]);const[V]=(0,w.Rj)(),C=(0,j.D)(h)&&(0,j.D)(y)&&(0,j.D)(S)?{nodeId:h,pDiskId:y,vDiskSlotId:S}:n.CN,{currentData:R={},isFetching:_,error:E}=f.useGetVDiskDataQuery(C,{pollingInterval:V}),F=_&&void 0===R,{NodeHost:O,NodeId:B,NodeType:H,NodeDC:q,PDiskId:G,PDiskType:M,Severity:Z,VDiskId:A}=R,{GroupID:J,GroupGeneration:L,Ring:Q,Domain:Y,VDisk:z}=A||{},K=(0,j.D)(J)&&(0,j.D)(L)&&(0,j.D)(Q)&&(0,j.D)(Y)&&(0,j.D)(z),U=async e=>{if(K)return window.api[N?"evictVDisk":"evictVDiskOld"]({groupId:J,groupGeneration:L,failRealmIdx:Q,failDomainIdx:Y,vDiskIdx:z,force:e}).then((e=>{if(!1===(null===e||void 0===e?void 0:e.result)){throw{statusText:e.error,retryPossible:e.forceRetryPossible}}}))},W=()=>{e(p.h.util.invalidateTags([{type:"VDiskData",id:(0,x.FR)(h||0,y||0,S||0)},"StorageData"]))};return(0,P.jsxs)("div",{className:T(null),ref:i,children:[(()=>{const e=S?`${$("vdisk")} ${S}`:$("vdisk"),i=y?`${$("pdisk")} ${y}`:$("pdisk"),s=O||$("node");return(0,P.jsx)(a.ql,{titleTemplate:`%s - ${e} - ${i} \u2014 ${s} \u2014 YDB Monitoring`,defaultTitle:`${e} - ${i} \u2014 ${s} \u2014 YDB Monitoring`})})(),(()=>{const e=O?`${$("fqdn")}: ${O}`:void 0,i=B?`${$("node")}: ${B}`:void 0,s=B?`${$("pdisk")}: ${G}`:void 0;return(0,P.jsx)(D.B,{className:T("meta"),loading:F,items:[e,i,H,q,s,M]})})(),(0,P.jsx)(c.a,{className:T("title"),entityName:$("vdisk"),status:(0,x.b2)(Z),id:null===R||void 0===R?void 0:R.StringifiedId}),(0,P.jsx)("div",{className:T("controls"),children:(0,P.jsxs)(r.U,{onConfirmAction:U,onConfirmActionSuccess:W,buttonDisabled:!K||!s,buttonView:"normal",dialogHeader:$("evict-vdisk-dialog-header"),dialogText:$("evict-vdisk-dialog-text"),retryButtonText:$("force-evict-vdisk-button"),withPopover:!0,popoverContent:$("evict-vdisk-not-allowed"),popoverDisabled:s,children:[(0,P.jsx)(o.J,{data:d}),$("evict-vdisk-button")]})}),F?(0,P.jsx)(u.b,{rows:20}):(0,P.jsxs)(t.Fragment,{children:[E?(0,P.jsx)(v.V,{error:E}):null,(0,P.jsx)(k.K,{data:R,className:T("info")}),(0,j.D)(J)&&(0,j.D)(h)?(0,P.jsxs)(t.Fragment,{children:[(0,P.jsx)("div",{className:T("storage-title"),children:$("storage")}),(0,P.jsx)(b.V,{groupId:J,nodeId:h,pDiskId:null!==y&&void 0!==y?y:void 0,vDiskSlotId:null!==S&&void 0!==S?S:void 0,parentRef:i})]}):null]})]})}}}]);