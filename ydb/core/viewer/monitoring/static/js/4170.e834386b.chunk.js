"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[4170],{30832:(e,t,s)=>{s.d(t,{a:()=>d});var i=s(24362),o=s(98366),n=s(75859);const a=(0,i.cn)("ydb-entity-page-title");function d(e){let{entityName:t,status:s,id:i,className:d}=e;return(0,n.jsxs)("div",{className:a(null,d),children:[(0,n.jsx)("span",{className:a("prefix"),children:t}),(0,n.jsx)(o.J,{className:a("icon"),status:s,size:"s"}),i]})}},91816:(e,t,s)=>{s.d(t,{b:()=>c});var i=s(68963),o=s(56711),n=s(24362),a=s(42587),d=s(75859);const l=(0,n.cn)("ydb-info-viewer-skeleton"),r=()=>(0,d.jsxs)("div",{className:l("label"),children:[(0,d.jsx)(o.O,{className:l("label__text")}),(0,d.jsx)("div",{className:l("label__dots")})]}),c=e=>{let{rows:t=8,className:s,delay:n=600}=e;const[c]=(0,a.$)(n);let v=(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(r,{}),(0,d.jsx)(o.O,{className:l("value")})]});return c||(v=null),(0,d.jsx)("div",{className:l(null,s),children:[...new Array(t)].map(((e,t)=>(0,d.jsx)("div",{className:l("row"),children:v},"skeleton-row-".concat(t))))})}},27174:(e,t,s)=>{s.d(t,{B:()=>u});var i=s(77796),o=s(24362),n=s(50422),a=s(56711),d=s(42587),l=s(75859);const r=e=>{let{delay:t=600,className:s}=e;const[i]=(0,d.$)(t);return i?(0,l.jsx)(a.O,{className:s}):null},c=(0,o.cn)("ydb-page-meta");function v(e){let{items:t,loading:s}=e;return(0,l.jsx)("div",{className:c("info"),children:s?(0,l.jsx)(r,{className:c("skeleton")}):t.filter((e=>Boolean(e))).join("\xa0\xa0\xb7\xa0\xa0")})}function u(e){let{className:t,...s}=e;return(0,l.jsxs)(i.k,{gap:1,alignItems:"center",justifyContent:"space-between",className:c(null,t),children:[(0,l.jsx)(v,{...s}),(0,l.jsx)(n.q,{})]})}},17159:(e,t,s)=>{s.r(t),s.d(t,{VDiskGroup:()=>q,VDiskPage:()=>R});var i=s(68963);const o=e=>i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),i.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.28 4.78a.75.75 0 0 0 0-1.06l-2.5-2.5a.75.75 0 1 0-1.06 1.06L6.94 3.5H1.75a.75.75 0 1 0 0 1.5h5.19L5.72 6.22a.75.75 0 1 0 1.06 1.06l2.5-2.5Zm-.06 3.94-2.5 2.5a.75.75 0 0 0 0 1.06l2.5 2.5a.75.75 0 1 0 1.06-1.06L9.06 12.5h5.19a.75.75 0 0 0 0-1.5H9.06l1.22-1.22a.75.75 0 1 0-1.06-1.06ZM14 4.25a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0ZM3.75 13.5a1.75 1.75 0 1 0 0-3.5 1.75 1.75 0 0 0 0 3.5Z",clipRule:"evenodd"}));var n=s(88776),a=s(17095),d=s(49352),l=s(52846),r=s(65070),c=s(30832),v=s(26688),u=s(91816),D=s(27174),k=s(2098),p=s(22200),g=s(14146),m=s(79061),I=s(11431),f=s(5922),x=s(905),N=s(3764),h=s(51688),w=s(92092);const y=x.h.injectEndpoints({endpoints:e=>({getVDiskData:e.query({queryFn:async e=>{let{nodeId:t,pDiskId:s,vDiskSlotId:i}=e;try{const{vDiskData:e,groupData:o}=await async function(e){let{nodeId:t,pDiskId:s,vDiskSlotId:i}=e,{signal:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await Promise.all([window.api.getVDiskInfo({nodeId:t,pDiskId:s,vDiskSlotId:i},{signal:o}),window.api.getNodeWhiteboardPDiskInfo({nodeId:t,pDiskId:s},{signal:o}),window.api.getNodeInfo(t,{signal:o})]),a=function(e){var t,s,i,o,n,a,d;let[l,r,c]=e;const v=null===(t=l.VDiskStateInfo)||void 0===t?void 0:t[0],u=(0,N.w)(v),D=null===(s=r.PDiskStateInfo)||void 0===s?void 0:s[0],k=(0,N.b)(D),p=null===(i=c.SystemStateInfo)||void 0===i?void 0:i[0],g=(0,h.Ns)(p),m=null!==(o=null!==(n=u.NodeId)&&void 0!==n?n:k.NodeId)&&void 0!==o?o:g.NodeId,I=g.Host,f=null===(a=g.Roles)||void 0===a?void 0:a[0],x=g.DC,w=null!==(d=u.PDiskId)&&void 0!==d?d:k.PDiskId,y=k.Type;return{...u,NodeId:m,NodeHost:I,NodeType:f,NodeDC:x,PDiskId:w,PDiskType:y}}(n),{StoragePoolName:d,VDiskId:l={}}=a,{GroupID:r}=l;let c;if((0,f.D)(d)&&(0,f.D)(r)){c=function(e,t,s){var i,o;const n=null===(i=e.StoragePools)||void 0===i?void 0:i.find((e=>e.Name===t)),a=null===n||void 0===n||null===(o=n.Groups)||void 0===o?void 0:o.find((e=>e.GroupID===s));if(a&&n)return(0,w.mD)(a,n)}(await window.api.getStorageInfo({nodeId:t,poolName:d,groupId:r,version:I.w.v1},{signal:o}),d,r)}return{vDiskData:a,groupData:c}}({nodeId:t,pDiskId:s,vDiskSlotId:i});return{data:{vDiskData:e,groupData:o}}}catch(o){return{error:o}}},providesTags:["All"]})}),overrideExisting:"throw"});var j=s(24362),b=s(52317),S=s(34301),P=s(92666),V=s(17096),T=s(77382),C=s(46393),G=s(30817);const E=JSON.parse('{"fqdn":"FQDN","node":"Node","pdisk":"PDisk","vdisk":"VDisk","group":"Group","evict-vdisk-button":"Evict VDisk","force-evict-vdisk-button":"Evict anyway","evict-vdisk-dialog-header":"Evict VDisk","evict-vdisk-dialog-text":"VDisk will be evicted. Do you want to proceed?","evict-vdisk-not-allowed":"You don\'t have enough rights to evict VDisk"}'),_=(0,G.wZ)("ydb-vDisk-page",{en:E});var B=s(75859);const H=(0,j.cn)("ydb-vdisk-page");function R(){const e=(0,V.zL)(),t=(0,V.ix)(g.VH),[{nodeId:s,pDiskId:k,vDiskSlotId:I}]=(0,l.useQueryParams)({nodeId:l.StringParam,pDiskId:l.StringParam,vDiskSlotId:l.StringParam});i.useEffect((()=>{e((0,m.J)("vDisk",{nodeId:s,pDiskId:k,vDiskSlotId:I}))}),[e,s,k,I]);const[x]=(0,V.Rj)(),N=(0,f.D)(s)&&(0,f.D)(k)&&(0,f.D)(I)?{nodeId:s,pDiskId:k,vDiskSlotId:I}:a.CN,{currentData:h,isFetching:w,refetch:j,error:b}=y.useGetVDiskDataQuery(N,{pollingInterval:x}),T=w&&void 0===h,{vDiskData:C={},groupData:G}=h||{},{NodeHost:E,NodeId:R,NodeType:F,NodeDC:L,PDiskId:M,PDiskType:O,Severity:Z,VDiskId:A}=C,{GroupID:J,GroupGeneration:Q,Ring:Y,Domain:z,VDisk:K}=A||{},W=(0,f.D)(J)&&(0,f.D)(Q)&&(0,f.D)(Y)&&(0,f.D)(z)&&(0,f.D)(K),$=async e=>{if(W)return window.api.evictVDisk({groupId:J,groupGeneration:Q,failRealmIdx:Y,failDomainIdx:z,vDiskIdx:K,force:e}).then((e=>{if(!1===(null===e||void 0===e?void 0:e.result)){throw{statusText:e.error,retryPossible:e.forceRetryPossible}}}))},U=async()=>j();return(0,B.jsxs)("div",{className:H(null),children:[(()=>{const e=I?"".concat(_("vdisk")," ").concat(I):_("vdisk"),t=k?"".concat(_("pdisk")," ").concat(k):_("pdisk"),s=E||_("node");return(0,B.jsx)(d.ql,{titleTemplate:"%s - ".concat(e," - ").concat(t," \u2014 ").concat(s," \u2014 YDB Monitoring"),defaultTitle:"".concat(e," - ").concat(t," \u2014 ").concat(s," \u2014 YDB Monitoring")})})(),(()=>{const e=E?"".concat(_("fqdn"),": ").concat(E):void 0,t=R?"".concat(_("node"),": ").concat(R):void 0,s=R?"".concat(_("pdisk"),": ").concat(M):void 0;return(0,B.jsx)(D.B,{className:H("meta"),loading:T,items:[e,t,F,L,s,O]})})(),(0,B.jsx)(c.a,{className:H("title"),entityName:_("vdisk"),status:(0,P.b2)(Z),id:(0,S.a2)(null===C||void 0===C?void 0:C.VDiskId)}),(0,B.jsx)("div",{className:H("controls"),children:(0,B.jsxs)(r.U,{onConfirmAction:$,onConfirmActionSuccess:U,buttonDisabled:!W||!t,buttonView:"normal",dialogHeader:_("evict-vdisk-dialog-header"),dialogText:_("evict-vdisk-dialog-text"),retryButtonText:_("force-evict-vdisk-button"),withPopover:!0,popoverContent:_("evict-vdisk-not-allowed"),popoverDisabled:t,children:[(0,B.jsx)(n.J,{data:o}),_("evict-vdisk-button")]})}),T?(0,B.jsx)(u.b,{rows:20}):(0,B.jsxs)(i.Fragment,{children:[b?(0,B.jsx)(v.V,{error:b}):null,(0,B.jsx)(p.K,{data:C,className:H("info")}),G?(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{className:H("group-title"),children:_("group")}),(0,B.jsx)(q,{data:G})]}):null]})]})}function q(e){let{data:t}=e;const s=(0,C.M)();return(0,B.jsx)(k.G,{columnsWidthLSKey:T.Ty,data:[t],columns:s,settings:b.LE})}}}]);