"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[43334],{9252:(e,t,a)=>{a.d(t,{k:()=>l});var r=a(44433),n=a(88610),o=a(60712);const l=({value:e,onChange:t,className:a})=>(0,o.jsxs)(r.a,{value:e,onUpdate:t,className:a,children:[(0,o.jsx)(r.a.Option,{value:n.s$.ALL,children:n.s$.ALL}),(0,o.jsx)(r.a.Option,{value:n.s$.PROBLEMS,children:n.s$.PROBLEMS})]})},11363:(e,t,a)=>{a.d(t,{G:()=>oe});var r=a(59284),n=a(86782),o=a(12888),l=a(98167),s=a(67028),i=a(90182),d=a(88610);function u(){const e=(0,i.YQ)();return{problemFilter:(0,i.N4)(d.yV),handleProblemFilterChange:t=>{e((0,d.$u)(t))}}}var c=a(78034),p=a(80987),h=a(48372);const m=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),g=(0,h.g4)("ydb-nodes",{en:m}),b=["database","static","other","any"],v={get database(){return g("database")},get static(){return g("static")},get other(){return g("other")},get any(){return g("any")}};const y="nodesTableSelectedColumns",f=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],x=["NodeId"],C=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function w(e,t){return t?e:e.filter((e=>"SystemState"!==e))}function j(e){var t;const[a,r]=(0,p.useQueryParams)({uptimeFilter:p.StringParam,peerRole:p.StringParam,search:p.StringParam,nodesGroupBy:p.StringParam}),n=c.Bm.parse(a.uptimeFilter),o=null!==(t=a.search)&&void 0!==t?t:"",l=(i=a.peerRole,b.find((e=>e===i)));var i;const d=(0,s.DM)(),u=function(e,t,a){return w(t,a).find((t=>t===e))}(a.nodesGroupBy,null!==e&&void 0!==e?e:[],d);return{uptimeFilter:n,searchValue:o,peerRoleFilter:l,groupByParam:u,handleSearchQueryChange:e=>{r({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{r({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{r({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{r({nodesGroupBy:e},"replaceIn")}}}var N=a(44508),S=a(42265),T=a(15298),F=a(43951),I=a(71708),P=a(62710),R=a(98089),B=a(69775),A=a(24555),_=a(28539),k=a(9252),G=a(95963),E=a(64934),D=a(44433),L=a(60712);function q({value:e="database",onChange:t}){return(0,L.jsx)(D.a,{value:e,onUpdate:t,children:b.map((e=>(0,L.jsx)(D.a.Option,{value:e,children:v[e]},e)))})}const O=(0,a(77506).cn)("ydb-nodes"),U=e=>O("node",{unavailable:(0,c.X7)(e)});function V({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:a,columnsToSelect:o,handleSelectedColumnsUpdate:l,entitiesCountCurrent:i,entitiesCountTotal:d,entitiesLoading:c}){const{searchValue:p,uptimeFilter:h,peerRoleFilter:m,groupByParam:b,handleSearchQueryChange:v,handleUptimeFilterChange:y,handlePeerRoleFilterChange:f,handleGroupByParamChange:x}=j(t),{problemFilter:C,handleProblemFilterChange:N}=u(),S=(0,s.DM)(),T=function(e,t){return w(e,t).map((e=>({value:e,content:(0,n.kn)(e)})))}(t,S),F=(0,s.WF)(),I=a&&F;return(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(G.v,{onChange:v,placeholder:g("controls_search-placeholder"),width:238,value:p}),S&&e?null:(0,L.jsx)(k.k,{value:C,onChange:N}),e?null:(0,L.jsx)(E.j,{value:h,onChange:y}),I?(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(R.E,{variant:"body-2",children:g("controls_peer-role-label")}),(0,L.jsx)(q,{value:m,onChange:f})]}):null,(0,L.jsx)(B.O,{popupWidth:200,items:o,showStatus:!0,onUpdate:l,sortable:!1}),e?(0,L.jsxs)(r.Fragment,{children:[(0,L.jsx)(R.E,{variant:"body-2",children:g("controls_group-by-placeholder")}),(0,L.jsx)(A.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:b?[b]:void 0,onUpdate:e=>{x(e[0])},options:T,className:O("group-by-select"),popupClassName:O("group-by-popup")})]}):null,(0,L.jsx)(_.T,{current:i,total:d,label:g("nodes"),loading:c})]})}var $=a(78524),H=a(62783),M=a(81101),W=a(11906),Q=a(69464),K=a(40781);const X=async e=>{const{type:t="any",storage:a=!1,tablets:r=!0,limit:o,offset:l,sortParams:s,filters:i,columnsIds:d}=e,{sortOrder:u,columnId:p}=null!==s&&void 0!==s?s:{},{path:h,database:m,searchValue:g,problemFilter:b,uptimeFilter:v,peerRoleFilter:y,filterGroup:f,filterGroupBy:x}=null!==i&&void 0!==i?i:{},C=(0,n.kU)(p),w=C?(0,Q.T)(C,u):void 0,j=(0,K.R)(d,n.fN),N=await window.api.viewer.getNodes({type:t,storage:a,tablets:r,limit:o,offset:l,sort:w,path:h,database:m,filter:g,problems_only:(0,c.AB)(b),uptime:(0,c.Fo)(v),filter_peer_role:y,filter_group:f,filter_group_by:x,fieldsRequired:j}),S=(0,W.N)(N);return{data:S.Nodes||[],found:S.FoundNodes||0,total:S.TotalNodes||0}};function J({path:e,database:t,searchValue:a,problemFilter:o,uptimeFilter:l,peerRoleFilter:s,filterGroup:i,filterGroupBy:d,columns:u,scrollContainerRef:p,initialEntitiesCount:h}){const m=r.useMemo((()=>({path:e,database:t,searchValue:a,problemFilter:o,uptimeFilter:l,peerRoleFilter:s,filterGroup:i,filterGroupBy:d})),[e,t,a,o,l,s,i,d]);return(0,L.jsx)(H.k5,{columnsWidthLSKey:n.zO,scrollContainerRef:p,columns:u,fetchData:X,initialEntitiesCount:h,renderErrorMessage:M.$,renderEmptyDataMessage:()=>"All"!==o||l!==c.cW.All?(0,L.jsx)($.v,{name:"thumbsUp",width:"200"}):g("empty.default"),getRowClassName:U,filters:m,tableName:"nodes"})}const z=r.memo((function({name:e,count:t,isExpanded:a,path:r,database:n,searchValue:o,peerRoleFilter:l,groupByParam:s,columns:i,scrollContainerRef:d,onIsExpandedChange:u}){return(0,L.jsx)(I.Q,{title:e,count:t,entityName:g("nodes"),expanded:a,onIsExpandedChange:u,children:(0,L.jsx)(S.o,{initialState:{sortParams:void 0},table:(0,L.jsx)(J,{path:r,database:n,searchValue:o,problemFilter:"All",uptimeFilter:c.cW.All,peerRoleFilter:l,filterGroup:e,filterGroupBy:s,initialEntitiesCount:t,columns:i,scrollContainerRef:d}),tableWrapperProps:{scrollContainerRef:d}})},e)}));function Y({path:e,database:t,scrollContainerRef:a,withPeerRoleFilter:o,columns:l,defaultColumnsIds:s,requiredColumnsIds:d,selectedColumnsKey:u,groupByParams:c}){const{searchValue:p,peerRoleFilter:h,groupByParam:m}=j(c),[b]=(0,i.Nt)(),{columnsToShow:v,columnsToSelect:y,setColumns:f}=(0,F.K)(l,u,n.uG,s,d),{currentData:x,isFetching:C,error:w}=T.s.useGetNodesQuery({path:e,database:t,filter:p,filter_peer_role:h,group:m,limit:0},{pollingInterval:b}),I=void 0===x&&C,{NodeGroups:R,FoundNodes:B=0,TotalNodes:A=0}=x||{},{expandedGroups:_,setIsGroupExpanded:k}=(0,P.$)(R),G=r.useMemo((()=>({foundEntities:B,totalEntities:A,isInitialLoad:I,sortParams:void 0})),[B,A,I]);return(0,L.jsx)(S.o,{initialState:G,controls:(0,L.jsx)(V,{groupByParams:c,withPeerRoleFilter:o,columnsToSelect:y,handleSelectedColumnsUpdate:f,entitiesCountCurrent:B,entitiesCountTotal:A,entitiesLoading:I,withGroupBySelect:!0}),error:w?(0,L.jsx)(N.o,{error:w}):null,table:null!==R&&void 0!==R&&R.length?R.map((({name:r,count:n})=>{const o=_[r];return(0,L.jsx)(z,{name:r,count:n,isExpanded:o,path:e,database:t,searchValue:p,peerRoleFilter:h,groupByParam:m,columns:v,scrollContainerRef:a,onIsExpandedChange:k},r)})):g("no-nodes-groups"),tableWrapperProps:{scrollContainerRef:a,scrollDependencies:[p,m,R,h],loading:I,className:O("groups-wrapper")}})}var Z=a(49554);function ee({withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:a,columnsToSelect:r,handleSelectedColumnsUpdate:n}){const{tableState:o}=(0,Z.WV)();return(0,L.jsx)(V,{withGroupBySelect:e,groupByParams:t,withPeerRoleFilter:a,columnsToSelect:r,handleSelectedColumnsUpdate:n,entitiesCountCurrent:o.foundEntities,entitiesCountTotal:o.totalEntities,entitiesLoading:o.isInitialLoad})}function te({path:e,database:t,scrollContainerRef:a,withPeerRoleFilter:r,columns:o,defaultColumnsIds:l,requiredColumnsIds:i,selectedColumnsKey:d,groupByParams:c}){const{searchValue:p,uptimeFilter:h,peerRoleFilter:m}=j(c),{problemFilter:g}=u(),b=(0,s.Ye)(),{columnsToShow:v,columnsToSelect:y,setColumns:f}=(0,F.K)(o,d,n.uG,l,i);return(0,L.jsx)(S.o,{controls:(0,L.jsx)(ee,{withGroupBySelect:b,groupByParams:c,withPeerRoleFilter:r,columnsToSelect:y,handleSelectedColumnsUpdate:f}),table:(0,L.jsx)(J,{path:e,database:t,searchValue:p,problemFilter:g,uptimeFilter:h,peerRoleFilter:m,columns:v,scrollContainerRef:a}),tableWrapperProps:{scrollContainerRef:a,scrollDependencies:[p,g,h,m]}})}function ae(e){const{uptimeFilter:t,groupByParam:a,handleUptimeFilterChange:n}=j(e.groupByParams),{problemFilter:o,handleProblemFilterChange:i}=u(),d=(0,s.Pm)(),p=(0,s.Ye)();r.useEffect((()=>{!p||"All"===o&&t===c.cW.All||(i("All"),n(c.cW.All))}),[i,n,o,t,p]);return(0,L.jsx)(l.r,{loading:!d,children:p&&a?(0,L.jsx)(Y,{...e}):(0,L.jsx)(te,{...e})})}var re=a(78762);function ne(e){return[(0,re._E)(),(0,re.Nh)(e),(0,re.eT)(),(0,re.uk)(),(0,re.OX)(),(0,re.jl)(),(0,re.fr)(),(0,re.kv)(),(0,re.pH)(),(0,re.iX)(),(0,re.ID)(),(0,re.Rn)(),(0,re.qp)(e)].map((e=>({...e,sortable:(0,n.sp)(e.name)})))}function oe({path:e,database:t,scrollContainerRef:a,additionalNodesProps:l,withPeerRoleFilter:s,columns:i=ne({database:t,getNodeRef:null===l||void 0===l?void 0:l.getNodeRef}),defaultColumnsIds:d=f,requiredColumnsIds:u=x,selectedColumnsKey:c=y,groupByParams:p=C}){const h=(0,o.X)(),m=r.useMemo((()=>h?i:i.filter((e=>!(0,n.xd)(e.name)))),[i,h]);return(0,L.jsx)(ae,{path:e,database:t,scrollContainerRef:a,withPeerRoleFilter:s,columns:m,defaultColumnsIds:d,requiredColumnsIds:u,selectedColumnsKey:c,groupByParams:p})}},11906:(e,t,a)=>{a.d(t,{N:()=>n});var r=a(78034);const n=e=>{var t;const a=(e.Nodes||[]).map((e=>{const{SystemState:t,...a}=e;return{...a,...(0,r.q1)(t)}}));return{Nodes:a,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||a.length,FoundNodes:Number(e.FoundNodes)}}},15298:(e,t,a)=>{a.d(t,{s:()=>o});var r=a(21334),n=a(11906);const o=r.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const a=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,n.N)(a)}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"})},21545:(e,t,a)=>{a.d(t,{X:()=>n});var r=a(78034);const n=a(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:a},{signal:n})=>{try{const[o,l,s]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:a},{signal:n}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:n}),window.api.viewer.getNodesList({signal:n})]),i=(0,r.nN)(s),d=Object.keys(l).reduce(((e,t)=>{var a;const r=null===(a=l[t])||void 0===a?void 0:a.TabletStateInfo;return null===r||void 0===r||r.forEach((a=>{var r;const{ChangeTime:n,Generation:o,State:l,Leader:s,FollowerId:d}=a,u=i&&t?null===(r=i.get(Number(t)))||void 0===r?void 0:r.Host:void 0;e.push({nodeId:t,generation:o,changeTime:n,state:l,leader:s,followerId:d,fqdn:u})})),e}),[]),{TabletStateInfo:u=[]}=o,c=void 0===a?u.find((e=>e.Leader)):u.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===a})),{TabletId:p}=c||{};return{data:{id:p,data:c,history:d}}}catch(o){return{error:o}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const a=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:r,PathId:n}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${r}:${n}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(r){return{error:r}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,a)=>{a.d(t,{B:()=>d});var r=a(59284),n=a(84476),o=a(84375),l=a(55974),s=a(42829),i=a(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:a,dialogHeader:d,dialogText:u,retryButtonText:c,buttonDisabled:p=!1,buttonView:h="action",buttonTitle:m,buttonClassName:g,withPopover:b=!1,popoverContent:v,popoverPlacement:y="right",popoverDisabled:f=!0}){const[x,C]=r.useState(!1),[w,j]=r.useState(!1),[N,S]=r.useState(!1),T=()=>(0,i.jsx)(n.$,{onClick:()=>C(!0),view:h,disabled:p,loading:!p&&w,className:g,title:m,children:e});return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)(l.g,{visible:x,header:d,text:u,withRetry:N,retryButtonText:c,onConfirm:async e=>{j(!0),await t(e)},onConfirmActionSuccess:async()=>{S(!1);try{await(null===a||void 0===a?void 0:a())}finally{j(!1)}},onConfirmActionError:e=>{S((0,s.D)(e)),j(!1)},onClose:()=>{C(!1)}}),b?(0,i.jsx)(o.A,{content:v,placement:y,disabled:f,children:T()}):T()]})}},27775:(e,t,a)=>{a.d(t,{i:()=>l});var r=a(47665),n=a(58267),o=a(60712);function l({state:e}){return(0,o.jsx)(r.J,{theme:(0,n._)(e),children:e})}},28539:(e,t,a)=>{a.d(t,{T:()=>r.T});var r=a(53755)},42829:(e,t,a)=>{a.d(t,{D:()=>r});const r=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55974:(e,t,a)=>{a.d(t,{g:()=>y});var r=a(59284),n=a(18677),o=a(71153),l=a(74321),s=a(2198),i=a(99991),d=a(56999),u=a(77506),c=a(81288),p=a(48372);const h=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),m=(0,p.g4)("ydb-critical-action-dialog",{en:h});var g=a(60712);const b=(0,u.cn)("ydb-critical-dialog"),v=e=>{if((0,c.cH)(e)){if(403===e.status)return m("no-rights-error");if("string"===typeof e.data)return e.data;if((0,c._E)(e)&&e.data)return(0,g.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return m("default-error")};function y({visible:e,header:t,text:a,withRetry:d,retryButtonText:u,withCheckBox:c,onClose:p,onConfirm:h,onConfirmActionSuccess:y,onConfirmActionError:f}){const[x,C]=r.useState(!1),[w,j]=r.useState(),[N,S]=r.useState(!1),T=async e=>(C(!0),h(e).then((()=>{y(),p()})).catch((e=>{f(e),j(e)})).finally((()=>{C(!1)})));return(0,g.jsx)(s.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:p,onTransitionExited:()=>{j(void 0),S(!1)},children:w?(0,g.jsxs)(r.Fragment,{children:[(0,g.jsx)(s.l.Header,{caption:t}),(0,g.jsx)(s.l.Body,{className:b("body"),children:(0,g.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,g.jsx)("span",{className:b("error-icon"),children:(0,g.jsx)(n.A,{width:"24",height:"22"})}),v(w)]})}),(0,g.jsx)(s.l.Footer,{loading:!1,preset:"default",textButtonApply:d?u||m("button-retry"):void 0,textButtonCancel:m("button-close"),onClickButtonApply:()=>T(!0),onClickButtonCancel:p})]}):(0,g.jsxs)(r.Fragment,{children:[(0,g.jsx)(s.l.Header,{caption:t}),(0,g.jsxs)(s.l.Body,{className:b("body"),children:[(0,g.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,g.jsx)("span",{className:b("warning-icon"),children:(0,g.jsx)(i.I,{data:o.A,size:24})}),a]}),c?(0,g.jsx)(l.S,{checked:N,onUpdate:S,children:m("checkbox-text")}):null]}),(0,g.jsx)(s.l.Footer,{loading:x,preset:"default",textButtonApply:m("button-confirm"),textButtonCancel:m("button-cancel"),propsButtonApply:{type:"submit",disabled:c&&!N},onClickButtonCancel:p,onClickButtonApply:()=>T()})]})})}},56999:(e,t,a)=>{a.d(t,{O:()=>C});var r=a(59284),n=a(45720),o=a(16929),l=a(71153),s=a(18677),i=a(84476),d=a(33705),u=a(67884),c=a(99991),p=a(74529),h=a(77506),m=a(41650);const g=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function b(e){return function(e){return!!e&&void 0!==g[e]}(e)?g[e]:"S_INFO"}var v=a(60712);const y=(0,h.cn)("kv-result-issues"),f=(0,h.cn)("kv-issues"),x=(0,h.cn)("kv-issue");function C({data:e,hideSeverity:t}){const[a,n]=r.useState(!1),o="string"===typeof e||null===e||void 0===e?void 0:e.issues,l=Array.isArray(o)&&o.length>0;return(0,v.jsxs)("div",{className:y(),children:[(0,v.jsxs)("div",{className:y("error-message"),children:[(()=>{let a;if("string"===typeof e)a=e;else{var n,o;const l=b(null===e||void 0===e||null===(n=e.error)||void 0===n?void 0:n.severity);a=(0,v.jsxs)(r.Fragment,{children:[t?null:(0,v.jsxs)(r.Fragment,{children:[(0,v.jsx)(I,{severity:l})," "]}),(0,v.jsx)("span",{className:y("error-message-text"),children:null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message})]})}return a})(),l&&(0,v.jsx)(i.$,{view:"normal",onClick:()=>n(!a),children:a?"Hide details":"Show details"})]}),l&&a&&(0,v.jsx)(w,{hideSeverity:t,issues:o})]})}function w({issues:e,hideSeverity:t}){const a=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var a;const r=null!==(a=t.severity)&&void 0!==a?a:10;return Math.min(e,r)}),10);return(0,v.jsx)("div",{className:f(null),children:null===e||void 0===e?void 0:e.map(((e,r)=>(0,v.jsx)(j,{hideSeverity:t,issue:e,expanded:e===a},r)))})}function j({issue:e,hideSeverity:t,level:a=0}){const[n,o]=r.useState(!0),l=b(e.severity),s=e.issues,u=Array.isArray(s)&&s.length>0,c=n?"bottom":"right";return(0,v.jsxs)("div",{className:x({leaf:!u,"has-issues":u}),children:[(0,v.jsxs)("div",{className:x("line"),children:[u&&(0,v.jsx)(i.$,{view:"flat-secondary",onClick:()=>o(!n),className:x("arrow-toggle"),children:(0,v.jsx)(d.I,{direction:c,size:16})}),t?null:(0,v.jsx)(I,{severity:l}),(0,v.jsx)(N,{issue:e}),e.issue_code?(0,v.jsxs)("span",{className:x("code"),children:["Code: ",e.issue_code]}):null]}),u&&n&&(0,v.jsx)("div",{className:x("issues"),children:(0,v.jsx)(S,{issues:s,level:a+1,expanded:n})})]})}function N({issue:e}){var t;const a=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,m.kf)(t.row))return"";const{row:a,column:r}=t;return(0,m.kf)(r)?`${a}:${r}`:`line ${a}`}(e),r=window.ydbEditor,n=()=>(0,v.jsxs)("span",{className:x("message"),children:[a&&(0,v.jsx)("span",{className:x("place-text"),title:"Position",children:a}),(0,v.jsx)("div",{className:x("message-text"),children:(0,v.jsx)(p.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:o,column:l}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,m.kf)(o)&&r))return n();return(0,v.jsx)(u.N,{href:"#",extraProps:{draggable:!1},onClick:()=>{const e={lineNumber:o,column:null!==l&&void 0!==l?l:0};r.setPosition(e),r.revealPositionInCenterIfOutsideViewport(e),r.focus()},view:"primary",children:n()})}function S(e){const{issues:t,level:a,expanded:r}=e;return(0,v.jsx)("div",{className:x("list"),children:t.map(((e,t)=>(0,v.jsx)(j,{issue:e,level:a,expanded:r},t)))})}const T={S_INFO:n.A,S_WARNING:o.A,S_ERROR:l.A,S_FATAL:s.A},F=(0,h.cn)("yql-issue-severity");function I({severity:e}){const t=e.slice(2).toLowerCase();return(0,v.jsxs)("span",{className:F({severity:t}),children:[(0,v.jsx)(c.I,{className:F("icon"),data:T[e]}),(0,v.jsx)("span",{className:F("title"),children:t})]})}},74529:(e,t,a)=>{a.d(t,{A:()=>p});var r=a(59284),n=a(67884),o=a(77506),l=a(48372);const s=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),i=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,l.g4)("ydb-shorty-string",{ru:i,en:s});var u=a(60712);const c=(0,o.cn)("kv-shorty-string");function p({value:e="",limit:t=200,strict:a=!1,displayLength:o=!0,render:l=e=>e,onToggle:s,expandLabel:i=d("default_expand_label"),collapseLabel:p=d("default_collapse_label")}){const[h,m]=r.useState(!1),g=(h?p:i)+(o&&!h?d("chars_count",{count:e.length}):""),b=e.length>t+(a?0:g.length),v=h||!b?e:e.slice(0,t-4)+"\xa0...";return(0,u.jsxs)("div",{className:c(),children:[l(v),b?(0,u.jsx)(n.N,{className:c("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),m((e=>!e)),null===s||void 0===s||s()},children:g}):null]})}},88616:(e,t,a)=>{a.d(t,{Q:()=>P});var r=a(59284),n=a(76938),o=a(98089),l=a(99991),s=a(80987),i=a(22983),d=a(28539),u=a(10508),c=a(44508),p=a(44294),h=a(17594),m=a(41775),g=a(69326),b=a(80420),v=a(27775),y=a(41826),f=a(21545),x=a(6354),C=a(76086),w=a(12888),j=a(29819),N=a(48372);const S=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),T=(0,N.g4)("ydb-tablets",{en:S});var F=a(60712);function I(e){const t=e.State===x.r.Stopped,a=(0,w.X)(),[r]=f.X.useKillTabletMutation(),o=e.TabletId;return o?(0,F.jsx)(i.B,{buttonView:"outlined",buttonTitle:T("dialog.kill-header"),dialogHeader:T("dialog.kill-header"),dialogText:T("dialog.kill-text"),onConfirmAction:()=>r({id:o}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:T(a?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,F.jsx)(l.I,{data:n.A})}):null}function P({database:e,tablets:t,loading:a,error:n,scrollContainerRef:l}){const[{tabletsSearch:i},f]=(0,s.useQueryParams)({tabletsSearch:s.StringParam}),[x,w]=r.useState(),N=r.useMemo((()=>function({database:e}){return[{name:"Type",width:150,get header(){return T("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,F.jsxs)("span",{children:[e.Type," ",t?(0,F.jsx)(o.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return T("Tablet")},render:({row:t})=>t.TabletId?(0,F.jsx)(b.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):C.Pd},{name:"State",get header(){return T("State")},render:({row:e})=>(0,F.jsx)(v.i,{state:e.State})},{name:"NodeId",get header(){return T("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,j.vI)(e.NodeId);return(0,F.jsx)(p.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return T("Node FQDN")},render:({row:e})=>e.fqdn?(0,F.jsx)(u.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,F.jsx)("span",{children:"\u2014"})},{name:"Generation",get header(){return T("Generation")},align:"right"},{name:"Uptime",get header(){return T("Uptime")},render:({row:e})=>(0,F.jsx)(y.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,F.jsx)(I,{...e})}]}({database:e})),[e]),S=r.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==i&&void 0!==i?i:"")))),[t,i]);return(0,F.jsxs)(g.L,{fullHeight:!0,children:[(0,F.jsxs)(g.L.Controls,{children:[(0,F.jsx)(m.v,{placeholder:T("controls.search-placeholder"),onChange:e=>{f({tabletsSearch:e||void 0},"replaceIn")},value:null!==i&&void 0!==i?i:"",width:238}),(0,F.jsx)(d.T,{label:T("controls.entities-count-label"),loading:a,total:t.length,current:S.length})]}),n?(0,F.jsx)(c.o,{error:n}):null,(0,F.jsx)(g.L.Table,{scrollContainerRef:l,scrollDependencies:[i,x],loading:a,children:(0,F.jsx)(h.l,{columns:N,data:S,settings:C.N3,emptyDataMessage:T("noTabletsData"),onSortChange:w})})]})}},95963:(e,t,a)=>{a.d(t,{v:()=>r.v});var r=a(41775)}}]);