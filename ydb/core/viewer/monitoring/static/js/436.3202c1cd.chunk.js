"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[436],{99683:(e,t,r)=>{r.d(t,{l:()=>o});var n=r(68330),s=r(24362),a=r(75859);const l=(0,s.cn)("ydb-cell-with-popover");function o(e){let{children:t,className:r,wrapperClassName:s,...o}=e;return(0,a.jsx)("div",{className:l(null,s),children:(0,a.jsx)(n.J,{className:l("popover",r),...o,children:t})})}},79023:(e,t,r)=>{r.d(t,{u:()=>y});var n,s,a,l,o,i,d,c,u,m,h,p=r(88776),g=r(24362),v=r(68963);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f.apply(this,arguments)}const w=function(e){return v.createElement("svg",f({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 383 396",fill:"none"},e),n||(n=v.createElement("path",{d:"M307.333 168.43c9.4-14.2 14.1-32.6 14.1-55.3 0-34.4-11.7-61.9-35.3-82.2-23.4-20.5-63-30.7-106.7-30.7-13.1 0-24.1.9-34.8 2.7-10.7 1.8-20.1 3.9-28.2 6.3-5.4 1.6-16.1 5.7-23.3 8.6-4.1 1.7-6.9 6-6.9 10.8v39.5c0 8.2 7.8 13.8 14.9 10.5a458.74 458.74 0 001.806-.818c2.367-1.074 4.452-2.02 5.894-2.581 5.7-2.3 12.4-4.2 20.1-5.8 7.7-1.6 16.3-2.4 25.7-2.4 22.2 0 43.1 5 52.3 14.9 9.2 10 13.8 22.499 13.8 37.499 0 13-2.7 24.1-8.2 33.2-5.5 9.1-13.1 18-22.9 26.5-7.9 6.9-15.2 13.5-22 19.8-6.8 6.3-12.6 13.2-17.5 20.7s-8.7 16-11.3 25.3c-1.6 5.6-2.7 20.3-3.3 31-.3 6.6 4.5 12.2 10.7 12.2h51.2c5.4 0 10-4.4 10.6-10.2.6-5.7 2-12.5 5.5-17.8 4-5.9 8.7-11.8 14.7-17.3s13-11 20.9-16.7c8-5.6 16.2-12.1 24.9-19.4 12.8-11.4 23.9-24.1 33.3-38.3zm-167.6 212.7c9 9.5 20.1 14.2 33.4 14.2 6.3 0 12.4-1.3 18.2-4 5.8-2.6 10.9-6 15.2-10.3 4.3-4.3 7.7-9.4 10.2-15.2 2.5-5.8 3.7-12.1 3.7-19 0-6.8-1.2-13.2-3.7-19-2.5-5.8-5.9-10.9-10.2-15.4-4.3-4.5-9.4-7.9-15.2-10.3-5.8-2.4-11.9-3.6-18.2-3.6-13.3 0-24.4 4.6-33.4 13.9s-13.5 20.8-13.5 34.5c0 13.4 4.5 24.8 13.5 34.2z",fill:"#ECF2F9"})),s||(s=v.createElement("path",{d:"M213.933 353.03h-193.5c-10 0-18.2-8.2-18.2-18.2v-125.4c0-10 8.2-18.2 18.2-18.2h193.5c10 0 18.2 8.2 18.2 18.2v125.4c0 10.1-8.2 18.2-18.2 18.2z",stroke:"#00E6C5",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4 10"})),a||(a=v.createElement("path",{d:"M21.034 214.732a5.2 5.2 0 100-10.4 5.2 5.2 0 000 10.4zm16.899 0a5.2 5.2 0 100-10.4 5.2 5.2 0 000 10.4zm16.9 0a5.2 5.2 0 100-10.4 5.2 5.2 0 000 10.4z",fill:"#2EE5C0"})),l||(l=v.createElement("path",{d:"M2.533 228.129h228.9",stroke:"#00E6C5",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4 10"})),o||(o=v.createElement("path",{d:"M301.033 264.83l-216.9 12c-7.3.4-13.3-5.2-13.3-12.5V96.93c0-7.3 6-12.9 13.3-12.5l216.9 12c5.6.3 10.1 5.7 10.1 12v144.4c0 6.3-4.5 11.7-10.1 12z",fill:"#027BF3"})),i||(i=v.createElement("path",{d:"M90.433 107.93c3.4.2 6.1-2.4 6.1-5.8s-2.7-6.3-6.1-6.4c-3.3-.2-6.1 2.4-6.1 5.8s2.7 6.3 6.1 6.4zm19.8.798c3.3.1 6-2.5 6-5.8s-2.7-6.1-6-6.3c-3.3-.1-6 2.5-6 5.8s2.7 6.2 6 6.3zm25.2-4.9c0 3.3-2.6 5.9-5.8 5.7-3.2-.1-5.9-2.9-5.9-6.2 0-3.3 2.6-5.9 5.9-5.7 3.2.1 5.8 2.9 5.8 6.2zm66.001 61.703l19.1-20.9 17.4 19.1-18.9 20.9 18.9 20.5-17.4 19.5-19.1-20.5-19.4 21.5-18.1-19.1 19.6-21.5-19.6-21 18.1-19.5 19.4 21z",fill:"#fff"})),d||(d=v.createElement("path",{d:"M327.433 112.83c0-28.4-21.7-37.1-33.5-37.9-.1 0-33.5 2.3-33.5 45.3 0 25.5 21.2 45.5 46 44.6 7.8-.3 14.9-2.6 21-6.4v-45.6z",fill:"#67B0F8"})),c||(c=v.createElement("path",{d:"M380.534 195.931c-2.9 3.4-7.6 3.7-10.5.8l-38.6-39 11.3-12.2 37.8 39c2.9 3 2.9 8 0 11.4z",fill:"#FF4645"})),u||(u=v.createElement("path",{d:"M342.833 145.629l-11.3 12.2 3.7 3.7c1.9 1.9 4.9 2 6.8.2 1.1-1 2.2-2.1 3.2-3.2.6-.7 1.3-1.4 1.9-2.1 1.6-1.9 1.5-4.8-.3-6.6l-4-4.2z",fill:"#D93654"})),m||(m=v.createElement("path",{d:"M267.633 154.13c-23-21.401-23-57.3 0-78.1 21.9-19.8 55.1-17 74.4 4.3 18.4 20.399 18.4 51.7 0 71.6-19.3 20.8-52.5 22.6-74.4 2.2zm9.4-10.802c15.6 15 39.8 14.2 54.1-.9 13.8-14.6 13.8-37.8 0-52.8-14.3-15.5-38.5-17-54.1-2.5-16.2 15.1-16.2 40.7 0 56.2z",fill:"#00236B"})),h||(h=v.createElement("path",{d:"M41.034 42.73a2 2 0 10-4 0h4zm-4 8.3a2 2 0 004 0h-4zm4 17.2a2 2 0 10-4 0h4zm-4 8.9a2 2 0 004 0h-4zm19.2-15.2a2 2 0 000-4v4zm-8.2-4a2 2 0 100 4v-4zm-17.9 4a2 2 0 000-4v4zm-8.2-4a2 2 0 100 4v-4zm15.1-15.2v8.3h4v-8.3h-4zm0 25.5v8.9h4v-8.9h-4zm19.2-10.3h-8.2v4h8.2v-4zm-26.1 0h-8.2v4h8.2v-4z",fill:"#2EE5C0"})))};var x=r(75859);const b=(0,g.cn)("empty-state"),N={s:150,m:250,l:350},y=e=>{let{image:t,title:r,description:n,actions:s,size:a="m",position:l="center"}=e;return(0,x.jsx)("div",{className:b({size:a}),children:(0,x.jsxs)("div",{className:b("wrapper",{size:a,position:l}),children:[(0,x.jsx)("div",{className:b("image"),children:t||(0,x.jsx)(p.J,{data:w,width:N[a],height:N[a]})}),(0,x.jsx)("div",{className:b("title",{size:a}),children:r}),(0,x.jsx)("div",{className:b("description"),children:n}),(0,x.jsx)("div",{className:b("actions"),children:s})]})})}},49201:(e,t,r)=>{r.d(t,{C:()=>l});var n=r(14979);const s=(0,r(30817).wZ)("ydb-entities-count",{ru:{of:"\u0438\u0437"},en:{of:"of"}});var a=r(75859);const l=e=>{let{total:t,current:r,label:l,loading:o,className:i}=e,d="";return l&&(d+="".concat(l,": ")),o?d+="...":(d+="".concat(r),t&&Number(t)!==Number(r)&&(d+=" ".concat(s("of")," ").concat(t))),(0,a.jsx)(n._,{theme:"info",size:"m",className:i,children:d})}},82073:(e,t,r)=>{r.d(t,{J:()=>o});var n=r(79023),s=r(56350),a=r(68746),l=r(75859);const o=e=>{let{title:t,description:r,...o}=e;return(0,l.jsx)(n.u,{image:(0,l.jsx)(s.Q,{name:"403"}),title:t||(0,a.Z)("403.title"),description:r||(0,a.Z)("403.description"),...o})}},86969:(e,t,r)=>{r.d(t,{J:()=>n.J});var n=r(82073)},8747:(e,t,r)=>{r.d(t,{V:()=>a});var n=r(68746),s=r(75859);const a=e=>{let{error:t,className:r,defaultMessage:a=(0,n.Z)("responseError.defaultMessage")}=e,l="";return t&&"string"===typeof t&&(l=t),t&&"object"===typeof t&&("data"in t&&"string"===typeof t.data?l=t.data:"statusText"in t&&"string"===typeof t.statusText?l=t.statusText:"message"in t&&"string"===typeof t.message&&(l=t.message)),(0,s.jsx)("div",{className:"error ".concat(r),children:l||a})}},26688:(e,t,r)=>{r.d(t,{V:()=>n.V});var n=r(8747)},68746:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(30817);const s=JSON.parse('{"403.title":"Access denied","403.description":"You don\u2019t have the necessary roles to view this page.","responseError.defaultMessage":"Response error"}'),a=JSON.parse('{"403.title":"\u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d","403.description":"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0434\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b.","responseError.defaultMessage":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430"}'),l=(0,n.wZ)("ydb-errors-access-denied",{ru:a,en:s})},16670:(e,t,r)=>{r.d(t,{a:()=>o});var n=r(2982),s=r(24362),a=r(75859);const l=(0,s.cn)("ydb-loader"),o=e=>{let{size:t="m",className:r}=e;return(0,a.jsx)("div",{className:l(null,r),children:(0,a.jsx)(n.a,{size:t})})}},65890:(e,t,r)=>{r.d(t,{k:()=>g});var n=r(39683),s=r(17176),a=r(88776),l=r(10502),o=r(92398),i=r(24362),d=r(51688),c=r(99683),u=r(69214),m=r(27506),h=r(75859);const p=(0,i.cn)("ydb-node-host-wrapper"),g=e=>{let{node:t,getNodeRef:r}=e;if(!t.Host)return(0,h.jsx)("span",{children:"\u2014"});const i=!(0,d.TA)(t),g=i&&r?r(t)+"internal":void 0,v=i?(0,o.a3)(t.NodeId,{tenantName:t.TenantName}):void 0,f=g?(0,h.jsx)(s.z,{size:"s",href:g,className:p("external-button"),target:"_blank",children:(0,h.jsx)(a.J,{data:n.Z})}):null;return(0,h.jsx)(c.l,{disabled:!i,content:(0,h.jsx)(m.bP,{data:t}),placement:["top","bottom"],behavior:l.x.Immediate,children:(0,h.jsx)(u.A,{name:t.Host,status:t.SystemState,path:v,hasClipboardButton:!0,additionalControls:f})})}},2098:(e,t,r)=>{r.d(t,{G:()=>d});var n=r(2639),s=r(19812),a=r(24362),l=r(89712),o=r(75859);const i=(0,a.cn)("ydb-resizeable-data-table");function d(e){let{columnsWidthLSKey:t,columns:r,settings:a,wrapperClassName:d,...c}=e;const[u,m]=(0,l.M)(t),h=(0,n.B)(r,u),p={...a,defaultResizeable:!0};return(0,o.jsx)("div",{className:i(null,d),children:(0,o.jsx)(s.ZP,{theme:"yandex-cloud",columns:h,onResize:m,settings:p,...c})})}},30629:(e,t,r)=>{r.d(t,{o:()=>i});var n=r(68963),s=r(77264),a=r(24362),l=r(75859);const o=(0,a.cn)("ydb-search"),i=e=>{let{onChange:t,value:r="",className:a,debounce:i=200,placeholder:d}=e;const[c,u]=n.useState(r),m=n.useRef();n.useEffect((()=>{u((e=>e!==r?r:e))}),[r]);return(0,l.jsx)(s.o,{hasClear:!0,autoFocus:!0,className:o(null,a),placeholder:d,value:c,onUpdate:e=>{u(e),window.clearTimeout(m.current),m.current=window.setTimeout((()=>{null===t||void 0===t||t(e)}),i)}})}},22692:(e,t,r)=>{r.d(t,{h:()=>o});var n=r(56711),s=r(24362),a=r(75859);const l=(0,s.cn)("table-skeleton"),o=e=>{let{rows:t=2,className:r}=e;return(0,a.jsxs)("div",{className:l(null,r),children:[(0,a.jsxs)("div",{className:l("row"),children:[(0,a.jsx)(n.O,{className:l("col-1")}),(0,a.jsx)(n.O,{className:l("col-2")}),(0,a.jsx)(n.O,{className:l("col-3")}),(0,a.jsx)(n.O,{className:l("col-4")}),(0,a.jsx)(n.O,{className:l("col-5")})]}),[...new Array(t)].map(((e,t)=>(0,a.jsx)("div",{className:l("row"),children:(0,a.jsx)(n.O,{className:l("col-full")})},"skeleton-row-".concat(t))))]})}},47101:(e,t,r)=>{r.d(t,{l:()=>o});var n=r(24362),s=r(22692),a=r(75859);const l=(0,n.cn)("ydb-table-with-controls-layout"),o=e=>{let{children:t,className:r}=e;return(0,a.jsx)("div",{className:l(null,r),children:t})};o.Controls=function(e){let{children:t,className:r}=e;return(0,a.jsx)("div",{className:l("controls-wrapper"),children:(0,a.jsx)("div",{className:l("controls",r),children:t})})},o.Table=function(e){let{children:t,loading:r,className:n}=e;return r?(0,a.jsx)(s.h,{className:l("loader")}):(0,a.jsx)("div",{className:l("table",n),children:t})}},43989:(e,t,r)=>{r.d(t,{X:()=>l});var n=r(79734),s=r(51688),a=r(75859);const l=e=>{let{value:t,onChange:r,className:l}=e;return(0,a.jsxs)(n.E,{value:t,onUpdate:r,className:l,children:[(0,a.jsx)(n.E.Option,{value:s.Uu.All,children:s.qU[s.Uu.All]}),(0,a.jsx)(n.E.Option,{value:s.Uu.SmallUptime,children:s.qU[s.Uu.SmallUptime]})]})}},80816:(e,t,r)=>{r.d(t,{a:()=>o});var n=r(14979),s=r(24362),a=r(75859);const l=(0,s.cn)("ydb-usage-label");function o(e){let{value:t,overloadThreshold:r=90,theme:s,...o}=e;return(0,a.jsxs)(n._,{theme:s,className:l({overload:Number(t)>=r}),...o,children:[t||0,"%"]})}},56294:(e,t,r)=>{r.d(t,{$:()=>D});var n=r(89712),s=r(68963),a=r(5922),l=r(26688),o=r(47101),i=r(56711);const d="left",c=-1,u=40;const m=(0,r(24362).cn)("ydb-virtual-table");var h=r(75859);const p=e=>{let{children:t,className:r,height:n,width:s,align:a=d}=e;return(0,h.jsx)("td",{className:m("row-cell",{align:a},r),style:{height:"".concat(n,"px"),width:"".concat(s,"px"),maxWidth:"".concat(s,"px")},children:t})},g=e=>{let{index:t,columns:r,height:n}=e;return(0,h.jsx)("tr",{className:m("row"),children:r.map((e=>(0,h.jsx)(p,{height:n,width:e.width,align:e.align,className:e.className,children:(0,h.jsx)(i.O,{style:{width:"80%",height:"50%"}})},"".concat(e.name).concat(t))))})},v=e=>{let{row:t,index:r,columns:n,getRowClassName:s,height:a}=e;const l=null===s||void 0===s?void 0:s(t);return(0,h.jsx)("tr",{className:m("row",l),children:n.map((e=>(0,h.jsx)(p,{height:a,width:e.width,align:e.align,className:e.className,children:e.render({row:t,index:r})},"".concat(e.name).concat(r))))})},f=e=>{let{columns:t,children:r}=e;return(0,h.jsx)("tr",{className:m("row",{empty:!0}),children:(0,h.jsx)("td",{colSpan:t.length,className:m("td"),children:r})})},w=(0,s.memo)((function(e){var t;let{id:r,chunkSize:n,rowHeight:l,columns:o,chunkData:i,observer:d,getRowClassName:c}=e;const u=s.useRef(null);s.useEffect((()=>{const e=u.current;return e&&d.observe(e),()=>{e&&d.unobserve(e)}}),[d]);const m=null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.length,p=m?m*l:n*l;return(0,h.jsx)("tbody",{ref:u,id:r.toString(),style:{height:"".concat(p,"px")},children:(()=>{var e;return i&&i.active?i.loading||i.error?(0,a.c)(n).map((e=>(0,h.jsx)(g,{columns:o,height:l,index:e},e))):null===(e=i.data)||void 0===e?void 0:e.map(((e,t)=>(0,h.jsx)(v,{index:t,row:e,columns:o,height:l,getRowClassName:c},t))):null})()})}));function x(e){let{minWidth:t,maxWidth:r,getCurrentColumnWidth:n,onResize:a}=e;const l=s.useRef(null),[o,i]=s.useState(!1);return s.useEffect((()=>{const e=l.current;if(!e)return;let s,o,d;const c=function(e){let t,r=null;return function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];t=s,"number"!==typeof r&&(r=requestAnimationFrame((()=>{e(...t),r=null})))}}((e=>{if(b(e),"number"!==typeof s||"number"!==typeof o)return;const n=e.clientX-s,l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Math.max(t,Math.min(e,r))}(o+n,t,r);l!==d&&(d=l,null===a||void 0===a||a(d))})),u=e=>{b(e),void 0!==d&&(null===a||void 0===a||a(d)),i(!1),s=void 0,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u)},m=e=>{o=n(),b(e),s=e.clientX,i(!0),document.addEventListener("mousemove",c),document.addEventListener("mouseup",u)};return e.addEventListener("mousedown",m),()=>{e.removeEventListener("mousedown",m),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u)}}),[a,t,r,n]),(0,h.jsx)("span",{ref:l,className:m("resize-handler",{resizing:o}),onClick:e=>b(e)})}function b(e){e.preventDefault(),e.stopPropagation()}const N=e=>{let{order:t}=e;return(0,h.jsx)("svg",{className:m("sort-icon",{desc:-1===t}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,h.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})})},y=e=>{let{sortOrder:t,sortable:r,defaultSortOrder:n}=e;return r?(0,h.jsx)("span",{className:m("sort-icon-container",{shadow:!t}),children:(0,h.jsx)(N,{order:t||n})}):null},j=e=>{var t;let{column:r,resizeable:n,sortOrder:a,defaultSortOrder:l,onSort:o,rowHeight:i,onCellMount:d,onCellUnMount:c,onColumnsResize:u}=e;const p=s.useRef(null);s.useEffect((()=>{const e=p.current;return e&&(null===d||void 0===d||d(e)),()=>{e&&(null===c||void 0===c||c(e))}}),[d,c]);const g=s.useCallback((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.getBoundingClientRect().width}),[]),v=s.useCallback((e=>{null===u||void 0===u||u(r.name,e)}),[u,r.name]),f=null!==(t=r.header)&&void 0!==t?t:r.name;return(0,h.jsx)("th",{children:(0,h.jsxs)("div",{ref:p,className:m("head-cell-wrapper"),style:{height:"".concat(i,"px"),width:"".concat(r.width,"px")},children:[(0,h.jsxs)("div",{className:m("head-cell",{align:r.align,sortable:r.sortable},r.className),onClick:()=>{r.sortable&&(null===o||void 0===o||o(r.name))},children:[(0,h.jsx)("div",{className:m("head-cell-content"),children:f}),(0,h.jsx)(y,{sortOrder:a,sortable:r.sortable,defaultSortOrder:l})]}),n?(0,h.jsx)(x,{maxWidth:r.resizeMaxWidth,minWidth:r.resizeMinWidth,getCurrentColumnWidth:g,onResize:v}):null]})})},E=e=>{let{columns:t,onSort:r,onColumnsResize:n,defaultSortOrder:a=c,rowHeight:l=u}=e;const[o,i]=s.useState({}),d=e=>{let t={};if(e===o.columnId){if(o.sortOrder&&o.sortOrder!==a)return i(t),void(null===r||void 0===r||r(t));t={sortOrder:1===o.sortOrder?-1:1,columnId:e}}else t={sortOrder:a,columnId:e};null===r||void 0===r||r(t),i(t)};return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("colgroup",{children:t.map((e=>(0,h.jsx)("col",{style:{width:"".concat(e.width,"px")}},e.name)))}),(0,h.jsx)("thead",{className:m("head"),children:(0,h.jsx)("tr",{children:t.map((e=>{var t;const r=o.columnId===e.name?o.sortOrder:void 0,s=n&&(null===(t=e.resizeable)||void 0===t||t);return(0,h.jsx)(j,{column:e,resizeable:s,sortOrder:r,defaultSortOrder:a,onSort:d,rowHeight:l,onColumnsResize:n},e.name)}))})})]})};var S=r(30817);const C=JSON.parse('{"empty":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"}'),O=(0,S.wZ)("ydb-virtual-table",{ru:C,en:{empty:"No data"}}),k="infiniteTable/INIT_CHUNK",T="infiniteTable/REMOVE_CHUNK",I="infiniteTable/SET_CHUNK_LOADING",z="infiniteTable/SET_CHUNK_DATA",U="infiniteTable/SET_CHUNK_ERROR",G="infiniteTable/RESET_CHUNKS",R=e=>({type:k,data:{id:e}}),_=e=>{let{limit:t,fetchData:r,columns:n,getRowClassName:i,rowHeight:d=u,parentContainer:c,initialSortParams:p,onColumnsResize:g,renderControls:v,renderEmptyDataMessage:x,renderErrorMessage:b,dependencyArray:N}=e;const y=s.useRef(!1),j=s.useRef(null),[S,C]=s.useReducer(((e,t)=>{switch(t.type){case z:{const{id:r,data:n}=t.data;return{...e,[r]:{loading:!1,wasLoaded:!0,active:!0,data:n}}}case U:{const{id:r,error:n}=t.data;return{...e,[r]:{loading:!1,wasLoaded:!0,active:!0,error:n}}}case k:{const{id:r}=t.data;return{...e,[r]:{loading:!1,wasLoaded:!1,active:!0}}}case I:{const{id:r}=t.data;return{...e,[r]:{loading:!0,wasLoaded:!1,active:!0}}}case T:{const{id:r}=t.data,n={...e};return delete n[r],n}case G:return{};default:return e}}),{}),[_,D]=s.useState(p),[P,A]=s.useState(t),[F,M]=s.useState(0),[L,Z]=s.useState(),V=s.useRef({}),K=s.useCallback((async e=>{C((e=>({type:I,data:{id:e}}))(e));const n=setTimeout((async()=>{const n=Number(e)*t;try{const s=await r(t,n,_),{data:a,total:l,found:o}=s;A(l),M(o),y.current=!0,C(((e,t)=>({type:z,data:{id:e,data:t}}))(e,a))}catch(s){if(null!==s&&void 0!==s&&s.isCancelled)return;C(((e,t)=>({type:U,data:{id:e,error:t}}))(e,s)),Z(s)}}),200);if(V.current[e]){const t=V.current[e];window.clearTimeout(t)}V.current[e]=n}),[r,t,_]),W=s.useCallback((e=>{C(R(e))}),[]),H=s.useCallback((e=>{if(C((e=>({type:T,data:{id:e}}))(e)),V.current[e]){const t=V.current[e];window.clearTimeout(t),delete V.current[e]}}),[]);s.useEffect((()=>()=>{Object.values(V.current).forEach((e=>{window.clearTimeout(e)})),V.current={}}),[]),s.useEffect((()=>{for(const e of Object.keys(S)){const t=S[Number(e)];null===t||void 0===t||!t.active||null!==t&&void 0!==t&&t.loading||null!==t&&void 0!==t&&t.wasLoaded||K(e)}}),[K,S]),s.useEffect((()=>{var e;(A(t),M(0),Z(void 0),C({type:G}),y.current=!1,c)?c.scrollTo(0,0):null===(e=j.current)||void 0===e||e.scrollTo(0,0);C(R("0"))}),[N,t,c]);const J=e=>{D(e),(()=>{for(const t of Object.keys(S)){var e;null!==(e=S[Number(t)])&&void 0!==e&&e.active&&C(R(t))}})()},Y=(e=>{let{onEntry:t,onLeave:r,parentContainer:n}=e;const a=s.useRef();return s.useEffect((()=>(a.current=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?t(e.target.id):r(e.target.id)}))}),{root:n,rootMargin:"100%"}),()=>{var e;null===(e=a.current)||void 0===e||e.disconnect(),a.current=void 0})),[n,t,r]),a.current})({onEntry:W,onLeave:H,parentContainer:c}),B=F||t,Q=Math.ceil(B/t),q=()=>y.current&&0===F?(0,h.jsx)("tbody",{children:(0,h.jsx)(f,{columns:n,children:x?x():O("empty")})}):!y.current&&L?(0,h.jsx)("tbody",{children:(0,h.jsx)(f,{columns:n,children:b?b(L):(0,h.jsx)(l.V,{error:L})})}):Y?(0,a.c)(Q).map((e=>{const r=S[e];return(0,h.jsx)(w,{observer:Y,id:e,chunkSize:t,rowHeight:d,columns:n,chunkData:r,getRowClassName:i},e)})):null,X=()=>(0,h.jsxs)("table",{className:m("table"),children:[(0,h.jsx)(E,{columns:n,onSort:J,onColumnsResize:g}),q()]});return(0,h.jsx)("div",{ref:j,className:m(null),children:v?(0,h.jsxs)(o.l,{children:[(0,h.jsx)(o.l.Controls,{children:v({inited:y.current,totalEntities:P,foundEntities:F})}),(0,h.jsx)(o.l.Table,{children:X()})]}):X()})};function D(e){let{columnsWidthLSKey:t,columns:r,...s}=e;const[a,l]=(0,n.M)(t),o=function(e,t){return e.map((e=>{var r;return{...e,width:null!==(r=t[e.name])&&void 0!==r?r:e.width}}))}(r,a);return(0,h.jsx)(_,{columns:o,onColumnsResize:l,...s})}},92076:(e,t,r)=>{r.d(t,{HI:()=>B,Ty:()=>E,k8:()=>Q,mk:()=>Y});var n=r(68963),s=r(71549),a=r(19812),l=r(10502),o=r(14979),i=r(68330),d=r(88776),c=r(99683),u=r(69214),m=r(80816),h=r(79255),p=r(95829),g=r(75850),v=r(24362),f=r(4119),w=r(15106),x=r(47651),b=r(10703),N=r(43817),y=(r(5384),r(75859));const j=(0,v.cn)("global-storage-groups"),E="storageGroupsColumnsWidth",S="MediaType",C="Erasure",O="GroupId",k="Used",T="Limit",I="Usage",z="UsedSpaceFlag",U="Read",G="Write",R="VDisks",_="Degraded",D={name:"PoolName",header:"Pool Name",width:250,render:e=>{var t;let{row:r}=e;const n=null===(t=r.PoolName)||void 0===t?void 0:t.split("/");return n&&(0,y.jsx)(c.l,{wrapperClassName:j("pool-name-wrapper"),content:r.PoolName,placement:["right"],behavior:l.x.Immediate,children:n[n.length-1]})},align:a.ZP.LEFT},P={name:S,header:"Type",width:100,resizeMinWidth:100,align:a.ZP.LEFT,render:e=>{let{row:t}=e;return(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(o._,{children:t.MediaType||"\u2014"}),"\xa0",t.Encryption&&(0,y.jsx)(i.J,{content:(0,N.Z)("encrypted"),placement:"right",behavior:l.x.Immediate,children:(0,y.jsx)(o._,{children:(0,y.jsx)(d.J,{data:s.Z,size:18})})})]})},sortable:!1},A={name:C,header:"Erasure",width:100,render:e=>{let{row:t}=e;return t.ErasureSpecies?t.ErasureSpecies:"-"},align:a.ZP.LEFT,sortable:!1},F={name:_,header:"Degraded",width:110,resizeMinWidth:110,render:e=>{let{row:t}=e;return t.Degraded?(0,y.jsxs)(o._,{theme:(0,b._O)(t),children:["Degraded: ",t.Degraded]}):"-"},align:a.ZP.LEFT,defaultOrder:a.ZP.DESCENDING},M={name:I,header:"Usage",width:75,resizeMinWidth:75,render:e=>{let{row:t}=e;return t.Limit?(0,y.jsx)(m.a,{value:t.Usage,theme:(0,b.YC)(t.Usage)}):"-"},sortAccessor:e=>e.Limit?e.Usage:null,align:a.ZP.LEFT,sortable:!1},L={name:O,header:"Group ID",width:130,render:e=>{let{row:t}=e;return(0,y.jsx)("span",{className:j("group-id"),children:t.GroupID})},sortAccessor:e=>Number(e.GroupID),align:a.ZP.RIGHT,sortable:!1},Z={name:k,header:"Used",width:100,render:e=>{let{row:t}=e;return(0,x.Uz)(t.Used,!0)},align:a.ZP.RIGHT,sortable:!1},V={name:T,header:"Limit",width:100,render:e=>{let{row:t}=e;return(0,x.Uz)(t.Limit)},align:a.ZP.RIGHT,sortable:!1},K={name:z,header:"Space",width:110,render:e=>{let{row:t}=e;const r=t.UsedSpaceFlag;let n=g.K.Red;return r<100?n=g.K.Green:r<1e4?n=g.K.Yellow:r<1e6&&(n=g.K.Orange),(0,y.jsx)(u.A,{status:n})},align:a.ZP.CENTER},W={name:U,header:"Read",width:100,render:e=>{let{row:t}=e;return t.Read?(0,x.Qt)(t.Read):"-"},align:a.ZP.RIGHT},H={name:G,header:"Write",width:100,render:e=>{let{row:t}=e;return t.Write?(0,x.Qt)(t.Write):"-"},align:a.ZP.RIGHT},J=e=>({name:R,className:j("vdisks-column"),header:"VDisks",render:t=>{var r;let{row:n}=t;return(0,y.jsx)("div",{className:j("vdisks-wrapper"),children:null===(r=n.VDisks)||void 0===r?void 0:r.map((t=>(0,y.jsx)(h.c,{data:t,nodes:e,className:j("vdisks-item")},(0,f.a2)(t.VDiskId))))})},align:a.ZP.CENTER,width:900,resizeable:!1}),Y=()=>[L,P,A,M,Z,V],B=e=>[D,P,A,F,L,M,Z,J(e)],Q=(e,t)=>{const r=((e,t)=>t===p.G.space?e.filter((e=>e.name!==_)):t===p.G.missing?e.filter((e=>e.name!==z)):e.filter((e=>e.name!==_&&e.name!==z)))([D,P,A,F,M,L,Z,V,K,W,H,J(e)],t);return r.map((e=>({...e,sortable:(0,w.P7)(e.name)})))}},43817:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(30817);const s=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),a=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),l=(0,n.wZ)("ydb-storage-groups",{ru:a,en:s})},7283:(e,t,r)=>{r.d(t,{V:()=>Je});var n=r(52317),s=r(28459),a=r(68963),l=r(52846),o=r(86969),i=r(26688),d=r(47101),c=r(99337),u=r(95829),m=r(15106),h=r(14223);const p=e=>e.trim().toLowerCase(),g=(e,t)=>{const r=p(t);return r?e.filter((e=>{var t,n;return(null===(t=e.NodeId)||void 0===t?void 0:t.toString().includes(r))||(null===(n=e.Host)||void 0===n?void 0:n.toLowerCase().includes(r))})):e},v=(e,t)=>{const r=p(t);return r?e.filter((e=>{var t,n;return(null===(t=e.PoolName)||void 0===t?void 0:t.toLowerCase().includes(r))||(null===(n=e.GroupID)||void 0===n?void 0:n.toString().includes(r))})):e},f=(e,t)=>Array.isArray(t)&&0!==t.length?e.filter((e=>{const r=e.Usage;return t.some((e=>Number(e)<=r&&r<Number(e)+5))})):e;var w=r(11431),x=r(905),b=r(92092);const N=x.h.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,t)=>{let{signal:r}=t;try{const t=await window.api.getNodes({storage:!0,type:"static",...e},{signal:r});return{data:(0,b.Y2)(t)}}catch(n){return{error:n}}},providesTags:["All"]}),getStorageGroupsInfo:e.query({queryFn:async(e,t)=>{let{signal:r}=t;try{const t=await window.api.getStorageInfo({version:w.w.v1,...e},{signal:r});return{data:(0,b.KJ)(t)}}catch(n){return{error:n}}},providesTags:["All"]})}),overrideExisting:"throw"});var y=r(95408);const j=y.z.nativeEnum(u.G).catch(u.G.all),E=y.z.nativeEnum(u.d).catch(u.d.groups);var S=r(51688),C=r(49201),O=r(30629),k=r(43989),T=r(79734),I=r(75859);const z={[u.d.groups]:"Groups",[u.d.nodes]:"Nodes"},U=e=>{let{value:t,onChange:r}=e;return(0,I.jsxs)(T.E,{value:t,onUpdate:r,qa:"storage-type-filter",children:[(0,I.jsx)(T.E.Option,{value:u.d.groups,children:z[u.d.groups]}),(0,I.jsx)(T.E.Option,{value:u.d.nodes,children:z[u.d.nodes]})]})},G={[u.G.all]:"All",[u.G.missing]:"Degraded",[u.G.space]:"Out of Space"},R=e=>{let{value:t,onChange:r}=e;return(0,I.jsxs)(T.E,{value:t,onUpdate:r,qa:"storage-visible-entities-filter",children:[(0,I.jsx)(T.E.Option,{value:u.G.missing,children:G[u.G.missing]}),(0,I.jsx)(T.E.Option,{value:u.G.space,children:G[u.G.space]}),(0,I.jsx)(T.E.Option,{value:u.G.all,children:G[u.G.all]})]})};var _=r(2418),D=r(69214),P=r(24362),A=r(10703),F=r(30817);const M=JSON.parse('{"label":"Usage:","default_value":"Any","groups_count":["{{count}} group","{{count}} groups","{{count}} groups","No groups"]}'),L=JSON.parse('{"label":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435:","default_value":"\u041b\u044e\u0431\u043e\u0435","groups_count":["{{count}} \u0433\u0440\u0443\u043f\u043f\u0430","{{count}} \u0433\u0440\u0443\u043f\u043f\u044b","{{count}} \u0433\u0440\u0443\u043f\u043f","\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f"]}'),Z=(0,F.wZ)("ydb-usage-filter",{ru:L,en:M}),V=(0,P.cn)("usage-filter"),K=e=>{const{className:t,value:r=[],groups:n=[],onChange:s,debounce:l=200}=e,[o,i]=a.useState(r),d=a.useRef();a.useEffect((()=>{i((e=>e.join(",")!==r.join(",")?r:e))}),[r]);const c=a.useMemo((()=>n.map((e=>{let{threshold:t,count:r}=e;return{value:String(t),text:"".concat(t,"%"),data:{count:r}}}))),[n]),u=Math.max(...n.map((e=>{let{count:t}=e;return t})));return(0,I.jsx)(_.P,{className:V(null,t),label:Z("label"),value:o,placeholder:Z("default_value"),options:c,multiple:!0,onUpdate:e=>{i(e),window.clearTimeout(d.current),d.current=window.setTimeout((()=>{null===s||void 0===s||s(e)}),l)},renderOption:e=>{let{value:t,data:r,text:n}=e;return(0,I.jsxs)("div",{className:V("option"),children:[(0,I.jsx)(D.A,{className:V("option-title"),status:(0,A.CZ)(Number(t)),name:n,size:"xs"}),(0,I.jsxs)("div",{className:V("option-meta"),children:[Z("groups_count",{count:r.count}),(0,I.jsx)("div",{className:V("option-bar"),style:{width:"".concat(r.count/u*100,"%")}})]})]})},getOptionHeight:()=>50,popupWidth:280,disabled:0===n.length})},W=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN"}'),H=JSON.parse('{"groups":"\u0413\u0440\u0443\u043f\u043f\u044b","nodes":"\u041d\u043e\u0434\u044b","controls_groups-search-placeholder":"ID \u0433\u0440\u0443\u043f\u043f\u044b, \u0438\u043c\u044f \u043f\u0443\u043b\u0430","controls_nodes-search-placeholder":"ID \u0443\u0437\u043b\u0430, FQDN"}'),J=(0,F.wZ)("ydb-storage",{ru:H,en:W}),Y=(0,P.cn)("global-storage"),B=e=>{let{searchValue:t,handleSearchValueChange:r,withTypeSelector:n,storageType:s,handleStorageTypeChange:l,visibleEntities:o,handleVisibleEntitiesChange:i,nodesUptimeFilter:d,handleNodesUptimeFilterChange:c,withGroupsUsageFilter:m,groupsUsageFilter:h,groupsUsageFilterOptions:p,handleGroupsUsageFilterChange:g,entitiesCountCurrent:v,entitiesCountTotal:f,entitiesLoading:w}=e;const x=s===u.d.nodes,b=J(x?"nodes":"groups");return(0,I.jsxs)(a.Fragment,{children:[(0,I.jsx)(O.o,{value:t,onChange:r,placeholder:J(x?"controls_nodes-search-placeholder":"controls_groups-search-placeholder"),className:Y("search")}),n&&(0,I.jsx)(U,{value:s,onChange:l}),(0,I.jsx)(R,{value:o,onChange:i}),x&&(0,I.jsx)(k.X,{value:d,onChange:c}),!x&&m&&(0,I.jsx)(K,{value:h,onChange:g,groups:p}),(0,I.jsx)(C.C,{label:b,loading:w,total:f,current:v})]})};var Q=r(2098),q=r(17176),X=r(79023),$=r(56350);const ee=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),te=JSON.parse('{"default_message":"\u0412\u0441\u0451 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435!","default_button_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"}'),re=(0,F.wZ)("ydb-storage-empty-filter",{ru:te,en:ee}),ne=e=>{let{title:t,message:r=re("default_message"),showAll:n=re("default_button_label"),onShowAll:s}=e;return(0,I.jsx)(X.u,{image:(0,I.jsx)($.Q,{name:"thumbsUp"}),position:"left",title:t,description:r,actions:s&&[(0,I.jsx)(q.z,{onClick:s,children:n},"show-all")]})};var se=r(43817);const ae=e=>{let t,{visibleEntities:r,onShowAll:n}=e;return r===u.G.space&&(t=(0,se.Z)("empty.out_of_space")),r===u.G.missing&&(t=(0,se.Z)("empty.degraded")),t?(0,I.jsx)(ne,{title:t,showAll:(0,se.Z)("show_all"),onShowAll:n}):null};var le=r(92076);r(5384);function oe(e){let{data:t,tableSettings:r,visibleEntities:n,nodes:s,onShowAll:l,sort:o,handleSort:i}=e;const d=a.useMemo((()=>(0,le.k8)(s,n)),[s,n]);return t.length||n===u.G.all?(0,I.jsx)(Q.G,{columnsWidthLSKey:le.Ty,data:t,columns:d,settings:r,emptyDataMessage:(0,se.Z)("empty.default"),sortOrder:o,onSort:i},n):(0,I.jsx)(ae,{onShowAll:l,visibleEntities:n})}const ie=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),de=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432","empty.out_of_space":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0443\u0437\u043b\u043e\u0432","empty.small_uptime":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432 \u0441 uptime < 1h","empty.several_filters":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0443\u0437\u043b\u044b"}'),ce=(0,F.wZ)("ydb-storage-nodes",{ru:de,en:ie}),ue=e=>{let t,{visibleEntities:r,nodesUptimeFilter:n,onShowAll:s}=e;return r===u.G.space&&(t=ce("empty.out_of_space")),r===u.G.missing&&(t=ce("empty.degraded")),n===S.Uu.SmallUptime&&(t=ce("empty.small_uptime")),r!==u.G.all&&n!==S.Uu.All&&(t=ce("empty.several_filters")),t?(0,I.jsx)(ne,{title:t,showAll:ce("show_all"),onShowAll:s}):null};var me=r(19812),he=r(65890),pe=r(1796),ge=r(74170),ve=r(40073),fe=r(79255),we=r(54665),xe=r(4119),be=r(92398);const Ne=(0,P.cn)("pdisk-storage"),ye=e=>{let{nodeId:t,data:r={},vDisks:n}=e;const[s,l]=a.useState(!1),o=a.useRef(null);return(0,I.jsxs)(a.Fragment,{children:[(0,I.jsx)(ve.J,{data:r,anchorRef:o,open:s}),(0,I.jsxs)("div",{className:Ne(),ref:o,children:[null!==n&&void 0!==n&&n.length?(0,I.jsx)("div",{className:Ne("vdisks"),children:n.map((e=>(0,I.jsx)("div",{className:Ne("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,I.jsx)(fe.c,{data:e,compact:!0,stackClassName:Ne("donors-stack")})},(0,xe.a2)(e.VDiskId))))}):null,(0,I.jsxs)(ge.h,{to:(0,we.ax)(we.ZP.node,{id:t,activeTab:be.pV},{pdiskId:r.PDiskId||""}),className:Ne("content"),onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},children:[(0,I.jsx)(pe.p,{diskAllocatedPercent:r.AllocatedPercent,severity:r.Severity}),(0,I.jsx)("div",{className:Ne("media-type"),children:r.Type})]})]})]})},je=(0,P.cn)("global-storage-nodes"),Ee=e=>je("node",{unavailable:(0,S.TA)(e)}),Se="storageNodesColumnsWidth",Ce="NodeId",Oe="Host",ke="DC",Te="Rack",Ie="Uptime",ze="PDisks",Ue="Missing",Ge=(e,t)=>{const r=(e=>{const t=null===e||void 0===e?void 0:e.getNodeRef;return[{name:Ce,header:"Node ID",width:100,align:me.ZP.RIGHT,render:e=>{let{row:t}=e;return t.NodeId}},{name:Oe,header:"Host",width:350,render:e=>{let{row:r}=e;return(0,I.jsx)(he.k,{node:r,getNodeRef:t})},align:me.ZP.LEFT},{name:ke,header:"DC",width:100,render:e=>{let{row:t}=e;return t.DC||n.jX},align:me.ZP.LEFT},{name:Te,header:"Rack",width:100,render:e=>{let{row:t}=e;return t.Rack||"\u2014"},align:me.ZP.LEFT},{name:Ie,header:"Uptime",width:130,sortAccessor:e=>{let{StartTime:t}=e;return t?-t:0},align:me.ZP.RIGHT,render:e=>{let{row:t}=e;return t.Uptime}},{name:Ue,header:"Missing",width:100,align:me.ZP.CENTER,defaultOrder:me.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.Missing}},{name:ze,className:je("pdisks-column"),header:"PDisks",render:e=>{var t;let{row:r}=e;return(0,I.jsx)("div",{className:je("pdisks-wrapper"),children:null===(t=r.PDisks)||void 0===t?void 0:t.map((e=>{var t;const n=null===(t=r.VDisks)||void 0===t?void 0:t.filter((t=>t.PDiskId===e.PDiskId));return(0,I.jsx)("div",{className:je("pdisks-item"),children:(0,I.jsx)(ye,{data:e,nodeId:r.NodeId,vDisks:n})},e.PDiskId)}))})},align:me.ZP.CENTER,sortable:!1,width:900,resizeable:!1}]})(e),s=r.map((e=>({...e,sortable:(0,S.oh)(e.name)})));return t!==u.G.missing?s.filter((e=>e.name!==Ue)):s};function Re(e){let{data:t,tableSettings:r,visibleEntities:n,onShowAll:s,nodesUptimeFilter:a,additionalNodesProps:l,sort:o,handleSort:i}=e;const d=Ge(l,n);return t.length||n===u.G.all&&a===S.Uu.All?(0,I.jsx)(Q.G,{columnsWidthLSKey:Se,data:t,columns:d,settings:{...r,dynamicRenderType:"variable"},emptyDataMessage:ce("empty.default"),rowClassName:Ee,sortOrder:o,onSort:i},n):(0,I.jsx)(ue,{visibleEntities:n,nodesUptimeFilter:a,onShowAll:s})}const _e=(0,l.withDefault)({encode:l.ArrayParam.encode,decode:e=>null===e||void 0===e?e:Array.isArray(e)?e.filter(Boolean):e?[e]:[]},[]),De=e=>{var t;let{additionalNodesProps:r,tenant:p,nodeId:w}=e;const[x]=(0,s.Rj)(),[b,y]=(0,l.useQueryParams)({type:l.StringParam,visible:l.StringParam,search:l.StringParam,uptimeFilter:l.StringParam,usageFilter:_e}),C=E.parse(b.type),O=j.parse(b.visible),k=null!==(t=b.search)&&void 0!==t?t:"",T=S.U8.parse(b.uptimeFilter),z=b.usageFilter,U=(0,s.ix)(c.d),[G,R]=a.useState({sortOrder:void 0,sortValue:void 0}),_=G.sortValue?G:A.TP,[D,P]=a.useState({sortOrder:void 0,sortValue:void 0}),F=D.sortOrder?D:(0,A._r)(O),M=void 0!==w,L=M?u.d.groups:C,Z=(0,s.Aq)({filter:k,nodesUptimeFilter:T,..._}),V=(0,s.Ot)({filter:k,...F}),K=N.useGetStorageNodesInfoQuery({tenant:p,visibleEntities:O,...Z},{skip:L!==u.d.nodes,pollingInterval:x}),W=N.useGetStorageGroupsInfoQuery({tenant:p,visibleEntities:O,nodeId:w,...V},{skip:L!==u.d.groups,pollingInterval:x}),{currentData:H,isFetching:J,error:Q}=L===u.d.nodes?K:W,{currentData:{nodes:q=[]}={}}=K,{currentData:{groups:X=[]}={}}=W,{nodes:$,groups:ee,...te}=null!==H&&void 0!==H?H:{found:0,total:0},re=void 0===H&&J,ne=a.useMemo((()=>function(e,t,r){let n=e||[];return n=g(n,t),n=(0,h.f)(n,r),n}(q,k,T)),[k,q,T]),se=a.useMemo((()=>function(e,t,r){let n=e||[];return n=v(n,t),n=f(n,r),n}(X,k,z)),[k,X,z]),ae=a.useMemo((()=>function(e){const t={};return null===e||void 0===e||e.forEach((e=>{const r=(0,m.Ic)(e,5);Object.prototype.hasOwnProperty.call(t,r)||(t[r]=0),t[r]+=1})),Object.entries(t).map((e=>{let[t,r]=e;return{threshold:Number(t),count:r}})).sort(((e,t)=>t.threshold-e.threshold))}(X)),[X]),[le,ie]=(0,s.sC)(_,(e=>R(e))),[de,ce]=(0,s.sC)(F,(e=>P(e))),ue=e=>{y({usageFilter:e.length?e:void 0},"replaceIn")},me=e=>{y({search:e||void 0},"replaceIn")},he=e=>{y({visible:e},"replaceIn")},pe=e=>{y({type:e},"replaceIn")},ge=e=>{y({uptimeFilter:e},"replaceIn")},ve=()=>{he(u.G.all),ge(S.Uu.All)};return Q?403===Q.status?(0,I.jsx)(o.J,{position:"left"}):(0,I.jsx)(i.V,{error:Q}):(0,I.jsxs)(d.l,{children:[(0,I.jsx)(d.l.Controls,{children:(0,I.jsx)(B,{searchValue:k,handleSearchValueChange:me,withTypeSelector:!M,storageType:L,handleStorageTypeChange:pe,visibleEntities:O,handleVisibleEntitiesChange:he,nodesUptimeFilter:T,handleNodesUptimeFilterChange:ge,groupsUsageFilter:z,groupsUsageFilterOptions:ae,handleGroupsUsageFilterChange:ue,entitiesCountCurrent:L===u.d.groups?se.length:ne.length,entitiesCountTotal:te.total,entitiesLoading:re})}),(0,I.jsx)(d.l.Table,{loading:re,className:Y("table"),children:(0,I.jsxs)(a.Fragment,{children:[L===u.d.groups&&(0,I.jsx)(oe,{visibleEntities:O,data:se,tableSettings:n.LE,nodes:U,onShowAll:()=>he(u.G.all),sort:de,handleSort:ce},"groups"),L===u.d.nodes&&(0,I.jsx)(Re,{visibleEntities:O,nodesUptimeFilter:T,data:ne,tableSettings:n.LE,onShowAll:ve,additionalNodesProps:r,sort:le,handleSort:ie},"nodes")]})})]})};var Pe=r(82073),Ae=r(8747),Fe=r(56294);const Me=(e,t)=>"getStorageGroups|offset".concat(t,"|limit").concat(e),Le=async e=>{let{limit:t,offset:r,...n}=e;const s=await window.api.getStorageInfo({version:w.w.v2,limit:t,offset:r,...n},{concurrentId:Me(t,r)}),a=(0,b.KJ)(s);return{data:a.groups||[],found:a.found||0,total:a.total||0}},Ze=e=>{let{searchValue:t,visibleEntities:r,tenant:n,nodeId:s,nodesMap:l,onShowAll:o,parentContainer:i,renderControls:d,renderErrorMessage:c}=e;const m=a.useMemo((()=>[t,r,n,s]),[t,r,n,s]),h=a.useCallback((async function(e,a){let{sortOrder:l,columnId:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return await Le({limit:e,offset:a,filter:t,visibleEntities:r,tenant:n,nodeId:s,sortOrder:l,sortValue:o})}),[s,t,n,r]),p=a.useMemo((()=>(0,le.k8)(l,r)),[l,r]);return(0,I.jsx)(Fe.$,{columnsWidthLSKey:le.Ty,parentContainer:i,columns:p,fetchData:h,limit:50,renderControls:d,renderErrorMessage:c,renderEmptyDataMessage:()=>r!==u.G.all?(0,I.jsx)(ae,{onShowAll:o,visibleEntities:r}):(0,se.Z)("empty.default"),dependencyArray:m})},Ve=(e,t)=>"getStorageNodes|offset".concat(t,"|limit").concat(e),Ke=async e=>{let{type:t="static",storage:r=!0,limit:n,offset:s,...a}=e;const l=await window.api.getNodes({type:t,storage:r,limit:n,offset:s,...a},{concurrentId:Ve(n,s)}),o=(0,b.Y2)(l);return{data:o.nodes||[],found:o.found||0,total:o.total||0}},We=e=>{let{searchValue:t,visibleEntities:r,nodesUptimeFilter:n,tenant:s,additionalNodesProps:l,onShowAll:o,parentContainer:i,renderControls:d,renderErrorMessage:c}=e;const m=a.useMemo((()=>[t,r,n,s]),[t,r,n,s]),h=a.useCallback((async function(e,a){let{sortOrder:l,columnId:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return await Ke({limit:e,offset:a,filter:t,uptime:(0,S.RW)(n),visibleEntities:r,tenant:s,sortOrder:l,sortValue:o})}),[n,t,s,r]),p=a.useMemo((()=>Ge(l,r)),[l,r]);return(0,I.jsx)(Fe.$,{columnsWidthLSKey:Se,parentContainer:i,columns:p,fetchData:h,rowHeight:50,limit:50,renderControls:d,renderErrorMessage:c,renderEmptyDataMessage:()=>r!==u.G.all||n!==S.Uu.All?(0,I.jsx)(ue,{onShowAll:o,nodesUptimeFilter:n,visibleEntities:r}):ce("empty.default"),getRowClassName:Ee,dependencyArray:m})},He=e=>{var t;let{tenant:r,nodeId:n,parentContainer:a,additionalNodesProps:o}=e;const[i,d]=(0,l.useQueryParams)({type:l.StringParam,visible:l.StringParam,search:l.StringParam,uptimeFilter:l.StringParam}),m=E.parse(i.type),h=j.parse(i.visible),p=null!==(t=i.search)&&void 0!==t?t:"",g=S.U8.parse(i.uptimeFilter),v=e=>{d({search:e||void 0},"replaceIn")},f=e=>{d({visible:e},"replaceIn")},w=e=>{d({type:e},"replaceIn")},x=e=>{d({uptimeFilter:e},"replaceIn")},b=(0,s.ix)(c.d),N=()=>{d({visible:u.G.all,uptimeFilter:S.Uu.All},"replaceIn")},y=e=>{let{totalEntities:t,foundEntities:r,inited:s}=e;return(0,I.jsx)(B,{searchValue:p,handleSearchValueChange:v,withTypeSelector:!n,storageType:m,handleStorageTypeChange:w,visibleEntities:h,handleVisibleEntitiesChange:f,nodesUptimeFilter:g,handleNodesUptimeFilterChange:x,withGroupsUsageFilter:!1,entitiesCountCurrent:r,entitiesCountTotal:t,entitiesLoading:!s})},C=e=>403===e.status?(0,I.jsx)(Pe.J,{position:"left"}):(0,I.jsx)(Ae.V,{error:e});return m===u.d.nodes?(0,I.jsx)(We,{searchValue:p,visibleEntities:h,nodesUptimeFilter:g,tenant:r,additionalNodesProps:o,onShowAll:N,parentContainer:a,renderControls:y,renderErrorMessage:C}):(0,I.jsx)(Ze,{searchValue:p,visibleEntities:h,tenant:r,nodeId:n,nodesMap:b,onShowAll:()=>{f(u.G.all)},parentContainer:a,renderControls:y,renderErrorMessage:C})},Je=e=>{let{parentContainer:t,...r}=e;const[a]=(0,s.yu)(n.ET);return a?(0,I.jsx)(He,{parentContainer:t,...r}):(0,I.jsx)(De,{...r})}},10703:(e,t,r)=>{r.d(t,{CZ:()=>h,TP:()=>p,YC:()=>m,_O:()=>u,_r:()=>w});var n=r(81413),s=r(95829),a=r(75850),l=r(99106),o=r(51688),i=r(15106);const d=(0,l.p)(1,2,["success","warning","danger"]),c={"block-4-2":(0,l.p)(1,2,["success","warning","danger"]),"mirror-3-dc":(0,l.p)(1,3,["success","warning","danger"])},u=e=>{var t;return(void 0!==(t=e.ErasureSpecies)&&t in c?c[e.ErasureSpecies]:d)(e.Degraded)},m=(0,l.p)(80,85,["success","warning","danger"]),h=(0,l.p)(80,85,[a.K.Green,a.K.Yellow,a.K.Red]),p={sortValue:o.Hk.NodeId,sortOrder:n.zE},g={sortValue:i.t5.PoolName,sortOrder:n.zE},v={sortValue:i.t5.Degraded,sortOrder:n.hr},f={sortValue:i.t5.Usage,sortOrder:n.hr};function w(e){return e===s.G.missing?v:e===s.G.space?f:g}},14223:(e,t,r)=>{r.d(t,{A:()=>m,f:()=>c});var n=r(75850),s=r(52317),a=r(4119),l=r(27070),o=r(51688),i=r(80839);const d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(arguments.length>1?arguments[1]:void 0)===i.pu.ALL?e:e.filter((e=>{let{SystemState:t}=e;return t&&t!==n.K.Green}))},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(arguments.length>1?arguments[1]:void 0)===o.Uu.All?e:e.filter((e=>{let{StartTime:t}=e;return!t||(0,a.OW)(t)<s.RQ}))},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t)return e;const r=(0,l.Y)(t);return e.filter((e=>!e.Host||(r.test(e.Host)||r.test(String(e.NodeId)))))};function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{uptimeFilter:t,searchValue:r,problemFilter:n}=arguments.length>1?arguments[1]:void 0,s=c(e,t);return s=d(s,n),s=u(s,r),s}},95829:(e,t,r)=>{r.d(t,{G:()=>n,d:()=>s});const n={all:"all",missing:"missing",space:"space"},s={groups:"groups",nodes:"nodes"}},89712:(e,t,r)=>{r.d(t,{M:()=>l});var n=r(68963),s=r(2639),a=r(18193);const l=e=>{const t=n.useCallback((()=>e?a.r.readUserSettingsValue(e,{}):{}),[e]),r=n.useCallback((t=>{e&&a.r.setUserSettingsValue(e,t)}),[e]);return(0,s.M)({saveSizes:r,getSizes:t})}},83496:(e,t,r)=>{r.d(t,{FW:()=>i,KR:()=>d,LV:()=>o,uk:()=>l});var n=r(75850),s=r(28164);const a={[s.g.Dead]:n.K.Red,[s.g.Created]:n.K.Yellow,[s.g.ResolveStateStorage]:n.K.Yellow,[s.g.Candidate]:n.K.Yellow,[s.g.BlockBlobStorage]:n.K.Yellow,[s.g.WriteZeroEntry]:n.K.Yellow,[s.g.Restored]:n.K.Yellow,[s.g.Discover]:n.K.Yellow,[s.g.Lock]:n.K.Yellow,[s.g.Stopped]:n.K.Yellow,[s.g.ResolveLeader]:n.K.Yellow,[s.g.RebuildGraph]:n.K.Yellow,[s.g.Deleted]:n.K.Green,[s.g.Active]:n.K.Green},l=Object.keys(s.g),o=Object.entries(a).reduce(((e,t)=>{let[r,n]=t;return e[n]?e[n].push(r):e[n]=[r],e}),{}),i=e=>{if(!e)return n.K.Grey;return t=e,Object.values(n.K).includes(t)?e:a[e];var t};function d(e){if(!e)return"unknown";switch(e){case s.g.Dead:return"danger";case s.g.Active:case s.g.Deleted:return"success";default:return"warning"}}},5384:()=>{}}]);