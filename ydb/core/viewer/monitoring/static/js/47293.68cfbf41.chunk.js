"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[47293],{2102:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(77506),n=r(60712);const o=(0,a.cn)("ydb-diagnostic-card");function l({children:e,className:t,active:r,size:a="m",interactive:l=!0}){return(0,n.jsx)("div",{className:o({active:r,size:a,interactive:l},t),children:e})}},7117:(e,t,r)=>{r.d(t,{G:()=>ee});var a=r(59284),n=r(44508),o=r(98167),l=r(89073),s=r(86782),i=r(67028),d=r(15298),u=r(90182),c=r(88610);function p(){const e=(0,u.YQ)();return{problemFilter:(0,u.N4)(c.yV),handleProblemFilterChange:t=>{e((0,c.$u)(t))}}}var h=r(12888),m=r(43951),g=r(78034),b=r(71708),v=r(62710),y=r(98089),f=r(69775),x=r(24555),w=r(28539),j=r(9252),N=r(95963),C=r(64934),T=r(44433),S=r(48372);const F=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}'),I=(0,S.g4)("ydb-nodes",{en:F}),P=["database","static","other","any"],R={get database(){return I("database")},get static(){return I("static")},get other(){return I("other")},get any(){return I("any")}};var A=r(60712);function B({value:e="database",onChange:t}){return(0,A.jsx)(T.a,{value:e,onUpdate:t,children:P.map((e=>(0,A.jsx)(T.a.Option,{value:e,children:R[e]},e)))})}const _="nodesTableSelectedColumns",k=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],G=["NodeId"],L=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function E(e,t){return t?e:e.filter((e=>"SystemState"!==e))}var D=r(59109);const q=(0,r(77506).cn)("ydb-nodes"),O=e=>q("node",{unavailable:(0,g.X7)(e)}),U=e=>e&&403===e.status?(0,A.jsx)(D.O,{position:"left"}):(0,A.jsx)(n.o,{error:e});var V=r(67087);function $(e){var t;const[r,a]=(0,V.useQueryParams)({uptimeFilter:V.StringParam,peerRole:V.StringParam,search:V.StringParam,nodesGroupBy:V.StringParam}),n=g.Bm.parse(r.uptimeFilter),o=null!==(t=r.search)&&void 0!==t?t:"",l=(s=r.peerRole,P.find((e=>e===s)));var s;const d=(0,i.DM)(),u=function(e,t,r){return E(t,r).find((t=>t===e))}(r.nodesGroupBy,null!==e&&void 0!==e?e:[],d);return{uptimeFilter:n,searchValue:o,peerRoleFilter:l,groupByParam:u,handleSearchQueryChange:e=>{a({search:e||void 0},"replaceIn")},handleUptimeFilterChange:e=>{a({uptimeFilter:e},"replaceIn")},handlePeerRoleFilterChange:e=>{a({peerRole:e},"replaceIn")},handleGroupByParamChange:e=>{a({nodesGroupBy:e},"replaceIn")}}}function H({withGroupBySelect:e,groupByParams:t=[],withPeerRoleFilter:r,columnsToSelect:n,handleSelectedColumnsUpdate:o,entitiesCountCurrent:l,entitiesCountTotal:d,entitiesLoading:u}){const{searchValue:c,uptimeFilter:h,peerRoleFilter:m,groupByParam:g,handleSearchQueryChange:b,handleUptimeFilterChange:v,handlePeerRoleFilterChange:T,handleGroupByParamChange:S}=$(t),{problemFilter:F,handleProblemFilterChange:P}=p(),R=(0,i.DM)(),_=function(e,t){return E(e,t).map((e=>({value:e,content:(0,s.kn)(e)})))}(t,R),k=(0,i.WF)(),G=r&&k;return(0,A.jsxs)(a.Fragment,{children:[(0,A.jsx)(N.v,{onChange:b,placeholder:I("controls_search-placeholder"),width:238,value:c}),R&&e?null:(0,A.jsx)(j.k,{value:F,onChange:P}),e?null:(0,A.jsx)(C.j,{value:h,onChange:v}),G?(0,A.jsxs)(a.Fragment,{children:[(0,A.jsx)(y.E,{variant:"body-2",children:I("controls_peer-role-label")}),(0,A.jsx)(B,{value:m,onChange:T})]}):null,(0,A.jsx)(f.O,{popupWidth:200,items:n,showStatus:!0,onUpdate:o,sortable:!1}),e?(0,A.jsxs)(a.Fragment,{children:[(0,A.jsx)(y.E,{variant:"body-2",children:I("controls_group-by-placeholder")}),(0,A.jsx)(x.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:g?[g]:void 0,onUpdate:e=>{S(e[0])},options:_,className:q("group-by-select"),popupClassName:q("group-by-popup")})]}):null,(0,A.jsx)(w.T,{current:l,total:d,label:I("nodes"),loading:u})]})}var M=r(78524),Q=r(40427),K=r(11906),W=r(69464),z=r(40781);const X=async e=>{const{type:t="any",storage:r=!1,tablets:a=!0,limit:n,offset:o,sortParams:l,filters:i,columnsIds:d}=e,{sortOrder:u,columnId:c}=null!==l&&void 0!==l?l:{},{path:p,database:h,searchValue:m,problemFilter:b,uptimeFilter:v,peerRoleFilter:y,filterGroup:f,filterGroupBy:x}=null!==i&&void 0!==i?i:{},w=(0,s.kU)(c),j=w?(0,W.T)(w,u):void 0,N=(0,z.R)(d,s.fN),C=await window.api.viewer.getNodes({type:t,storage:r,tablets:a,limit:n,offset:o,sort:j,path:p,database:h,filter:m,problems_only:(0,g.AB)(b),uptime:(0,g.Fo)(v),filter_peer_role:y,filter_group:f,filter_group_by:x,fieldsRequired:N}),T=(0,K.N)(C);return{data:T.Nodes||[],found:T.FoundNodes||0,total:T.TotalNodes||0}};function J({path:e,database:t,searchValue:r,problemFilter:n,uptimeFilter:o,peerRoleFilter:l,filterGroup:i,filterGroupBy:d,columns:u,parentRef:c,renderControls:p,initialEntitiesCount:h}){const m=a.useMemo((()=>({path:e,database:t,searchValue:r,problemFilter:n,uptimeFilter:o,peerRoleFilter:l,filterGroup:i,filterGroupBy:d})),[e,t,r,n,o,l,i,d]);return(0,A.jsx)(Q.k5,{columnsWidthLSKey:s.zO,parentRef:c,columns:u,fetchData:X,limit:50,initialEntitiesCount:h,renderControls:p,renderErrorMessage:U,renderEmptyDataMessage:()=>"All"!==n||o!==g.cW.All?(0,A.jsx)(M.v,{name:"thumbsUp",width:"200"}):I("empty.default"),getRowClassName:O,filters:m,tableName:"nodes"})}var Y=r(78762);function Z(e){return[(0,Y._E)(),(0,Y.Nh)(e),(0,Y.eT)(),(0,Y.uk)(),(0,Y.OX)(),(0,Y.jl)(),(0,Y.fr)(),(0,Y.kv)(),(0,Y.pH)(),(0,Y.iX)(),(0,Y.ID)(),(0,Y.Rn)(),(0,Y.qp)(e)].map((e=>({...e,sortable:(0,s.sp)(e.name)})))}function ee({path:e,database:t,parentRef:r,additionalNodesProps:n,withPeerRoleFilter:l,columns:d=Z({database:t,getNodeRef:null===n||void 0===n?void 0:n.getNodeRef}),defaultColumnsIds:u=k,requiredColumnsIds:c=G,selectedColumnsKey:m=_,groupByParams:b=L}){const{uptimeFilter:v,groupByParam:y,handleUptimeFilterChange:f}=$(b),{problemFilter:x,handleProblemFilterChange:w}=p(),j=(0,i.Pm)(),N=(0,i.Ye)(),C=(0,h.X)(),T=a.useMemo((()=>C?d:d.filter((e=>!(0,s.xd)(e.name)))),[d,C]);a.useEffect((()=>{!N||"All"===x&&v===g.cW.All||(w("All"),f(g.cW.All))}),[w,f,x,v,N]);return(0,A.jsx)(o.r,{loading:!j,children:N&&y?(0,A.jsx)(re,{path:e,database:t,parentRef:r,withPeerRoleFilter:l,columns:T,defaultColumnsIds:u,requiredColumnsIds:c,selectedColumnsKey:m,groupByParams:b}):(0,A.jsx)(te,{path:e,database:t,parentRef:r,withPeerRoleFilter:l,columns:T,defaultColumnsIds:u,requiredColumnsIds:c,selectedColumnsKey:m,groupByParams:b})})}function te({path:e,database:t,parentRef:r,withPeerRoleFilter:a,columns:n,defaultColumnsIds:o,requiredColumnsIds:l,selectedColumnsKey:d,groupByParams:u}){const{searchValue:c,uptimeFilter:h,peerRoleFilter:g}=$(u),{problemFilter:b}=p(),v=(0,i.Ye)(),{columnsToShow:y,columnsToSelect:f,setColumns:x}=(0,m.K)(n,d,s.uG,o,l);return(0,A.jsx)(J,{path:e,database:t,searchValue:c,problemFilter:b,uptimeFilter:h,peerRoleFilter:g,columns:y,parentRef:r,renderControls:({totalEntities:e,foundEntities:t,inited:r})=>(0,A.jsx)(H,{withGroupBySelect:v,groupByParams:u,withPeerRoleFilter:a,columnsToSelect:f,handleSelectedColumnsUpdate:x,entitiesCountCurrent:t,entitiesCountTotal:e,entitiesLoading:!r})})}function re({path:e,database:t,parentRef:r,withPeerRoleFilter:a,columns:o,defaultColumnsIds:i,requiredColumnsIds:c,selectedColumnsKey:p,groupByParams:h}){const{searchValue:y,peerRoleFilter:f,groupByParam:x}=$(h),[w]=(0,u.Nt)(),{columnsToShow:j,columnsToSelect:N,setColumns:C}=(0,m.K)(o,p,s.uG,i,c),{currentData:T,isFetching:S,error:F}=d.s.useGetNodesQuery({path:e,database:t,filter:y,filter_peer_role:f,group:x,limit:0},{pollingInterval:w}),P=void 0===T&&S,{NodeGroups:R,FoundNodes:B=0,TotalNodes:_=0}=T||{},{expandedGroups:k,setIsGroupExpanded:G}=(0,v.$)(R);return(0,A.jsxs)(l.L,{children:[(0,A.jsx)(l.L.Controls,{children:(0,A.jsx)(H,{withGroupBySelect:!0,groupByParams:h,withPeerRoleFilter:a,columnsToSelect:N,handleSelectedColumnsUpdate:C,entitiesCountCurrent:B,entitiesCountTotal:_,entitiesLoading:P})}),F?(0,A.jsx)(n.o,{error:F}):null,(0,A.jsx)(l.L.Table,{loading:P,className:q("groups-wrapper"),children:null!==R&&void 0!==R&&R.length?R.map((({name:a,count:n})=>{const o=k[a];return(0,A.jsx)(b.Q,{title:a,count:n,entityName:I("nodes"),expanded:o,onIsExpandedChange:G,children:(0,A.jsx)(J,{path:e,database:t,searchValue:y,problemFilter:"All",uptimeFilter:g.cW.All,peerRoleFilter:f,filterGroup:a,filterGroupBy:x,initialEntitiesCount:n,columns:j,parentRef:r})},a)})):I("no-nodes-groups")})]})}},9252:(e,t,r)=>{r.d(t,{k:()=>l});var a=r(44433),n=r(88610),o=r(60712);const l=({value:e,onChange:t,className:r})=>(0,o.jsxs)(a.a,{value:e,onUpdate:t,className:r,children:[(0,o.jsx)(a.a.Option,{value:n.s$.ALL,children:n.s$.ALL}),(0,o.jsx)(a.a.Option,{value:n.s$.PROBLEMS,children:n.s$.PROBLEMS})]})},11906:(e,t,r)=>{r.d(t,{N:()=>n});var a=r(78034);const n=e=>{var t;const r=(e.Nodes||[]).map((e=>{const{SystemState:t,...r}=e;return{...r,...(0,a.q1)(t)}}));return{Nodes:r,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),TotalNodes:Number(e.TotalNodes)||r.length,FoundNodes:Number(e.FoundNodes)}}},15298:(e,t,r)=>{r.d(t,{s:()=>o});var a=r(21334),n=r(11906);const o=a.F.injectEndpoints({endpoints:e=>({getNodes:e.query({queryFn:async(e,{signal:t})=>{try{const r=await window.api.viewer.getNodes({type:"any",storage:!1,tablets:!0,...e},{signal:t});return{data:(0,n.N)(r)}}catch(r){return{error:r}}},providesTags:["All"]})}),overrideExisting:"throw"})},21545:(e,t,r)=>{r.d(t,{X:()=>n});var a=r(78034);const n=r(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:r},{signal:n})=>{try{const[o,l,s]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:r},{signal:n}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:n}),window.api.viewer.getNodesList({signal:n})]),i=(0,a.nN)(s),d=Object.keys(l).reduce(((e,t)=>{var r;const a=null===(r=l[t])||void 0===r?void 0:r.TabletStateInfo;return null===a||void 0===a||a.forEach((r=>{var a;const{ChangeTime:n,Generation:o,State:l,Leader:s,FollowerId:d}=r,u=i&&t?null===(a=i.get(Number(t)))||void 0===a?void 0:a.Host:void 0;e.push({nodeId:t,generation:o,changeTime:n,state:l,leader:s,followerId:d,fqdn:u})})),e}),[]),{TabletStateInfo:u=[]}=o,c=void 0===r?u.find((e=>e.Leader)):u.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===r})),{TabletId:p}=c||{};return{data:{id:p,data:c,history:d}}}catch(o){return{error:o}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const r=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:a,PathId:n}=e;return{data:(null===r||void 0===r?void 0:r.Path)||`${a}:${n}`}}catch(r){return{error:r}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:r})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:r})}}catch(a){return{error:a}}},providesTags:(e,t,r)=>["All",{type:"Tablet",id:r.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(r){return{error:r}}},invalidatesTags:(e,t,r)=>[{type:"Tablet",id:r.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,r)=>{r.d(t,{B:()=>d});var a=r(59284),n=r(84476),o=r(84375),l=r(55974),s=r(42829),i=r(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:r,dialogHeader:d,dialogText:u,retryButtonText:c,buttonDisabled:p=!1,buttonView:h="action",buttonTitle:m,buttonClassName:g,withPopover:b=!1,popoverContent:v,popoverPlacement:y="right",popoverDisabled:f=!0}){const[x,w]=a.useState(!1),[j,N]=a.useState(!1),[C,T]=a.useState(!1),S=()=>(0,i.jsx)(n.$,{onClick:()=>w(!0),view:h,disabled:p,loading:!p&&j,className:g,title:m,children:e});return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsx)(l.g,{visible:x,header:d,text:u,withRetry:C,retryButtonText:c,onConfirm:async e=>{N(!0),await t(e)},onConfirmActionSuccess:async()=>{T(!1);try{await(null===r||void 0===r?void 0:r())}finally{N(!1)}},onConfirmActionError:e=>{T((0,s.D)(e)),N(!1)},onClose:()=>{w(!1)}}),b?(0,i.jsx)(o.A,{content:v,placement:y,disabled:f,children:S()}):S()]})}},27775:(e,t,r)=>{r.d(t,{i:()=>l});var a=r(47665),n=r(58267),o=r(60712);function l({state:e}){return(0,o.jsx)(a.J,{theme:(0,n._)(e),children:e})}},28539:(e,t,r)=>{r.d(t,{T:()=>a.T});var a=r(53755)},42829:(e,t,r)=>{r.d(t,{D:()=>a});const a=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55974:(e,t,r)=>{r.d(t,{g:()=>y});var a=r(59284),n=r(18677),o=r(71153),l=r(74321),s=r(2198),i=r(99991),d=r(89954),u=r(77506),c=r(81288),p=r(48372);const h=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),m=(0,p.g4)("ydb-critical-action-dialog",{en:h});var g=r(60712);const b=(0,u.cn)("ydb-critical-dialog"),v=e=>{if((0,c.cH)(e)){if(403===e.status)return m("no-rights-error");if("string"===typeof e.data)return e.data;if((0,c._E)(e)&&e.data)return(0,g.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return m("default-error")};function y({visible:e,header:t,text:r,withRetry:d,retryButtonText:u,withCheckBox:c,onClose:p,onConfirm:h,onConfirmActionSuccess:y,onConfirmActionError:f}){const[x,w]=a.useState(!1),[j,N]=a.useState(),[C,T]=a.useState(!1),S=async e=>(w(!0),h(e).then((()=>{y(),p()})).catch((e=>{f(e),N(e)})).finally((()=>{w(!1)})));return(0,g.jsx)(s.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:p,onTransitionExited:()=>{N(void 0),T(!1)},children:j?(0,g.jsxs)(a.Fragment,{children:[(0,g.jsx)(s.l.Header,{caption:t}),(0,g.jsx)(s.l.Body,{className:b("body"),children:(0,g.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,g.jsx)("span",{className:b("error-icon"),children:(0,g.jsx)(n.A,{width:"24",height:"22"})}),v(j)]})}),(0,g.jsx)(s.l.Footer,{loading:!1,preset:"default",textButtonApply:d?u||m("button-retry"):void 0,textButtonCancel:m("button-close"),onClickButtonApply:()=>S(!0),onClickButtonCancel:p})]}):(0,g.jsxs)(a.Fragment,{children:[(0,g.jsx)(s.l.Header,{caption:t}),(0,g.jsxs)(s.l.Body,{className:b("body"),children:[(0,g.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,g.jsx)("span",{className:b("warning-icon"),children:(0,g.jsx)(i.I,{data:o.A,size:24})}),r]}),c?(0,g.jsx)(l.S,{checked:C,onUpdate:T,children:m("checkbox-text")}):null]}),(0,g.jsx)(s.l.Footer,{loading:x,preset:"default",textButtonApply:m("button-confirm"),textButtonCancel:m("button-cancel"),propsButtonApply:{type:"submit",disabled:c&&!C},onClickButtonCancel:p,onClickButtonApply:()=>S()})]})})}},88616:(e,t,r)=>{r.d(t,{Q:()=>P});var a=r(59284),n=r(76938),o=r(98089),l=r(99991),s=r(67087),i=r(22983),d=r(28539),u=r(10508),c=r(44508),p=r(44294),h=r(17594),m=r(41775),g=r(89073),b=r(80420),v=r(27775),y=r(41826),f=r(21545),x=r(6354),w=r(76086),j=r(12888),N=r(29819),C=r(48372);const T=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),S=(0,C.g4)("ydb-tablets",{en:T});var F=r(60712);function I(e){const t=e.State===x.r.Stopped,r=(0,j.X)(),[a]=f.X.useKillTabletMutation(),o=e.TabletId;return o?(0,F.jsx)(i.B,{buttonView:"outlined",buttonTitle:S("dialog.kill-header"),dialogHeader:S("dialog.kill-header"),dialogText:S("dialog.kill-text"),onConfirmAction:()=>a({id:o}).unwrap(),buttonDisabled:t||!r,withPopover:!0,popoverContent:S(r?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,F.jsx)(l.I,{data:n.A})}):null}function P({database:e,tablets:t,loading:r,error:n}){const[{tabletsSearch:l},i]=(0,s.useQueryParams)({tabletsSearch:s.StringParam}),f=a.useMemo((()=>function({database:e}){return[{name:"Type",width:150,get header(){return S("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,F.jsxs)("span",{children:[e.Type," ",t?(0,F.jsx)(o.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return S("Tablet")},render:({row:t})=>t.TabletId?(0,F.jsx)(b.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):w.Pd},{name:"State",get header(){return S("State")},render:({row:e})=>(0,F.jsx)(v.i,{state:e.State})},{name:"NodeId",get header(){return S("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,N.vI)(e.NodeId);return(0,F.jsx)(p.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return S("Node FQDN")},render:({row:e})=>e.fqdn?(0,F.jsx)(u.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,F.jsx)("span",{children:"\u2014"})},{name:"Generation",get header(){return S("Generation")},align:"right"},{name:"Uptime",get header(){return S("Uptime")},render:({row:e})=>(0,F.jsx)(y.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,F.jsx)(I,{...e})}]}({database:e})),[e]),x=a.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==l&&void 0!==l?l:"")))),[t,l]);return(0,F.jsxs)(g.L,{children:[(0,F.jsxs)(g.L.Controls,{children:[(0,F.jsx)(m.v,{placeholder:S("controls.search-placeholder"),onChange:e=>{i({tabletsSearch:e||void 0},"replaceIn")},value:null!==l&&void 0!==l?l:"",width:238}),(0,F.jsx)(d.T,{label:S("controls.entities-count-label"),loading:r,total:t.length,current:x.length})]}),n?(0,F.jsx)(c.o,{error:n}):null,(0,F.jsx)(g.L.Table,{loading:r,children:(0,F.jsx)(h.l,{columns:f,data:x,settings:w.N3,emptyDataMessage:S("noTabletsData")})})]})}},89954:(e,t,r)=>{r.d(t,{O:()=>S});var a=r(59284),n=r(45720),o=r(16929),l=r(71153),s=r(18677),i=r(84476),d=r(33705),u=r(67884),c=r(99991),p=r(77506),h=r(48372);const m=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),g=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),b=(0,h.g4)("ydb-shorty-string",{ru:g,en:m});var v=r(60712);const y=(0,p.cn)("kv-shorty-string");function f({value:e="",limit:t=200,strict:r=!1,displayLength:n=!0,render:o=e=>e,onToggle:l,expandLabel:s=b("default_expand_label"),collapseLabel:i=b("default_collapse_label")}){const[d,c]=a.useState(!1),p=(d?i:s)+(n&&!d?b("chars_count",{count:e.length}):""),h=e.length>t+(r?0:p.length),m=d||!h?e:e.slice(0,t-4)+"\xa0...";return(0,v.jsxs)("div",{className:y(),children:[o(m),h?(0,v.jsx)(u.N,{className:y("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),c((e=>!e)),null===l||void 0===l||l()},children:p}):null]})}var x=r(41650);const w=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function j(e){return function(e){return!!e&&void 0!==w[e]}(e)?w[e]:"S_INFO"}const N=(0,p.cn)("kv-result-issues"),C=(0,p.cn)("kv-issues"),T=(0,p.cn)("kv-issue");function S({data:e,hideSeverity:t}){const[r,n]=a.useState(!1),o="string"===typeof e||null===e||void 0===e?void 0:e.issues,l=Array.isArray(o)&&o.length>0;return(0,v.jsxs)("div",{className:N(),children:[(0,v.jsxs)("div",{className:N("error-message"),children:[(()=>{let r;if("string"===typeof e)r=e;else{var n,o;const l=j(null===e||void 0===e||null===(n=e.error)||void 0===n?void 0:n.severity);r=(0,v.jsxs)(a.Fragment,{children:[t?null:(0,v.jsxs)(a.Fragment,{children:[(0,v.jsx)(_,{severity:l})," "]}),(0,v.jsx)("span",{className:N("error-message-text"),children:null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message})]})}return r})(),l&&(0,v.jsx)(i.$,{view:"normal",onClick:()=>n(!r),children:r?"Hide details":"Show details"})]}),l&&r&&(0,v.jsx)(F,{hideSeverity:t,issues:o})]})}function F({issues:e,hideSeverity:t}){const r=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var r;const a=null!==(r=t.severity)&&void 0!==r?r:10;return Math.min(e,a)}),10);return(0,v.jsx)("div",{className:C(null),children:null===e||void 0===e?void 0:e.map(((e,a)=>(0,v.jsx)(I,{hideSeverity:t,issue:e,expanded:e===r},a)))})}function I({issue:e,hideSeverity:t,level:r=0}){const[n,o]=a.useState(!0),l=j(e.severity),s=e.issues,u=Array.isArray(s)&&s.length>0,c=n?"bottom":"right";return(0,v.jsxs)("div",{className:T({leaf:!u,"has-issues":u}),children:[(0,v.jsxs)("div",{className:T("line"),children:[u&&(0,v.jsx)(i.$,{view:"flat-secondary",onClick:()=>o(!n),className:T("arrow-toggle"),children:(0,v.jsx)(d.I,{direction:c,size:16})}),t?null:(0,v.jsx)(_,{severity:l}),(0,v.jsx)(P,{issue:e}),e.issue_code?(0,v.jsxs)("span",{className:T("code"),children:["Code: ",e.issue_code]}):null]}),u&&n&&(0,v.jsx)("div",{className:T("issues"),children:(0,v.jsx)(R,{issues:s,level:r+1,expanded:n})})]})}function P({issue:e}){var t;const r=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,x.kf)(t.row))return"";const{row:r,column:a}=t;return(0,x.kf)(a)?`${r}:${a}`:`line ${r}`}(e),a=window.ydbEditor,n=()=>(0,v.jsxs)("span",{className:T("message"),children:[r&&(0,v.jsx)("span",{className:T("place-text"),title:"Position",children:r}),(0,v.jsx)("div",{className:T("message-text"),children:(0,v.jsx)(f,{value:e.message,expandLabel:"Show full message"})})]}),{row:o,column:l}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,x.kf)(o)&&a))return n();return(0,v.jsx)(u.N,{href:"#",extraProps:{draggable:!1},onClick:()=>{const e={lineNumber:o,column:null!==l&&void 0!==l?l:0};a.setPosition(e),a.revealPositionInCenterIfOutsideViewport(e),a.focus()},view:"primary",children:n()})}function R(e){const{issues:t,level:r,expanded:a}=e;return(0,v.jsx)("div",{className:T("list"),children:t.map(((e,t)=>(0,v.jsx)(I,{issue:e,level:r,expanded:a},t)))})}const A={S_INFO:n.A,S_WARNING:o.A,S_ERROR:l.A,S_FATAL:s.A},B=(0,p.cn)("yql-issue-severity");function _({severity:e}){const t=e.slice(2).toLowerCase();return(0,v.jsxs)("span",{className:B({severity:t}),children:[(0,v.jsx)(c.I,{className:B("icon"),data:A[e]}),(0,v.jsx)("span",{className:B("title"),children:t})]})}},95963:(e,t,r)=>{r.d(t,{v:()=>a.v});var a=r(41775)}}]);