"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[49393],{3685:(e,t,a)=>{a.d(t,{$:()=>i});var n=a(54090),l=a(77506),s=a(33775),o=a(60712);const r=(0,l.cn)("ydb-entity-page-title");function i({entityName:e,status:t=n.m.Grey,id:a,className:l}){return(0,o.jsxs)("div",{className:r(null,l),children:[(0,o.jsx)("span",{className:r("prefix"),children:e}),(0,o.jsx)(s.k,{className:r("icon"),status:t,size:"s"}),a]})}},21545:(e,t,a)=>{a.d(t,{X:()=>l});var n=a(78034);const l=a(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:a},{signal:l})=>{try{const[s,o,r]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:a},{signal:l}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:l}),window.api.viewer.getNodesList({signal:l})]),i=(0,n.nN)(r),d=Object.keys(o).reduce(((e,t)=>{var a;const n=null===(a=o[t])||void 0===a?void 0:a.TabletStateInfo;return null===n||void 0===n||n.forEach((a=>{var n;const{ChangeTime:l,Generation:s,State:o,Leader:r,FollowerId:d}=a,c=i&&t?null===(n=i.get(Number(t)))||void 0===n?void 0:n.Host:void 0;e.push({nodeId:t,generation:s,changeTime:l,state:o,leader:r,followerId:d,fqdn:c})})),e}),[]),{TabletStateInfo:c=[]}=s,u=void 0===a?c.find((e=>e.Leader)):c.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===a})),{TabletId:h}=u||{};return{data:{id:h,data:u,history:d}}}catch(s){return{error:s}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const a=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:n,PathId:l}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${n}:${l}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(n){return{error:n}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,a)=>{a.d(t,{B:()=>d});var n=a(59284),l=a(84476),s=a(84375),o=a(55974),r=a(42829),i=a(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:a,dialogHeader:d,dialogText:c,retryButtonText:u,buttonDisabled:h=!1,buttonView:m="action",buttonTitle:v,buttonClassName:p,withPopover:b=!1,popoverContent:g,popoverPlacement:x="right",popoverDisabled:f=!0}){const[y,w]=n.useState(!1),[j,N]=n.useState(!1),[I,T]=n.useState(!1),S=()=>(0,i.jsx)(l.$,{onClick:()=>w(!0),view:m,disabled:h,loading:!h&&j,className:p,title:v,children:e});return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(o.g,{visible:y,header:d,text:c,withRetry:I,retryButtonText:u,onConfirm:async e=>{N(!0),await t(e)},onConfirmActionSuccess:async()=>{T(!1);try{await(null===a||void 0===a?void 0:a())}finally{N(!1)}},onConfirmActionError:e=>{T((0,r.D)(e)),N(!1)},onClose:()=>{w(!1)}}),b?(0,i.jsx)(s.A,{content:g,placement:x,disabled:f,children:S()}):S()]})}},27775:(e,t,a)=>{a.d(t,{i:()=>o});var n=a(47665),l=a(58267),s=a(60712);function o({state:e}){return(0,s.jsx)(n.J,{theme:(0,l._)(e),children:e})}},42829:(e,t,a)=>{a.d(t,{D:()=>n});const n=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55974:(e,t,a)=>{a.d(t,{g:()=>x});var n=a(59284),l=a(18677),s=a(71153),o=a(74321),r=a(2198),i=a(99991),d=a(56999),c=a(77506),u=a(81288),h=a(48372);const m=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),v=(0,h.g4)("ydb-critical-action-dialog",{en:m});var p=a(60712);const b=(0,c.cn)("ydb-critical-dialog"),g=e=>{if((0,u.cH)(e)){if(403===e.status)return v("no-rights-error");if("string"===typeof e.data)return e.data;if((0,u._E)(e)&&e.data)return(0,p.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return v("default-error")};function x({visible:e,header:t,text:a,withRetry:d,retryButtonText:c,withCheckBox:u,onClose:h,onConfirm:m,onConfirmActionSuccess:x,onConfirmActionError:f}){const[y,w]=n.useState(!1),[j,N]=n.useState(),[I,T]=n.useState(!1),S=async e=>(w(!0),m(e).then((()=>{x(),h()})).catch((e=>{f(e),N(e)})).finally((()=>{w(!1)})));return(0,p.jsx)(r.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:h,onTransitionExited:()=>{N(void 0),T(!1)},children:j?(0,p.jsxs)(n.Fragment,{children:[(0,p.jsx)(r.l.Header,{caption:t}),(0,p.jsx)(r.l.Body,{className:b("body"),children:(0,p.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,p.jsx)("span",{className:b("error-icon"),children:(0,p.jsx)(l.A,{width:"24",height:"22"})}),g(j)]})}),(0,p.jsx)(r.l.Footer,{loading:!1,preset:"default",textButtonApply:d?c||v("button-retry"):void 0,textButtonCancel:v("button-close"),onClickButtonApply:()=>S(!0),onClickButtonCancel:h})]}):(0,p.jsxs)(n.Fragment,{children:[(0,p.jsx)(r.l.Header,{caption:t}),(0,p.jsxs)(r.l.Body,{className:b("body"),children:[(0,p.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,p.jsx)("span",{className:b("warning-icon"),children:(0,p.jsx)(i.I,{data:s.A,size:24})}),a]}),u?(0,p.jsx)(o.S,{checked:I,onUpdate:T,children:v("checkbox-text")}):null]}),(0,p.jsx)(r.l.Footer,{loading:y,preset:"default",textButtonApply:v("button-confirm"),textButtonCancel:v("button-cancel"),propsButtonApply:{type:"submit",disabled:u&&!I},onClickButtonCancel:h,onClickButtonApply:()=>S()})]})})}},56999:(e,t,a)=>{a.d(t,{O:()=>w});var n=a(59284),l=a(45720),s=a(16929),o=a(71153),r=a(18677),i=a(84476),d=a(33705),c=a(67884),u=a(99991),h=a(74529),m=a(77506),v=a(41650);const p=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function b(e){return function(e){return!!e&&void 0!==p[e]}(e)?p[e]:"S_INFO"}var g=a(60712);const x=(0,m.cn)("kv-result-issues"),f=(0,m.cn)("kv-issues"),y=(0,m.cn)("kv-issue");function w({data:e,hideSeverity:t}){const[a,l]=n.useState(!1),s="string"===typeof e||null===e||void 0===e?void 0:e.issues,o=Array.isArray(s)&&s.length>0;return(0,g.jsxs)("div",{className:x(),children:[(0,g.jsxs)("div",{className:x("error-message"),children:[(()=>{let a;if("string"===typeof e)a=e;else{var l,s;const o=b(null===e||void 0===e||null===(l=e.error)||void 0===l?void 0:l.severity);a=(0,g.jsxs)(n.Fragment,{children:[t?null:(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(C,{severity:o})," "]}),(0,g.jsx)("span",{className:x("error-message-text"),children:null===e||void 0===e||null===(s=e.error)||void 0===s?void 0:s.message})]})}return a})(),o&&(0,g.jsx)(i.$,{view:"normal",onClick:()=>l(!a),children:a?"Hide details":"Show details"})]}),o&&a&&(0,g.jsx)(j,{hideSeverity:t,issues:s})]})}function j({issues:e,hideSeverity:t}){const a=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var a;const n=null!==(a=t.severity)&&void 0!==a?a:10;return Math.min(e,n)}),10);return(0,g.jsx)("div",{className:f(null),children:null===e||void 0===e?void 0:e.map(((e,n)=>(0,g.jsx)(N,{hideSeverity:t,issue:e,expanded:e===a},n)))})}function N({issue:e,hideSeverity:t,level:a=0}){const[l,s]=n.useState(!0),o=b(e.severity),r=e.issues,c=Array.isArray(r)&&r.length>0,u=l?"bottom":"right";return(0,g.jsxs)("div",{className:y({leaf:!c,"has-issues":c}),children:[(0,g.jsxs)("div",{className:y("line"),children:[c&&(0,g.jsx)(i.$,{view:"flat-secondary",onClick:()=>s(!l),className:y("arrow-toggle"),children:(0,g.jsx)(d.I,{direction:u,size:16})}),t?null:(0,g.jsx)(C,{severity:o}),(0,g.jsx)(I,{issue:e}),e.issue_code?(0,g.jsxs)("span",{className:y("code"),children:["Code: ",e.issue_code]}):null]}),c&&l&&(0,g.jsx)("div",{className:y("issues"),children:(0,g.jsx)(T,{issues:r,level:a+1,expanded:l})})]})}function I({issue:e}){var t;const a=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,v.kf)(t.row))return"";const{row:a,column:n}=t;return(0,v.kf)(n)?`${a}:${n}`:`line ${a}`}(e),n=window.ydbEditor,l=()=>(0,g.jsxs)("span",{className:y("message"),children:[a&&(0,g.jsx)("span",{className:y("place-text"),title:"Position",children:a}),(0,g.jsx)("div",{className:y("message-text"),children:(0,g.jsx)(h.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:s,column:o}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,v.kf)(s)&&n))return l();return(0,g.jsx)(c.N,{href:"#",extraProps:{draggable:!1},onClick:()=>{const e={lineNumber:s,column:null!==o&&void 0!==o?o:0};n.setPosition(e),n.revealPositionInCenterIfOutsideViewport(e),n.focus()},view:"primary",children:l()})}function T(e){const{issues:t,level:a,expanded:n}=e;return(0,g.jsx)("div",{className:y("list"),children:t.map(((e,t)=>(0,g.jsx)(N,{issue:e,level:a,expanded:n},t)))})}const S={S_INFO:l.A,S_WARNING:s.A,S_ERROR:o.A,S_FATAL:r.A},_=(0,m.cn)("yql-issue-severity");function C({severity:e}){const t=e.slice(2).toLowerCase();return(0,g.jsxs)("span",{className:_({severity:t}),children:[(0,g.jsx)(u.I,{className:_("icon"),data:S[e]}),(0,g.jsx)("span",{className:_("title"),children:t})]})}},58267:(e,t,a)=>{a.d(t,{P:()=>o,_:()=>r});var n=a(54090),l=a(6354);const s={[l.r.Dead]:n.m.Red,[l.r.Created]:n.m.Yellow,[l.r.ResolveStateStorage]:n.m.Yellow,[l.r.Candidate]:n.m.Yellow,[l.r.BlockBlobStorage]:n.m.Yellow,[l.r.WriteZeroEntry]:n.m.Yellow,[l.r.Restored]:n.m.Yellow,[l.r.Discover]:n.m.Yellow,[l.r.Lock]:n.m.Yellow,[l.r.Stopped]:n.m.Yellow,[l.r.ResolveLeader]:n.m.Yellow,[l.r.RebuildGraph]:n.m.Yellow,[l.r.Deleted]:n.m.Green,[l.r.Active]:n.m.Green},o=e=>{if(!e)return n.m.Grey;return t=e,Object.values(n.m).includes(t)?e:s[e];var t};function r(e){if(!e)return"unknown";switch(e){case l.r.Dead:return"danger";case l.r.Active:case l.r.Deleted:return"success";default:return"warning"}}},58389:(e,t,a)=>{a.d(t,{B:()=>u});var n=a(87184),l=a(77506),s=a(90053),o=a(70043),r=a(60712);const i=(0,l.cn)("ydb-page-meta"),d="\xa0\xa0\xb7\xa0\xa0";function c({items:e,loading:t}){return(0,r.jsx)("div",{className:i("info"),children:t?(0,r.jsx)(o.E,{className:i("skeleton")}):e.filter((e=>Boolean(e))).join(d)})}function u({className:e,...t}){return(0,r.jsxs)(n.s,{gap:1,alignItems:"center",justifyContent:"space-between",className:i(null,e),children:[(0,r.jsx)(c,{...t}),(0,r.jsx)(s.E,{})]})}},70043:(e,t,a)=>{a.d(t,{E:()=>o});var n=a(89169),l=a(66781),s=a(60712);const o=({delay:e=600,className:t})=>{const[a]=(0,l.y)(e);return a?(0,s.jsx)(n.E,{className:t}):null}},74529:(e,t,a)=>{a.d(t,{A:()=>h});var n=a(59284),l=a(67884),s=a(77506),o=a(48372);const r=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),i=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,o.g4)("ydb-shorty-string",{ru:i,en:r});var c=a(60712);const u=(0,s.cn)("kv-shorty-string");function h({value:e="",limit:t=200,strict:a=!1,displayLength:s=!0,render:o=e=>e,onToggle:r,expandLabel:i=d("default_expand_label"),collapseLabel:h=d("default_collapse_label")}){const[m,v]=n.useState(!1),p=(m?h:i)+(s&&!m?d("chars_count",{count:e.length}):""),b=e.length>t+(a?0:p.length),g=m||!b?e:e.slice(0,t-4)+"\xa0...";return(0,c.jsxs)("div",{className:u(),children:[o(g),b?(0,c.jsx)(l.N,{className:u("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),v((e=>!e)),null===r||void 0===r||r()},children:p}):null]})}},79737:(e,t,a)=>{a.d(t,{A:()=>r,X:()=>i});var n=a(5874),l=a(77506),s=a(60712);const o=(0,l.cn)("ydb-table");function r({children:e,className:t}){return(0,s.jsx)("div",{className:o("table-header-content",t),children:e})}function i({className:e,width:t,wrapperClassName:a,...l}){return(0,s.jsx)("div",{className:o(null,a),children:(0,s.jsx)(n.W,{headerCellClassName:({column:e})=>{var t;const a=null===(t=e.columnDef.meta)||void 0===t?void 0:t.align;return o("table-header-cell",{align:a})},cellClassName:e=>{var t,a;const n=null===e||void 0===e||null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.align,l=null===e||void 0===e||null===(a=e.column.columnDef.meta)||void 0===a?void 0:a.verticalAlign;return o("table-cell",{align:n,"vertical-align":l})},className:o("table",{width:t},e),...l})})}},81342:(e,t,a)=>{a.r(t),a.d(t,{Tablet:()=>pe});var n=a(59284),l=a(87184),s=a(23871),o=a(4980),r=a(61750),i=a(10755),d=a(80987),c=a(370),u=a(7889),h=a(3685),m=a(44508),v=a(44294),p=a(98167),b=a(58389),g=a(92459),x=a(40174),f=a(21545),y=a(54090),w=a(77506),j=a(76086),N=a(69063),I=a(12888),T=a(76938);const S=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.5 1.5a3 3 0 0 0-3 3v7a3 3 0 0 0 3 3h7a3 3 0 0 0 3-3v-7a3 3 0 0 0-3-3z",clipRule:"evenodd"})),_=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",d:"M13.756 10.164c1.665-.962 1.665-3.366 0-4.328L5.251.919C3.584-.045 1.5 1.158 1.5 3.083v9.834c0 1.925 2.084 3.128 3.751 2.164z"}));var C=a(99991),A=a(22983),k=a(6354),D=a(48372);const E=JSON.parse('{"tablet.header":"Tablet","tablet.meta-database":"Database","tablet.meta-follower":"Follower","controls.kill":"Restart","controls.stop":"Stop","controls.resume":"Resume","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.stop-not-allowed":"You don\'t have enough rights to stop tablet","controls.resume-not-allowed":"You don\'t have enough rights to resume tablet","dialog.kill-header":"Restart tablet","dialog.stop-header":"Stop tablet","dialog.resume-header":"Resume tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","dialog.stop-text":"The tablet will be stopped. Do you want to proceed?","dialog.resume-text":"The tablet will be resumed. Do you want to proceed?","emptyState":"The tablet was not found","label_tablet-history":"Tablets","label_tablet-channels":"Storage"}'),F=(0,D.g4)("ydb-tablet-page",{en:E});function B(e){return Boolean(e&&"0"!==e)}var R=a(60712);const O=({tablet:e})=>{const{TabletId:t,HiveId:a}=e,s=(0,I.X)(),[o]=f.X.useKillTabletMutation(),[r]=f.X.useStopTabletMutation(),[i]=f.X.useResumeTabletMutation();if(!t)return null;const d=B(a),c=e.State===k.r.Stopped,u=e.State!==k.r.Stopped&&e.State!==k.r.Dead,h=e.State===k.r.Stopped||e.State===k.r.Deleted;return(0,R.jsxs)(l.s,{gap:2,wrap:"nowrap",children:[(0,R.jsxs)(A.B,{dialogHeader:F("dialog.kill-header"),dialogText:F("dialog.kill-text"),onConfirmAction:()=>o({id:t}).unwrap(),buttonDisabled:c||!s,withPopover:!0,buttonView:"normal",popoverContent:F("controls.kill-not-allowed"),popoverPlacement:"bottom",popoverDisabled:s,children:[(0,R.jsx)(C.I,{data:T.A}),F("controls.kill")]}),d&&(0,R.jsxs)(n.Fragment,{children:[(0,R.jsxs)(A.B,{dialogHeader:F("dialog.stop-header"),dialogText:F("dialog.stop-text"),onConfirmAction:()=>r({id:t,hiveId:a}).unwrap(),buttonDisabled:h||!s,withPopover:!0,buttonView:"normal",popoverContent:F("controls.stop-not-allowed"),popoverPlacement:"bottom",popoverDisabled:s,children:[(0,R.jsx)(C.I,{data:S}),F("controls.stop")]}),(0,R.jsxs)(A.B,{dialogHeader:F("dialog.resume-header"),dialogText:F("dialog.resume-text"),onConfirmAction:()=>i({id:t,hiveId:a}).unwrap(),buttonDisabled:u||!s,withPopover:!0,buttonView:"normal",popoverContent:F("controls.resume-not-allowed"),popoverPlacement:"bottom",popoverDisabled:s,children:[(0,R.jsx)(C.I,{data:_}),F("controls.resume")]})]})]})};var P=a(52905),$=a(60073),G=a(25196),H=a(27775),L=a(41826),z=a(31684),q=a(29819);const Y=JSON.parse('{"field_scheme-shard":"SchemeShard","field_follower":"Follower","field_generation":"Generation","field_hive":"HiveId","field_state":"State","field_uptime":"Uptime","field_node":"Node","field_links":"Links","field_developer-ui-app":"App","field_developer-ui-counters":"Counters","field_developer-ui-executor":"Executor DB internals","field_developer-ui-state":"State Storage","title_info":"Info","title_links":"Links"}'),M=(0,D.g4)("ydb-tablet-info",{en:Y}),K=(0,w.cn)("ydb-tablet-info"),X=({tablet:e})=>{const t=(0,I.X)(),{ChangeTime:a,Generation:n,FollowerId:s,NodeId:o,HiveId:r,State:i,TenantId:{SchemeShard:d}={},TabletId:c}=e,u=B(r),h=i===k.r.Active,m=[];u&&m.push({label:M("field_hive"),value:(0,R.jsx)(P.N_,{to:(0,g.DM)(r),className:K("link"),children:r})}),d&&m.push({label:M("field_scheme-shard"),value:(0,R.jsx)(P.N_,{to:(0,g.DM)(d),className:K("link"),children:d})}),m.push({label:M("field_state"),value:(0,R.jsx)(H.i,{state:i})}),h&&m.push({label:M("field_uptime"),value:(0,R.jsx)(L.H,{ChangeTime:a})}),m.push({label:M("field_generation"),value:n},{label:M("field_node"),value:(0,R.jsx)(P.N_,{className:K("link"),to:(0,q.vI)(String(o)),children:o})}),s&&m.push({label:M("field_follower"),value:s});return(0,R.jsxs)(l.s,{gap:10,wrap:"nowrap",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("div",{className:K("section-title"),children:M("title_info")}),(0,R.jsx)($.z_,{info:m})]}),t&&c?(0,R.jsxs)("div",{children:[(0,R.jsx)("div",{className:K("section-title"),children:M("title_links")}),(0,R.jsxs)(l.s,{direction:"column",gap:3,children:[(0,R.jsx)(G.K,{title:M("field_developer-ui-app"),url:(0,z._t)(c,"app")}),(0,R.jsx)(G.K,{title:M("field_developer-ui-counters"),url:(0,z._t)(c,"counters")}),(0,R.jsx)(G.K,{title:M("field_developer-ui-executor"),url:(0,z._t)(c,"executorInternals")}),(0,R.jsx)(G.K,{title:M("field_developer-ui-state"),url:(0,z._t)(c,void 0,"SsId")})]})]}):null]})};var Q=a(36590),J=a(79737),V=a(84476),W=a(33705),U=a(56839);const Z=JSON.parse('{"label_channel-index":"Channel","label_storage-pool":"Storage Pool Name","label_group-id":"Group ID","label_generation":"From generation","label_timestamp":"Timestamp"}'),ee=(0,D.g4)("ydb-tablet-storage-info",{en:Z}),te=(0,w.cn)("ydb-tablet-storage-info");function ae(e,t){const a=e.getValue(),n="function"===typeof t?t(a):a;return(0,R.jsx)("div",{className:te("metrics-cell"),children:n})}function ne({row:e,name:t,hasExpand:a}){const n=e.getCanExpand();return(0,R.jsxs)(l.s,{gap:1,alignItems:"flex-start",className:te("name-wrapper"),children:[n&&(0,R.jsx)(V.$,{view:"flat",size:"xs",onClick:e.getToggleExpandedHandler(),children:(0,R.jsx)(V.$.Icon,{children:(0,R.jsx)(W.I,{direction:e.getIsExpanded()?"bottom":"right",size:14})})}),(0,R.jsx)("div",{className:te("name-content",{"no-control":a&&!n}),children:t})]})}function le({data:e}){const[t,a]=n.useState({}),l=n.useMemo((()=>function(e){var t;if(!e)return[];const{BoundChannels:a,TabletStorageInfo:n={}}=e,l=null!==(t=n.Channels)&&void 0!==t?t:[],s=[];for(const r of l){var o;const e=r.Channel,t=r.History;if(!e||!t||!t.length)continue;const n=[...t];n.reverse();const[l,...i]=n,d={...l,storagePoolName:null===a||void 0===a||null===(o=a[e])||void 0===o?void 0:o.StoragePoolName,channelIndex:e,children:i};s.push(d)}return s}(e)),[e]),s=n.useMemo((()=>l.some((e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.length}))),[l]),o=n.useMemo((()=>{return e=s,[{accessorKey:"channelIndex",header:()=>(0,R.jsx)(J.A,{children:ee("label_channel-index")}),size:50,cell:ae,meta:{align:"right"}},{accessorKey:"storagePoolName",header:()=>(0,R.jsx)(J.A,{children:ee("label_storage-pool")}),size:200,cell:ae},{accessorKey:"GroupID",header:()=>(0,R.jsx)(J.A,{className:e?te("with-padding"):void 0,children:ee("label_group-id")}),size:100,cell:t=>(0,R.jsx)(ne,{row:t.row,name:t.getValue(),hasExpand:e})},{accessorKey:"FromGeneration",header:()=>(0,R.jsx)(J.A,{children:ee("label_generation")}),size:100,cell:ae,meta:{align:"right"}},{accessorKey:"Timestamp",header:()=>(0,R.jsx)(J.A,{children:ee("label_timestamp")}),size:200,cell:e=>ae(e,U.Ey),meta:{align:"right"}}];var e}),[s]),r=(0,Q.K)({columns:o,data:l,getSubRows:e=>e.children,enableExpanding:!0,onExpandedChange:a,state:{expanded:t}});return(0,R.jsx)(J.X,{table:r})}var se=a(4557),oe=a(10508),re=a(82015),ie=a(17594);const de={displayIndices:!1,highlightRows:!0},ce=({history:e,database:t,tabletId:a})=>{const l=n.useMemo((()=>(({database:e,tabletId:t})=>[{name:"Generation",align:se.Ay.RIGHT,render:({row:e})=>e.generation},{name:"Change time",align:se.Ay.RIGHT,sortable:!1,render:({row:e})=>(0,R.jsx)(L.H,{ChangeTime:e.changeTime}),width:120},{name:"State",sortable:!1,render:({row:e})=>(0,R.jsx)(H.i,{state:e.state})},{name:"Tablet",sortable:!1,render:({row:a})=>{var n;const l=(0,g.DM)(t,{database:e,followerId:a.leader||null===(n=a.followerId)||void 0===n?void 0:n.toString()}),s=`${t}${a.followerId?`.${a.followerId}`:""}`;return(0,R.jsx)(re.E,{to:l,children:s})}},{name:"Node ID",align:se.Ay.RIGHT,sortable:!1,render:({row:e})=>(0,R.jsx)(re.E,{to:(0,q.vI)(e.nodeId),children:e.nodeId})},{name:"Node FQDN",sortable:!1,width:300,render:({row:e})=>e.fqdn?(0,R.jsx)(oe.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,R.jsx)("span",{children:"\u2014"})}])({database:t,tabletId:a})),[t,a]);return(0,R.jsx)(ie.l,{columnsWidthLSKey:"tabletTableColumnsWidth",data:e,columns:l,settings:de,initialSortOrder:{columnId:"Generation",order:se.Ay.DESCENDING}})},ue=(0,w.cn)("ydb-tablet-page"),he={history:"history",channels:"channels"},me=[{id:he.history,get title(){return F("label_tablet-history")}},{id:he.channels,get title(){return F("label_tablet-channels")},isAdvanced:!0}],ve=c.z.nativeEnum(he).catch(he.history);function pe(){var e;const t=(0,N.YQ)(),{id:a}=(0,i.g)(),[{database:s,clusterName:c,followerId:u}]=(0,d.useQueryParams)(g.qc),[h]=(0,N.Nt)(),{currentData:v,isFetching:y,error:w}=f.X.useGetTabletQuery({id:a,database:null!==s&&void 0!==s?s:void 0,followerId:null!==u&&void 0!==u?u:void 0},{pollingInterval:h}),I=y&&void 0===v,{data:T={},history:S=[]}=v||{},{currentData:_}=f.X.useGetTabletDescribeQuery(T.TenantId?{tenantId:T.TenantId}:o.hT),C=null!==(e=_||s)&&void 0!==e?e:void 0,A=T.Type;n.useEffect((()=>{t((0,x.g)("tablet",{tenantName:null!==s&&void 0!==s?s:void 0,tabletId:a,tabletType:A}))}),[t,s,a,A]);const{Leader:k,Type:D}=T,E=[];return C&&E.push(`${F("tablet.meta-database")}: ${C}`),D&&E.push(D),!1===k&&E.push(F("tablet.meta-follower").toUpperCase()),(0,R.jsxs)(l.s,{gap:5,direction:"column",className:ue(),children:[(0,R.jsx)(r.mg,{children:(0,R.jsx)("title",{children:`${a} \u2014 ${F("tablet.header")} \u2014 ${C||c||j.QM}`})}),(0,R.jsx)(b.B,{items:E}),(0,R.jsxs)(p.r,{loading:I,size:"l",children:[w?(0,R.jsx)(m.o,{error:w}):null,v?(0,R.jsx)(be,{id:a,tablet:T,history:S,database:C}):null]})]})}function be({id:e,tablet:t,history:a,database:n}){const s=!Object.keys(t).length,{Overall:o,HiveId:r,FollowerId:i}=t,d=`${e}${i?`.${i}`:""}`;return(0,R.jsxs)(u.q,{title:F("emptyState"),className:ue("placeholder"),isEmpty:s,children:[(0,R.jsxs)(l.s,{gap:5,direction:"column",children:[(0,R.jsx)(h.$,{entityName:F("tablet.header"),status:null!==o&&void 0!==o?o:y.m.Grey,id:d}),(0,R.jsx)(O,{tablet:t}),(0,R.jsx)(X,{tablet:t})]}),(0,R.jsx)(ge,{id:e,hiveId:r,history:a,database:n})]})}function ge({id:e,hiveId:t,history:a,database:o}){var r;const[{activeTab:i,...c},u]=(0,d.useQueryParams)(g.qc),h=!(0,I.X)()||!B(t);let m=ve.parse(i);return h&&null!==(r=me.find((e=>e.id===m)))&&void 0!==r&&r.isAdvanced&&(m=he.history),n.useEffect((()=>{i!==m&&u({activeTab:m},"replaceIn")}),[i,m,u]),(0,R.jsxs)(l.s,{gap:5,direction:"column",children:[(0,R.jsx)("div",{children:(0,R.jsx)(s.t,{size:"l",items:me.filter((({isAdvanced:e})=>!e||!h)),activeTab:m,wrapTo:(t,a)=>{const n=(0,g.DM)(e,{...c,activeTab:t.id});return(0,R.jsx)(v.E,{to:n,children:a},t.id)}})}),"history"===m?(0,R.jsx)(ce,{history:a,tabletId:e,database:o}):null,"channels"!==m||h?null:(0,R.jsx)(xe,{id:e,hiveId:t})]})}function xe({id:e,hiveId:t}){const[a]=(0,N.Nt)(),{currentData:n,error:l,isFetching:s}=f.X.useGetAdvancedTableInfoQuery({id:e,hiveId:t},{pollingInterval:a}),o=s&&void 0===n;return(0,R.jsxs)(p.r,{loading:o,size:"l",children:[l?(0,R.jsx)(m.o,{error:l}):null,n?(0,R.jsx)(le,{data:n}):null]})}},90053:(e,t,a)=>{a.d(t,{E:()=>v});var n=a(8873),l=a(84476),s=a(24555),o=a(21334),r=a(77506),i=a(69063),d=a(48372);const c=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),u=(0,d.g4)("ydb-diagnostics-autorefresh-control",{en:c});var h=a(60712);const m=(0,r.cn)("auto-refresh-control");function v({className:e,onManualRefresh:t}){const a=(0,i.YQ)(),[r,d]=(0,i.Nt)();return(0,h.jsxs)("div",{className:m(null,e),children:[(0,h.jsx)(l.$,{view:"flat-secondary",onClick:()=>{a(o.F.util.invalidateTags(["All"])),null===t||void 0===t||t()},extraProps:{"aria-label":u("Refresh")},children:(0,h.jsx)(l.$.Icon,{children:(0,h.jsx)(n.A,{})})}),(0,h.jsxs)(s.l,{value:[String(r)],onUpdate:e=>{d(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,h.jsx)(s.l.Option,{value:"0",children:u("None")}),(0,h.jsx)(s.l.Option,{value:"15000",children:u("15 sec")}),(0,h.jsx)(s.l.Option,{value:"60000",children:u("1 min")}),(0,h.jsx)(s.l.Option,{value:"120000",children:u("2 min")}),(0,h.jsx)(s.l.Option,{value:"300000",children:u("5 min")})]})]})}}}]);