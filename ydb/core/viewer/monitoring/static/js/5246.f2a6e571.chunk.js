(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[5246],{94790:(e,t,a)=>{"use strict";a.d(t,{f:()=>l});var r=a(68963),s=a(44920),n=a(75859);const l=e=>{let{children:t,content:a,className:l,hasArrow:o=!0,placement:i=["top","bottom"],...d}=e;const[c,p]=r.useState(!1),u=r.useRef(null);return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)(s.G,{anchorRef:u,open:c,placement:i,hasArrow:o,...d,children:a}),(0,n.jsx)("span",{className:l,ref:u,onMouseEnter:()=>{p(!0)},onMouseLeave:()=>{p(!1)},children:t})]})}},63104:(e,t,a)=>{"use strict";a.d(t,{Y:()=>u});var r=a(54665),s=a(24362),n=a(52317),l=a(94790),o=a(74170),i=a(42784),d=a(27506),c=a(75859);const p=(0,s.cn)("tablet"),u=e=>{var t;let{tablet:a={},tenantName:s}=e;const{TabletId:u,NodeId:g,Type:h}=a,v=null===(t=a.Overall)||void 0===t?void 0:t.toLowerCase(),m=u&&(0,r.fK)(u,{nodeId:g,tenantName:s,type:h});return(0,c.jsx)(l.f,{className:p("wrapper"),content:(0,c.jsx)(d.Fb,{data:a,className:p("popup-content")}),children:(0,c.jsx)(o.h,{to:m,children:(0,c.jsx)(i.v,{className:p({status:v}),text:(0,n.qV)(a.Type)})})})}},55246:(e,t,a)=>{"use strict";a.r(t),a.d(t,{TabletsFilters:()=>L});var r=a(68963),s=a(2982),n=a(2418),l=a(99090),o=a.n(l),i=a(49352),d=a(83570),c=a.n(d),p=a(52846),u=a(95408),g=a(86969),h=a(26688),v=a(63104),m=a(79061),y=a(99337),f=a(99399),b=a(36313),j=a(87555);const x=[],w=(0,b.P1)(((e,t)=>{var a;return null===(a=(0,f.em)(e,t))||void 0===a?void 0:a.TabletStateInfo}),((e,t,a)=>a),((e,t,a,r)=>r),((e,t,a)=>{let r=null!==e&&void 0!==e?e:x;var s,n;a.length>0&&(r=null===(s=r)||void 0===s?void 0:s.filter((e=>a.some((t=>e.Type===t)))));t.length>0&&(r=null===(n=r)||void 0===n?void 0:n.filter((e=>t.some((t=>e.State===t)))));return r.length>0?r:x}),{argsMemoize:b.PP,argsMemoizeOptions:{equalityCheck:j.wU}});var N=a(24362),S=a(52317),I=a(17096),T=a(83496),K=a(30817);const A=JSON.parse('{"page.title":"Tablets"}'),P=JSON.parse('{"page.title":"\u0422\u0430\u0431\u043b\u0435\u0442\u043a\u0438"}'),F=(0,K.wZ)("ydb-tablets-filters-page",{en:A,ru:P});var C=a(75859);const Y=(0,N.cn)("tablets-filters"),k=u.z.preprocess((e=>Array.isArray(e)?e.filter(Boolean).sort():[]),u.z.string().array()),z=u.z.preprocess((e=>Array.isArray(e)?e.flatMap((e=>T.LV[e]||e)).filter(Boolean):[]),u.z.string().array()),O=220,D=300;function L(){var e;const[t,a]=(0,p.useQueryParams)({nodeIds:p.ArrayParam,type:p.ArrayParam,state:p.ArrayParam,path:p.StringParam,clusterName:p.StringParam}),n=null!==(e=t.path)&&void 0!==e?e:void 0,l=(0,I.zL)();r.useEffect((()=>{l((0,m.J)("tablets",{tenantName:n}))}),[l,n]);const d=k.parse(t.nodeIds),{currentData:u,isFetching:b,error:j}=f.zg.useGetTabletsInfoQuery({nodes:d,path:n},{pollingInterval:S.t_}),{data:x}=y.W.useGetNodesListQuery({},{pollingInterval:S.t_}),N=b&&void 0===u,K=z.parse(t.state),A=T.uk.map((e=>({value:e,content:e}))),P=k.parse(t.type),O=Array.from(new Set(...[o()(null===u||void 0===u?void 0:u.TabletStateInfo,(e=>e.Type))])).map((e=>({value:String(e),content:e}))),D=(0,I.ix)((e=>w(e,{nodes:d,path:n},K,P))),L=(e,t)=>(0,C.jsx)(v.Y,{tablet:D[e],tenantName:n},t),q=o()(x,(e=>({content:e.Id,value:String(e.Id),data:e.Host})));return(0,C.jsxs)(r.Fragment,{children:[(0,C.jsx)(i.ql,{children:(0,C.jsx)("title",{children:"".concat(F("page.title")," \u2014 ").concat(n||t.clusterName||S.DO)})}),N?(0,C.jsx)("div",{className:"loader",children:(0,C.jsx)(s.a,{size:"l"})}):j&&"object"===typeof j&&"status"in j&&403===j.status?(0,C.jsx)(g.J,{}):(0,C.jsxs)("div",{className:Y(),children:[n?(0,C.jsxs)("div",{className:Y("tenant"),children:[(0,C.jsx)("span",{className:Y("label"),children:"Database: "})," ",n]}):null,(0,C.jsx)(R,{nodesForSelect:q,nodeFilter:d,onChangeNodes:e=>a({nodeIds:e}),states:A,stateFilter:K,onChangeStates:e=>a({state:e}),types:O,typeFilter:P,onChangeTypes:e=>a({type:e})}),j?(0,C.jsx)(h.V,{error:j}):null,D.length>0?(0,C.jsx)("div",{className:Y("items"),children:(0,C.jsx)(c(),{itemRenderer:L,length:D.length,type:"uniform"})}):!j&&(0,C.jsx)("div",{className:Y("empty-message"),children:"no tablets"})]})]})}function R(e){let{nodesForSelect:t,nodeFilter:a,onChangeNodes:r,states:s,stateFilter:l,onChangeStates:o,types:i,typeFilter:d,onChangeTypes:c}=e;return(0,C.jsxs)("div",{className:Y("filters"),children:[(0,C.jsx)("div",{className:Y("filter-wrapper"),children:(0,C.jsx)(n.P,{multiple:!0,label:"Node ID",width:O,popupWidth:D,placeholder:"All",options:t,value:a,onUpdate:r,renderOption:e=>(0,C.jsxs)("div",{className:Y("node"),children:[(0,C.jsx)("div",{children:e.content}),(0,C.jsx)("div",{className:Y("node-meta"),title:e.data,children:e.data})]}),getOptionHeight:()=>40})}),(0,C.jsx)("div",{className:Y("filter-wrapper"),children:(0,C.jsx)(n.P,{multiple:!0,label:"multiple",width:O,placeholder:"All",options:s,value:l,onUpdate:o})}),(0,C.jsx)("div",{className:Y("filter-wrapper"),children:(0,C.jsx)(n.P,{multiple:!0,label:"Types",width:O,placeholder:"All",options:i,value:d,onUpdate:c})})]})}},99399:(e,t,a)=>{"use strict";a.d(t,{Sq:()=>p,em:()=>c,zg:()=>i});var r=a(36313),s=a(85690),n=a.n(s),l=a(905),o=a(99337);const i=l.h.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,t)=>{let{signal:a}=t;try{return{data:await window.api.getTabletsInfo(e,{signal:a})}}catch(r){return{error:r}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),d=(0,r.P1)((e=>e),(e=>i.endpoints.getTabletsInfo.select(e)),{argsMemoize:r.PP,argsMemoizeOptions:{equalityCheck:n()}}),c=(0,r.P1)((e=>e),((e,t)=>d(t)),((e,t)=>t(e).data)),p=(0,r.P1)(((e,t)=>c(e,t)),(e=>(0,o.d)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]))},83496:(e,t,a)=>{"use strict";a.d(t,{FW:()=>i,KR:()=>d,LV:()=>o,uk:()=>l});var r=a(75850),s=a(28164);const n={[s.g.Dead]:r.K.Red,[s.g.Created]:r.K.Yellow,[s.g.ResolveStateStorage]:r.K.Yellow,[s.g.Candidate]:r.K.Yellow,[s.g.BlockBlobStorage]:r.K.Yellow,[s.g.WriteZeroEntry]:r.K.Yellow,[s.g.Restored]:r.K.Yellow,[s.g.Discover]:r.K.Yellow,[s.g.Lock]:r.K.Yellow,[s.g.Stopped]:r.K.Yellow,[s.g.ResolveLeader]:r.K.Yellow,[s.g.RebuildGraph]:r.K.Yellow,[s.g.Deleted]:r.K.Green,[s.g.Active]:r.K.Green},l=Object.keys(s.g),o=Object.entries(n).reduce(((e,t)=>{let[a,r]=t;return e[r]?e[r].push(a):e[r]=[a],e}),{}),i=e=>{if(!e)return r.K.Grey;return t=e,Object.values(r.K).includes(t)?e:n[e];var t};function d(e){if(!e)return"unknown";switch(e){case s.g.Dead:return"danger";case s.g.Active:case s.g.Deleted:return"success";default:return"warning"}}},16484:(e,t,a)=>{var r=a(46067),s=a(75345);e.exports=function(e,t){var a=-1,n=s(e)?Array(e.length):[];return r(e,(function(e,r,s){n[++a]=t(e,r,s)})),n}},99090:(e,t,a)=>{var r=a(40341),s=a(67173),n=a(16484),l=a(46296);e.exports=function(e,t){return(l(e)?r:n)(e,s(t,3))}}}]);