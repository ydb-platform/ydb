"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[54229],{21545:(e,t,s)=>{s.d(t,{X:()=>i});var n=s(78034);const i=s(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:s},{signal:i})=>{try{const[a,r,o]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:s},{signal:i}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:i}),window.api.viewer.getNodesList({database:t},{signal:i})]),l=(0,n.nN)(o),d=Object.keys(r).reduce(((e,t)=>{var s;const n=null===(s=r[t])||void 0===s?void 0:s.TabletStateInfo;return null===n||void 0===n||n.forEach((s=>{var n;const{ChangeTime:i,Generation:a,State:r,Leader:o,FollowerId:d}=s,c=l&&t?null===(n=l.get(Number(t)))||void 0===n?void 0:n.Host:void 0;e.push({nodeId:t,generation:a,changeTime:i,state:r,leader:o,followerId:d,fqdn:c})})),e}),[]),{TabletStateInfo:c=[]}=a,u=void 0===s?c.find((e=>e.Leader)):c.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===s})),{TabletId:h}=u||{};return{data:{id:h,data:u,history:d}}}catch(a){return{error:a}}},providesTags:(e,t,s)=>["All",{type:"Tablet",id:s.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e,database:t},{signal:s})=>{try{const n=await window.api.viewer.getTabletDescribe(e,t,{signal:s}),{SchemeShard:i,PathId:a}=e;return{data:(null===n||void 0===n?void 0:n.Path)||`${i}:${a}`}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:s})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:s})}}catch(n){return{error:n}}},providesTags:(e,t,s)=>["All",{type:"Tablet",id:s.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,s)=>[{type:"Tablet",id:s.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(s){return{error:s}}},invalidatesTags:(e,t,s)=>[{type:"Tablet",id:s.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(s){return{error:s}}},invalidatesTags:(e,t,s)=>[{type:"Tablet",id:s.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,s)=>{s.d(t,{B:()=>d});var n=s(59284),i=s(80136),a=s(58611),r=s(55974),o=s(42829),l=s(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:s,dialogHeader:d,dialogText:c,retryButtonText:u,buttonDisabled:h=!1,buttonView:v="action",buttonClassName:p,withPopover:y=!1,popoverContent:m,popoverPlacement:g="right",popoverDisabled:x=!0}){const[b,f]=n.useState(!1),[j,w]=n.useState(!1),[S,C]=n.useState(!1),_=()=>(0,l.jsx)(i.$,{onClick:()=>f(!0),view:v,disabled:h,loading:!h&&j,className:p,children:e});return(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(r.g,{visible:b,header:d,text:c,withRetry:S,retryButtonText:u,onConfirm:async e=>{w(!0),await t(e)},onConfirmActionSuccess:async()=>{C(!1);try{await(null===s||void 0===s?void 0:s())}finally{w(!1)}},onConfirmActionError:e=>{C((0,o.D)(e)),w(!1)},onClose:()=>{f(!1)}}),y?(0,l.jsx)(a.A,{content:m,placement:g,disabled:x,children:(0,l.jsx)("span",{children:_()})}):_()]})}},27775:(e,t,s)=>{s.d(t,{i:()=>r});var n=s(52443),i=s(58267),a=s(60712);function r({state:e}){return(0,a.jsx)(n.J,{theme:(0,i._)(e),children:e})}},42829:(e,t,s)=>{s.d(t,{D:()=>n});const n=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},55974:(e,t,s)=>{s.d(t,{g:()=>x});var n=s(59284),i=s(18677),a=s(71153),r=s(48139),o=s(71989),l=s(47653),d=s(68774),c=s(77506),u=s(81288),h=s(48372);const v=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),p=(0,h.g4)("ydb-critical-action-dialog",{en:v});var y=s(60712);const m=(0,c.cn)("ydb-critical-dialog"),g=e=>{if((0,u.cH)(e)){if(403===e.status)return p("no-rights-error");if("string"===typeof e.data)return e.data;if((0,u._E)(e)&&e.data)return(0,y.jsx)(d.OI,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return p("default-error")};function x({visible:e,header:t,text:s,withRetry:d,retryButtonText:c,withCheckBox:u,onClose:h,onConfirm:v,onConfirmActionSuccess:x,onConfirmActionError:b}){const[f,j]=n.useState(!1),[w,S]=n.useState(),[C,_]=n.useState(!1),T=async e=>(j(!0),v(e).then((()=>{x(),h()})).catch((e=>{b(e),S(e)})).finally((()=>{j(!1)})));return(0,y.jsx)(o.l,{open:e,hasCloseButton:!1,className:m(),size:"s",onClose:h,onTransitionOutComplete:()=>{S(void 0),_(!1)},children:w?(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(o.l.Header,{caption:t}),(0,y.jsx)(o.l.Body,{className:m("body"),children:(0,y.jsxs)("div",{className:m("body-message",{error:!0}),children:[(0,y.jsx)("span",{className:m("error-icon"),children:(0,y.jsx)(i.A,{width:"24",height:"22"})}),g(w)]})}),(0,y.jsx)(o.l.Footer,{loading:!1,preset:"default",textButtonApply:d?c||p("button-retry"):void 0,textButtonCancel:p("button-close"),onClickButtonApply:()=>T(!0),onClickButtonCancel:h})]}):(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(o.l.Header,{caption:t}),(0,y.jsxs)(o.l.Body,{className:m("body"),children:[(0,y.jsxs)("div",{className:m("body-message",{warning:!0}),children:[(0,y.jsx)("span",{className:m("warning-icon"),children:(0,y.jsx)(l.I,{data:a.A,size:24})}),s]}),u?(0,y.jsx)(r.S,{checked:C,onUpdate:_,children:p("checkbox-text")}):null]}),(0,y.jsx)(o.l.Footer,{loading:f,preset:"default",textButtonApply:p("button-confirm"),textButtonCancel:p("button-cancel"),propsButtonApply:{type:"submit",disabled:u&&!C},onClickButtonCancel:h,onClickButtonApply:()=>T()})]})})}},68774:(e,t,s)=>{s.d(t,{tm:()=>O,OI:()=>k,vt:()=>B});var n=s(59284),i=s(45720),a=s(16929),r=s(71153),o=s(18677),l=s(32752),d=s(80136),c=s(60461),u=s(78540),h=s(47653),v=s(74529),p=s(77506),y=s(41650),m=s(71989),g=s(60712);function x({open:e,issues:t,hideSeverity:s,onClose:n,textButtonCancel:i="Close",size:a="m",caption:r}){return(0,g.jsxs)(m.l,{size:a,onClose:n,disableOutsideClick:!0,open:e,children:[(0,g.jsx)(m.l.Header,{caption:r}),(0,g.jsx)(m.l.Body,{children:(0,g.jsx)(O,{issues:t,hideSeverity:s})}),(0,g.jsx)(m.l.Footer,{textButtonCancel:i,onClickButtonCancel:n})]})}function b(e){return Array.isArray(e)&&e.length>0}function f(e){var t;return"string"===typeof e?[]:null!==e&&void 0!==e&&null!==(t=e.error)&&void 0!==t&&t.message?[{message:e.error.message,severity:e.error.severity,position:e.error.position,end_position:e.error.end_position,issue_code:e.error.issue_code,issues:Array.isArray(e.issues)?e.issues:[]}]:Array.isArray(e.issues)?e.issues:[]}var j=s(48372);const w=JSON.parse('{"action_show-details":"Show details","action_hide-details":"Hide details","action_close":"Close","action_show-full-message":"Show full message","field_code":"Code","field_position":"Position"}'),S=(0,j.g4)("issues",{en:w}),C=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function _(e){return function(e){return!!e&&void 0!==C[e]}(e)?C[e]:"S_INFO"}const T=(0,p.cn)("kv-result-issues"),N=(0,p.cn)("kv-issues"),A=(0,p.cn)("kv-issue");function I({message:e}){return(0,g.jsx)("div",{className:T("error-message"),children:e})}function k({data:e,hideSeverity:t}){const s=f(e),[i,a]=n.useState({});return"string"===typeof e?(0,g.jsx)(I,{message:e}):(0,g.jsx)("div",{className:T(),children:(0,g.jsx)(l.s,{direction:"column",gap:"2",children:s.map(((e,s)=>{const r=b(e.issues);return(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(F,{severity:_(e.severity),message:e.message||"",hideSeverity:t,hasIssues:r,expanded:i[s],onClick:()=>(e=>a((t=>({...t,[e]:!t[e]}))))(s)}),i[s]&&r&&(0,g.jsx)(O,{hideSeverity:t,issues:e.issues})]},s)}))})})}function B({data:e,hideSeverity:t}){const s=f(e),[i,a]=n.useState(!1),[r,o]=n.useState(null);return"string"===typeof e?(0,g.jsx)(I,{message:e}):(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)("div",{className:T(),children:(0,g.jsx)(l.s,{direction:"column",gap:"2",children:s.map(((e,s)=>{const n=b(e.issues);return(0,g.jsx)(F,{severity:_(e.severity),message:e.message||"",hideSeverity:t,hasIssues:n,onClick:()=>{return t=e.issues,o(null!==t&&void 0!==t?t:[]),void a(!0);var t}},s)}))})}),(0,g.jsx)(x,{open:i,issues:null!==r&&void 0!==r?r:[],hideSeverity:t,onClose:()=>a(!1),textButtonCancel:S("action_close")})]})}function F({severity:e,message:t,hideSeverity:s,hasIssues:n,expanded:i,onClick:a}){const r=S(i?"action_hide-details":"action_show-details");return(0,g.jsxs)("div",{className:T("error-message"),children:[s?null:(0,g.jsx)(H,{severity:e}),(0,g.jsx)("span",{className:T("error-message-text"),children:t}),n&&(0,g.jsx)(d.$,{view:"normal",size:"s",onClick:a,children:r})]})}function O({issues:e,hideSeverity:t}){const s=function(e){return null===e||void 0===e?void 0:e.reduce(((e,t)=>{var s;const n=null!==(s=t.severity)&&void 0!==s?s:10;return Math.min(e,n)}),10)}(e);return(0,g.jsx)("div",{className:N(null),children:null===e||void 0===e?void 0:e.map(((e,n)=>(0,g.jsx)(L,{hideSeverity:t,issue:e,expanded:e.severity===s},n)))})}function L({issue:e,hideSeverity:t,level:s=0}){const[i,a]=n.useState(!0),r=_(e.severity),o=e.issues,l=b(o),u=i?"bottom":"right";return(0,g.jsxs)("div",{className:A({leaf:!l,"has-issues":l}),children:[(0,g.jsxs)("div",{className:A("line"),children:[l&&(0,g.jsx)(d.$,{view:"flat-secondary",onClick:()=>a(!i),className:A("arrow-toggle"),children:(0,g.jsx)(c.I,{direction:u,size:16})}),t?null:(0,g.jsx)(H,{severity:r}),(0,g.jsx)(q,{issue:e}),e.issue_code?(0,g.jsxs)("span",{className:A("code"),children:[S("field_code"),": ",e.issue_code]}):null]}),l&&i&&(0,g.jsx)("div",{className:A("issues"),children:(0,g.jsx)(P,{issues:o,level:s+1,expanded:i})})]})}function q({issue:e}){var t;const s=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,y.kf)(t.row))return"";const{row:s,column:n}=t;return(0,y.kf)(n)?`${s}:${n}`:`line ${s}`}(e),n=window.ydbEditor,i=()=>(0,g.jsxs)("span",{className:A("message"),children:[s&&(0,g.jsx)("span",{className:A("place-text"),title:S("field_position"),children:s}),(0,g.jsx)("div",{className:A("message-text"),children:(0,g.jsx)(v.A,{value:e.message,expandLabel:S("action_show-full-message")})})]}),{row:a,column:r}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,y.kf)(a)&&n))return i();return(0,g.jsx)(u.N,{href:"#",onClick:()=>{const e={lineNumber:a,column:null!==r&&void 0!==r?r:0};n.setPosition(e),n.revealPositionInCenterIfOutsideViewport(e),n.focus()},view:"primary",draggable:!1,children:i()})}function P(e){const{issues:t,level:s,expanded:n}=e;return(0,g.jsx)("div",{className:A("list"),children:t.map(((e,t)=>(0,g.jsx)(L,{issue:e,level:s,expanded:n},t)))})}const R={S_INFO:i.A,S_WARNING:a.A,S_ERROR:r.A,S_FATAL:o.A},E=(0,p.cn)("yql-issue-severity");function H({severity:e}){const t=e.slice(2).toLowerCase();return(0,g.jsxs)("span",{className:E({severity:t}),children:[(0,g.jsx)(h.I,{className:E("icon"),data:R[e]}),(0,g.jsx)("span",{className:E("title"),children:t})]})}},74529:(e,t,s)=>{s.d(t,{A:()=>h});var n=s(59284),i=s(78540),a=s(77506),r=s(48372);const o=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),l=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,r.g4)("ydb-shorty-string",{ru:l,en:o});var c=s(60712);const u=(0,a.cn)("kv-shorty-string");function h({value:e="",limit:t=200,strict:s=!1,displayLength:a=!0,render:r=e=>e,onToggle:o,expandLabel:l=d("default_expand_label"),collapseLabel:h=d("default_collapse_label")}){const[v,p]=n.useState(!1),y=(v?h:l)+(a&&!v?d("chars_count",{count:e.length}):""),m=e.length>t+(s?0:y.length),g=v||!m?e:e.slice(0,t-4)+"\xa0...";return(0,c.jsxs)("div",{className:u(),children:[r(g),m?(0,c.jsx)(i.N,{className:u("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),p((e=>!e)),null===o||void 0===o||o()},children:y}):null]})}}}]);