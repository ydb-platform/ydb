"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[5558],{8659:(e,t,a)=>{a.d(t,{P:()=>y});var s=a(54665),n=a(14146),i=a(17880),l=a(5922),d=a(81854),r=a(24362),o=a(34301),c=a(48169),u=a(17096),v=a(69214),p=a(23373),h=a(32270),m=a(67359),b=a(30817);const g=JSON.parse('{"decomission-status":"Decomission Status","type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),N=(0,b.wZ)("ydb-pDisk-info",{en:g});var x=a(75859);const j=(0,r.cn)("ydb-pdisk-info");function y(e){let{pDisk:t,nodeId:a,withPDiskPageLink:r,className:b}=e;const g=(0,u.ix)(n.VH),y=(0,i.X_)(),[I,k,f,D]=function(e){let{pDisk:t,nodeId:a,withPDiskPageLink:n,isUserAllowedToMakeChanges:i}=e;const{PDiskId:r,Path:u,Guid:p,Category:b,Type:g,Device:y,Realtime:I,State:k,SerialNumber:f,TotalSize:D,AllocatedSize:w,DecommitStatus:T,StatusV2:S,NumActiveSlots:P,ExpectedSlotCount:z,LogUsedSize:V,LogTotalSize:A,SystemSize:C,SharedWithOs:E}=t||{},q=[];(0,l.D)(T)&&q.push({label:N("decomission-status"),value:T.replace("DECOMMIT_","")}),(0,l.D)(b)&&q.push({label:N("type"),value:g}),(0,l.D)(u)&&q.push({label:N("path"),value:u}),(0,l.D)(p)&&q.push({label:N("guid"),value:p}),f&&q.push({label:N("serial-number"),value:f}),(0,l.D)(E)&&q.push({label:N("shared-with-os"),value:N("yes")});const R=[];(0,l.D)(S)&&R.push({label:N("drive-status"),value:S}),(0,l.D)(k)&&R.push({label:N("state"),value:k}),(0,l.D)(y)&&R.push({label:N("device"),value:(0,x.jsx)(v.A,{status:y})}),(0,l.D)(I)&&R.push({label:N("realtime"),value:(0,x.jsx)(v.A,{status:I})});const L=[];L.push({label:N("space"),value:(0,x.jsx)(m.y,{value:w,capacity:D,formatValues:o.q3,colorizeProgress:!0})}),(0,l.D)(P)&&(0,l.D)(z)&&L.push({label:N("slots"),value:(0,x.jsx)(m.y,{value:P,capacity:z})}),(0,l.D)(V)&&(0,l.D)(A)&&L.push({label:N("log-size"),value:(0,x.jsx)(m.y,{value:V,capacity:A,formatValues:o.q3})}),(0,l.D)(C)&&L.push({label:N("system-size"),value:(0,d.td)({value:C})});const _=[];if((n||i)&&(0,l.D)(r)&&(0,l.D)(a)){const e=(0,s.ds)(r,a),t=(0,c.ok)({nodeId:a,pDiskId:r});_.push({label:N("links"),value:(0,x.jsxs)("span",{className:j("links"),children:[n&&(0,x.jsx)(h.j,{title:N("pdisk-page"),url:e,external:!1}),i&&(0,x.jsx)(h.j,{title:N("developer-ui"),url:t})]})})}return[q,R,L,_]}({pDisk:t,nodeId:a,withPDiskPageLink:r&&y,isUserAllowedToMakeChanges:g});return(0,x.jsxs)("div",{className:j("wrapper",b),children:[(0,x.jsxs)("div",{className:j("col"),children:[(0,x.jsx)(p._,{info:I,renderEmptyState:()=>null}),(0,x.jsx)(p._,{info:f,renderEmptyState:()=>null})]}),(0,x.jsxs)("div",{className:j("col"),children:[(0,x.jsx)(p._,{info:k,renderEmptyState:()=>null}),(0,x.jsx)(p._,{info:D,renderEmptyState:()=>null})]})]})}},97482:(e,t,a)=>{a.d(t,{f:()=>l});var s=a(14979),n=a(83496),i=a(75859);function l(e){let{state:t}=e;return(0,i.jsx)(s._,{theme:(0,n.KR)(t),children:t})}},12199:(e,t,a)=>{a.d(t,{$:()=>r});var s=a(24362),n=a(75859);const i=(0,s.cn)("tag"),l=e=>{let{text:t,type:a}=e;return(0,n.jsx)("div",{className:i({type:a}),children:t})},d=(0,s.cn)("tags"),r=e=>{let{tags:t,tagsType:a,className:s=""}=e;return(0,n.jsx)("div",{className:d(null,s),children:t&&t.map(((e,t)=>(0,n.jsx)(l,{text:e,type:a},t)))})}},72473:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>be,STORAGE_ROLE:()=>me});var s=a(68963),n=a(8179),i=a(49352),l=a(86974),d=a(83203),r=a(50422),o=a(39683),c=a(88776),u=a(24362),v=a(48169),p=a(69214),h=a(12199),m=a(75859);const b=(0,u.cn)("basic-node-viewer"),g=e=>{let t,{node:a,additionalNodesProps:n,className:i}=e;return null!==n&&void 0!==n&&n.getNodeRef?t=n.getNodeRef(a)+"internal":a.NodeId&&(t=(0,v.wq)(a.NodeId)+"internal"),(0,m.jsx)("div",{className:b(null,i),children:a?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:b("title"),children:"Node"}),(0,m.jsx)(p.A,{status:a.SystemState,name:a.Host}),t&&(0,m.jsx)("a",{rel:"noopener noreferrer",className:b("link",{external:!0}),href:t,target:"_blank",children:(0,m.jsx)(c.J,{data:o.Z})}),(0,m.jsxs)("div",{className:b("id"),children:[(0,m.jsx)("label",{className:b("label"),children:"NodeID"}),(0,m.jsx)("label",{children:a.NodeId})]}),a.DC&&(0,m.jsx)(h.$,{tags:[a.DC]}),a.Roles&&(0,m.jsx)(h.$,{tags:a.Roles,tagsType:"blue"})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var N=a(26688),x=a(52317),j=a(23373);const y=(0,u.cn)("ydb-pool-usage"),I=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},k=e=>{let{data:t={}}=e;const{Threads:a,Name:s="Unknown",Usage:n=0}=t,i=n&&a,l=Math.floor(100*n),d=l>100?100:l;return(0,m.jsxs)("div",{className:y(),children:[(0,m.jsxs)("div",{className:y("info"),children:[(0,m.jsx)("div",{className:y("pool-name"),children:s}),i&&(0,m.jsxs)("div",{className:y("value"),children:[(0,m.jsxs)("div",{className:y("percents"),children:[l<1?"<1":l,"%"]}),(0,m.jsxs)("div",{className:y("threads"),children:["(\xd7",a,")"]})]})]}),(0,m.jsx)("div",{className:y("visual"),children:(0,m.jsx)("div",{className:y("usage-line",{type:I(d)}),style:{width:"".concat(d,"%")}})})]})};var f=a(67359);const D=(0,u.cn)("full-node-viewer"),w=e=>{var t,a,s,n;let{node:i,className:l}=e;const d=null===i||void 0===i||null===(t=i.Endpoints)||void 0===t?void 0:t.map((e=>{let{Name:t,Address:a}=e;return{label:t,value:a}})),r=[];null!==i&&void 0!==i&&null!==(a=i.Tenants)&&void 0!==a&&a.length&&r.push({label:"Database",value:i.Tenants[0]}),r.push({label:"Version",value:null===i||void 0===i?void 0:i.Version},{label:"Uptime",value:null===i||void 0===i?void 0:i.Uptime},{label:"DC",value:(null===i||void 0===i?void 0:i.DataCenterDescription)||(null===i||void 0===i?void 0:i.DC)},{label:"Rack",value:null===i||void 0===i?void 0:i.Rack});const o=null===i||void 0===i||null===(s=i.LoadAveragePercents)||void 0===s?void 0:s.map(((e,t)=>({label:x.x5[t],value:(0,m.jsx)(f.y,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,m.jsx)("div",{className:"".concat(D()," ").concat(l),children:i?(0,m.jsxs)("div",{className:D("common-info"),children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:D("section-title"),children:"Pools"}),(0,m.jsx)("div",{className:D("section",{pools:!0}),children:null===i||void 0===i||null===(n=i.PoolStats)||void 0===n?void 0:n.map(((e,t)=>(0,m.jsx)(k,{data:e},t)))})]}),d&&d.length&&(0,m.jsx)(j._,{title:"Endpoints",className:D("section"),info:d}),(0,m.jsx)(j._,{title:"Common info",className:D("section"),info:r}),(0,m.jsx)(j._,{title:"Load average",className:D("section",{average:!0}),info:o})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var T=a(62776),S=a(54665),P=a(79061),z=a(71698),V=a(17096),A=a(70885),C=a(42635),E=a(92398),q=a(92820),R=a(85198),L=a.n(R),_=a(36313),F=a(34301),O=a(3764);const U=(0,_.P1)((e=>e),(e=>z.N.endpoints.getNodeStructure.select({nodeId:e}))),Z=(0,_.P1)((e=>e),((e,t)=>U(t)),((e,t)=>t(e).data)),G=(0,_.P1)(((e,t)=>Number(t)),((e,t)=>Z(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,s={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var n;const i=null===(n=a.VDisks)||void 0===n?void 0:n.filter((t=>t.NodeId===e)).map(O.w);null===i||void 0===i||i.forEach((a=>{const n=(0,F.a2)(a.VDiskId),i=(0,O.b)(a.PDisk),l=i.PDiskId;s[String(l)]||(s[String(l)]={vDisks:{},...i}),s[String(l)].vDisks[n]={...a,PDiskId:l,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(s).reduce(((e,t)=>{const a=s[t].vDisks,n=Object.keys(a).reduce(((e,t,s)=>(e.push({...a[t],id:t,order:s}),e)),[]);return e[t]={...s[t],vDisks:n},e}),{})}));var J=a(67585),M=a(19812),H=a(17176),B=a(68330),K=a(33569),Q=a(8659),Y=a(22200),$=a(75850),W=a(17632),X=a(5922),ee=a(30817);const te=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),ae=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),se=(0,ee.wZ)("ydb-node-page",{en:te,ru:ae}),ne=(0,u.cn)("kv-node-structure");function ie(e){let{label:t,value:a,className:s}=e;return(0,m.jsxs)("span",{className:ne("pdisk-title-item",s),children:[t&&(0,m.jsxs)("span",{className:ne("pdisk-title-item-label"),children:[t,":"]}),(0,m.jsx)("span",{className:ne("pdisk-title-item-value"),children:a})]})}const le=(0,u.cn)("kv-node-structure");var de;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(de||(de={}));const re={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function oe(e){let{pDiskId:t,selectedVdiskId:a,nodeId:s}=e;return[{name:de.slotId,header:re[de.slotId],width:100,render:e=>{let{row:n}=e;const i=n.VDiskSlotId;let l=null;return(0,X.D)(s)&&(0,X.D)(t)&&(0,X.D)(i)&&(l=(0,v.yf)({nodeId:s,pDiskId:t,vDiskSlotId:i})),(0,m.jsxs)("div",{className:le("vdisk-id",{selected:n.id===a}),children:[(0,m.jsx)("span",{children:i}),l&&(0,m.jsx)(H.z,{size:"s",className:le("external-button",{hidden:!0}),href:l,target:"_blank",title:se("vdisk.developer-ui-button-title"),children:(0,m.jsx)(c.J,{data:o.Z})})]})},align:M.ZP.LEFT},{name:de.VDiskState,header:re[de.VDiskState],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(p.A,{status:t.VDiskState===W.H.OK?$.K.Green:$.K.Red})},sortAccessor:e=>e.VDiskState===W.H.OK?1:0,align:M.ZP.CENTER},{name:de.Size,header:re[de.Size],width:100,render:e=>{let{row:t}=e;return(0,m.jsx)(f.y,{value:t.AllocatedSize,capacity:Number(t.AllocatedSize)+Number(t.AvailableSize),formatValues:F.q3,colorizeProgress:!0})},sortAccessor:e=>Number(e.AllocatedSize),align:M.ZP.CENTER},{name:de.Info,header:re[de.Info],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(B.J,{placement:["right"],content:(0,m.jsx)(Y.K,{data:t,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:le("vdisk-details"),children:(0,m.jsx)(H.z,{view:"flat-secondary",className:le("vdisk-details-button",{selected:t.id===a}),children:(0,m.jsx)(c.J,{data:J.Z,size:18})})})},sortable:!1}]}function ce(e){let{id:t,data:a,selectedVdiskId:n,nodeId:i,unfolded:l}=e;const[d,r]=s.useState(null!==l&&void 0!==l&&l),{TotalSize:o=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:h,vDisks:b}=a,g=Number(o),N=Number(c);return(0,m.jsxs)("div",{className:le("pdisk"),id:t,children:[(0,m.jsxs)("div",{className:le("pdisk-header"),children:[(0,m.jsxs)("div",{className:le("pdisk-title-wrapper"),children:[(0,m.jsx)(p.A,{status:u}),(0,m.jsx)(ie,{label:"PDiskID",value:v,className:le("pdisk-title-id")}),(0,m.jsx)(ie,{value:h,className:le("pdisk-title-type")}),(0,m.jsx)(f.y,{value:g-N,capacity:g,formatValues:F.q3,colorizeProgress:!0,className:le("pdisk-title-size")}),(0,m.jsx)(ie,{label:"VDisks",value:b.length})]}),(0,m.jsx)(H.z,{onClick:d?()=>{r(!1)}:()=>{r(!0)},view:"flat-secondary",children:(0,m.jsx)(K.F,{direction:d?"top":"bottom"})})]}),d&&(L()(a)?(0,m.jsx)("div",{children:"No information about PDisk"}):(0,m.jsxs)("div",{children:[(0,m.jsx)(Q.P,{pDisk:a,nodeId:i,className:le("pdisk-details"),withPDiskPageLink:!0}),(0,m.jsxs)("div",{className:le("vdisks-container"),children:[(0,m.jsx)("div",{className:le("vdisks-header"),children:"VDisks"}),(0,m.jsx)(M.ZP,{theme:"yandex-cloud",data:b,columns:oe({nodeId:i,pDiskId:v,selectedVdiskId:n}),settings:{...x.LE,dynamicRender:!1},rowClassName:e=>e.id===n?le("selected-vdisk"):""})]})]}))]})}const ue=(0,u.cn)("kv-node-structure");function ve(e){let{type:t,id:a}=e;return"".concat(t,"-").concat(a)}const pe=function(e){let{nodeId:t,className:a}=e;const n=(0,V.ix)((e=>G(e,t))),[i]=(0,V.Rj)(),{currentData:l,isFetching:d,error:r}=z.N.useGetNodeStructureQuery({nodeId:t},{pollingInterval:i}),o=d&&void 0===l,{pdiskId:c,vdiskId:u}=q.parse(window.location.href,!0).query,v=s.useRef(null),p=s.useRef(!1);return s.useEffect((()=>{if(!L()(n)&&!p.current&&v.current){const t=document.getElementById(ve({type:"pdisk",id:c}));let a=0;if(u){var e;const t=null===(e=n[c])||void 0===e?void 0:e.vDisks,s=null===t||void 0===t?void 0:t.find((e=>e.id===u)),i=s?document.querySelector(".data-table"):void 0,l=(null===s||void 0===s?void 0:s.order)||0;i&&(a+=i.offsetTop+40*l)}t&&(v.current.scrollTo({behavior:"smooth",top:a||t.offsetTop}),p.current=!0)}}),[n,c,u]),(0,m.jsxs)("div",{className:ue(),ref:v,children:[r?(0,m.jsx)(N.V,{error:r,className:ue("error")}):null,(0,m.jsx)("div",{className:a,children:o?(0,m.jsx)(T.a,{size:"m"}):r&&!l?null:(()=>{const e=Object.keys(n);return e.length>0?e.map((e=>(0,m.jsx)(ce,{data:n[e],id:ve({type:"pdisk",id:e}),unfolded:c===e,selectedVdiskId:u,nodeId:t},e))):"There is no information about node structure."})()})]})},he=(0,u.cn)("node"),me="Storage";function be(e){var t,a;const o=s.useRef(null),c=(0,V.zL)(),u=(0,l.TH)(),v=null!==(t=(0,l.$B)(S.ZP.node))&&void 0!==t?t:Object.create(null),{id:p,activeTab:h}=v.params,{tenantName:b}=(0,S.mB)(u),[x]=(0,V.Rj)(),{currentData:j,isFetching:y,error:I}=z.N.useGetNodeInfoQuery({nodeId:p},{pollingInterval:x}),k=y&&void 0===j,f=j,{activeTabVerified:D,nodeTabs:q}=s.useMemo((()=>{var e;const t=((null===f||void 0===f||null===(e=f.Roles)||void 0===e?void 0:e.find((e=>e===me)))?E.ZJ:E.ZJ.filter((e=>e.id!==E.P_))).map((e=>({...e,title:e.name})));let a=t.find((e=>{let{id:t}=e;return t===h}));return a||(a=t[0]),{activeTabVerified:a,nodeTabs:t}}),[h,f]),R=(null===f||void 0===f||null===(a=f.Tenants)||void 0===a?void 0:a[0])||(null===b||void 0===b?void 0:b.toString());let L;if(f){var _;const e=!(null!==f&&void 0!==f&&null!==(_=f.Tenants)&&void 0!==_&&_[0]);L=e?"Storage":"Compute"}s.useEffect((()=>{c((0,P.J)("node",{tenantName:R,nodeRole:L,nodeId:p}))}),[c,R,p,L]);const F=()=>{switch(D.id){case E.P_:return(0,m.jsx)("div",{className:he("storage"),children:(0,m.jsx)(A.V,{nodeId:p,parentContainer:o.current})});case E.IA:return(0,m.jsx)(C.J,{nodeId:p,database:R,className:he("node-page-wrapper")});case E.mD:return(0,m.jsx)(w,{node:f,className:he("overview-wrapper")});case E.pV:return(0,m.jsx)(pe,{className:he("node-page-wrapper"),nodeId:p});default:return!1}};return k?(0,m.jsx)(T.a,{size:"l"}):f?(0,m.jsxs)("div",{className:he(null,e.className),ref:o,children:[(0,m.jsx)(i.ql,{titleTemplate:"%s \u2014 ".concat(f.Host," \u2014 YDB Monitoring"),defaultTitle:"".concat(f.Host," \u2014 YDB Monitoring"),children:(0,m.jsx)("title",{children:D.title})}),(0,m.jsx)(g,{node:f,additionalNodesProps:e.additionalNodesProps,className:he("header")}),I?(0,m.jsx)(N.V,{error:I,className:he("error")}):null,(0,m.jsxs)("div",{className:he("tabs"),children:[(0,m.jsx)(n.m,{size:"l",items:q,activeTab:D.id,wrapTo:(e,t)=>{let{id:a}=e;return(0,m.jsx)(d.rU,{to:(0,S.ax)(S.ZP.node,{id:p,activeTab:a},{tenantName:R}),className:he("tab"),children:t},a)},allowNotSelected:!0}),(0,m.jsx)(r.q,{})]}),(0,m.jsx)("div",{className:he("content"),children:F()})]}):I?(0,m.jsx)(N.V,{error:I}):(0,m.jsx)("div",{className:"error",children:"no node data"})}},42635:(e,t,a)=>{a.d(t,{J:()=>U});var s=a(66950),n=a(10288),i=a(88776),l=a(17095),d=a(14659),r=a(41919),o=a(69214),c=a(26688),u=a(74170),v=a(2098),p=a(22692),h=a(97482),m=a(54665),b=a(14146),g=a(76386),N=a(36313),x=a(85690),j=a.n(x),y=a(905),I=a(99337);const k=y.h.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,t)=>{let{signal:a}=t;try{return{data:await window.api.getTabletsInfo(e,{signal:a})}}catch(s){return{error:s}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),f=(0,N.P1)((e=>e),(e=>k.endpoints.getTabletsInfo.select(e)),{argsMemoize:N.PP,argsMemoizeOptions:{equalityCheck:j()}}),D=(0,N.P1)((e=>e),((e,t)=>f(t)),((e,t)=>t(e).data)),w=(0,N.P1)(((e,t)=>D(e,t)),(e=>(0,I.d)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]));var T=a(28164),S=a(24362),P=a(52317),z=a(34301),V=a(48169),A=a(17096),C=a(92398),E=a(30817);const q=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),R=(0,E.wZ)("ydb-tablets",{en:q});var L=a(75859);const _=(0,S.cn)("tablets");function F(e){let{database:t}=e;return[{name:"Type",get header(){return R("Type")},render:e=>{let{row:t}=e;const a=!1===t.Leader;return(0,L.jsxs)("span",{children:[t.Type," ",a?(0,L.jsx)(n.x,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return R("Tablet")},render:e=>{var a;let{row:s}=e;if(!s.TabletId)return P.jX;const n=(0,m.fK)(s.TabletId,{nodeId:s.NodeId,type:s.Type,tenantName:t});return(0,L.jsx)(o.A,{name:null===(a=s.TabletId)||void 0===a?void 0:a.toString(),path:n,hasClipboardButton:!0,showStatus:!1,additionalControls:(0,L.jsx)(r.Q,{href:(0,V.wz)(s.TabletId)})})}},{name:"State",get header(){return R("State")},render:e=>{let{row:t}=e;return(0,L.jsx)(h.f,{state:t.State})}},{name:"NodeId",get header(){return R("Node ID")},render:e=>{let{row:t}=e;const a=void 0===t.NodeId?void 0:(0,C.a3)(t.NodeId);return(0,L.jsx)(u.h,{to:a,children:t.NodeId})},align:"right"},{name:"fqdn",get header(){return R("Node FQDN")},render:e=>{let{row:t}=e;return t.fqdn?(0,L.jsx)(o.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,L.jsx)("span",{children:"\u2014"})}},{name:"Generation",get header(){return R("Generation")},align:"right"},{name:"Uptime",get header(){return R("Uptime")},render:e=>{let{row:t}=e;return(0,z.fG)(t.ChangeTime)},sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:e=>{let{row:t}=e;return(0,L.jsx)(O,{...t})}}]}function O(e){const t=e.State===T.g.Stopped,a=(0,A.ix)(b.VH),[n]=g._.useKillTabletMutation(),l=e.TabletId;return l?(0,L.jsx)(d.U,{buttonView:"outlined",dialogContent:R("dialog.kill"),onConfirmAction:()=>n({id:l}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:R("controls.kill-not-allowed"),popoverDisabled:a,children:(0,L.jsx)(i.J,{data:s.Z})}):null}function U(e){let{nodeId:t,path:a,database:s,className:n}=e;const[i]=(0,A.Rj)();let d={};const r=void 0===t?void 0:String(t);void 0!==r?d={nodeId:r,database:s}:a&&(d={path:a,database:s});const{currentData:o,isFetching:u,error:h}=k.useGetTabletsInfoQuery(0===Object.keys(d).length?l.CN:d,{pollingInterval:i}),m=u&&void 0===o,b=(0,A.ix)((e=>w(e,d)));return m?(0,L.jsx)(p.h,{}):(0,L.jsxs)("div",{className:_(null,n),children:[h?(0,L.jsx)(c.V,{error:h}):null,o?(0,L.jsx)(v.G,{columns:F({database:s}),data:b,settings:P.LE,emptyDataMessage:R("noTabletsData")}):null]})}},71698:(e,t,a)=>{a.d(t,{N:()=>l});var s=a(905),n=a(51688);const i=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,n.Ns)(a)},l=s.h.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{const e=await window.api.getNodeInfo(a,{signal:s});return{data:i(e)}}catch(n){return{error:n}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{return{data:await window.api.getStorageInfo({nodeId:a},{signal:s})}}catch(n){return{error:n}}},providesTags:["All"]})}),overrideExisting:"throw"})},76386:(e,t,a)=>{a.d(t,{_:()=>n});var s=a(51688);const n=a(905).h.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async(e,t)=>{let{id:a,database:n,nodeId:i}=e,{signal:l}=t;try{const[e,t,d]=await Promise.all([window.api.getTablet({id:a,database:n,nodeId:i},{signal:l}),window.api.getTabletHistory({id:a,database:n,nodeId:i},{signal:l}),window.api.getNodesList({signal:l})]),r=(0,s.dn)(d),o=Object.keys(t).reduce(((e,a)=>{var s;const n=null===(s=t[a])||void 0===s?void 0:s.TabletStateInfo;if(n&&n.length){const t=n.find((e=>e.Leader))||n[0],{ChangeTime:s,Generation:i,State:l,Leader:d,FollowerId:o}=t,c=r&&a?r.get(Number(a)):void 0;"Dead"!==l&&e.push({nodeId:a,generation:i,changeTime:s,state:l,leader:d,followerId:o,fqdn:c})}return e}),[]),{TabletStateInfo:c=[]}=e,[u={}]=c,{TabletId:v}=u;return{data:{id:v,data:u,history:o}}}catch(d){return{error:d}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async(e,t)=>{let{tenantId:a}=e,{signal:s}=t;try{const e=await window.api.getTabletDescribe(a,{signal:s}),{SchemeShard:t,PathId:n}=a;return{data:(null===e||void 0===e?void 0:e.Path)||"".concat(t,":").concat(n)}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async(e,t)=>{let{id:a,hiveId:s}=e,{signal:n}=t;try{return{data:await window.api.getTabletFromHive({id:a,hiveId:s},{signal:n})}}catch(i){return{error:i}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async e=>{let{id:t}=e;try{return{data:await window.api.killTablet(t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.stopTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.resumeTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},66950:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(68963);const n=e=>s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.501 6.501 0 0 0-6.445 5.649.75.75 0 1 0 1.488.194A5.001 5.001 0 0 1 11.57 4.5h-1.32a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 .75-.75v-3a.75.75 0 0 0-1.5 0v1.06A6.48 6.48 0 0 0 8 1.5Zm-5.25 13a.75.75 0 0 1-.75-.75v-3a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H4.43a5.001 5.001 0 0 0 8.528-2.843.75.75 0 1 1 1.487.194A6.501 6.501 0 0 1 3.5 12.691v1.059a.75.75 0 0 1-.75.75Z",clipRule:"evenodd"}))}}]);