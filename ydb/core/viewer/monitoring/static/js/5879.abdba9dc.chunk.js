"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[5879],{66498:(e,t,a)=>{a.d(t,{a:()=>s.a});var s=a(41989)},50377:(e,t,a)=>{a.d(t,{P:()=>N});var s=a(79777),i=a(46878),l=a(65e3),n=a(25665),r=a(10142),d=a(99294),o=a(38980),c=a(70340),u=a(55842),v=a(43862),p=a(90808),h=a(20760),m=a(73287),g=a(37711);const b=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),x=(0,g.wZ)("ydb-pDisk-info",{en:b});var j=a(10161);const k=(0,d.cn)("ydb-pdisk-info");function N(e){let{pDisk:t,nodeId:a,withPDiskPageLink:d,className:g}=e;const b=(0,u.ix)(l.VH),[N,y,f,I]=function(e){let{pDisk:t,nodeId:a,withPDiskPageLink:s,isUserAllowedToMakeChanges:l}=e;const{PDiskId:d,Path:u,Guid:v,Category:g,Type:b,Device:N,Realtime:y,State:f,SerialNumber:I,TotalSize:w,AllocatedSize:D,StatusV2:S,NumActiveSlots:T,ExpectedSlotCount:P,LogUsedSize:z,LogTotalSize:V,SystemSize:A,SharedWithOs:C}=t||{},E=[];(0,n.D)(g)&&E.push({label:x("type"),value:b}),(0,n.D)(u)&&E.push({label:x("path"),value:u}),(0,n.D)(v)&&E.push({label:x("guid"),value:v}),I&&E.push({label:x("serial-number"),value:I}),(0,n.D)(C)&&E.push({label:x("shared-with-os"),value:x("yes")});const q=[];(0,n.D)(S)&&q.push({label:x("drive-status"),value:S}),(0,n.D)(f)&&q.push({label:x("state"),value:f}),(0,n.D)(N)&&q.push({label:x("device"),value:(0,j.jsx)(m.J,{status:N})}),(0,n.D)(y)&&q.push({label:x("realtime"),value:(0,j.jsx)(m.J,{status:y})});const R=[];R.push({label:x("space"),value:(0,j.jsx)(h.y,{value:D,capacity:w,formatValues:o.q3,colorizeProgress:!0})}),(0,n.D)(T)&&(0,n.D)(P)&&R.push({label:x("slots"),value:(0,j.jsx)(h.y,{value:T,capacity:P})}),(0,n.D)(z)&&(0,n.D)(V)&&R.push({label:x("log-size"),value:(0,j.jsx)(h.y,{value:z,capacity:V,formatValues:o.q3})}),(0,n.D)(A)&&R.push({label:x("system-size"),value:(0,r.td)({value:A})});const L=[];if((s||l)&&(0,n.D)(d)&&(0,n.D)(a)){const e=(0,i.ds)(d,a),t=(0,c.ok)({nodeId:a,pDiskId:d});L.push({label:x("links"),value:(0,j.jsxs)("span",{className:k("links"),children:[s&&(0,j.jsx)(p.j,{title:x("pdisk-page"),url:e,external:!1}),l&&(0,j.jsx)(p.j,{title:x("developer-ui"),url:t})]})})}return[E,q,R,L]}({pDisk:t,nodeId:a,withPDiskPageLink:d,isUserAllowedToMakeChanges:b});return(0,j.jsxs)(s.k,{className:g,gap:2,direction:"row",wrap:!0,children:[(0,j.jsxs)(s.k,{direction:"column",gap:2,width:500,children:[(0,j.jsx)(v._,{info:N,renderEmptyState:()=>null}),(0,j.jsx)(v._,{info:f,renderEmptyState:()=>null})]}),(0,j.jsxs)(s.k,{direction:"column",gap:2,width:500,children:[(0,j.jsx)(v._,{info:y,renderEmptyState:()=>null}),(0,j.jsx)(v._,{info:I,renderEmptyState:()=>null})]})]})}},76217:(e,t,a)=>{a.d(t,{P:()=>g});var s=a(83797),i=a(2194),l=a(46878),n=a(65e3),r=a(70340),d=a(55842),o=a(61168),c=a(62508),u=a(90808),v=a(37711);const p=JSON.parse('{"field_links":"Links","context_developer-ui":"Developer UI"}'),h=(0,v.wZ)("ydb-tablet-name-wrapper",{en:p});var m=a(10161);function g(e){let{tabletId:t,database:a}=e;const v=(0,d.ix)(n.VH),p=(0,l.fK)(t,{database:a});return(0,m.jsx)(o.l,{disabled:!v,delayClosing:200,content:(0,m.jsx)(s.w,{responsive:!0,children:(0,m.jsx)(s.w.Item,{name:h("field_links"),children:(0,m.jsx)(u.j,{title:h("context_developer-ui"),url:(0,r.wz)(t)})})}),placement:["top","bottom"],behavior:i.x.Immediate,children:(0,m.jsx)(c.A,{name:t.toString(),path:p,hasClipboardButton:!0,showStatus:!1})})}},59907:(e,t,a)=>{a.d(t,{f:()=>n});var s=a(2634),i=a(55973),l=a(10161);function n(e){let{state:t}=e;return(0,l.jsx)(s._,{theme:(0,i.KR)(t),children:t})}},13618:(e,t,a)=>{a.d(t,{$:()=>d});a(34706);var s=a(79777),i=a(99294),l=a(10161);const n=(0,i.cn)("tag"),r=e=>{let{text:t,type:a}=e;return(0,l.jsx)("div",{className:n({type:a}),children:t})},d=e=>{let{tags:t,tagsType:a,className:i="",gap:n=1}=e;return(0,l.jsx)(s.k,{className:i,gap:n,wrap:"wrap",alignItems:"center",children:t&&t.map(((e,t)=>(0,l.jsx)(r,{text:e,type:a},t)))})}},33100:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>Ne,STORAGE_ROLE:()=>ke});var s=a(34706),i=a(72555),l=a(42152),n=a(55783),r=a(26836),d=a(99495),o=a(74003),c=a(15152),u=a(14561),v=a(99294),p=a(70340),h=a(62508),m=a(13618),g=a(10161);const b=(0,v.cn)("basic-node-viewer"),x=e=>{let t,{node:a,additionalNodesProps:i,className:l}=e;if(null!==i&&void 0!==i&&i.getNodeRef){const e=i.getNodeRef(a);t=e?(0,p.i1)(e):void 0}else if(a.NodeId){const e=(0,p.wq)(a.NodeId);t=(0,p.i1)(e)}return(0,g.jsx)("div",{className:b(null,l),children:a?(0,g.jsxs)(s.Fragment,{children:[(0,g.jsx)("div",{className:b("title"),children:"Node"}),(0,g.jsx)(h.A,{status:a.SystemState,name:a.Host}),t&&(0,g.jsx)("a",{rel:"noopener noreferrer",className:b("link",{external:!0}),href:t,target:"_blank",children:(0,g.jsx)(u.J,{data:c.Z})}),(0,g.jsxs)("div",{className:b("id"),children:[(0,g.jsx)("label",{className:b("label"),children:"NodeID"}),(0,g.jsx)("label",{children:a.NodeId})]}),a.DC&&(0,g.jsx)(m.$,{tags:[a.DC]}),a.Roles&&(0,g.jsx)(m.$,{tags:a.Roles,tagsType:"blue"})]}):(0,g.jsx)("div",{className:"error",children:"no data"})})};var j=a(15327),k=a(27810),N=a(43862);const y=(0,v.cn)("ydb-pool-usage"),f=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},I=e=>{let{data:t={}}=e;const{Threads:a,Name:s="Unknown",Usage:i=0}=t,l=i&&a,n=Math.floor(100*i),r=n>100?100:n;return(0,g.jsxs)("div",{className:y(),children:[(0,g.jsxs)("div",{className:y("info"),children:[(0,g.jsx)("div",{className:y("pool-name"),children:s}),l&&(0,g.jsxs)("div",{className:y("value"),children:[(0,g.jsxs)("div",{className:y("percents"),children:[n<1?"<1":n,"%"]}),(0,g.jsxs)("div",{className:y("threads"),children:["(\xd7",a,")"]})]})]}),(0,g.jsx)("div",{className:y("visual"),children:(0,g.jsx)("div",{className:y("usage-line",{type:f(r)}),style:{width:`${r}%`}})})]})};var w=a(20760);const D=(0,v.cn)("full-node-viewer"),S=e=>{var t,a,s,i;let{node:l,className:n}=e;const r=null===l||void 0===l||null===(t=l.Endpoints)||void 0===t?void 0:t.map((e=>{let{Name:t,Address:a}=e;return{label:t,value:a}})),d=[];null!==l&&void 0!==l&&null!==(a=l.Tenants)&&void 0!==a&&a.length&&d.push({label:"Database",value:l.Tenants[0]}),d.push({label:"Version",value:null===l||void 0===l?void 0:l.Version},{label:"Uptime",value:null===l||void 0===l?void 0:l.Uptime},{label:"DC",value:(null===l||void 0===l?void 0:l.DataCenterDescription)||(null===l||void 0===l?void 0:l.DC)},{label:"Rack",value:null===l||void 0===l?void 0:l.Rack});const o=null===l||void 0===l||null===(s=l.LoadAveragePercents)||void 0===s?void 0:s.map(((e,t)=>({label:k.x5[t],value:(0,g.jsx)(w.y,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,g.jsx)("div",{className:`${D()} ${n}`,children:l?(0,g.jsxs)("div",{className:D("common-info"),children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:D("section-title"),children:"Pools"}),(0,g.jsx)("div",{className:D("section",{pools:!0}),children:null===l||void 0===l||null===(i=l.PoolStats)||void 0===i?void 0:i.map(((e,t)=>(0,g.jsx)(I,{data:e},t)))})]}),r&&r.length&&(0,g.jsx)(N._,{title:"Endpoints",className:D("section"),info:r}),(0,g.jsx)(N._,{title:"Common info",className:D("section"),info:d}),(0,g.jsx)(N._,{title:"Load average",className:D("section",{average:!0}),info:o})]}):(0,g.jsx)("div",{className:"error",children:"no data"})})};var T=a(66498),P=a(46878),z=a(39202),V=a(85709),A=a(78759),C=a(96183);const E=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,C.Ns)(a)},q=A.h.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{const e=await window.api.getNodeInfo(a,{signal:s});return{data:E(e)}}catch(i){return{error:i}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{return{data:await window.api.getStorageInfo({nodeId:a},{signal:s})}}catch(i){return{error:i}}},providesTags:["All"]})}),overrideExisting:"throw"});var R=a(55842),L=a(58095),_=a(28265),O=a(75544),U=a(55102),F=a.n(U),J=a(67386),Z=a(38980),G=a(26612);const $=(0,J.P1)((e=>e),(e=>q.endpoints.getNodeStructure.select({nodeId:e}))),H=(0,J.P1)((e=>e),((e,t)=>$(t)),((e,t)=>t(e).data)),M=(0,J.P1)(((e,t)=>Number(t)),((e,t)=>H(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,s={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var i;const l=null===(i=a.VDisks)||void 0===i?void 0:i.filter((t=>t.NodeId===e)).map(G.se);null===l||void 0===l||l.forEach((a=>{var i;const l=(0,Z.a2)(a.VDiskId),n=null===(i=a.PDisk)||void 0===i?void 0:i.PDiskId;s[String(n)]||(s[String(n)]={vDisks:{},...a.PDisk}),s[String(n)].vDisks[l]={...a,PDiskId:n,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(s).reduce(((e,t)=>{const a=s[t].vDisks,i=Object.keys(a).reduce(((e,t,s)=>(e.push({...a[t],id:t,order:s}),e)),[]);return e[t]={...s[t],vDisks:i},e}),{})}));var K=a(29254),Q=a(71624),B=a(72616),Y=a(16318),X=a(81778),W=a(50377),ee=a(73287),te=a(49263),ae=a(77468),se=a(38392),ie=a(25665),le=a(37711);const ne=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),re=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),de=(0,le.wZ)("ydb-node-page",{en:ne,ru:re}),oe=(0,v.cn)("kv-node-structure");function ce(e){let{label:t,value:a,className:s}=e;return(0,g.jsxs)("span",{className:oe("pdisk-title-item",s),children:[t&&(0,g.jsxs)("span",{className:oe("pdisk-title-item-label"),children:[t,":"]}),(0,g.jsx)("span",{className:oe("pdisk-title-item-value"),children:a})]})}const ue=(0,v.cn)("kv-node-structure");var ve;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(ve||(ve={}));const pe={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function he(e){let{pDiskId:t,selectedVdiskId:a,nodeId:s}=e;return[{name:ve.slotId,header:pe[ve.slotId],width:100,render:e=>{let{row:i}=e;const l=i.VDiskSlotId;let n=null;return(0,ie.D)(s)&&(0,ie.D)(t)&&(0,ie.D)(l)&&(n=(0,p.yf)({nodeId:s,pDiskId:t,vDiskSlotId:l})),(0,g.jsxs)("div",{className:ue("vdisk-id",{selected:i.id===a}),children:[(0,g.jsx)("span",{children:l}),n&&(0,g.jsx)(B.z,{size:"s",className:ue("external-button",{hidden:!0}),href:n,target:"_blank",title:de("vdisk.developer-ui-button-title"),children:(0,g.jsx)(u.J,{data:c.Z})})]})},align:Q.ZP.LEFT},{name:ve.VDiskState,header:pe[ve.VDiskState],width:70,render:e=>{let{row:t}=e;return(0,g.jsx)(ee.J,{status:t.VDiskState===se.H.OK?ae.K.Green:ae.K.Red})},sortAccessor:e=>e.VDiskState===se.H.OK?1:0,align:Q.ZP.CENTER},{name:ve.Size,header:pe[ve.Size],width:170,render:e=>{let{row:t}=e;return(0,g.jsx)(w.y,{value:t.AllocatedSize,capacity:Number(t.AllocatedSize)+Number(t.AvailableSize),formatValues:Z.q3,colorizeProgress:!0})},sortAccessor:e=>Number(e.AllocatedSize),align:Q.ZP.CENTER},{name:ve.Info,header:pe[ve.Info],width:70,render:e=>{let{row:t}=e;return(0,g.jsx)(Y.J,{placement:["right"],content:(0,g.jsx)(te.K,{data:t,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:ue("vdisk-details"),children:(0,g.jsx)(B.z,{view:"flat-secondary",className:ue("vdisk-details-button",{selected:t.id===a}),children:(0,g.jsx)(u.J,{data:K.Z,size:18})})})},sortable:!1}]}function me(e){let{id:t,data:a,selectedVdiskId:i,nodeId:l,unfolded:n}=e;const[r,d]=s.useState(null!==n&&void 0!==n&&n),{TotalSize:o=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:p,vDisks:h}=a,m=Number(o),b=Number(c);return(0,g.jsxs)("div",{className:ue("pdisk"),id:t,children:[(0,g.jsxs)("div",{className:ue("pdisk-header"),children:[(0,g.jsxs)("div",{className:ue("pdisk-title-wrapper"),children:[(0,g.jsx)(ee.J,{status:u}),(0,g.jsx)(ce,{label:"PDiskID",value:v,className:ue("pdisk-title-id")}),(0,g.jsx)(ce,{value:p,className:ue("pdisk-title-type")}),(0,g.jsx)(w.y,{value:m-b,capacity:m,formatValues:Z.q3,colorizeProgress:!0,className:ue("pdisk-title-size")}),(0,g.jsx)(ce,{label:"VDisks",value:h.length})]}),(0,g.jsx)(B.z,{onClick:r?()=>{d(!1)}:()=>{d(!0)},view:"flat-secondary",children:(0,g.jsx)(X.F,{direction:r?"top":"bottom"})})]}),r&&(F()(a)?(0,g.jsx)("div",{children:"No information about PDisk"}):(0,g.jsxs)("div",{children:[(0,g.jsx)(W.P,{pDisk:a,nodeId:l,className:ue("pdisk-details"),withPDiskPageLink:!0}),(0,g.jsxs)("div",{className:ue("vdisks-container"),children:[(0,g.jsx)("div",{className:ue("vdisks-header"),children:"VDisks"}),(0,g.jsx)(Q.ZP,{theme:"yandex-cloud",data:h,columns:he({nodeId:l,pDiskId:v,selectedVdiskId:i}),settings:{...k.LE,dynamicRender:!1},rowClassName:e=>e.id===i?ue("selected-vdisk"):""})]})]}))]})}const ge=(0,v.cn)("kv-node-structure");function be(e){let{type:t,id:a}=e;return`${t}-${a}`}const xe=function(e){let{nodeId:t,className:a}=e;const i=(0,R.ix)((e=>M(e,t))),[l]=(0,R.Rj)(),{currentData:n,isFetching:r,error:o}=q.useGetNodeStructureQuery({nodeId:t},{pollingInterval:l}),c=r&&void 0===n,[{pdiskId:u,vdiskId:v}]=(0,d.useQueryParams)({pdiskId:d.StringParam,vdiskId:d.StringParam}),p=s.useRef(null),h=s.useRef(!1);return s.useEffect((()=>{if(!F()(i)&&!h.current&&p.current&&u){const t=document.getElementById(be({type:"pdisk",id:u}));let a=0;if(v){var e;const t=null===(e=i[u])||void 0===e?void 0:e.vDisks,s=null===t||void 0===t?void 0:t.find((e=>e.id===v)),l=s?document.querySelector(".data-table"):void 0,n=(null===s||void 0===s?void 0:s.order)||0;l&&(a+=l.offsetTop+40*n)}t&&(p.current.scrollTo({behavior:"smooth",top:a||t.offsetTop}),h.current=!0)}}),[i,u,v]),(0,g.jsxs)("div",{className:ge(),ref:p,children:[o?(0,g.jsx)(j.V,{error:o,className:ge("error")}):null,(0,g.jsx)("div",{className:a,children:c?(0,g.jsx)(T.a,{size:"m"}):o&&!n?null:(()=>{const e=Object.keys(i);return e.length>0?e.map((e=>(0,g.jsx)(me,{data:i[e],id:be({type:"pdisk",id:e}),unfolded:u===e,selectedVdiskId:v,nodeId:t},e))):"There is no information about node structure."})()})]})},je=(0,v.cn)("node"),ke="Storage";function Ne(e){var t,a;const c=s.useRef(null),u=(0,R.zL)(),v=null!==(t=(0,n.$B)(P.ZP.node))&&void 0!==t?t:Object.create(null),{id:p,activeTab:h}=v.params,[{database:m}]=(0,d.useQueryParams)(O.v3),[b]=(0,R.Rj)(),{currentData:k,isFetching:N,error:y}=q.useGetNodeInfoQuery({nodeId:p},{pollingInterval:b}),f=N&&void 0===k,I=k,w=(0,z.rU)(),D=(0,z.X_)(),{activeTabVerified:A,nodeTabs:C}=s.useMemo((()=>{var e;let t=(null===I||void 0===I||null===(e=I.Roles)||void 0===e?void 0:e.find((e=>e===ke)))?O.ZJ:O.ZJ.filter((e=>e.id!==O.P_));D&&(t=t.filter((e=>e.id!==O.pV)));const a=t.map((e=>({...e,title:e.name})));let s=a.find((e=>{let{id:t}=e;return t===h}));return s||(s=a[0]),{activeTabVerified:s,nodeTabs:a}}),[h,I,D]),E=(null===I||void 0===I||null===(a=I.Tenants)||void 0===a?void 0:a[0])||(null===m||void 0===m?void 0:m.toString());let U;if(I){var F;const e=!(null!==I&&void 0!==I&&null!==(F=I.Tenants)&&void 0!==F&&F[0]);U=e?"Storage":"Compute"}s.useEffect((()=>{u((0,V.J)("node",{tenantName:E,nodeRole:U,nodeId:p}))}),[u,E,p,U]);const J=()=>{switch(A.id){case O.P_:return(0,g.jsx)("div",{className:je("storage"),ref:c,children:(0,g.jsx)(L.V,{nodeId:p,parentRef:c})});case O.IA:return(0,g.jsx)(_.J,{nodeId:p,database:E,className:je("node-page-wrapper")});case O.pV:return(0,g.jsx)(xe,{className:je("node-page-wrapper"),nodeId:p});case O.mD:return(0,g.jsx)(S,{node:I,className:je("overview-wrapper")});default:return!1}};return f||!w?(0,g.jsx)(T.a,{size:"l"}):I?(0,g.jsxs)("div",{className:je(null,e.className),children:[(0,g.jsx)(l.ql,{titleTemplate:`%s \u2014 ${I.Host} \u2014 YDB Monitoring`,defaultTitle:`${I.Host} \u2014 YDB Monitoring`,children:(0,g.jsx)("title",{children:A.title})}),(0,g.jsx)(x,{node:I,additionalNodesProps:e.additionalNodesProps,className:je("header")}),y?(0,g.jsx)(j.V,{error:y,className:je("error")}):null,(0,g.jsxs)("div",{className:je("tabs"),children:[(0,g.jsx)(i.m,{size:"l",items:C,activeTab:A.id,wrapTo:(e,t)=>{let{id:a}=e;return(0,g.jsx)(r.rU,{to:(0,O.a3)(p,{database:E},a),className:je("tab"),children:t},a)},allowNotSelected:!0}),(0,g.jsx)(o.q,{})]}),(0,g.jsx)("div",{className:je("content"),children:J()})]}):y?(0,g.jsx)(j.V,{error:y}):(0,g.jsx)("div",{className:"error",children:"no node data"})}},72427:(e,t,a)=>{a.d(t,{O:()=>D});var s=a(42568),i=a(23795),l=a(14561),n=a(55982),r=a(62508),d=a(67653),o=a(74116),c=a(22877),u=a(76217),v=a(59907),p=a(65e3),h=a(6215),m=a(9038),g=a(27810),b=a(38980),x=a(55842),j=a(75544),k=a(37711);const N=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),y=(0,k.wZ)("ydb-tablets",{en:N});var f=a(10161);function I(e){let{database:t}=e;return[{name:"Type",width:150,get header(){return y("Type")},render:e=>{let{row:t}=e;const a=!1===t.Leader;return(0,f.jsxs)("span",{children:[t.Type," ",a?(0,f.jsx)(i.x,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return y("Tablet")},render:e=>{let{row:a}=e;return a.TabletId?(0,f.jsx)(u.P,{tabletId:a.TabletId,database:t}):g.jX}},{name:"State",get header(){return y("State")},render:e=>{let{row:t}=e;return(0,f.jsx)(v.f,{state:t.State})}},{name:"NodeId",get header(){return y("Node ID")},render:e=>{let{row:t}=e;const a=void 0===t.NodeId?void 0:(0,j.a3)(t.NodeId);return(0,f.jsx)(d.h,{to:a,children:t.NodeId})},align:"right"},{name:"fqdn",get header(){return y("Node FQDN")},render:e=>{let{row:t}=e;return t.fqdn?(0,f.jsx)(r.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,f.jsx)("span",{children:"\u2014"})}},{name:"Generation",get header(){return y("Generation")},align:"right"},{name:"Uptime",get header(){return y("Uptime")},render:e=>{let{row:t}=e;return(0,b.fG)(t.ChangeTime)},sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:e=>{let{row:t}=e;return(0,f.jsx)(w,{...t})}}]}function w(e){const t=e.State===m.g.Stopped,a=(0,x.ix)(p.VH),[i]=h._.useKillTabletMutation(),r=e.TabletId;return r?(0,f.jsx)(n.U,{buttonView:"outlined",buttonTitle:y("dialog.kill-header"),dialogHeader:y("dialog.kill-header"),dialogText:y("dialog.kill-text"),onConfirmAction:()=>i({id:r}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:y(a?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,f.jsx)(l.J,{data:s.Z})}):null}function D(e){let{database:t,tablets:a,className:s,loading:i}=e;return i?(0,f.jsx)(c.h,{}):(0,f.jsx)(o.G,{wrapperClassName:s,columns:I({database:t}),data:a,settings:g.LE,emptyDataMessage:y("noTabletsData")})}},28265:(e,t,a)=>{a.d(t,{J:()=>j});var s=a(64485),i=a(15327),l=a(67386),n=a(74647),r=a.n(n),d=a(78759),o=a(4969);const c=d.h.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,t)=>{let{signal:a}=t;try{return{data:await window.api.getTabletsInfo(e,{signal:a})}}catch(s){return{error:s}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),u=(0,l.P1)((e=>e),(e=>c.endpoints.getTabletsInfo.select(e)),{argsMemoize:l.PP,argsMemoizeOptions:{equalityCheck:r()}}),v=(0,l.P1)((e=>e),((e,t)=>u(t)),((e,t)=>t(e).data)),p=(0,l.P1)(((e,t)=>v(e,t)),(e=>(0,o.s)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]));var h=a(99294),m=a(55842),g=a(72427),b=a(10161);const x=(0,h.cn)("tablets");function j(e){let{nodeId:t,path:a,database:l,className:n}=e;const[r]=(0,m.Rj)();let d={};const o=void 0===t?void 0:String(t);void 0!==o?d={nodeId:o,database:l}:a&&(d={path:a,database:l});const{currentData:u,isFetching:v,error:h}=c.useGetTabletsInfoQuery(0===Object.keys(d).length?s.CN:d,{pollingInterval:r}),j=v&&void 0===u,k=(0,m.ix)((e=>p(e,d)));return(0,b.jsxs)("div",{className:x(null,n),children:[h?(0,b.jsx)(i.V,{error:h}):null,u||j?(0,b.jsx)(g.O,{tablets:k,database:l,loading:j}):null]})}},6215:(e,t,a)=>{a.d(t,{_:()=>i});var s=a(96183);const i=a(78759).h.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async(e,t)=>{let{id:a,database:i}=e,{signal:l}=t;try{const[e,t,n]=await Promise.all([window.api.getTablet({id:a,database:i},{signal:l}),window.api.getTabletHistory({id:a,database:i},{signal:l}),window.api.getNodesList({signal:l})]),r=(0,s.Xs)(n),d=Object.keys(t).reduce(((e,a)=>{var s;const i=null===(s=t[a])||void 0===s?void 0:s.TabletStateInfo;if(i&&i.length){const t=i.find((e=>e.Leader))||i[0],{ChangeTime:s,Generation:l,State:n,Leader:d,FollowerId:o}=t,c=r&&a?r.get(Number(a)):void 0;"Dead"!==n&&e.push({nodeId:a,generation:l,changeTime:s,state:n,leader:d,followerId:o,fqdn:c})}return e}),[]),{TabletStateInfo:o=[]}=e,[c={}]=o,{TabletId:u}=c;return{data:{id:u,data:c,history:d}}}catch(n){return{error:n}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async(e,t)=>{let{tenantId:a}=e,{signal:s}=t;try{const e=await window.api.getTabletDescribe(a,{signal:s}),{SchemeShard:t,PathId:i}=a;return{data:(null===e||void 0===e?void 0:e.Path)||`${t}:${i}`}}catch(i){return{error:i}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async(e,t)=>{let{id:a,hiveId:s}=e,{signal:i}=t;try{return{data:await window.api.getTabletFromHive({id:a,hiveId:s},{signal:i})}}catch(l){return{error:l}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async e=>{let{id:t}=e;try{return{data:await window.api.killTablet(t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.stopTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.resumeTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},42568:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(34706);const i=e=>s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.5 6.5 0 1 1-6.445 7.348.75.75 0 1 1 1.487-.194A5.001 5.001 0 1 0 4.43 4.5h1.32a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 2 5.25v-3a.75.75 0 0 1 1.5 0v1.06A6.48 6.48 0 0 1 8 1.5Z",clipRule:"evenodd"}))}}]);