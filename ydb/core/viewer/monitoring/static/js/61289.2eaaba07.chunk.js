"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[61289],{156:(e,t,s)=>{s.d(t,{k_:()=>S,QQ:()=>N,b0:()=>y,OH:()=>b,fj:()=>g,Ep:()=>x});var a=s(59284),n=s(24600),r=s(7435),o=s(16439),i=s(47779),l=s(28232);const d=3,u=2,c=120,m=10,p=1,h=10;function g(){const[e,t]=a.useState(void 0),[s,n]=a.useState(void 0);return{handleDataFetched:a.useCallback((s=>{if(null!==s&&void 0!==s&&s.columnsSettings&&!e){const{maxSlotsPerDisk:e,maxDisksPerNode:a}=s.columnsSettings,r=e||p,o=a||p,i=Math.max(r*d+(r-1)*u,c),l=o*i+(o-1)*m+2*h;t(i),n(l)}}),[e]),columnsSettings:a.useMemo((()=>({pDiskWidth:e||c,pDiskContainerWidth:s})),[s,e])}}const v=(0,o.H)(["success","warning","danger"],1,2),f={"block-4-2":(0,o.H)(["success","warning","danger"],1,2),"mirror-3-dc":(0,o.H)(["success","warning","danger"],1,3)},S=e=>{var t;return(void 0!==(t=e.ErasureSpecies)&&t in f?f[e.ErasureSpecies]:v)(e.Degraded)};function b(e,t){var s;let a=!0;return(0,r.f8)(null===(s=e.VDiskId)||void 0===s?void 0:s.GroupID)&&null!==t&&void 0!==t&&t.groupId&&(a&&=String(e.VDiskId.GroupID)===t.groupId),(0,r.f8)(e.NodeId)&&null!==t&&void 0!==t&&t.nodeId&&(a&&=String(e.NodeId)===t.nodeId),(0,r.f8)(e.PDiskId)&&null!==t&&void 0!==t&&t.pDiskId&&(a&&=String(e.PDiskId)===t.pDiskId),(0,r.f8)(e.VDiskSlotId)&&null!==t&&void 0!==t&&t.vDiskSlotId&&(a&&=String(e.VDiskSlotId)===t.vDiskSlotId),a}const k=10;function y(e){return(0,r.f8)(null===e||void 0===e?void 0:e.nodeId)||(0,r.f8)(null===e||void 0===e?void 0:e.pDiskId)||(0,r.f8)(null===e||void 0===e?void 0:e.vDiskSlotId)?1:k}function N(e){return(0,r.f8)(null===e||void 0===e?void 0:e.groupId)||(0,r.f8)(null===e||void 0===e?void 0:e.vDiskSlotId)?1:k}function x(e=[],t){const s=(0,l.J)(),r=(0,i.N4)((e=>(0,n.K)(e,s)));return a.useMemo((()=>{const s=[];return function(e){return"mirror-3-dc"===e||"mirror-3of4"===e}(t)?(e.forEach(((t,a)=>{var n,o,i;(null===r||void 0===r||null===(n=r.get(Number(null===t||void 0===t?void 0:t.NodeId)))||void 0===n?void 0:n.DC)!==(null===r||void 0===r||null===(o=r.get(Number(null===(i=e[a+1])||void 0===i?void 0:i.NodeId)))||void 0===o?void 0:o.DC)&&s.push(a)})),s):s}),[t,e,r])}},1349:(e,t,s)=>{s.d(t,{z:()=>Ee});var a=s(12888),n=s(59284),r=s(98167),o=s(67028),i=s(80987),l=s(370);const d={all:"all",missing:"missing",space:"space"},u={groups:"groups",nodes:"nodes"},c=l.z.nativeEnum(d).catch(d.all),m=l.z.nativeEnum(u).catch(u.groups);var p=s(78034),h=s(74319),g=s(86782);const v=["NodeId","Host","Uptime","CPU","RAM","PDisks"],f=["NodeId"],S=["Host","DC","Rack","Version","Uptime","Missing","DiskSpaceUsage"],b=S.map((e=>({value:e,content:(0,g.kn)(e)}))),k=l.z.custom((e=>S.includes(e))).catch(void 0),y={groups:"groupsSearch",nodes:"nodesSearch"};function N(){var e,t;const[s,a]=(0,i.useQueryParams)({type:i.StringParam,visible:i.StringParam,groupsSearch:i.StringParam,nodesSearch:i.StringParam,search:i.StringParam,uptimeFilter:i.StringParam,storageNodesGroupBy:i.StringParam,storageGroupsGroupBy:i.StringParam}),r=m.parse(s.type),o=c.parse(s.visible),l=null!==(e=s.groupsSearch)&&void 0!==e?e:"",d=null!==(t=s.nodesSearch)&&void 0!==t?t:"",u=p.Bm.parse(s.uptimeFilter),g=h.kY.parse(s.storageGroupsGroupBy),v=k.parse(s.storageNodesGroupBy);n.useEffect((()=>{if(s.search){const e={search:void 0};e[y[r]]=s.search,a(e,"replaceIn")}}),[s.search,r]);const f=e=>{a({visible:e},"replaceIn")},S=e=>{a({uptimeFilter:e},"replaceIn")};return{storageType:r,visibleEntities:o,groupsSearchValue:l,nodesSearchValue:d,nodesUptimeFilter:u,storageGroupsGroupByParam:g,storageNodesGroupByParam:v,handleTextFilterGroupsChange:e=>{a({groupsSearch:e||void 0},"replaceIn")},handleTextFilterNodesChange:e=>{a({nodesSearch:e||void 0},"replaceIn")},handleVisibleEntitiesChange:f,handleStorageTypeChange:e=>{a({type:e},"replaceIn")},handleUptimeFilterChange:S,handleStorageGroupsGroupByParamChange:e=>{a({storageGroupsGroupBy:e},"replaceIn")},handleStorageNodesGroupByParamChange:e=>{a({storageNodesGroupBy:e},"replaceIn")},handleShowAllGroups:()=>{f("all")},handleShowAllNodes:()=>{f("all"),S(p.cW.All)}}}var x=s(79553),D=s(42265),w=s(10671),I=s(10174),C=s(47779),P=s(81101),j=s(62783),E=s(61503),A=s(91157),T=s(60712);const R=({visibleEntities:e,onShowAll:t})=>{let s;return e===d.space&&(s=(0,A.A)("empty.out_of_space")),e===d.missing&&(s=(0,A.A)("empty.degraded")),s?(0,T.jsx)(E.U,{title:s,showAll:(0,A.A)("show_all"),onShowAll:t}):null};var U=s(16029),M=s(69464),G=s(40781);const L=({columns:e,database:t,nodeId:s,groupId:a,pDiskId:i,filterGroup:l,filterGroupBy:u,searchValue:c,visibleEntities:m,onShowAll:p,scrollContainerRef:g,renderErrorMessage:v,initialEntitiesCount:f})=>{const S=(0,o.Pm)(),b=(0,o.YA)(),k=(y=b,n.useCallback((async e=>{const{limit:t,offset:s,sortParams:a,filters:n,columnsIds:r}=e,{sortOrder:o,columnId:i}=null!==a&&void 0!==a?a:{},{searchValue:l,visibleEntities:d,database:u,nodeId:c,groupId:m,pDiskId:p,filterGroup:g,filterGroupBy:v}=null!==n&&void 0!==n?n:{},f=(0,h.GP)(i),S=f?(0,M.T)(f,o):void 0,b=(0,G.R)(r,h.YX),{groups:k,found:N,total:x}=await(0,U.t)({limit:t,offset:s,sort:S,filter:l,with:d,database:u,nodeId:c,groupId:m,pDiskId:p,filter_group:g,filter_group_by:v,fieldsRequired:b,shouldUseGroupsHandler:y});return{data:k||[],found:N||0,total:x||0}}),[y]));var y;const N=n.useMemo((()=>({searchValue:c,visibleEntities:m,database:t,nodeId:s,groupId:a,pDiskId:i,filterGroup:l,filterGroupBy:u})),[c,m,t,s,a,i,l,u]);return(0,T.jsx)(r.r,{loading:!S,children:(0,T.jsx)(j.k5,{columnsWidthLSKey:h.qK,scrollContainerRef:g,columns:e,fetchData:k,initialEntitiesCount:f,renderErrorMessage:v,renderEmptyDataMessage:()=>m!==d.all?(0,T.jsx)(R,{onShowAll:p,visibleEntities:m}):(0,A.A)("empty.default"),filters:N,tableName:"storage-groups"})})};var z=s(43951),W=s(74006);function V({visibleEntities:e,viewContext:t}){const s=(0,a.X)(),r=(0,a.b)(),i=(0,o.Z9)(),l=n.useMemo((()=>{const e=(0,W.J)({viewContext:t}),a=i?e:e.filter((e=>e.name!==h.UW.PileName));if(s)return a;const n=a.filter((e=>!(0,h.Ai)(e.name)));return r?n:n.filter((e=>!(0,h.RY)(e.name)))}),[s,t,r,i]),u=n.useMemo((()=>e===d.missing?[...h.LO,h.UW.Degraded]:e===d.space?[...h.LO,h.UW.DiskSpace]:h.LO),[e]),c=n.useMemo((()=>i?h.hu.includes(h.UW.PileName)?h.hu:[...h.hu,h.UW.PileName]:h.hu),[i]);return(0,z.K)(l,h.zY,h.H6,c,u)}var _=s(71708),O=s(62710),F=s(48372);const H=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN","controls_group-by-placeholder":"Group by:","no-nodes":"No such nodes","no-groups":"No such groups"}'),B=(0,F.g4)("ydb-storage",{en:H});var $=s(71573),Y=s(88908),q=s(12207),J=s(53755),K=s(49554),Q=s(59134),X=s(74281);const Z={[u.groups]:"Groups",[u.nodes]:"Nodes"},ee=({value:e,onChange:t})=>(0,T.jsxs)(X.x,{value:e,onUpdate:t,qa:"storage-type-filter",children:[(0,T.jsx)(X.x.Option,{value:u.groups,children:Z[u.groups]}),(0,T.jsx)(X.x.Option,{value:u.nodes,children:Z[u.nodes]})]}),te={[d.all]:"All",[d.missing]:"Degraded",[d.space]:"Out of Space"},se=({value:e,onChange:t})=>(0,T.jsxs)(X.x,{value:e,onUpdate:t,qa:"storage-visible-entities-filter",children:[(0,T.jsx)(X.x.Option,{value:d.missing,children:te[d.missing]}),(0,T.jsx)(X.x.Option,{value:d.space,children:te[d.space]}),(0,T.jsx)(X.x.Option,{value:d.all,children:te[d.all]})]});function ae({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:s,entitiesCountTotal:r,entitiesLoading:i}){const{groupsSearchValue:l,storageType:d,visibleEntities:u,storageGroupsGroupByParam:c,handleTextFilterGroupsChange:m,handleStorageTypeChange:p,handleVisibleEntitiesChange:g,handleStorageGroupsGroupByParamChange:v}=N(),f=(0,a.X)(),S=(0,o.Z9)(),b=n.useMemo((()=>S?h.SE:h.SE.filter((e=>"PileName"!==e.value))),[S]),k=e&&f;return(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(Q.v,{value:l,onChange:m,placeholder:B("controls_groups-search-placeholder"),className:(0,$.b)("search")}),k&&(0,T.jsx)(ee,{value:d,onChange:p}),t?null:(0,T.jsx)(se,{value:u,onChange:g}),t?(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(Y.E,{variant:"body-2",children:B("controls_group-by-placeholder")}),(0,T.jsx)(q.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:c?[c]:void 0,onUpdate:e=>{v(e[0])},options:b})]}):null,(0,T.jsx)(J.T,{label:B("groups"),loading:i,total:r,current:s})]})}function ne({withTypeSelector:e,withGroupBySelect:t}){const{tableState:s}=(0,K.WV)();return(0,T.jsx)(ae,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:s.foundEntities,entitiesCountTotal:s.totalEntities,entitiesLoading:s.isInitialLoad})}const re=n.memo((function({name:e,count:t,isExpanded:s,database:a,nodeId:n,groupId:r,pDiskId:o,searchValue:i,scrollContainerRef:l,filterGroupBy:d,columns:u,onIsExpandedChange:c,handleShowAllGroups:m}){return(0,T.jsx)(_.Q,{title:e,count:t,entityName:B("groups"),expanded:s,onIsExpandedChange:c,children:(0,T.jsx)(D.o,{initialState:{sortParams:void 0},table:(0,T.jsx)(L,{database:a,scrollContainerRef:l,nodeId:n,groupId:r,pDiskId:o,filterGroup:e,filterGroupBy:d,searchValue:i,visibleEntities:"all",onShowAll:m,renderErrorMessage:P.$,columns:u,initialEntitiesCount:t}),tableWrapperProps:{scrollContainerRef:l}})},e)}));function oe({database:e,nodeId:t,groupId:s,pDiskId:a,scrollContainerRef:r,viewContext:o}){const[i]=(0,C.Nt)(),{groupsSearchValue:l,storageGroupsGroupByParam:d,visibleEntities:u,handleShowAllGroups:c}=N(),{columnsToShow:m,columnsToSelect:p,setColumns:h}=V({visibleEntities:u,viewContext:o}),{currentData:g,isFetching:v,error:f}=I.S.useGetStorageGroupsInfoQuery({database:e,with:"all",nodeId:t,groupId:s,pDiskId:a,filter:l,shouldUseGroupsHandler:!0,group:d},{pollingInterval:i}),S=void 0===g&&v,{tableGroups:b,found:k=0,total:y=0}=g||{},{expandedGroups:P,setIsGroupExpanded:j}=(0,O.$)(b),E=n.useMemo((()=>({foundEntities:k,totalEntities:y,isInitialLoad:S,sortParams:void 0})),[k,y,S]);return(0,T.jsx)(D.o,{controls:(0,T.jsx)(ae,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:k,entitiesCountTotal:y,entitiesLoading:S}),extraControls:(0,T.jsx)(w.O,{popupWidth:200,items:p,showStatus:!0,onUpdate:h}),error:f?(0,T.jsx)(x.o,{error:f}):null,table:null!==b&&void 0!==b&&b.length?b.map((({name:n,count:o})=>{const i=P[n];return(0,T.jsx)(re,{name:n,count:o,isExpanded:i,database:e,nodeId:t,groupId:s,pDiskId:a,filterGroupBy:d,searchValue:l,visibleEntities:"all",scrollContainerRef:r,onIsExpandedChange:j,handleShowAllGroups:c,columns:m},n)})):B("no-groups"),initialState:E,tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[l,d,b],loading:S,className:(0,$.b)("groups-wrapper")}})}function ie({database:e,nodeId:t,groupId:s,pDiskId:a,viewContext:n,scrollContainerRef:r,initialEntitiesCount:i}){const{groupsSearchValue:l,visibleEntities:d,handleShowAllGroups:u}=N(),c=(0,o.SA)(),{columnsToShow:m,columnsToSelect:p,setColumns:h}=V({visibleEntities:d,viewContext:n});return(0,T.jsx)(D.o,{controls:(0,T.jsx)(ne,{withTypeSelector:!0,withGroupBySelect:c}),extraControls:(0,T.jsx)(w.O,{popupWidth:200,items:p,showStatus:!0,onUpdate:h}),table:(0,T.jsx)(L,{database:e,nodeId:t,groupId:s,pDiskId:a,searchValue:l,visibleEntities:d,onShowAll:u,scrollContainerRef:r,renderErrorMessage:P.$,columns:m,initialEntitiesCount:i}),tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[l,d]}})}function le(e){const{storageGroupsGroupByParam:t,visibleEntities:s,handleShowAllGroups:a}=N(),i=(0,o.Pm)(),l=(0,o.SA)();n.useEffect((()=>{l&&"all"!==s&&a()}),[a,l,s]);return(0,T.jsx)(r.r,{loading:!i,children:l&&t?(0,T.jsx)(oe,{...e}):(0,T.jsx)(ie,{...e})})}var de=s(44508),ue=s(77506);const ce=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),me=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432","empty.out_of_space":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0443\u0437\u043b\u043e\u0432","empty.small_uptime":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432 \u0441 uptime < 1h","empty.several_filters":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0443\u0437\u043b\u044b"}'),pe=(0,F.g4)("ydb-storage-nodes",{ru:me,en:ce}),he=({visibleEntities:e,nodesUptimeFilter:t,onShowAll:s})=>{let a;return e===d.space&&(a=pe("empty.out_of_space")),e===d.missing&&(a=pe("empty.degraded")),t===p.cW.SmallUptime&&(a=pe("empty.small_uptime")),e!==d.all&&t!==p.cW.All&&(a=pe("empty.several_filters")),a?(0,T.jsx)(E.U,{title:a,showAll:pe("show_all"),onShowAll:s}):null};var ge=s(49164);const ve=async e=>{const{type:t="static",storage:s=!0,limit:a,offset:n,sortParams:r,filters:o,columnsIds:i}=e,{searchValue:l,nodesUptimeFilter:d,visibleEntities:u,database:c,nodeId:m,groupId:h,filterGroup:v,filterGroupBy:f}=null!==o&&void 0!==o?o:{},{sortOrder:S,columnId:b}=null!==r&&void 0!==r?r:{},k=(0,g.kU)(b),y=k?(0,M.T)(k,S):void 0,N=(0,G.R)(i,g.fN),x=await window.api.viewer.getNodes({type:t,storage:s,limit:a,offset:n,sort:y,filter:l,uptime:(0,p.Fo)(d),with:u,database:c,node_id:m,group_id:h,filter_group:v,filter_group_by:f,fieldsRequired:N}),D=(0,ge.rz)(x);return{data:D.nodes||[],found:D.found||0,total:D.total||0,columnsSettings:D.columnsSettings}},fe=(0,ue.cn)("ydb-storage-nodes"),Se=e=>fe("node",{unavailable:(0,p.X7)(e)}),be=({columns:e,database:t,nodeId:s,groupId:a,filterGroup:r,filterGroupBy:o,searchValue:i,visibleEntities:l,nodesUptimeFilter:u,onShowAll:c,scrollContainerRef:m,renderErrorMessage:h,initialEntitiesCount:g,onDataFetched:v})=>{const f=n.useMemo((()=>({searchValue:i,visibleEntities:l,nodesUptimeFilter:u,database:t,nodeId:s,groupId:a,filterGroup:r,filterGroupBy:o})),[i,l,u,t,s,a,r,o]);return(0,T.jsx)(j.k5,{columnsWidthLSKey:"storageNodesColumnsWidth",scrollContainerRef:m,columns:e,fetchData:ve,rowHeight:51,initialEntitiesCount:g,renderErrorMessage:h,renderEmptyDataMessage:()=>l!==d.all||u!==p.cW.All?(0,T.jsx)(he,{onShowAll:c,nodesUptimeFilter:u,visibleEntities:l}):pe("empty.default"),getRowClassName:Se,filters:f,tableName:"storage-nodes",onDataFetched:v})};var ke=s(156),ye=s(64934);function Ne({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:s,entitiesCountTotal:a,entitiesLoading:r}){const{nodesSearchValue:o,storageType:i,visibleEntities:l,nodesUptimeFilter:d,storageNodesGroupByParam:u,handleTextFilterNodesChange:c,handleStorageTypeChange:m,handleVisibleEntitiesChange:p,handleUptimeFilterChange:h,handleStorageNodesGroupByParamChange:g}=N();return(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(Q.v,{value:o,onChange:c,placeholder:B("controls_nodes-search-placeholder"),className:(0,$.b)("search")}),e&&(0,T.jsx)(ee,{value:i,onChange:m}),t?null:(0,T.jsx)(se,{value:l,onChange:p}),t?null:(0,T.jsx)(ye.j,{value:d,onChange:h}),t?(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(Y.E,{variant:"body-2",children:B("controls_group-by-placeholder")}),(0,T.jsx)(q.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:u?[u]:void 0,onUpdate:e=>{g(e[0])},options:b})]}):null,(0,T.jsx)(J.T,{label:B("nodes"),loading:r,total:a,current:s})]})}function xe({withTypeSelector:e,withGroupBySelect:t}){const{tableState:s}=(0,K.WV)();return(0,T.jsx)(Ne,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:s.foundEntities,entitiesCountTotal:s.totalEntities,entitiesLoading:s.isInitialLoad})}var De=s(11515);function we({database:e,viewContext:t,columnsSettings:s}){const{visibleEntities:a}=N();return function({visibleEntities:e,database:t,viewContext:s,columnsSettings:a}){const r=(0,o.Z9)(),i=n.useMemo((()=>{const e=(0,De.C)({database:t,viewContext:s,columnsSettings:a});return r?e:e.filter((e=>e.name!==g.vg.PileName))}),[t,s,a,r]),l=n.useMemo((()=>e===d.missing?[...f,g.vg.Missing]:f),[e]),u=n.useMemo((()=>r?v.includes(g.vg.PileName)?v:[...v,g.vg.PileName]:v),[r]);return(0,z.K)(i,"storageNodesSelectedColumns",g.uG,u,l)}({visibleEntities:a,database:e,viewContext:t,columnsSettings:s})}const Ie=n.memo((function({name:e,count:t,isExpanded:s,database:a,nodeId:n,groupId:r,searchValue:o,scrollContainerRef:i,filterGroupBy:l,columns:d,onIsExpandedChange:u,handleShowAllNodes:c,onDataFetched:m}){return(0,T.jsx)(_.Q,{title:e,count:t,entityName:B("nodes"),expanded:s,onIsExpandedChange:u,children:(0,T.jsx)(D.o,{initialState:{sortParams:void 0},table:(0,T.jsx)(be,{database:a,scrollContainerRef:i,nodeId:n,groupId:r,filterGroup:e,filterGroupBy:l,searchValue:o,visibleEntities:"all",nodesUptimeFilter:p.cW.All,onShowAll:c,renderErrorMessage:P.$,columns:d,initialEntitiesCount:t,onDataFetched:m}),tableWrapperProps:{scrollContainerRef:i}})},e)}));function Ce({database:e,groupId:t,nodeId:s,viewContext:a,scrollContainerRef:r}){const[o]=(0,C.Nt)(),{nodesSearchValue:i,storageNodesGroupByParam:l,handleShowAllNodes:d}=N(),{handleDataFetched:u,columnsSettings:c}=(0,ke.fj)(),{columnsToShow:m,columnsToSelect:p,setColumns:h}=we({database:e,viewContext:a,columnsSettings:c}),{currentData:g,isFetching:v,error:f}=I.S.useGetStorageNodesInfoQuery({database:e,with:"all",filter:i,node_id:s,group_id:t,group:l},{pollingInterval:o}),S=void 0===g&&v,{tableGroups:b,found:k=0,total:y=0}=g||{},{expandedGroups:x,setIsGroupExpanded:P}=(0,O.$)(b),j=n.useMemo((()=>({foundEntities:k,totalEntities:y,isInitialLoad:S,sortParams:void 0})),[k,y,S]);return(0,T.jsx)(D.o,{controls:(0,T.jsx)(Ne,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:k,entitiesCountTotal:y,entitiesLoading:S}),extraControls:(0,T.jsx)(w.O,{popupWidth:200,items:p,showStatus:!0,onUpdate:h}),error:f?(0,T.jsx)(de.o,{error:f}):null,table:null!==b&&void 0!==b&&b.length?b.map((({name:a,count:n})=>{const o=x[a];return(0,T.jsx)(Ie,{name:a,count:n,isExpanded:o,database:e,nodeId:s,groupId:t,searchValue:i,visibleEntities:"all",filterGroupBy:l,scrollContainerRef:r,onIsExpandedChange:P,handleShowAllNodes:d,columns:m,onDataFetched:u},a)})):B("no-nodes"),initialState:j,tableWrapperProps:{scrollContainerRef:r,scrollDependencies:[i,l,b],loading:S,className:(0,$.b)("groups-wrapper")}})}function Pe({database:e,nodeId:t,groupId:s,viewContext:a,scrollContainerRef:n,initialEntitiesCount:r}){const{nodesSearchValue:i,visibleEntities:l,nodesUptimeFilter:d,handleShowAllNodes:u}=N(),c=(0,o.Ye)(),{handleDataFetched:m,columnsSettings:p}=(0,ke.fj)(),{columnsToShow:h,columnsToSelect:g,setColumns:v}=we({database:e,viewContext:a,columnsSettings:p});return(0,T.jsx)(D.o,{controls:(0,T.jsx)(xe,{withTypeSelector:!0,withGroupBySelect:c}),extraControls:(0,T.jsx)(w.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:v}),table:(0,T.jsx)(be,{database:e,nodeId:t,groupId:s,searchValue:i,visibleEntities:l,nodesUptimeFilter:d,onShowAll:u,scrollContainerRef:n,renderErrorMessage:P.$,columns:h,initialEntitiesCount:r,onDataFetched:m}),tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[i,l,d]}})}function je(e){const{storageNodesGroupByParam:t,visibleEntities:s,nodesUptimeFilter:a,handleShowAllNodes:i}=N(),l=(0,o.Pm)(),d=(0,o.Ye)();n.useEffect((()=>{!d||"all"===s&&a===p.cW.All||i()}),[i,a,d,s]);return(0,T.jsx)(r.r,{loading:!l,children:d&&t?(0,T.jsx)(Ce,{...e}):(0,T.jsx)(Pe,{...e})})}const Ee=e=>{const{storageType:t}=N(),s=(0,a.X)();return"nodes"===t&&s?(0,T.jsx)(je,{initialEntitiesCount:(0,ke.b0)(e.viewContext),...e}):(0,T.jsx)(le,{initialEntitiesCount:(0,ke.QQ)(e.viewContext),...e})}},5707:(e,t,s)=>{s.d(t,{A$:()=>o,Km:()=>i,Yh:()=>l,aW:()=>r,iZ:()=>u,qs:()=>d});var a=s(94025),n=s(67375);const r={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},o=Object.entries(r).reduce(((e,[t,s])=>({...e,[s]:t})),{}),i=r.Grey,l=o[i],d={[n.W.OK]:r.Green,[n.W.Initial]:r.Yellow,[n.W.SyncGuidRecovery]:r.Yellow,[n.W.LocalRecoveryError]:r.Red,[n.W.SyncGuidRecoveryError]:r.Red,[n.W.PDiskError]:r.Red},u={[a.t.Normal]:r.Green,[a.t.Initial]:r.Yellow,[a.t.InitialFormatRead]:r.Yellow,[a.t.InitialSysLogRead]:r.Yellow,[a.t.InitialCommonLogRead]:r.Yellow,[a.t.InitialFormatReadError]:r.Red,[a.t.InitialSysLogReadError]:r.Red,[a.t.InitialSysLogParseError]:r.Red,[a.t.InitialCommonLogReadError]:r.Red,[a.t.InitialCommonLogParseError]:r.Red,[a.t.CommonLoggerInitError]:r.Red,[a.t.OpenFileError]:r.Red,[a.t.ChunkQuotaError]:r.Red,[a.t.DeviceIoError]:r.Red,[a.t.Stopped]:r.Red}},7187:(e,t,s)=>{s.d(t,{H7:()=>c,NJ:()=>i,SW:()=>d,XY:()=>u,nC:()=>p,r$:()=>m});var a=s(7435),n=s(54090),r=s(16439),o=s(5707);function i(e){return"VDiskId"in e}const l=(0,r.H)([n.m.Green,n.m.Yellow,n.m.Red]),d=e=>(0,a.f8)(e)?c(l(e)):0;function u(e){return void 0===e?o.Yh:o.A$[e]||o.Yh}function c(e){return e?o.aW[e]:0}function m({nodeId:e,pDiskId:t}){if((0,a.f8)(e)&&(0,a.f8)(t))return`${e}-${t}`}function p(e){return("vDiskId"in e?[e.vDiskId]:[e.nodeId,e.pDiskId,e.vDiskSlotId]).join("-")}},10174:(e,t,s)=>{s.d(t,{S:()=>o});var a=s(21334),n=s(16029),r=s(49164);const o=a.F.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,{signal:t})=>{try{const s=await window.api.viewer.getNodes({storage:!0,type:"static",...e},{signal:t});return{data:(0,r.rz)(s)}}catch(s){return{error:s}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await(0,n.t)(e,{signal:t})}}catch(s){return{error:s}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},10576:(e,t,s)=>{s.d(t,{E:()=>v});var a=s(59284),n=s(88226),r=s(50229),o=s(44294),i=s(96927),l=s(63193),d=s(92459),u=s(7435),c=s(77506),m=s(71573),p=s(156),h=s(60712);const g=(0,c.cn)("pdisk-storage"),v=({data:e={},vDisks:t,showPopup:s,onShowPopup:c,onHidePopup:v,className:f,progressBarClassName:S,viewContext:b,width:k,delayOpen:y=m.s,delayClose:N=m.s})=>{const{NodeId:x,PDiskId:D}=e,w=(0,u.f8)(x)&&(0,u.f8)(D),I=a.useRef(null);let C;return w&&(C=(0,d.Ck)(D,x)),(0,h.jsxs)("div",{className:g(null,f),ref:I,style:{width:k},children:[null!==t&&void 0!==t&&t.length?(0,h.jsx)("div",{className:g("vdisks"),children:t.map((e=>(0,h.jsx)("div",{className:g("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,h.jsx)(l.y,{data:e,inactive:!(0,p.OH)(e,b),compact:!0,delayOpen:y,delayClose:N})},e.StringifiedId)))}):null,(0,h.jsx)(r.P,{showPopup:s,offset:{mainAxis:2,crossAxis:0},anchorRef:I,onShowPopup:c,onHidePopup:v,renderPopupContent:()=>(0,h.jsx)(i.O,{data:e}),delayOpen:y,delayClose:N,children:(0,h.jsxs)(o.E,{to:C,className:g("content"),children:[(0,h.jsx)(n.V,{diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,className:S}),(0,h.jsx)("div",{className:g("media-type"),children:e.Type})]})})]})}},10671:(e,t,s)=>{s.d(t,{O:()=>d});var a=s(27738),n=s(88908),r=s(80136),o=s(47653),i=s(53807),l=s(60712);function d(e){const{items:t,showStatus:s,disabled:d}=e,u=()=>{if(!s)return null;const e=t.reduce(((e,t)=>t.selected?e+1:e),0),a=t.length;return(0,l.jsxs)(n.E,{color:"secondary",children:[e,"/",a]})};return(0,l.jsx)(i.O,{...e,renderSwitcher:e=>(0,l.jsxs)(r.$,{disabled:d,onClick:e.onClick,children:[(0,l.jsx)(o.I,{data:a.A}),u()]}),hideApplyButton:!0})}},11515:(e,t,s)=>{s.d(t,{t:()=>u,C:()=>c});var a=s(4557),n=s(95109),r=s(86782),o=s(77506),i=s(10576),l=s(60712);const d=(0,o.cn)("ydb-storage-nodes-columns"),u=({viewContext:e,columnsSettings:t})=>({name:r.vg.PDisks,header:r.uG.PDisks,className:d("pdisks-column"),width:null===t||void 0===t?void 0:t.pDiskContainerWidth,render:({row:s})=>{var a;return(0,l.jsx)("div",{className:d("pdisks-wrapper"),children:null===(a=s.PDisks)||void 0===a?void 0:a.map((a=>{var n;const r=null===(n=s.VDisks)||void 0===n?void 0:n.filter((e=>e.PDiskId===a.PDiskId));return(0,l.jsx)("div",{className:d("pdisks-item"),children:(0,l.jsx)(i.E,{data:a,vDisks:r,viewContext:e,width:null===t||void 0===t?void 0:t.pDiskWidth})},a.PDiskId)}))})},align:a.Ay.CENTER,sortable:!1,resizeable:!1}),c=({database:e,viewContext:t,columnsSettings:s})=>[(0,n._E)(),(0,n.Nh)({database:e}),(0,n.eT)(),(0,n.uk)(),(0,n.OV)(),(0,n.OX)(),(0,n.jl)(),(0,n.fr)(),(0,n.kv)(),(0,n.pH)(),(0,n.iX)(),(0,n.Bg)(),(0,n.Rn)(),(0,n.Vz)(),u({viewContext:t,columnsSettings:s}),(0,n.qp)({database:e})].map((e=>({...e,sortable:(0,r.sp)(e.name)})))},15132:(e,t,s)=>{s.d(t,{O:()=>d});var a=s(27160),n=s(77506),r=s(35736),o=s(41650),i=s(60712);const l=(0,n.cn)("progress-viewer");function d({value:e,capacity:t,formatValues:s=r.g,percents:n,withOverflow:d,className:u,size:c="xs",colorizeProgress:m,inverseColorize:p,warningThreshold:h,dangerThreshold:g,hideCapacity:v}){const f=(0,a.D)();let S=Math.floor(parseFloat(String(e))/parseFloat(String(t))*100)||0;const b=S;S=S>100?100:S;let k=e,y=t,N="/";n?(k=(d?b:S)+"%",y="",N=""):s&&([k,y]=s(Number(e),Number(t)));const x=(0,r.w)({fillWidth:S,warningThreshold:h,dangerThreshold:g,colorizeProgress:m,inverseColorize:p});m&&!(0,o.kf)(t)&&(S=100);const D={width:S+"%"};return(0,o.kf)(e)?(0,i.jsxs)("div",{className:l({size:c,theme:f,status:x},u),children:[(0,i.jsx)("div",{className:l("line"),style:D}),(0,i.jsx)("span",{className:l("text"),children:(0,o.kf)(t)&&!v?`${k} ${N} ${y}`:k})]}):(0,i.jsx)("div",{className:`${l({size:c})} ${u} error`,children:"no data"})}},16029:(e,t,s)=>{s.d(t,{t:()=>n});var a=s(49164);async function n({version:e="v2",shouldUseGroupsHandler:t,...s},n){if(t&&"v1"!==e){const e=await window.api.storage.getStorageGroups({...s},n);return(0,a.Rv)(e)}{const t=await window.api.viewer.getStorageInfo({version:e,...s},n);return(0,a.Qi)(t)}}},24543:(e,t,s)=>{s.d(t,{u:()=>o});var a=s(59284),n=s(11064),r=s(60712);const o=({children:e,content:t,className:s,pinOnClick:o,hasArrow:i=!0,placement:l=["top","bottom"],...d})=>{const[u,c]=a.useState(!1),[m,p]=a.useState(!1),h=a.useRef(null);return(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(n.z,{anchorElement:h.current,open:m||u,placement:l,hasArrow:i,onOutsideClick:()=>{p(!1)},...d,children:t}),(0,r.jsx)("span",{className:s,ref:h,onClick:o?()=>{p(!0)}:void 0,onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:e})]})}},27295:(e,t,s)=>{s.d(t,{LW:()=>m,WT:()=>u,hK:()=>p,or:()=>c});var a=s(13847),n=s(7435),r=s(56839),o=s(51930),i=s(64036),l=s(78461),d=s(7187);function u(e={}){var t;if(!(0,d.NJ)(e)){const{NodeId:t,PDiskId:s,VSlotId:a}=e,o=(0,n.f8)(a)&&(0,n.f8)(s)&&(0,n.f8)(t)?{NodeId:t,PDiskId:s,VSlotId:a}:void 0;return{StringifiedId:(0,r.U9)(o),NodeId:t,PDiskId:s,VDiskSlotId:a}}const{PDisk:s,PDiskId:o,VDiskId:l,NodeId:p,Donors:h,AvailableSize:g,AllocatedSize:v,...f}=e,S=s?c({...s,NodeId:null!==(t=null===s||void 0===s?void 0:s.NodeId)&&void 0!==t?t:p}):void 0,b=null!==o&&void 0!==o?o:null===S||void 0===S?void 0:S.PDiskId,k=m({AvailableSize:g,AllocatedSize:v,SlotSize:null===s||void 0===s?void 0:s.EnforcedDynamicSlotSize}),y=(0,i.b)(e),N=(0,r.U9)(l);return{...f,...k,VDiskId:l,NodeId:p,PDiskId:b,PDisk:S,Donors:null===h||void 0===h?void 0:h.map((e=>{if((0,d.NJ)(e))return u({...e,DonorMode:!0});{const{NodeId:t,PDiskId:s,VSlotId:n}=e;return{NodeId:t,PDiskId:s,VDiskSlotId:n,StringifiedId:(0,a.isNil)(t)||(0,a.isNil)(s)||(0,a.isNil)(n)?"":`${t}-${s}-${n}`,DonorMode:!0}}})),Severity:y,StringifiedId:N}}function c(e={}){const{AvailableSize:t,TotalSize:s,Category:a,State:n,PDiskId:r,NodeId:i,EnforcedDynamicSlotSize:u,...c}=e,m=(0,d.r$)({nodeId:i,pDiskId:r}),h=(0,l.Y)(a),g=p({AvailableSize:t,TotalSize:s}),v=(0,o.d)({State:n,AllocatedPercent:g.AllocatedPercent});return{...c,...g,PDiskId:r,NodeId:i,StringifiedId:m,Type:h,Category:a,State:n,Severity:v,SlotSize:u}}function m({AvailableSize:e,AllocatedSize:t,SlotSize:s}){const a=Number(null!==e&&void 0!==e?e:0),n=Number(t),r=Number(s);let o=n+a;!a&&r&&(o=r);return{AvailableSize:a,AllocatedSize:n,SizeLimit:o,AllocatedPercent:o>0?Math.floor(100*n/o):NaN}}function p({AvailableSize:e,TotalSize:t}){const s=Number(e),a=Number(t),n=a-s;return{AvailableSize:s,TotalSize:a,AllocatedSize:n,AllocatedPercent:Math.floor(100*n/a)}}},27662:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(48372);const n=JSON.parse('{"text_external-consumption":"External Consumption","text_allocator-caches":"Allocator Caches","text_shared-cache":"Shared Cache","text_memtable":"MemTable","text_query-execution":"Query Execution","text_usage":"Usage","text_soft-limit":"Soft Limit","text_hard-limit":"Hard Limit","text_other":"Other","text_memory-details":"Memory Details"}'),r=(0,a.g4)("ydb-memory-viewer",{en:n})},31911:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(48372);const n=JSON.parse('{"node-id":"Node ID","host":"Host","database":"Database","node-name":"Node Name","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Detailed Memory","ram":"RAM","cpu":"CPU","pools":"Pools","disk-usage":"Disk Usage","tablets":"Tablets","load-average":"Load Average","load":"Load","sessions":"Sessions","missing":"Missing","pdisks":"PDisks","field_memory-used":"Memory used","field_memory-limit":"Memory limit","field_pile-name":"Pile Name","system-state":"System State","connect-status":"Connect Status","utilization":"Utilization","network-utilization":"Network Utilization","connections":"Connections","clock-skew":"Clock Skew","skew":"Skew","ping-time":"Ping Time","ping":"Ping","send":"Send","receive":"Receive","max":"Max","min":"Min","avg":"Avg","sum":"Sum"}'),r=(0,a.g4)("ydb-nodes-columns",{en:n})},35736:(e,t,s)=>{s.d(t,{g:()=>o,w:()=>i});var a=s(76086),n=s(56839);const r=e=>(0,n.ZV)((0,n.CR)(e||0,2)),o=(e,t)=>[r(e),r(t)];function i({inverseColorize:e,warningThreshold:t=a.Hh,dangerThreshold:s=a.Ed,colorizeProgress:n,fillWidth:r}){let o=e?"danger":"good";return n&&(r>t&&r<=s?o="warning":r>s&&(o=e?"good":"danger")),o}},39110:(e,t,s)=>{s.d(t,{r:()=>r});var a=s(48372);const n=JSON.parse('{"slot-id":"VDisk Slot Id","label_pdisk-id":"PDisk Id","pool-name":"Storage Pool Name","kind":"Kind","guid":"GUID","incarnation-guid":"Incarnation GUID","instance-guid":"Instance GUID","replication-status":"Replicated","replication-progress":"Replication Progress","replication-time-remaining":"Time Remaining","donors":"Donors","state-status":"VDisk State","space-status":"Disk Space","fresh-rank-satisfaction":"Fresh Rank Satisfaction","level-rank-satisfaction":"Level Rank Satisfaction","front-queues":"Front Queues","has-unreadable-blobs":"Has Unreadable Blobs","size":"Size","usage":"Usage","read-throughput":"Read Throughput","write-throughput":"Write Throughput","links":"Links","vdisk-page":"VDisk page","developer-ui":"Developer UI","yes":"Yes","no":"No","vdiks-title":"VDisk"}'),r=(0,a.g4)("ydb-vDisk-info",{en:n})},40781:(e,t,s)=>{function a(e,t){const s=e.reduce(((e,s)=>(t[s].forEach((t=>{e.add(t)})),e)),new Set);return Array.from(s).sort()}s.d(t,{R:()=>a})},42265:(e,t,s)=>{s.d(t,{o:()=>u});var a=s(59284),n=s(69326),r=s(49554),o=s(60712);const i=({table:e,tableWrapperProps:t})=>{const{tableState:s}=(0,r.WV)(),{sortParams:i}=s,l=a.useMemo((()=>{const e=(null===t||void 0===t?void 0:t.scrollDependencies)||[];return{...t,scrollDependencies:[...e,i]}}),[t,i]);return(0,o.jsx)(n.L.Table,{...l,children:e})},l=({controls:e,extraControls:t})=>e||t?(0,o.jsx)(n.L.Controls,{renderExtraControls:()=>t,children:e}):null,d=({error:e})=>e?(0,o.jsx)(a.Fragment,{children:e}):null,u=({controls:e,extraControls:t,table:s,tableWrapperProps:a,error:u,initialState:c,noBatching:m,fullHeight:p=!0})=>(0,o.jsx)(r.jV,{initialState:c,noBatching:m,children:(0,o.jsxs)(n.L,{fullHeight:p,children:[(0,o.jsx)(l,{controls:e,extraControls:t}),(0,o.jsx)(d,{error:u}),(0,o.jsx)(i,{table:s,tableWrapperProps:a})]})})},43951:(e,t,s)=>{s.d(t,{K:()=>o});var a=s(59284),n=s(59001);function r(e){if("string"===typeof e)return{id:e,selected:!0};if(e&&"object"===typeof e&&"id"in e&&"string"===typeof e.id){const t="selected"in e&&Boolean(e.selected);return{id:e.id,selected:t}}}const o=(e,t,s,o,i)=>{const[l,d]=a.useState((()=>{const s=n.f.readUserSettingsValue(t,o).map(r);return e.reduce(((e,t)=>{const a=s.find((e=>e&&e.id===t.name));return a?e.push(a):e.push({id:t.name,selected:!1}),e}),[])})),u=a.useMemo((()=>l.reduce(((t,{id:a,selected:n})=>{const r=null===i||void 0===i?void 0:i.includes(a),o=e.find((e=>e.name===a));return o&&t.push({id:a,title:s[a],selected:n||r,required:r,sticky:r?"start":void 0,column:o}),t}),[]).toSorted(((e,t)=>Number(Boolean(t.required))-Number(Boolean(e.required))))),[e,s,i,l]),c=a.useMemo((()=>u.filter((e=>e.selected)).map((e=>e.column))),[u]),m=a.useCallback((e=>{const s=e.map((({id:e,selected:t})=>({id:e,selected:t})));n.f.setUserSettingsValue(t,s),d(s)}),[t]);return{columnsToShow:c,columnsToSelect:u,setColumns:m}}},48295:(e,t,s)=>{s.d(t,{_:()=>u});var a=s(77506),n=s(24543),r=s(80176),o=s(60712);const i=(0,a.cn)("ydb-pool-bar"),l=({data:e={}})=>{const{Usage:t=0}=e,s=Math.min(100*t,100),a=(e=>e>=75?"danger":e>=50&&e<75?"warning":"normal")(s);return(0,o.jsx)(n.u,{className:i({type:a}),content:(0,o.jsx)(r.HG,{data:e,className:i("popup-content")}),children:(0,o.jsx)("div",{style:{height:`${s}%`},className:i("value",{type:a})})})},d=(0,a.cn)("ydb-pools-graph"),u=({pools:e=[]})=>(0,o.jsx)("div",{className:d(),children:e.map(((e,t)=>(0,o.jsx)(l,{data:e},t)))})},49164:(e,t,s)=>{s.d(t,{Rv:()=>v,rz:()=>h,Qi:()=>g});var a=s(94025),n=s(67375),r=s(7187),o=s(27295),i=s(78034);var l=s(73891),d=s(49696);function u(e){const{DiskSpace:t,VDisks:s=[]}=e;return t||(0,r.XY)(Math.max(...s.map((e=>(0,r.H7)(e.DiskSpace)))))}const c=(e,t)=>{var s;const a=(0,o.WT)(e);return{...a,StoragePoolName:t,Donors:null===a||void 0===a||null===(s=a.Donors)||void 0===s?void 0:s.map((e=>({...e,StoragePoolName:t})))}},m=(e,t)=>{var s;let r,i=0,l=0,d=0,m=0,p=0;const{Name:h,MediaType:g}=t;if(e.VDisks)for(const u of e.VDisks){const{Replicated:e,VDiskState:t,AvailableSize:s,AllocatedSize:c,PDisk:h,ReadThroughput:g,WriteThroughput:v}=u,{Type:f,State:S,AvailableSize:b}=(0,o.or)(h);!1!==e&&S===a.t.Normal&&t===n.W.OK||(i+=1);const k=Number(null!==s&&void 0!==s?s:b)||0,y=Number(c)||0;l+=y,d+=k+y,m+=Number(g)||0,p+=Number(v)||0,r=!f||f!==r&&r?"Mixed":f}const v=null===(s=e.VDisks)||void 0===s?void 0:s.map((e=>c(e,h))),f=d?((e,t=1)=>{const s=e.Limit?100*e.Used/e.Limit:0;return Math.floor(s/t)*t})({Used:l,Limit:d},5):void 0,S=u(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:v,Usage:f,Read:m,Write:p,PoolName:h,Used:l,Limit:d,Degraded:i,MediaType:g||r||void 0,DiskSpace:S}},p=e=>{const{VDisks:t=[],PoolName:s,Usage:a=0,Read:n=0,Write:r=0,Used:o=0,Limit:i=0,Degraded:l=0,Kind:d,MediaType:m,GroupID:p,Overall:h,GroupGeneration:g}=e,v=t.map((e=>c(e,s))),f=100*Number(a),S=u(e);return{...e,PoolName:s,GroupId:p,MediaType:m||d,VDisks:v,Usage:f,Overall:h,GroupGeneration:g?String(g):void 0,Read:Number(n),Write:Number(r),Used:Number(o),Limit:Number(i),Degraded:Number(l),DiskSpace:S}},h=e=>{const{Nodes:t,TotalNodes:s,FoundNodes:n,NodeGroups:r,MaximumSlotsPerDisk:l,MaximumDisksPerNode:d}=e,u=null===r||void 0===r?void 0:r.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),c=((e,t)=>{if(t&&!isNaN(Number(t)))return Number(t);const s=(e||[]).flatMap((e=>{const t=e.PDisks||[],s=e.VDisks||[];return t.map((e=>s.filter((t=>t.PDiskId===e.PDiskId)).length||0))}));return Math.max(1,...s)})(t,l),m=((e,t)=>{if(t&&!isNaN(Number(t)))return Number(t);const s=(e||[]).map((e=>{var t;return(null===(t=e.PDisks)||void 0===t?void 0:t.length)||0}));return Math.max(1,...s)})(t,d),p=null===t||void 0===t?void 0:t.map((e=>((e,t,s)=>{const{SystemState:n,NodeId:r,PDisks:l,VDisks:d,...u}=e,c=(null===l||void 0===l?void 0:l.filter((e=>e.State!==a.t.Normal)).length)||0,m=null===l||void 0===l?void 0:l.map((e=>({...(0,o.or)(e),NodeId:r}))),p=null===d||void 0===d?void 0:d.map((e=>({...(0,o.WT)(e),NodeId:r})));return{...u,...(0,i.q1)(n),NodeId:r,PDisks:m,VDisks:p,Missing:c,MaximumSlotsPerDisk:t,MaximumDisksPerNode:s}})(e,c,m)));return{nodes:p,total:Number(s)||(null===p||void 0===p?void 0:p.length),found:Number(n),tableGroups:u,columnsSettings:{maxSlotsPerDisk:c,maxDisksPerNode:m}}},g=e=>{const{StoragePools:t,StorageGroups:s,TotalGroups:a,FoundGroups:n}=e,r=((e,t)=>{let s=[];return e?s=e.map(p):null===t||void 0===t||t.forEach((e=>{var t;null===(t=e.Groups)||void 0===t||t.forEach((t=>{s.push(m(t,e))}))})),s})(s,t);return{groups:r,total:Number(a)||r.length,found:Number(n)}};function v(e){const{FoundGroups:t,TotalGroups:s,StorageGroups:a=[],StorageGroupGroups:n}=e,r=a.map((e=>{const{Usage:t,DiskSpaceUsage:s,Read:a,Write:n,Used:r,Limit:o,MissingDisks:i,VDisks:c=[],Overall:m,LatencyPutTabletLog:p,LatencyPutUserData:h,LatencyGetFast:g}=e,v=c.map(d.b),f=u(e);return{...e,Usage:t,DiskSpaceUsage:s,Read:Number(a),Write:Number(n),Used:Number(r),Limit:Number(o),LatencyPutTabletLogMs:(0,l.Jc)(p),LatencyPutUserDataMs:(0,l.Jc)(h),LatencyGetFastMs:(0,l.Jc)(g),Degraded:Number(i),Overall:m,VDisks:v,DiskSpace:f}})),o=null===n||void 0===n?void 0:n.map((({GroupName:e,GroupCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e)));return{groups:r,total:Number(s)||r.length,found:Number(t),tableGroups:o}}},49554:(e,t,s)=>{s.d(t,{WV:()=>l,jV:()=>i});var a=s(59284),n=s(60712);const r={sortParams:void 0,totalEntities:0,foundEntities:0,isInitialLoad:!0},o=a.createContext({tableState:r,setSortParams:()=>{},setTotalEntities:()=>{},setFoundEntities:()=>{},setIsInitialLoad:()=>{}}),i=({children:e,initialState:t={},noBatching:s})=>{var i,l,d,u;const[c,m]=a.useState(null!==(i=t.sortParams)&&void 0!==i?i:r.sortParams),[p,h]=a.useState(null!==(l=t.totalEntities)&&void 0!==l?l:r.totalEntities),[g,v]=a.useState(null!==(d=t.foundEntities)&&void 0!==d?d:r.foundEntities),[f,S]=a.useState(null!==(u=t.isInitialLoad)&&void 0!==u?u:r.isInitialLoad),b=a.useMemo((()=>({sortParams:c,totalEntities:p,foundEntities:g,isInitialLoad:f})),[c,p,g,f]),k=a.useMemo((()=>({tableState:b,noBatching:s,setSortParams:m,setTotalEntities:h,setFoundEntities:v,setIsInitialLoad:S})),[b,s]);return(0,n.jsx)(o.Provider,{value:k,children:e})},l=()=>{const e=a.useContext(o);if(void 0===e)throw new Error("usePaginatedTableState must be used within a PaginatedTableStateProvider");return e}},49696:(e,t,s)=>{s.d(t,{b:()=>d});var a=s(56839),n=s(51930),r=s(64036),o=s(78461),i=s(7187),l=s(27295);function d(e={}){var t,s,u;const{Whiteboard:c={},PDisk:m,...p}=e,h={...c,...p,VDiskId:c.VDiskId},g=function(e={}){var t,s,a;const{Whiteboard:r,...d}=e,u={...r,...d,PDiskId:null===r||void 0===r?void 0:r.PDiskId};if(void 0===u.PDiskId&&d.PDiskId){const e=Number(d.PDiskId.split("-")[1]);isNaN(e)||(u.PDiskId=e)}const c=d.PDiskId||(0,i.r$)({nodeId:u.NodeId,pDiskId:u.PDiskId}),{AllocatedPercent:m,AllocatedSize:p,AvailableSize:h,TotalSize:g}=(0,l.hK)({AvailableSize:u.AvailableSize,TotalSize:u.TotalSize}),v=null!==(t=null===(s=d.Type)||void 0===s?void 0:s.toUpperCase())&&void 0!==t?t:(0,o.Y)(null===r||void 0===r?void 0:r.Category),f=(0,n.d)({State:null===r||void 0===r?void 0:r.State,AllocatedPercent:m}),S=null!==(a=d.SlotSize)&&void 0!==a?a:null===r||void 0===r?void 0:r.EnforcedDynamicSlotSize;return{...u,StringifiedId:c,AllocatedPercent:m,AllocatedSize:p,AvailableSize:h,TotalSize:g,Type:v,Severity:f,SlotSize:S}}({...m,NodeId:h.NodeId}),v=null!==(t=null===g||void 0===g?void 0:g.PDiskId)&&void 0!==t?t:null===c||void 0===c?void 0:c.PDiskId,f=null!==(s=p.VDiskId)&&void 0!==s?s:(0,a.U9)(c.VDiskId),S=(0,r.b)(h),b=(0,l.LW)({AvailableSize:h.AvailableSize,AllocatedSize:h.AllocatedSize,SlotSize:null===m||void 0===m?void 0:m.SlotSize}),k=null===(u=p.Donors)||void 0===u?void 0:u.map((e=>d({...e,Whiteboard:{...e.Whiteboard,DonorMode:!0}})));return{...h,...b,PDisk:g,Donors:k,PDiskId:v,StringifiedId:f,Severity:S}}},50229:(e,t,s)=>{s.d(t,{P:()=>d});var a=s(59284),n=s(11064),r=s(43781),o=s.n(r),i=s(76086),l=s(60712);const d=({children:e,renderPopupContent:t,showPopup:s,offset:r,anchorRef:d,onShowPopup:u,onHidePopup:c,placement:m=["top","bottom"],contentClassName:p,delayClose:h=100,delayOpen:g=100})=>{const[v,f]=a.useState(!1),S=a.useRef(null),b=a.useMemo((()=>o()((()=>{f(!0),null===u||void 0===u||u()}),g)),[u,g]),k=a.useCallback((()=>{f(!1),null===c||void 0===c||c()}),[c]),y=a.useMemo((()=>o()(k,h)),[k,h]),N=b,[x,D]=a.useState(!1),[w,I]=a.useState(!1),C=a.useCallback((()=>{D(!0)}),[]),P=a.useCallback((()=>{D(!1)}),[]),j=a.useCallback((()=>{I(!0)}),[]),E=a.useCallback((()=>{I(!1)}),[]),A=a.useCallback((()=>{I(!1),D(!1),k()}),[k]),T=v||s||x||w;return(0,l.jsxs)(a.Fragment,{children:[(0,l.jsx)("span",{ref:S,onMouseEnter:N,onMouseLeave:()=>{b.cancel(),y()},children:e}),T?(0,l.jsx)(n.z,{anchorElement:(null===d||void 0===d?void 0:d.current)||S.current,onOpenChange:(e,t,s)=>{"escape-key"===s&&A()},placement:m,hasArrow:!0,open:!0,offset:r||{mainAxis:12,crossAxis:0},children:(0,l.jsx)("div",{className:p,onContextMenu:j,onMouseEnter:C,onMouseLeave:P,onBlur:E,children:(0,l.jsx)("div",{className:i.zQ,children:t()})})}):null]})}},50672:(e,t,s)=>{s.d(t,{D:()=>r});var a=s(48372);const n=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","usage":"Usage","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","yes":"Yes"}'),r=(0,a.g4)("ydb-pDisk-info",{en:n})},51930:(e,t,s)=>{s.d(t,{d:()=>r});var a=s(5707),n=s(7187);function r(e){const t=function(e){return t=e,void 0!==t&&t in a.iZ?a.iZ[e]:a.Km;var t}(e.State),s=(0,n.SW)(e.AllocatedPercent);return t!==a.Km&&s?Math.max(t,s):t}},53755:(e,t,s)=>{s.d(t,{T:()=>l});var a=s(52443),n=s(77506);const r=(0,s(48372).g4)("ydb-entities-count",{ru:{of:"\u0438\u0437"},en:{of:"of"}});var o=s(60712);const i=(0,n.cn)("ydb-entities-count"),l=({total:e,current:t,label:s,loading:n,className:l})=>{let d="";return s&&(d+=`${s}: `),n?d+="...":(d+=`${t}`,e&&Number(e)!==Number(t)&&(d+=` ${r("of")} ${e}`)),(0,o.jsx)(a.J,{theme:"info",size:"m",className:i(null,l),children:d})}},58267:(e,t,s)=>{s.d(t,{P:()=>o,_:()=>i});var a=s(54090),n=s(6354);const r={[n.r.Dead]:a.m.Red,[n.r.Created]:a.m.Yellow,[n.r.ResolveStateStorage]:a.m.Yellow,[n.r.Candidate]:a.m.Yellow,[n.r.BlockBlobStorage]:a.m.Yellow,[n.r.WriteZeroEntry]:a.m.Yellow,[n.r.Restored]:a.m.Yellow,[n.r.Discover]:a.m.Yellow,[n.r.Lock]:a.m.Yellow,[n.r.Stopped]:a.m.Yellow,[n.r.ResolveLeader]:a.m.Yellow,[n.r.RebuildGraph]:a.m.Yellow,[n.r.Terminating]:a.m.Yellow,[n.r.Deleted]:a.m.Green,[n.r.Active]:a.m.Green},o=e=>{if(!e)return a.m.Grey;return t=e,Object.values(a.m).includes(t)?e:r[e];var t};function i(e){if(!e)return"unknown";switch(e){case n.r.Dead:return"danger";case n.r.Active:case n.r.Deleted:return"success";default:return"warning"}}},59134:(e,t,s)=>{s.d(t,{v:()=>d});s(59284);var a=s(77506),n=s(79602),r=s(62441),o=s(60712);const i=({onUpdate:e,value:t="",debounce:s=200,...a})=>{const[i,l]=(0,r.o)({value:t,onUpdate:e,debounce:s});return(0,o.jsx)(n.k,{value:i,onUpdate:l,...a})},l=(0,a.cn)("ydb-search"),d=({onChange:e,value:t="",width:s,className:a,debounce:n,inputRef:r,...d})=>(0,o.jsx)(i,{debounce:n,hasClear:!0,autoFocus:!0,controlRef:r,style:{width:s},className:l(null,a),value:t,onUpdate:e,...d})},59753:(e,t,s)=>{s.d(t,{L:()=>d});var a=s(92459),n=s(25196),r=s(48372);const o=JSON.parse('{"pdisk-page":"PDisk page"}'),i=(0,r.g4)("ydb-pDisk-link",{en:o});var l=s(60712);function d({pDiskId:e,nodeId:t}){return(0,l.jsx)(n.K,{title:i("pdisk-page"),url:(0,a.Ck)(e,t),external:!1})}},61503:(e,t,s)=>{s.d(t,{U:()=>c});var a=s(80136),n=s(7889),r=s(19280),o=s(48372);const i=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),l=JSON.parse('{"default_message":"\u0412\u0441\u0451 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435!","default_button_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"}'),d=(0,o.g4)("ydb-storage-empty-filter",{ru:l,en:i});var u=s(60712);const c=({title:e,message:t=d("default_message"),showAll:s=d("default_button_label"),onShowAll:o,image:i=(0,u.jsx)(r.v,{name:"thumbsUp",width:200})})=>(0,u.jsx)(n.pp,{image:i,position:"left",title:e,description:t,actions:o&&[(0,u.jsx)(a.$,{onClick:o,children:s},"show-all")]})},62441:(e,t,s)=>{s.d(t,{o:()=>n});var a=s(59284);function n({value:e,onUpdate:t,debounce:s=200}){const[n,r]=a.useState(e),o=a.useRef();a.useEffect((()=>{r((t=>t!==e?e:t))}),[e]);return[n,e=>{r(e),window.clearTimeout(o.current),o.current=window.setTimeout((()=>{null===t||void 0===t||t(e)}),s)}]}},62710:(e,t,s)=>{s.d(t,{$:()=>n});var a=s(59284);function n(e){const[t,s]=a.useState({});a.useEffect((()=>{null!==e&&void 0!==e&&e.length&&s((t=>e.reduce(((e,{name:s})=>{const a=t[s];return{...e,[s]:null!==a&&void 0!==a&&a}}),{})))}),[e]);return{expandedGroups:t,setIsGroupExpanded:a.useCallback(((e,t)=>{s((s=>({...s,[e]:t})))}),[])}}},62783:(e,t,s)=>{s.d(t,{U3:()=>n,k5:()=>z});const a=!0,n=41;var r=s(59284),o=s(49554);const i=new class{constructor(){this.requestQueue=new Map,this.batchTimeout=null,this.BATCH_DELAY=50}queueRequest(e,t){return new Promise(((s,a)=>{const n=this.createBatchKey(e);this.requestQueue.has(n)||this.requestQueue.set(n,[]),this.requestQueue.get(n).push({params:e,resolve:s,reject:a,signal:t}),this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout((()=>{this.processBatch()}),this.BATCH_DELAY)}))}createBatchKey(e){return JSON.stringify({tableName:e.tableName,filters:e.filters,sortParams:e.sortParams,columnsIds:e.columnsIds,limit:e.limit})}groupConsecutiveRequests(e){if(0===e.length)return[];const t=e.sort(((e,t)=>e.params.offset-t.params.offset)),s=[];let a=[t[0]];const n=t[0].params.limit;for(let r=1;r<t.length;r++){const e=a[a.length-1].params.offset+n;t[r].params.offset===e?a.push(t[r]):(s.push(this.createBatchGroup(a)),a=[t[r]])}return s.push(this.createBatchGroup(a)),s}createBatchGroup(e){const t=Math.min(...e.map((e=>e.params.offset))),s=Math.max(...e.map((e=>e.params.offset))),a=e[0].params.limit,n=e.length*a;return{requests:e,batchKey:this.createBatchKey(e[0].params),minOffset:t,maxOffset:s,totalLimit:n}}async executeBatch(e){const t=e.requests[0],s={...t.params,offset:e.minOffset,limit:e.totalLimit};try{const a=await t.params.fetchData({limit:s.limit,offset:s.offset,filters:s.filters,sortParams:s.sortParams,columnsIds:s.columnsIds,signal:t.signal});this.splitAndDistributeResponse(e,a)}catch(a){e.requests.forEach((e=>{e.resolve({error:a})}))}}splitAndDistributeResponse(e,t){const s=e.requests[0].params.limit;e.requests.forEach(((e,a)=>{const n=a*s,r=n+s,o=t.data.slice(n,r),i={...t,data:o,total:t.total,found:t.found};e.resolve({data:i})}))}async processBatch(){const e=Array.from(this.requestQueue.entries());this.requestQueue.clear(),this.batchTimeout=null;for(const[t,s]of e){const e=this.groupConsecutiveRequests(s);await Promise.all(e.map((e=>this.executeBatch(e))))}}};const l=s(21334).F.injectEndpoints({endpoints:function(e){return{fetchTableChunk:e.query({queryFn:async({offset:e,limit:t,sortParams:s,filters:a,columnsIds:n,fetchData:r,tableName:o,noBatching:l},{signal:d})=>{try{if(l){return{data:await r({limit:t,offset:e,filters:a,sortParams:s,columnsIds:n,signal:d})}}{const l=await i.queueRequest({offset:e,limit:t,sortParams:s,filters:a,columnsIds:n,fetchData:r,tableName:o},d);return"error"in l?{error:l.error}:l}}catch(u){return{error:u}}},providesTags:["All"]})}}});var d=s(7435),u=s(47779),c=s(44508),m=s(1608);const p=(0,s(77506).cn)("ydb-paginated-table");function h(e){let t,s=null;return function(...a){t=a,"number"!==typeof s&&(s=requestAnimationFrame((()=>{e(...t),s=null})))}}const g=r.memo;var v=s(60712);const f=({children:e,className:t,height:s,width:a,align:n="left",resizeable:r})=>(0,v.jsx)("td",{className:p("row-cell",{align:n},t),style:{height:`${s}px`,width:`${a}px`,maxWidth:r?`${a}px`:void 0},children:e}),S=g((function({columns:e,height:t}){return(0,v.jsx)("tr",{className:p("row",{loading:!0}),style:{height:t},children:e.map((e=>{var s;const n=null!==(s=e.resizeable)&&void 0!==s?s:a;return(0,v.jsx)(f,{height:t,width:e.width,align:e.align,className:e.className,resizeable:n,children:(0,v.jsx)(m.E,{className:p("row-skeleton"),style:{width:"80%",height:"50%"}})},e.name)}))})})),b=({row:e,columns:t,getRowClassName:s,height:n})=>{const r=null===s||void 0===s?void 0:s(e);return(0,v.jsx)("tr",{className:p("row",r),style:{height:n},children:t.map((t=>{var s;const r=null!==(s=t.resizeable)&&void 0!==s?s:a;return(0,v.jsx)(f,{height:n,width:t.width,align:t.align,className:t.className,resizeable:r,children:t.render({row:e})},t.name)}))})},k=({columns:e,children:t,height:s})=>(0,v.jsx)("tr",{className:p("row",{empty:!0}),style:{height:s},children:(0,v.jsx)("td",{colSpan:e.length,className:p("td"),children:t})});var y=s(48372);const N=JSON.parse('{"empty":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"}'),x=(0,y.g4)("ydb-paginated-table",{ru:N,en:{empty:"No data"}}),D=g((function({id:e,chunkSize:t,calculatedCount:s,rowHeight:a,columns:n,fetchData:i,tableName:m,filters:p,sortParams:h,getRowClassName:g,renderErrorMessage:f,renderEmptyDataMessage:y,onDataFetched:N,shouldFetch:D,shouldRender:w,keepCache:I}){var C;const[P,j]=r.useState(!0),[E]=(0,u.Nt)(),{noBatching:A}=(0,o.WV)(),T={offset:e*t,limit:t,fetchData:i,filters:p,sortParams:h,columnsIds:n.map((e=>e.name)).toSorted(),tableName:m,noBatching:A};l.useFetchTableChunkQuery(T,{skip:P||!D,pollingInterval:E,refetchOnMountOrArgChange:!I});const{currentData:R,error:U}=l.endpoints.fetchTableChunk.useQueryState(T);r.useEffect((()=>{let e=0;return D&&P&&(e=window.setTimeout((()=>{j(!1)}),200)),()=>{window.clearTimeout(e)}}),[D,P]),r.useEffect((()=>{R&&N({...R,data:R.data,found:R.found||0,total:R.total||0})}),[R,N]);const M=(null===R||void 0===R||null===(C=R.data)||void 0===C?void 0:C.length)||s;return w?(()=>{var e;if(!R){if(U){const e=U;return(0,v.jsx)(k,{columns:n,height:M*a,children:f?f(e):(0,v.jsx)(c.o,{error:e})})}return(0,d._e)(M).map((e=>(0,v.jsx)(S,{columns:n,height:a},e)))}return null!==(e=R.data)&&void 0!==e&&e.length?R.data.map(((e,t)=>(0,v.jsx)(b,{row:e,columns:n,height:a,getRowClassName:g},t))):(0,v.jsx)(k,{columns:n,height:M*a,children:y?y():x("empty")})})():null}));var w=s(13847);const I=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?1:2,C=({scrollContainerRef:e,tableRef:t,foundEntities:s,chunkSize:a,rowHeight:n,columns:o,fetchData:i,filters:l,tableName:d,sortParams:u,getRowClassName:c,renderErrorMessage:m,renderEmptyDataMessage:g,onDataFetched:f,keepCache:S})=>{const b=(({scrollContainerRef:e,tableRef:t,totalItems:s,rowHeight:a,chunkSize:n,renderOverscan:o=I,fetchOverscan:i=4})=>{const l=r.useMemo((()=>Math.ceil(s/n)),[n,s]),[d,u]=r.useState(0),[c,m]=r.useState(0),p=r.useCallback((()=>{const r=null===e||void 0===e?void 0:e.current,o=t.current;if(!r||!o)return null;const i=function(e,t){const s=t.getBoundingClientRect(),a=e.getBoundingClientRect();return s.top-a.top+e.scrollTop}(r,o),d=Math.max(r.scrollTop-i,0),u=d+r.clientHeight,c=function(e){const{container:t,currentTableOffset:s,totalItems:a,rowHeight:n,freezeMarginPx:r}=e,o=s,i=o+a*n,l=t.scrollTop,d=l+t.clientHeight,u="number"===typeof r?r:t.clientHeight;return d<o-u||l>i+u}({container:r,currentTableOffset:i,totalItems:s,rowHeight:a});return{start:Math.max(Math.floor(d/a/n),0),end:Math.min(Math.floor(u/a/n),Math.max(l-1,0)),skipUpdate:c}}),[e,t,a,n,l,s]),g=r.useCallback((()=>{const e=p();if(e){const{start:t,end:s,skipUpdate:a}=e;if(a)return;u(t),m(s)}}),[p]);r.useEffect((()=>{g()}),[l,g]);const v=r.useCallback((()=>{g()}),[g]);return r.useEffect((()=>{const e=h((()=>{g()}));return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[g]),r.useEffect((()=>{const t=null===e||void 0===e?void 0:e.current;if(!t)return;const s=(0,w.throttle)(v,200,{trailing:!0,leading:!0});return t.addEventListener("scroll",s,{passive:!0}),()=>{t.removeEventListener("scroll",s)}}),[v,e]),r.useMemo((()=>{const e=Math.max(d-o,0),t=Math.min(c+o,Math.max(l-1,0)),s=Math.max(d-i,0),a=Math.min(c+i,Math.max(l-1,0));return Array(l).fill(null).map(((n,r)=>({shouldRender:r>=e&&r<=t,shouldFetch:r>=s&&r<=a})))}),[l,d,c,o,i])})({scrollContainerRef:e,tableRef:t,totalItems:s||1,rowHeight:n,chunkSize:a}),k=r.useMemo((()=>s?s%a||a:1),[s,a]),y=r.useCallback((()=>({firstRenderIndex:b.findIndex((e=>e.shouldRender)),lastRenderIndex:b.findLastIndex((e=>e.shouldRender))})),[b]),N=r.useCallback((()=>({firstFetchIndex:b.findIndex((e=>e.shouldFetch)),lastFetchIndex:b.findLastIndex((e=>e.shouldFetch))})),[b]),x=r.useCallback(((e,t)=>{let s=0;for(let r=e;r<t;r++){s+=(r===b.length-1?k:a)*n}return s}),[a,b.length,k,n]),C=r.useCallback(((e,t,s)=>{const a=x(e,t);return(0,v.jsx)("tr",{style:{height:`${a}px`},className:p(s),children:(0,v.jsx)("td",{colSpan:o.length,style:{padding:0,border:"none"}})},s)}),[x,o.length]),P=r.useCallback((e=>{const t=b[e];return(0,v.jsx)(D,{id:e,calculatedCount:e===b.length-1?k:a,chunkSize:a,rowHeight:n,columns:o,fetchData:i,filters:l,tableName:d,sortParams:u,getRowClassName:c,renderErrorMessage:m,renderEmptyDataMessage:g,onDataFetched:f,shouldFetch:t.shouldFetch,shouldRender:t.shouldRender,keepCache:S},e)}),[a,b,o,i,l,c,S,k,f,g,m,n,u,d]),j=r.useCallback((()=>{const{firstFetchIndex:e,lastFetchIndex:t}=N(),{firstRenderIndex:s,lastRenderIndex:a}=y(),n=[];if(-1===e)return n;s>0&&n.push(C(0,s,"separator-beginning"));for(let r=e;r<=t;r++)n.push(P(r));return a<b.length-1&&n.push(C(a+1,b.length,"separator-end")),n}),[b.length,P,C,N,y]);return(0,v.jsx)(r.Fragment,{children:j()})};var P=s(20263);function j({minWidth:e,maxWidth:t,getCurrentColumnWidth:s,onResize:a}){const n=r.useRef(null),[o,i]=r.useState(!1);return r.useEffect((()=>{const r=n.current;if(!r)return;let o,l,d;const u=h((s=>{if(E(s),"number"!==typeof o||"number"!==typeof l)return;const n=s.clientX-o,r=function(e,t=40,s=1/0){return Math.max(t,Math.min(e,s))}(l+n,e,t);r!==d&&(d=r,null===a||void 0===a||a(d))})),c=e=>{E(e),void 0!==d&&(null===a||void 0===a||a(d)),i(!1),o=void 0,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)},m=e=>{l=s(),E(e),o=e.clientX,i(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)};return r.addEventListener("mousedown",m),()=>{r.removeEventListener("mousedown",m),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)}}),[a,e,t,s]),(0,v.jsx)("span",{ref:n,className:p("resize-handler",{resizing:o}),onClick:e=>E(e)})}function E(e){e.preventDefault(),e.stopPropagation()}const A=({order:e})=>(0,v.jsx)("svg",{className:p("sort-icon",{desc:-1===e}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,v.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})}),T=({sortOrder:e,sortable:t,defaultSortOrder:s})=>t?(0,v.jsx)("span",{className:p("sort-icon-container",{shadow:!e}),children:(0,v.jsx)(A,{order:e||s})}):null,R={left:"right",right:"left",center:"right"},U=({column:e,resizeable:t,sortOrder:s,defaultSortOrder:a,onSort:n,rowHeight:o,onCellMount:i,onCellUnMount:l,onColumnsResize:d})=>{var u;const c=r.useRef(null);r.useEffect((()=>{const e=c.current;return e&&(null===i||void 0===i||i(e)),()=>{e&&(null===l||void 0===l||l(e))}}),[i,l]);const m=r.useCallback((()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.getBoundingClientRect().width}),[]),h=r.useCallback((t=>{null===d||void 0===d||d(e.name,t)}),[d,e.name]),g=null!==(u=e.header)&&void 0!==u?u:e.name,f={height:`${o}px`,width:`${e.width}px`,minWidth:t?`${e.width}px`:void 0,maxWidth:t?`${e.width}px`:void 0};return(0,v.jsxs)("th",{ref:c,className:p("head-cell-wrapper"),style:f,children:[(0,v.jsxs)("div",{className:p("head-cell",{align:e.align,sortable:e.sortable},e.className),onClick:()=>{e.sortable&&(null===n||void 0===n||n(e.name))},children:[(0,v.jsxs)("div",{className:p("head-cell-content-container"),children:[(0,v.jsx)("div",{className:p("head-cell-content"),children:g}),e.note&&(0,v.jsx)(P.H,{popoverProps:{placement:R[e.align]},className:p("head-cell-note"),children:e.note})]}),(0,v.jsx)(T,{sortOrder:s,sortable:e.sortable,defaultSortOrder:a})]}),t?(0,v.jsx)(j,{maxWidth:e.resizeMaxWidth,minWidth:e.resizeMinWidth,getCurrentColumnWidth:m,onResize:h}):null]})},M=({columns:e,onSort:t,onColumnsResize:s,defaultSortOrder:o=-1,rowHeight:i=n})=>{const[l,d]=r.useState({}),u=e=>{let s={};if(e===l.columnId){if(l.sortOrder&&l.sortOrder!==o)return d(s),void(null===t||void 0===t||t(s));s={sortOrder:1===l.sortOrder?-1:1,columnId:e}}else s={sortOrder:o,columnId:e};null===t||void 0===t||t(s),d(s)};return(0,v.jsxs)(r.Fragment,{children:[(0,v.jsx)("colgroup",{children:e.map((e=>(0,v.jsx)("col",{style:{width:`${e.width}px`}},e.name)))}),(0,v.jsx)("thead",{className:p("head"),children:(0,v.jsx)("tr",{children:e.map((e=>{var t;const n=l.columnId===e.name?l.sortOrder:void 0,r=s&&(null!==(t=e.resizeable)&&void 0!==t?t:a);return(0,v.jsx)(U,{column:e,resizeable:r,sortOrder:n,defaultSortOrder:o,onSort:u,rowHeight:i,onColumnsResize:s},e.name)}))})})]})},G=({limit:e=20,initialEntitiesCount:t,fetchData:s,filters:a,tableName:i,columns:l,getRowClassName:d,rowHeight:u=n,scrollContainerRef:c,onColumnsResize:m,renderErrorMessage:h,renderEmptyDataMessage:g,containerClassName:f,onDataFetched:S,keepCache:b=!0})=>{const{tableState:k,setSortParams:y,setTotalEntities:N,setFoundEntities:x,setIsInitialLoad:D}=(0,o.WV)(),{sortParams:w,foundEntities:I}=k,P=r.useRef(null),[j,E]=r.useState(a);r.useEffect((()=>{E(a)}),[a]);const A=r.useCallback((e=>{e&&(N(e.total),x(e.found),D(!1),null===S||void 0===S||S(e))}),[S,x,D,N]);r.useLayoutEffect((()=>{const e=c.current;if(e){"transform"!==window.getComputedStyle(e).willChange&&(e.style.willChange="transform")}}),[c.current]),r.useLayoutEffect((()=>{const e=t||1;N(t||0),x(e),D(!0)}),[t,N,x,D]);return(0,v.jsx)("div",{ref:P,className:p(null,f),children:(0,v.jsxs)("table",{className:p("table"),children:[(0,v.jsx)(M,{columns:l,onSort:y,onColumnsResize:m}),(0,v.jsx)("tbody",{children:(0,v.jsx)(C,{scrollContainerRef:c,tableRef:P,foundEntities:I,chunkSize:e,rowHeight:u,columns:l,fetchData:s,filters:j,tableName:i,sortParams:w,getRowClassName:d,renderErrorMessage:h,renderEmptyDataMessage:g,onDataFetched:A,keepCache:b})})]})})};var L=s(16819);function z({columnsWidthLSKey:e,columns:t,...s}){const[a,n]=(0,L.a)(e),r=function(e,t){return e.map((e=>{var s;return{...e,width:null!==(s=t[e.name])&&void 0!==s?s:e.width}}))}(t,a);return(0,v.jsx)(G,{columns:r,onColumnsResize:n,containerClassName:p("resizeable-table-container"),...s})}},63193:(e,t,s)=>{s.d(t,{y:()=>U});var a=s(92459),n=s(77506),r=s(88226),o=s(50229),i=s(44294),l=s(59284),d=s(32752),u=s(52443),c=s(24600),m=s(54090),p=s(67375),h=s(7435),g=s(76086),v=s(56839),f=s(31684),S=s(7187),b=s(47779),k=s(28232),y=s(12888),N=s(41650),x=s(60073),D=s(25196),w=s(96927),I=s(39110),C=s(48372);const P=JSON.parse('{"context_not-available":"not available","label_state":"State","label_storage-pool":"StoragePool","label_node-id":"NodeId","label_pdisk-id":"PDiskId","label_vslot-id":"VSlotId","label_links":"Links","label_vdisk":"VDisk","label_fresh":"Fresh","label_level":"Level","label_space":"Space","label_front-queues":"FrontQueues","label_replicated":"Replicated","label_progress":"Progress","label_remaining":"Remaining","label_unsync-vdisks":"UnsyncVDisks","label_allocated":"Allocated","label_read":"Read","label_write":"Write"}'),j=(0,C.g4)("ydb-vDisk-popup",{en:P});var E=s(60712);const A=(0,n.cn)("vdisk-storage-popup"),T=({data:e})=>{const t=(0,S.NJ)(e),s=(0,y.b)(),n=(0,y.X)(),r=(0,a.Z$)(),o=(0,k.J)(),C=l.useMemo((()=>t?((e,t,s)=>{var a,n,r,o;const{NodeId:i,PDiskId:l,VDiskSlotId:u,StringifiedId:c,VDiskState:g,SatisfactionRank:S,DiskSpace:b,FrontQueues:k,Replicated:y,ReplicationProgress:x,ReplicationSecondsRemaining:w,UnsyncedVDisks:C,AllocatedSize:P,ReadThroughput:A,WriteThroughput:T,StoragePoolName:R}=e,U=[{label:j("label_vdisk"),value:c},{label:j("label_state"),value:null!==g&&void 0!==g?g:j("context_not-available")}];var M,G;if(R&&U.push({label:j("label_storage-pool"),value:R}),S&&(null===(a=S.FreshRank)||void 0===a?void 0:a.Flag)!==m.m.Green&&U.push({label:j("label_fresh"),value:null===(M=S.FreshRank)||void 0===M?void 0:M.Flag}),S&&(null===(n=S.LevelRank)||void 0===n?void 0:n.Flag)!==m.m.Green&&U.push({label:j("label_level"),value:null===(G=S.LevelRank)||void 0===G?void 0:G.Flag}),S&&null!==(r=S.FreshRank)&&void 0!==r&&r.RankPercent&&U.push({label:j("label_fresh"),value:S.FreshRank.RankPercent}),S&&null!==(o=S.LevelRank)&&void 0!==o&&o.RankPercent&&U.push({label:j("label_level"),value:S.LevelRank.RankPercent}),b&&b!==m.m.Green&&U.push({label:j("label_space"),value:b}),k&&k!==m.m.Green&&U.push({label:j("label_front-queues"),value:k}),!1===y&&g===p.W.OK){if(U.push({label:j("label_replicated"),value:"NO"}),(0,h.f8)(x)){const e=Math.round(100*x);U.push({label:j("label_progress"),value:`${e}%`})}if((0,h.f8)(w)){const e=(0,v.YS)(w);e&&U.push({label:j("label_remaining"),value:e})}}if(C&&U.push({label:j("label_unsync-vdisks"),value:C}),Number(P)&&U.push({label:j("label_allocated"),value:(0,N.wb)(P)}),Number(A)&&U.push({label:j("label_read"),value:(0,N.O4)(A)}),Number(T)&&U.push({label:j("label_write"),value:(0,N.O4)(T)}),t&&(0,h.f8)(i)&&(0,h.f8)(l)&&((0,h.f8)(u)||(0,h.f8)(c))){const e=(0,h.f8)(u)?(0,f.Wg)({nodeId:i,pDiskId:l,vDiskSlotId:u}):void 0,t=null===s||void 0===s?void 0:s({nodeId:i,vDiskId:c});t&&U.push({label:j("label_links"),value:(0,E.jsxs)(d.s,{wrap:"wrap",gap:2,children:[(0,E.jsx)(D.K,{title:(0,I.r)("vdisk-page"),url:t,external:!1},t),e?(0,E.jsx)(D.K,{title:(0,I.r)("developer-ui"),url:e}):null]})})}return U})(e,n,r):((e,t)=>{const{NodeId:s,PDiskId:a,VSlotId:n,StoragePoolName:r}=e,o=[{label:j("label_state"),value:j("context_not-available")}];if(r&&o.push({label:j("label_storage-pool"),value:r}),o.push({label:j("label_node-id"),value:null!==s&&void 0!==s?s:g.Pd},{label:j("label_pdisk-id"),value:null!==a&&void 0!==a?a:g.Pd},{label:j("label_vslot-id"),value:null!==n&&void 0!==n?n:g.Pd}),t&&(0,h.f8)(s)&&(0,h.f8)(a)&&(0,h.f8)(n)){const e=(0,f.Wg)({nodeId:s,pDiskId:a,vDiskSlotId:n});o.push({label:j("label_links"),value:(0,E.jsx)(D.K,{title:"Developer UI",url:e})})}return o})(e,n)),[e,t,n,r]),P=(0,b.N4)((e=>(0,c.K)(e,o))),T=(0,h.f8)(e.NodeId)?null===P||void 0===P?void 0:P.get(e.NodeId):void 0,R=l.useMemo((()=>t&&e.PDisk&&(0,w.f)(e.PDisk,T,n)),[e,T,t,n]),U=[];if("Donors"in e&&e.Donors){const t=e.Donors;for(const e of t)U.push({label:j("label_vdisk"),value:(0,E.jsx)(i.E,{to:r({nodeId:e.NodeId,vDiskId:e.StringifiedId}),children:e.StringifiedId})})}return(0,E.jsxs)("div",{className:A(),children:[e.DonorMode&&(0,E.jsx)(u.J,{className:A("donor-label"),children:"Donor"}),(0,E.jsx)(x.z_,{title:"VDisk",info:C,size:"s"}),R&&s&&(0,E.jsx)(x.z_,{title:"PDisk",info:R,size:"s"}),U.length>0&&(0,E.jsx)(x.z_,{title:"Donors",info:U,size:"s"})]})},R=(0,n.cn)("ydb-vdisk-component"),U=({data:e={},compact:t,inactive:s,showPopup:n,onShowPopup:l,onHidePopup:d,progressBarClassName:u,delayClose:c,delayOpen:m})=>{const p=(0,a.Z$)()({nodeId:e.NodeId,vDiskId:e.StringifiedId});return(0,E.jsx)(o.P,{showPopup:n,onShowPopup:l,onHidePopup:d,renderPopupContent:()=>(0,E.jsx)(T,{data:e}),offset:{mainAxis:2,crossAxis:0},delayClose:c,delayOpen:m,children:(0,E.jsx)("div",{className:R(),children:(0,E.jsx)(i.E,{to:p,className:R("content"),children:(0,E.jsx)(r.V,{diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,compact:t,inactive:s,className:u})})})})}},64036:(e,t,s)=>{s.d(t,{b:()=>r});var a=s(54090),n=s(5707);function r(e){const{DiskSpace:t,VDiskState:s,FrontQueues:a,Replicated:r}=e;if(!s)return n.Km;const i=o(t),l=function(e){var t;if(!e)return n.Km;return null!==(t=n.qs[e])&&void 0!==t?t:n.Km}(s),d=Math.min(n.aW.Orange,o(a));let u=Math.max(i,l,d);return!1===r&&u===n.aW.Green&&(u=n.aW.Blue),u}function o(e){var t;return e?e===a.m.Blue?n.aW.Green:null!==(t=n.aW[e])&&void 0!==t?t:n.Km:n.Km}},64934:(e,t,s)=>{s.d(t,{j:()=>o});var a=s(74281),n=s(78034),r=s(60712);const o=({value:e,onChange:t,className:s})=>(0,r.jsxs)(a.x,{value:e,onUpdate:t,className:s,children:[(0,r.jsx)(a.x.Option,{value:n.cW.All,children:n.DG[n.cW.All]}),(0,r.jsx)(a.x.Option,{value:n.cW.SmallUptime,children:n.DG[n.cW.SmallUptime]})]})},67375:(e,t,s)=>{s.d(t,{W:()=>a});let a=function(e){return e.Initial="Initial",e.LocalRecoveryError="LocalRecoveryError",e.SyncGuidRecovery="SyncGuidRecovery",e.SyncGuidRecoveryError="SyncGuidRecoveryError",e.OK="OK",e.PDiskError="PDiskError",e}({})},69326:(e,t,s)=>{s.d(t,{L:()=>d});var a=s(59284),n=s(32752),r=s(77506),o=s(19228);var i=s(60712);const l=(0,r.cn)("ydb-table-with-controls-layout"),d=({children:e,className:t,fullHeight:s})=>(0,i.jsx)("div",{className:l({"full-height":s},t),children:e});d.Controls=function({children:e,renderExtraControls:t,className:s}){return(0,i.jsxs)(n.s,{justifyContent:"space-between",className:l("controls-wrapper"),gap:2,children:[(0,i.jsx)("div",{className:l("controls",s),children:e}),(0,i.jsx)("div",{className:l("extra-controls"),children:null===t||void 0===t?void 0:t()})]})},d.Table=function({children:e,loading:t,className:s,scrollContainerRef:n,scrollDependencies:r=[]}){const d=a.useRef(null);return(({tableContainerRef:e,scrollContainerRef:t,dependencies:s=[]})=>{const n=a.useCallback((()=>{if(null!==e&&void 0!==e&&e.current){const t=window.getComputedStyle(e.current).getPropertyValue("--data-table-sticky-header-offset");return t?parseInt(t,10):0}return 0}),[e]),r=a.useCallback((()=>{if(null!==e&&void 0!==e&&e.current&&null!==t&&void 0!==t&&t.current){const s=n(),a=e.current.getBoundingClientRect(),r=t.current.getBoundingClientRect(),o=a.top-r.top+t.current.scrollTop;a.top-s<r.top&&t.current.scrollTo(0,o-s)}}),[t,e,n]);a.useLayoutEffect((()=>{e&&t&&r()}),[r,e,t,...s])})({tableContainerRef:d,scrollContainerRef:n,dependencies:r}),t?(0,i.jsx)(o.Q,{className:l("loader")}):(0,i.jsx)("div",{ref:d,className:l("table",s),children:e})}},69464:(e,t,s)=>{s.d(t,{T:()=>n});var a=s(6388);s(23536);const n=(e,t=a.xN)=>t===a.xN?`-${e}`:e},71573:(e,t,s)=>{s.d(t,{b:()=>a,s:()=>n});const a=(0,s(77506).cn)("global-storage"),n=200},71708:(e,t,s)=>{s.d(t,{Q:()=>d});s(59284);var a=s(60461),n=s(88908),r=s(52443),o=s(77506),i=s(60712);const l=(0,o.cn)("ydb-table-group"),d=({children:e,title:t,entityName:s,count:o,expanded:d=!1,onIsExpandedChange:u})=>{const c=()=>{u(t,!d)};return(0,i.jsxs)("div",{className:l(null),children:[(0,i.jsx)("button",{onClick:c,className:l("button"),title:t,children:(0,i.jsxs)("div",{className:l("title-wrapper"),children:[(0,i.jsx)(a.I,{direction:d?"top":"bottom"}),(0,i.jsxs)("div",{className:l("title"),children:[(0,i.jsx)(n.E,{variant:"subheader-2",children:t}),(0,i.jsxs)(n.E,{variant:"body-2",color:"secondary",className:l("count"),children:[s,": ",(0,i.jsx)(r.J,{theme:"normal",children:o})]})]})]})}),d?(0,i.jsx)("div",{className:l("content"),children:e}):null]})};d.displayName="TableGroup"},74006:(e,t,s)=>{s.d(t,{J:()=>ie,k:()=>oe});var a=s(79879),n=s(4557),r=s(32752),o=s(52443),i=s(58611),l=s(47653),d=s(71661),u=s(10508),c=s(33775),m=s(12535),p=s(92459),h=s(7435),g=s(77506),v=s(76086),f=s(56839),S=s(16439),b=s(73891),k=s(41650),y=s(59284),N=s(26230),x=s(63193),D=s(10576),w=s(71573),I=s(156),C=s(60712);const P=(0,g.cn)("ydb-storage-disks");function j({vDisks:e=[],viewContext:t,erasure:s}){const[a,n]=y.useState(),o=(0,I.Ep)(e,s),{theme:{spaceBaseSize:i}}=(0,N.L)();if(!e.length)return null;const l=(300-i*(e.length-1))/e.length;return(0,C.jsxs)("div",{className:P(null),children:[(0,C.jsx)(r.s,{direction:"row",gap:1,grow:!0,style:{width:300},children:null===e||void 0===e?void 0:e.map(((e,s)=>(0,C.jsx)(E,{vDisk:e,inactive:!(0,I.OH)(e,t),highlightedVDisk:a,setHighlightedVDisk:n,unavailableVDiskWidth:l},e.StringifiedId||s)))}),(0,C.jsx)("div",{className:P("pdisks-wrapper"),children:null===e||void 0===e?void 0:e.map(((e,t)=>{var s;return(0,C.jsx)(A,{vDisk:e,highlightedVDisk:a,setHighlightedVDisk:n,withDCMargin:o.includes(t)},(null===e||void 0===e||null===(s=e.PDisk)||void 0===s?void 0:s.StringifiedId)||t)}))})]})}function E({vDisk:e,highlightedVDisk:t,inactive:s,setHighlightedVDisk:a,unavailableVDiskWidth:n}){const r={...e,PDisk:void 0},o=e.StringifiedId,i=(0,k.kf)(r.AllocatedSize)?void 0:n,l=Number(r.AllocatedSize)||1;return(0,C.jsx)("div",{style:{flexGrow:l,minWidth:i},className:P("vdisk-item"),children:(0,C.jsx)(x.y,{data:r,compact:!0,inactive:s,showPopup:t===o,delayOpen:w.s,delayClose:w.s,onShowPopup:()=>a(o),onHidePopup:()=>a(void 0),progressBarClassName:P("vdisk-progress-bar")})})}function A({vDisk:e,highlightedVDisk:t,setHighlightedVDisk:s,withDCMargin:a}){const n=e.StringifiedId;return e.PDisk?(0,C.jsx)(D.E,{className:P("pdisk-item",{"with-dc-margin":a}),progressBarClassName:P("pdisk-progress-bar"),data:e.PDisk,showPopup:t===n,delayOpen:w.s,delayClose:w.s,onShowPopup:()=>s(n),onHidePopup:()=>s(void 0)}):null}var T=s(7187);const R="--ydb-stack-level",U=(0,g.cn)("stack"),M=({children:e,className:t})=>(0,C.jsx)("div",{className:U(null,t),children:y.Children.map(e,((e,t)=>y.isValidElement(e)?(0,C.jsx)("div",{className:U("layer"),style:{[R]:t},children:e}):null))});function G({data:e,className:t,stackClassName:s,...a}){const{Donors:n,...r}=e||{},o=n&&n.length>0?(0,C.jsxs)(M,{className:s,children:[(0,C.jsx)(x.y,{data:r,...a}),n.map((e=>{const t=(0,T.NJ)(e);return(0,C.jsx)(x.y,{data:e,...a},(0,f.U9)(t?e.VDiskId:e))}))]}):(0,C.jsx)(x.y,{data:e,...a});return(0,C.jsx)("div",{className:t,children:o})}const L=(0,g.cn)("ydb-storage-vdisks");function z({vDisks:e,viewContext:t,erasure:s}){const a=(0,I.Ep)(e,s);return(0,C.jsx)("div",{className:L("wrapper"),children:null===e||void 0===e?void 0:e.map(((e,s)=>(0,C.jsx)(G,{data:e,inactive:!(0,I.OH)(e,t),delayOpen:w.s,delayClose:w.s,className:L("item",{"with-dc-margin":a.includes(s)})},e.StringifiedId)))})}var W=s(91157),V=s(74319);const _=(0,g.cn)("ydb-storage-groups-columns"),O={name:V.UW.PoolName,header:V.H6.PoolName,width:250,render:({row:e})=>e.PoolName?(0,C.jsx)(d.s,{content:e.PoolName,placement:["right"],openDelay:0,className:_("pool-name-wrapper"),children:(0,C.jsx)("span",{className:_("pool-name"),children:e.PoolName})}):v.Pd,align:n.Ay.LEFT},F={name:V.UW.PileName,header:V.H6.PileName,width:120,render:({row:e})=>e.PileName||v.Pd,align:n.Ay.LEFT},H={name:V.UW.MediaType,header:V.H6.MediaType,width:100,resizeMinWidth:100,align:n.Ay.LEFT,render:({row:e})=>(0,C.jsxs)(r.s,{children:[(0,C.jsx)(o.J,{children:e.MediaType||v.Pd}),"\xa0",e.Encryption&&(0,C.jsx)(i.A,{content:(0,W.A)("encrypted"),placement:"right",className:v.zQ,children:(0,C.jsx)(o.J,{children:(0,C.jsx)(l.I,{data:a.A,size:18})})})]}),sortable:!1},B={name:V.UW.Erasure,header:V.H6.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:({row:e})=>e.ErasureSpecies?e.ErasureSpecies:"-",align:n.Ay.LEFT},$={name:V.UW.Degraded,header:V.H6.Degraded,width:110,resizeMinWidth:110,render:({row:e})=>e.Degraded?(0,C.jsxs)(o.J,{theme:(0,I.k_)(e),children:["Degraded: ",e.Degraded]}):"-",align:n.Ay.LEFT,defaultOrder:n.Ay.DESCENDING},Y={name:V.UW.State,header:V.H6.State,width:150,render:({row:e})=>{var t;return null!==(t=e.State)&&void 0!==t?t:v.Pd},align:n.Ay.LEFT,defaultOrder:n.Ay.DESCENDING},q={name:V.UW.Usage,header:V.H6.Usage,width:85,resizeMinWidth:75,render:({row:e})=>(0,h.f8)(e.Usage)?(0,C.jsx)(m.U,{value:Math.floor(e.Usage),theme:(0,S.f)(e.Usage)}):v.Pd,align:n.Ay.LEFT},J={name:V.UW.DiskSpaceUsage,header:V.H6.DiskSpaceUsage,width:115,resizeMinWidth:75,render:({row:e})=>(0,h.f8)(e.DiskSpaceUsage)?(0,C.jsx)(m.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,S.f)(e.DiskSpaceUsage)}):v.Pd,align:n.Ay.LEFT},K={name:V.UW.GroupId,header:V.H6.GroupId,width:140,render:({row:e})=>e.GroupId?(0,C.jsx)(le,{id:e.GroupId}):"-",sortAccessor:e=>Number(e.GroupId),align:n.Ay.LEFT},Q={name:V.UW.Used,header:V.H6.Used,width:100,render:({row:e})=>(0,k.wb)(e.Used,!0),align:n.Ay.RIGHT},X={name:V.UW.Limit,header:V.H6.Limit,width:100,render:({row:e})=>(0,k.wb)(e.Limit),align:n.Ay.RIGHT},Z={name:V.UW.DiskSpace,header:V.H6.DiskSpace,width:70,render:({row:e})=>(0,C.jsx)(c.k,{status:e.DiskSpace}),align:n.Ay.CENTER},ee={name:V.UW.Read,header:V.H6.Read,width:100,render:({row:e})=>e.Read?(0,k.O4)(e.Read):"-",align:n.Ay.RIGHT},te={name:V.UW.Write,header:V.H6.Write,width:100,render:({row:e})=>e.Write?(0,k.O4)(e.Write):"-",align:n.Ay.RIGHT},se={name:V.UW.Latency,header:V.H6.Latency,width:100,render:({row:e})=>(0,h.f8)(e.LatencyPutTabletLogMs)?(0,b.Xo)(e.LatencyPutTabletLogMs):v.Pd,align:n.Ay.RIGHT},ae={name:V.UW.AllocationUnits,header:V.H6.AllocationUnits,width:150,render:({row:e})=>(0,h.f8)(e.AllocationUnits)?(0,f.ZV)(e.AllocationUnits):v.Pd,align:n.Ay.RIGHT},ne=e=>({name:V.UW.VDisks,header:V.H6.VDisks,className:_("vdisks-column"),render:({row:t})=>(0,C.jsx)(z,{vDisks:t.VDisks,viewContext:null===e||void 0===e?void 0:e.viewContext,erasure:t.ErasureSpecies}),align:n.Ay.CENTER,width:780,resizeable:!1,sortable:!1}),re=e=>({name:V.UW.VDisksPDisks,header:V.H6.VDisksPDisks,className:_("disks-column"),render:({row:t})=>(0,C.jsx)(j,{vDisks:t.VDisks,viewContext:null===e||void 0===e?void 0:e.viewContext,erasure:t.ErasureSpecies}),align:n.Ay.CENTER,width:900,resizeable:!1,sortable:!1}),oe=()=>[K,H,B,q,Q,X],ie=e=>[K,O,F,H,B,$,Y,q,J,Q,X,Z,ee,te,se,ae,ne(e),re(e)].map((e=>({...e,sortable:(0,V.i4)(e.name)})));function le({id:e}){const t=(0,p.zO)();return(0,C.jsx)(u.c,{name:String(e),path:t(e),hasClipboardButton:!0,showStatus:!1})}},74319:(e,t,s)=>{s.d(t,{hu:()=>m,YX:()=>y,LO:()=>g,UW:()=>d,H6:()=>v,qK:()=>i,SE:()=>b,zY:()=>l,GP:()=>x,Ai:()=>c,i4:()=>D,RY:()=>h,kY:()=>k});var a=s(370),n=s(48372);const r=JSON.parse('{"pool-name":"Pool Name","pile-name":"Pile Name","type":"Type","encryption":"Encryption","erasure":"Erasure","degraded":"Degraded","missing-disks":"Missing Disks","state":"State","usage":"Usage","disk-usage":"Disk usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","latency":"Latency","allocation-units":"Allocation Units","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}'),o=(0,n.g4)("ydb-storage-groups-columns",{en:r}),i="storageGroupsColumnsWidth",l="storageGroupsSelectedColumns",d={GroupId:"GroupId",PoolName:"PoolName",PileName:"PileName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",Degraded:"Degraded",State:"State"},u=["DiskSpaceUsage","Latency","AllocationUnits","VDisksPDisks"];function c(e){return u.includes(e)}const m=["GroupId","PoolName","Erasure","Used","VDisks"],p=["DiskSpace"];function h(e){return p.some((t=>t===e))}const g=["GroupId"],v={get PoolName(){return o("pool-name")},get MediaType(){return o("type")},get PileName(){return o("pile-name")},get Erasure(){return o("erasure")},get GroupId(){return o("group-id")},get Used(){return o("used")},get Limit(){return o("limit")},get Usage(){return o("usage")},get DiskSpaceUsage(){return o("disk-usage")},get DiskSpace(){return o("space")},get Read(){return o("read")},get Write(){return o("write")},get Latency(){return o("latency")},get AllocationUnits(){return o("allocation-units")},get VDisks(){return o("vdisks")},get VDisksPDisks(){return o("vdisks-pdisks")},get Degraded(){return o("missing-disks")},get State(){return o("state")}},f={get GroupId(){return o("group-id")},get Erasure(){return o("erasure")},get Usage(){return o("usage")},get DiskSpaceUsage(){return o("disk-usage")},get PoolName(){return o("pool-name")},get PileName(){return o("pile-name")},get Kind(){return o("type")},get Encryption(){return o("encryption")},get MediaType(){return o("type")},get MissingDisks(){return o("missing-disks")},get State(){return o("state")},get Latency(){return o("latency")}},S=["PoolName","PileName","MediaType","Encryption","Erasure","Usage","DiskSpaceUsage","State","MissingDisks","Latency"],b=S.map((e=>({value:e,content:f[e]}))),k=a.z.custom((e=>S.includes(e))).catch(void 0),y={GroupId:["GroupId"],PoolName:["PoolName"],PileName:["PileName"],MediaType:["MediaType","Encryption"],Erasure:["Erasure"],Used:["Used"],Limit:["Limit"],Usage:["Usage"],DiskSpaceUsage:["DiskSpaceUsage"],DiskSpace:["State"],Read:["Read"],Write:["Write"],Latency:["Latency"],AllocationUnits:["AllocationUnits"],VDisks:["VDisk","PDisk","Read","Write"],VDisksPDisks:["VDisk","PDisk","Read","Write"],Degraded:["MissingDisks"],State:["State"]},N={GroupId:"GroupId",PoolName:"PoolName",PileName:void 0,MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:void 0,Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:void 0,VDisksPDisks:void 0,Degraded:"Degraded",State:"State"};function x(e){return N[e]}function D(e){return Boolean(x(e))}},78461:(e,t,s)=>{s.d(t,{Y:()=>n});const a={HDD:"HDD",SSD:"SSD",MVME:"NVME"};function n(e){if(!e)return;const t=function(e,t){const s={};return Object.entries(t).reduce(((t,[a,n])=>{const r=e.length-t,o=r-n;return s[a]=e.substring(o,r)||"0",t+n}),0),s}(BigInt(e).toString(2),{isSolidState:1,kind:55,typeExt:8});if("1"===t.isSolidState)switch(parseInt(t.typeExt,2)){case 0:return a.SSD;case 2:return a.MVME}else if("0"===t.typeExt)return a.HDD}},81101:(e,t,s)=>{s.d(t,{$:()=>o});var a=s(59109),n=s(44508),r=s(60712);const o=e=>403===e.status?(0,r.jsx)(a.O,{position:"left"}):(0,r.jsx)(n.o,{error:e})},86782:(e,t,s)=>{s.d(t,{fN:()=>p,kU:()=>g,kn:()=>m,ri:()=>d,sp:()=>v,uG:()=>u,vg:()=>r,xd:()=>i,zO:()=>n});var a=s(31911);const n="nodesTableColumnsWidth",r={NodeId:"NodeId",Host:"Host",NetworkHost:"NetworkHost",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"RAM",CPU:"CPU",Pools:"Pools",LoadAverage:"LoadAverage",Load:"Load",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:"TotalSessions",Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:"Tablets",PDisks:"PDisks",PileName:"PileName"},o=["Pools","Memory"];function i(e){return o.includes(e)}const l=["LoadAverage","PDisks"];function d(e){return l.some((t=>t===e))}const u={get NodeId(){return(0,a.A)("node-id")},get Host(){return(0,a.A)("host")},get NetworkHost(){return(0,a.A)("host")},get Database(){return(0,a.A)("database")},get NodeName(){return(0,a.A)("node-name")},get DC(){return(0,a.A)("dc")},get Rack(){return(0,a.A)("rack")},get Version(){return(0,a.A)("version")},get Uptime(){return(0,a.A)("uptime")},get Memory(){return(0,a.A)("memory")},get RAM(){return(0,a.A)("ram")},get Pools(){return(0,a.A)("pools")},get CPU(){return(0,a.A)("cpu")},get LoadAverage(){return(0,a.A)("load-average")},get Load(){return(0,a.A)("load")},get DiskSpaceUsage(){return(0,a.A)("disk-usage")},get TotalSessions(){return(0,a.A)("sessions")},get Connections(){return(0,a.A)("connections")},get NetworkUtilization(){return(0,a.A)("utilization")},get SendThroughput(){return(0,a.A)("send")},get ReceiveThroughput(){return(0,a.A)("receive")},get PingTime(){return(0,a.A)("ping")},get ClockSkew(){return(0,a.A)("skew")},get Missing(){return(0,a.A)("missing")},get Tablets(){return(0,a.A)("tablets")},get PDisks(){return(0,a.A)("pdisks")},get PileName(){return(0,a.A)("field_pile-name")}},c={get NodeId(){return(0,a.A)("node-id")},get Host(){return(0,a.A)("host")},get NodeName(){return(0,a.A)("node-name")},get Database(){return(0,a.A)("database")},get DiskSpaceUsage(){return(0,a.A)("disk-usage")},get DC(){return(0,a.A)("dc")},get Rack(){return(0,a.A)("rack")},get Missing(){return(0,a.A)("missing")},get Uptime(){return(0,a.A)("uptime")},get Version(){return(0,a.A)("version")},get SystemState(){return(0,a.A)("system-state")},get ConnectStatus(){return(0,a.A)("connect-status")},get NetworkUtilization(){return(0,a.A)("network-utilization")},get ClockSkew(){return(0,a.A)("clock-skew")},get PingTime(){return(0,a.A)("ping-time")},get PileName(){return(0,a.A)("field_pile-name")}};function m(e){return c[e]}const p={NodeId:["NodeId"],Host:["Host","Rack","Database","SystemState"],NetworkHost:["Host","Rack","Database","SystemState","ConnectStatus"],Database:["Database"],NodeName:["NodeName"],DC:["DC"],Rack:["Rack"],Version:["Version"],Uptime:["Uptime","DisconnectTime"],Memory:["Memory","MemoryDetailed"],RAM:["Memory"],Pools:["CPU"],CPU:["CPU"],LoadAverage:["LoadAverage"],Load:["LoadAverage"],DiskSpaceUsage:["DiskSpaceUsage"],TotalSessions:["SystemState"],Connections:["Connections"],NetworkUtilization:["NetworkUtilization"],SendThroughput:["SendThroughput"],ReceiveThroughput:["ReceiveThroughput"],PingTime:["PingTime"],ClockSkew:["ClockSkew"],Missing:["Missing"],Tablets:["Tablets","Database"],PDisks:["PDisks"],PileName:["PileName"]},h={NodeId:"NodeId",Host:"Host",NetworkHost:"Host",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"Memory",CPU:"CPU",Pools:"CPU",LoadAverage:"LoadAverage",Load:"LoadAverage",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:void 0,Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:void 0,PDisks:void 0,PileName:void 0};function g(e){return h[e]}function v(e){return Boolean(g(e))}},88226:(e,t,s)=>{s.d(t,{V:()=>d});s(59284);var a=s(77506),n=s(76086),r=s(7187),o=s(47779),i=s(60712);const l=(0,a.cn)("storage-disk-progress-bar");function d({diskAllocatedPercent:e=-1,severity:t,compact:s,faded:a,inactive:d,empty:u,content:c,className:m}){const[p]=(0,o.iK)(n.TJ),h={inverted:p,compact:s,faded:a,empty:u,inactive:d},g=void 0!==t&&(0,r.XY)(t);g&&(h[g.toLocaleLowerCase()]=!0);return(0,i.jsxs)("div",{className:l(h,m),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":e,children:[(()=>{if(s)return(0,i.jsx)("div",{className:l("fill-bar",h),style:{width:"100%"}});let t=Math.min(e,100);return p&&(t=Math.max(100-e,0)),e>=0?(0,i.jsx)("div",{className:l("fill-bar",h),style:{width:`${t}%`}}):null})(),c||(!s&&e>=0?(0,i.jsx)("div",{className:l("title"),children:`${Math.floor(e)}%`}):null)]})}},90053:(e,t,s)=>{s.d(t,{E:()=>h});var a=s(8873),n=s(80136),r=s(12207),o=s(21334),i=s(77506),l=s(47779),d=s(48372);const u=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),c=(0,d.g4)("ydb-diagnostics-autorefresh-control",{en:u});var m=s(60712);const p=(0,i.cn)("auto-refresh-control");function h({className:e,onManualRefresh:t}){const s=(0,l.YQ)(),[i,d]=(0,l.Nt)();return(0,m.jsxs)("div",{className:p(null,e),children:[(0,m.jsx)(n.$,{view:"flat-secondary",onClick:()=>{s(o.F.util.invalidateTags(["All"])),null===t||void 0===t||t()},"aria-label":c("Refresh"),children:(0,m.jsx)(n.$.Icon,{children:(0,m.jsx)(a.A,{})})}),(0,m.jsxs)(r.l,{value:[String(i)],onUpdate:e=>{d(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,m.jsx)(r.l.Option,{value:"0",children:c("None")}),(0,m.jsx)(r.l.Option,{value:"15000",children:c("15 sec")}),(0,m.jsx)(r.l.Option,{value:"60000",children:c("1 min")}),(0,m.jsx)(r.l.Option,{value:"120000",children:c("2 min")}),(0,m.jsx)(r.l.Option,{value:"300000",children:c("5 min")})]})]})}},90327:(e,t,s)=>{s.d(t,{AB:()=>l,HW:()=>r,Sb:()=>d});var a=s(41650),n=s(27662);function r(e){const t=o(e.AllocatedMemory)||0,s=o(e.AllocatorCachesMemory)||0;return String(t+s)}function o(e){return(0,a.kf)(e)?parseFloat(String(e)):void 0}const i={AllocatorCachesMemory:"var(--g-color-base-danger-medium)",SharedCacheConsumption:"var(--g-color-base-info-medium)",MemTableConsumption:"var(--g-color-base-warning-medium)",QueryExecutionConsumption:"var(--g-color-base-positive-medium)",Other:"var(--g-color-base-neutral-medium)"};function l(e){return i[e]||i.Other}function d(e,t){const s=[{label:(0,n.A)("text_shared-cache"),key:"SharedCacheConsumption",value:o(e.SharedCacheConsumption),capacity:o(e.SharedCacheLimit),isInfo:!1},{label:(0,n.A)("text_query-execution"),key:"QueryExecutionConsumption",value:o(e.QueryExecutionConsumption),capacity:o(e.QueryExecutionLimit),isInfo:!1},{label:(0,n.A)("text_memtable"),key:"MemTableConsumption",value:o(e.MemTableConsumption),capacity:o(e.MemTableLimit),isInfo:!1},{label:(0,n.A)("text_allocator-caches"),key:"AllocatorCachesMemory",value:o(e.AllocatorCachesMemory),isInfo:!1}],a=s.filter((e=>void 0!==e.value)).reduce(((e,t)=>e+t.value),0),r=Math.max(0,t-a);return s.push({label:(0,n.A)("text_other"),key:"Other",value:r,isInfo:!1}),s.push({label:(0,n.A)("text_external-consumption"),key:"ExternalConsumption",value:o(e.ExternalConsumption),isInfo:!0},{label:(0,n.A)("text_usage"),key:"Usage",value:t,isInfo:!0},{label:(0,n.A)("text_soft-limit"),key:"SoftLimit",value:o(e.SoftLimit),isInfo:!0},{label:(0,n.A)("text_hard-limit"),key:"HardLimit",value:o(e.HardLimit),isInfo:!0}),s.filter((e=>void 0!==e.value))}},91157:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(48372);const n=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),r=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),o=(0,a.g4)("ydb-storage-groups",{ru:r,en:n})},94025:(e,t,s)=>{s.d(t,{t:()=>a});let a=function(e){return e.Initial="Initial",e.InitialFormatRead="InitialFormatRead",e.InitialFormatReadError="InitialFormatReadError",e.InitialSysLogRead="InitialSysLogRead",e.InitialSysLogReadError="InitialSysLogReadError",e.InitialSysLogParseError="InitialSysLogParseError",e.InitialCommonLogRead="InitialCommonLogRead",e.InitialCommonLogReadError="InitialCommonLogReadError",e.InitialCommonLogParseError="InitialCommonLogParseError",e.CommonLoggerInitError="CommonLoggerInitError",e.Normal="Normal",e.OpenFileError="OpenFileError",e.ChunkQuotaError="ChunkQuotaError",e.DeviceIoError="DeviceIoError",e.Stopped="Stopped",e.Missing="Missing",e.Timeout="Timeout",e.NodeDisconnected="NodeDisconnected",e.Unknown="Unknown",e}({})},95109:(e,t,s)=>{s.d(t,{pt:()=>pe,SH:()=>le,fr:()=>te,uk:()=>Y,Bg:()=>ne,Nh:()=>H,ID:()=>se,fR:()=>ae,iX:()=>Z,Vz:()=>ie,b8:()=>B,H:()=>de,_E:()=>F,eT:()=>$,OV:()=>J,wN:()=>me,kv:()=>ee,pH:()=>X,OX:()=>q,ui:()=>ce,DH:()=>ue,oz:()=>re,qp:()=>oe,jl:()=>Q,Rn:()=>K});var a=s(4557),n=s(90101),r=s(7435),o=s(77506),i=s(76086),l=s(56839),d=s(16439),u=s(41650),c=s(71661),m=s(27160),p=s(32752),h=s(46549),g=s(35736),v=s(50229),f=s(15132),S=s(90327),b=s(60712);const k=1,y=.01*i.J7,N=(0,o.cn)("memory-viewer"),x=(e,t)=>[(0,h.z3)({value:e,size:"gb",withSizeLabel:!1,precision:2}),(0,h.z3)({value:t,size:"gb",withSizeLabel:!0,precision:1})];function D({stats:e,percents:t,formatValues:s,className:a,warningThreshold:r,dangerThreshold:o}){var i;const l=null!==(i=e.AnonRss)&&void 0!==i?i:(0,S.HW)(e),d=e.HardLimit,c=(0,m.D)();let D=Math.floor(parseFloat(String(l))/parseFloat(String(d))*100)||0;D=D>100?100:D;let w=l,I=d,C="/";t?(w=D+"%",I="",C=""):s&&([w,I]=s(Number(l),Number(d)));const P=(0,S.Sb)(e,Number(l)),j=(0,g.w)({fillWidth:D,warningThreshold:r,dangerThreshold:o,colorizeProgress:!0});let E=0;return(0,b.jsx)(v.P,{renderPopupContent:()=>(0,b.jsx)(n.u,{responsive:!0,children:P.map((({label:e,value:t,capacity:s,key:a})=>(0,b.jsx)(n.u.Item,{name:(0,b.jsxs)(p.s,{alignItems:"center",gap:"1",className:N("container"),children:[(0,b.jsx)("div",{className:N("legend",{type:a})}),(0,b.jsx)("div",{className:N("name"),children:e})]}),children:s?(0,b.jsx)(f.O,{value:t,capacity:s,formatValues:x,colorizeProgress:!0}):(0,h.z3)({value:t,size:"gb",withSizeLabel:!0,precision:2})},e)))}),children:(0,b.jsx)("div",{className:N({theme:c,status:j},a),children:(0,b.jsxs)("div",{className:N("progress-container"),children:[P.filter((({isInfo:e})=>!e)).map((e=>{if(e.value<y)return null;const t=Math.max((s=e.value,l?s/parseFloat(String(d))*100:0),k);var s;const a=E;return E+=t,(0,b.jsx)("div",{className:N("segment",{type:e.key}),style:{width:`${t}%`,left:`${a}%`}},e.key)})),(0,b.jsx)(p.s,{justifyContent:"center",alignItems:"center",className:N("text"),children:(0,u.kf)(d)?`${w} ${C} ${I}`:w})]})})})}var w=s(92459),I=s(78034),C=s(10508),P=s(80176);const j=({node:e,database:t,statusForIcon:s="SystemState"})=>{if(!e.Host)return i.Pd;const a="ConnectStatus"===s?e.ConnectStatus:e.SystemState,n=!(0,I.X7)(e),r=(0,I.wH)(e)?void 0:null!==t&&void 0!==t?t:e.TenantName,o=n?(0,w.vI)({id:e.NodeId,activeTab:e.TenantName?"tablets":"storage"},{database:r}):void 0;return(0,b.jsx)(C.c,{name:e.Host,status:a,path:o,hasClipboardButton:!0,infoPopoverContent:n?(0,b.jsx)(P.p,{data:e}):null})};var E=s(48295),A=s(52905),T=s(58267);const R=(0,o.cn)("tablets-statistic"),U=({tablets:e=[],database:t,nodeId:s})=>{const a=(e=>e.map((e=>({label:(0,i.bk)(e.Type),type:e.Type,count:e.Count,state:(0,T.P)(e.State)}))).sort(((e,t)=>String(e.label).localeCompare(String(t.label)))))(e);return(0,b.jsx)("div",{className:R(),children:a.map(((e,a)=>{var n;const r=(0,w.vI)({id:s,activeTab:"tablets"},{database:t}),o=`${e.label}: ${e.count}`,i=R("tablet",{state:null===(n=e.state)||void 0===n?void 0:n.toLowerCase()});return(0,b.jsx)(A.N_,{to:r,className:i,children:o},a)}))})};var M=s(41826),G=s(12535),L=s(86782),z=s(31911),W=s(73891);function V(e){return(0,W.Xo)((0,W.Jc)(e,1))}function _(e){const t=(0,W.Jc)(e,1);return(Number(t)<=0?"":"+")+(0,W.Xo)(t)}const O=(0,o.cn)("ydb-nodes-columns");function F(){return{name:L.vg.NodeId,header:"#",width:80,resizeMinWidth:80,render:({row:e})=>e.NodeId,align:a.Ay.RIGHT}}function H({database:e}){return{name:L.vg.Host,header:L.uG.Host,render:({row:t})=>(0,b.jsx)(j,{node:t,database:e}),width:350,align:a.Ay.LEFT}}function B({database:e}){return{name:L.vg.NetworkHost,header:L.uG.NetworkHost,render:({row:t})=>(0,b.jsx)(j,{node:t,database:e,statusForIcon:"ConnectStatus"}),width:350,align:a.Ay.LEFT}}function $(){return{name:L.vg.NodeName,header:L.uG.NodeName,align:a.Ay.LEFT,render:({row:e})=>e.NodeName||i.Pd,width:200}}function Y(){return{name:L.vg.DC,header:L.uG.DC,align:a.Ay.LEFT,render:({row:e})=>e.DC||i.Pd,width:60}}function q(){return{name:L.vg.Rack,header:L.uG.Rack,align:a.Ay.LEFT,render:({row:e})=>e.Rack||i.Pd,width:100}}function J(){return{name:L.vg.PileName,header:(0,z.A)("field_pile-name"),align:a.Ay.LEFT,render:({row:e})=>e.PileName||i.Pd,width:100}}function K(){return{name:L.vg.Version,header:L.uG.Version,width:200,align:a.Ay.LEFT,render:({row:e})=>(0,b.jsx)(c.s,{content:e.Version,children:e.Version})}}function Q(){return{name:L.vg.Uptime,header:L.uG.Uptime,sortAccessor:({StartTime:e})=>e?-e:0,render:({row:e})=>(0,b.jsx)(M.p,{StartTime:e.StartTime,DisconnectTime:e.DisconnectTime}),align:a.Ay.RIGHT,width:120}}function X(){return{name:L.vg.RAM,header:L.uG.RAM,sortAccessor:({MemoryUsed:e=0})=>Number(e),defaultOrder:a.Ay.DESCENDING,render:({row:e})=>{const[t,s]=(0,u.kf)(e.MemoryUsed)&&(0,u.kf)(e.MemoryLimit)?(0,l.j9)(Number(e.MemoryUsed),Number(e.MemoryLimit),"gb",void 0,!0):[0,0];return(0,b.jsx)(c.s,{placement:["top","bottom"],fullWidth:!0,content:(0,b.jsxs)(n.u,{responsive:!0,children:[(0,b.jsx)(n.u.Item,{name:(0,z.A)("field_memory-used"),children:t}),(0,b.jsx)(n.u.Item,{name:(0,z.A)("field_memory-limit"),children:s})]}),children:(0,b.jsx)(f.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:(e,t)=>(0,l.j9)(e,t,"gb",void 0,!0),className:O("column-ram"),colorizeProgress:!0,hideCapacity:!0})})},align:a.Ay.LEFT,width:80,resizeMinWidth:40}}function Z(){return{name:L.vg.Memory,header:L.uG.Memory,defaultOrder:a.Ay.DESCENDING,render:({row:e})=>e.MemoryStats?(0,b.jsx)(D,{formatValues:l.vX,stats:e.MemoryStats}):(0,b.jsx)(f.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:l.vX,colorizeProgress:!0}),align:a.Ay.LEFT,width:300,resizeMinWidth:170}}function ee(){return{name:L.vg.Pools,header:L.uG.Pools,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map((({Usage:e})=>Number(e)))),defaultOrder:a.Ay.DESCENDING,render:({row:e})=>e.PoolStats?(0,b.jsx)(E._,{pools:e.PoolStats}):i.Pd,align:a.Ay.LEFT,width:80,resizeMinWidth:60}}function te(){return{name:L.vg.CPU,header:L.uG.CPU,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map((({Usage:e})=>Number(e)))),defaultOrder:a.Ay.DESCENDING,render:({row:e})=>{if(!e.PoolStats)return i.Pd;let t=(0,u.kf)(e.CoresUsed)&&(0,u.kf)(e.CoresTotal)?e.CoresUsed/e.CoresTotal:void 0;if(void 0===t){let s=0;t=e.PoolStats.reduce(((e,t)=>(s+=Number(t.Threads),e+Number(t.Usage)*Number(t.Threads))),0),t/=s}return(0,b.jsx)(c.s,{placement:["top","bottom"],fullWidth:!0,content:(0,b.jsx)(n.u,{responsive:!0,children:e.PoolStats.map((e=>(0,u.kf)(e.Usage)?(0,b.jsx)(n.u.Item,{name:e.Name,children:(0,P.Qz)("Usage",e.Usage).value},e.Name):null))}),children:(0,b.jsx)(f.O,{className:O("column-cpu"),value:t,capacity:1,colorizeProgress:!0,percents:!0})})},align:a.Ay.LEFT,width:80,resizeMinWidth:40}}function se(){return{name:L.vg.LoadAverage,header:L.uG.LoadAverage,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:a.Ay.DESCENDING,render:({row:e})=>(0,b.jsx)(f.O,{value:e.LoadAveragePercents&&e.LoadAveragePercents.length>0?e.LoadAveragePercents[0]:void 0,percents:!0,colorizeProgress:!0,capacity:100}),align:a.Ay.LEFT,width:170,resizeMinWidth:170}}function ae(){return{name:L.vg.Load,header:L.uG.Load,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:a.Ay.DESCENDING,render:({row:e})=>e.LoadAveragePercents&&e.LoadAveragePercents.length>0?(0,b.jsx)(G.U,{value:e.LoadAveragePercents[0].toFixed(),theme:(0,d.f)(e.LoadAveragePercents[0])}):i.Pd,align:a.Ay.LEFT,width:80,resizeMinWidth:70}}function ne(){return{name:L.vg.DiskSpaceUsage,header:L.uG.DiskSpaceUsage,render:({row:e})=>(0,r.f8)(e.DiskSpaceUsage)?(0,b.jsx)(G.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,d.f)(e.DiskSpaceUsage)}):i.Pd,align:a.Ay.LEFT,width:115,resizeMinWidth:75}}function re(){return{name:L.vg.TotalSessions,header:L.uG.TotalSessions,render:({row:e})=>{var t;return null!==(t=e.TotalSessions)&&void 0!==t?t:i.Pd},align:a.Ay.RIGHT,width:100}}function oe({database:e}){return{name:L.vg.Tablets,header:L.uG.Tablets,width:500,resizeMinWidth:500,render:({row:t})=>t.Tablets?(0,b.jsx)(U,{database:null!==e&&void 0!==e?e:t.TenantName,nodeId:t.NodeId,tablets:t.Tablets}):i.Pd,align:a.Ay.LEFT,sortable:!1}}function ie(){return{name:L.vg.Missing,header:L.uG.Missing,render:({row:e})=>e.Missing,align:a.Ay.CENTER,defaultOrder:a.Ay.DESCENDING,width:100}}function le(){return{name:L.vg.Connections,header:L.uG.Connections,render:({row:e})=>(0,u.kf)(e.Connections)?e.Connections:i.Pd,align:a.Ay.RIGHT,width:130}}function de(){return{name:L.vg.NetworkUtilization,header:L.uG.NetworkUtilization,render:({row:e})=>{const{NetworkUtilization:t,NetworkUtilizationMin:s=0,NetworkUtilizationMax:a=0}=e;return(0,u.kf)(t)?(0,b.jsx)(c.s,{placement:["top","bottom"],content:(0,b.jsxs)(n.u,{responsive:!0,children:[(0,b.jsx)(n.u.Item,{name:(0,z.A)("sum"),children:(0,l.l9)(t)},"NetworkUtilization"),(0,b.jsx)(n.u.Item,{name:(0,z.A)("min"),children:(0,l.l9)(s)},"NetworkUtilizationMin"),(0,b.jsx)(n.u.Item,{name:(0,z.A)("max"),children:(0,l.l9)(a)},"NetworkUtilizationMax")]}),children:(0,l.l9)(t)}):i.Pd},align:a.Ay.RIGHT,width:110}}function ue(){return{name:L.vg.SendThroughput,header:L.uG.SendThroughput,render:({row:e})=>(0,u.kf)(e.SendThroughput)?(0,u.O4)(e.SendThroughput):i.Pd,align:a.Ay.RIGHT,width:110}}function ce(){return{name:L.vg.ReceiveThroughput,header:L.uG.ReceiveThroughput,render:({row:e})=>(0,u.kf)(e.ReceiveThroughput)?(0,u.O4)(e.ReceiveThroughput):i.Pd,align:a.Ay.RIGHT,width:110}}function me(){return{name:L.vg.PingTime,header:L.uG.PingTime,render:({row:e})=>{const{PingTimeUs:t,PingTimeMinUs:s=0,PingTimeMaxUs:a=0}=e;return(0,u.kf)(t)?(0,b.jsx)(c.s,{placement:["top","bottom"],content:(0,b.jsxs)(n.u,{responsive:!0,children:[(0,b.jsx)(n.u.Item,{name:(0,z.A)("avg"),children:V(t)},"PingTimeUs"),(0,b.jsx)(n.u.Item,{name:(0,z.A)("min"),children:V(s)},"PingTimeMinUs"),(0,b.jsx)(n.u.Item,{name:(0,z.A)("max"),children:V(a)},"PingTimeMaxUs")]}),children:V(t)}):i.Pd},align:a.Ay.RIGHT,width:110}}function pe(){return{name:L.vg.ClockSkew,header:L.uG.ClockSkew,render:({row:e})=>{const{ClockSkewUs:t,ClockSkewMinUs:s=0,ClockSkewMaxUs:a=0}=e;return(0,u.kf)(t)?(0,b.jsx)(c.s,{placement:["top","bottom"],content:(0,b.jsxs)(n.u,{responsive:!0,children:[(0,b.jsx)(n.u.Item,{name:(0,z.A)("avg"),children:_(t)},"ClockSkewUs"),(0,b.jsx)(n.u.Item,{name:(0,z.A)("min"),children:_(s)},"ClockSkewMinUs"),(0,b.jsx)(n.u.Item,{name:(0,z.A)("max"),children:_(a)},"ClockSkewMaxUs")]}),children:_(t)}):i.Pd},align:a.Ay.RIGHT,width:110}}},96927:(e,t,s)=>{s.d(t,{O:()=>y,f:()=>k});var a=s(59284),n=s(32752),r=s(24600),o=s(54090),i=s(7435),l=s(76086),d=s(31684),u=s(47779),c=s(28232),m=s(12888),p=s(41650),h=s(60073),g=s(25196),v=s(50672),f=s(59753),S=s(60712);const b=[o.m.Orange,o.m.Red,o.m.Yellow],k=(e,t,s)=>{const{AvailableSize:a,TotalSize:r,State:o,PDiskId:u,NodeId:c,StringifiedId:m,Path:h,Realtime:k,Type:y,Device:N}=e,x=[{label:"PDisk",value:null!==m&&void 0!==m?m:l.Pd},{label:"State",value:o||"not available"},{label:"Type",value:y||"unknown"}];if(c&&x.push({label:"Node Id",value:c}),null!==t&&void 0!==t&&t.Host&&x.push({label:"Host",value:t.Host}),null!==t&&void 0!==t&&t.DC&&x.push({label:"DC",value:t.DC}),h&&x.push({label:"Path",value:h}),(0,p.kf)(r)&&x.push({label:"Available",value:`${(0,p.wb)(a)} of ${(0,p.wb)(r)}`}),k&&b.includes(k)&&x.push({label:"Realtime",value:k}),N&&b.includes(N)&&x.push({label:"Device",value:N}),s&&(0,i.f8)(c)&&(0,i.f8)(u)){const e=(0,d.ar)({nodeId:c,pDiskId:u});x.push({label:"Links",value:(0,S.jsxs)(n.s,{gap:2,wrap:"wrap",children:[(0,S.jsx)(f.L,{pDiskId:u,nodeId:c}),(0,S.jsx)(g.K,{title:(0,v.D)("developer-ui"),url:e})]})})}return x},y=({data:e})=>{const t=(0,c.J)(),s=(0,m.X)(),n=(0,u.N4)((e=>(0,r.K)(e,t))),o=(0,i.f8)(e.NodeId)?null===n||void 0===n?void 0:n.get(e.NodeId):void 0,l=a.useMemo((()=>k(e,o,s)),[e,o,s]);return(0,S.jsx)(h.z_,{title:"PDisk",info:l,size:"s"})}}}]);