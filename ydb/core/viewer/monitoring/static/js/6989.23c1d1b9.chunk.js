"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[6989],{52248:(e,t,a)=>{a.d(t,{a:()=>s.a});var s=a(47334)},56735:(e,t,a)=>{a.d(t,{Q:()=>j});var s=a(87184),i=a(92459),l=a(78668),n=a(7435),d=a(46549),r=a(77506),o=a(86200),c=a(31684),u=a(90182),v=a(18863),p=a(25196),h=a(15132),m=a(33775),g=a(48372);const b=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),x=(0,g.g4)("ydb-pDisk-info",{en:b});var N=a(60712);const f=(0,r.cn)("ydb-pdisk-info");function j({pDisk:e,nodeId:t,withPDiskPageLink:a,className:r}){const g=(0,u.N4)(l._5),[b,j,k,I]=function({pDisk:e,nodeId:t,withPDiskPageLink:a,isUserAllowedToMakeChanges:s}){const{PDiskId:l,Path:r,Guid:u,Category:v,Type:g,Device:b,Realtime:j,State:k,SerialNumber:I,TotalSize:y,AllocatedSize:w,StatusV2:T,NumActiveSlots:S,ExpectedSlotCount:D,LogUsedSize:z,LogTotalSize:P,SystemSize:A,SharedWithOs:C}=e||{},E=[];(0,n.f8)(v)&&E.push({label:x("type"),value:g}),(0,n.f8)(r)&&E.push({label:x("path"),value:r}),(0,n.f8)(u)&&E.push({label:x("guid"),value:u}),I&&E.push({label:x("serial-number"),value:I}),(0,n.f8)(C)&&E.push({label:x("shared-with-os"),value:x("yes")});const V=[];(0,n.f8)(T)&&V.push({label:x("drive-status"),value:T}),(0,n.f8)(k)&&V.push({label:x("state"),value:k}),(0,n.f8)(b)&&V.push({label:x("device"),value:(0,N.jsx)(m.k,{status:b})}),(0,n.f8)(j)&&V.push({label:x("realtime"),value:(0,N.jsx)(m.k,{status:j})});const O=[];O.push({label:x("space"),value:(0,N.jsx)(h.O,{value:w,capacity:y,formatValues:o.vX,colorizeProgress:!0})}),(0,n.f8)(S)&&(0,n.f8)(D)&&O.push({label:x("slots"),value:(0,N.jsx)(h.O,{value:S,capacity:D})}),(0,n.f8)(z)&&(0,n.f8)(P)&&O.push({label:x("log-size"),value:(0,N.jsx)(h.O,{value:z,capacity:P,formatValues:o.vX})}),(0,n.f8)(A)&&O.push({label:x("system-size"),value:(0,d.z3)({value:A})});const q=[];if((a||s)&&(0,n.f8)(l)&&(0,n.f8)(t)){const e=(0,i.Ck)(l,t),n=(0,c.ar)({nodeId:t,pDiskId:l});q.push({label:x("links"),value:(0,N.jsxs)("span",{className:f("links"),children:[a&&(0,N.jsx)(p.K,{title:x("pdisk-page"),url:e,external:!1}),s&&(0,N.jsx)(p.K,{title:x("developer-ui"),url:n})]})})}return[E,V,O,q]}({pDisk:e,nodeId:t,withPDiskPageLink:a,isUserAllowedToMakeChanges:g});return(0,N.jsxs)(s.s,{className:r,gap:2,direction:"row",wrap:!0,children:[(0,N.jsxs)(s.s,{direction:"column",gap:2,width:500,children:[(0,N.jsx)(v.z,{info:b,renderEmptyState:()=>null}),(0,N.jsx)(v.z,{info:k,renderEmptyState:()=>null})]}),(0,N.jsxs)(s.s,{direction:"column",gap:2,width:500,children:[(0,N.jsx)(v.z,{info:j,renderEmptyState:()=>null}),(0,N.jsx)(v.z,{info:I,renderEmptyState:()=>null})]})]})}},80420:(e,t,a)=>{a.d(t,{$:()=>g});var s=a(40336),i=a(63291),l=a(92459),n=a(78668),d=a(31684),r=a(90182),o=a(71661),c=a(10508),u=a(25196),v=a(48372);const p=JSON.parse('{"field_links":"Links","context_developer-ui":"Developer UI"}'),h=(0,v.g4)("ydb-tablet-name-wrapper",{en:p});var m=a(60712);function g({tabletId:e,database:t}){const a=(0,r.N4)(n._5),v=(0,l.DM)(e,{database:t});return(0,m.jsx)(o.s,{disabled:!a,delayClosing:200,content:(0,m.jsx)(s.u,{responsive:!0,children:(0,m.jsx)(s.u.Item,{name:h("field_links"),children:(0,m.jsx)(u.K,{title:h("context_developer-ui"),url:(0,d._t)(e)})})}),placement:["top","bottom"],behavior:i.m.Immediate,children:(0,m.jsx)(c.c,{name:e.toString(),path:v,hasClipboardButton:!0,showStatus:!1})})}},27775:(e,t,a)=>{a.d(t,{i:()=>n});var s=a(47665),i=a(58267),l=a(60712);function n({state:e}){return(0,l.jsx)(s.J,{theme:(0,i._8)(e),children:e})}},59984:(e,t,a)=>{a.d(t,{Y:()=>r});a(59284);var s=a(87184),i=a(77506),l=a(60712);const n=(0,i.cn)("tag"),d=({text:e,type:t})=>(0,l.jsx)("div",{className:n({type:t}),children:e}),r=({tags:e,tagsType:t,className:a="",gap:i=1})=>(0,l.jsx)(s.s,{className:a,gap:i,wrap:"wrap",alignItems:"center",children:e&&e.map(((e,a)=>(0,l.jsx)(d,{text:e,type:t},a)))})},49020:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>je,STORAGE_ROLE:()=>fe});var s=a(59284),i=a(23871),l=a(61750),n=a(10755),d=a(52905),r=a(67087),o=a(90053),c=a(112),u=a(99991),v=a(77506),p=a(31684),h=a(10508),m=a(59984),g=a(60712);const b=(0,v.cn)("basic-node-viewer"),x=({node:e,additionalNodesProps:t,className:a})=>{let i;if(null!==t&&void 0!==t&&t.getNodeRef){const a=t.getNodeRef(e);i=a?(0,p.Un)(a):void 0}else if(e.NodeId){const t=(0,p.Kx)(e.NodeId);i=(0,p.Un)(t)}return(0,g.jsx)("div",{className:b(null,a),children:e?(0,g.jsxs)(s.Fragment,{children:[(0,g.jsx)("div",{className:b("title"),children:"Node"}),(0,g.jsx)(h.c,{status:e.SystemState,name:e.Host}),i&&(0,g.jsx)("a",{rel:"noopener noreferrer",className:b("link",{external:!0}),href:i,target:"_blank",children:(0,g.jsx)(u.I,{data:c.A})}),(0,g.jsxs)("div",{className:b("id"),children:[(0,g.jsx)("label",{className:b("label"),children:"NodeID"}),(0,g.jsx)("label",{children:e.NodeId})]}),e.DC&&(0,g.jsx)(m.Y,{tags:[e.DC]}),e.Roles&&(0,g.jsx)(m.Y,{tags:e.Roles,tagsType:"blue"})]}):(0,g.jsx)("div",{className:"error",children:"no data"})})};var N=a(44508),f=a(76086),j=a(18863);const k=(0,v.cn)("ydb-pool-usage"),I=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},y=({data:e={}})=>{const{Threads:t,Name:a="Unknown",Usage:s=0}=e,i=s&&t,l=Math.floor(100*s),n=l>100?100:l;return(0,g.jsxs)("div",{className:k(),children:[(0,g.jsxs)("div",{className:k("info"),children:[(0,g.jsx)("div",{className:k("pool-name"),children:a}),i&&(0,g.jsxs)("div",{className:k("value"),children:[(0,g.jsxs)("div",{className:k("percents"),children:[l<1?"<1":l,"%"]}),(0,g.jsxs)("div",{className:k("threads"),children:["(\xd7",t,")"]})]})]}),(0,g.jsx)("div",{className:k("visual"),children:(0,g.jsx)("div",{className:k("usage-line",{type:I(n)}),style:{width:`${n}%`}})})]})};var w=a(15132);const T=(0,v.cn)("full-node-viewer"),S=({node:e,className:t})=>{var a,s,i,l;const n=null===e||void 0===e||null===(a=e.Endpoints)||void 0===a?void 0:a.map((({Name:e,Address:t})=>({label:e,value:t}))),d=[];null!==e&&void 0!==e&&null!==(s=e.Tenants)&&void 0!==s&&s.length&&d.push({label:"Database",value:e.Tenants[0]}),d.push({label:"Version",value:null===e||void 0===e?void 0:e.Version},{label:"Uptime",value:null===e||void 0===e?void 0:e.Uptime},{label:"DC",value:(null===e||void 0===e?void 0:e.DataCenterDescription)||(null===e||void 0===e?void 0:e.DC)},{label:"Rack",value:null===e||void 0===e?void 0:e.Rack});const r=null===e||void 0===e||null===(i=e.LoadAveragePercents)||void 0===i?void 0:i.map(((e,t)=>({label:f.GT[t],value:(0,g.jsx)(w.O,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,g.jsx)("div",{className:`${T()} ${t}`,children:e?(0,g.jsxs)("div",{className:T("common-info"),children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:T("section-title"),children:"Pools"}),(0,g.jsx)("div",{className:T("section",{pools:!0}),children:null===e||void 0===e||null===(l=e.PoolStats)||void 0===l?void 0:l.map(((e,t)=>(0,g.jsx)(y,{data:e},t)))})]}),n&&n.length&&(0,g.jsx)(j.z,{title:"Endpoints",className:T("section"),info:n}),(0,g.jsx)(j.z,{title:"Common info",className:T("section"),info:d}),(0,g.jsx)(j.z,{title:"Load average",className:T("section",{average:!0}),info:r})]}):(0,g.jsx)("div",{className:"error",children:"no data"})})};var D=a(52248),z=a(92459),P=a(67028),A=a(40174),C=a(21334),E=a(78034);const V=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,E.q1)(a)},O=C.F.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async({nodeId:e},{signal:t})=>{try{const a=await window.api.viewer.getNodeInfo(e,{signal:t});return{data:V(a)}}catch(a){return{error:a}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async({nodeId:e},{signal:t})=>{try{return{data:await window.api.viewer.getStorageInfo({nodeId:e},{signal:t})}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"});var q=a(90182),R=a(41122),F=a(76768),L=a(29819),U=a(905),M=a.n(U),_=a(53850),G=a(86200),Q=a(27295);const $=(0,_.Mz)((e=>e),(e=>O.endpoints.getNodeStructure.select({nodeId:e}))),X=(0,_.Mz)((e=>e),((e,t)=>$(t)),((e,t)=>t(e).data)),Y=(0,_.Mz)(((e,t)=>Number(t)),((e,t)=>X(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,s={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var i;const l=null===(i=a.VDisks)||void 0===i?void 0:i.filter((t=>t.NodeId===e)).map(Q.WT);null===l||void 0===l||l.forEach((a=>{var i;const l=(0,G.U9)(a.VDiskId),n=null===(i=a.PDisk)||void 0===i?void 0:i.PDiskId;s[String(n)]||(s[String(n)]={vDisks:{},...a.PDisk}),s[String(n)].vDisks[l]={...a,PDiskId:n,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(s).reduce(((e,t)=>{const a=s[t].vDisks,i=Object.keys(a).reduce(((e,t,s)=>(e.push({...a[t],id:t,order:s}),e)),[]);return e[t]={...s[t],vDisks:i},e}),{})}));var B=a(45720),H=a(4557),K=a(84476),W=a(84375),J=a(33705),Z=a(56735),ee=a(33775),te=a(67440),ae=a(54090),se=a(67375),ie=a(7435),le=a(48372);const ne=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),de=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),re=(0,le.g4)("ydb-node-page",{en:ne,ru:de}),oe=(0,v.cn)("kv-node-structure");function ce({label:e,value:t,className:a}){return(0,g.jsxs)("span",{className:oe("pdisk-title-item",a),children:[e&&(0,g.jsxs)("span",{className:oe("pdisk-title-item-label"),children:[e,":"]}),(0,g.jsx)("span",{className:oe("pdisk-title-item-value"),children:t})]})}const ue=(0,v.cn)("kv-node-structure");var ve;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(ve||(ve={}));const pe={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function he({pDiskId:e,selectedVdiskId:t,nodeId:a}){return[{name:ve.slotId,header:pe[ve.slotId],width:100,render:({row:s})=>{const i=s.VDiskSlotId;let l=null;return(0,ie.f8)(a)&&(0,ie.f8)(e)&&(0,ie.f8)(i)&&(l=(0,p.Wg)({nodeId:a,pDiskId:e,vDiskSlotId:i})),(0,g.jsxs)("div",{className:ue("vdisk-id",{selected:s.id===t}),children:[(0,g.jsx)("span",{children:i}),l&&(0,g.jsx)(K.$,{size:"s",className:ue("external-button",{hidden:!0}),href:l,target:"_blank",title:re("vdisk.developer-ui-button-title"),children:(0,g.jsx)(u.I,{data:c.A})})]})},align:H.Ay.LEFT},{name:ve.VDiskState,header:pe[ve.VDiskState],width:70,render:({row:e})=>(0,g.jsx)(ee.k,{status:e.VDiskState===se.W.OK?ae.m.Green:ae.m.Red}),sortAccessor:e=>e.VDiskState===se.W.OK?1:0,align:H.Ay.CENTER},{name:ve.Size,header:pe[ve.Size],width:170,render:({row:e})=>(0,g.jsx)(w.O,{value:e.AllocatedSize,capacity:Number(e.AllocatedSize)+Number(e.AvailableSize),formatValues:G.vX,colorizeProgress:!0}),sortAccessor:e=>Number(e.AllocatedSize),align:H.Ay.CENTER},{name:ve.Info,header:pe[ve.Info],width:70,render:({row:e})=>(0,g.jsx)(W.A,{placement:["right"],content:(0,g.jsx)(te.E,{data:e,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:ue("vdisk-details"),children:(0,g.jsx)(K.$,{view:"flat-secondary",className:ue("vdisk-details-button",{selected:e.id===t}),children:(0,g.jsx)(u.I,{data:B.A,size:18})})}),sortable:!1}]}function me({id:e,data:t,selectedVdiskId:a,nodeId:i,unfolded:l}){const[n,d]=s.useState(null!==l&&void 0!==l&&l),{TotalSize:r=0,AvailableSize:o=0,Device:c,PDiskId:u,Type:v,vDisks:p}=t,h=Number(r),m=Number(o);return(0,g.jsxs)("div",{className:ue("pdisk"),id:e,children:[(0,g.jsxs)("div",{className:ue("pdisk-header"),children:[(0,g.jsxs)("div",{className:ue("pdisk-title-wrapper"),children:[(0,g.jsx)(ee.k,{status:c}),(0,g.jsx)(ce,{label:"PDiskID",value:u,className:ue("pdisk-title-id")}),(0,g.jsx)(ce,{value:v,className:ue("pdisk-title-type")}),(0,g.jsx)(w.O,{value:h-m,capacity:h,formatValues:G.vX,colorizeProgress:!0,className:ue("pdisk-title-size")}),(0,g.jsx)(ce,{label:"VDisks",value:p.length})]}),(0,g.jsx)(K.$,{onClick:n?()=>{d(!1)}:()=>{d(!0)},view:"flat-secondary",children:(0,g.jsx)(J.I,{direction:n?"top":"bottom"})})]}),n&&(M()(t)?(0,g.jsx)("div",{children:"No information about PDisk"}):(0,g.jsxs)("div",{children:[(0,g.jsx)(Z.Q,{pDisk:t,nodeId:i,className:ue("pdisk-details"),withPDiskPageLink:!0}),(0,g.jsxs)("div",{className:ue("vdisks-container"),children:[(0,g.jsx)("div",{className:ue("vdisks-header"),children:"VDisks"}),(0,g.jsx)(H.Ay,{theme:"yandex-cloud",data:p,columns:he({nodeId:i,pDiskId:u,selectedVdiskId:a}),settings:{...f.N3,dynamicRender:!1},rowClassName:e=>e.id===a?ue("selected-vdisk"):""})]})]}))]})}const ge=(0,v.cn)("kv-node-structure");function be({type:e,id:t}){return`${e}-${t}`}const xe=function({nodeId:e,className:t}){const a=(0,q.N4)((t=>Y(t,e))),[i]=(0,q.Nt)(),{currentData:l,isFetching:n,error:d}=O.useGetNodeStructureQuery({nodeId:e},{pollingInterval:i}),o=n&&void 0===l,[{pdiskId:c,vdiskId:u}]=(0,r.useQueryParams)({pdiskId:r.StringParam,vdiskId:r.StringParam}),v=s.useRef(null),p=s.useRef(!1);return s.useEffect((()=>{if(!M()(a)&&!p.current&&v.current&&c){const t=document.getElementById(be({type:"pdisk",id:c}));let s=0;if(u){var e;const t=null===(e=a[c])||void 0===e?void 0:e.vDisks,i=null===t||void 0===t?void 0:t.find((e=>e.id===u)),l=i?document.querySelector(".data-table"):void 0,n=(null===i||void 0===i?void 0:i.order)||0;l&&(s+=l.offsetTop+40*n)}t&&(v.current.scrollTo({behavior:"smooth",top:s||t.offsetTop}),p.current=!0)}}),[a,c,u]),(0,g.jsxs)("div",{className:ge(),ref:v,children:[d?(0,g.jsx)(N.o,{error:d,className:ge("error")}):null,(0,g.jsx)("div",{className:t,children:o?(0,g.jsx)(D.a,{size:"m"}):d&&!l?null:(()=>{const t=Object.keys(a);return t.length>0?t.map((t=>(0,g.jsx)(me,{data:a[t],id:be({type:"pdisk",id:t}),unfolded:c===t,selectedVdiskId:u,nodeId:e},t))):"There is no information about node structure."})()})]})},Ne=(0,v.cn)("node"),fe="Storage";function je(e){var t,a;const c=s.useRef(null),u=(0,q.YQ)(),v=null!==(t=(0,n.W5)(z.Ay.node))&&void 0!==t?t:Object.create(null),{id:p,activeTab:h}=v.params,[{database:m}]=(0,r.useQueryParams)(L.Gi),[b]=(0,q.Nt)(),{currentData:f,isFetching:j,error:k}=O.useGetNodeInfoQuery({nodeId:p},{pollingInterval:b}),I=j&&void 0===f,y=f,w=(0,P.Pm)(),T=(0,P.c2)(),{activeTabVerified:C,nodeTabs:E}=s.useMemo((()=>{var e;let t=(null===y||void 0===y||null===(e=y.Roles)||void 0===e?void 0:e.find((e=>e===fe)))?L.qn:L.qn.filter((e=>e.id!==L.O3));T&&(t=t.filter((e=>e.id!==L.mX)));const a=t.map((e=>({...e,title:e.name})));let s=a.find((({id:e})=>e===h));return s||(s=a[0]),{activeTabVerified:s,nodeTabs:a}}),[h,y,T]),V=(null===y||void 0===y||null===(a=y.Tenants)||void 0===a?void 0:a[0])||(null===m||void 0===m?void 0:m.toString());let U;if(y){var M;const e=!(null!==y&&void 0!==y&&null!==(M=y.Tenants)&&void 0!==M&&M[0]);U=e?"Storage":"Compute"}s.useEffect((()=>{u((0,A.g)("node",{tenantName:V,nodeRole:U,nodeId:p}))}),[u,V,p,U]);const _=()=>{switch(C.id){case L.O3:return(0,g.jsx)("div",{className:Ne("storage"),ref:c,children:(0,g.jsx)(R.p,{nodeId:p,parentRef:c})});case L.q7:return(0,g.jsx)(F.C,{nodeId:p,database:V,className:Ne("node-page-wrapper")});case L.mX:return(0,g.jsx)(xe,{className:Ne("node-page-wrapper"),nodeId:p});case L.wS:return(0,g.jsx)(S,{node:y,className:Ne("overview-wrapper")});default:return!1}};return I||!w?(0,g.jsx)(D.a,{size:"l"}):y?(0,g.jsxs)("div",{className:Ne(null,e.className),children:[(0,g.jsx)(l.mg,{titleTemplate:`%s \u2014 ${y.Host} \u2014 YDB Monitoring`,defaultTitle:`${y.Host} \u2014 YDB Monitoring`,children:(0,g.jsx)("title",{children:C.title})}),(0,g.jsx)(x,{node:y,additionalNodesProps:e.additionalNodesProps,className:Ne("header")}),k?(0,g.jsx)(N.o,{error:k,className:Ne("error")}):null,(0,g.jsxs)("div",{className:Ne("tabs"),children:[(0,g.jsx)(i.t,{size:"l",items:E,activeTab:C.id,wrapTo:({id:e},t)=>(0,g.jsx)(d.N_,{to:(0,L.vI)(p,{database:V},e),className:Ne("tab"),children:t},e),allowNotSelected:!0}),(0,g.jsx)(o.E,{})]}),(0,g.jsx)("div",{className:Ne("content"),children:_()})]}):k?(0,g.jsx)(N.o,{error:k}):(0,g.jsx)("div",{className:"error",children:"no node data"})}},88616:(e,t,a)=>{a.d(t,{Q:()=>T});var s=a(76938),i=a(98089),l=a(99991),n=a(22983),d=a(10508),r=a(44294),o=a(17594),c=a(19228),u=a(80420),v=a(27775),p=a(78668),h=a(21545),m=a(6354),g=a(76086),b=a(86200),x=a(90182),N=a(29819),f=a(48372);const j=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),k=(0,f.g4)("ydb-tablets",{en:j});var I=a(60712);function y({database:e}){return[{name:"Type",width:150,get header(){return k("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,I.jsxs)("span",{children:[e.Type," ",t?(0,I.jsx)(i.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return k("Tablet")},render:({row:t})=>t.TabletId?(0,I.jsx)(u.$,{tabletId:t.TabletId,database:e}):g.Pd},{name:"State",get header(){return k("State")},render:({row:e})=>(0,I.jsx)(v.i,{state:e.State})},{name:"NodeId",get header(){return k("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,N.vI)(e.NodeId);return(0,I.jsx)(r.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return k("Node FQDN")},render:({row:e})=>e.fqdn?(0,I.jsx)(d.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,I.jsx)("span",{children:"\u2014"})},{name:"Generation",get header(){return k("Generation")},align:"right"},{name:"Uptime",get header(){return k("Uptime")},render:({row:e})=>(0,b.H7)(e.ChangeTime),sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,I.jsx)(w,{...e})}]}function w(e){const t=e.State===m.r.Stopped,a=(0,x.N4)(p._5),[i]=h.X.useKillTabletMutation(),d=e.TabletId;return d?(0,I.jsx)(n.B,{buttonView:"outlined",buttonTitle:k("dialog.kill-header"),dialogHeader:k("dialog.kill-header"),dialogText:k("dialog.kill-text"),onConfirmAction:()=>i({id:d}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:k(a?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,I.jsx)(l.I,{data:s.A})}):null}function T({database:e,tablets:t,className:a,loading:s}){return s?(0,I.jsx)(c.Q,{}):(0,I.jsx)(o.l,{wrapperClassName:a,columns:y({database:e}),data:t,settings:g.N3,emptyDataMessage:k("noTabletsData")})}},76768:(e,t,a)=>{a.d(t,{C:()=>N});var s=a(44992),i=a(44508),l=a(53850),n=a(62060),d=a.n(n),r=a(21334),o=a(24600);const c=r.F.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.viewer.getTabletsInfo(e,{signal:t})}}catch(a){return{error:a}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),u=(0,l.Mz)((e=>e),(e=>c.endpoints.getTabletsInfo.select(e)),{argsMemoize:l.i5,argsMemoizeOptions:{equalityCheck:d()}}),v=(0,l.Mz)((e=>e),((e,t)=>u(t)),((e,t)=>t(e).data)),p=(0,l.Mz)(((e,t)=>v(e,t)),(e=>(0,o.E)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]));var h=a(77506),m=a(90182),g=a(88616),b=a(60712);const x=(0,h.cn)("tablets");function N({nodeId:e,path:t,database:a,className:l}){const[n]=(0,m.Nt)();let d={};const r=void 0===e?void 0:String(e);void 0!==r?d={nodeId:r,database:a}:t&&(d={path:t,database:a});const{currentData:o,isFetching:u,error:v}=c.useGetTabletsInfoQuery(0===Object.keys(d).length?s.hT:d,{pollingInterval:n}),h=u&&void 0===o,N=(0,m.N4)((e=>p(e,d)));return(0,b.jsxs)("div",{className:x(null,l),children:[v?(0,b.jsx)(i.o,{error:v}):null,o||h?(0,b.jsx)(g.Q,{tablets:N,database:a,loading:h}):null]})}},21545:(e,t,a)=>{a.d(t,{X:()=>i});var s=a(78034);const i=a(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t},{signal:a})=>{try{const[i,l,n]=await Promise.all([window.api.viewer.getTablet({id:e,database:t},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({signal:a})]),d=(0,s.pl)(n),r=Object.keys(l).reduce(((e,t)=>{var a;const s=null===(a=l[t])||void 0===a?void 0:a.TabletStateInfo;if(s&&s.length){const a=s.find((e=>e.Leader))||s[0],{ChangeTime:i,Generation:l,State:n,Leader:r,FollowerId:o}=a,c=d&&t?d.get(Number(t)):void 0;"Dead"!==n&&e.push({nodeId:t,generation:l,changeTime:i,state:n,leader:r,followerId:o,fqdn:c})}return e}),[]),{TabletStateInfo:o=[]}=i,[c={}]=o,{TabletId:u}=c;return{data:{id:u,data:c,history:r}}}catch(i){return{error:i}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const a=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:s,PathId:i}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${s}:${i}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(s){return{error:s}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},76938:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(59284);const i=e=>s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.5 6.5 0 1 1-6.445 7.348.75.75 0 1 1 1.487-.194A5.001 5.001 0 1 0 4.43 4.5h1.32a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 2 5.25v-3a.75.75 0 0 1 1.5 0v1.06A6.48 6.48 0 0 1 8 1.5Z",clipRule:"evenodd"}))}}]);