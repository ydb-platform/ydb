"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[7045],{14659:(e,t,s)=>{s.d(t,{U:()=>g});var a=s(68963),n=s(17176),l=s(68330),i=s(76506),o=s(71586),r=s(25822),d=s(88776),c=s(24362),u=s(30817);const v=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-cancel":"Cancel","button-close":"Close"}'),p=(0,u.wZ)("ydb-critical-action-dialog",{en:v});var h=s(75859);const m=(0,c.cn)("ydb-critical-dialog"),b=e=>403===e.status?p("no-rights-error"):e.statusText?e.statusText:p("default-error");function x(e){let{visible:t,text:s,onClose:n,onConfirm:l,onConfirmActionSuccess:c,onConfirmActionError:u}=e;const[v,x]=a.useState(!1),[g,j]=a.useState(),N=async e=>(e.preventDefault(),x(!0),l().then((()=>{c(),n()})).catch((e=>{u(),j(e)})).finally((()=>{x(!1)})));return(0,h.jsx)(r.V,{open:t,hasCloseButton:!1,className:m(),size:"s",onClose:n,onTransitionExited:()=>j(void 0),children:g?(0,h.jsxs)(a.Fragment,{children:[(0,h.jsxs)(r.V.Body,{className:m("body"),children:[(0,h.jsx)("span",{className:m("error-icon"),children:(0,h.jsx)(i.Z,{width:"24",height:"22"})}),b(g)]}),(0,h.jsx)(r.V.Footer,{loading:!1,preset:"default",textButtonCancel:p("button-close"),onClickButtonCancel:n})]}):(0,h.jsxs)("form",{onSubmit:N,children:[(0,h.jsxs)(r.V.Body,{className:m("body"),children:[(0,h.jsx)("span",{className:m("warning-icon"),children:(0,h.jsx)(d.J,{data:o.Z,size:24})}),s]}),(0,h.jsx)(r.V.Footer,{loading:v,preset:"default",textButtonApply:p("button-confirm"),textButtonCancel:p("button-cancel"),propsButtonApply:{type:"submit"},onClickButtonCancel:n,onClickButtonApply:()=>{}})]})})}function g(e){let{children:t,onConfirmAction:s,onConfirmActionSuccess:i,dialogContent:o,buttonDisabled:r=!1,buttonView:d="action",buttonClassName:c,withPopover:u=!1,popoverContent:v,popoverPlacement:p="right",popoverDisabled:m=!0}=e;const[b,g]=a.useState(!1),[j,N]=a.useState(!1),k=()=>(0,h.jsx)(n.z,{onClick:()=>g(!0),view:d,disabled:r,loading:!r&&j,className:c,children:t});return(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)(x,{visible:b,text:o,onConfirm:async()=>{N(!0),await s(),N(!1)},onConfirmActionSuccess:async()=>{if(i){N(!0);try{await i()}catch{}finally{N(!1)}}},onConfirmActionError:()=>{N(!1)},onClose:()=>{g(!1)}}),u?(0,h.jsx)(l.J,{content:v,placement:p,disabled:m,children:k()}):k()]})}},8659:(e,t,s)=>{s.d(t,{P:()=>g});var a=s(54665),n=s(5922),l=s(24362),i=s(52317),o=s(4119),r=s(48169),d=s(69214),c=s(23373),u=s(32270),v=s(67359),p=s(30817);const h=JSON.parse('{"path":"Path","guid":"GUID","category":"Category","type":"Type","size":"Size","state":"State","device":"Device","realtime":"Realtime","serial-number":"SerialNumber","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page"}'),m=(0,p.wZ)("ydb-pDisk-info",{en:h});var b=s(75859);const x=(0,l.cn)("ydb-pdisk-info");function g(e){let{pDisk:t,nodeId:s,isPDiskPage:l=!1,...p}=e;const{PDiskId:h,Path:g,Guid:j,Category:N,Type:k,Device:D,Realtime:f,State:I,SerialNumber:S,TotalSize:y,AvailableSize:w}=t,T=Number(y),C=Number(w),V=[];if((0,n.D)(g)&&V.push({label:m("path"),value:g}),(0,n.D)(j)&&V.push({label:m("guid"),value:j}),(0,n.D)(N)&&(V.push({label:m("category"),value:N}),V.push({label:m("type"),value:k})),T>=0&&C>=0&&V.push({label:m("size"),value:(0,b.jsx)(v.y,{value:T-C,capacity:T,formatValues:o.q3,colorizeProgress:!0})}),(0,n.D)(I)&&V.push({label:m("state"),value:I}),(0,n.D)(D)&&V.push({label:m("device"),value:(0,b.jsx)(d.A,{status:D})}),(0,n.D)(f)&&V.push({label:m("realtime"),value:(0,b.jsx)(d.A,{status:f})}),(0,n.D)(S)&&V.push({label:m("serial-number"),value:S||i.jX}),(0,n.D)(h)&&(0,n.D)(s)){const e=(0,a.ds)(h,s),t=(0,r.ok)({nodeId:s,pDiskId:h});V.push({label:m("links"),value:(0,b.jsxs)("span",{className:x("links"),children:[!l&&(0,b.jsx)(u.j,{title:m("pdisk-page"),url:e,external:!1}),(0,b.jsx)(u.j,{title:m("developer-ui"),url:t})]})})}return(0,b.jsx)(c._,{info:V,...p})}},94178:(e,t,s)=>{s.d(t,{V:()=>i});var a=s(24362),n=s(75859);const l=(0,a.cn)("tag"),i=e=>{let{text:t,type:s}=e;return(0,n.jsx)("div",{className:l({type:s}),children:t})}},47057:(e,t,s)=>{s.d(t,{$:()=>o});var a=s(24362),n=s(94178),l=s(75859);const i=(0,a.cn)("tags"),o=e=>{let{tags:t,tagsType:s,className:a=""}=e;return(0,l.jsx)("div",{className:i(null,a),children:t&&t.map(((e,t)=>(0,l.jsx)(n.V,{text:e,type:s},t)))})}},22200:(e,t,s)=>{s.d(t,{K:()=>g});var a=s(54665),n=s(5922),l=s(24362),i=s(4119),o=s(48169),r=s(47651),d=s(69214),c=s(62206),u=s(32270),v=s(67359),p=s(30817);const h=JSON.parse('{"slot-id":"VDisk Slot Id","pool-name":"Storage Pool Name","kind":"Kind","guid":"GUID","incarnation-guid":"Incarnation GUID","instance-guid":"Instance GUID","replication-status":"Replicated","state-status":"VDisk State","space-status":"Disk Space","fresh-rank-satisfaction":"Fresh Rank Satisfaction","level-rank-satisfaction":"Level Rank Satisfaction","front-queues":"Front Queues","has-unreadable-blobs":"Has Unreadable Blobs","size":"Size","read-throughput":"Read Throughput","write-throughput":"Write Throughput","links":"Links","vdisk-page":"VDisk Page","developer-ui":"Developer UI","yes":"Yes","no":"No"}'),m=(0,p.wZ)("ydb-vDisk-info",{en:h});var b=s(75859);const x=(0,l.cn)("ydb-vdisk-info");function g(e){var t,s;let{data:l,isVDiskPage:p=!1,...h}=e;const{AllocatedSize:g,DiskSpace:j,FrontQueues:N,Guid:k,Replicated:D,VDiskState:f,VDiskSlotId:I,Kind:S,SatisfactionRank:y,AvailableSize:w,HasUnreadableBlobs:T,IncarnationGuid:C,InstanceGuid:V,StoragePoolName:P,ReadThroughput:z,WriteThroughput:A,PDiskId:R,NodeId:F}=l,U=[];var Z,E;((0,n.D)(I)&&U.push({label:m("slot-id"),value:I}),(0,n.D)(P)&&U.push({label:m("pool-name"),value:P}),(0,n.D)(f)&&U.push({label:m("state-status"),value:f}),Number(g)>=0&&Number(w)>=0&&U.push({label:m("size"),value:(0,b.jsx)(v.y,{value:g,capacity:Number(g)+Number(w),formatValues:i.q3,colorizeProgress:!0})}),(0,n.D)(S)&&U.push({label:m("kind"),value:S}),(0,n.D)(k)&&U.push({label:m("guid"),value:k}),(0,n.D)(C)&&U.push({label:m("incarnation-guid"),value:C}),(0,n.D)(V)&&U.push({label:m("instance-guid"),value:V}),(0,n.D)(D)&&U.push({label:m("replication-status"),value:m(D?"yes":"no")}),(0,n.D)(j)&&U.push({label:m("space-status"),value:(0,b.jsx)(d.A,{status:j})}),(0,n.D)(null===y||void 0===y||null===(t=y.FreshRank)||void 0===t?void 0:t.Flag))&&U.push({label:m("fresh-rank-satisfaction"),value:(0,b.jsx)(d.A,{status:null===y||void 0===y||null===(Z=y.FreshRank)||void 0===Z?void 0:Z.Flag})});(0,n.D)(null===y||void 0===y||null===(s=y.LevelRank)||void 0===s?void 0:s.Flag)&&U.push({label:m("level-rank-satisfaction"),value:(0,b.jsx)(d.A,{status:null===y||void 0===y||null===(E=y.LevelRank)||void 0===E?void 0:E.Flag})});if((0,n.D)(N)&&U.push({label:m("front-queues"),value:(0,b.jsx)(d.A,{status:N})}),(0,n.D)(T)&&U.push({label:m("has-unreadable-blobs"),value:m(T?"yes":"no")}),(0,n.D)(z)&&U.push({label:m("read-throughput"),value:(0,r.Qt)(z)}),(0,n.D)(A)&&U.push({label:m("write-throughput"),value:(0,r.Qt)(A)}),(0,n.D)(R)&&(0,n.D)(F)&&(0,n.D)(I)){const e=(0,a.By)(I,R,F),t=(0,o.yf)({nodeId:F,pDiskId:R,vDiskSlotId:I});U.push({label:m("links"),value:(0,b.jsxs)("span",{className:x("links"),children:[!p&&(0,b.jsx)(u.j,{title:m("vdisk-page"),url:e,external:!1}),(0,b.jsx)(u.j,{title:m("developer-ui"),url:t})]})})}return(0,b.jsx)(c._P,{info:U,...h})}},55515:(e,t,s)=>{s.r(t),s.d(t,{Node:()=>ke,STORAGE_ROLE:()=>Ne});var a=s(68963),n=s(8179),l=s(49352),i=s(86974),o=s(83203),r=s(50422),d=s(39683),c=s(88776),u=s(24362),v=s(48169),p=s(69214),h=s(47057),m=s(75859);const b=(0,u.cn)("basic-node-viewer"),x=e=>{let t,{node:s,additionalNodesProps:n,className:l}=e;return null!==n&&void 0!==n&&n.getNodeRef?t=n.getNodeRef(s)+"internal":s.NodeId&&(t=(0,v.wq)(s.NodeId)+"internal"),(0,m.jsx)("div",{className:b(null,l),children:s?(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("div",{className:b("title"),children:"Node"}),(0,m.jsx)(p.A,{status:s.SystemState,name:s.Host}),t&&(0,m.jsx)("a",{rel:"noopener noreferrer",className:b("link",{external:!0}),href:t,target:"_blank",children:(0,m.jsx)(c.J,{data:d.Z})}),(0,m.jsxs)("div",{className:b("id"),children:[(0,m.jsx)("label",{className:b("label"),children:"NodeID"}),(0,m.jsx)("label",{children:s.NodeId})]}),s.DC&&(0,m.jsx)(h.$,{tags:[s.DC]}),s.Roles&&(0,m.jsx)(h.$,{tags:s.Roles,tagsType:"blue"})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var g=s(26688),j=s(52317),N=s(23373);const k=(0,u.cn)("ydb-pool-usage"),D=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},f=e=>{let{data:t={}}=e;const{Threads:s,Name:a="Unknown",Usage:n=0}=t,l=n&&s,i=Math.floor(100*n),o=i>100?100:i;return(0,m.jsxs)("div",{className:k(),children:[(0,m.jsxs)("div",{className:k("info"),children:[(0,m.jsx)("div",{className:k("pool-name"),children:a}),l&&(0,m.jsxs)("div",{className:k("value"),children:[(0,m.jsxs)("div",{className:k("percents"),children:[i<1?"<1":i,"%"]}),(0,m.jsxs)("div",{className:k("threads"),children:["(\xd7",s,")"]})]})]}),(0,m.jsx)("div",{className:k("visual"),children:(0,m.jsx)("div",{className:k("usage-line",{type:D(o)}),style:{width:"".concat(o,"%")}})})]})};var I=s(67359);const S=(0,u.cn)("full-node-viewer"),y=e=>{var t,s,a,n;let{node:l,className:i}=e;const o=null===l||void 0===l||null===(t=l.Endpoints)||void 0===t?void 0:t.map((e=>{let{Name:t,Address:s}=e;return{label:t,value:s}})),r=[];null!==l&&void 0!==l&&null!==(s=l.Tenants)&&void 0!==s&&s.length&&r.push({label:"Database",value:l.Tenants[0]}),r.push({label:"Version",value:null===l||void 0===l?void 0:l.Version},{label:"Uptime",value:null===l||void 0===l?void 0:l.Uptime},{label:"DC",value:(null===l||void 0===l?void 0:l.DataCenterDescription)||(null===l||void 0===l?void 0:l.DC)},{label:"Rack",value:null===l||void 0===l?void 0:l.Rack});const d=null===l||void 0===l||null===(a=l.LoadAveragePercents)||void 0===a?void 0:a.map(((e,t)=>({label:j.x5[t],value:(0,m.jsx)(I.y,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,m.jsx)("div",{className:"".concat(S()," ").concat(i),children:l?(0,m.jsxs)("div",{className:S("common-info"),children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:S("section-title"),children:"Pools"}),(0,m.jsx)("div",{className:S("section",{pools:!0}),children:null===l||void 0===l||null===(n=l.PoolStats)||void 0===n?void 0:n.map(((e,t)=>(0,m.jsx)(f,{data:e},t)))})]}),o&&o.length&&(0,m.jsx)(N.Z,{title:"Endpoints",className:S("section"),info:o}),(0,m.jsx)(N.Z,{title:"Common info",className:S("section"),info:r}),(0,m.jsx)(N.Z,{title:"Load average",className:S("section",{average:!0}),info:d})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var w=s(16670),T=s(54665),C=s(79061),V=s(905),P=s(51688);const z=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const s=e.SystemStateInfo[0];return(0,P.Ns)(s)},A=V.h.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async(e,t)=>{let{nodeId:s}=e,{signal:a}=t;try{const e=await window.api.getNodeInfo(s,{signal:a});return{data:z(e)}}catch(n){return{error:n}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async(e,t)=>{let{nodeId:s}=e,{signal:a}=t;try{return{data:await window.api.getStorageInfo({nodeId:s},{signal:a})}}catch(n){return{error:n}}},providesTags:["All"]})}),overrideExisting:"throw"});var R=s(34051),F=s(70885),U=s(66809),Z=s(92398),E=s(92820),G=s(85198),q=s.n(G),B=s(36313),J=s(4119),O=s(3764);const L=(0,B.P1)((e=>e),(e=>A.endpoints.getNodeStructure.select({nodeId:e}))),K=(0,B.P1)((e=>e),((e,t)=>L(t)),((e,t)=>t(e).data)),_=(0,B.P1)(((e,t)=>Number(t)),((e,t)=>K(e,t)),((e,t)=>{const s=null===t||void 0===t?void 0:t.StoragePools,a={};null===s||void 0===s||s.forEach((t=>{const s=t.Groups;null===s||void 0===s||s.forEach((s=>{var n;const l=null===(n=s.VDisks)||void 0===n?void 0:n.filter((t=>t.NodeId===e));null===l||void 0===l||l.forEach((s=>{const n=(0,J.a2)(s.VDiskId),l=(0,O.b)(s.PDisk),i=l.PDiskId;a[String(i)]||(a[String(i)]={vDisks:{},...l}),a[String(i)].vDisks[n]={...s,PDiskId:i,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(a).reduce(((e,t)=>{const s=a[t].vDisks,n=Object.keys(s).reduce(((e,t,a)=>(e.push({...s[t],id:t,order:a}),e)),[]);return e[t]={...a[t],vDisks:n},e}),{})}));var Q=s(67585),H=s(19812),M=s(17176),Y=s(68330),$=s(33569),W=s(8659),X=s(75850),ee=s(17632),te=s(5922),se=s(30817);const ae=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),ne=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),le=(0,se.wZ)("ydb-node-page",{en:ae,ru:ne}),ie=(0,u.cn)("kv-node-structure");function oe(e){let{label:t,value:s,className:a}=e;return(0,m.jsxs)("span",{className:ie("pdisk-title-item",a),children:[t&&(0,m.jsxs)("span",{className:ie("pdisk-title-item-label"),children:[t,":"]}),(0,m.jsx)("span",{className:ie("pdisk-title-item-value"),children:s})]})}var re=s(22200);const de=(0,u.cn)("kv-node-structure");function ce(e){let{data:t}=e;const{VDiskState:s,VDiskId:n}=t;return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)("div",{className:de("row"),children:[(0,m.jsx)("span",{className:de("title"),children:"VDisk "}),(0,m.jsx)(p.A,{status:s===ee.H.OK?X.K.Green:X.K.Red,name:(0,J.a2)(n)})]}),(0,m.jsx)("div",{className:de("column"),children:(0,m.jsx)(re.K,{className:de("section"),data:t})})]})}const ue=(0,u.cn)("kv-node-structure");var ve;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(ve||(ve={}));const pe={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function he(e){let{pDiskId:t,selectedVdiskId:s,nodeId:a}=e;return[{name:ve.slotId,header:pe[ve.slotId],width:100,render:e=>{let{row:n}=e;const l=n.VDiskSlotId;let i=null;return(0,te.D)(a)&&(0,te.D)(t)&&(0,te.D)(l)&&(i=(0,v.yf)({nodeId:a,pDiskId:t,vDiskSlotId:l})),(0,m.jsxs)("div",{className:ue("vdisk-id",{selected:n.id===s}),children:[(0,m.jsx)("span",{children:l}),i&&(0,m.jsx)(M.z,{size:"s",className:ue("external-button",{hidden:!0}),href:i,target:"_blank",title:le("vdisk.developer-ui-button-title"),children:(0,m.jsx)(c.J,{data:d.Z})})]})},align:H.ZP.LEFT},{name:ve.VDiskState,header:pe[ve.VDiskState],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(p.A,{status:t.VDiskState===ee.H.OK?X.K.Green:X.K.Red})},sortAccessor:e=>e.VDiskState===ee.H.OK?1:0,align:H.ZP.CENTER},{name:ve.Size,header:pe[ve.Size],width:100,render:e=>{let{row:t}=e;return(0,m.jsx)(I.y,{value:t.AllocatedSize,capacity:Number(t.AllocatedSize)+Number(t.AvailableSize),formatValues:J.q3,colorizeProgress:!0})},sortAccessor:e=>Number(e.AllocatedSize),align:H.ZP.CENTER},{name:ve.Info,header:pe[ve.Info],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(Y.J,{placement:["right"],content:(0,m.jsx)(ce,{data:t}),tooltipContentClassName:ue("vdisk-details"),children:(0,m.jsx)(M.z,{view:"flat-secondary",className:ue("vdisk-details-button",{selected:t.id===s}),children:(0,m.jsx)(c.J,{data:Q.Z,size:18})})})},sortable:!1}]}function me(e){let{id:t,data:s,selectedVdiskId:n,nodeId:l,unfolded:i}=e;const[o,r]=a.useState(null!==i&&void 0!==i&&i),{TotalSize:d=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:h,vDisks:b}=s,x=Number(d),g=Number(c);return(0,m.jsxs)("div",{className:ue("pdisk"),id:t,children:[(0,m.jsxs)("div",{className:ue("pdisk-header"),children:[(0,m.jsxs)("div",{className:ue("pdisk-title-wrapper"),children:[(0,m.jsx)(p.A,{status:u}),(0,m.jsx)(oe,{label:"PDiskID",value:v,className:ue("pdisk-title-id")}),(0,m.jsx)(oe,{value:h,className:ue("pdisk-title-type")}),(0,m.jsx)(I.y,{value:x-g,capacity:x,formatValues:J.q3,colorizeProgress:!0,className:ue("pdisk-title-size")}),(0,m.jsx)(oe,{label:"VDisks",value:b.length})]}),(0,m.jsx)(M.z,{onClick:o?()=>{r(!1)}:()=>{r(!0)},view:"flat-secondary",children:(0,m.jsx)($.F,{direction:o?"top":"bottom"})})]}),o&&(q()(s)?(0,m.jsx)("div",{children:"No information about PDisk"}):(0,m.jsxs)("div",{children:[(0,m.jsx)(W.P,{pDisk:s,nodeId:l,className:ue("pdisk-details")}),(0,m.jsxs)("div",{className:ue("vdisks-container"),children:[(0,m.jsx)("div",{className:ue("vdisks-header"),children:"VDisks"}),(0,m.jsx)(H.ZP,{theme:"yandex-cloud",data:b,columns:he({nodeId:l,pDiskId:v,selectedVdiskId:n}),settings:{...j.LE,dynamicRender:!1},rowClassName:e=>e.id===n?ue("selected-vdisk"):""})]})]}))]})}const be=(0,u.cn)("kv-node-structure");function xe(e){let{type:t,id:s}=e;return"".concat(t,"-").concat(s)}const ge=function(e){let{nodeId:t,className:s}=e;const n=(0,R.ix)((e=>_(e,t))),[l]=(0,R.Rj)(),{currentData:i,isFetching:o,error:r}=A.useGetNodeStructureQuery({nodeId:t},{pollingInterval:l}),d=o&&void 0===i,{pdiskId:c,vdiskId:u}=E.parse(window.location.href,!0).query,v=a.useRef(null),p=a.useRef(!1);return a.useEffect((()=>{if(!q()(n)&&!p.current&&v.current){const t=document.getElementById(xe({type:"pdisk",id:c}));let s=0;if(u){var e;const t=null===(e=n[c])||void 0===e?void 0:e.vDisks,a=null===t||void 0===t?void 0:t.find((e=>e.id===u)),l=a?document.querySelector(".data-table"):void 0,i=(null===a||void 0===a?void 0:a.order)||0;l&&(s+=l.offsetTop+40*i)}t&&(v.current.scrollTo({behavior:"smooth",top:s||t.offsetTop}),p.current=!0)}}),[n,c,u]),(0,m.jsx)("div",{className:be(),ref:v,children:(0,m.jsx)("div",{className:s,children:d?(0,m.jsx)(w.a,{size:"m"}):r?(0,m.jsx)(g.V,{error:r}):(()=>{const e=Object.keys(n);return e.length>0?e.map((e=>(0,m.jsx)(me,{data:n[e],id:xe({type:"pdisk",id:e}),unfolded:c===e,selectedVdiskId:u,nodeId:t},e))):"There is no information about node structure."})()})})},je=(0,u.cn)("node"),Ne="Storage";function ke(e){var t;const s=a.useRef(null),d=(0,R.zL)(),c=(0,i.TH)(),u=null!==(t=(0,i.$B)(T.ZP.node))&&void 0!==t?t:Object.create(null),{id:v,activeTab:p}=u.params,{tenantName:h}=(0,T.mB)(c),[b]=(0,R.Rj)(),{currentData:j,isFetching:N,error:k}=A.useGetNodeInfoQuery({nodeId:v},{pollingInterval:b}),D=N&&void 0===j,f=j,{activeTabVerified:I,nodeTabs:S}=a.useMemo((()=>{var e;const t=((null===f||void 0===f||null===(e=f.Roles)||void 0===e?void 0:e.find((e=>e===Ne)))?Z.ZJ:Z.ZJ.filter((e=>e.id!==Z.P_))).map((e=>({...e,title:e.name})));let s=t.find((e=>{let{id:t}=e;return t===p}));return s||(s=t[0]),{activeTabVerified:s,nodeTabs:t}}),[p,f]);a.useEffect((()=>{var e;const t=(null===f||void 0===f||null===(e=f.Tenants)||void 0===e?void 0:e[0])||(null===h||void 0===h?void 0:h.toString());d((0,C.J)("node",{tenantName:t,nodeId:v}))}),[d,f,v,h]);const V=()=>{switch(I.id){case Z.P_:return(0,m.jsx)("div",{className:je("storage"),children:(0,m.jsx)(F.V,{nodeId:v,parentContainer:s.current})});case Z.IA:return(0,m.jsx)(U.J,{nodeId:v,className:je("node-page-wrapper")});case Z.mD:return(0,m.jsx)(y,{node:f,className:je("overview-wrapper")});case Z.pV:return(0,m.jsx)(ge,{className:je("node-page-wrapper"),nodeId:v});default:return!1}};return D?(0,m.jsx)(w.a,{size:"l"}):k?(0,m.jsx)(g.V,{error:k}):f?(0,m.jsxs)("div",{className:je(null,e.className),ref:s,children:[(0,m.jsx)(l.ql,{titleTemplate:"%s \u2014 ".concat(f.Host," \u2014 YDB Monitoring"),defaultTitle:"".concat(f.Host," \u2014 YDB Monitoring"),children:(0,m.jsx)("title",{children:I.title})}),(0,m.jsx)(x,{node:f,additionalNodesProps:e.additionalNodesProps,className:je("header")}),(0,m.jsxs)("div",{className:je("tabs"),children:[(0,m.jsx)(n.m,{size:"l",items:S,activeTab:I.id,wrapTo:(e,t)=>{let{id:s}=e;return(0,m.jsx)(o.rU,{to:(0,T.ax)(T.ZP.node,{id:v,activeTab:s}),className:je("tab"),children:t},s)},allowNotSelected:!0}),(0,m.jsx)(r.q,{})]}),(0,m.jsx)("div",{className:je("content"),children:V()})]}):(0,m.jsx)("div",{className:"error",children:"no node data"})}},66809:(e,t,s)=>{s.d(t,{J:()=>V});var a=s(66950),n=s(10288),l=s(14979),i=s(88776),o=s(17095),r=s(14659),d=s(69214),c=s(26688),u=s(74170),v=s(2098),p=s(22692),h=s(54665),m=s(99399),b=s(28164),x=s(24362),g=s(52317),j=s(4119),N=s(34051),k=s(83496),D=s(92398),f=s(30817);const I=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),S=(0,f.wZ)("ydb-tablets",{en:I});var y=s(75859);const w=(0,x.cn)("tablets"),T=[{name:"Type",get header(){return S("Type")},render:e=>{let{row:t}=e;return(0,y.jsxs)("span",{children:[t.Type," ",t.Leader?"":(0,y.jsx)(n.x,{color:"secondary",children:"follower"})]})}},{name:"TabletId",get header(){return S("Tablet")},render:e=>{let{row:t}=e;const s=t.TabletId&&(0,h.ax)(h.ZP.tablet,{id:t.TabletId},{nodeId:t.NodeId,type:t.Type});return(0,y.jsx)(u.h,{to:s,children:t.TabletId})}},{name:"State",get header(){return S("State")},render:e=>{let{row:t}=e;return(0,y.jsx)(l._,{theme:(0,k.KR)(t.State),children:t.State})}},{name:"NodeId",get header(){return S("Node ID")},render:e=>{let{row:t}=e;const s=void 0===t.NodeId?void 0:(0,D.a3)(t.NodeId);return(0,y.jsx)(u.h,{to:s,children:t.NodeId})},align:"right"},{name:"fqdn",get header(){return S("Node FQDN")},render:e=>{let{row:t}=e;return t.fqdn?(0,y.jsx)(d.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,y.jsx)("span",{children:"\u2014"})}},{name:"Generation",get header(){return S("Generation")},align:"right"},{name:"Uptime",get header(){return S("Uptime")},render:e=>{let{row:t}=e;return(0,j.fG)(t.ChangeTime)},sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:e=>{let{row:t}=e;return(0,y.jsx)(C,{...t})}}];function C(e){const t=e.State===b.g.Stopped,s=(0,N.zL)(),{isUserAllowedToMakeChanges:n}=(0,N.ix)((e=>e.authentication));return(0,y.jsx)(r.U,{buttonView:"outlined",dialogContent:S("dialog.kill"),onConfirmAction:()=>window.api.killTablet(e.TabletId),onConfirmActionSuccess:()=>{s(m.zg.util.invalidateTags(["All"]))},buttonDisabled:t||!n,withPopover:!0,popoverContent:S("controls.kill-not-allowed"),popoverDisabled:n,children:(0,y.jsx)(i.J,{data:a.Z})})}function V(e){let{nodeId:t,path:s,className:a}=e;const[n]=(0,N.Rj)();let l={};const i=void 0===t?void 0:String(t);void 0!==i?l={nodes:[String(i)]}:s&&(l={path:s});const{currentData:r,isFetching:d,error:u}=m.zg.useGetTabletsInfoQuery(0===Object.keys(l).length?o.CN:l,{pollingInterval:n}),h=d&&void 0===r,b=(0,N.ix)((e=>(0,m.Sq)(e,l)));return h?(0,y.jsx)(p.h,{}):u?(0,y.jsx)(c.V,{error:u}):(0,y.jsx)("div",{className:w(null,a),children:(0,y.jsx)(v.G,{columns:T,data:b,settings:g.LE,emptyDataMessage:S("noTabletsData")})})}}}]);