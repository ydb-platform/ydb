"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[7054],{74003:(e,t,a)=>{a.d(t,{q:()=>v});var l=a(26714),n=a(72616),s=a(26390),i=a(78759),o=a(99294),r=a(55842),d=a(37711);const c=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),u=(0,d.wZ)("ydb-diagnostics-autorefresh-control",{en:c});var h=a(10161);const m=(0,o.cn)("auto-refresh-control");function v(e){let{className:t}=e;const a=(0,r.zL)(),[o,d]=(0,r.Rj)();return(0,h.jsxs)("div",{className:m(null,t),children:[(0,h.jsx)(n.z,{view:"flat-secondary",onClick:()=>{a(i.h.util.invalidateTags(["All"]))},extraProps:{"aria-label":u("Refresh")},children:(0,h.jsx)(n.z.Icon,{children:(0,h.jsx)(l.Z,{})})}),(0,h.jsxs)(s.P,{value:[String(o)],onUpdate:e=>{d(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,h.jsx)(s.P.Option,{value:"0",children:u("None")}),(0,h.jsx)(s.P.Option,{value:"15000",children:u("15 sec")}),(0,h.jsx)(s.P.Option,{value:"60000",children:u("1 min")}),(0,h.jsx)(s.P.Option,{value:"120000",children:u("2 min")}),(0,h.jsx)(s.P.Option,{value:"300000",children:u("5 min")})]})]})}},55982:(e,t,a)=>{a.d(t,{U:()=>d});var l=a(34706),n=a(72616),s=a(16318),i=a(47945),o=a(51403),r=a(10161);function d(e){let{children:t,onConfirmAction:a,onConfirmActionSuccess:d,dialogHeader:c,dialogText:u,retryButtonText:h,buttonDisabled:m=!1,buttonView:v="action",buttonTitle:p,buttonClassName:b,withPopover:g=!1,popoverContent:x,popoverPlacement:f="right",popoverDisabled:j=!0}=e;const[w,y]=l.useState(!1),[N,S]=l.useState(!1),[T,_]=l.useState(!1),C=()=>(0,r.jsx)(n.z,{onClick:()=>y(!0),view:v,disabled:m,loading:!m&&N,className:b,title:p,children:t});return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(i.g,{visible:w,header:c,text:u,withRetry:T,retryButtonText:h,onConfirm:async e=>{S(!0),await a(e)},onConfirmActionSuccess:async()=>{_(!1);try{await(null===d||void 0===d?void 0:d())}finally{S(!1)}},onConfirmActionError:e=>{_((0,o.q)(e)),S(!1)},onClose:()=>{y(!1)}}),g?(0,r.jsx)(s.J,{content:x,placement:f,disabled:j,children:C()}):C()]})}},47945:(e,t,a)=>{a.d(t,{g:()=>g});var l=a(34706),n=a(3948),s=a(15268),i=a(19912),o=a(68585),r=a(14561),d=a(58231),c=a(99294),u=a(37711);const h=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),m=(0,u.wZ)("ydb-critical-action-dialog",{en:h});var v=a(10161);const p=(0,c.cn)("ydb-critical-dialog"),b=e=>e.data&&"issues"in e.data&&e.data.issues?(0,v.jsx)(d.I,{hideSeverity:!0,data:e.data}):403===e.status?m("no-rights-error"):e.statusText?e.statusText:m("default-error");function g(e){let{visible:t,header:a,text:d,withRetry:c,retryButtonText:u,withCheckBox:h,onClose:g,onConfirm:x,onConfirmActionSuccess:f,onConfirmActionError:j}=e;const[w,y]=l.useState(!1),[N,S]=l.useState(),[T,_]=l.useState(!1),C=async e=>(y(!0),x(e).then((()=>{f(),g()})).catch((e=>{j(e),S(e)})).finally((()=>{y(!1)})));return(0,v.jsx)(o.V,{open:t,hasCloseButton:!1,className:p(),size:"s",onClose:g,onTransitionExited:()=>{S(void 0),_(!1)},children:N?(0,v.jsxs)(l.Fragment,{children:[(0,v.jsx)(o.V.Header,{caption:a}),(0,v.jsx)(o.V.Body,{className:p("body"),children:(0,v.jsxs)("div",{className:p("body-message",{error:!0}),children:[(0,v.jsx)("span",{className:p("error-icon"),children:(0,v.jsx)(n.Z,{width:"24",height:"22"})}),b(N)]})}),(0,v.jsx)(o.V.Footer,{loading:!1,preset:"default",textButtonApply:c?u||m("button-retry"):void 0,textButtonCancel:m("button-close"),onClickButtonApply:()=>C(!0),onClickButtonCancel:g})]}):(0,v.jsxs)(l.Fragment,{children:[(0,v.jsx)(o.V.Header,{caption:a}),(0,v.jsxs)(o.V.Body,{className:p("body"),children:[(0,v.jsxs)("div",{className:p("body-message",{warning:!0}),children:[(0,v.jsx)("span",{className:p("warning-icon"),children:(0,v.jsx)(r.J,{data:s.Z,size:24})}),d]}),h?(0,v.jsx)(i.X,{checked:T,onUpdate:_,children:m("checkbox-text")}):null]}),(0,v.jsx)(o.V.Footer,{loading:w,preset:"default",textButtonApply:m("button-confirm"),textButtonCancel:m("button-cancel"),propsButtonApply:{type:"submit",disabled:h&&!T},onClickButtonCancel:g,onClickButtonApply:()=>C()})]})})}},51403:(e,t,a)=>{a.d(t,{q:()=>l});const l=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},89516:(e,t,a)=>{a.d(t,{a:()=>o});var l=a(99294),n=a(73287),s=a(10161);const i=(0,l.cn)("ydb-entity-page-title");function o(e){let{entityName:t,status:a,id:l,className:o}=e;return(0,s.jsxs)("div",{className:i(null,o),children:[(0,s.jsx)("span",{className:i("prefix"),children:t}),(0,s.jsx)(n.J,{className:i("icon"),status:a,size:"s"}),l]})}},62508:(e,t,a)=>{a.d(t,{A:()=>u});var l=a(17823),n=a(99175),s=a(77468),i=a(99294),o=a(32489),r=a(73287),d=a(10161);const c=(0,i.cn)("entity-status");function u(e){let{status:t=s.K.Grey,name:a="",label:i,path:u,iconPath:h,size:m="s",mode:v="color",showStatus:p=!0,externalLink:b=!1,withLeftTrim:g=!1,hasClipboardButton:x,clipboardButtonAlwaysVisible:f=!1,className:j}=e;const w=()=>p?(0,d.jsx)(r.J,{className:c("icon"),status:t,size:m,mode:v}):null;return(0,d.jsxs)("div",{className:c(null,j),children:[h?(y=h,(0,d.jsx)(l.r,{target:"_blank",href:y,children:w()})):w(),i&&(0,d.jsx)("span",{title:i,className:c("label",{size:m,state:t.toLowerCase()}),children:i}),(u||a)&&(0,d.jsxs)("div",{className:c("wrapper",{"with-button":x}),children:[(0,d.jsx)("span",{className:c("link",{"with-left-trim":g}),title:a,children:u?b?(0,d.jsx)(l.r,{className:c("name"),href:u,children:a}):(0,d.jsx)(o.h,{className:c("name"),to:u,children:a}):a&&(0,d.jsx)("span",{className:c("name"),children:a})}),x&&(0,d.jsx)("div",{className:c("controls-wrapper",{visible:f}),children:(0,d.jsx)(n.m,{text:a,size:"xs",view:"normal",className:c("clipboard-button",{visible:f})})})]})]});var y}},84573:(e,t,a)=>{a.d(t,{B:()=>c});var l=a(79777),n=a(99294),s=a(74003),i=a(43464),o=a(10161);const r=(0,n.cn)("ydb-page-meta");function d(e){let{items:t,loading:a}=e;return(0,o.jsx)("div",{className:r("info"),children:a?(0,o.jsx)(i.O,{className:r("skeleton")}):t.filter((e=>Boolean(e))).join("\xa0\xa0\xb7\xa0\xa0")})}function c(e){let{className:t,...a}=e;return(0,o.jsxs)(l.k,{gap:1,alignItems:"center",justifyContent:"space-between",className:r(null,t),children:[(0,o.jsx)(d,{...a}),(0,o.jsx)(s.q,{})]})}},74116:(e,t,a)=>{a.d(t,{G:()=>d});var l=a(59769),n=a(71624),s=a(99294),i=a(46154),o=a(10161);const r=(0,s.cn)("ydb-resizeable-data-table");function d(e){let{columnsWidthLSKey:t,columns:a,settings:s,wrapperClassName:d,...c}=e;const[u,h]=(0,i.M)(t),m=(0,l.B)(a,u),v={...s,defaultResizeable:!0};return(0,o.jsx)("div",{className:r(null,d),children:(0,o.jsx)(n.ZP,{theme:"yandex-cloud",columns:m,onResize:h,settings:v,...c})})}},43464:(e,t,a)=>{a.d(t,{O:()=>i});var l=a(5194),n=a(83658),s=a(10161);const i=e=>{let{delay:t=600,className:a}=e;const[i]=(0,n.$)(t);return i?(0,s.jsx)(l.O,{className:a}):null}},73287:(e,t,a)=>{a.d(t,{J:()=>h});var l=a(29254),n=a(96334),s=a(15268),i=a(14561),o=a(77468),r=a(99294),d=a(10161);const c=(0,r.cn)("ydb-status-icon"),u={[o.K.Blue]:l.Z,[o.K.Yellow]:n.Z,[o.K.Orange]:s.Z,[o.K.Red]:n.Z};function h(e){let{status:t=o.K.Grey,size:a="s",mode:l="color",className:n}=e;const s={state:t.toLowerCase(),size:a};return"icons"===l&&t in u?(0,d.jsx)(i.J,{className:c("status-icon",s,n),data:u[t]}):(0,d.jsx)("div",{className:c("status-color",s,n)})}},59907:(e,t,a)=>{a.d(t,{f:()=>i});var l=a(2634),n=a(55973),s=a(10161);function i(e){let{state:t}=e;return(0,s.jsx)(l._,{theme:(0,n.KR)(t),children:t})}},65874:(e,t,a)=>{a.r(t),a.d(t,{Tablet:()=>be,b:()=>he});var l=a(34706),n=a(79777),s=a(72555),i=a(64485),o=a(42152),r=a(55783),d=a(99495),c=a(75475),u=a(90205),h=a(89516),m=a(15327),v=a(67653),p=a(48653),b=a(84573),g=a(46878),x=a(65e3),f=a(85709),j=a(6215),w=a(77468),y=a(99294),N=a(27810),S=a(55842),T=a(42568),_=a(87130);const C=e=>l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),l.createElement("path",{fill:"currentColor",d:"M13.756 10.164c1.665-.962 1.665-3.366 0-4.328L5.251.919C3.584-.045 1.5 1.158 1.5 3.083v9.834c0 1.925 2.084 3.128 3.751 2.164l8.505-4.917Z"}));var I=a(14561),k=a(55982),A=a(9038),R=a(37711);const z=JSON.parse('{"tablet.header":"Tablet","tablet.meta-database":"Database","tablet.meta-follower":"Follower","controls.kill":"Restart","controls.stop":"Stop","controls.resume":"Resume","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.stop-not-allowed":"You don\'t have enough rights to stop tablet","controls.resume-not-allowed":"You don\'t have enough rights to resume tablet","dialog.kill-header":"Restart tablet","dialog.stop-header":"Stop tablet","dialog.resume-header":"Resume tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","dialog.stop-text":"The tablet will be stopped. Do you want to proceed?","dialog.resume-text":"The tablet will be resumed. Do you want to proceed?","emptyState":"The tablet was not found","label_tablet-history":"Tablets","label_tablet-channels":"Storage"}'),D=(0,R.wZ)("ydb-tablet-page",{en:z});function Z(e){return Boolean(e&&"0"!==e)}var B=a(10161);const K=e=>{let{tablet:t}=e;const{TabletId:a,HiveId:s}=t,i=(0,S.ix)(x.VH),[o]=j._.useKillTabletMutation(),[r]=j._.useStopTabletMutation(),[d]=j._.useResumeTabletMutation();if(!a)return null;const c=Z(s),u=t.State===A.g.Stopped,h=t.State!==A.g.Stopped&&t.State!==A.g.Dead,m=t.State===A.g.Stopped||t.State===A.g.Deleted;return(0,B.jsxs)(n.k,{gap:2,wrap:"nowrap",children:[(0,B.jsxs)(k.U,{dialogHeader:D("dialog.kill-header"),dialogText:D("dialog.kill-text"),onConfirmAction:()=>o({id:a}).unwrap(),buttonDisabled:u||!i,withPopover:!0,buttonView:"normal",popoverContent:D("controls.kill-not-allowed"),popoverPlacement:"bottom",popoverDisabled:i,children:[(0,B.jsx)(I.J,{data:T.Z}),D("controls.kill")]}),c&&(0,B.jsxs)(l.Fragment,{children:[(0,B.jsxs)(k.U,{dialogHeader:D("dialog.stop-header"),dialogText:D("dialog.stop-text"),onConfirmAction:()=>r({id:a,hiveId:s}).unwrap(),buttonDisabled:m||!i,withPopover:!0,buttonView:"normal",popoverContent:D("controls.stop-not-allowed"),popoverPlacement:"bottom",popoverDisabled:i,children:[(0,B.jsx)(I.J,{data:_.Z}),D("controls.stop")]}),(0,B.jsxs)(k.U,{dialogHeader:D("dialog.resume-header"),dialogText:D("dialog.resume-text"),onConfirmAction:()=>d({id:a,hiveId:s}).unwrap(),buttonDisabled:h||!i,withPopover:!0,buttonView:"normal",popoverContent:D("controls.resume-not-allowed"),popoverPlacement:"bottom",popoverDisabled:i,children:[(0,B.jsx)(I.J,{data:C}),D("controls.resume")]})]})]})};var O=a(26836),P=a(41591),E=a(90808),F=a(59907),G=a(38980),L=a(70340),V=a(75544);const H=JSON.parse('{"field_scheme-shard":"SchemeShard","field_follower":"Follower","field_generation":"Generation","field_hive":"HiveId","field_state":"State","field_uptime":"Uptime","field_node":"Node","field_links":"Links","field_developer-ui-app":"App","field_developer-ui-counters":"Counters","field_developer-ui-executor":"Executor DB internals","field_developer-ui-state":"State Storage","title_info":"Info","title_links":"Links"}'),q=(0,R.wZ)("ydb-tablet-info",{en:H}),J=(0,y.cn)("ydb-tablet-info"),M=e=>{let{tablet:t}=e;const a=(0,S.ix)(x.VH),{ChangeTime:l,Generation:s,FollowerId:i,NodeId:o,HiveId:r,State:d,TenantId:{SchemeShard:c}={},TabletId:u}=t,h=Z(r),m=d===A.g.Active,v=[];h&&v.push({label:q("field_hive"),value:(0,B.jsx)(O.rU,{to:(0,g.fK)(r),className:J("link"),children:r})}),c&&v.push({label:q("field_scheme-shard"),value:(0,B.jsx)(O.rU,{to:(0,g.fK)(c),className:J("link"),children:c})}),v.push({label:q("field_state"),value:(0,B.jsx)(F.f,{state:d})}),m&&v.push({label:q("field_uptime"),value:(0,G.fG)(l)}),v.push({label:q("field_generation"),value:s},{label:q("field_node"),value:(0,B.jsx)(O.rU,{className:J("link"),to:(0,V.a3)(String(o)),children:o})}),i&&v.push({label:q("field_follower"),value:i});return(0,B.jsxs)(n.k,{gap:10,wrap:"nowrap",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("div",{className:J("section-title"),children:q("title_info")}),(0,B.jsx)(P._P,{info:v})]}),a&&u?(0,B.jsxs)("div",{children:[(0,B.jsx)("div",{className:J("section-title"),children:q("title_links")}),(0,B.jsxs)(n.k,{direction:"column",gap:3,children:[(0,B.jsx)(E.j,{title:q("field_developer-ui-app"),url:(0,L.wz)(u,"app")}),(0,B.jsx)(E.j,{title:q("field_developer-ui-counters"),url:(0,L.wz)(u,"counters")}),(0,B.jsx)(E.j,{title:q("field_developer-ui-executor"),url:(0,L.wz)(u,"executorInternals")}),(0,B.jsx)(E.j,{title:q("field_developer-ui-state"),url:(0,L.wz)(u,void 0,"SsId")})]})]}):null]})};var Y=a(8475),U=a(72001),$=a(72616),W=a(81778);const Q=JSON.parse('{"label_channel-index":"Channel","label_storage-pool":"Storage Pool Name","label_group-id":"Group ID","label_generation":"From generation","label_timestamp":"Timestamp"}'),X=(0,R.wZ)("ydb-tablet-storage-info",{en:Q}),ee=(0,y.cn)("ydb-tablet-storage-info");function te(e){let{name:t,className:a}=e;return(0,B.jsx)("div",{className:ee("table-header-content",a),children:t})}function ae(e,t){const a=e.getValue(),l="function"===typeof t?t(a):a;return(0,B.jsx)("div",{className:ee("metrics-cell"),children:l})}function le(e){let{row:t,name:a,hasExpand:l}=e;const s=t.getCanExpand();return(0,B.jsxs)(n.k,{gap:1,alignItems:"flex-start",className:ee("name-wrapper"),children:[s&&(0,B.jsx)($.z,{view:"flat",size:"xs",onClick:t.getToggleExpandedHandler(),children:(0,B.jsx)($.z.Icon,{children:(0,B.jsx)(W.F,{direction:t.getIsExpanded()?"bottom":"right",size:14})})}),(0,B.jsx)("div",{className:ee("name-content",{"no-control":l&&!s}),children:a})]})}function ne(e){let{data:t}=e;const[a,n]=l.useState({}),s=l.useMemo((()=>function(e){var t;if(!e)return[];const{BoundChannels:a,TabletStorageInfo:l={}}=e,n=null!==(t=l.Channels)&&void 0!==t?t:[],s=[];for(const o of n){var i;const e=o.Channel,t=o.History;if(!e||!t||!t.length)continue;const l=[...t];l.reverse();const[n,...r]=l,d={...n,storagePoolName:null===a||void 0===a||null===(i=a[e])||void 0===i?void 0:i.StoragePoolName,channelIndex:e,children:r};s.push(d)}return s}(t)),[t]),i=l.useMemo((()=>s.some((e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.length}))),[s]),o=l.useMemo((()=>{return e=i,[{accessorKey:"channelIndex",header:()=>(0,B.jsx)(te,{name:X("label_channel-index")}),size:50,cell:ae,meta:{align:"right"}},{accessorKey:"storagePoolName",header:()=>(0,B.jsx)(te,{name:X("label_storage-pool")}),size:200,cell:ae},{accessorKey:"GroupID",header:()=>(0,B.jsx)(te,{name:X("label_group-id"),className:e?ee("with-padding"):void 0}),size:100,cell:t=>(0,B.jsx)(le,{row:t.row,name:t.getValue(),hasExpand:e})},{accessorKey:"FromGeneration",header:()=>(0,B.jsx)(te,{name:X("label_generation")}),size:100,cell:ae,meta:{align:"right"}},{accessorKey:"Timestamp",header:()=>(0,B.jsx)(te,{name:X("label_timestamp")}),size:200,cell:e=>ae(e,G.i$),meta:{align:"right"}}];var e}),[i]),r=(0,Y.x)({columns:o,data:s,getSubRows:e=>e.children,enableExpanding:!0,onExpandedChange:n,state:{expanded:a}});return(0,B.jsx)("div",{children:(0,B.jsx)(U.i,{table:r,headerCellClassName:e=>{var t;let{column:a}=e;const l=null===(t=a.columnDef.meta)||void 0===t?void 0:t.align;return ee("table-header-cell",{align:l})},cellClassName:e=>{var t,a;const l=null===e||void 0===e||null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.align,n=null===e||void 0===e||null===(a=e.column.columnDef.meta)||void 0===a?void 0:a.verticalAlign;return ee("table-cell",{align:l,"vertical-align":n})},className:ee("table")})})}var se=a(71624),ie=a(62508),oe=a(32489),re=a(74116);const de=[{name:"Generation",align:se.ZP.RIGHT,render:e=>{let{row:t}=e;return t.generation}},{name:"Change time",align:se.ZP.RIGHT,sortable:!1,render:e=>{let{row:t}=e;return(0,G.fG)(t.changeTime)}},{name:"State",sortable:!1,render:e=>{let{row:t}=e;return(0,B.jsx)(F.f,{state:t.state})}},{name:"Follower ID",sortable:!1,render:e=>{let{row:t}=e;return t.leader?"leader":t.followerId}},{name:"Node ID",align:se.ZP.RIGHT,sortable:!1,render:e=>{let{row:t}=e;return(0,B.jsx)(oe.h,{to:(0,V.a3)(t.nodeId),children:t.nodeId})}},{name:"Node FQDN",sortable:!1,width:300,render:e=>{let{row:t}=e;return t.fqdn?(0,B.jsx)(ie.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,B.jsx)("span",{children:"\u2014"})}}],ce={displayIndices:!1},ue=e=>{let{history:t}=e;return(0,B.jsx)(re.G,{columnsWidthLSKey:"tabletTableColumnsWidth",data:t,columns:de,settings:ce,initialSortOrder:{columnId:"Generation",order:se.ZP.DESCENDING}})},he=(0,y.cn)("ydb-tablet-page"),me={history:"history",channels:"channels"},ve=[{id:me.history,get title(){return D("label_tablet-history")}},{id:me.channels,get title(){return D("label_tablet-channels")},isAdvanced:!0}],pe=c.z.nativeEnum(me).catch(me.history);function be(){var e;const t=(0,S.zL)(),{id:a}=(0,r.UO)(),[{database:s,clusterName:c}]=(0,d.useQueryParams)(g.eB),[u]=(0,S.Rj)(),{currentData:h,isFetching:v,error:x}=j._.useGetTabletQuery({id:a,database:null!==s&&void 0!==s?s:void 0},{pollingInterval:u}),w=v&&void 0===h,{data:y={},history:T=[]}=h||{},{currentData:_}=j._.useGetTabletDescribeQuery(y.TenantId?{tenantId:y.TenantId}:i.CN),C=null!==(e=_||s)&&void 0!==e?e:void 0,I=y.Type;l.useEffect((()=>{t((0,f.J)("tablet",{tenantName:null!==s&&void 0!==s?s:void 0,tabletId:a,tabletType:I}))}),[t,s,a,I]);const{Leader:k,Type:A}=y,R=[];return C&&R.push(`${D("tablet.meta-database")}: ${C}`),A&&R.push(A),!1===k&&R.push(D("tablet.meta-follower").toUpperCase()),(0,B.jsxs)(n.k,{gap:5,direction:"column",className:he(),children:[(0,B.jsx)(o.ql,{children:(0,B.jsx)("title",{children:`${a} \u2014 ${D("tablet.header")} \u2014 ${C||c||N.DO}`})}),(0,B.jsx)(b.B,{items:R}),(0,B.jsxs)(p.s,{loading:w,size:"l",children:[x?(0,B.jsx)(m.V,{error:x}):null,h?(0,B.jsx)(ge,{id:a,tablet:y,history:T}):null]})]})}function ge(e){let{id:t,tablet:a,history:l}=e;const s=!Object.keys(a).length,{Overall:i,HiveId:o}=a;return(0,B.jsxs)(u.$,{title:D("emptyState"),className:he("placeholder"),isEmpty:s,children:[(0,B.jsxs)(n.k,{gap:5,direction:"column",children:[(0,B.jsx)(h.a,{entityName:D("tablet.header"),status:null!==i&&void 0!==i?i:w.K.Grey,id:t}),(0,B.jsx)(K,{tablet:a}),(0,B.jsx)(M,{tablet:a})]}),(0,B.jsx)(xe,{id:t,hiveId:o,history:l})]})}function xe(e){var t;let{id:a,hiveId:i,history:o}=e;const[{activeTab:r,...c},u]=(0,d.useQueryParams)(g.eB),h=!(0,S.ix)(x.VH)||!Z(i);let m=pe.parse(r);return h&&null!==(t=ve.find((e=>e.id===m)))&&void 0!==t&&t.isAdvanced&&(m=me.history),l.useEffect((()=>{r!==m&&u({activeTab:m},"replaceIn")}),[r,m,u]),(0,B.jsxs)(n.k,{gap:5,direction:"column",children:[(0,B.jsx)("div",{children:(0,B.jsx)(s.m,{size:"l",items:ve.filter((e=>{let{isAdvanced:t}=e;return!t||!h})),activeTab:m,wrapTo:(e,t)=>{const l=(0,g.fK)(a,{...c,activeTab:e.id});return(0,B.jsx)(v.h,{to:l,children:t},e.id)}})}),"history"===m?(0,B.jsx)(ue,{history:o}):null,"channels"!==m||h?null:(0,B.jsx)(fe,{id:a,hiveId:i})]})}function fe(e){let{id:t,hiveId:a}=e;const[l]=(0,S.Rj)(),{currentData:n,error:s,isFetching:i}=j._.useGetAdvancedTableInfoQuery({id:t,hiveId:a},{pollingInterval:l}),o=i&&void 0===n;return(0,B.jsxs)(p.s,{loading:o,size:"l",children:[s?(0,B.jsx)(m.V,{error:s}):null,n?(0,B.jsx)(ne,{data:n}):null]})}},58231:(e,t,a)=>{a.d(t,{I:()=>_});var l=a(34706),n=a(29254),s=a(96334),i=a(15268),o=a(3948),r=a(72616),d=a(81778),c=a(14561),u=a(17823),h=a(99294),m=a(37711);const v=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),p=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),b=(0,m.wZ)("ydb-shorty-string",{ru:p,en:v});var g=a(10161);const x=(0,h.cn)("kv-shorty-string");function f(e){let{value:t="",limit:a=200,strict:n=!1,displayLength:s=!0,render:i=(e=>e),onToggle:o,expandLabel:r=b("default_expand_label"),collapseLabel:d=b("default_collapse_label")}=e;const[c,h]=l.useState(!1),m=(c?d:r)+(s&&!c?b("chars_count",{count:t.length}):""),v=t.length>a+(n?0:m.length),p=c||!v?t:t.slice(0,a-4)+"\xa0...";return(0,g.jsxs)("div",{className:x(),children:[i(p),v?(0,g.jsx)(u.r,{className:x("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),h((e=>!e)),null===o||void 0===o||o()},children:m}):null]})}var j=a(73689);const w=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function y(e){return function(e){return!!e&&void 0!==w[e]}(e)?w[e]:"S_INFO"}const N=(0,h.cn)("kv-result-issues"),S=(0,h.cn)("kv-issues"),T=(0,h.cn)("kv-issue");function _(e){let{data:t,hideSeverity:a}=e;const[n,s]=l.useState(!1),i="string"===typeof t||null===t||void 0===t?void 0:t.issues,o=Array.isArray(i)&&i.length>0;return(0,g.jsxs)("div",{className:N(),children:[(0,g.jsxs)("div",{className:N("error-message"),children:[(()=>{let e;if("string"===typeof t)e=t;else{var n,s;const i=y(null===t||void 0===t||null===(n=t.error)||void 0===n?void 0:n.severity);e=(0,g.jsxs)(l.Fragment,{children:[a?null:(0,g.jsxs)(l.Fragment,{children:[(0,g.jsx)(z,{severity:i})," "]}),(0,g.jsx)("span",{className:N("error-message-text"),children:null===t||void 0===t||null===(s=t.error)||void 0===s?void 0:s.message})]})}return e})(),o&&(0,g.jsx)(r.z,{view:"normal",onClick:()=>s(!n),children:n?"Hide details":"Show details"})]}),o&&n&&(0,g.jsx)(C,{hideSeverity:a,issues:i})]})}function C(e){let{issues:t,hideSeverity:a}=e;const l=null===t||void 0===t?void 0:t.reduce(((e,t)=>{var a;const l=null!==(a=t.severity)&&void 0!==a?a:10;return Math.min(e,l)}),10);return(0,g.jsx)("div",{className:S(null),children:null===t||void 0===t?void 0:t.map(((e,t)=>(0,g.jsx)(I,{hideSeverity:a,issue:e,expanded:e===l},t)))})}function I(e){let{issue:t,hideSeverity:a,level:n=0}=e;const[s,i]=l.useState(!0),o=y(t.severity),c=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,j.kE)(t.row))return"";const{row:a,column:l}=t;return(0,j.kE)(l)?`${a}:${l}`:`line ${a}`}(t),u=t.issues,h=Array.isArray(u)&&u.length>0,m=s?"bottom":"right";return(0,g.jsxs)("div",{className:T({leaf:!h,"has-issues":h}),children:[(0,g.jsxs)("div",{className:T("line"),children:[h&&(0,g.jsx)(r.z,{view:"flat-secondary",onClick:()=>i(!s),className:T("arrow-toggle"),children:(0,g.jsx)(d.F,{direction:m,size:16})}),a?null:(0,g.jsx)(z,{severity:o}),(0,g.jsxs)("span",{className:T("message"),children:[c&&(0,g.jsx)("span",{className:T("place-text"),title:"Position",children:c}),(0,g.jsx)("div",{className:T("message-text"),children:(0,g.jsx)(f,{value:t.message,expandLabel:"Show full message"})})]}),t.issue_code?(0,g.jsxs)("span",{className:T("code"),children:["Code: ",t.issue_code]}):null]}),h&&s&&(0,g.jsx)("div",{className:T("issues"),children:(0,g.jsx)(k,{issues:u,level:n+1,expanded:s})})]})}function k(e){const{issues:t,level:a,expanded:l}=e;return(0,g.jsx)("div",{className:T("list"),children:t.map(((e,t)=>(0,g.jsx)(I,{issue:e,level:a,expanded:l},t)))})}const A={S_INFO:n.Z,S_WARNING:s.Z,S_ERROR:i.Z,S_FATAL:o.Z},R=(0,h.cn)("yql-issue-severity");function z(e){let{severity:t}=e;const a=t.slice(2).toLowerCase();return(0,g.jsxs)("span",{className:R({severity:a}),children:[(0,g.jsx)(c.J,{className:R("icon"),data:A[t]}),(0,g.jsx)("span",{className:R("title"),children:a})]})}},6215:(e,t,a)=>{a.d(t,{_:()=>n});var l=a(96183);const n=a(78759).h.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async(e,t)=>{let{id:a,database:n}=e,{signal:s}=t;try{const[e,t,i]=await Promise.all([window.api.getTablet({id:a,database:n},{signal:s}),window.api.getTabletHistory({id:a,database:n},{signal:s}),window.api.getNodesList({signal:s})]),o=(0,l.Xs)(i),r=Object.keys(t).reduce(((e,a)=>{var l;const n=null===(l=t[a])||void 0===l?void 0:l.TabletStateInfo;if(n&&n.length){const t=n.find((e=>e.Leader))||n[0],{ChangeTime:l,Generation:s,State:i,Leader:r,FollowerId:d}=t,c=o&&a?o.get(Number(a)):void 0;"Dead"!==i&&e.push({nodeId:a,generation:s,changeTime:l,state:i,leader:r,followerId:d,fqdn:c})}return e}),[]),{TabletStateInfo:d=[]}=e,[c={}]=d,{TabletId:u}=c;return{data:{id:u,data:c,history:r}}}catch(i){return{error:i}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async(e,t)=>{let{tenantId:a}=e,{signal:l}=t;try{const e=await window.api.getTabletDescribe(a,{signal:l}),{SchemeShard:t,PathId:n}=a;return{data:(null===e||void 0===e?void 0:e.Path)||`${t}:${n}`}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async(e,t)=>{let{id:a,hiveId:l}=e,{signal:n}=t;try{return{data:await window.api.getTabletFromHive({id:a,hiveId:l},{signal:n})}}catch(s){return{error:s}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async e=>{let{id:t}=e;try{return{data:await window.api.killTablet(t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.stopTablet(t,a)}}catch(l){return{error:l}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.resumeTablet(t,a)}}catch(l){return{error:l}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},46154:(e,t,a)=>{a.d(t,{M:()=>i});var l=a(34706),n=a(59769),s=a(9951);const i=e=>{const t=l.useCallback((()=>e?s.r.readUserSettingsValue(e,{}):{}),[e]),a=l.useCallback((t=>{e&&s.r.setUserSettingsValue(e,t)}),[e]);return(0,n.M)({saveSizes:a,getSizes:t})}},55973:(e,t,a)=>{a.d(t,{FW:()=>i,KR:()=>o});var l=a(77468),n=a(9038);const s={[n.g.Dead]:l.K.Red,[n.g.Created]:l.K.Yellow,[n.g.ResolveStateStorage]:l.K.Yellow,[n.g.Candidate]:l.K.Yellow,[n.g.BlockBlobStorage]:l.K.Yellow,[n.g.WriteZeroEntry]:l.K.Yellow,[n.g.Restored]:l.K.Yellow,[n.g.Discover]:l.K.Yellow,[n.g.Lock]:l.K.Yellow,[n.g.Stopped]:l.K.Yellow,[n.g.ResolveLeader]:l.K.Yellow,[n.g.RebuildGraph]:l.K.Yellow,[n.g.Deleted]:l.K.Green,[n.g.Active]:l.K.Green},i=(Object.keys(n.g),Object.entries(s).reduce(((e,t)=>{let[a,l]=t;return e[l]?e[l].push(a):e[l]=[a],e}),{}),e=>{if(!e)return l.K.Grey;return t=e,Object.values(l.K).includes(t)?e:s[e];var t});function o(e){if(!e)return"unknown";switch(e){case n.g.Dead:return"danger";case n.g.Active:case n.g.Deleted:return"success";default:return"warning"}}},96334:(e,t,a)=>{a.d(t,{Z:()=>n});var l=a(34706);const n=e=>l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),l.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 2.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8.75 5a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 0 1.5 0V5Z",clipRule:"evenodd"}))},29254:(e,t,a)=>{a.d(t,{Z:()=>n});var l=a(34706);const n=e=>l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),l.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm1-9.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8 7.75a.75.75 0 0 1 .75.75V11a.75.75 0 0 1-1.5 0V8.5A.75.75 0 0 1 8 7.75Z",clipRule:"evenodd"}))},15268:(e,t,a)=>{a.d(t,{Z:()=>n});var l=a(34706);const n=e=>l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),l.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.836 2.244c.962-1.665 3.366-1.665 4.328 0l4.917 8.505c.964 1.666-.239 3.751-2.164 3.751H3.083c-1.925 0-3.128-2.085-2.164-3.751l4.917-8.505ZM8 5a.75.75 0 0 1 .75.75v2a.75.75 0 1 1-1.5 0v-2A.75.75 0 0 1 8 5Zm1 5.75a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z",clipRule:"evenodd"}))},5194:(e,t,a)=>{a.d(t,{O:()=>s});var l=a(34706);const n=(0,a(87578).Ge)("skeleton");function s(e){let{className:t,style:a,qa:s}=e;return l.createElement("div",{className:n(null,t),style:a,"data-qa":s})}}}]);