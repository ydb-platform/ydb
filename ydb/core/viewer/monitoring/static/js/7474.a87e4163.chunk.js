"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[7474],{74003:(e,t,s)=>{s.d(t,{q:()=>h});var r=s(26714),n=s(72616),a=s(26390),o=s(78759),i=s(99294),l=s(55842),d=s(37711);const u=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),c=(0,d.wZ)("ydb-diagnostics-autorefresh-control",{en:u});var p=s(10161);const m=(0,i.cn)("auto-refresh-control");function h(e){let{className:t}=e;const s=(0,l.zL)(),[i,d]=(0,l.Rj)();return(0,p.jsxs)("div",{className:m(null,t),children:[(0,p.jsx)(n.z,{view:"flat",onClick:()=>{s(o.h.util.invalidateTags(["All"]))},extraProps:{"aria-label":c("Refresh")},children:(0,p.jsx)(n.z.Icon,{children:(0,p.jsx)(r.Z,{})})}),(0,p.jsxs)(a.P,{value:[String(i)],onUpdate:e=>{d(Number(e))},width:85,children:[(0,p.jsx)(a.P.Option,{value:"0",children:c("None")}),(0,p.jsx)(a.P.Option,{value:"15000",children:c("15 sec")}),(0,p.jsx)(a.P.Option,{value:"60000",children:c("1 min")}),(0,p.jsx)(a.P.Option,{value:"120000",children:c("2 min")}),(0,p.jsx)(a.P.Option,{value:"300000",children:c("5 min")})]})]})}},61168:(e,t,s)=>{s.d(t,{l:()=>l});var r=s(16318),n=s(99294),a=s(10161);const o=(0,n.cn)("ydb-cell-with-popover"),i=100;function l(e){let{children:t,className:s,wrapperClassName:n,...l}=e;return(0,a.jsx)("div",{className:o(null,n),children:(0,a.jsx)(r.J,{delayClosing:i,delayOpening:i,className:o("popover",s),...l,children:t})})}},43926:(e,t,s)=>{s.d(t,{f:()=>o});var r=s(34706),n=s(24874),a=s(10161);const o=e=>{let{children:t,content:s,className:o,pinOnClick:i,hasArrow:l=!0,placement:d=["top","bottom"],...u}=e;const[c,p]=r.useState(!1),[m,h]=r.useState(!1),g=r.useRef(null);return(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)(n.G,{anchorRef:g,open:m||c,placement:d,hasArrow:l,onOutsideClick:()=>{h(!1)},...u,children:s}),(0,a.jsx)("span",{className:o,ref:g,onClick:i?()=>{h(!0)}:void 0,onMouseEnter:()=>{p(!0)},onMouseLeave:()=>{p(!1)},children:t})]})}},90457:(e,t,s)=>{s.d(t,{p:()=>d});s(34706);var r=s(99294),n=s(27810),a=s(53458),o=s(55842),i=s(10161);const l=(0,r.cn)("storage-disk-progress-bar");function d(e){let{diskAllocatedPercent:t=-1,severity:s,compact:r,faded:d,inactive:u,empty:c,content:p,className:m}=e;const[h]=(0,o.yu)(n.yT),g={inverted:h,compact:r,faded:d,empty:c,inactive:u},v=void 0!==s&&(0,a.b2)(s);v&&(g[v.toLocaleLowerCase()]=!0);return(0,i.jsxs)("div",{className:l(g,m),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":t,children:[(()=>{if(r)return(0,i.jsx)("div",{className:l("fill-bar",g),style:{width:"100%"}});const e=h?100-t:t;return t>=0?(0,i.jsx)("div",{className:l("fill-bar",g),style:{width:`${e}%`}}):null})(),p||(!r&&t>=0?(0,i.jsx)("div",{className:l("title"),children:`${Math.round(t)}%`}):null)]})}},14325:(e,t,s)=>{s.d(t,{C:()=>l});var r=s(2634),n=s(99294);const a=(0,s(37711).wZ)("ydb-entities-count",{ru:{of:"\u0438\u0437"},en:{of:"of"}});var o=s(10161);const i=(0,n.cn)("ydb-entities-count"),l=e=>{let{total:t,current:s,label:n,loading:l,className:d}=e,u="";return n&&(u+=`${n}: `),l?u+="...":(u+=`${s}`,t&&Number(t)!==Number(s)&&(u+=` ${a("of")} ${t}`)),(0,o.jsx)(r._,{theme:"info",size:"m",className:i(null,d),children:u})}},62508:(e,t,s)=>{s.d(t,{A:()=>c});var r=s(17823),n=s(99175),a=s(77468),o=s(99294),i=s(32489),l=s(73287),d=s(10161);const u=(0,o.cn)("entity-status");function c(e){let{status:t=a.K.Grey,name:s="",label:o,path:c,iconPath:p,size:m="s",mode:h="color",showStatus:g=!0,externalLink:v=!1,withLeftTrim:N=!1,hasClipboardButton:S,clipboardButtonAlwaysVisible:b=!1,className:f}=e;const x=()=>g?(0,d.jsx)(l.J,{className:u("icon"),status:t,size:m,mode:h}):null;return(0,d.jsxs)("div",{className:u(null,f),title:s,children:[p?(w=p,(0,d.jsx)(r.r,{target:"_blank",href:w,children:x()})):x(),o&&(0,d.jsx)("span",{title:o,className:u("label",{size:m,state:t.toLowerCase()}),children:o}),(c||s)&&(0,d.jsxs)("div",{className:u("wrapper"),children:[(0,d.jsx)("span",{className:u("link",{"with-left-trim":N}),children:c?v?(0,d.jsx)(r.r,{className:u("name"),href:c,children:s}):(0,d.jsx)(i.h,{className:u("name"),to:c,children:s}):s&&(0,d.jsx)("span",{className:u("name"),children:s})}),S&&(0,d.jsx)("div",{className:u("controls-wrapper",{visible:b}),children:(0,d.jsx)(n.m,{text:s,size:"xs",view:"normal",className:u("clipboard-button",{visible:b})})})]})]});var w}},91890:(e,t,s)=>{s.d(t,{I:()=>u});var r=s(34706),n=s(24874),a=s(58399),o=s.n(a),i=s(99294),l=s(10161);const d=(0,i.cn)("hover-popup"),u=e=>{let{children:t,popupContent:s,showPopup:a,offset:i,anchorRef:u,onShowPopup:c,onHidePopup:p,placement:m=["top","bottom"],contentClassName:h}=e;const[g,v]=r.useState(!1),N=r.useRef(null),S=r.useMemo((()=>o()((()=>{v(!0),null===c||void 0===c||c()}),100)),[c]),b=r.useCallback((()=>{v(!1),null===p||void 0===p||p()}),[p]),f=r.useMemo((()=>o()(b,100)),[b]),x=S,[w,D]=r.useState(!1),[k,y]=r.useState(!1),I=r.useCallback((()=>{D(!0)}),[]),j=r.useCallback((()=>{D(!1)}),[]),C=r.useCallback((()=>{y(!0)}),[]),P=r.useCallback((()=>{y(!1)}),[]),E=r.useCallback((()=>{y(!1),D(!1),b()}),[b]),G=g||a||w||k;return(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)("span",{ref:N,onMouseEnter:x,onMouseLeave:()=>{S.cancel(),f()},children:t}),(0,l.jsx)(n.G,{contentClassName:d(null,h),anchorRef:u||N,open:G,onMouseEnter:I,onMouseLeave:j,onEscapeKeyDown:E,onBlur:P,placement:m,hasArrow:!0,offset:i||[0,12],children:(0,l.jsx)("div",{onContextMenu:C,children:s})})]})}},66970:(e,t,s)=>{s.d(t,{J:()=>S,b:()=>N});var r=s(34706),n=s(65e3),a=s(4969),o=s(77468),i=s(25665),l=s(27810),d=s(70340),u=s(53458),c=s(55842),p=s(73689),m=s(41591),h=s(90808),g=s(10161);const v=[o.K.Orange,o.K.Red,o.K.Yellow],N=(e,t,s)=>{var r;const{AvailableSize:n,TotalSize:a,State:o,PDiskId:c,NodeId:m,Path:N,Realtime:S,Type:b,Device:f}=e,x=[{label:"PDisk",value:null!==(r=(0,u.CH)(m,c))&&void 0!==r?r:l.jX},{label:"State",value:o||"not available"},{label:"Type",value:b||"unknown"}];if(m&&x.push({label:"Node Id",value:m}),t&&x.push({label:"Host",value:t}),N&&x.push({label:"Path",value:N}),x.push({label:"Available",value:`${(0,p.Uz)(n)} of ${(0,p.Uz)(a)}`}),S&&v.includes(S)&&x.push({label:"Realtime",value:S}),f&&v.includes(f)&&x.push({label:"Device",value:f}),s&&(0,i.D)(m)&&(0,i.D)(c)){const e=(0,d.ok)({nodeId:m,pDiskId:c});x.push({label:"Links",value:(0,g.jsx)(h.j,{title:"Developer UI",url:e})})}return x},S=e=>{let{data:t}=e;const s=(0,c.ix)(n.VH),o=(0,c.ix)(a.s),l=(0,i.D)(t.NodeId)?null===o||void 0===o?void 0:o.get(t.NodeId):void 0,d=r.useMemo((()=>N(t,l,s)),[t,l,s]);return(0,g.jsx)(m._P,{title:"PDisk",info:d,size:"s"})}},79317:(e,t,s)=>{s.d(t,{WQ:()=>U});var r=s(34706),n=s(25665),a=s(74640);const o=s(78759).h.injectEndpoints({endpoints:function(e){return{fetchTableChunk:e.query({queryFn:async(e,t)=>{let{offset:s,limit:r,sortParams:n,filters:a,columnsIds:o,fetchData:i}=e,{signal:l}=t;try{return{data:await i({limit:r,offset:s,filters:a,sortParams:n,columnsIds:o,signal:l})}}catch(d){return{error:d}}},providesTags:["All"]})}}});var i=s(55842),l=s(15327),d=s(5194);const u="left",c=!0,p=-1,m=40;const h=(0,s(99294).cn)("ydb-paginated-table");var g=s(10161);const v=e=>{let{children:t,className:s,height:r,width:n,align:a=u,resizeable:o}=e;return(0,g.jsx)("td",{className:h("row-cell",{align:a},s),style:{height:`${r}px`,width:`${n}px`,maxWidth:o?`${n}px`:void 0},children:t})},N=e=>{let{index:t,columns:s,height:r}=e;return(0,g.jsx)("tr",{className:h("row",{loading:!0}),children:s.map((e=>{var s;const n=null!==(s=e.resizeable)&&void 0!==s?s:c;return(0,g.jsx)(v,{height:r,width:e.width,align:e.align,className:e.className,resizeable:n,children:(0,g.jsx)(d.O,{className:h("row-skeleton"),style:{width:"80%",height:"50%"}})},`${e.name}${t}`)}))})},S=e=>{let{row:t,index:s,columns:r,getRowClassName:n,height:a}=e;const o=null===n||void 0===n?void 0:n(t);return(0,g.jsx)("tr",{className:h("row",o),children:r.map((e=>{var r;const n=null!==(r=e.resizeable)&&void 0!==r?r:c;return(0,g.jsx)(v,{height:a,width:e.width,align:e.align,className:e.className,resizeable:n,children:e.render({row:t,index:s})},`${e.name}${s}`)}))})},b=e=>{let{columns:t,children:s}=e;return(0,g.jsx)("tr",{className:h("row",{empty:!0}),children:(0,g.jsx)("td",{colSpan:t.length,className:h("td"),children:s})})},f=e=>{var t;let{id:s,limit:a,totalLength:d,rowHeight:u,columns:c,fetchData:p,tableName:m,filters:h,sortParams:v,getRowClassName:f,renderErrorMessage:x,onDataFetched:w,isActive:D}=e;const[k,y]=r.useState(!0),[I]=(0,i.Rj)(),j={offset:s*a,limit:a,fetchData:p,filters:h,sortParams:v,columnsIds:c.map((e=>e.name)),tableName:m};o.useFetchTableChunkQuery(j,{skip:k||!D,pollingInterval:I});const{currentData:C,error:P}=o.endpoints.fetchTableChunk.useQueryState(j);r.useEffect((()=>{let e=0;return D&&k&&(e=window.setTimeout((()=>{y(!1)}),200)),()=>{window.clearTimeout(e)}}),[D,k]),r.useEffect((()=>{if(C&&D){const{total:e=0,found:t=0}=C;w(e,t)}}),[C,D,w]);const E=d-s*a,G=E<a?E:a,T=(null===C||void 0===C||null===(t=C.data)||void 0===t?void 0:t.length)||G,U=T?T*u:a*u;return(0,g.jsx)("tbody",{id:s.toString(),style:{height:`${U}px`,display:D?"table-row-group":"block"},children:(()=>{if(!D)return null;if(!C){if(P){const e=P;return(0,g.jsx)(b,{columns:c,children:x?x(e):(0,g.jsx)(l.V,{error:e})})}return(0,n.c$)(T).map((e=>(0,g.jsx)(N,{columns:c,height:u,index:e},e)))}return C.data.map(((e,t)=>(0,g.jsx)(S,{index:t,row:e,columns:c,height:u,getRowClassName:f},t)))})()})};function x(e){let{minWidth:t,maxWidth:s,getCurrentColumnWidth:n,onResize:a}=e;const o=r.useRef(null),[i,l]=r.useState(!1);return r.useEffect((()=>{const e=o.current;if(!e)return;let r,i,d;const u=function(e){let t,s=null;return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];t=n,"number"!==typeof s&&(s=requestAnimationFrame((()=>{e(...t),s=null})))}}((e=>{if(w(e),"number"!==typeof r||"number"!==typeof i)return;const n=e.clientX-r,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Math.max(t,Math.min(e,s))}(i+n,t,s);o!==d&&(d=o,null===a||void 0===a||a(d))})),c=e=>{w(e),void 0!==d&&(null===a||void 0===a||a(d)),l(!1),r=void 0,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)},p=e=>{i=n(),w(e),r=e.clientX,l(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)};return e.addEventListener("mousedown",p),()=>{e.removeEventListener("mousedown",p),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)}}),[a,t,s,n]),(0,g.jsx)("span",{ref:o,className:h("resize-handler",{resizing:i}),onClick:e=>w(e)})}function w(e){e.preventDefault(),e.stopPropagation()}const D=e=>{let{order:t}=e;return(0,g.jsx)("svg",{className:h("sort-icon",{desc:-1===t}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,g.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})})},k=e=>{let{sortOrder:t,sortable:s,defaultSortOrder:r}=e;return s?(0,g.jsx)("span",{className:h("sort-icon-container",{shadow:!t}),children:(0,g.jsx)(D,{order:t||r})}):null},y=e=>{var t;let{column:s,resizeable:n,sortOrder:a,defaultSortOrder:o,onSort:i,rowHeight:l,onCellMount:d,onCellUnMount:u,onColumnsResize:c}=e;const p=r.useRef(null);r.useEffect((()=>{const e=p.current;return e&&(null===d||void 0===d||d(e)),()=>{e&&(null===u||void 0===u||u(e))}}),[d,u]);const m=r.useCallback((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.getBoundingClientRect().width}),[]),v=r.useCallback((e=>{null===c||void 0===c||c(s.name,e)}),[c,s.name]),N=null!==(t=s.header)&&void 0!==t?t:s.name,S={height:`${l}px`,width:`${s.width}px`,minWidth:n?`${s.width}px`:void 0,maxWidth:n?`${s.width}px`:void 0};return(0,g.jsxs)("th",{ref:p,className:h("head-cell-wrapper"),style:S,children:[(0,g.jsxs)("div",{className:h("head-cell",{align:s.align,sortable:s.sortable},s.className),onClick:()=>{s.sortable&&(null===i||void 0===i||i(s.name))},children:[(0,g.jsx)("div",{className:h("head-cell-content"),children:N}),(0,g.jsx)(k,{sortOrder:a,sortable:s.sortable,defaultSortOrder:o})]}),n?(0,g.jsx)(x,{maxWidth:s.resizeMaxWidth,minWidth:s.resizeMinWidth,getCurrentColumnWidth:m,onResize:v}):null]})},I=e=>{let{columns:t,onSort:s,onColumnsResize:n,defaultSortOrder:a=p,rowHeight:o=m}=e;const[i,l]=r.useState({}),d=e=>{let t={};if(e===i.columnId){if(i.sortOrder&&i.sortOrder!==a)return l(t),void(null===s||void 0===s||s(t));t={sortOrder:1===i.sortOrder?-1:1,columnId:e}}else t={sortOrder:a,columnId:e};null===s||void 0===s||s(t),l(t)};return(0,g.jsxs)(r.Fragment,{children:[(0,g.jsx)("colgroup",{children:t.map((e=>(0,g.jsx)("col",{style:{width:`${e.width}px`}},e.name)))}),(0,g.jsx)("thead",{className:h("head"),children:(0,g.jsx)("tr",{children:t.map((e=>{var t;const s=i.columnId===e.name?i.sortOrder:void 0,r=n&&(null!==(t=e.resizeable)&&void 0!==t?t:c);return(0,g.jsx)(y,{column:e,resizeable:r,sortOrder:s,defaultSortOrder:a,onSort:d,rowHeight:o,onColumnsResize:n},e.name)}))})})]})};var j=s(37711);const C=JSON.parse('{"empty":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"}'),P=(0,j.wZ)("ydb-paginated-table",{ru:C,en:{empty:"No data"}});var E=s(76421);const G=e=>{let{limit:t,initialEntitiesCount:s,fetchData:o,filters:i,tableName:l,columns:d,getRowClassName:u,rowHeight:c=m,parentRef:p,initialSortParams:v,onColumnsResize:N,renderControls:S,renderErrorMessage:x,renderEmptyDataMessage:w,containerClassName:D}=e;const k=s||t,y=s||0,[j,C]=r.useState(v),[G,T]=r.useState(k),[U,R]=r.useState(y),[L,M]=r.useState(!0),A=r.useRef(null),V=(e=>{let{containerRef:t,totalItems:s,itemHeight:a,chunkSize:o}=e;const[i,l]=r.useState((0,n.c$)(2).map((e=>e))),d=r.useCallback((()=>{const e=t.current;if(!e)return;const{scrollTop:r,clientHeight:i}=e,d=Math.floor(r/a),u=Math.min(Math.ceil((r+i)/a),s-1),c=Math.floor(d/o),p=Math.floor(u/o),m=(0,n.c$)(p-c+1+1).map((e=>c+e));l(m)}),[o,t,a,s]),u=r.useMemo((()=>(0,E.throttle)(d,100)),[d]);return r.useEffect((()=>{const e=t.current;if(e)return e.addEventListener("scroll",u),()=>{e.removeEventListener("scroll",u),u.cancel()}}),[t,u]),i})({containerRef:null!==p&&void 0!==p?p:A,totalItems:U,itemHeight:c,chunkSize:t}),z=r.useCallback(((e,t)=>{T(e),R(t),M(!1)}),[]);r.useLayoutEffect((()=>{var e;(T(k),R(y),M(!0),null!==p&&void 0!==p&&p.current)?p.current.scrollTo(0,0):null===(e=A.current)||void 0===e||e.scrollTo(0,0)}),[i,y,k,t,p]);const O=()=>{if(!L&&0===U)return(0,g.jsx)("tbody",{children:(0,g.jsx)(b,{columns:d,children:w?w():P("empty")})});const e=U||t,s=Math.ceil(e/t);return(0,n.c$)(s).map((s=>(0,g.jsx)(f,{id:s,limit:t,totalLength:e,rowHeight:c,columns:d,fetchData:o,filters:i,tableName:l,sortParams:j,getRowClassName:u,renderErrorMessage:x,onDataFetched:z,isActive:V.includes(s)},s)))},F=()=>(0,g.jsxs)("table",{className:h("table"),children:[(0,g.jsx)(I,{columns:d,onSort:C,onColumnsResize:N}),O()]});return(0,g.jsx)("div",{ref:A,className:h(null,D),children:S?(0,g.jsxs)(a.l,{children:[(0,g.jsx)(a.l.Controls,{children:S({inited:!L,totalEntities:G,foundEntities:U})}),(0,g.jsx)(a.l.Table,{children:F()})]}):F()})};var T=s(46154);function U(e){let{columnsWidthLSKey:t,columns:s,...r}=e;const[n,a]=(0,T.M)(t),o=function(e,t){return e.map((e=>{var s;return{...e,width:null!==(s=t[e.name])&&void 0!==s?s:e.width}}))}(s,n);return(0,g.jsx)(G,{columns:o,onColumnsResize:a,containerClassName:h("resizeable-table-container"),...r})}},31580:(e,t,s)=>{s.d(t,{m:()=>u});var r=s(99294),n=s(43926),a=s(13467),o=s(10161);const i=(0,r.cn)("ydb-pool-bar"),l=e=>{let{data:t={}}=e;const{Usage:s=0}=t,r=Math.min(100*s,100),l=(e=>e>=75?"danger":e>=50&&e<75?"warning":"normal")(r);return(0,o.jsx)(n.f,{className:i({type:l}),content:(0,o.jsx)(a.A8,{data:t,className:i("popup-content")}),children:(0,o.jsx)("div",{style:{height:`${r}%`},className:i("value",{type:l})})})},d=(0,r.cn)("ydb-pools-graph"),u=e=>{let{pools:t=[]}=e;return(0,o.jsx)("div",{className:d(),children:t.map(((e,t)=>(0,o.jsx)(l,{data:e},t)))})}},20760:(e,t,s)=>{s.d(t,{y:()=>p});var r=s(53216),n=s(99294),a=s(14075),o=s(95440),i=s(73689),l=s(10161);const d=(0,n.cn)("progress-viewer"),u=e=>(0,a.uf)((0,a.W0)(Number(e),2)),c=(e,t)=>[u(e),u(t)];function p(e){let{value:t,capacity:s,formatValues:n=c,percents:a,className:u,size:p="xs",colorizeProgress:m,inverseColorize:h,warningThreshold:g=60,dangerThreshold:v=80}=e;const N=(0,r.F)();let S=Math.round(parseFloat(String(t))/parseFloat(String(s))*100)||0;S=S>100?100:S;let b=t,f=s,x="/";a?(b=S+"%",f="",x=""):n&&([b,f]=n(Number(t),Number(s)));const w=(0,o.S)({fillWidth:S,warningThreshold:g,dangerThreshold:v,colorizeProgress:m,inverseColorize:h});m&&!(0,i.kE)(s)&&(S=100);const D={width:S+"%"};return(0,i.kE)(t)?(0,l.jsxs)("div",{className:d({size:p,theme:N,status:w},u),children:[(0,l.jsx)("div",{className:d("line"),style:D}),(0,l.jsx)("span",{className:d("text"),children:(0,i.kE)(s)?`${b} ${x} ${f}`:b})]}):(0,l.jsx)("div",{className:`${d({size:p})} ${u} error`,children:"no data"})}},74116:(e,t,s)=>{s.d(t,{G:()=>d});var r=s(59769),n=s(71624),a=s(99294),o=s(46154),i=s(10161);const l=(0,a.cn)("ydb-resizeable-data-table");function d(e){let{columnsWidthLSKey:t,columns:s,settings:a,wrapperClassName:d,...u}=e;const[c,p]=(0,o.M)(t),m=(0,r.B)(s,c),h={...a,defaultResizeable:!0};return(0,i.jsx)("div",{className:l(null,d),children:(0,i.jsx)(n.ZP,{theme:"yandex-cloud",columns:m,onResize:p,settings:h,...u})})}},76485:(e,t,s)=>{s.d(t,{o:()=>l});var r=s(34706),n=s(86357),a=s(99294),o=s(10161);const i=(0,a.cn)("ydb-search"),l=e=>{let{onChange:t,value:s="",className:a,debounce:l=200,placeholder:d}=e;const[u,c]=r.useState(s),p=r.useRef();r.useEffect((()=>{c((e=>e!==s?s:e))}),[s]);return(0,o.jsx)(n.o,{hasClear:!0,autoFocus:!0,className:i(null,a),placeholder:d,value:u,onUpdate:e=>{c(e),window.clearTimeout(p.current),p.current=window.setTimeout((()=>{null===t||void 0===t||t(e)}),l)}})}},73287:(e,t,s)=>{s.d(t,{J:()=>p});var r=s(29254),n=s(96334),a=s(15268),o=s(14561),i=s(77468),l=s(99294),d=s(10161);const u=(0,l.cn)("ydb-status-icon"),c={[i.K.Blue]:r.Z,[i.K.Yellow]:n.Z,[i.K.Orange]:a.Z,[i.K.Red]:n.Z};function p(e){let{status:t=i.K.Grey,size:s="s",mode:r="color",className:n}=e;const a={state:t.toLowerCase(),size:s};return"icons"===r&&t in c?(0,d.jsx)(o.J,{className:u("status-icon",a,n),data:c[t]}):(0,d.jsx)("div",{className:u("status-color",a,n)})}},22877:(e,t,s)=>{s.d(t,{h:()=>l});var r=s(5194),n=s(99294),a=s(83658),o=s(10161);const i=(0,n.cn)("table-skeleton"),l=e=>{let{rows:t=2,delay:s=600,className:n}=e;const[l]=(0,a.$)(s);return(0,o.jsxs)("div",{className:i("wrapper",{hidden:!l},n),children:[(0,o.jsxs)("div",{className:i("row"),children:[(0,o.jsx)(r.O,{className:i("col-1")}),(0,o.jsx)(r.O,{className:i("col-2")}),(0,o.jsx)(r.O,{className:i("col-3")}),(0,o.jsx)(r.O,{className:i("col-4")}),(0,o.jsx)(r.O,{className:i("col-5")})]}),[...new Array(t)].map(((e,t)=>(0,o.jsx)("div",{className:i("row"),children:(0,o.jsx)(r.O,{className:i("col-full")})},`skeleton-row-${t}`)))]})}},74640:(e,t,s)=>{s.d(t,{l:()=>i});var r=s(99294),n=s(22877),a=s(10161);const o=(0,r.cn)("ydb-table-with-controls-layout"),i=e=>{let{children:t,className:s}=e;return(0,a.jsx)("div",{className:o(null,s),children:t})};i.Controls=function(e){let{children:t,className:s}=e;return(0,a.jsx)("div",{className:o("controls-wrapper"),children:(0,a.jsx)("div",{className:o("controls",s),children:t})})},i.Table=function(e){let{children:t,loading:s,className:r}=e;return s?(0,a.jsx)(n.h,{className:o("loader")}):(0,a.jsx)("div",{className:o("table",r),children:t})}},56065:(e,t,s)=>{s.d(t,{X:()=>o});var r=s(67661),n=s(96183),a=s(10161);const o=e=>{let{value:t,onChange:s,className:o}=e;return(0,a.jsxs)(r.E,{value:t,onUpdate:s,className:o,children:[(0,a.jsx)(r.E.Option,{value:n.Uu.All,children:n.qU[n.Uu.All]}),(0,a.jsx)(r.E.Option,{value:n.Uu.SmallUptime,children:n.qU[n.Uu.SmallUptime]})]})}},46931:(e,t,s)=>{s.d(t,{a:()=>i});var r=s(2634),n=s(99294),a=s(10161);const o=(0,n.cn)("ydb-usage-label");function i(e){let{value:t,overloadThreshold:s=90,theme:n,...i}=e;return(0,a.jsxs)(r._,{theme:n,className:o({overload:Number(t)>=s}),...i,children:[t||0,"%"]})}},4893:(e,t,s)=>{s.d(t,{T:()=>P});var r=s(99294),n=s(90457),a=s(91890),o=s(67653),i=s(34706),l=s(2634),d=s(65e3),u=s(4969),c=s(77468),p=s(25665),m=s(27810),h=s(14075),g=s(70340),v=s(53458),N=s(55842),S=s(73689),b=s(41591),f=s(90808),x=s(66970),w=s(75544),D=s(46878);function k(e){let t;const s=(0,v.Iz)(e)?e.VDiskSlotId:e.VSlotId;return(0,p.D)(s)&&(0,p.D)(e.PDiskId)&&(0,p.D)(e.NodeId)?t=(0,D.By)(s,e.PDiskId,e.NodeId):(0,p.D)(e.NodeId)&&(0,v.Iz)(e)&&(t=(0,D.ax)(D.ZP.node,{id:e.NodeId,activeTab:w.pV},{pdiskId:e.PDiskId,vdiskId:(0,h.a2)(e.VDiskId)})),t}var y=s(10161);const I=(0,r.cn)("vdisk-storage-popup"),j=e=>{let{data:t}=e;const s=(0,v.Iz)(t),r=(0,N.ix)(d.VH),n=i.useMemo((()=>s?((e,t)=>{var s,r,n,a;const{NodeId:o,PDiskId:i,VDiskSlotId:l,StringifiedId:d,VDiskState:u,SatisfactionRank:m,DiskSpace:h,FrontQueues:v,Replicated:N,UnsyncedVDisks:b,AllocatedSize:x,ReadThroughput:w,WriteThroughput:D,StoragePoolName:k}=e,I=[{label:"VDisk",value:d},{label:"State",value:null!==u&&void 0!==u?u:"not available"}];var j,C;if(k&&I.push({label:"StoragePool",value:k}),m&&(null===(s=m.FreshRank)||void 0===s?void 0:s.Flag)!==c.K.Green&&I.push({label:"Fresh",value:null===(j=m.FreshRank)||void 0===j?void 0:j.Flag}),m&&(null===(r=m.LevelRank)||void 0===r?void 0:r.Flag)!==c.K.Green&&I.push({label:"Level",value:null===(C=m.LevelRank)||void 0===C?void 0:C.Flag}),m&&null!==(n=m.FreshRank)&&void 0!==n&&n.RankPercent&&I.push({label:"Fresh",value:m.FreshRank.RankPercent}),m&&null!==(a=m.LevelRank)&&void 0!==a&&a.RankPercent&&I.push({label:"Level",value:m.LevelRank.RankPercent}),h&&h!==c.K.Green&&I.push({label:"Space",value:h}),v&&v!==c.K.Green&&I.push({label:"FrontQueues",value:v}),N||I.push({label:"Replicated",value:"NO"}),b&&I.push({label:"UnsyncVDisks",value:b}),Number(x)&&I.push({label:"Allocated",value:(0,S.Uz)(x)}),Number(w)&&I.push({label:"Read",value:(0,S.Qt)(w)}),Number(D)&&I.push({label:"Write",value:(0,S.Qt)(D)}),t&&(0,p.D)(o)&&(0,p.D)(i)&&(0,p.D)(l)){const e=(0,g.yf)({nodeId:o,pDiskId:i,vDiskSlotId:l});I.push({label:"Links",value:(0,y.jsx)(f.j,{title:"Developer UI",url:e})})}return I})(t,r):((e,t)=>{const{NodeId:s,PDiskId:r,VSlotId:n,StoragePoolName:a}=e,o=[{label:"State",value:"not available"}];if(a&&o.push({label:"StoragePool",value:a}),o.push({label:"NodeId",value:null!==s&&void 0!==s?s:m.jX},{label:"PDiskId",value:null!==r&&void 0!==r?r:m.jX},{label:"VSlotId",value:null!==n&&void 0!==n?n:m.jX}),t&&(0,p.D)(s)&&(0,p.D)(r)&&(0,p.D)(n)){const e=(0,g.yf)({nodeId:s,pDiskId:r,vDiskSlotId:n});o.push({label:"Links",value:(0,y.jsx)(f.j,{title:"Developer UI",url:e})})}return o})(t,r)),[t,s,r]),a=(0,N.ix)(u.s),w=(0,p.D)(t.NodeId)?null===a||void 0===a?void 0:a.get(t.NodeId):void 0,D=i.useMemo((()=>s&&t.PDisk&&(0,x.b)(t.PDisk,w,r)),[t,w,s,r]),j=[];if("Donors"in t&&t.Donors){const e=t.Donors;for(const t of e){const e=(0,v.Iz)(t);j.push({label:"VDisk",value:(0,y.jsx)(o.h,{to:k(t),children:(0,h.a2)(e?t.VDiskId:{NodeId:t.NodeId,PDiskId:t.PDiskId,VSlotId:t.VSlotId})})})}}return(0,y.jsxs)("div",{className:I(),children:[t.DonorMode&&(0,y.jsx)(l._,{className:I("donor-label"),children:"Donor"}),(0,y.jsx)(b._P,{title:"VDisk",info:n,size:"s"}),D&&(0,y.jsx)(b._P,{title:"PDisk",info:D,size:"s"}),j.length>0&&(0,y.jsx)(b._P,{title:"Donors",info:j,size:"s"})]})},C=(0,r.cn)("ydb-vdisk-component"),P=e=>{let{data:t={},compact:s,inactive:r,showPopup:i,onShowPopup:l,onHidePopup:d,progressBarClassName:u}=e;const c=k(t);return(0,y.jsx)(a.I,{showPopup:i,onShowPopup:l,onHidePopup:d,popupContent:(0,y.jsx)(j,{data:t}),children:(0,y.jsx)("div",{className:C(),children:(0,y.jsx)(o.h,{to:c,className:C("content"),children:(0,y.jsx)(n.p,{diskAllocatedPercent:t.AllocatedPercent,severity:t.Severity,compact:s,inactive:r,className:u})})})})}},9796:(e,t,s)=>{s.d(t,{eb:()=>A,EF:()=>G,cB:()=>O,Up:()=>P,gs:()=>V,OJ:()=>z,rh:()=>L,Fi:()=>H,A6:()=>C,iJ:()=>E,KO:()=>T,As:()=>F,Zn:()=>M,TX:()=>W,VQ:()=>R,Zi:()=>U});var r=s(71624),n=s(16124),a=s(25665),o=s(27810),i=s(14075),l=s(61734),d=s(61168),u=s(2194),c=s(75544),p=s(70340),m=s(96183),h=s(62508),g=s(13467),v=s(10161);const N=e=>{let{node:t,getNodeRef:s,database:r}=e;if(!t.Host)return(0,v.jsx)("span",{children:"\u2014"});const n=!(0,m.TA)(t);let a;s?a=s(t)+"internal":t.NodeId&&(a=(0,p.wq)(t.NodeId)+"internal");const o=n?(0,c.a3)(t.NodeId,{tenantName:null!==r&&void 0!==r?r:t.TenantName}):void 0;return(0,v.jsx)(d.l,{disabled:!n,content:(0,v.jsx)(g.bP,{data:t,nodeHref:a}),placement:["top","bottom"],behavior:u.x.Immediate,children:(0,v.jsx)(h.A,{name:t.Host,status:t.SystemState,path:o,hasClipboardButton:!0})})};var S=s(31580),b=s(20760),f=s(26836),x=s(46878),w=s(99294),D=s(55973);const k=(0,w.cn)("tablets-statistic"),y=e=>{let{tablets:t=[],tenantName:s,nodeId:r,backend:n}=e;const a=(e=>e.map((e=>({label:(0,o.qV)(e.Type),type:e.Type,count:e.Count,state:(0,D.FW)(e.State)}))).sort(((e,t)=>String(e.label).localeCompare(String(t.label)))))(t);return(0,v.jsx)("div",{className:k(),children:a.map(((e,t)=>{var a;const o=(0,x.ax)(x.ZP.node,{id:r,activeTab:c.IA},{tenantName:s,backend:n}),i=`${e.label}: ${e.count}`,l=k("tablet",{state:null===(a=e.state)||void 0===a?void 0:a.toLowerCase()});return n?(0,v.jsx)("a",{href:o,className:l,children:i},t):(0,v.jsx)(f.rU,{to:o,className:l,children:i},t)}))})};var I=s(46931),j=s(27660);function C(){return{name:j.xv.NodeId,header:"#",width:80,render:e=>{let{row:t}=e;return t.NodeId},align:r.ZP.RIGHT}}function P(e){let{getNodeRef:t,database:s}=e;return{name:j.xv.Host,header:j.Pr.Host,render:e=>{let{row:r}=e;return(0,v.jsx)(N,{node:r,getNodeRef:t,database:s})},width:350,align:r.ZP.LEFT}}function E(){return{name:j.xv.NodeName,header:j.Pr.NodeName,align:r.ZP.LEFT,render:e=>{let{row:t}=e;return t.NodeName||o.jX},width:200}}function G(){return{name:j.xv.DC,header:j.Pr.DC,align:r.ZP.LEFT,render:e=>{let{row:t}=e;return t.DC||o.jX},width:60}}function T(){return{name:j.xv.Rack,header:j.Pr.Rack,align:r.ZP.LEFT,render:e=>{let{row:t}=e;return t.Rack||o.jX},width:100}}function U(){return{name:j.xv.Version,header:j.Pr.Version,width:200,align:r.ZP.LEFT,render:e=>{let{row:t}=e;return(0,v.jsx)(d.l,{content:t.Version,children:t.Version})}}}function R(){return{name:j.xv.Uptime,header:j.Pr.Uptime,sortAccessor:e=>{let{StartTime:t}=e;return t?-t:0},render:e=>{let{row:t}=e;return t.Uptime},align:r.ZP.RIGHT,width:110}}function L(){return{name:j.xv.Memory,header:j.Pr.Memory,sortAccessor:e=>{let{MemoryUsed:t=0}=e;return Number(t)},defaultOrder:r.ZP.DESCENDING,render:e=>{let{row:t}=e;return(0,v.jsx)(b.y,{value:t.MemoryUsed,capacity:t.MemoryLimit,formatValues:i.q3,colorizeProgress:!0})},align:r.ZP.LEFT,width:170,resizeMinWidth:170}}function M(){return{name:j.xv.SharedCacheUsage,header:j.Pr.SharedCacheUsage,render:e=>{let{row:t}=e;return(0,v.jsx)(b.y,{value:t.SharedCacheUsed,capacity:t.SharedCacheLimit,formatValues:i.q3,colorizeProgress:!0})},align:r.ZP.LEFT,width:170,resizeMinWidth:170}}function A(){return{name:j.xv.CPU,header:j.Pr.CPU,sortAccessor:e=>{let{PoolStats:t=[]}=e;return Math.max(...t.map((e=>{let{Usage:t}=e;return Number(t)})))},defaultOrder:r.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.PoolStats?(0,v.jsx)(S.m,{pools:t.PoolStats}):o.jX},align:r.ZP.LEFT,width:80,resizeMinWidth:60}}function V(){return{name:j.xv.LoadAverage,header:j.Pr.LoadAverage,sortAccessor:e=>{let{LoadAveragePercents:t=[]}=e;return t[0]},defaultOrder:r.ZP.DESCENDING,render:e=>{let{row:t}=e;return(0,v.jsx)(b.y,{value:t.LoadAveragePercents&&t.LoadAveragePercents.length>0?t.LoadAveragePercents[0]:void 0,percents:!0,colorizeProgress:!0,capacity:100})},align:r.ZP.LEFT,width:170,resizeMinWidth:170}}function z(){return{name:j.xv.Load,header:j.Pr.Load,sortAccessor:e=>{let{LoadAveragePercents:t=[]}=e;return t[0]},defaultOrder:r.ZP.DESCENDING,render:e=>{let{row:t}=e;return t.LoadAveragePercents&&t.LoadAveragePercents.length>0?(0,v.jsx)(I.a,{value:t.LoadAveragePercents[0].toFixed(),theme:(0,n.w)(t.LoadAveragePercents[0])}):o.jX},align:r.ZP.LEFT,width:80,resizeMinWidth:70}}function O(){return{name:j.xv.DiskSpaceUsage,header:j.Pr.DiskSpaceUsage,render:e=>{let{row:t}=e;return(0,a.D)(t.DiskSpaceUsage)?(0,v.jsx)(I.a,{value:Math.floor(t.DiskSpaceUsage),theme:(0,l.HQ)(t.DiskSpaceUsage)}):o.jX},align:r.ZP.LEFT,width:115,resizeMinWidth:75}}function F(){return{name:j.xv.TotalSessions,header:j.Pr.TotalSessions,render:e=>{var t;let{row:s}=e;return null!==(t=s.TotalSessions)&&void 0!==t?t:o.jX},align:r.ZP.RIGHT,width:100}}function W(e){let{database:t}=e;return{name:j.xv.Tablets,header:j.Pr.Tablets,width:500,resizeMinWidth:500,render:e=>{let{row:s}=e;return s.Tablets?(0,v.jsx)(y,{tenantName:null!==t&&void 0!==t?t:s.TenantName,nodeId:s.NodeId,tablets:s.Tablets}):o.jX},align:r.ZP.LEFT,sortable:!1}}function H(){return{name:j.xv.Missing,header:j.Pr.Missing,render:e=>{let{row:t}=e;return t.Missing},align:r.ZP.CENTER,defaultOrder:r.ZP.DESCENDING}}},27660:(e,t,s)=>{s.d(t,{xv:()=>i,Pr:()=>l,WN:()=>d,t5:()=>o});var r=s(37711);const n=JSON.parse('{"node-id":"Node ID","host":"Host","node-name":"Node Name","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Memory","cpu":"CPU","disk-usage":"Disk usage","tablets":"Tablets","load-average":"Load Average","load":"Load","caches":"Caches","sessions":"Sessions","missing":"Missing","pdisks":"PDisks"}'),a=(0,r.wZ)("ydb-nodes-columns",{en:n}),o="nodesTableColumnsWidth",i={NodeId:"NodeId",Host:"Host",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",CPU:"CPU",LoadAverage:"LoadAverage",Load:"Load",DiskSpaceUsage:"DiskSpaceUsage",SharedCacheUsage:"SharedCacheUsage",TotalSessions:"TotalSessions",Missing:"Missing",Tablets:"Tablets",PDisks:"PDisks"},l={get NodeId(){return a("node-id")},get Host(){return a("host")},get NodeName(){return a("node-name")},get DC(){return a("dc")},get Rack(){return a("rack")},get Version(){return a("version")},get Uptime(){return a("uptime")},get Memory(){return a("memory")},get CPU(){return a("cpu")},get LoadAverage(){return a("load-average")},get Load(){return a("load")},get DiskSpaceUsage(){return a("disk-usage")},get SharedCacheUsage(){return a("caches")},get TotalSessions(){return a("sessions")},get Missing(){return a("missing")},get Tablets(){return a("tablets")},get PDisks(){return a("pdisks")}},d={NodeId:["NodeId"],Host:["Host","Rack","Database","SystemState"],NodeName:["NodeName"],DC:["DC"],Rack:["Rack"],Version:["Version"],Uptime:["Uptime"],Memory:["Memory"],CPU:["CPU"],LoadAverage:["LoadAverage"],Load:["LoadAverage"],DiskSpaceUsage:["DiskSpaceUsage"],SharedCacheUsage:["SystemState"],TotalSessions:["SystemState"],Missing:["Missing"],Tablets:["Tablets","Database"],PDisks:["PDisks"]}},98530:(e,t,s)=>{s.d(t,{l:()=>g});var r=s(34706),n=s(90457),a=s(91890),o=s(67653),i=s(66970),l=s(4893),d=s(46878),u=s(25665),c=s(99294),p=s(14418),m=s(10161);const h=(0,c.cn)("pdisk-storage"),g=e=>{let{data:t={},vDisks:s,showPopup:c,onShowPopup:g,onHidePopup:v,className:N,progressBarClassName:S,viewContext:b}=e;const{NodeId:f,PDiskId:x}=t,w=(0,u.D)(f)&&(0,u.D)(x),D=r.useRef(null);let k;return w&&(k=(0,d.ds)(x,f)),(0,m.jsxs)("div",{className:h(null,N),ref:D,children:[null!==s&&void 0!==s&&s.length?(0,m.jsx)("div",{className:h("vdisks"),children:s.map((e=>(0,m.jsx)("div",{className:h("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,m.jsx)(l.T,{data:e,inactive:!(0,p.XW)(e,b),compact:!0})},e.StringifiedId)))}):null,(0,m.jsx)(a.I,{showPopup:c,anchorRef:D,onShowPopup:g,onHidePopup:v,popupContent:(0,m.jsx)(i.J,{data:t}),children:(0,m.jsxs)(o.h,{to:k,className:h("content"),children:[(0,m.jsx)(n.p,{diskAllocatedPercent:t.AllocatedPercent,severity:t.Severity,className:S}),(0,m.jsx)("div",{className:h("media-type"),children:t.Type})]})})]})}},96635:(e,t,s)=>{s.d(t,{V:()=>re,m:()=>se});var r=s(34706),n=s(51553),a=s(71624),o=s(2194),i=s(2634),l=s(16318),d=s(14561),u=s(61168),c=s(67653),p=s(73287),m=s(46931),h=s(14075),g=s(53458),v=s(99294),N=s(10161);const S=(0,v.cn)("stack"),b=e=>{let{children:t,className:s}=e;return(0,N.jsx)("div",{className:S(null,s),children:r.Children.map(t,((e,t)=>r.isValidElement(e)?(0,N.jsx)("div",{className:S("layer"),style:{"--ydb-stack-level":t},children:e}):null))})};var f=s(4893);function x(e){let{data:t,className:s,stackClassName:r,...n}=e;const{Donors:a,...o}=t||{},i=a&&a.length>0?(0,N.jsxs)(b,{className:r,children:[(0,N.jsx)(f.T,{data:o,...n}),a.map((e=>{const t=(0,g.Iz)(e);return(0,N.jsx)(f.T,{data:e,...n},(0,h.a2)(t?e.VDiskId:e))}))]}):(0,N.jsx)(f.T,{data:t,...n});return(0,N.jsx)("div",{className:s,children:i})}var w=s(46878),D=s(25665),k=s(27810),y=s(61734),I=s(83627),j=s(73689),C=s(75246),P=s(79777),E=s(98530),G=s(14418);const T=(0,v.cn)("ydb-storage-disks"),U=300;function R(e){let{vDisks:t=[],viewContext:s}=e;const[n,a]=r.useState(),{theme:{spaceBaseSize:o}}=(0,C.l)();if(!t.length)return null;const i=(U-o*(t.length-1))/t.length;return(0,N.jsxs)("div",{className:T(null),children:[(0,N.jsx)(P.k,{direction:"row",gap:1,grow:!0,style:{width:U},children:null===t||void 0===t?void 0:t.map((e=>(0,N.jsx)(L,{vDisk:e,inactive:!(0,G.XW)(e,s),highlightedVDisk:n,setHighlightedVDisk:a,unavailableVDiskWidth:i},e.StringifiedId)))}),(0,N.jsx)("div",{className:T("pdisks-wrapper"),children:null===t||void 0===t?void 0:t.map((e=>{var t;return(0,N.jsx)(M,{vDisk:e,highlightedVDisk:n,setHighlightedVDisk:a},(0,g.CH)(e.NodeId,null===e||void 0===e||null===(t=e.PDisk)||void 0===t?void 0:t.PDiskId))}))})]})}function L(e){let{vDisk:t,highlightedVDisk:s,inactive:r,setHighlightedVDisk:n,unavailableVDiskWidth:a}=e;const o={...t,PDisk:void 0},i=t.StringifiedId,l=(0,D.D)(o.AllocatedSize)?void 0:a,d=Number(o.AllocatedSize)||1;return(0,N.jsx)("div",{style:{flexGrow:d,minWidth:l},className:T("vdisk-item"),children:(0,N.jsx)(f.T,{data:o,compact:!0,inactive:r,showPopup:s===i,onShowPopup:()=>n(i),onHidePopup:()=>n(void 0),progressBarClassName:T("vdisk-progress-bar")})})}function M(e){let{vDisk:t,highlightedVDisk:s,setHighlightedVDisk:r}=e;const n=t.StringifiedId;return t.PDisk?(0,N.jsx)(E.l,{className:T("pdisk-item"),progressBarClassName:T("pdisk-progress-bar"),data:t.PDisk,showPopup:s===n,onShowPopup:()=>r(n),onHidePopup:()=>r(void 0)}):null}var A=s(50791),V=s(78090);const z=(0,v.cn)("ydb-storage-groups-columns"),O={name:V.tn.PoolName,header:V.G0.PoolName,width:250,render:e=>{let{row:t}=e;return t.PoolName?(0,N.jsx)(u.l,{content:t.PoolName,placement:["right"],behavior:o.x.Immediate,className:z("pool-name-wrapper"),children:(0,N.jsx)("span",{className:z("pool-name"),children:t.PoolName})}):k.jX},align:a.ZP.LEFT},F={name:V.tn.MediaType,header:V.G0.MediaType,width:100,resizeMinWidth:100,align:a.ZP.LEFT,render:e=>{let{row:t}=e;return(0,N.jsxs)(r.Fragment,{children:[(0,N.jsx)(i._,{children:t.MediaType||"\u2014"}),"\xa0",t.Encryption&&(0,N.jsx)(l.J,{content:(0,A.Z)("encrypted"),placement:"right",behavior:o.x.Immediate,children:(0,N.jsx)(i._,{children:(0,N.jsx)(d.J,{data:n.Z,size:18})})})]})},sortable:!1},W={name:V.tn.Erasure,header:V.G0.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:e=>{let{row:t}=e;return t.ErasureSpecies?t.ErasureSpecies:"-"},align:a.ZP.LEFT},H={name:V.tn.Degraded,header:V.G0.Degraded,width:110,resizeMinWidth:110,render:e=>{let{row:t}=e;return t.Degraded?(0,N.jsxs)(i._,{theme:(0,G._O)(t),children:["Degraded: ",t.Degraded]}):"-"},align:a.ZP.LEFT,defaultOrder:a.ZP.DESCENDING},_={name:V.tn.Usage,header:V.G0.Usage,width:85,resizeMinWidth:75,render:e=>{let{row:t}=e;return(0,D.D)(t.Usage)?(0,N.jsx)(m.a,{value:Math.floor(t.Usage),theme:(0,y.HQ)(t.Usage)}):k.jX},align:a.ZP.LEFT},Z={name:V.tn.DiskSpaceUsage,header:V.G0.DiskSpaceUsage,width:115,resizeMinWidth:75,render:e=>{let{row:t}=e;return(0,D.D)(t.DiskSpaceUsage)?(0,N.jsx)(m.a,{value:Math.floor(t.DiskSpaceUsage),theme:(0,y.HQ)(t.DiskSpaceUsage)}):k.jX},align:a.ZP.LEFT},B={name:V.tn.GroupId,header:V.G0.GroupId,width:130,render:e=>{let{row:t}=e;return t.GroupId?(0,N.jsx)(c.h,{className:z("group-id"),to:(0,w.Uu)(t.GroupId),children:t.GroupId}):"-"},sortAccessor:e=>Number(e.GroupId),align:a.ZP.RIGHT},K={name:V.tn.Used,header:V.G0.Used,width:100,render:e=>{let{row:t}=e;return(0,j.Uz)(t.Used,!0)},align:a.ZP.RIGHT},$={name:V.tn.Limit,header:V.G0.Limit,width:100,render:e=>{let{row:t}=e;return(0,j.Uz)(t.Limit)},align:a.ZP.RIGHT},Q={name:V.tn.DiskSpace,header:V.G0.DiskSpace,width:70,render:e=>{let{row:t}=e;return(0,N.jsx)(p.J,{status:t.DiskSpace})},align:a.ZP.CENTER},X={name:V.tn.Read,header:V.G0.Read,width:100,render:e=>{let{row:t}=e;return t.Read?(0,j.Qt)(t.Read):"-"},align:a.ZP.RIGHT},J={name:V.tn.Write,header:V.G0.Write,width:100,render:e=>{let{row:t}=e;return t.Write?(0,j.Qt)(t.Write):"-"},align:a.ZP.RIGHT},Y={name:V.tn.Latency,header:V.G0.Latency,width:100,render:e=>{let{row:t}=e;return(0,D.D)(t.LatencyPutTabletLogMs)?(0,I.zm)(t.LatencyPutTabletLogMs):k.jX},align:a.ZP.RIGHT},q={name:V.tn.AllocationUnits,header:V.G0.AllocationUnits,width:150,render:e=>{let{row:t}=e;return(0,D.D)(t.AllocationUnits)?(0,h.uf)(t.AllocationUnits):k.jX},align:a.ZP.RIGHT},ee=e=>({name:V.tn.VDisks,header:V.G0.VDisks,className:z("vdisks-column"),render:t=>{var s;let{row:r}=t;return(0,N.jsx)("div",{className:z("vdisks-wrapper"),children:null===(s=r.VDisks)||void 0===s?void 0:s.map((t=>(0,N.jsx)(x,{data:t,inactive:!(0,G.XW)(t,null===e||void 0===e?void 0:e.viewContext),className:z("vdisks-item")},t.StringifiedId)))})},align:a.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),te=e=>({name:V.tn.VDisksPDisks,header:V.G0.VDisksPDisks,className:z("disks-column"),render:t=>{let{row:s}=t;return(0,N.jsx)(R,{vDisks:s.VDisks,viewContext:null===e||void 0===e?void 0:e.viewContext})},align:a.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),se=()=>[B,F,W,_,K,$].map((e=>({...e,sortable:!1}))),re=e=>[B,O,F,W,H,_,Z,K,$,Q,X,J,Y,q,ee(e),te(e)].map((e=>({...e,sortable:(0,y.P7)(e.name)})))},78090:(e,t,s)=>{s.d(t,{nu:()=>u,h2:()=>v,Rt:()=>c,tn:()=>d,G0:()=>p,Ty:()=>i,r8:()=>h,j0:()=>l,Hx:()=>g});var r=s(75475),n=s(37711);const a=JSON.parse('{"pool-name":"Pool Name","type":"Type","encryption":"Encryption","erasure":"Erasure","degraded":"Degraded","missing-disks":"Missing Disks","state":"State","usage":"Usage","disk-usage":"Disk usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","latency":"Latency","allocation-units":"Allocation Units","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}'),o=(0,n.wZ)("ydb-storage-groups-columns",{en:a}),i="storageGroupsColumnsWidth",l="storageGroupsSelectedColumns",d={GroupId:"GroupId",PoolName:"PoolName",MediaType:"MediaType",Encryption:"Encryption",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",MissingDisks:"MissingDisks",Degraded:"Degraded",State:"State"},u=["GroupId","PoolName","MediaType","Erasure","Used","Limit","Usage","Read","Write","VDisks"],c=["GroupId"],p={get PoolName(){return o("pool-name")},get MediaType(){return o("type")},get Encryption(){return o("encryption")},get Erasure(){return o("erasure")},get GroupId(){return o("group-id")},get Used(){return o("used")},get Limit(){return o("limit")},get Usage(){return o("usage")},get DiskSpaceUsage(){return o("disk-usage")},get DiskSpace(){return o("space")},get Read(){return o("read")},get Write(){return o("write")},get Latency(){return o("latency")},get AllocationUnits(){return o("allocation-units")},get VDisks(){return o("vdisks")},get VDisksPDisks(){return o("vdisks-pdisks")},get Degraded(){return o("missing-disks")},get MissingDisks(){return o("missing-disks")},get State(){return o("state")}},m=["PoolName","MediaType","Encryption","Erasure","Usage","DiskSpaceUsage","State","MissingDisks","Latency"],h=m.map((e=>({value:e,content:p[e]}))),g=r.z.custom((e=>m.includes(e))).catch(void 0),v={GroupId:["GroupId"],PoolName:["PoolName"],MediaType:["MediaType","Encryption"],Encryption:["Encryption"],Erasure:["Erasure"],Used:["Used"],Limit:["Limit"],Usage:["Usage"],DiskSpaceUsage:["DiskSpaceUsage"],DiskSpace:["State"],Read:["Read"],Write:["Write"],Latency:["Latency"],AllocationUnits:["AllocationUnits"],VDisks:["VDisk","PDisk","Read","Write"],VDisksPDisks:["VDisk","PDisk","Read","Write"],MissingDisks:["MissingDisks"],Degraded:["MissingDisks"],State:["State"]}},50791:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(37711);const n=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),a=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),o=(0,r.wZ)("ydb-storage-groups",{ru:a,en:n})},92025:(e,t,s)=>{s.d(t,{V:()=>st});var r=s(27810),n=s(55842),a=s(34706),o=s(87149),i=s(48653),l=s(74640),d=s(39202),u=s(89085),c=s(53366),p=s(23795),m=s(26390),h=s(14325),g=s(76485),v=s(56065),N=s(78090),S=s(75475),b=s(27660);const f="storageNodesColumnsWidth",x="storageNodesSelectedColumns",w=["NodeId","Host","DC","Rack","CPU","Uptime","PDisks"],D=["NodeId"],k=["Host","DC","Rack","Version","Uptime","Missing","DiskSpaceUsage"],y=k.map((e=>({value:e,content:b.Pr[e]}))),I=S.z.custom((e=>k.includes(e))).catch(void 0);var j=s(67661),C=s(34695),P=s(10161);const E={[C.d.groups]:"Groups",[C.d.nodes]:"Nodes"},G=e=>{let{value:t,onChange:s}=e;return(0,P.jsxs)(j.E,{value:t,onUpdate:s,qa:"storage-type-filter",children:[(0,P.jsx)(j.E.Option,{value:C.d.groups,children:E[C.d.groups]}),(0,P.jsx)(j.E.Option,{value:C.d.nodes,children:E[C.d.nodes]})]})},T={[C.G.all]:"All",[C.G.missing]:"Degraded",[C.G.space]:"Out of Space"},U=e=>{let{value:t,onChange:s}=e;return(0,P.jsxs)(j.E,{value:t,onUpdate:s,qa:"storage-visible-entities-filter",children:[(0,P.jsx)(j.E.Option,{value:C.G.missing,children:T[C.G.missing]}),(0,P.jsx)(j.E.Option,{value:C.G.space,children:T[C.G.space]}),(0,P.jsx)(j.E.Option,{value:C.G.all,children:T[C.G.all]})]})};var R=s(37711);const L=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN","controls_group-by-placeholder":"Group by:","no-nodes":"No such nodes","no-groups":"No such groups"}'),M=(0,R.wZ)("ydb-storage",{en:L});var A=s(71037),V=s(15327),z=s(99294);const O=(0,z.cn)("global-storage"),F=e=>403===e.status?(0,P.jsx)(A.J,{position:"left"}):(0,P.jsx)(V.V,{error:e});var W=s(99495);const H=S.z.nativeEnum(C.G).catch(C.G.all),_=S.z.nativeEnum(C.d).catch(C.d.groups);var Z=s(96183);function B(){var e;const[t,s]=(0,W.useQueryParams)({type:W.StringParam,visible:W.StringParam,search:W.StringParam,uptimeFilter:W.StringParam,storageNodesGroupBy:W.StringParam,storageGroupsGroupBy:W.StringParam}),r=_.parse(t.type),n=H.parse(t.visible),a=null!==(e=t.search)&&void 0!==e?e:"",o=Z.U8.parse(t.uptimeFilter),i=N.Hx.parse(t.storageGroupsGroupBy),l=I.parse(t.storageNodesGroupBy),d=e=>{s({visible:e},"replaceIn")},u=e=>{s({uptimeFilter:e},"replaceIn")};return{storageType:r,visibleEntities:n,searchValue:a,nodesUptimeFilter:o,storageGroupsGroupByParam:i,storageNodesGroupByParam:l,handleTextFilterChange:e=>{s({search:e||void 0},"replaceIn")},handleVisibleEntitiesChange:d,handleStorageTypeChange:e=>{s({type:e},"replaceIn")},handleUptimeFilterChange:u,handleStorageGroupsGroupByParamChange:e=>{s({storageGroupsGroupBy:e},"replaceIn")},handleStorageNodesGroupByParamChange:e=>{s({storageNodesGroupBy:e},"replaceIn")},handleShowAllGroups:()=>{d("all")},handleShowAllNodes:()=>{d("all"),u(Z.Uu.All)}}}function K(e){let{withTypeSelector:t,withGroupBySelect:s,entitiesCountCurrent:r,entitiesCountTotal:n,entitiesLoading:o,columnsToSelect:i,handleSelectedColumnsUpdate:l}=e;const{searchValue:d,storageType:u,visibleEntities:v,storageGroupsGroupByParam:S,handleTextFilterChange:b,handleStorageTypeChange:f,handleVisibleEntitiesChange:x,handleStorageGroupsGroupByParamChange:w}=B();return(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(g.o,{value:d,onChange:b,placeholder:M("controls_groups-search-placeholder"),className:O("search")}),t&&(0,P.jsx)(G,{value:u,onChange:f}),s?null:(0,P.jsx)(U,{value:v,onChange:x}),(0,P.jsx)(h.C,{label:M("groups"),loading:o,total:n,current:r}),(0,P.jsx)(c.N,{popupWidth:200,items:i,showStatus:!0,onUpdate:l,sortable:!1}),s?(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(p.x,{variant:"body-2",children:M("controls_group-by-placeholder")}),(0,P.jsx)(m.P,{hasClear:!0,placeholder:"-",width:150,defaultValue:S?[S]:void 0,onUpdate:e=>{w(e[0])},options:N.r8})]}):null]})}function $(e){let{withTypeSelector:t,withGroupBySelect:s,entitiesCountCurrent:r,entitiesCountTotal:n,entitiesLoading:o,columnsToSelect:i,handleSelectedColumnsUpdate:l}=e;const{searchValue:d,storageType:u,visibleEntities:N,nodesUptimeFilter:S,storageNodesGroupByParam:b,handleTextFilterChange:f,handleStorageTypeChange:x,handleVisibleEntitiesChange:w,handleUptimeFilterChange:D,handleStorageNodesGroupByParamChange:k}=B();return(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(g.o,{value:d,onChange:f,placeholder:M("controls_nodes-search-placeholder"),className:O("search")}),t&&(0,P.jsx)(G,{value:u,onChange:x}),s?null:(0,P.jsx)(U,{value:N,onChange:w}),s?null:(0,P.jsx)(v.X,{value:S,onChange:D}),(0,P.jsx)(h.C,{label:M("nodes"),loading:o,total:n,current:r}),(0,P.jsx)(c.N,{popupWidth:200,items:i,showStatus:!0,onUpdate:l,sortable:!1}),s?(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(p.x,{variant:"body-2",children:M("controls_group-by-placeholder")}),(0,P.jsx)(m.P,{hasClear:!0,placeholder:"-",width:150,defaultValue:b?[b]:void 0,onUpdate:e=>{k(e[0])},options:y})]}):null]})}var Q=s(79317),X=s(72616),J=s(90205),Y=s(91538);const q=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),ee=JSON.parse('{"default_message":"\u0412\u0441\u0451 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435!","default_button_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"}'),te=(0,R.wZ)("ydb-storage-empty-filter",{ru:ee,en:q}),se=e=>{let{title:t,message:s=te("default_message"),showAll:r=te("default_button_label"),onShowAll:n}=e;return(0,P.jsx)(J.u,{image:(0,P.jsx)(Y.Q,{name:"thumbsUp"}),position:"left",title:t,description:s,actions:n&&[(0,P.jsx)(X.z,{onClick:n,children:r},"show-all")]})};var re=s(50791);const ne=e=>{let t,{visibleEntities:s,onShowAll:r}=e;return s===C.G.space&&(t=(0,re.Z)("empty.out_of_space")),s===C.G.missing&&(t=(0,re.Z)("empty.degraded")),t?(0,P.jsx)(se,{title:t,showAll:(0,re.Z)("show_all"),onShowAll:r}):null};var ae=s(55993),oe=s(89991),ie=s(61734),le=s(83023);const de=e=>{let{columns:t,database:s,nodeId:r,groupId:n,pDiskId:o,filterGroup:l,filterGroupBy:u,searchValue:c,visibleEntities:p,onShowAll:m,parentRef:h,renderControls:g,renderErrorMessage:v,initialEntitiesCount:S}=e;const b=(0,d.rU)(),f=(0,d.tS)(),x=(w=f,a.useCallback((async e=>{const{limit:t,offset:s,sortParams:r,filters:n,columnsIds:a}=e,{sortOrder:o,columnId:i}=null!==r&&void 0!==r?r:{},{searchValue:l,visibleEntities:d,database:u,nodeId:c,groupId:p,pDiskId:m,filterGroup:h,filterGroupBy:g}=null!==n&&void 0!==n?n:{},v=(0,ie.P7)(i)?(0,oe.A)(i,o):void 0,S=(0,le.w)(a,N.h2),{groups:b,found:f,total:x}=await(0,ae.R)({limit:t,offset:s,sort:v,filter:l,with:d,database:u,nodeId:c,groupId:p,pDiskId:m,filter_group:h,filter_group_by:g,fieldsRequired:S,shouldUseGroupsHandler:w});return{data:b||[],found:f||0,total:x||0}}),[w]));var w;const D=a.useMemo((()=>({searchValue:c,visibleEntities:p,database:s,nodeId:r,groupId:n,pDiskId:o,filterGroup:l,filterGroupBy:u})),[c,p,s,r,n,o,l,u]);return(0,P.jsx)(i.s,{loading:!b,children:(0,P.jsx)(Q.WQ,{columnsWidthLSKey:N.Ty,parentRef:h,columns:t,fetchData:x,limit:50,initialEntitiesCount:S,renderControls:g,renderErrorMessage:v,renderEmptyDataMessage:()=>p!==C.G.all?(0,P.jsx)(ne,{onShowAll:m,visibleEntities:p}):(0,re.Z)("empty.default"),filters:D,tableName:"storage-groups"})})};var ue=s(97485),ce=s(96635);function pe(e){return a.useMemo((()=>(0,ce.V)({viewContext:e})),[e])}function me(e){let{visibleEntities:t,viewContext:s}=e;const r=pe(s),n=a.useMemo((()=>t===C.G.missing?[...N.Rt,N.tn.Degraded]:t===C.G.space?[...N.Rt,N.tn.DiskSpace]:N.Rt),[t]);return(0,ue.N)(r,N.j0,N.G0,N.nu,n)}var he=s(81778),ge=s(2634);const ve=(0,z.cn)("ydb-table-group");function Ne(e){let{children:t,title:s,entityName:r,count:n,expanded:a=!1,onIsExpandedChange:o}=e;const i=()=>{o(s,!a)};return(0,P.jsxs)("div",{className:ve(null),children:[(0,P.jsx)("button",{onClick:i,className:ve("button"),title:s,children:(0,P.jsxs)("div",{className:ve("title-wrapper"),children:[(0,P.jsx)(he.F,{direction:a?"top":"bottom"}),(0,P.jsxs)("div",{className:ve("title"),children:[(0,P.jsx)(p.x,{variant:"subheader-2",children:s}),(0,P.jsxs)(p.x,{variant:"body-2",color:"secondary",className:ve("count"),children:[r,": ",(0,P.jsx)(ge._,{theme:"normal",children:n})]})]})]})}),a?(0,P.jsx)("div",{className:ve("content"),children:t}):null]})}function Se(e){const[t,s]=a.useState({});a.useEffect((()=>{null!==e&&void 0!==e&&e.length&&s((t=>e.reduce(((e,s)=>{let{name:r}=s;const n=t[r];return{...e,[r]:null!==n&&void 0!==n&&n}}),{})))}),[e]);return{expandedGroups:t,setIsGroupExpanded:a.useCallback(((e,t)=>{s((s=>({...s,[e]:t})))}),[])}}function be(e){const{storageGroupsGroupByParam:t,visibleEntities:s,handleShowAllGroups:r}=B(),n=(0,d.rU)(),o=(0,d.Pq)();a.useEffect((()=>{o&&"all"!==s&&r()}),[r,o,s]);return(0,P.jsx)(i.s,{loading:!n,children:o&&t?(0,P.jsx)(xe,{...e}):(0,P.jsx)(fe,{...e})})}function fe(e){let{database:t,nodeId:s,groupId:r,pDiskId:n,viewContext:a,parentRef:o,initialEntitiesCount:i}=e;const{searchValue:l,visibleEntities:u,handleShowAllGroups:c}=B(),p=(0,d.Pq)(),{columnsToShow:m,columnsToSelect:h,setColumns:g}=me({visibleEntities:u,viewContext:a});return(0,P.jsx)(de,{database:t,nodeId:s,groupId:r,pDiskId:n,searchValue:l,visibleEntities:u,onShowAll:c,parentRef:o,renderControls:e=>{let{totalEntities:t,foundEntities:s,inited:r}=e;return(0,P.jsx)(K,{withTypeSelector:!0,withGroupBySelect:p,entitiesCountCurrent:s,entitiesCountTotal:t,entitiesLoading:!r,columnsToSelect:h,handleSelectedColumnsUpdate:g})},renderErrorMessage:F,columns:m,initialEntitiesCount:i})}function xe(e){let{database:t,nodeId:s,groupId:r,pDiskId:a,viewContext:i}=e;const[d]=(0,n.Rj)(),{searchValue:c,storageGroupsGroupByParam:p,visibleEntities:m,handleShowAllGroups:h}=B(),{columnsToShow:g,columnsToSelect:v,setColumns:N}=me({visibleEntities:m,viewContext:i}),{currentData:S,isFetching:b,error:f}=u.y.useGetStorageGroupsInfoQuery({database:t,with:"all",nodeId:s,groupId:r,pDiskId:a,filter:c,shouldUseGroupsHandler:!0,group:p},{pollingInterval:d}),x=void 0===S&&b,{tableGroups:w,found:D=0,total:k=0}=S||{},{expandedGroups:y,setIsGroupExpanded:I}=Se(w);return(0,P.jsxs)(l.l,{children:[(0,P.jsx)(l.l.Controls,{children:(0,P.jsx)(K,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:D,entitiesCountTotal:k,entitiesLoading:x,columnsToSelect:v,handleSelectedColumnsUpdate:N})}),f?(0,P.jsx)(o.V,{error:f}):null,(0,P.jsx)(l.l.Table,{loading:x,className:O("groups-wrapper"),children:null!==w&&void 0!==w&&w.length?w.map((e=>{let{name:n,count:o}=e;const i=y[n];return(0,P.jsx)(Ne,{title:n,count:o,entityName:M("groups"),expanded:i,onIsExpandedChange:I,children:(0,P.jsx)(de,{database:t,nodeId:s,groupId:r,pDiskId:a,filterGroup:n,filterGroupBy:p,searchValue:c,visibleEntities:"all",onShowAll:h,renderErrorMessage:F,columns:g,initialEntitiesCount:o})},n)})):M("no-groups")})]})}var we=s(10730),De=s(61979);const ke=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),ye=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432","empty.out_of_space":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0443\u0437\u043b\u043e\u0432","empty.small_uptime":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432 \u0441 uptime < 1h","empty.several_filters":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0443\u0437\u043b\u044b"}'),Ie=(0,R.wZ)("ydb-storage-nodes",{ru:ye,en:ke}),je=e=>{let t,{visibleEntities:s,nodesUptimeFilter:r,onShowAll:n}=e;return s===C.G.space&&(t=Ie("empty.out_of_space")),s===C.G.missing&&(t=Ie("empty.degraded")),r===Z.Uu.SmallUptime&&(t=Ie("empty.small_uptime")),s!==C.G.all&&r!==Z.Uu.All&&(t=Ie("empty.several_filters")),t?(0,P.jsx)(se,{title:t,showAll:Ie("show_all"),onShowAll:n}):null};var Ce=s(32527);const Pe=async e=>{const{type:t="static",storage:s=!0,limit:r,offset:n,sortParams:a,filters:o,columnsIds:i}=e,{searchValue:l,nodesUptimeFilter:d,visibleEntities:u,database:c,nodeId:p,groupId:m,filterGroup:h,filterGroupBy:g}=null!==o&&void 0!==o?o:{},{sortOrder:v,columnId:N}=null!==a&&void 0!==a?a:{},S=(0,Z.oh)(N)?(0,oe.A)(N,v):void 0,f=(0,le.w)(i,b.WN),x=await window.api.getNodes({type:t,storage:s,limit:r,offset:n,sort:S,filter:l,uptime:(0,Z.RW)(d),with:u,database:c,node_id:p,group_id:m,filter_group:h,filter_group_by:g,fieldsRequired:f}),w=(0,Ce.Y2)(x);return{data:w.nodes||[],found:w.found||0,total:w.total||0}},Ee=(0,z.cn)("ydb-storage-nodes"),Ge=e=>Ee("node",{unavailable:(0,Z.TA)(e)}),Te=e=>{let{columns:t,database:s,nodeId:r,groupId:n,filterGroup:o,filterGroupBy:i,searchValue:l,visibleEntities:d,nodesUptimeFilter:u,onShowAll:c,parentRef:p,renderControls:m,renderErrorMessage:h,initialEntitiesCount:g}=e;const v=a.useMemo((()=>({searchValue:l,visibleEntities:d,nodesUptimeFilter:u,database:s,nodeId:r,groupId:n,filterGroup:o,filterGroupBy:i})),[l,d,u,s,r,n,o,i]);return(0,P.jsx)(Q.WQ,{columnsWidthLSKey:f,parentRef:p,columns:t,fetchData:Pe,rowHeight:51,limit:50,initialEntitiesCount:g,renderControls:m,renderErrorMessage:h,renderEmptyDataMessage:()=>d!==C.G.all||u!==Z.Uu.All?(0,P.jsx)(je,{onShowAll:c,nodesUptimeFilter:u,visibleEntities:d}):Ie("empty.default"),getRowClassName:Ge,filters:v,tableName:"storage-nodes"})};var Ue=s(71624),Re=s(9796),Le=s(98530);const Me=(0,z.cn)("ydb-storage-nodes-columns"),Ae=e=>{let{viewContext:t}=e;return{name:b.xv.PDisks,header:b.Pr.PDisks,className:Me("pdisks-column"),render:e=>{var s;let{row:r}=e;return(0,P.jsx)("div",{className:Me("pdisks-wrapper"),children:null===(s=r.PDisks)||void 0===s?void 0:s.map((e=>{var s;const n=null===(s=r.VDisks)||void 0===s?void 0:s.filter((t=>t.PDiskId===e.PDiskId));return(0,P.jsx)("div",{className:Me("pdisks-item"),children:(0,P.jsx)(Le.l,{data:e,vDisks:n,viewContext:t})},e.PDiskId)}))})},align:Ue.ZP.CENTER,sortable:!1,width:900,resizeable:!1}},Ve=e=>{let{database:t,additionalNodesProps:s,viewContext:r}=e;const n=null===s||void 0===s?void 0:s.getNodeRef;return[(0,Re.A6)(),(0,Re.iJ)(),(0,Re.Up)({getNodeRef:n,database:t}),(0,Re.EF)(),(0,Re.KO)(),(0,Re.Zi)(),(0,Re.rh)(),(0,Re.eb)(),(0,Re.cB)(),(0,Re.VQ)(),(0,Re.Fi)(),Ae({viewContext:r})].map((e=>({...e,sortable:(0,Z.oh)(e.name)})))};function ze(e){let{visibleEntities:t,database:s,additionalNodesProps:r,viewContext:n}=e;const o=a.useMemo((()=>Ve({database:s,additionalNodesProps:r,viewContext:n})),[s,r,n]),i=a.useMemo((()=>t===C.G.missing?[...D,b.xv.Missing]:D),[t]);return(0,ue.N)(o,x,b.Pr,w,i)}const Oe=e=>{const{storageNodesGroupByParam:t,visibleEntities:s,nodesUptimeFilter:r,handleShowAllNodes:n}=B(),o=(0,d.rU)(),l=(0,d.th)();a.useEffect((()=>{l&&"all"!==s&&r!==Z.Uu.All&&n()}),[n,r,l,s]);return(0,P.jsx)(i.s,{loading:!o,children:l&&t?(0,P.jsx)(We,{...e}):(0,P.jsx)(Fe,{...e})})};function Fe(e){let{database:t,nodeId:s,groupId:r,viewContext:n,parentRef:a,initialEntitiesCount:o}=e;const{searchValue:i,visibleEntities:l,nodesUptimeFilter:u,handleShowAllNodes:c}=B(),p=(0,d.th)(),{columnsToShow:m,columnsToSelect:h,setColumns:g}=He({database:t,viewContext:n});return(0,P.jsx)(Te,{database:t,nodeId:s,groupId:r,searchValue:i,visibleEntities:l,nodesUptimeFilter:u,onShowAll:c,parentRef:a,renderControls:e=>{let{totalEntities:t,foundEntities:s,inited:r}=e;return(0,P.jsx)($,{withTypeSelector:!0,withGroupBySelect:p,entitiesCountCurrent:s,entitiesCountTotal:t,entitiesLoading:!r,columnsToSelect:h,handleSelectedColumnsUpdate:g})},renderErrorMessage:F,columns:m,initialEntitiesCount:o})}function We(e){let{database:t,groupId:s,nodeId:r,viewContext:a}=e;const[o]=(0,n.Rj)(),{searchValue:i,storageNodesGroupByParam:d,handleShowAllNodes:c}=B(),{columnsToShow:p,columnsToSelect:m,setColumns:h}=He({database:t,viewContext:a}),{currentData:g,isFetching:v,error:N}=u.y.useGetStorageNodesInfoQuery({database:t,with:"all",filter:i,node_id:r,group_id:s,group:d},{pollingInterval:o}),S=void 0===g&&v,{tableGroups:b,found:f=0,total:x=0}=g||{},{expandedGroups:w,setIsGroupExpanded:D}=Se(b);return(0,P.jsxs)(l.l,{children:[(0,P.jsx)(l.l.Controls,{children:(0,P.jsx)($,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:f,entitiesCountTotal:x,entitiesLoading:S,columnsToSelect:m,handleSelectedColumnsUpdate:h})}),N?(0,P.jsx)(V.V,{error:N}):null,(0,P.jsx)(l.l.Table,{loading:S,className:O("groups-wrapper"),children:null!==b&&void 0!==b&&b.length?b.map((e=>{let{name:n,count:a}=e;const o=w[n];return(0,P.jsx)(Ne,{title:n,count:a,entityName:M("nodes"),expanded:o,onIsExpandedChange:D,children:(0,P.jsx)(Te,{database:t,nodeId:r,groupId:s,searchValue:i,visibleEntities:"all",nodesUptimeFilter:Z.Uu.All,onShowAll:c,filterGroup:n,filterGroupBy:d,renderErrorMessage:F,columns:p,initialEntitiesCount:a})},n)})):M("no-nodes")})]})}function He(e){let{database:t,viewContext:s}=e;const{balancer:r}=(0,we.kW)(),{additionalNodesProps:n}=(0,De.f)({balancer:r}),{visibleEntities:a}=B();return ze({additionalNodesProps:n,visibleEntities:a,database:t,viewContext:s})}var _e=s(14418);const Ze=e=>{const{storageType:t}=B();return"nodes"===t?(0,P.jsx)(Oe,{initialEntitiesCount:(0,_e._M)(e.viewContext),...e}):(0,P.jsx)(be,{initialEntitiesCount:(0,_e.le)(e.viewContext),...e})};var Be=s(93225),Ke=s(82114);const $e=e=>e.trim().toLowerCase(),Qe=(e,t)=>{const s=$e(t);return s?e.filter((e=>{var t,r;return(null===(t=e.NodeId)||void 0===t?void 0:t.toString().includes(s))||(null===(r=e.Host)||void 0===r?void 0:r.toLowerCase().includes(s))})):e},Xe=(e,t)=>{const s=$e(t);return s?e.filter((e=>{var t,r;return(null===(t=e.PoolName)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(r=e.GroupId)||void 0===r?void 0:r.toString().includes(s))})):e};var Je=s(74116);function Ye(e){let{data:t,columns:s,visibleEntities:n,onShowAll:a,sort:o,handleSort:i}=e;return t.length||n===C.G.all?(0,P.jsx)(Je.G,{columnsWidthLSKey:N.Ty,data:t,columns:s,settings:r.LE,emptyDataMessage:(0,re.Z)("empty.default"),sortOrder:o,onSort:i},n):(0,P.jsx)(ne,{onShowAll:a,visibleEntities:n})}const qe={...r.LE,dynamicRenderMinSize:51};function et(e){let{data:t,columns:s,visibleEntities:r,nodesUptimeFilter:n,sort:a,onShowAll:o,handleSort:i}=e;return t.length||r===C.G.all&&n===Z.Uu.All?(0,P.jsx)(Je.G,{columnsWidthLSKey:f,data:t,columns:s,settings:qe,emptyDataMessage:Ie("empty.default"),rowClassName:Ge,sortOrder:a,onSort:i},r):(0,P.jsx)(je,{visibleEntities:r,nodesUptimeFilter:n,onShowAll:o})}const tt=e=>{var t,s;let{database:r,viewContext:o,nodeId:i,groupId:c,pDiskId:p}=e;const{balancer:m}=(0,we.kW)(),{additionalNodesProps:h}=(0,De.f)({balancer:m}),{storageType:g,searchValue:v,visibleEntities:N,nodesUptimeFilter:S,handleShowAllGroups:b,handleShowAllNodes:f}=B(),x=(0,d.rU)(),w=(0,d.tS)(),[D]=(0,n.Rj)(),k="groups"===g,y="nodes"===g,[I,j]=a.useState({sortOrder:void 0,sortValue:void 0}),C=I.sortValue?I:_e.TP,[E,G]=a.useState({sortOrder:void 0,sortValue:void 0}),T=E.sortOrder?E:(0,_e._r)(N),{columnsToShow:U,columnsToSelect:R,setColumns:L}=ze({additionalNodesProps:h,visibleEntities:N,database:r,viewContext:o}),{columnsToShow:M,columnsToSelect:z,setColumns:F}=me({visibleEntities:N,viewContext:o}),W=u.y.useGetStorageNodesInfoQuery({database:r,with:N,node_id:i,group_id:c},{skip:!y,pollingInterval:D}),H=u.y.useGetStorageGroupsInfoQuery({database:r,with:N,nodeId:i,groupId:c,pDiskId:p,shouldUseGroupsHandler:w,fieldsRequired:"all"},{skip:!k||!x,pollingInterval:D}),{currentData:_,isFetching:Z,error:Q}=y?W:H,{currentData:{nodes:X=[]}={}}=W,{currentData:{groups:J=[]}={}}=H,Y=(null===(t=W.currentData)||void 0===t?void 0:t.total)||0,q=(null===(s=H.currentData)||void 0===s?void 0:s.total)||0,ee=void 0===_&&Z,te=a.useMemo((()=>function(e,t,s){let r=e||[];return r=Qe(r,t),r=(0,Ke.f)(r,s),r}(X,v,S)),[X,S,v]),se=a.useMemo((()=>function(e,t){let s=e||[];return s=Xe(s,t),s}(J,v)),[v,J]),[re,ne]=(0,n.sC)(C,(e=>j(e))),[ae,oe]=(0,n.sC)(T,(e=>G(e)));return(0,Be.u)(Q)?(0,P.jsx)(A.J,{position:"left"}):(0,P.jsxs)(l.l,{children:[(0,P.jsx)(l.l.Controls,{children:(0,P.jsxs)(a.Fragment,{children:[k?(0,P.jsx)(K,{withTypeSelector:!0,entitiesCountCurrent:se.length,entitiesCountTotal:q,entitiesLoading:ee,columnsToSelect:z,handleSelectedColumnsUpdate:F}):null,y?(0,P.jsx)($,{withTypeSelector:!0,entitiesCountCurrent:te.length,entitiesCountTotal:Y,entitiesLoading:ee,columnsToSelect:R,handleSelectedColumnsUpdate:L}):null]})}),Q?(0,P.jsx)(V.V,{error:Q}):null,(0,P.jsx)(l.l.Table,{loading:ee||!x,className:O("table"),children:_?(0,P.jsxs)(a.Fragment,{children:[k?(0,P.jsx)(Ye,{visibleEntities:N,data:se,onShowAll:b,sort:ae,handleSort:oe,columns:M},"groups"):null,y?(0,P.jsx)(et,{visibleEntities:N,nodesUptimeFilter:S,data:te,onShowAll:f,sort:re,handleSort:ne,columns:U},"nodes"):null]}):null})]})},st=e=>{var t,s,a,o;let{parentRef:i,...l}=e;const[d]=(0,n.yu)(r.Qy),u={nodeId:null===(t=l.nodeId)||void 0===t?void 0:t.toString(),pDiskId:null===(s=l.pDiskId)||void 0===s?void 0:s.toString(),groupId:null===(a=l.groupId)||void 0===a?void 0:a.toString(),vDiskSlotId:null===(o=l.vDiskSlotId)||void 0===o?void 0:o.toString()};return d?(0,P.jsx)(Ze,{parentRef:i,viewContext:u,...l}):(0,P.jsx)(tt,{viewContext:u,...l})}},14418:(e,t,s)=>{s.d(t,{TP:()=>p,XW:()=>N,_M:()=>b,_O:()=>c,_r:()=>v,le:()=>f});var r=s(20560),n=s(27660),a=s(34695),o=s(25665),i=s(84029),l=s(78090);const d=(0,i.p)(1,2,["success","warning","danger"]),u={"block-4-2":(0,i.p)(1,2,["success","warning","danger"]),"mirror-3-dc":(0,i.p)(1,3,["success","warning","danger"])},c=e=>{var t;return(void 0!==(t=e.ErasureSpecies)&&t in u?u[e.ErasureSpecies]:d)(e.Degraded)},p={sortValue:n.xv.NodeId,sortOrder:r.zE},m={sortValue:l.tn.PoolName,sortOrder:r.zE},h={sortValue:l.tn.Degraded,sortOrder:r.hr},g={sortValue:l.tn.Usage,sortOrder:r.hr};function v(e){return e===a.G.missing?h:e===a.G.space?g:m}function N(e,t){var s;let r=!0;return(0,o.D)(null===(s=e.VDiskId)||void 0===s?void 0:s.GroupID)&&null!==t&&void 0!==t&&t.groupId&&(r&&=String(e.VDiskId.GroupID)===t.groupId),(0,o.D)(e.NodeId)&&null!==t&&void 0!==t&&t.nodeId&&(r&&=String(e.NodeId)===t.nodeId),(0,o.D)(e.PDiskId)&&null!==t&&void 0!==t&&t.pDiskId&&(r&&=String(e.PDiskId)===t.pDiskId),(0,o.D)(e.VDiskSlotId)&&null!==t&&void 0!==t&&t.vDiskSlotId&&(r&&=String(e.VDiskSlotId)===t.vDiskSlotId),r}const S=10;function b(e){let{nodeId:t,pDiskId:s,vDiskSlotId:r}=e;return(0,o.D)(t)||(0,o.D)(s)||(0,o.D)(r)?1:S}function f(e){let{vDiskSlotId:t,groupId:s}=e;return(0,o.D)(s)||(0,o.D)(t)?1:S}},82114:(e,t,s)=>{s.d(t,{A:()=>p,f:()=>u});var r=s(77468),n=s(27810),a=s(14075),o=s(89991),i=s(96183),l=s(32341);const d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(arguments.length>1?arguments[1]:void 0)===l.pu.ALL?e:e.filter((e=>{let{SystemState:t}=e;return t&&t!==r.K.Green}))},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(arguments.length>1?arguments[1]:void 0)===i.Uu.All?e:e.filter((e=>{let{StartTime:t}=e;return!t||(0,a.OW)(t)<n.RQ}))},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t)return e;const s=(0,o.Y)(t);return e.filter((e=>!e.Host||(s.test(e.Host)||s.test(String(e.NodeId)))))};function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{uptimeFilter:t,searchValue:s,problemFilter:r}=arguments.length>1?arguments[1]:void 0,n=u(e,t);return n=d(n,r),n=c(n,s),n}},16124:(e,t,s)=>{s.d(t,{n:()=>a,w:()=>o});var r=s(84029),n=s(96183);const a=e=>{var t;const s=(e.Nodes||[]).map((e=>({...(0,n.Ns)(e.SystemState),Tablets:e.Tablets,NodeId:e.NodeId})));return{Nodes:s,NodeGroups:null===(t=e.NodeGroups)||void 0===t?void 0:t.map((e=>({name:e.GroupName,count:e.NodeCount}))),TotalNodes:Number(e.TotalNodes)||s.length,FoundNodes:Number(e.FoundNodes)}},o=(0,r.p)(60,80,["success","warning","danger"])},34695:(e,t,s)=>{s.d(t,{G:()=>r,d:()=>n});const r={all:"all",missing:"missing",space:"space"},n={groups:"groups",nodes:"nodes"}},55993:(e,t,s)=>{s.d(t,{R:()=>n});var r=s(32527);async function n(e,t){let{version:s="v2",shouldUseGroupsHandler:n,...a}=e;if(n&&"v1"!==s){const e=await window.api.getStorageGroups({...a},t);return(0,r._u)(e)}{const e=await window.api.getStorageInfo({version:s,...a},t);return(0,r.S9)(e)}}},89085:(e,t,s)=>{s.d(t,{y:()=>o});var r=s(78759),n=s(55993),a=s(32527);const o=r.h.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,t)=>{let{signal:s}=t;try{const t=await window.api.getNodes({storage:!0,type:"static",...e},{signal:s});return{data:(0,a.Y2)(t)}}catch(r){return{error:r}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,t)=>{let{signal:s}=t;try{return{data:await(0,n.R)(e,{signal:s})}}catch(r){return{error:r}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},32527:(e,t,s)=>{s.d(t,{S9:()=>v,Y2:()=>g,_u:()=>N});var r=s(96234),n=s(38392),a=s(53458),o=s(84953),i=s(96183),l=s(61734),d=s(83627);function u(e){const{DiskSpace:t,VDisks:s=[]}=e;return t||(0,a.b2)(Math.max(...s.map((e=>(0,a.Or)(e.DiskSpace)))))}const c=(e,t)=>{var s;const r=(0,o.w)(e);return{...r,StoragePoolName:t,Donors:null===r||void 0===r||null===(s=r.Donors)||void 0===s?void 0:s.map((e=>({...e,StoragePoolName:t})))}},p=e=>{const{VDisks:t=[],PoolName:s,Usage:r=0,Read:n=0,Write:a=0,Used:o=0,Limit:i=0,Degraded:l=0,Kind:d,MediaType:p,GroupID:m,Overall:h,GroupGeneration:g}=e,v=t.map((e=>c(e,s))),N=100*Number(r),S=u(e);return{...e,PoolName:s,GroupId:m,MediaType:p||d,VDisks:v,Usage:N,Overall:h,GroupGeneration:g?String(g):void 0,Read:Number(n),Write:Number(a),Used:Number(o),Limit:Number(i),Degraded:Number(l),DiskSpace:S}},m=(e,t)=>{let s=[];return e?s=e.map(p):null===t||void 0===t||t.forEach((e=>{var t;null===(t=e.Groups)||void 0===t||t.forEach((t=>{s.push(((e,t)=>{var s;let a,i=0,d=0,p=0,m=0,h=0;const{Name:g,MediaType:v}=t;if(e.VDisks)for(const l of e.VDisks){const{Replicated:e,VDiskState:t,AvailableSize:s,AllocatedSize:u,PDisk:c,ReadThroughput:g,WriteThroughput:v}=l,{Type:N,State:S,AvailableSize:b}=(0,o.b)(c);e&&S===r.w.Normal&&t===n.H.OK||(i+=1);const f=Number(null!==s&&void 0!==s?s:b)||0,x=Number(u)||0;d+=x,p+=f+x,m+=Number(g)||0,h+=Number(v)||0,a=!N||N!==a&&a?"Mixed":N}const N=null===(s=e.VDisks)||void 0===s?void 0:s.map((e=>c(e,g))),S=p?(0,l.Ic)({Used:d,Limit:p},5):void 0,b=u(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:N,Usage:S,Read:m,Write:h,PoolName:g,Used:d,Limit:p,Degraded:i,MediaType:v||a||void 0,DiskSpace:b}})(t,e))}))})),s},h=e=>{var t,s,n;const a=(null===(t=e.PDisks)||void 0===t?void 0:t.filter((e=>e.State!==r.w.Normal)).length)||0,l=null===(s=e.PDisks)||void 0===s?void 0:s.map((t=>({...(0,o.b)(t),NodeId:e.NodeId}))),d=null===(n=e.VDisks)||void 0===n?void 0:n.map((t=>({...(0,o.w)(t),NodeId:e.NodeId})));return{...(0,i.Ns)(e.SystemState),NodeId:e.NodeId,DiskSpaceUsage:e.DiskSpaceUsage,PDisks:l,VDisks:d,Missing:a}},g=e=>{const{Nodes:t,TotalNodes:s,FoundNodes:r,NodeGroups:n}=e,a=null===n||void 0===n?void 0:n.map((e=>{let{GroupName:t,NodeCount:s}=e;if(t&&s)return{name:t,count:Number(s)}})).filter((e=>Boolean(e))),o=null===t||void 0===t?void 0:t.map(h);return{nodes:o,total:Number(s)||(null===o||void 0===o?void 0:o.length),found:Number(r),tableGroups:a}},v=e=>{const{StoragePools:t,StorageGroups:s,TotalGroups:r,FoundGroups:n}=e,a=m(s,t);return{groups:a,total:Number(r)||a.length,found:Number(n)}};function N(e){const{FoundGroups:t,TotalGroups:s,StorageGroups:r=[],StorageGroupGroups:n}=e,a=r.map((e=>{const{Usage:t,DiskSpaceUsage:s,Read:r,Write:n,Used:a,Limit:i,MissingDisks:l,VDisks:c=[],Overall:p,LatencyPutTabletLog:m,LatencyPutUserData:h,LatencyGetFast:g}=e,v=c.map((e=>{const{Whiteboard:t,PDisk:s,VDiskId:r,NodeId:n,AllocatedSize:a,AvailableSize:i,DiskSpace:l,Status:d}=e,u=null===s||void 0===s?void 0:s.Whiteboard,c={...t,PDiskId:null===u||void 0===u?void 0:u.PDiskId,NodeId:n,AllocatedSize:a,AvailableSize:i,DiskSpace:l,Status:d,PDisk:{...u,NodeId:n}},p=(0,o.w)(c);return{...p,StringifiedId:p.StringifiedId||r}})),N=u(e);return{...e,Usage:t,DiskSpaceUsage:s,Read:Number(r),Write:Number(n),Used:Number(a),Limit:Number(i),LatencyPutTabletLogMs:(0,d.BO)(m),LatencyPutUserDataMs:(0,d.BO)(h),LatencyGetFastMs:(0,d.BO)(g),Degraded:Number(l),Overall:p,VDisks:v,DiskSpace:N}})),i=null===n||void 0===n?void 0:n.map((e=>{let{GroupName:t,GroupCount:s}=e;if(t&&s)return{name:t,count:Number(s)}})).filter((e=>Boolean(e)));return{groups:a,total:Number(s)||a.length,found:Number(t),tableGroups:i}}},96234:(e,t,s)=>{let r;s.d(t,{w:()=>r}),function(e){e.Initial="Initial",e.InitialFormatRead="InitialFormatRead",e.InitialFormatReadError="InitialFormatReadError",e.InitialSysLogRead="InitialSysLogRead",e.InitialSysLogReadError="InitialSysLogReadError",e.InitialSysLogParseError="InitialSysLogParseError",e.InitialCommonLogRead="InitialCommonLogRead",e.InitialCommonLogReadError="InitialCommonLogReadError",e.InitialCommonLogParseError="InitialCommonLogParseError",e.CommonLoggerInitError="CommonLoggerInitError",e.Normal="Normal",e.OpenFileError="OpenFileError",e.ChunkQuotaError="ChunkQuotaError",e.DeviceIoError="DeviceIoError",e.Missing="Missing",e.Timeout="Timeout",e.NodeDisconnected="NodeDisconnected",e.Unknown="Unknown"}(r||(r={}))},38392:(e,t,s)=>{let r;s.d(t,{H:()=>r}),function(e){e.Initial="Initial",e.LocalRecoveryError="LocalRecoveryError",e.SyncGuidRecovery="SyncGuidRecovery",e.SyncGuidRecoveryError="SyncGuidRecoveryError",e.OK="OK",e.PDiskError="PDiskError"}(r||(r={}))},53443:(e,t,s)=>{s.d(t,{i6:()=>i,mG:()=>o,mr:()=>d,oO:()=>a,s:()=>l,tH:()=>u});var r=s(96234),n=s(38392);const a={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},o=Object.entries(a).reduce(((e,t)=>{let[s,r]=t;return{...e,[r]:s}}),{}),i=a.Grey,l=o[i],d={[n.H.OK]:a.Green,[n.H.Initial]:a.Yellow,[n.H.SyncGuidRecovery]:a.Yellow,[n.H.LocalRecoveryError]:a.Red,[n.H.SyncGuidRecoveryError]:a.Red,[n.H.PDiskError]:a.Red},u={[r.w.Initial]:a.Grey,[r.w.Normal]:a.Green,[r.w.InitialFormatRead]:a.Yellow,[r.w.InitialSysLogRead]:a.Yellow,[r.w.InitialCommonLogRead]:a.Yellow,[r.w.InitialFormatReadError]:a.Red,[r.w.InitialSysLogReadError]:a.Red,[r.w.InitialSysLogParseError]:a.Red,[r.w.InitialCommonLogReadError]:a.Red,[r.w.InitialCommonLogParseError]:a.Red,[r.w.CommonLoggerInitError]:a.Red,[r.w.OpenFileError]:a.Red,[r.w.ChunkQuotaError]:a.Red,[r.w.DeviceIoError]:a.Red}},53458:(e,t,s)=>{s.d(t,{CH:()=>l,FR:()=>d,Iz:()=>a,Or:()=>i,b2:()=>o});var r=s(25665),n=s(53443);function a(e){return"VDiskId"in e}function o(e){return void 0===e?n.s:n.mG[e]||n.s}function i(e){return e?n.oO[e]:0}function l(e,t){if((0,r.D)(e)&&(0,r.D)(t))return`${e}-${t}`}function d(e,t,s){return[e,t,s].join("-")}},84953:(e,t,s)=>{s.d(t,{b:()=>g,w:()=>h});var r=s(14075),n=s(77468),a=s(84029),o=s(53443);const i=(0,a.p)(85,95,[n.K.Green,n.K.Yellow,n.K.Red]);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=function(e){return t=e,void 0!==t&&t in o.tH?o.tH[e]:o.i6;var t}(e.State),r=i(t);return s!==o.i6&&r?Math.max(s,o.oO[r]):s}var d=s(53458);function u(e){if(!(0,d.Iz)(e))return o.i6;const{DiskSpace:t,VDiskState:s,FrontQueues:r,Replicated:n}=e;if(!s)return o.i6;const a=c(t),i=function(e){var t;if(!e)return o.i6;return null!==(t=o.mr[e])&&void 0!==t?t:o.i6}(s),l=Math.min(o.oO.Orange,c(r));let u=Math.max(a,i,l);return n||u!==o.oO.Green||(u=o.oO.Blue),u}function c(e){var t;return e&&null!==(t=o.oO[e])&&void 0!==t?t:o.i6}const p={HDD:"HDD",SSD:"SSD",MVME:"NVME"};function m(e){if(!e)return;const t=function(e,t){const s={};return Object.entries(t).reduce(((t,r)=>{let[n,a]=r;const o=e.length-t,i=o-a;return s[n]=e.substring(i,o)||"0",t+a}),0),s}(BigInt(e).toString(2),{isSolidState:1,kind:55,typeExt:8});if("1"===t.isSolidState)switch(parseInt(t.typeExt,2)){case 0:return p.SSD;case 2:return p.MVME}else if("0"===t.typeExt)return p.HDD}function h(){var e,t,s,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=a.PDisk?g({...a.PDisk,NodeId:null!==(e=a.PDisk.NodeId)&&void 0!==e?e:a.NodeId}):void 0,i=null!==(t=a.PDiskId)&&void 0!==t?t:null===o||void 0===o?void 0:o.PDiskId,l=Number(null!==(s=a.AvailableSize)&&void 0!==s?s:null===o||void 0===o?void 0:o.AvailableSize),d=Number(a.AllocatedSize),c=d+l,p=Math.round(100*d/c),m=null===(n=a.Donors)||void 0===n?void 0:n.map((e=>h({...e,DonorMode:!0}))),v=u(a),N=(0,r.a2)(a.VDiskId);return{...a,PDisk:o,PDiskId:i,Donors:m,Severity:v,StringifiedId:N,TotalSize:c,AllocatedPercent:p}}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{AvailableSize:s,TotalSize:r,Category:n}=e,a=m(n),o=Number(s),i=Number(r),d=i-o,u=Math.round(100*d/i),c=l(e,u);return{...t,...e,Type:a,Severity:c,AllocatedSize:d,AllocatedPercent:u}}},89991:(e,t,s)=>{s.d(t,{A:()=>o,Y:()=>i});var r=s(20560),n=s(78171),a=s.n(n);const o=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.hr)===r.hr?`-${e}`:e},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(a()(e),"i")}},84029:(e,t,s)=>{s.d(t,{p:()=>r});const r=(e,t,s)=>r=>0<=r&&r<e?s[0]:e<=r&&r<t?s[1]:t<=r?s[2]:void 0},97485:(e,t,s)=>{s.d(t,{N:()=>a});var r=s(34706),n=s(9951);const a=(e,t,s,a,o)=>{const[i,l]=r.useState((()=>n.r.readUserSettingsValue(t,a)));return{columnsToShow:r.useMemo((()=>e.filter((e=>{const t=e.name,s=i.includes(t),r=null===o||void 0===o?void 0:o.includes(t);return s||r}))),[e,o,i]),columnsToSelect:r.useMemo((()=>e.map((e=>e.name)).map((e=>{const t=null===o||void 0===o?void 0:o.includes(e),r=i.includes(e);return{id:e,title:s[e],selected:t||r,required:t,sticky:t?"start":void 0}}))),[e,s,o,i]),setColumns:r.useCallback((e=>{const s=e.filter((e=>e.selected)).map((e=>e.id));n.r.setUserSettingsValue(t,s),l(s)}),[t])}}},46154:(e,t,s)=>{s.d(t,{M:()=>o});var r=s(34706),n=s(59769),a=s(9951);const o=e=>{const t=r.useCallback((()=>e?a.r.readUserSettingsValue(e,{}):{}),[e]),s=r.useCallback((t=>{e&&a.r.setUserSettingsValue(e,t)}),[e]);return(0,n.M)({saveSizes:s,getSizes:t})}},95440:(e,t,s)=>{function r(e){let{inverseColorize:t,warningThreshold:s=60,dangerThreshold:r=80,colorizeProgress:n,fillWidth:a}=e,o=t?"danger":"good";return n&&(a>s&&a<=r?o="warning":a>r&&(o=t?"good":"danger")),o}s.d(t,{S:()=>r})},61734:(e,t,s)=>{s.d(t,{HQ:()=>a,Ic:()=>n,P7:()=>i});var r=s(84029);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const s=e.Limit?100*e.Used/e.Limit:0;return Math.floor(s/t)*t},a=(0,r.p)(80,85,["success","warning","danger"]),o=["PoolName","Kind","MediaType","Erasure","Degraded","Usage","GroupId","Used","Limit","Read","Write","AllocationUnits","Latency","DiskSpaceUsage"],i=e=>o.includes(e)},83023:(e,t,s)=>{function r(e,t){const s=e.reduce(((e,s)=>(t[s].forEach((t=>{e.add(t)})),e)),new Set);return Array.from(s).sort()}s.d(t,{w:()=>r})},55973:(e,t,s)=>{s.d(t,{FW:()=>o,KR:()=>i});var r=s(77468),n=s(9038);const a={[n.g.Dead]:r.K.Red,[n.g.Created]:r.K.Yellow,[n.g.ResolveStateStorage]:r.K.Yellow,[n.g.Candidate]:r.K.Yellow,[n.g.BlockBlobStorage]:r.K.Yellow,[n.g.WriteZeroEntry]:r.K.Yellow,[n.g.Restored]:r.K.Yellow,[n.g.Discover]:r.K.Yellow,[n.g.Lock]:r.K.Yellow,[n.g.Stopped]:r.K.Yellow,[n.g.ResolveLeader]:r.K.Yellow,[n.g.RebuildGraph]:r.K.Yellow,[n.g.Deleted]:r.K.Green,[n.g.Active]:r.K.Green},o=(Object.keys(n.g),Object.entries(a).reduce(((e,t)=>{let[s,r]=t;return e[r]?e[r].push(s):e[r]=[s],e}),{}),e=>{if(!e)return r.K.Grey;return t=e,Object.values(r.K).includes(t)?e:a[e];var t});function i(e){if(!e)return"unknown";switch(e){case n.g.Dead:return"danger";case n.g.Active:case n.g.Deleted:return"success";default:return"warning"}}}}]);