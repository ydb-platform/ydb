"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[7488],{8659:(e,t,a)=>{a.d(t,{P:()=>y});var s=a(54665),n=a(14146),l=a(17880),i=a(5922),d=a(81854),r=a(24362),o=a(34301),c=a(48169),u=a(17096),v=a(69214),p=a(23373),h=a(32270),m=a(67359),g=a(30817);const b=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),x=(0,g.wZ)("ydb-pDisk-info",{en:b});var N=a(75859);const j=(0,r.cn)("ydb-pdisk-info");function y(e){let{pDisk:t,nodeId:a,withPDiskPageLink:r,className:g}=e;const b=(0,u.ix)(n.VH),y=(0,l.X_)(),[k,I,f,w]=function(e){let{pDisk:t,nodeId:a,withPDiskPageLink:n,isUserAllowedToMakeChanges:l}=e;const{PDiskId:r,Path:u,Guid:p,Category:g,Type:b,Device:y,Realtime:k,State:I,SerialNumber:f,TotalSize:w,AllocatedSize:D,StatusV2:T,NumActiveSlots:S,ExpectedSlotCount:P,LogUsedSize:z,LogTotalSize:V,SystemSize:A,SharedWithOs:C}=t||{},q=[];(0,i.D)(g)&&q.push({label:x("type"),value:b}),(0,i.D)(u)&&q.push({label:x("path"),value:u}),(0,i.D)(p)&&q.push({label:x("guid"),value:p}),f&&q.push({label:x("serial-number"),value:f}),(0,i.D)(C)&&q.push({label:x("shared-with-os"),value:x("yes")});const E=[];(0,i.D)(T)&&E.push({label:x("drive-status"),value:T}),(0,i.D)(I)&&E.push({label:x("state"),value:I}),(0,i.D)(y)&&E.push({label:x("device"),value:(0,N.jsx)(v.A,{status:y})}),(0,i.D)(k)&&E.push({label:x("realtime"),value:(0,N.jsx)(v.A,{status:k})});const R=[];R.push({label:x("space"),value:(0,N.jsx)(m.y,{value:D,capacity:w,formatValues:o.q3,colorizeProgress:!0})}),(0,i.D)(S)&&(0,i.D)(P)&&R.push({label:x("slots"),value:(0,N.jsx)(m.y,{value:S,capacity:P})}),(0,i.D)(z)&&(0,i.D)(V)&&R.push({label:x("log-size"),value:(0,N.jsx)(m.y,{value:z,capacity:V,formatValues:o.q3})}),(0,i.D)(A)&&R.push({label:x("system-size"),value:(0,d.td)({value:A})});const L=[];if((n||l)&&(0,i.D)(r)&&(0,i.D)(a)){const e=(0,s.ds)(r,a),t=(0,c.ok)({nodeId:a,pDiskId:r});L.push({label:x("links"),value:(0,N.jsxs)("span",{className:j("links"),children:[n&&(0,N.jsx)(h.j,{title:x("pdisk-page"),url:e,external:!1}),l&&(0,N.jsx)(h.j,{title:x("developer-ui"),url:t})]})})}return[q,E,R,L]}({pDisk:t,nodeId:a,withPDiskPageLink:r&&y,isUserAllowedToMakeChanges:b});return(0,N.jsxs)("div",{className:j("wrapper",g),children:[(0,N.jsxs)("div",{className:j("col"),children:[(0,N.jsx)(p._,{info:k,renderEmptyState:()=>null}),(0,N.jsx)(p._,{info:f,renderEmptyState:()=>null})]}),(0,N.jsxs)("div",{className:j("col"),children:[(0,N.jsx)(p._,{info:I,renderEmptyState:()=>null}),(0,N.jsx)(p._,{info:w,renderEmptyState:()=>null})]})]})}},97482:(e,t,a)=>{a.d(t,{f:()=>i});var s=a(14979),n=a(83496),l=a(75859);function i(e){let{state:t}=e;return(0,l.jsx)(s._,{theme:(0,n.KR)(t),children:t})}},12199:(e,t,a)=>{a.d(t,{$:()=>r});var s=a(24362),n=a(75859);const l=(0,s.cn)("tag"),i=e=>{let{text:t,type:a}=e;return(0,n.jsx)("div",{className:l({type:a}),children:t})},d=(0,s.cn)("tags"),r=e=>{let{tags:t,tagsType:a,className:s=""}=e;return(0,n.jsx)("div",{className:d(null,s),children:t&&t.map(((e,t)=>(0,n.jsx)(i,{text:e,type:a},t)))})}},72473:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>ge,STORAGE_ROLE:()=>me});var s=a(68963),n=a(8179),l=a(49352),i=a(86974),d=a(83203),r=a(50422),o=a(39683),c=a(88776),u=a(24362),v=a(48169),p=a(69214),h=a(12199),m=a(75859);const g=(0,u.cn)("basic-node-viewer"),b=e=>{let t,{node:a,additionalNodesProps:n,className:l}=e;return null!==n&&void 0!==n&&n.getNodeRef?t=n.getNodeRef(a)+"internal":a.NodeId&&(t=(0,v.wq)(a.NodeId)+"internal"),(0,m.jsx)("div",{className:g(null,l),children:a?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:g("title"),children:"Node"}),(0,m.jsx)(p.A,{status:a.SystemState,name:a.Host}),t&&(0,m.jsx)("a",{rel:"noopener noreferrer",className:g("link",{external:!0}),href:t,target:"_blank",children:(0,m.jsx)(c.J,{data:o.Z})}),(0,m.jsxs)("div",{className:g("id"),children:[(0,m.jsx)("label",{className:g("label"),children:"NodeID"}),(0,m.jsx)("label",{children:a.NodeId})]}),a.DC&&(0,m.jsx)(h.$,{tags:[a.DC]}),a.Roles&&(0,m.jsx)(h.$,{tags:a.Roles,tagsType:"blue"})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var x=a(26688),N=a(52317),j=a(23373);const y=(0,u.cn)("ydb-pool-usage"),k=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},I=e=>{let{data:t={}}=e;const{Threads:a,Name:s="Unknown",Usage:n=0}=t,l=n&&a,i=Math.floor(100*n),d=i>100?100:i;return(0,m.jsxs)("div",{className:y(),children:[(0,m.jsxs)("div",{className:y("info"),children:[(0,m.jsx)("div",{className:y("pool-name"),children:s}),l&&(0,m.jsxs)("div",{className:y("value"),children:[(0,m.jsxs)("div",{className:y("percents"),children:[i<1?"<1":i,"%"]}),(0,m.jsxs)("div",{className:y("threads"),children:["(\xd7",a,")"]})]})]}),(0,m.jsx)("div",{className:y("visual"),children:(0,m.jsx)("div",{className:y("usage-line",{type:k(d)}),style:{width:"".concat(d,"%")}})})]})};var f=a(67359);const w=(0,u.cn)("full-node-viewer"),D=e=>{var t,a,s,n;let{node:l,className:i}=e;const d=null===l||void 0===l||null===(t=l.Endpoints)||void 0===t?void 0:t.map((e=>{let{Name:t,Address:a}=e;return{label:t,value:a}})),r=[];null!==l&&void 0!==l&&null!==(a=l.Tenants)&&void 0!==a&&a.length&&r.push({label:"Database",value:l.Tenants[0]}),r.push({label:"Version",value:null===l||void 0===l?void 0:l.Version},{label:"Uptime",value:null===l||void 0===l?void 0:l.Uptime},{label:"DC",value:(null===l||void 0===l?void 0:l.DataCenterDescription)||(null===l||void 0===l?void 0:l.DC)},{label:"Rack",value:null===l||void 0===l?void 0:l.Rack});const o=null===l||void 0===l||null===(s=l.LoadAveragePercents)||void 0===s?void 0:s.map(((e,t)=>({label:N.x5[t],value:(0,m.jsx)(f.y,{value:e,percents:!0,colorizeProgress:!0,capacity:100})})));return(0,m.jsx)("div",{className:"".concat(w()," ").concat(i),children:l?(0,m.jsxs)("div",{className:w("common-info"),children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:w("section-title"),children:"Pools"}),(0,m.jsx)("div",{className:w("section",{pools:!0}),children:null===l||void 0===l||null===(n=l.PoolStats)||void 0===n?void 0:n.map(((e,t)=>(0,m.jsx)(I,{data:e},t)))})]}),d&&d.length&&(0,m.jsx)(j._,{title:"Endpoints",className:w("section"),info:d}),(0,m.jsx)(j._,{title:"Common info",className:w("section"),info:r}),(0,m.jsx)(j._,{title:"Load average",className:w("section",{average:!0}),info:o})]}):(0,m.jsx)("div",{className:"error",children:"no data"})})};var T=a(62776),S=a(54665),P=a(79061),z=a(71698),V=a(17096),A=a(82994),C=a(42635),q=a(92398),E=a(92820),R=a(85198),L=a.n(R),F=a(36313),_=a(34301),U=a(3764);const O=(0,F.P1)((e=>e),(e=>z.N.endpoints.getNodeStructure.select({nodeId:e}))),Z=(0,F.P1)((e=>e),((e,t)=>O(t)),((e,t)=>t(e).data)),G=(0,F.P1)(((e,t)=>Number(t)),((e,t)=>Z(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,s={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var n;const l=null===(n=a.VDisks)||void 0===n?void 0:n.filter((t=>t.NodeId===e)).map(U.w);null===l||void 0===l||l.forEach((a=>{const n=(0,_.a2)(a.VDiskId),l=(0,U.b)(a.PDisk),i=l.PDiskId;s[String(i)]||(s[String(i)]={vDisks:{},...l}),s[String(i)].vDisks[n]={...a,PDiskId:i,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(s).reduce(((e,t)=>{const a=s[t].vDisks,n=Object.keys(a).reduce(((e,t,s)=>(e.push({...a[t],id:t,order:s}),e)),[]);return e[t]={...s[t],vDisks:n},e}),{})}));var J=a(67585),H=a(19812),M=a(17176),B=a(68330),K=a(33569),Q=a(8659),Y=a(22200),$=a(75850),W=a(17632),X=a(5922),ee=a(30817);const te=JSON.parse('{"pdisk.developer-ui-button-title":"PDisk Developer UI page","vdisk.developer-ui-button-title":"VDisk Developer UI page"}'),ae=JSON.parse('{"pdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 PDisk \u0432 Developer UI","vdisk.developer-ui-button-title":"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 VDisk \u0432 Developer UI"}'),se=(0,ee.wZ)("ydb-node-page",{en:te,ru:ae}),ne=(0,u.cn)("kv-node-structure");function le(e){let{label:t,value:a,className:s}=e;return(0,m.jsxs)("span",{className:ne("pdisk-title-item",s),children:[t&&(0,m.jsxs)("span",{className:ne("pdisk-title-item-label"),children:[t,":"]}),(0,m.jsx)("span",{className:ne("pdisk-title-item-value"),children:a})]})}const ie=(0,u.cn)("kv-node-structure");var de;!function(e){e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info"}(de||(de={}));const re={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function oe(e){let{pDiskId:t,selectedVdiskId:a,nodeId:s}=e;return[{name:de.slotId,header:re[de.slotId],width:100,render:e=>{let{row:n}=e;const l=n.VDiskSlotId;let i=null;return(0,X.D)(s)&&(0,X.D)(t)&&(0,X.D)(l)&&(i=(0,v.yf)({nodeId:s,pDiskId:t,vDiskSlotId:l})),(0,m.jsxs)("div",{className:ie("vdisk-id",{selected:n.id===a}),children:[(0,m.jsx)("span",{children:l}),i&&(0,m.jsx)(M.z,{size:"s",className:ie("external-button",{hidden:!0}),href:i,target:"_blank",title:se("vdisk.developer-ui-button-title"),children:(0,m.jsx)(c.J,{data:o.Z})})]})},align:H.ZP.LEFT},{name:de.VDiskState,header:re[de.VDiskState],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(p.A,{status:t.VDiskState===W.H.OK?$.K.Green:$.K.Red})},sortAccessor:e=>e.VDiskState===W.H.OK?1:0,align:H.ZP.CENTER},{name:de.Size,header:re[de.Size],width:100,render:e=>{let{row:t}=e;return(0,m.jsx)(f.y,{value:t.AllocatedSize,capacity:Number(t.AllocatedSize)+Number(t.AvailableSize),formatValues:_.q3,colorizeProgress:!0})},sortAccessor:e=>Number(e.AllocatedSize),align:H.ZP.CENTER},{name:de.Info,header:re[de.Info],width:70,render:e=>{let{row:t}=e;return(0,m.jsx)(B.J,{placement:["right"],content:(0,m.jsx)(Y.K,{data:t,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:ie("vdisk-details"),children:(0,m.jsx)(M.z,{view:"flat-secondary",className:ie("vdisk-details-button",{selected:t.id===a}),children:(0,m.jsx)(c.J,{data:J.Z,size:18})})})},sortable:!1}]}function ce(e){let{id:t,data:a,selectedVdiskId:n,nodeId:l,unfolded:i}=e;const[d,r]=s.useState(null!==i&&void 0!==i&&i),{TotalSize:o=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:h,vDisks:g}=a,b=Number(o),x=Number(c);return(0,m.jsxs)("div",{className:ie("pdisk"),id:t,children:[(0,m.jsxs)("div",{className:ie("pdisk-header"),children:[(0,m.jsxs)("div",{className:ie("pdisk-title-wrapper"),children:[(0,m.jsx)(p.A,{status:u}),(0,m.jsx)(le,{label:"PDiskID",value:v,className:ie("pdisk-title-id")}),(0,m.jsx)(le,{value:h,className:ie("pdisk-title-type")}),(0,m.jsx)(f.y,{value:b-x,capacity:b,formatValues:_.q3,colorizeProgress:!0,className:ie("pdisk-title-size")}),(0,m.jsx)(le,{label:"VDisks",value:g.length})]}),(0,m.jsx)(M.z,{onClick:d?()=>{r(!1)}:()=>{r(!0)},view:"flat-secondary",children:(0,m.jsx)(K.F,{direction:d?"top":"bottom"})})]}),d&&(L()(a)?(0,m.jsx)("div",{children:"No information about PDisk"}):(0,m.jsxs)("div",{children:[(0,m.jsx)(Q.P,{pDisk:a,nodeId:l,className:ie("pdisk-details"),withPDiskPageLink:!0}),(0,m.jsxs)("div",{className:ie("vdisks-container"),children:[(0,m.jsx)("div",{className:ie("vdisks-header"),children:"VDisks"}),(0,m.jsx)(H.ZP,{theme:"yandex-cloud",data:g,columns:oe({nodeId:l,pDiskId:v,selectedVdiskId:n}),settings:{...N.LE,dynamicRender:!1},rowClassName:e=>e.id===n?ie("selected-vdisk"):""})]})]}))]})}const ue=(0,u.cn)("kv-node-structure");function ve(e){let{type:t,id:a}=e;return"".concat(t,"-").concat(a)}const pe=function(e){let{nodeId:t,className:a}=e;const n=(0,V.ix)((e=>G(e,t))),[l]=(0,V.Rj)(),{currentData:i,isFetching:d,error:r}=z.N.useGetNodeStructureQuery({nodeId:t},{pollingInterval:l}),o=d&&void 0===i,{pdiskId:c,vdiskId:u}=E.parse(window.location.href,!0).query,v=s.useRef(null),p=s.useRef(!1);return s.useEffect((()=>{if(!L()(n)&&!p.current&&v.current){const t=document.getElementById(ve({type:"pdisk",id:c}));let a=0;if(u){var e;const t=null===(e=n[c])||void 0===e?void 0:e.vDisks,s=null===t||void 0===t?void 0:t.find((e=>e.id===u)),l=s?document.querySelector(".data-table"):void 0,i=(null===s||void 0===s?void 0:s.order)||0;l&&(a+=l.offsetTop+40*i)}t&&(v.current.scrollTo({behavior:"smooth",top:a||t.offsetTop}),p.current=!0)}}),[n,c,u]),(0,m.jsxs)("div",{className:ue(),ref:v,children:[r?(0,m.jsx)(x.V,{error:r,className:ue("error")}):null,(0,m.jsx)("div",{className:a,children:o?(0,m.jsx)(T.a,{size:"m"}):r&&!i?null:(()=>{const e=Object.keys(n);return e.length>0?e.map((e=>(0,m.jsx)(ce,{data:n[e],id:ve({type:"pdisk",id:e}),unfolded:c===e,selectedVdiskId:u,nodeId:t},e))):"There is no information about node structure."})()})]})},he=(0,u.cn)("node"),me="Storage";function ge(e){var t,a;const o=s.useRef(null),c=(0,V.zL)(),u=(0,i.TH)(),v=null!==(t=(0,i.$B)(S.ZP.node))&&void 0!==t?t:Object.create(null),{id:p,activeTab:h}=v.params,{tenantName:g}=(0,S.mB)(u),[N]=(0,V.Rj)(),{currentData:j,isFetching:y,error:k}=z.N.useGetNodeInfoQuery({nodeId:p},{pollingInterval:N}),I=y&&void 0===j,f=j,{activeTabVerified:w,nodeTabs:E}=s.useMemo((()=>{var e;const t=((null===f||void 0===f||null===(e=f.Roles)||void 0===e?void 0:e.find((e=>e===me)))?q.ZJ:q.ZJ.filter((e=>e.id!==q.P_))).map((e=>({...e,title:e.name})));let a=t.find((e=>{let{id:t}=e;return t===h}));return a||(a=t[0]),{activeTabVerified:a,nodeTabs:t}}),[h,f]),R=(null===f||void 0===f||null===(a=f.Tenants)||void 0===a?void 0:a[0])||(null===g||void 0===g?void 0:g.toString());let L;if(f){var F;const e=!(null!==f&&void 0!==f&&null!==(F=f.Tenants)&&void 0!==F&&F[0]);L=e?"Storage":"Compute"}s.useEffect((()=>{c((0,P.J)("node",{tenantName:R,nodeRole:L,nodeId:p}))}),[c,R,p,L]);const _=()=>{switch(w.id){case q.P_:return(0,m.jsx)("div",{className:he("storage"),children:(0,m.jsx)(A.V,{nodeId:p,parentContainer:o.current})});case q.IA:return(0,m.jsx)(C.J,{nodeId:p,database:R,className:he("node-page-wrapper")});case q.mD:return(0,m.jsx)(D,{node:f,className:he("overview-wrapper")});case q.pV:return(0,m.jsx)(pe,{className:he("node-page-wrapper"),nodeId:p});default:return!1}};return I?(0,m.jsx)(T.a,{size:"l"}):f?(0,m.jsxs)("div",{className:he(null,e.className),ref:o,children:[(0,m.jsx)(l.ql,{titleTemplate:"%s \u2014 ".concat(f.Host," \u2014 YDB Monitoring"),defaultTitle:"".concat(f.Host," \u2014 YDB Monitoring"),children:(0,m.jsx)("title",{children:w.title})}),(0,m.jsx)(b,{node:f,additionalNodesProps:e.additionalNodesProps,className:he("header")}),k?(0,m.jsx)(x.V,{error:k,className:he("error")}):null,(0,m.jsxs)("div",{className:he("tabs"),children:[(0,m.jsx)(n.m,{size:"l",items:E,activeTab:w.id,wrapTo:(e,t)=>{let{id:a}=e;return(0,m.jsx)(d.rU,{to:(0,S.ax)(S.ZP.node,{id:p,activeTab:a},{tenantName:R}),className:he("tab"),children:t},a)},allowNotSelected:!0}),(0,m.jsx)(r.q,{})]}),(0,m.jsx)("div",{className:he("content"),children:_()})]}):k?(0,m.jsx)(x.V,{error:k}):(0,m.jsx)("div",{className:"error",children:"no node data"})}},42635:(e,t,a)=>{a.d(t,{J:()=>O});var s=a(66950),n=a(10288),l=a(88776),i=a(17095),d=a(65070),r=a(41919),o=a(69214),c=a(26688),u=a(74170),v=a(2098),p=a(22692),h=a(97482),m=a(54665),g=a(14146),b=a(76386),x=a(36313),N=a(85690),j=a.n(N),y=a(905),k=a(99337);const I=y.h.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,t)=>{let{signal:a}=t;try{return{data:await window.api.getTabletsInfo(e,{signal:a})}}catch(s){return{error:s}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),f=(0,x.P1)((e=>e),(e=>I.endpoints.getTabletsInfo.select(e)),{argsMemoize:x.PP,argsMemoizeOptions:{equalityCheck:j()}}),w=(0,x.P1)((e=>e),((e,t)=>f(t)),((e,t)=>t(e).data)),D=(0,x.P1)(((e,t)=>w(e,t)),(e=>(0,k.d)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{const a=void 0===e.NodeId?void 0:t.get(e.NodeId);return{...e,fqdn:a}})):e.TabletStateInfo:[]));var T=a(28164),S=a(24362),P=a(52317),z=a(34301),V=a(48169),A=a(17096),C=a(92398),q=a(30817);const E=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet"}'),R=(0,q.wZ)("ydb-tablets",{en:E});var L=a(75859);const F=(0,S.cn)("tablets");function _(e){let{database:t}=e;return[{name:"Type",get header(){return R("Type")},render:e=>{let{row:t}=e;const a=!1===t.Leader;return(0,L.jsxs)("span",{children:[t.Type," ",a?(0,L.jsx)(n.x,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return R("Tablet")},render:e=>{var a;let{row:s}=e;if(!s.TabletId)return P.jX;const n=(0,m.fK)(s.TabletId,{nodeId:s.NodeId,type:s.Type,tenantName:t});return(0,L.jsx)(o.A,{name:null===(a=s.TabletId)||void 0===a?void 0:a.toString(),path:n,hasClipboardButton:!0,showStatus:!1,additionalControls:(0,L.jsx)(r.Q,{href:(0,V.wz)(s.TabletId)})})}},{name:"State",get header(){return R("State")},render:e=>{let{row:t}=e;return(0,L.jsx)(h.f,{state:t.State})}},{name:"NodeId",get header(){return R("Node ID")},render:e=>{let{row:t}=e;const a=void 0===t.NodeId?void 0:(0,C.a3)(t.NodeId);return(0,L.jsx)(u.h,{to:a,children:t.NodeId})},align:"right"},{name:"fqdn",get header(){return R("Node FQDN")},render:e=>{let{row:t}=e;return t.fqdn?(0,L.jsx)(o.A,{name:t.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,L.jsx)("span",{children:"\u2014"})}},{name:"Generation",get header(){return R("Generation")},align:"right"},{name:"Uptime",get header(){return R("Uptime")},render:e=>{let{row:t}=e;return(0,z.fG)(t.ChangeTime)},sortAccessor:e=>-Number(e.ChangeTime),align:"right"},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:e=>{let{row:t}=e;return(0,L.jsx)(U,{...t})}}]}function U(e){const t=e.State===T.g.Stopped,a=(0,A.ix)(g.VH),[n]=b._.useKillTabletMutation(),i=e.TabletId;return i?(0,L.jsx)(d.U,{buttonView:"outlined",dialogHeader:R("dialog.kill-header"),dialogText:R("dialog.kill-text"),onConfirmAction:()=>n({id:i}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:R("controls.kill-not-allowed"),popoverDisabled:a,children:(0,L.jsx)(l.J,{data:s.Z})}):null}function O(e){let{nodeId:t,path:a,database:s,className:n}=e;const[l]=(0,A.Rj)();let d={};const r=void 0===t?void 0:String(t);void 0!==r?d={nodeId:r,database:s}:a&&(d={path:a,database:s});const{currentData:o,isFetching:u,error:h}=I.useGetTabletsInfoQuery(0===Object.keys(d).length?i.CN:d,{pollingInterval:l}),m=u&&void 0===o,g=(0,A.ix)((e=>D(e,d)));return m?(0,L.jsx)(p.h,{}):(0,L.jsxs)("div",{className:F(null,n),children:[h?(0,L.jsx)(c.V,{error:h}):null,o?(0,L.jsx)(v.G,{columns:_({database:s}),data:g,settings:P.LE,emptyDataMessage:R("noTabletsData")}):null]})}},71698:(e,t,a)=>{a.d(t,{N:()=>i});var s=a(905),n=a(51688);const l=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,n.Ns)(a)},i=s.h.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{const e=await window.api.getNodeInfo(a,{signal:s});return{data:l(e)}}catch(n){return{error:n}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async(e,t)=>{let{nodeId:a}=e,{signal:s}=t;try{return{data:await window.api.getStorageInfo({nodeId:a},{signal:s})}}catch(n){return{error:n}}},providesTags:["All"]})}),overrideExisting:"throw"})},76386:(e,t,a)=>{a.d(t,{_:()=>n});var s=a(51688);const n=a(905).h.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async(e,t)=>{let{id:a,database:n,nodeId:l}=e,{signal:i}=t;try{const[e,t,d]=await Promise.all([window.api.getTablet({id:a,database:n,nodeId:l},{signal:i}),window.api.getTabletHistory({id:a,database:n,nodeId:l},{signal:i}),window.api.getNodesList({signal:i})]),r=(0,s.dn)(d),o=Object.keys(t).reduce(((e,a)=>{var s;const n=null===(s=t[a])||void 0===s?void 0:s.TabletStateInfo;if(n&&n.length){const t=n.find((e=>e.Leader))||n[0],{ChangeTime:s,Generation:l,State:i,Leader:d,FollowerId:o}=t,c=r&&a?r.get(Number(a)):void 0;"Dead"!==i&&e.push({nodeId:a,generation:l,changeTime:s,state:i,leader:d,followerId:o,fqdn:c})}return e}),[]),{TabletStateInfo:c=[]}=e,[u={}]=c,{TabletId:v}=u;return{data:{id:v,data:u,history:o}}}catch(d){return{error:d}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async(e,t)=>{let{tenantId:a}=e,{signal:s}=t;try{const e=await window.api.getTabletDescribe(a,{signal:s}),{SchemeShard:t,PathId:n}=a;return{data:(null===e||void 0===e?void 0:e.Path)||"".concat(t,":").concat(n)}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async(e,t)=>{let{id:a,hiveId:s}=e,{signal:n}=t;try{return{data:await window.api.getTabletFromHive({id:a,hiveId:s},{signal:n})}}catch(l){return{error:l}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async e=>{let{id:t}=e;try{return{data:await window.api.killTablet(t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.stopTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async e=>{let{id:t,hiveId:a}=e;try{return{data:await window.api.resumeTablet(t,a)}}catch(s){return{error:s}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},66950:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(68963);const n=e=>s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.501 6.501 0 0 0-6.445 5.649.75.75 0 1 0 1.488.194A5.001 5.001 0 0 1 11.57 4.5h-1.32a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 .75-.75v-3a.75.75 0 0 0-1.5 0v1.06A6.48 6.48 0 0 0 8 1.5Zm-5.25 13a.75.75 0 0 1-.75-.75v-3a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H4.43a5.001 5.001 0 0 0 8.528-2.843.75.75 0 1 1 1.487.194A6.501 6.501 0 0 1 3.5 12.691v1.059a.75.75 0 0 1-.75.75Z",clipRule:"evenodd"}))}}]);