"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[7512],{89516:(e,i,s)=>{s.d(i,{a:()=>a});var t=s(99294),d=s(73287),o=s(10161);const n=(0,t.cn)("ydb-entity-page-title");function a(e){let{entityName:i,status:s,id:t,className:a}=e;return(0,o.jsxs)("div",{className:n(null,a),children:[(0,o.jsx)("span",{className:n("prefix"),children:i}),(0,o.jsx)(d.J,{className:n("icon"),status:s,size:"s"}),t]})}},21711:(e,i,s)=>{s.d(i,{b:()=>c});var t=s(34706),d=s(5194),o=s(99294),n=s(83658),a=s(10161);const l=(0,o.cn)("ydb-info-viewer-skeleton"),r=()=>(0,a.jsxs)("div",{className:l("label"),children:[(0,a.jsx)(d.O,{className:l("label__text")}),(0,a.jsx)("div",{className:l("label__dots")})]}),c=e=>{let{rows:i=8,className:s,delay:o=600}=e;const[c]=(0,n.$)(o);let v=(0,a.jsxs)(t.Fragment,{children:[(0,a.jsx)(r,{}),(0,a.jsx)(d.O,{className:l("value")})]});return c||(v=null),(0,a.jsx)("div",{className:l(null,s),children:[...new Array(i)].map(((e,i)=>(0,a.jsx)("div",{className:l("row"),children:v},`skeleton-row-${i}`)))})}},22136:(e,i,s)=>{s.d(i,{B:()=>u});var t=s(41577),d=s(99294),o=s(74003),n=s(5194),a=s(83658),l=s(10161);const r=e=>{let{delay:i=600,className:s}=e;const[t]=(0,a.$)(i);return t?(0,l.jsx)(n.O,{className:s}):null},c=(0,d.cn)("ydb-page-meta");function v(e){let{items:i,loading:s}=e;return(0,l.jsx)("div",{className:c("info"),children:s?(0,l.jsx)(r,{className:c("skeleton")}):i.filter((e=>Boolean(e))).join("\xa0\xa0\xb7\xa0\xa0")})}function u(e){let{className:i,...s}=e;return(0,l.jsxs)(t.k,{gap:1,alignItems:"center",justifyContent:"space-between",className:c(null,i),children:[(0,l.jsx)(v,{...s}),(0,l.jsx)(o.q,{})]})}},49038:(e,i,s)=>{s.r(i),s.d(i,{VDiskPage:()=>C});var t=s(34706);const d=e=>t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),t.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.28 4.78a.75.75 0 0 0 0-1.06l-2.5-2.5a.75.75 0 1 0-1.06 1.06L6.94 3.5H1.75a.75.75 0 1 0 0 1.5h5.19L5.72 6.22a.75.75 0 1 0 1.06 1.06l2.5-2.5Zm-.06 3.94-2.5 2.5a.75.75 0 0 0 0 1.06l2.5 2.5a.75.75 0 1 0 1.06-1.06L9.06 12.5h5.19a.75.75 0 0 0 0-1.5H9.06l1.22-1.22a.75.75 0 1 0-1.06-1.06ZM14 4.25a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0ZM3.75 13.5a1.75 1.75 0 1 0 0-3.5 1.75 1.75 0 0 0 0 3.5Z",clipRule:"evenodd"}));var o=s(14561),n=s(64485),a=s(42152),l=s(99495),r=s(55982),c=s(89516),v=s(15327),u=s(21711),D=s(22136),k=s(49263),p=s(78759),g=s(65e3),m=s(39202),I=s(85709),x=s(53458),N=s(84953),f=s(96183);const h=p.h.injectEndpoints({endpoints:e=>({getVDiskData:e.query({queryFn:async(e,i)=>{let{nodeId:s,pDiskId:t,vDiskSlotId:d}=e,{signal:o}=i;try{const e=function(e){var i,s,t,d,o,n,a;let[l,r,c]=e;const v=null===(i=l.VDiskStateInfo)||void 0===i?void 0:i[0],u=(0,N.w)(v),D=null===(s=r.PDiskStateInfo)||void 0===s?void 0:s[0],k=(0,N.b)(D),p=null===(t=c.SystemStateInfo)||void 0===t?void 0:t[0],g=(0,f.Ns)(p),m=null!==(d=null!==(o=u.NodeId)&&void 0!==o?o:k.NodeId)&&void 0!==d?d:g.NodeId,I=g.Host,x=null===(n=g.Roles)||void 0===n?void 0:n[0],h=g.DC,j=null!==(a=u.PDiskId)&&void 0!==a?a:k.PDiskId,y=k.Type;return{...u,NodeId:m,NodeHost:I,NodeType:x,NodeDC:h,PDiskId:j,PDiskType:y}}(await Promise.all([window.api.getVDiskInfo({nodeId:s,pDiskId:t,vDiskSlotId:d},{signal:o}),window.api.getNodeWhiteboardPDiskInfo({nodeId:s,pDiskId:t},{signal:o}),window.api.getNodeInfo(s,{signal:o})]));return{data:e}}catch(n){return{error:n}}},providesTags:(e,i,s)=>["All",{type:"VDiskData",id:(0,x.FR)(s.nodeId,s.pDiskId,s.vDiskSlotId)}]})}),overrideExisting:"throw"});var j=s(25665),y=s(99294),w=s(55842),b=s(35120),S=s(37711);const V=JSON.parse('{"fqdn":"FQDN","node":"Node","pdisk":"PDisk","vdisk":"VDisk","storage":"Storage","evict-vdisk-button":"Evict VDisk","force-evict-vdisk-button":"Evict anyway","evict-vdisk-dialog-header":"Evict VDisk","evict-vdisk-dialog-text":"VDisk will be evicted. Do you want to proceed?","evict-vdisk-not-allowed":"You don\'t have enough rights to evict VDisk"}'),$=(0,S.wZ)("ydb-vDisk-page",{en:V});var P=s(10161);const T=(0,y.cn)("ydb-vdisk-page");function C(){const e=(0,w.zL)(),i=(0,w.ix)(g.VH),s=(0,m.X_)(),[{nodeId:N,pDiskId:f,vDiskSlotId:y}]=(0,l.useQueryParams)({nodeId:l.StringParam,pDiskId:l.StringParam,vDiskSlotId:l.StringParam});t.useEffect((()=>{e((0,I.J)("vDisk",{nodeId:N,pDiskId:f,vDiskSlotId:y}))}),[e,N,f,y]);const[S]=(0,w.Rj)(),V=(0,j.D)(N)&&(0,j.D)(f)&&(0,j.D)(y)?{nodeId:N,pDiskId:f,vDiskSlotId:y}:n.CN,{currentData:C={},isFetching:R,error:_}=h.useGetVDiskDataQuery(V,{pollingInterval:S}),E=R&&void 0===C,{NodeHost:F,NodeId:B,NodeType:H,NodeDC:q,PDiskId:O,PDiskType:G,Severity:M,VDiskId:Z}=C,{GroupID:A,GroupGeneration:J,Ring:L,Domain:Q,VDisk:Y}=Z||{},z=(0,j.D)(A)&&(0,j.D)(J)&&(0,j.D)(L)&&(0,j.D)(Q)&&(0,j.D)(Y),K=async e=>{if(z)return window.api[s?"evictVDisk":"evictVDiskOld"]({groupId:A,groupGeneration:J,failRealmIdx:L,failDomainIdx:Q,vDiskIdx:Y,force:e}).then((e=>{if(!1===(null===e||void 0===e?void 0:e.result)){throw{statusText:e.error,retryPossible:e.forceRetryPossible}}}))},U=()=>{e(p.h.util.invalidateTags([{type:"VDiskData",id:(0,x.FR)(N||0,f||0,y||0)},"StorageData"]))};return(0,P.jsxs)("div",{className:T(null),children:[(()=>{const e=y?`${$("vdisk")} ${y}`:$("vdisk"),i=f?`${$("pdisk")} ${f}`:$("pdisk"),s=F||$("node");return(0,P.jsx)(a.ql,{titleTemplate:`%s - ${e} - ${i} \u2014 ${s} \u2014 YDB Monitoring`,defaultTitle:`${e} - ${i} \u2014 ${s} \u2014 YDB Monitoring`})})(),(()=>{const e=F?`${$("fqdn")}: ${F}`:void 0,i=B?`${$("node")}: ${B}`:void 0,s=B?`${$("pdisk")}: ${O}`:void 0;return(0,P.jsx)(D.B,{className:T("meta"),loading:E,items:[e,i,H,q,s,G]})})(),(0,P.jsx)(c.a,{className:T("title"),entityName:$("vdisk"),status:(0,x.b2)(M),id:null===C||void 0===C?void 0:C.StringifiedId}),(0,P.jsx)("div",{className:T("controls"),children:(0,P.jsxs)(r.U,{onConfirmAction:K,onConfirmActionSuccess:U,buttonDisabled:!z||!i,buttonView:"normal",dialogHeader:$("evict-vdisk-dialog-header"),dialogText:$("evict-vdisk-dialog-text"),retryButtonText:$("force-evict-vdisk-button"),withPopover:!0,popoverContent:$("evict-vdisk-not-allowed"),popoverDisabled:i,children:[(0,P.jsx)(o.J,{data:d}),$("evict-vdisk-button")]})}),E?(0,P.jsx)(u.b,{rows:20}):(0,P.jsxs)(t.Fragment,{children:[_?(0,P.jsx)(v.V,{error:_}):null,(0,P.jsx)(k.K,{data:C,className:T("info")}),(0,j.D)(A)&&(0,j.D)(N)?(0,P.jsxs)(t.Fragment,{children:[(0,P.jsx)("div",{className:T("storage-title"),children:$("storage")}),(0,P.jsx)(b.V,{groupId:A,nodeId:N,pDiskId:null!==f&&void 0!==f?f:void 0,vDiskSlotId:null!==y&&void 0!==y?y:void 0})]}):null]})]})}}}]);