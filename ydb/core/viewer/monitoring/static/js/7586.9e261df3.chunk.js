"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[7586],{50422:(e,s,r)=>{r.d(s,{q:()=>p});var a=r(84317),t=r(17176),o=r(2418),n=r(905),i=r(24362),l=r(17096),d=r(30817);const c=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),u=(0,d.wZ)("ydb-diagnostics-autorefresh-control",{en:c});var m=r(75859);const v=(0,i.cn)("auto-refresh-control");function p(e){let{className:s}=e;const r=(0,l.zL)(),[i,d]=(0,l.Rj)();return(0,m.jsxs)("div",{className:v(null,s),children:[(0,m.jsx)(t.z,{view:"flat",onClick:()=>{r(n.h.util.invalidateTags(["All"]))},extraProps:{"aria-label":u("Refresh")},children:(0,m.jsx)(t.z.Icon,{children:(0,m.jsx)(a.Z,{})})}),(0,m.jsxs)(o.P,{value:[String(i)],onUpdate:e=>{d(Number(e))},width:85,children:[(0,m.jsx)(o.P.Option,{value:"0",children:u("None")}),(0,m.jsx)(o.P.Option,{value:"15000",children:u("15 sec")}),(0,m.jsx)(o.P.Option,{value:"60000",children:u("1 min")}),(0,m.jsx)(o.P.Option,{value:"120000",children:u("2 min")}),(0,m.jsx)(o.P.Option,{value:"300000",children:u("5 min")})]})]})}},99683:(e,s,r)=>{r.d(s,{l:()=>i});var a=r(68330),t=r(24362),o=r(75859);const n=(0,t.cn)("ydb-cell-with-popover");function i(e){let{children:s,className:r,wrapperClassName:t,...i}=e;return(0,o.jsx)("div",{className:n(null,t),children:(0,o.jsx)(a.J,{className:n("popover",r),...i,children:s})})}},90861:(e,s,r)=>{r.d(s,{m:()=>u});var a=r(27320),t=r(17176),o=r(11050),n=r(81434),i=r(24362),l=r(75859);const d=(0,i.cn)("clipboard-button");function c(e){let{className:s,status:r,title:n,...i}=e;return(0,l.jsx)(a.u,{content:"success"===r?"Copied!":n||"Copy",placement:"bottom-start",children:(0,l.jsx)(t.z,{...i,className:d(null,s),children:(0,l.jsx)(t.z.Icon,{children:(0,l.jsx)(o.K,{status:r,size:16})})})})}function u(e){let{text:s,...r}=e;return(0,l.jsx)(n.h,{text:s,timeout:1e3,children:e=>(0,l.jsx)(c,{...r,status:e})})}},1796:(e,s,r)=>{r.d(s,{p:()=>d});r(68963);var a=r(24362),t=r(52317),o=r(92666),n=r(17096),i=r(75859);const l=(0,a.cn)("storage-disk-progress-bar");function d(e){let{diskAllocatedPercent:s=-1,severity:r,compact:a,faded:d,empty:c,content:u,className:m}=e;const[v]=(0,n.yu)(t.yT),p={inverted:v,compact:a,faded:d,empty:c},h=void 0!==r&&(0,o.b2)(r);h&&(p[h.toLocaleLowerCase()]=!0);return(0,i.jsxs)("div",{className:l(p,m),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":s,children:[(()=>{if(a)return(0,i.jsx)("div",{className:l("fill-bar",p),style:{width:"100%"}});const e=v?100-s:s;return s>=0?(0,i.jsx)("div",{className:l("fill-bar",p),style:{width:"".concat(e,"%")}}):null})(),u||(!a&&s>=0?(0,i.jsx)("div",{className:l("title"),children:"".concat(Math.round(s),"%")}):null)]})}},69214:(e,s,r)=>{r.d(s,{A:()=>u});var a=r(86017),t=r(75850),o=r(24362),n=r(90861),i=r(68036),l=r(98366),d=r(75859);const c=(0,o.cn)("entity-status");function u(e){let{status:s=t.K.Grey,name:r="",label:o,path:u,iconPath:m,size:v="s",mode:p="color",showStatus:h=!0,externalLink:g=!1,withLeftTrim:N=!1,hasClipboardButton:k,clipboardButtonAlwaysVisible:D=!1,className:b,additionalControls:I}=e;const w=()=>h?(0,d.jsx)(l.J,{className:c("icon"),status:s,size:v,mode:p}):null;return(0,d.jsxs)("div",{className:c(null,b),title:r,children:[m?(S=m,(0,d.jsx)(a.r,{target:"_blank",href:S,children:w()})):w(),o&&(0,d.jsx)("span",{title:o,className:c("label",{size:v,state:s.toLowerCase()}),children:o}),(0,d.jsx)("span",{className:c("link",{"with-left-trim":N}),children:u?g?(0,d.jsx)(a.r,{className:c("name"),href:u,children:r}):(0,d.jsx)(i.h,{className:c("name"),to:u,children:r}):r&&(0,d.jsx)("span",{className:c("name"),children:r})}),k&&(0,d.jsx)(n.m,{text:r,size:"s",className:c("clipboard-button",{visible:D})}),I&&(0,d.jsx)("span",{className:c("additional-controls "),children:I})]});var S}},40073:(e,s,r)=>{r.d(s,{J:()=>h,b:()=>p});var a=r(68963),t=r(44920),o=r(75850),n=r(24362),i=r(52317),l=r(92666),d=r(55850),c=r(62206),u=r(75859);const m=(0,n.cn)("pdisk-storage-popup"),v=[o.K.Orange,o.K.Red,o.K.Yellow],p=(e,s)=>{var r;const{AvailableSize:a,TotalSize:t,State:o,PDiskId:n,NodeId:c,Path:u,Realtime:m,Type:p,Device:h}=e,g=[{label:"PDisk",value:null!==(r=(0,l.CH)(c,n))&&void 0!==r?r:i.jX},{label:"State",value:o||"not available"},{label:"Type",value:p||"unknown"}];return c&&g.push({label:"Node Id",value:c}),s&&c&&s.get(c)&&g.push({label:"Host",value:s.get(c)}),u&&g.push({label:"Path",value:u}),g.push({label:"Available",value:"".concat((0,d.Uz)(a)," of ").concat((0,d.Uz)(t))}),m&&v.includes(m)&&g.push({label:"Realtime",value:m}),h&&v.includes(h)&&g.push({label:"Device",value:h}),g},h=e=>{let{data:s,nodes:r,...o}=e;const n=a.useMemo((()=>p(s,r)),[s,r]);return(0,u.jsx)(t.G,{contentClassName:m(),placement:["top","bottom"],hasArrow:!0,offset:[0,12],...o,children:(0,u.jsx)(c._P,{title:"PDisk",info:n,size:"s"})})}},67359:(e,s,r)=>{r.d(s,{y:()=>u});var a=r(56829),t=r(24362),o=r(34301),n=r(55850),i=r(75859);const l=(0,t.cn)("progress-viewer"),d=e=>(0,o.uf)((0,o.W0)(Number(e),2)),c=(e,s)=>[d(e),d(s)];function u(e){let{value:s,capacity:r,formatValues:t=c,percents:o,className:d,size:u="xs",colorizeProgress:m,inverseColorize:v,warningThreshold:p=60,dangerThreshold:h=80}=e;const g=(0,a.F)();let N=Math.round(parseFloat(String(s))/parseFloat(String(r))*100)||0;N=N>100?100:N;let k=s,D=r,b="/";o?(k=N+"%",D="",b=""):t&&([k,D]=t(Number(s),Number(r)));let I=v?"danger":"good";m&&(N>p&&N<=h?I="warning":N>h&&(I=v?"good":"danger"),(0,n.kE)(r)||(N=100));const w={width:N+"%"};return(0,n.kE)(s)?(0,i.jsxs)("div",{className:l({size:u,theme:g,status:I},d),children:[(0,i.jsx)("div",{className:l("line"),style:w}),(0,i.jsx)("span",{className:l("text"),children:(0,n.kE)(r)?"".concat(k," ").concat(b," ").concat(D):k})]}):(0,i.jsx)("div",{className:"".concat(l({size:u})," ").concat(d," error"),children:"no data"})}},2098:(e,s,r)=>{r.d(s,{G:()=>d});var a=r(2639),t=r(19812),o=r(24362),n=r(89712),i=r(75859);const l=(0,o.cn)("ydb-resizeable-data-table");function d(e){let{columnsWidthLSKey:s,columns:r,settings:o,wrapperClassName:d,...c}=e;const[u,m]=(0,n.M)(s),v=(0,a.B)(r,u),p={...o,defaultResizeable:!0};return(0,i.jsx)("div",{className:l(null,d),children:(0,i.jsx)(t.ZP,{theme:"yandex-cloud",columns:v,onResize:m,settings:p,...c})})}},98366:(e,s,r)=>{r.d(s,{J:()=>m});var a=r(67585),t=r(57225),o=r(71586),n=r(88776),i=r(75850),l=r(24362),d=r(75859);const c=(0,l.cn)("ydb-status-icon"),u={[i.K.Blue]:a.Z,[i.K.Yellow]:t.Z,[i.K.Orange]:o.Z,[i.K.Red]:t.Z};function m(e){let{status:s=i.K.Grey,size:r="s",mode:a="color",className:t}=e;const o={state:s.toLowerCase(),size:r};return"icons"===a&&s in u?(0,d.jsx)(n.J,{className:c("status-icon",o,t),data:u[s]}):(0,d.jsx)("div",{className:c("status-color",o,t)})}},80816:(e,s,r)=>{r.d(s,{a:()=>i});var a=r(14979),t=r(24362),o=r(75859);const n=(0,t.cn)("ydb-usage-label");function i(e){let{value:s,overloadThreshold:r=90,theme:t,...i}=e;return(0,o.jsxs)(a._,{theme:t,className:n({overload:Number(s)>=r}),...i,children:[s||0,"%"]})}},79255:(e,s,r)=>{r.d(s,{c:()=>f});var a=r(34301),t=r(92666),o=r(68963),n=r(24362),i=r(75859);const l=(0,n.cn)("stack"),d=e=>{let{children:s,className:r}=e;return(0,i.jsx)("div",{className:l(null,r),children:o.Children.map(s,((e,s)=>o.isValidElement(e)?(0,i.jsx)("div",{className:l("layer"),style:{"--ydb-stack-level":s},children:e}):null))})};var c=r(92398),u=r(54665),m=r(17880),v=r(5922),p=r(1796),h=r(74170),g=r(44920),N=r(14979),k=r(75850),D=r(52317),b=r(55850),I=r(62206),w=r(40073);const S=(0,n.cn)("vdisk-storage-popup"),y=e=>{let{data:s,nodes:r,...n}=e;const l=(0,t.Iz)(s),d=o.useMemo((()=>l?(e=>{var s,r,t,o;const{VDiskId:n,VDiskState:i,SatisfactionRank:l,DiskSpace:d,FrontQueues:c,Replicated:u,UnsyncedVDisks:m,AllocatedSize:v,ReadThroughput:p,WriteThroughput:h,StoragePoolName:g}=e,N=[{label:"VDisk",value:(0,a.a2)(n)},{label:"State",value:null!==i&&void 0!==i?i:"not available"}];var D,I;return g&&N.push({label:"StoragePool",value:g}),l&&(null===(s=l.FreshRank)||void 0===s?void 0:s.Flag)!==k.K.Green&&N.push({label:"Fresh",value:null===(D=l.FreshRank)||void 0===D?void 0:D.Flag}),l&&(null===(r=l.LevelRank)||void 0===r?void 0:r.Flag)!==k.K.Green&&N.push({label:"Level",value:null===(I=l.LevelRank)||void 0===I?void 0:I.Flag}),l&&null!==(t=l.FreshRank)&&void 0!==t&&t.RankPercent&&N.push({label:"Fresh",value:l.FreshRank.RankPercent}),l&&null!==(o=l.LevelRank)&&void 0!==o&&o.RankPercent&&N.push({label:"Level",value:l.LevelRank.RankPercent}),d&&d!==k.K.Green&&N.push({label:"Space",value:d}),c&&c!==k.K.Green&&N.push({label:"FrontQueues",value:c}),u||N.push({label:"Replicated",value:"NO"}),m&&N.push({label:"UnsyncVDisks",value:m}),Number(v)&&N.push({label:"Allocated",value:(0,b.Uz)(v)}),Number(p)&&N.push({label:"Read",value:(0,b.Qt)(p)}),Number(h)&&N.push({label:"Write",value:(0,b.Qt)(h)}),N})(s):(e=>{const{NodeId:s,PDiskId:r,VSlotId:a,StoragePoolName:t}=e,o=[{label:"State",value:"not available"}];return t&&o.push({label:"StoragePool",value:t}),o.push({label:"NodeId",value:null!==s&&void 0!==s?s:D.jX},{label:"PDiskId",value:null!==r&&void 0!==r?r:D.jX},{label:"VSlotId",value:null!==a&&void 0!==a?a:D.jX}),o})(s)),[s,l]),c=o.useMemo((()=>l&&s.PDisk&&(0,w.b)(s.PDisk,r)),[s,r,l]);return(0,i.jsxs)(g.G,{contentClassName:S(),placement:["top","bottom"],hasArrow:!0,offset:[0,12],...n,children:[s.DonorMode&&(0,i.jsx)(N._,{className:S("donor-label"),children:"Donor"}),(0,i.jsx)(I._P,{title:"VDisk",info:d,size:"s"}),c&&(0,i.jsx)(I._P,{title:"PDisk",info:c,size:"s"})]})},P=(0,n.cn)("ydb-vdisk-component"),x=e=>{let{data:s={},nodes:r,compact:n,showPopup:l,onShowPopup:d,onHidePopup:g,progressBarClassName:N}=e;const k=(0,t.Iz)(s),D=(0,m.X_)(),[b,I]=o.useState(!1),w=o.useRef(null);let S;return D&&(0,v.D)(s.VDiskSlotId)&&(0,v.D)(s.PDiskId)&&(0,v.D)(s.NodeId)?S=(0,u.By)(s.VDiskSlotId,s.PDiskId,s.NodeId):(0,v.D)(s.NodeId)&&k&&(S=(0,u.ax)(u.ZP.node,{id:s.NodeId,activeTab:c.pV},{pdiskId:s.PDiskId,vdiskId:(0,a.a2)(s.VDiskId)})),(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{className:P(),ref:w,onMouseEnter:()=>{I(!0),null===d||void 0===d||d()},onMouseLeave:()=>{I(!1),null===g||void 0===g||g()},children:(0,i.jsx)(h.h,{to:S,className:P("content"),children:(0,i.jsx)(p.p,{diskAllocatedPercent:s.AllocatedPercent,severity:s.Severity,compact:n,className:N})})}),(0,i.jsx)(y,{data:s,nodes:r,anchorRef:w,open:b||l})]})};function f(e){let{data:s,className:r,stackClassName:o,...n}=e;const l=null===s||void 0===s?void 0:s.Donors,c=l&&l.length>0?(0,i.jsxs)(d,{className:o,children:[(0,i.jsx)(x,{data:s,...n}),l.map((e=>{const s=(0,t.Iz)(e);return(0,i.jsx)(x,{data:e,...n},(0,a.a2)(s?e.VDiskId:e))}))]}):(0,i.jsx)(x,{data:s,...n});return(0,i.jsx)("div",{className:r,children:c})}},17931:(e,s,r)=>{r.d(s,{l:()=>g});var a=r(68963),t=r(1796),o=r(74170),n=r(40073),i=r(79255),l=r(54665),d=r(17880),c=r(5922),u=r(24362),m=r(34301),v=r(92398),p=r(75859);const h=(0,u.cn)("pdisk-storage"),g=e=>{let{data:s={},vDisks:r,showPopup:u,onShowPopup:g,onHidePopup:N,className:k,progressBarClassName:D}=e;const[b,I]=a.useState(!1),w=(0,d.X_)(),S=a.useRef(null),{NodeId:y,PDiskId:P}=s,x=(0,c.D)(y)&&(0,c.D)(P);let f;return x&&(f=(0,l.ax)(l.ZP.node,{id:y,activeTab:v.pV},{pdiskId:P})),x&&w&&(f=(0,l.ds)(P,y)),(0,p.jsxs)(a.Fragment,{children:[(0,p.jsxs)("div",{className:h(null,k),ref:S,children:[null!==r&&void 0!==r&&r.length?(0,p.jsx)("div",{className:h("vdisks"),children:r.map((e=>(0,p.jsx)("div",{className:h("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,p.jsx)(i.c,{data:e,compact:!0,stackClassName:h("donors-stack")})},(0,m.a2)(e.VDiskId))))}):null,(0,p.jsxs)(o.h,{to:f,className:h("content"),onMouseEnter:()=>{I(!0),null===g||void 0===g||g()},onMouseLeave:()=>{I(!1),null===N||void 0===N||N()},children:[(0,p.jsx)(t.p,{diskAllocatedPercent:s.AllocatedPercent,severity:s.Severity,className:D}),(0,p.jsx)("div",{className:h("media-type"),children:s.Type})]})]}),(0,p.jsx)(n.J,{data:s,anchorRef:S,open:b||u})]})}},77382:(e,s,r)=>{r.d(s,{Ty:()=>R,AH:()=>re,k8:()=>ae,mk:()=>se});var a=r(68963),t=r(71549),o=r(19812),n=r(10502),i=r(14979),l=r(68330),d=r(88776),c=r(99683),u=r(69214),m=r(80816),v=r(79255),p=r(95829),h=r(24362),g=r(34301),N=r(15106),k=r(55850),D=r(92666),b=r(17931),I=r(75859);const w=(0,h.cn)("ydb-storage-disks");function S(e){let{vDisks:s=[],nodes:r}=e;const[t,o]=a.useState();return s.length?(0,I.jsxs)("div",{className:w(null),children:[(0,I.jsx)("div",{className:w("vdisks-wrapper"),children:null===s||void 0===s?void 0:s.map((e=>(0,I.jsx)(y,{vDisk:e,nodes:r,highlightedVDisk:t,setHighlightedVDisk:o},(0,g.a2)(e.VDiskId))))}),(0,I.jsx)("div",{className:w("pdisks-wrapper"),children:null===s||void 0===s?void 0:s.map((e=>{var s;return(0,I.jsx)(P,{vDisk:e,nodes:r,highlightedVDisk:t,setHighlightedVDisk:o},(0,D.CH)(e.NodeId,null===e||void 0===e||null===(s=e.PDisk)||void 0===s?void 0:s.PDiskId))}))})]}):null}function y(e){let{nodes:s,vDisk:r,highlightedVDisk:a,setHighlightedVDisk:t}=e;const o={...r,PDisk:void 0},n=(0,g.a2)(r.VDiskId);return(0,I.jsx)("div",{style:{flexGrow:Number(r.AllocatedSize)||1},className:w("vdisk-item"),children:(0,I.jsx)(v.c,{data:o,nodes:s,compact:!0,showPopup:a===n,onShowPopup:()=>t(n),onHidePopup:()=>t(void 0),progressBarClassName:w("vdisk-progress-bar")})})}function P(e){let{vDisk:s,highlightedVDisk:r,setHighlightedVDisk:a}=e;const t=(0,g.a2)(s.VDiskId);return s.PDisk?(0,I.jsx)(b.l,{className:w("pdisk-item"),progressBarClassName:w("pdisk-progress-bar"),data:s.PDisk,showPopup:r===t,onShowPopup:()=>a(t),onHidePopup:()=>a(void 0)}):null}var x=r(10703),f=r(43817);const j=(0,h.cn)("ydb-storage-groups-columns"),R="storageGroupsColumnsWidth",E="MediaType",z="Erasure",G="GroupId",L="Used",V="Limit",C="Usage",T="DiskSpace",M="Read",F="Write",O="VDisks",A="Disks",U="Degraded",H={name:"PoolName",header:"Pool Name",width:250,render:e=>{var s;let{row:r}=e;const a=null===(s=r.PoolName)||void 0===s?void 0:s.split("/");return a&&(0,I.jsx)(c.l,{wrapperClassName:j("pool-name-wrapper"),content:r.PoolName,placement:["right"],behavior:n.x.Immediate,children:a[a.length-1]})},align:o.ZP.LEFT},Z={name:E,header:"Type",width:100,resizeMinWidth:100,align:o.ZP.LEFT,render:e=>{let{row:s}=e;return(0,I.jsxs)(a.Fragment,{children:[(0,I.jsx)(i._,{children:s.MediaType||"\u2014"}),"\xa0",s.Encryption&&(0,I.jsx)(l.J,{content:(0,f.Z)("encrypted"),placement:"right",behavior:n.x.Immediate,children:(0,I.jsx)(i._,{children:(0,I.jsx)(d.J,{data:t.Z,size:18})})})]})},sortable:!1},K={name:z,header:"Erasure",width:100,sortAccessor:e=>e.ErasureSpecies,render:e=>{let{row:s}=e;return s.ErasureSpecies?s.ErasureSpecies:"-"},align:o.ZP.LEFT},_={name:U,header:"Degraded",width:110,resizeMinWidth:110,render:e=>{let{row:s}=e;return s.Degraded?(0,I.jsxs)(i._,{theme:(0,x._O)(s),children:["Degraded: ",s.Degraded]}):"-"},align:o.ZP.LEFT,defaultOrder:o.ZP.DESCENDING},W={name:C,header:"Usage",width:75,resizeMinWidth:75,render:e=>{let{row:s}=e;return s.Limit?(0,I.jsx)(m.a,{value:s.Usage,theme:(0,x.YC)(s.Usage)}):"-"},sortAccessor:e=>e.Limit?e.Usage:null,align:o.ZP.LEFT},J={name:G,header:"Group ID",width:130,render:e=>{let{row:s}=e;return(0,I.jsx)("span",{className:j("group-id"),children:s.GroupId})},sortAccessor:e=>Number(e.GroupId),align:o.ZP.RIGHT},Y={name:L,header:"Used",width:100,render:e=>{let{row:s}=e;return(0,k.Uz)(s.Used,!0)},align:o.ZP.RIGHT},B={name:V,header:"Limit",width:100,render:e=>{let{row:s}=e;return(0,k.Uz)(s.Limit)},align:o.ZP.RIGHT},Q={name:T,header:"Space",width:110,render:e=>{let{row:s}=e;return(0,I.jsx)(u.A,{status:s.DiskSpace})},align:o.ZP.CENTER},q={name:M,header:"Read",width:100,render:e=>{let{row:s}=e;return s.Read?(0,k.Qt)(s.Read):"-"},align:o.ZP.RIGHT},X={name:F,header:"Write",width:100,render:e=>{let{row:s}=e;return s.Write?(0,k.Qt)(s.Write):"-"},align:o.ZP.RIGHT},$=e=>({name:O,className:j("vdisks-column"),header:"VDisks",render:s=>{var r;let{row:a}=s;return(0,I.jsx)("div",{className:j("vdisks-wrapper"),children:null===(r=a.VDisks)||void 0===r?void 0:r.map((s=>(0,I.jsx)(v.c,{data:s,nodes:e,className:j("vdisks-item")},(0,g.a2)(s.VDiskId))))})},align:o.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),ee=e=>({name:A,className:j("disks-column"),header:"Disks",render:s=>{let{row:r}=s;return(0,I.jsx)(S,{vDisks:r.VDisks,nodes:e})},align:o.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),se=()=>[J,Z,K,W,Y,B].map((e=>({...e,sortable:!1}))),re=(e,s)=>{const r=null!==s&&void 0!==s&&s.useAdvancedStorage?ee():$(null===e||void 0===e?void 0:e.nodes);return[H,Z,K,_,J,W,Y,r]},ae=(e,s)=>{const r=((e,s)=>{const r=null!==s&&void 0!==s&&s.useAdvancedStorage?ee():$(null===e||void 0===e?void 0:e.nodes);return[H,Z,K,_,W,J,Y,B,Q,q,X,r]})(e,s);var a,t;return(a=r,(t=null===s||void 0===s?void 0:s.visibleEntities)===p.G.space?a.filter((e=>e.name!==U)):t===p.G.missing?a.filter((e=>e.name!==T)):a.filter((e=>e.name!==U&&e.name!==T))).map((e=>({...e,sortable:(0,N.P)(e.name)})))}},46393:(e,s,r)=>{r.d(s,{M:()=>c,V:()=>d});var a=r(68963),t=r(99337),o=r(52317),n=r(17096),i=r(77382);const l=(e,s)=>{const[r]=(0,n.yu)(o.uJ,!1),i=(0,n.ix)(t.d);return a.useMemo((()=>e({nodes:i},{useAdvancedStorage:r,visibleEntities:s})),[e,i,r,s])},d=e=>l(i.k8,e),c=()=>l(i.AH)},43817:(e,s,r)=>{r.d(s,{Z:()=>n});var a=r(30817);const t=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),o=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),n=(0,a.wZ)("ydb-storage-groups",{ru:o,en:t})},10703:(e,s,r)=>{r.d(s,{CZ:()=>m,TP:()=>v,YC:()=>u,_O:()=>c,_r:()=>N});var a=r(81413),t=r(95829),o=r(75850),n=r(99106),i=r(51688);const l=(0,n.p)(1,2,["success","warning","danger"]),d={"block-4-2":(0,n.p)(1,2,["success","warning","danger"]),"mirror-3-dc":(0,n.p)(1,3,["success","warning","danger"])},c=e=>{var s;return(void 0!==(s=e.ErasureSpecies)&&s in d?d[e.ErasureSpecies]:l)(e.Degraded)},u=(0,n.p)(80,85,["success","warning","danger"]),m=(0,n.p)(80,85,[o.K.Green,o.K.Yellow,o.K.Red]),v={sortValue:i.Hk.NodeId,sortOrder:a.zE},p={sortValue:"PoolName",sortOrder:a.zE},h={sortValue:"Degraded",sortOrder:a.hr},g={sortValue:"Usage",sortOrder:a.hr};function N(e){return e===t.G.missing?h:e===t.G.space?g:p}},95829:(e,s,r)=>{r.d(s,{G:()=>a,d:()=>t});const a={all:"all",missing:"missing",space:"space"},t={groups:"groups",nodes:"nodes"}},26491:(e,s,r)=>{r.d(s,{R:()=>t});var a=r(92092);async function t(e,s){let{version:r="v2",shouldUseGroupsHandler:t,...o}=e;if(t&&"v1"!==r){const e=await window.api.getStorageGroups({...o},s);return(0,a._u)(e)}{const e=await window.api.getStorageInfo({version:r,...o},s);return(0,a.S9)(e)}}},33058:(e,s,r)=>{r.d(s,{y:()=>n});var a=r(905),t=r(26491),o=r(92092);const n=a.h.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,s)=>{let{signal:r}=s;try{const s=await window.api.getNodes({storage:!0,type:"static",...e},{signal:r});return{data:(0,o.Y2)(s)}}catch(a){return{error:a}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,s)=>{let{signal:r}=s;try{return{data:await(0,t.R)(e,{signal:r})}}catch(a){return{error:a}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},92092:(e,s,r)=>{r.d(s,{S9:()=>h,Y2:()=>p,_u:()=>g});var a=r(21897),t=r(17632),o=r(92666),n=r(3764),i=r(51688),l=r(15106);function d(e){const{DiskSpace:s,VDisks:r=[]}=e;return s||(0,o.b2)(Math.max(...r.map((e=>(0,o.Or)(e.DiskSpace)))))}const c=(e,s)=>{var r;const a=(0,n.w)(e);return{...a,StoragePoolName:s,Donors:null===a||void 0===a||null===(r=a.Donors)||void 0===r?void 0:r.map((e=>({...e,StoragePoolName:s})))}},u=e=>{const{VDisks:s=[],PoolName:r,Usage:a=0,Read:t=0,Write:o=0,Used:n=0,Limit:i=0,Degraded:l=0,Kind:u,MediaType:m,GroupID:v}=e,p=s.map((e=>c(e,r))),h=Math.floor(100*Number(a)),g=d(e);return{...e,PoolName:r,GroupId:v,MediaType:m||u,VDisks:p,Usage:h,Read:Number(t),Write:Number(o),Used:Number(n),Limit:Number(i),Degraded:Number(l),DiskSpace:g}},m=(e,s)=>{let r=[];return e?r=e.map(u):null===s||void 0===s||s.forEach((e=>{var s;null===(s=e.Groups)||void 0===s||s.forEach((s=>{r.push(((e,s)=>{var r;let o,i=0,u=0,m=0,v=0,p=0;const{Name:h,MediaType:g}=s;if(e.VDisks)for(const l of e.VDisks){const{Replicated:e,VDiskState:s,AvailableSize:r,AllocatedSize:d,PDisk:c,ReadThroughput:h,WriteThroughput:g}=l,{Type:N,State:k,AvailableSize:D}=(0,n.b)(c);e&&k===a.w.Normal&&s===t.H.OK||(i+=1);const b=Number(null!==r&&void 0!==r?r:D)||0,I=Number(d)||0;u+=I,m+=b+I,v+=Number(h)||0,p+=Number(g)||0,o=!N||N!==o&&o?"Mixed":N}const N=null===(r=e.VDisks)||void 0===r?void 0:r.map((e=>c(e,h))),k=(0,l.I)({Used:u,Limit:m},5),D=d(e);return{...e,GroupId:e.GroupID,VDisks:N,Usage:k,Read:v,Write:p,PoolName:h,Used:u,Limit:m,Degraded:i,MediaType:g||o||void 0,DiskSpace:D}})(s,e))}))})),r},v=e=>{var s,r,t;const o=(null===(s=e.PDisks)||void 0===s?void 0:s.filter((e=>e.State!==a.w.Normal)).length)||0,l=null===(r=e.PDisks)||void 0===r?void 0:r.map((s=>({...(0,n.b)(s),NodeId:e.NodeId}))),d=null===(t=e.VDisks)||void 0===t?void 0:t.map((s=>({...(0,n.w)(s),NodeId:e.NodeId})));return{...(0,i.Ns)(e.SystemState),NodeId:e.NodeId,PDisks:l,VDisks:d,Missing:o}},p=e=>{const{Nodes:s,TotalNodes:r,FoundNodes:a}=e,t=null===s||void 0===s?void 0:s.map(v);return{nodes:t,total:Number(r)||(null===t||void 0===t?void 0:t.length),found:Number(a)}},h=e=>{const{StoragePools:s,StorageGroups:r,TotalGroups:a,FoundGroups:t}=e,o=m(r,s);return{groups:o,total:Number(a)||o.length,found:Number(t)}};function g(e){const{FoundGroups:s,TotalGroups:r,StorageGroups:a=[]}=e,t=a.map((e=>{const{Usage:s,Read:r,Write:a,Used:t,Limit:o,MissingDisks:i,VDisks:l=[]}=e,c=l.map((e=>{var s;const r=e.Whiteboard,a=null===(s=e.PDisk)||void 0===s?void 0:s.Whiteboard,t=e.NodeId,o={...r,PDiskId:null===a||void 0===a?void 0:a.PDiskId,NodeId:t,PDisk:{...a,NodeId:t}};return(0,n.w)(o)})),u=d(e);return{...e,Usage:Math.floor(Number(s))||0,Read:Number(r),Write:Number(a),Used:Number(t),Limit:Number(o),Degraded:Number(i),VDisks:c,DiskSpace:u}}));return{groups:t,total:Number(r)||t.length,found:Number(s)}}},21897:(e,s,r)=>{let a;r.d(s,{w:()=>a}),function(e){e.Initial="Initial",e.InitialFormatRead="InitialFormatRead",e.InitialFormatReadError="InitialFormatReadError",e.InitialSysLogRead="InitialSysLogRead",e.InitialSysLogReadError="InitialSysLogReadError",e.InitialSysLogParseError="InitialSysLogParseError",e.InitialCommonLogRead="InitialCommonLogRead",e.InitialCommonLogReadError="InitialCommonLogReadError",e.InitialCommonLogParseError="InitialCommonLogParseError",e.CommonLoggerInitError="CommonLoggerInitError",e.Normal="Normal",e.OpenFileError="OpenFileError",e.ChunkQuotaError="ChunkQuotaError",e.DeviceIoError="DeviceIoError",e.Missing="Missing",e.Timeout="Timeout",e.NodeDisconnected="NodeDisconnected",e.Unknown="Unknown"}(a||(a={}))},17632:(e,s,r)=>{let a;r.d(s,{H:()=>a}),function(e){e.Initial="Initial",e.LocalRecoveryError="LocalRecoveryError",e.SyncGuidRecovery="SyncGuidRecovery",e.SyncGuidRecoveryError="SyncGuidRecoveryError",e.OK="OK",e.PDiskError="PDiskError"}(a||(a={}))},48169:(e,s,r)=>{r.d(s,{ok:()=>n,wq:()=>o,wz:()=>l,yf:()=>i});var a=r(27102),t=r(55850);const o=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.y3;const r=/\/node\/\d+\/?$/g;return r.test(String(s))?String(s).replace(r,"/node/".concat(e,"/")):"".concat(null!==s&&void 0!==s?s:"","/node/").concat(e,"/")},n=e=>{let{nodeId:s,pDiskId:r,host:a}=e;const n="actors/pdisks/pdisk"+(0,t.bJ)(r);return o(s,a)+n},i=e=>{let{nodeId:s,pDiskId:r,vDiskSlotId:a,host:n}=e;const i="actors/vdisks/vdisk"+(0,t.bJ)(r)+"_"+(0,t.bJ)(a);return o(s,n)+i};function l(e,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TabletID",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.y3;const o=s?"/".concat(s):"";return"".concat(t,"/tablets").concat(o,"?").concat(r,"=").concat(e)}},77072:(e,s,r)=>{r.d(s,{i6:()=>i,mG:()=>n,mr:()=>d,oO:()=>o,s:()=>l,tH:()=>c});var a=r(21897),t=r(17632);const o={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},n=Object.entries(o).reduce(((e,s)=>{let[r,a]=s;return{...e,[a]:r}}),{}),i=o.Grey,l=n[i],d={[t.H.OK]:o.Green,[t.H.Initial]:o.Yellow,[t.H.SyncGuidRecovery]:o.Yellow,[t.H.LocalRecoveryError]:o.Red,[t.H.SyncGuidRecoveryError]:o.Red,[t.H.PDiskError]:o.Red},c={[a.w.Initial]:o.Grey,[a.w.Normal]:o.Green,[a.w.InitialFormatRead]:o.Yellow,[a.w.InitialSysLogRead]:o.Yellow,[a.w.InitialCommonLogRead]:o.Yellow,[a.w.InitialFormatReadError]:o.Red,[a.w.InitialSysLogReadError]:o.Red,[a.w.InitialSysLogParseError]:o.Red,[a.w.InitialCommonLogReadError]:o.Red,[a.w.InitialCommonLogParseError]:o.Red,[a.w.CommonLoggerInitError]:o.Red,[a.w.OpenFileError]:o.Red,[a.w.ChunkQuotaError]:o.Red,[a.w.DeviceIoError]:o.Red}},92666:(e,s,r)=>{r.d(s,{CH:()=>l,FR:()=>d,Iz:()=>o,Or:()=>i,b2:()=>n});var a=r(5922),t=r(77072);function o(e){return"VDiskId"in e}function n(e){return void 0===e?t.s:t.mG[e]||t.s}function i(e){return e?t.oO[e]:0}function l(e,s){if((0,a.D)(e)&&(0,a.D)(s))return"".concat(e,"-").concat(s)}function d(e,s,r){return[e,s,r].join("-")}},3764:(e,s,r)=>{r.d(s,{b:()=>p,w:()=>v});var a=r(75850),t=r(99106),o=r(77072);const n=(0,t.p)(85,95,[a.K.Green,a.K.Yellow,a.K.Red]);function i(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=function(e){return s=e,void 0!==s&&s in o.tH?o.tH[e]:o.i6;var s}(e.State),a=n(s);return r!==o.i6&&a?Math.max(r,o.oO[a]):r}var l=r(92666);function d(e){if(!(0,l.Iz)(e))return o.i6;const{DiskSpace:s,VDiskState:r,FrontQueues:a,Replicated:t,DonorMode:n}=e;if(!r)return o.i6;const i=c(s),d=function(e){var s;if(!e)return o.i6;return null!==(s=o.mr[e])&&void 0!==s?s:o.i6}(r),u=Math.min(o.oO.Orange,c(a));let m=Math.max(i,d,u);return t||n||m!==o.oO.Green||(m=o.oO.Blue),m}function c(e){var s;return e&&null!==(s=o.oO[e])&&void 0!==s?s:o.i6}const u={HDD:"HDD",SSD:"SSD",MVME:"NVME"};function m(e){if(!e)return;const s=function(e,s){const r={};return Object.entries(s).reduce(((s,a)=>{let[t,o]=a;const n=e.length-s,i=n-o;return r[t]=e.substring(i,n)||"0",s+o}),0),r}(BigInt(e).toString(2),{isSolidState:1,kind:55,typeExt:8});if("1"===s.isSolidState)switch(parseInt(s.typeExt,2)){case 0:return u.SSD;case 2:return u.MVME}else if("0"===s.typeExt)return u.HDD}function v(){var e,s,r,a;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=t.PDisk?p({...t.PDisk,NodeId:null!==(e=t.PDisk.NodeId)&&void 0!==e?e:t.NodeId}):void 0,n=null!==(s=t.PDiskId)&&void 0!==s?s:null===o||void 0===o?void 0:o.PDiskId,i=Number(null!==(r=t.AvailableSize)&&void 0!==r?r:null===o||void 0===o?void 0:o.AvailableSize),l=Number(t.AllocatedSize),c=l+i,u=Math.round(100*l/c),m=null===(a=t.Donors)||void 0===a?void 0:a.map((e=>v({...e,DonorMode:!0}))),h=d(t);return{...t,PDisk:o,PDiskId:n,Donors:m,Severity:h,TotalSize:c,AllocatedPercent:u}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{AvailableSize:r,TotalSize:a,Category:t}=e,o=m(t),n=Number(r),l=Number(a),d=l-n,c=Math.round(100*d/l),u=i(e,c);return{...s,...e,Type:o,Severity:u,AllocatedSize:d,AllocatedPercent:c}}},99106:(e,s,r)=>{r.d(s,{p:()=>a});const a=(e,s,r)=>a=>0<=a&&a<e?r[0]:e<=a&&a<s?r[1]:s<=a?r[2]:void 0},89712:(e,s,r)=>{r.d(s,{M:()=>n});var a=r(68963),t=r(2639),o=r(18193);const n=e=>{const s=a.useCallback((()=>e?o.r.readUserSettingsValue(e,{}):{}),[e]),r=a.useCallback((s=>{e&&o.r.setUserSettingsValue(e,s)}),[e]);return(0,t.M)({saveSizes:r,getSizes:s})}},15106:(e,s,r)=>{r.d(s,{I:()=>a,P:()=>o});const a=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const r=e.Limit?100*e.Used/e.Limit:0;return Math.floor(r/s)*s},t=["PoolName","Kind","MediaType","Erasure","Degraded","Usage","GroupId","Used","Limit","Read","Write"],o=e=>t.includes(e)}}]);