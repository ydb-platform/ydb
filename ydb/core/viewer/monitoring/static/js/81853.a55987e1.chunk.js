"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[81853],{3685:(e,t,l)=>{l.d(t,{$:()=>o});var n=l(54090),a=l(77506),s=l(33775),r=l(60712);const i=(0,a.cn)("ydb-entity-page-title");function o({entityName:e,status:t=n.m.Grey,id:l,className:a}){return(0,r.jsxs)("div",{className:i(null,a),children:[(0,r.jsx)("span",{className:i("prefix"),children:e}),(0,r.jsx)(s.k,{className:i("icon"),status:t,size:"s"}),l]})}},18677:(e,t,l)=>{l.d(t,{A:()=>a});var n=l(59284);const a=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14M6.53 5.47a.75.75 0 0 0-1.06 1.06L6.94 8 5.47 9.47a.75.75 0 1 0 1.06 1.06L8 9.06l1.47 1.47a.75.75 0 1 0 1.06-1.06L9.06 8l1.47-1.47a.75.75 0 1 0-1.06-1.06L8 6.94z",clipRule:"evenodd"}))},21545:(e,t,l)=>{l.d(t,{X:()=>a});var n=l(78034);const a=l(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:l},{signal:a})=>{try{const[s,r,i]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:l},{signal:a}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:a}),window.api.viewer.getNodesList({database:t},{signal:a})]),o=(0,n.nN)(i),d=Object.keys(r).reduce(((e,t)=>{var l;const n=null===(l=r[t])||void 0===l?void 0:l.TabletStateInfo;return null===n||void 0===n||n.forEach((l=>{var n;const{ChangeTime:a,Generation:s,State:r,Leader:i,FollowerId:d}=l,c=o&&t?null===(n=o.get(Number(t)))||void 0===n?void 0:n.Host:void 0;e.push({nodeId:t,generation:s,changeTime:a,state:r,leader:i,followerId:d,fqdn:c})})),e}),[]),{TabletStateInfo:c=[]}=s,u=void 0===l?c.find((e=>e.Leader)):c.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===l})),{TabletId:h}=u||{};return{data:{id:h,data:u,history:d}}}catch(s){return{error:s}}},providesTags:(e,t,l)=>["All",{type:"Tablet",id:l.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e,database:t},{signal:l})=>{try{const n=await window.api.viewer.getTabletDescribe(e,t,{signal:l}),{SchemeShard:a,PathId:s}=e;return{data:(null===n||void 0===n?void 0:n.Path)||`${a}:${s}`}}catch(n){return{error:n}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:l})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:l})}}catch(n){return{error:n}}},providesTags:(e,t,l)=>["All",{type:"Tablet",id:l.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,l)=>[{type:"Tablet",id:l.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(l){return{error:l}}},invalidatesTags:(e,t,l)=>[{type:"Tablet",id:l.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(l){return{error:l}}},invalidatesTags:(e,t,l)=>[{type:"Tablet",id:l.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},22983:(e,t,l)=>{l.d(t,{B:()=>d});var n=l(59284),a=l(80136),s=l(58611),r=l(55974),i=l(42829),o=l(60712);function d({children:e,onConfirmAction:t,onConfirmActionSuccess:l,dialogHeader:d,dialogText:c,retryButtonText:u,buttonDisabled:h=!1,buttonView:m="action",buttonClassName:v,withPopover:p=!1,popoverContent:b,popoverPlacement:g="right",popoverDisabled:x=!0}){const[f,w]=n.useState(!1),[y,j]=n.useState(!1),[N,I]=n.useState(!1),T=()=>(0,o.jsx)(a.$,{onClick:()=>w(!0),view:m,disabled:h,loading:!h&&y,className:v,children:e});return(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(r.g,{visible:f,header:d,text:c,withRetry:N,retryButtonText:u,onConfirm:async e=>{j(!0),await t(e)},onConfirmActionSuccess:async()=>{I(!1);try{await(null===l||void 0===l?void 0:l())}finally{j(!1)}},onConfirmActionError:e=>{I((0,i.D)(e)),j(!1)},onClose:()=>{w(!1)}}),p?(0,o.jsx)(s.A,{content:b,placement:g,disabled:x,children:(0,o.jsx)("span",{children:T()})}):T()]})}},27775:(e,t,l)=>{l.d(t,{i:()=>r});var n=l(52443),a=l(58267),s=l(60712);function r({state:e}){return(0,s.jsx)(n.J,{theme:(0,a._)(e),children:e})}},42829:(e,t,l)=>{l.d(t,{D:()=>n});const n=e=>Boolean(e&&"object"===typeof e&&"retryPossible"in e&&e.retryPossible)},48139:(e,t,l)=>{l.d(t,{S:()=>c});var n=l(60712),a=l(59284),s=l(90883),r=l(21246);function i(e){return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 17",width:"16",height:"16",fill:"currentColor",...e,children:(0,n.jsx)("path",{d:"M4 7h9v3H4z"})})}function o(e){return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 10",width:"16",height:"16",fill:"currentColor",...e,children:(0,n.jsx)("path",{d:"M.49 5.385l1.644-1.644 4.385 4.385L4.874 9.77.49 5.385zm4.384 1.096L10.356 1 12 2.644 6.519 8.126 4.874 6.48v.001z"})})}const d=(0,l(10417).om)("checkbox"),c=a.forwardRef((function(e,t){const{size:l="m",indeterminate:a,disabled:c=!1,content:u,children:h,title:m,style:v,className:p,qa:b}=e,{checked:g,inputProps:x}=(0,s.v)(e),f=u||h,w=(0,n.jsxs)("span",{className:d("indicator"),children:[(0,n.jsx)("span",{className:d("icon"),"aria-hidden":!0,children:a?(0,n.jsx)(i,{className:d("icon-svg",{type:"dash"})}):(0,n.jsx)(o,{className:d("icon-svg",{type:"tick"})})}),(0,n.jsx)("input",{...x,className:d("control")}),(0,n.jsx)("span",{className:d("outline")})]});return(0,n.jsx)(r.m,{ref:t,title:m,style:v,size:l,disabled:c,className:d({size:l,disabled:c,indeterminate:a,checked:g},p),qa:b,control:w,children:f})}))},55974:(e,t,l)=>{l.d(t,{g:()=>x});var n=l(59284),a=l(18677),s=l(71153),r=l(48139),i=l(71989),o=l(47653),d=l(56999),c=l(77506),u=l(81288),h=l(48372);const m=JSON.parse('{"default-error":"Something went wrong, action cannot be completed","no-rights-error":"You don\'t have enough rights to complete the operation","button-confirm":"Confirm","button-retry":"Retry","button-cancel":"Cancel","button-close":"Close","checkbox-text":"I understand what I\'m doing"}'),v=(0,h.g4)("ydb-critical-action-dialog",{en:m});var p=l(60712);const b=(0,c.cn)("ydb-critical-dialog"),g=e=>{if((0,u.cH)(e)){if(403===e.status)return v("no-rights-error");if("string"===typeof e.data)return e.data;if((0,u._E)(e)&&e.data)return(0,p.jsx)(d.O,{hideSeverity:!0,data:e.data});if(e.statusText)return e.statusText}return v("default-error")};function x({visible:e,header:t,text:l,withRetry:d,retryButtonText:c,withCheckBox:u,onClose:h,onConfirm:m,onConfirmActionSuccess:x,onConfirmActionError:f}){const[w,y]=n.useState(!1),[j,N]=n.useState(),[I,T]=n.useState(!1),S=async e=>(y(!0),m(e).then((()=>{x(),h()})).catch((e=>{f(e),N(e)})).finally((()=>{y(!1)})));return(0,p.jsx)(i.l,{open:e,hasCloseButton:!1,className:b(),size:"s",onClose:h,onTransitionOutComplete:()=>{N(void 0),T(!1)},children:j?(0,p.jsxs)(n.Fragment,{children:[(0,p.jsx)(i.l.Header,{caption:t}),(0,p.jsx)(i.l.Body,{className:b("body"),children:(0,p.jsxs)("div",{className:b("body-message",{error:!0}),children:[(0,p.jsx)("span",{className:b("error-icon"),children:(0,p.jsx)(a.A,{width:"24",height:"22"})}),g(j)]})}),(0,p.jsx)(i.l.Footer,{loading:!1,preset:"default",textButtonApply:d?c||v("button-retry"):void 0,textButtonCancel:v("button-close"),onClickButtonApply:()=>S(!0),onClickButtonCancel:h})]}):(0,p.jsxs)(n.Fragment,{children:[(0,p.jsx)(i.l.Header,{caption:t}),(0,p.jsxs)(i.l.Body,{className:b("body"),children:[(0,p.jsxs)("div",{className:b("body-message",{warning:!0}),children:[(0,p.jsx)("span",{className:b("warning-icon"),children:(0,p.jsx)(o.I,{data:s.A,size:24})}),l]}),u?(0,p.jsx)(r.S,{checked:I,onUpdate:T,children:v("checkbox-text")}):null]}),(0,p.jsx)(i.l.Footer,{loading:w,preset:"default",textButtonApply:v("button-confirm"),textButtonCancel:v("button-cancel"),propsButtonApply:{type:"submit",disabled:u&&!I},onClickButtonCancel:h,onClickButtonApply:()=>S()})]})})}},56999:(e,t,l)=>{l.d(t,{O:()=>y});var n=l(59284),a=l(45720),s=l(16929),r=l(71153),i=l(18677),o=l(80136),d=l(60461),c=l(78540),u=l(47653),h=l(74529),m=l(77506),v=l(41650);const p=["S_FATAL","S_ERROR","S_WARNING","S_INFO"];function b(e){return function(e){return!!e&&void 0!==p[e]}(e)?p[e]:"S_INFO"}var g=l(60712);const x=(0,m.cn)("kv-result-issues"),f=(0,m.cn)("kv-issues"),w=(0,m.cn)("kv-issue");function y({data:e,hideSeverity:t}){const[l,a]=n.useState(!1),s="string"===typeof e||null===e||void 0===e?void 0:e.issues,r=Array.isArray(s)&&s.length>0;return(0,g.jsxs)("div",{className:x(),children:[(0,g.jsxs)("div",{className:x("error-message"),children:[(()=>{let l;if("string"===typeof e)l=e;else{var a,s;const r=b(null===e||void 0===e||null===(a=e.error)||void 0===a?void 0:a.severity);l=(0,g.jsxs)(n.Fragment,{children:[t?null:(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(C,{severity:r})," "]}),(0,g.jsx)("span",{className:x("error-message-text"),children:null===e||void 0===e||null===(s=e.error)||void 0===s?void 0:s.message})]})}return l})(),r&&(0,g.jsx)(o.$,{view:"normal",onClick:()=>a(!l),children:l?"Hide details":"Show details"})]}),r&&l&&(0,g.jsx)(j,{hideSeverity:t,issues:s})]})}function j({issues:e,hideSeverity:t}){const l=null===e||void 0===e?void 0:e.reduce(((e,t)=>{var l;const n=null!==(l=t.severity)&&void 0!==l?l:10;return Math.min(e,n)}),10);return(0,g.jsx)("div",{className:f(null),children:null===e||void 0===e?void 0:e.map(((e,n)=>(0,g.jsx)(N,{hideSeverity:t,issue:e,expanded:e===l},n)))})}function N({issue:e,hideSeverity:t,level:l=0}){const[a,s]=n.useState(!0),r=b(e.severity),i=e.issues,c=Array.isArray(i)&&i.length>0,u=a?"bottom":"right";return(0,g.jsxs)("div",{className:w({leaf:!c,"has-issues":c}),children:[(0,g.jsxs)("div",{className:w("line"),children:[c&&(0,g.jsx)(o.$,{view:"flat-secondary",onClick:()=>s(!a),className:w("arrow-toggle"),children:(0,g.jsx)(d.I,{direction:u,size:16})}),t?null:(0,g.jsx)(C,{severity:r}),(0,g.jsx)(I,{issue:e}),e.issue_code?(0,g.jsxs)("span",{className:w("code"),children:["Code: ",e.issue_code]}):null]}),c&&a&&(0,g.jsx)("div",{className:w("issues"),children:(0,g.jsx)(T,{issues:i,level:l+1,expanded:a})})]})}function I({issue:e}){var t;const l=function(e){const{position:t}=e;if("object"!==typeof t||null===t||!(0,v.kf)(t.row))return"";const{row:l,column:n}=t;return(0,v.kf)(n)?`${l}:${n}`:`line ${l}`}(e),n=window.ydbEditor,a=()=>(0,g.jsxs)("span",{className:w("message"),children:[l&&(0,g.jsx)("span",{className:w("place-text"),title:"Position",children:l}),(0,g.jsx)("div",{className:w("message-text"),children:(0,g.jsx)(h.A,{value:e.message,expandLabel:"Show full message"})})]}),{row:s,column:r}=null!==(t=e.position)&&void 0!==t?t:{};if(!((0,v.kf)(s)&&n))return a();return(0,g.jsx)(c.N,{href:"#",onClick:()=>{const e={lineNumber:s,column:null!==r&&void 0!==r?r:0};n.setPosition(e),n.revealPositionInCenterIfOutsideViewport(e),n.focus()},view:"primary",draggable:!1,children:a()})}function T(e){const{issues:t,level:l,expanded:n}=e;return(0,g.jsx)("div",{className:w("list"),children:t.map(((e,t)=>(0,g.jsx)(N,{issue:e,level:l,expanded:n},t)))})}const S={S_INFO:a.A,S_WARNING:s.A,S_ERROR:r.A,S_FATAL:i.A},_=(0,m.cn)("yql-issue-severity");function C({severity:e}){const t=e.slice(2).toLowerCase();return(0,g.jsxs)("span",{className:_({severity:t}),children:[(0,g.jsx)(u.I,{className:_("icon"),data:S[e]}),(0,g.jsx)("span",{className:_("title"),children:t})]})}},58267:(e,t,l)=>{l.d(t,{P:()=>r,_:()=>i});var n=l(54090),a=l(6354);const s={[a.r.Dead]:n.m.Red,[a.r.Created]:n.m.Yellow,[a.r.ResolveStateStorage]:n.m.Yellow,[a.r.Candidate]:n.m.Yellow,[a.r.BlockBlobStorage]:n.m.Yellow,[a.r.WriteZeroEntry]:n.m.Yellow,[a.r.Restored]:n.m.Yellow,[a.r.Discover]:n.m.Yellow,[a.r.Lock]:n.m.Yellow,[a.r.Stopped]:n.m.Yellow,[a.r.ResolveLeader]:n.m.Yellow,[a.r.RebuildGraph]:n.m.Yellow,[a.r.Terminating]:n.m.Yellow,[a.r.Deleted]:n.m.Green,[a.r.Active]:n.m.Green},r=e=>{if(!e)return n.m.Grey;return t=e,Object.values(n.m).includes(t)?e:s[e];var t};function i(e){if(!e)return"unknown";switch(e){case a.r.Dead:return"danger";case a.r.Active:case a.r.Deleted:return"success";default:return"warning"}}},58389:(e,t,l)=>{l.d(t,{B:()=>u});var n=l(32752),a=l(77506),s=l(90053),r=l(70043),i=l(60712);const o=(0,a.cn)("ydb-page-meta"),d="\xa0\xa0\xb7\xa0\xa0";function c({items:e,loading:t}){return(0,i.jsx)("div",{className:o("info"),children:t?(0,i.jsx)(r.E,{className:o("skeleton")}):e.filter((e=>Boolean(e))).join(d)})}function u({className:e,...t}){return(0,i.jsxs)(n.s,{gap:1,alignItems:"center",justifyContent:"space-between",className:o(null,e),children:[(0,i.jsx)(c,{...t}),(0,i.jsx)(s.E,{})]})}},70043:(e,t,l)=>{l.d(t,{E:()=>r});var n=l(1608),a=l(66781),s=l(60712);const r=({delay:e=600,className:t})=>{const[l]=(0,a.y)(e);return l?(0,s.jsx)(n.E,{className:t}):null}},74529:(e,t,l)=>{l.d(t,{A:()=>h});var n=l(59284),a=l(78540),s=l(77506),r=l(48372);const i=JSON.parse('{"default_collapse_label":"Show less","default_expand_label":"Show more","chars_count":[" ({{count}} symbol)"," ({{count}} symbols)"," ({{count}} symbols)"," ({{count}} symbols)"]}'),o=JSON.parse('{"default_collapse_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435","default_expand_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451","chars_count":[" ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u0430)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"," ({{count}} \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)"]}'),d=(0,r.g4)("ydb-shorty-string",{ru:o,en:i});var c=l(60712);const u=(0,s.cn)("kv-shorty-string");function h({value:e="",limit:t=200,strict:l=!1,displayLength:s=!0,render:r=e=>e,onToggle:i,expandLabel:o=d("default_expand_label"),collapseLabel:h=d("default_collapse_label")}){const[m,v]=n.useState(!1),p=(m?h:o)+(s&&!m?d("chars_count",{count:e.length}):""),b=e.length>t+(l?0:p.length),g=m||!b?e:e.slice(0,t-4)+"\xa0...";return(0,c.jsxs)("div",{className:u(),children:[r(g),b?(0,c.jsx)(a.N,{className:u("toggle"),href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),v((e=>!e)),null===i||void 0===i||i()},children:p}):null]})}},76938:(e,t,l)=>{l.d(t,{A:()=>a});var n=l(59284);const a=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.5 6.5 0 1 1-6.445 7.348.75.75 0 1 1 1.487-.194A5.001 5.001 0 1 0 4.43 4.5h1.32a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 2 5.25v-3a.75.75 0 0 1 1.5 0v1.06A6.48 6.48 0 0 1 8 1.5",clipRule:"evenodd"}))},79737:(e,t,l)=>{l.d(t,{A:()=>i,X:()=>o});var n=l(59554),a=l(77506),s=l(60712);const r=(0,a.cn)("ydb-table");function i({children:e,className:t}){return(0,s.jsx)("div",{className:r("table-header-content",t),children:e})}function o({className:e,width:t,wrapperClassName:l,...a}){return(0,s.jsx)("div",{className:r(null,l),children:(0,s.jsx)(n.WE,{headerCellClassName:({column:e})=>{var t;const l=null===(t=e.columnDef.meta)||void 0===t?void 0:t.align;return r("table-header-cell",{align:l})},cellClassName:e=>{var t,l;const n=null===e||void 0===e||null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.align,a=null===e||void 0===e||null===(l=e.column.columnDef.meta)||void 0===l?void 0:l.verticalAlign;return r("table-cell",{align:n,"vertical-align":a})},className:r("table",{width:t},e),...a})})}},81342:(e,t,l)=>{l.r(t),l.d(t,{Tablet:()=>we});var n=l(59284),a=l(32752),s=l(96727),r=l(29859),i=l(66212),o=l(4980),d=l(61750),c=l(10755),u=l(80987),h=l(370),m=l(7889),v=l(3685),p=l(44508),b=l(44294),g=l(98167),x=l(58389),f=l(92459),w=l(40174),y=l(21545),j=l(54090),N=l(77506),I=l(76086),T=l(47779),S=l(12888),_=l(76938);const C=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.5 1.5a3 3 0 0 0-3 3v7a3 3 0 0 0 3 3h7a3 3 0 0 0 3-3v-7a3 3 0 0 0-3-3z",clipRule:"evenodd"})),A=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",d:"M13.756 10.164c1.665-.962 1.665-3.366 0-4.328L5.251.919C3.584-.045 1.5 1.158 1.5 3.083v9.834c0 1.925 2.084 3.128 3.751 2.164z"}));var k=l(47653),E=l(22983),D=l(6354),R=l(48372);const B=JSON.parse('{"tablet.header":"Tablet","tablet.meta-database":"Database","tablet.meta-follower":"Follower","controls.kill":"Restart","controls.stop":"Stop","controls.resume":"Resume","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.stop-not-allowed":"You don\'t have enough rights to stop tablet","controls.resume-not-allowed":"You don\'t have enough rights to resume tablet","dialog.kill-header":"Restart tablet","dialog.stop-header":"Stop tablet","dialog.resume-header":"Resume tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","dialog.stop-text":"The tablet will be stopped. Do you want to proceed?","dialog.resume-text":"The tablet will be resumed. Do you want to proceed?","emptyState":"The tablet was not found","label_tablet-history":"Tablets","label_tablet-channels":"Storage"}'),F=(0,R.g4)("ydb-tablet-page",{en:B});function O(e){return Boolean(e&&"0"!==e)}var L=l(60712);const P=({tablet:e})=>{const{TabletId:t,HiveId:l}=e,s=(0,S.X)(),[r]=y.X.useKillTabletMutation(),[i]=y.X.useStopTabletMutation(),[o]=y.X.useResumeTabletMutation();if(!t)return null;const d=O(l),c=e.State===D.r.Stopped,u=e.State!==D.r.Stopped&&e.State!==D.r.Dead,h=e.State===D.r.Stopped||e.State===D.r.Deleted;return(0,L.jsxs)(a.s,{gap:2,wrap:"nowrap",children:[(0,L.jsxs)(E.B,{dialogHeader:F("dialog.kill-header"),dialogText:F("dialog.kill-text"),onConfirmAction:()=>r({id:t}).unwrap(),buttonDisabled:c||!s,withPopover:!0,buttonView:"normal",popoverContent:F("controls.kill-not-allowed"),popoverPlacement:"bottom",popoverDisabled:s,children:[(0,L.jsx)(k.I,{data:_.A}),F("controls.kill")]}),d&&(0,L.jsxs)(n.Fragment,{children:[(0,L.jsxs)(E.B,{dialogHeader:F("dialog.stop-header"),dialogText:F("dialog.stop-text"),onConfirmAction:()=>i({id:t,hiveId:l}).unwrap(),buttonDisabled:h||!s,withPopover:!0,buttonView:"normal",popoverContent:F("controls.stop-not-allowed"),popoverPlacement:"bottom",popoverDisabled:s,children:[(0,L.jsx)(k.I,{data:C}),F("controls.stop")]}),(0,L.jsxs)(E.B,{dialogHeader:F("dialog.resume-header"),dialogText:F("dialog.resume-text"),onConfirmAction:()=>o({id:t,hiveId:l}).unwrap(),buttonDisabled:u||!s,withPopover:!0,buttonView:"normal",popoverContent:F("controls.resume-not-allowed"),popoverPlacement:"bottom",popoverDisabled:s,children:[(0,L.jsx)(k.I,{data:A}),F("controls.resume")]})]})]})};var z=l(52905),$=l(60073),H=l(25196),G=l(27775),q=l(41826),Y=l(31684),M=l(28232);const K=JSON.parse('{"field_scheme-shard":"SchemeShard","field_follower":"Follower","field_generation":"Generation","field_hive":"HiveId","field_state":"State","field_uptime":"Uptime","field_node":"Node","field_links":"Links","field_developer-ui-app":"App","field_developer-ui-counters":"Counters","field_developer-ui-executor":"Executor DB internals","field_developer-ui-state":"State Storage","title_info":"Info","title_links":"Links"}'),X=(0,R.g4)("ydb-tablet-info",{en:K}),J=(0,N.cn)("ydb-tablet-info"),Q=({tablet:e})=>{const t=(0,f.Cs)(),l=(0,S.X)(),n=(0,M.J)(),{ChangeTime:s,Generation:r,FollowerId:i,NodeId:o,HiveId:d,State:c,TenantId:{SchemeShard:u}={},TabletId:h}=e,m=O(d),v=c===D.r.Active,p=[];m&&p.push({label:X("field_hive"),value:(0,L.jsx)(z.N_,{to:t(d),className:J("link"),children:d})}),u&&p.push({label:X("field_scheme-shard"),value:(0,L.jsx)(z.N_,{to:t(u),className:J("link"),children:u})}),p.push({label:X("field_state"),value:(0,L.jsx)(G.i,{state:c})}),v&&p.push({label:X("field_uptime"),value:(0,L.jsx)(q.H,{ChangeTime:s})}),p.push({label:X("field_generation"),value:r},{label:X("field_node"),value:(0,L.jsx)(z.N_,{className:J("link"),to:(0,f.vI)({id:String(o)},{database:n}),children:o})}),i&&p.push({label:X("field_follower"),value:i});return(0,L.jsxs)(a.s,{gap:10,wrap:"nowrap",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:J("section-title"),children:X("title_info")}),(0,L.jsx)($.z_,{info:p})]}),l&&h?(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:J("section-title"),children:X("title_links")}),(0,L.jsxs)(a.s,{direction:"column",gap:3,children:[(0,L.jsx)(H.K,{title:X("field_developer-ui-app"),url:(0,Y._t)(h,"app")}),(0,L.jsx)(H.K,{title:X("field_developer-ui-counters"),url:(0,Y._t)(h,"counters")}),(0,L.jsx)(H.K,{title:X("field_developer-ui-executor"),url:(0,Y._t)(h,"executorInternals")}),(0,L.jsx)(H.K,{title:X("field_developer-ui-state"),url:(0,Y._t)(h,void 0,"SsId")})]})]}):null]})};var V=l(59554),W=l(79737),U=l(80136),Z=l(60461),ee=l(56839);const te=JSON.parse('{"label_channel-index":"Channel","label_storage-pool":"Storage Pool Name","label_group-id":"Group ID","label_generation":"From generation","label_timestamp":"Timestamp"}'),le=(0,R.g4)("ydb-tablet-storage-info",{en:te}),ne=(0,N.cn)("ydb-tablet-storage-info");function ae(e,t){const l=e.getValue(),n="function"===typeof t?t(l):l;return(0,L.jsx)("div",{className:ne("metrics-cell"),children:n})}function se({row:e,name:t,hasExpand:l}){const n=e.getCanExpand();return(0,L.jsxs)(a.s,{gap:1,alignItems:"flex-start",className:ne("name-wrapper"),children:[n&&(0,L.jsx)(U.$,{view:"flat",size:"xs",onClick:e.getToggleExpandedHandler(),children:(0,L.jsx)(U.$.Icon,{children:(0,L.jsx)(Z.I,{direction:e.getIsExpanded()?"bottom":"right",size:14})})}),(0,L.jsx)("div",{className:ne("name-content",{"no-control":l&&!n}),children:t})]})}function re({data:e}){const[t,l]=n.useState({}),a=n.useMemo((()=>function(e){var t;if(!e)return[];const{BoundChannels:l,TabletStorageInfo:n={}}=e,a=null!==(t=n.Channels)&&void 0!==t?t:[],s=[];for(const i of a){var r;const e=i.Channel,t=i.History;if(!e||!t||!t.length)continue;const n=[...t];n.reverse();const[a,...o]=n,d={...a,storagePoolName:null===l||void 0===l||null===(r=l[e])||void 0===r?void 0:r.StoragePoolName,channelIndex:e,children:o};s.push(d)}return s}(e)),[e]),s=n.useMemo((()=>a.some((e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.length}))),[a]),r=n.useMemo((()=>{return e=s,[{accessorKey:"channelIndex",header:()=>(0,L.jsx)(W.A,{children:le("label_channel-index")}),size:50,cell:ae,meta:{align:"right"}},{accessorKey:"storagePoolName",header:()=>(0,L.jsx)(W.A,{children:le("label_storage-pool")}),size:200,cell:ae},{accessorKey:"GroupID",header:()=>(0,L.jsx)(W.A,{className:e?ne("with-padding"):void 0,children:le("label_group-id")}),size:100,cell:t=>(0,L.jsx)(se,{row:t.row,name:t.getValue(),hasExpand:e})},{accessorKey:"FromGeneration",header:()=>(0,L.jsx)(W.A,{children:le("label_generation")}),size:100,cell:ae,meta:{align:"right"}},{accessorKey:"Timestamp",header:()=>(0,L.jsx)(W.A,{children:le("label_timestamp")}),size:200,cell:e=>ae(e,ee.Ey),meta:{align:"right"}}];var e}),[s]),i=(0,V.K2)({columns:r,data:a,getSubRows:e=>e.children,enableExpanding:!0,onExpandedChange:l,state:{expanded:t}});return(0,L.jsx)(W.X,{table:i})}var ie=l(4557),oe=l(10508),de=l(69832),ce=l(43615),ue=l(17594),he=l(15017);function me({tabletId:e,row:t}){var l;const n=(0,f.Cs)()(e,{followerId:t.leader||null===(l=t.followerId)||void 0===l?void 0:l.toString()}),a=`${e}${t.followerId?`.${t.followerId}`:""}`;return(0,L.jsx)(de.E,{to:n,children:a})}const ve={displayIndices:!1,highlightRows:!0},pe=({history:e,tabletId:t})=>{const l=n.useMemo((()=>(({tabletId:e})=>[{name:"Generation",align:ie.Ay.RIGHT,render:({row:e})=>e.generation},{name:"Change time",align:ie.Ay.RIGHT,sortable:!1,render:({row:e})=>(0,L.jsx)(q.H,{ChangeTime:e.changeTime}),width:120},{name:"State",sortable:!1,render:({row:e})=>(0,L.jsx)(G.i,{state:e.state})},{name:"Tablet",sortable:!1,render:({row:t})=>(0,L.jsx)(me,{row:t,tabletId:e})},{name:"Node ID",align:ie.Ay.RIGHT,sortable:!1,render:({row:e})=>(0,L.jsx)(ce.W,{id:e.nodeId})},{name:"Node FQDN",sortable:!1,width:300,render:({row:e})=>e.fqdn?(0,L.jsx)(oe.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):he.EMPTY_DATA_PLACEHOLDER}])({tabletId:t})),[t]);return(0,L.jsx)(ue.l,{columnsWidthLSKey:"tabletTableColumnsWidth",data:e,columns:l,settings:ve,initialSortOrder:{columnId:"Generation",order:ie.Ay.DESCENDING}})},be=(0,N.cn)("ydb-tablet-page"),ge={history:"history",channels:"channels"},xe=[{id:ge.history,get title(){return F("label_tablet-history")}},{id:ge.channels,get title(){return F("label_tablet-channels")},isAdvanced:!0}],fe=h.z.nativeEnum(ge).catch(ge.history);function we(){const e=(0,T.YQ)(),{id:t}=(0,c.g)(),[{database:l,clusterName:s,followerId:r}]=(0,u.useQueryParams)(f.qc),i=null===l||void 0===l?void 0:l.toString(),[h]=(0,T.Nt)(),{currentData:m,isFetching:v,error:b}=y.X.useGetTabletQuery({id:t,database:i,followerId:null!==r&&void 0!==r?r:void 0},{pollingInterval:h}),j=v&&void 0===m,{data:N={},history:S=[]}=m||{},{currentData:_}=y.X.useGetTabletDescribeQuery(N.TenantId?{tenantId:N.TenantId,database:i}:o.hT),C=N.Type;n.useEffect((()=>{e((0,w.g)("tablet",{database:i,tabletId:t,tabletType:C,databaseName:_}))}),[e,i,t,C,_]);const{Leader:A}=N,k=[];return _&&k.push(`${F("tablet.meta-database")}: ${_}`),k.push(F("tablet.header")),!1===A&&k.push(F("tablet.meta-follower").toUpperCase()),(0,L.jsxs)(a.s,{gap:5,direction:"column",className:be(),children:[(0,L.jsx)(d.mg,{children:(0,L.jsx)("title",{children:`${t} \u2014 ${F("tablet.header")} \u2014 ${_||s||I.QM}`})}),(0,L.jsx)(x.B,{items:k}),(0,L.jsxs)(g.r,{loading:j,size:"l",children:[b?(0,L.jsx)(p.o,{error:b}):null,m?(0,L.jsx)(ye,{id:t,tablet:N,history:S}):null]})]})}function ye({id:e,tablet:t,history:l}){const n=!Object.keys(t).length,{Overall:s,HiveId:r,FollowerId:i,Type:o}=t,d=`${e}${i?`.${i}`:""}`;return(0,L.jsxs)(m.q5,{title:F("emptyState"),className:be("placeholder"),isEmpty:n,children:[(0,L.jsxs)(a.s,{gap:5,direction:"column",children:[(0,L.jsx)(v.$,{entityName:o||F("tablet.header"),status:null!==s&&void 0!==s?s:j.m.Grey,id:d}),(0,L.jsx)(P,{tablet:t}),(0,L.jsx)(Q,{tablet:t})]}),(0,L.jsx)(je,{id:e,hiveId:r,history:l})]})}function je({id:e,hiveId:t,history:l}){var o;const d=(0,f.Cs)(),[{activeTab:c,...h},m]=(0,u.useQueryParams)(f.qc),v=!(0,S.X)()||!O(t);let p=fe.parse(c);return v&&null!==(o=xe.find((e=>e.id===p)))&&void 0!==o&&o.isAdvanced&&(p=ge.history),n.useEffect((()=>{c!==p&&m({activeTab:p},"replaceIn")}),[c,p,m]),(0,L.jsxs)(a.s,{gap:5,direction:"column",children:[(0,L.jsx)("div",{children:(0,L.jsx)(s.f,{value:p,children:(0,L.jsx)(r.w,{size:"l",children:xe.filter((({isAdvanced:e})=>!e||!v)).map((({id:t,title:l})=>{const n=d(e,{...h,activeTab:t});return(0,L.jsx)(i.o,{value:t,children:(0,L.jsx)(b.E,{view:"primary",as:"tab",to:n,children:l})},t)}))})})}),"history"===p?(0,L.jsx)(pe,{history:l,tabletId:e}):null,"channels"!==p||v?null:(0,L.jsx)(Ne,{id:e,hiveId:t})]})}function Ne({id:e,hiveId:t}){const[l]=(0,T.Nt)(),{currentData:n,error:a,isFetching:s}=y.X.useGetAdvancedTableInfoQuery({id:e,hiveId:t},{pollingInterval:l}),r=s&&void 0===n;return(0,L.jsxs)(g.r,{loading:r,size:"l",children:[a?(0,L.jsx)(p.o,{error:a}):null,n?(0,L.jsx)(re,{data:n}):null]})}},90053:(e,t,l)=>{l.d(t,{E:()=>v});var n=l(8873),a=l(80136),s=l(12207),r=l(21334),i=l(77506),o=l(47779),d=l(48372);const c=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),u=(0,d.g4)("ydb-diagnostics-autorefresh-control",{en:c});var h=l(60712);const m=(0,i.cn)("auto-refresh-control");function v({className:e,onManualRefresh:t}){const l=(0,o.YQ)(),[i,d]=(0,o.Nt)();return(0,h.jsxs)("div",{className:m(null,e),children:[(0,h.jsx)(a.$,{view:"flat-secondary",onClick:()=>{l(r.F.util.invalidateTags(["All"])),null===t||void 0===t||t()},"aria-label":u("Refresh"),children:(0,h.jsx)(a.$.Icon,{children:(0,h.jsx)(n.A,{})})}),(0,h.jsxs)(s.l,{value:[String(i)],onUpdate:e=>{d(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,h.jsx)(s.l.Option,{value:"0",children:u("None")}),(0,h.jsx)(s.l.Option,{value:"15000",children:u("15 sec")}),(0,h.jsx)(s.l.Option,{value:"60000",children:u("1 min")}),(0,h.jsx)(s.l.Option,{value:"120000",children:u("2 min")}),(0,h.jsx)(s.l.Option,{value:"300000",children:u("5 min")})]})]})}}}]);