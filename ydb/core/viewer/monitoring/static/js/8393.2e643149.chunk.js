"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[8393],{3685:(e,s,t)=>{t.d(s,{$:()=>d});var a=t(54090),l=t(77506),i=t(33775),n=t(60712);const o=(0,l.cn)("ydb-entity-page-title");function d({entityName:e,status:s=a.m.Grey,id:t,className:l}){return(0,n.jsxs)("div",{className:o(null,l),children:[(0,n.jsx)("span",{className:o("prefix"),children:e}),(0,n.jsx)(i.k,{className:o("icon"),status:s,size:"s"}),t]})}},13758:(e,s,t)=>{t.r(s),t.d(s,{Node:()=>ye});var a=t(59284),l=t(23871),i=t(44992),n=t(61750),o=t(10755),d=t(67087),r=t(3685),c=t(44508),u=t(87184),v=t(77506),m=t(31684),p=t(88655),h=t(12888);var f=t(18863),g=t(25196),x=t(60712);const k=(0,v.cn)("ydb-pool-usage"),j=e=>{let s="green";return e>60&&e<=80?s="yellow":e>80&&(s="red"),s},b=({data:e={}})=>{const{Threads:s,Name:t="Unknown",Usage:a=0}=e,l=a&&s,i=Math.floor(100*a),n=i>100?100:i;return(0,x.jsxs)("div",{className:k(),children:[(0,x.jsxs)("div",{className:k("info"),children:[(0,x.jsx)("div",{className:k("pool-name"),children:t}),l&&(0,x.jsxs)("div",{className:k("value"),children:[(0,x.jsxs)("div",{className:k("percents"),children:[i<1?"<1":i,"%"]}),(0,x.jsxs)("div",{className:k("threads"),children:["(\xd7",s,")"]})]})]}),(0,x.jsx)("div",{className:k("visual"),children:(0,x.jsx)("div",{className:k("usage-line",{type:j(n)}),style:{width:`${n}%`}})})]})};var N=t(15132),I=t(41826),w=t(48372);const y=JSON.parse('{"database":"Database","uptime":"Uptime","version":"Version","dc":"DC","rack":"Rack","links":"Links","la-interval-1m":"1 min","la-interval-5m":"5 min","la-interval-15m":"15 min","developer-ui":"Developer UI","no-data":"No data","title.common-info":"Common info","title.endpoints":"Endpoints","title.roles":"Roles","title.pools":"Pools","title.load-average":"Load average"}'),D=(0,w.g4)("ydb-node-info",{en:y}),S=(0,v.cn)("full-node-viewer"),z=({node:e,className:s})=>{var t,a,l,i,n;const o=function(e){const s=(0,p.E)();if((0,h.X)()){if(null!==s&&void 0!==s&&s.getNodeRef){const t=s.getNodeRef(e);return t?(0,m.Un)(t):void 0}if(null!==e&&void 0!==e&&e.NodeId){const s=(0,m.Kx)(e.NodeId);return(0,m.Un)(s)}}}(e),d=[];null!==e&&void 0!==e&&null!==(t=e.Tenants)&&void 0!==t&&t.length&&d.push({label:D("database"),value:e.Tenants[0]}),d.push({label:D("version"),value:null===e||void 0===e?void 0:e.Version},{label:D("uptime"),value:(0,x.jsx)(I.p,{StartTime:null===e||void 0===e?void 0:e.StartTime,DisconnectTime:null===e||void 0===e?void 0:e.DisconnectTime})},{label:D("dc"),value:(null===e||void 0===e?void 0:e.DataCenterDescription)||(null===e||void 0===e?void 0:e.DC)}),null!==e&&void 0!==e&&e.Rack&&d.push({label:D("rack"),value:null===e||void 0===e?void 0:e.Rack}),o&&d.push({label:D("links"),value:(0,x.jsx)(g.K,{url:o,title:D("developer-ui")})});const r=null===e||void 0===e||null===(a=e.Endpoints)||void 0===a?void 0:a.map((({Name:e,Address:s})=>({label:e,value:s}))),c=null===e||void 0===e||null===(l=e.LoadAveragePercents)||void 0===l?void 0:l.map(((e,s)=>{return{label:(t=s,[D("la-interval-1m"),D("la-interval-5m"),D("la-interval-15m")][t]),value:(0,x.jsx)(N.O,{value:e,percents:!0,colorizeProgress:!0,capacity:100})};var t}));return e?(0,x.jsx)("div",{className:S(null,s),children:(0,x.jsxs)(u.s,{wrap:!0,gap:4,children:[(0,x.jsxs)(u.s,{direction:"column",gap:2,children:[(0,x.jsx)(f.z,{title:D("title.common-info"),className:S("section"),info:d}),r&&r.length?(0,x.jsx)(f.z,{title:D("title.endpoints"),className:S("section"),info:r}):null]}),(0,x.jsxs)(u.s,{direction:"column",gap:2,children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:S("section-title"),children:D("title.pools")}),(0,x.jsx)("div",{className:S("section",{pools:!0}),children:null===e||void 0===e||null===(i=e.PoolStats)||void 0===i?void 0:i.map(((e,s)=>(0,x.jsx)(b,{data:e},s)))})]}),(0,x.jsx)(f.z,{title:D("title.load-average"),className:S("section",{average:!0}),info:c})]}),e.Roles&&e.Roles.length?(0,x.jsx)(u.s,{direction:"column",gap:2,children:(0,x.jsxs)("div",{className:S("section"),children:[(0,x.jsx)("div",{className:S("section-title"),children:D("title.roles")}),null===e||void 0===e||null===(n=e.Roles)||void 0===n?void 0:n.map((e=>(0,x.jsx)("div",{className:S("role"),children:e},e)))]})}):null]})}):(0,x.jsx)("div",{className:"error",children:D("no-data")})};var T=t(42655),E=t(44294),A=t(58389),P=t(92459),R=t(67028),C=t(40174),V=t(21334),L=t(78034);const O=e=>{var s;if(null===(s=e.SystemStateInfo)||void 0===s||!s.length)return{};const t=e.SystemStateInfo[0];return(0,L.q1)(t)},M=V.F.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async({nodeId:e},{signal:s})=>{try{const t=await window.api.viewer.getNodeInfo(e,{signal:s});return{data:O(t)}}catch(t){return{error:t}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async({nodeId:e},{signal:s})=>{try{return{data:await window.api.viewer.getStorageInfo({nodeId:e},{signal:s})}}catch(t){return{error:t}}},providesTags:["All"]})}),overrideExisting:"throw"});var F=t(90182),$=t(99936),q=t(71635),G=t(29819),U=t(905),X=t.n(U),B=t(52248),K=t(53850),Q=t(56839),_=t(27295);const W=(0,K.Mz)((e=>e),(e=>M.endpoints.getNodeStructure.select({nodeId:e}))),H=(0,K.Mz)((e=>e),((e,s)=>W(s)),((e,s)=>s(e).data)),Y=(0,K.Mz)(((e,s)=>Number(s)),((e,s)=>H(e,s)),((e,s)=>{const t=null===s||void 0===s?void 0:s.StoragePools,a={};null===t||void 0===t||t.forEach((s=>{const t=s.Groups;null===t||void 0===t||t.forEach((t=>{var l;const i=null===(l=t.VDisks)||void 0===l?void 0:l.filter((s=>s.NodeId===e)).map(_.WT);null===i||void 0===i||i.forEach((t=>{var l;const i=(0,Q.U9)(t.VDiskId),n=null===(l=t.PDisk)||void 0===l?void 0:l.PDiskId;a[String(n)]||(a[String(n)]={vDisks:{},...t.PDisk}),a[String(n)].vDisks[i]={...t,PDiskId:n,NodeId:e,StoragePoolName:s.Name}}))}))}));return Object.keys(a).reduce(((e,s)=>{const t=a[s].vDisks,l=Object.keys(t).reduce(((e,s,a)=>(e.push({...t[s],id:s,order:a}),e)),[]);return e[s]={...a[s],vDisks:l},e}),{})}));var J=t(112),Z=t(45720),ee=t(4557),se=t(84476),te=t(99991),ae=t(84375),le=t(33705),ie=t(45659),ne=t(33775),oe=t(67808),de=t(54090),re=t(67375),ce=t(7435),ue=t(76086),ve=t(29971);const me=(0,v.cn)("kv-node-structure");function pe({label:e,value:s,className:t}){return(0,x.jsxs)("span",{className:me("pdisk-title-item",t),children:[e&&(0,x.jsxs)("span",{className:me("pdisk-title-item-label"),children:[e,":"]}),(0,x.jsx)("span",{className:me("pdisk-title-item-value"),children:s})]})}const he=(0,v.cn)("kv-node-structure");var fe=function(e){return e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info",e}(fe||{});const ge={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function xe({pDiskId:e,selectedVdiskId:s,nodeId:t,withDeveloperUILink:a}){return[{name:fe.slotId,header:ge[fe.slotId],width:100,render:({row:l})=>{const i=l.VDiskSlotId;let n=null;return(0,ce.f8)(t)&&(0,ce.f8)(e)&&(0,ce.f8)(i)&&(n=(0,m.Wg)({nodeId:t,pDiskId:e,vDiskSlotId:i})),(0,x.jsxs)("div",{className:he("vdisk-id",{selected:l.id===s}),children:[(0,x.jsx)("span",{children:i}),n&&a?(0,x.jsx)(se.$,{size:"s",className:he("external-button",{hidden:!0}),href:n,target:"_blank",title:(0,ve.A)("vdisk.developer-ui-button-title"),children:(0,x.jsx)(te.I,{data:J.A})}):null]})},align:ee.Ay.LEFT},{name:fe.VDiskState,header:ge[fe.VDiskState],width:70,render:({row:e})=>(0,x.jsx)(ne.k,{status:e.VDiskState===re.W.OK?de.m.Green:de.m.Red}),sortAccessor:e=>e.VDiskState===re.W.OK?1:0,align:ee.Ay.CENTER},{name:fe.Size,header:ge[fe.Size],width:170,render:({row:e})=>(0,x.jsx)(N.O,{value:e.AllocatedSize,capacity:Number(e.AllocatedSize)+Number(e.AvailableSize),formatValues:Q.vX,colorizeProgress:!0}),sortAccessor:e=>Number(e.AllocatedSize),align:ee.Ay.CENTER},{name:fe.Info,header:ge[fe.Info],width:70,render:({row:e})=>(0,x.jsx)(ae.A,{placement:["right"],content:(0,x.jsx)(oe.E,{data:e,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:he("vdisk-details"),children:(0,x.jsx)(se.$,{view:"flat-secondary",className:he("vdisk-details-button",{selected:e.id===s}),children:(0,x.jsx)(te.I,{data:Z.A,size:18})})}),sortable:!1}]}function ke({id:e,data:s,selectedVdiskId:t,nodeId:l,unfolded:i}){const n=(0,h.X)(),[o,d]=a.useState(null!==i&&void 0!==i&&i),{TotalSize:r=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:m,vDisks:p}=s,f=Number(r),g=Number(c);return(0,x.jsxs)("div",{className:he("pdisk"),id:e,children:[(0,x.jsxs)("div",{className:he("pdisk-header"),children:[(0,x.jsxs)("div",{className:he("pdisk-title-wrapper"),children:[(0,x.jsx)(ne.k,{status:u}),(0,x.jsx)(pe,{label:"PDiskID",value:v,className:he("pdisk-title-id")}),(0,x.jsx)(pe,{value:m,className:he("pdisk-title-type")}),(0,x.jsx)(N.O,{value:f-g,capacity:f,formatValues:Q.vX,colorizeProgress:!0,className:he("pdisk-title-size")}),(0,x.jsx)(pe,{label:"VDisks",value:p.length})]}),(0,x.jsx)(se.$,{onClick:o?()=>{d(!1)}:()=>{d(!0)},view:"flat-secondary",children:(0,x.jsx)(le.I,{direction:o?"top":"bottom"})})]}),o&&(X()(s)?(0,x.jsx)("div",{children:"No information about PDisk"}):(0,x.jsxs)("div",{children:[(0,x.jsx)(ie.Q,{pDisk:s,nodeId:l,className:he("pdisk-details"),withPDiskPageLink:!0}),(0,x.jsxs)("div",{className:he("vdisks-container"),children:[(0,x.jsx)("div",{className:he("vdisks-header"),children:"VDisks"}),(0,x.jsx)(ee.Ay,{theme:"yandex-cloud",data:p,columns:xe({nodeId:l,pDiskId:v,selectedVdiskId:t,withDeveloperUILink:n}),settings:{...ue.N3,dynamicRender:!1},rowClassName:e=>e.id===t?he("selected-vdisk"):""})]})]}))]})}const je=(0,v.cn)("kv-node-structure");function be({type:e,id:s}){return`${e}-${s}`}const Ne=function({nodeId:e,className:s}){const t=(0,F.N4)((s=>Y(s,e))),[l]=(0,F.Nt)(),{currentData:i,isFetching:n,error:o}=M.useGetNodeStructureQuery({nodeId:e},{pollingInterval:l}),r=n&&void 0===i,[{pdiskId:u,vdiskId:v}]=(0,d.useQueryParams)({pdiskId:d.StringParam,vdiskId:d.StringParam}),m=a.useRef(null),p=a.useRef(!1);return a.useEffect((()=>{if(!X()(t)&&!p.current&&m.current&&u){const s=document.getElementById(be({type:"pdisk",id:u}));let a=0;if(v){var e;const s=null===(e=t[u])||void 0===e?void 0:e.vDisks,l=null===s||void 0===s?void 0:s.find((e=>e.id===v)),i=l?document.querySelector(".data-table"):void 0,n=(null===l||void 0===l?void 0:l.order)||0;i&&(a+=i.offsetTop+40*n)}s&&(m.current.scrollTo({behavior:"smooth",top:a||s.offsetTop}),p.current=!0)}}),[t,u,v]),(0,x.jsxs)("div",{className:je(),ref:m,children:[o?(0,x.jsx)(c.o,{error:o,className:je("error")}):null,(0,x.jsx)("div",{className:s,children:r?(0,x.jsx)(B.a,{size:"m"}):o&&!i?null:(()=>{const s=Object.keys(t);return s.length>0?s.map((s=>(0,x.jsx)(ke,{data:t[s],id:be({type:"pdisk",id:s}),unfolded:u===s,selectedVdiskId:v,nodeId:e},s))):"There is no information about node structure."})()})]})},Ie=(0,v.cn)("node"),we="Storage";function ye(){var e,s;const t=a.useRef(null),l=(0,F.YQ)(),n=(0,o.W5)(P.Ay.node),r=null===n||void 0===n?void 0:n.params.id,u=null===n||void 0===n?void 0:n.params.activeTab,[{database:v}]=(0,d.useQueryParams)(G.Gi),m=G.IK.parse(u),[p]=(0,F.Nt)(),h=r?{nodeId:r}:i.hT,{currentData:f,isLoading:g,error:k}=M.useGetNodeInfoQuery(h,{pollingInterval:p}),j=(0,R.Pm)(),b=(0,R.c2)(),N=g||!j,I=null===f||void 0===f||null===(e=f.Roles)||void 0===e?void 0:e.find((e=>e===we)),{activeTab:w,nodeTabs:y}=a.useMemo((()=>{var e;let s=I?G.GX:G.GX.filter((e=>"storage"!==e.id));b&&(s=s.filter((e=>"structure"!==e.id)));return{activeTab:null!==(e=s.find((({id:e})=>e===m)))&&void 0!==e?e:s[0],nodeTabs:s}}),[I,b,m]),D=(null===f||void 0===f||null===(s=f.Tenants)||void 0===s?void 0:s[0])||(null===v||void 0===v?void 0:v.toString());return a.useEffect((()=>{g||l((0,C.g)("node",{tenantName:D,nodeRole:I?"Storage":"Compute",nodeId:r}))}),[l,D,r,g,I]),(0,x.jsxs)("div",{className:Ie(null),ref:t,children:[(0,x.jsx)(De,{node:f,activeTabTitle:w.title}),(0,x.jsx)(Se,{node:f,loading:N}),(0,x.jsx)(ze,{node:f}),k?(0,x.jsx)(c.o,{error:k,className:Ie("error")}):null,(0,x.jsx)(Te,{node:f,loading:N}),r?(0,x.jsx)(Ee,{nodeId:r,tenantName:D,activeTabId:w.id,tabs:y,parentContainer:t}):null]})}function De({node:e,activeTabTitle:s}){const t=null!==e&&void 0!==e&&e.Host?e.Host:(0,ve.A)("node");return(0,x.jsx)(n.mg,{titleTemplate:`%s \u2014 ${t} \u2014 YDB Monitoring`,defaultTitle:`${t} \u2014 YDB Monitoring`,children:(0,x.jsx)("title",{children:s})})}function Se({node:e,loading:s}){const t=null!==e&&void 0!==e&&e.Host?`${(0,ve.A)("fqdn")}: ${e.Host}`:void 0,a=null!==e&&void 0!==e&&e.DC?`${(0,ve.A)("dc")}: ${e.DC}`:void 0;return(0,x.jsx)(A.B,{loading:s,items:[t,a],className:Ie("meta")})}function ze({node:e}){return(0,x.jsx)(r.$,{entityName:(0,ve.A)("node"),status:null===e||void 0===e?void 0:e.SystemState,id:null===e||void 0===e?void 0:e.NodeId,className:Ie("title")})}function Te({node:e,loading:s}){return s?(0,x.jsx)(T.y,{className:Ie("info"),rows:10}):(0,x.jsx)(z,{node:e,className:Ie("info")})}function Ee({nodeId:e,tenantName:s,activeTabId:t,tabs:i,parentContainer:n}){return(0,x.jsxs)(a.Fragment,{children:[(0,x.jsx)("div",{className:Ie("tabs"),children:(0,x.jsx)(l.t,{size:"l",items:i,activeTab:t,wrapTo:({id:t},a)=>{const l=(0,G.vI)(e,{database:s},t);return(0,x.jsx)(E.E,{to:l,children:a},t)}})}),(()=>{switch(t){case"storage":return(0,x.jsx)($.z,{nodeId:e,parentRef:n,viewContext:{nodeId:e}});case"tablets":return(0,x.jsx)(q.C,{nodeId:e,database:s});case"structure":return(0,x.jsx)(Ne,{nodeId:e});default:return!1}})()]})}},18677:(e,s,t)=>{t.d(s,{A:()=>l});var a=t(59284);const l=e=>a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14M6.53 5.47a.75.75 0 0 0-1.06 1.06L6.94 8 5.47 9.47a.75.75 0 1 0 1.06 1.06L8 9.06l1.47 1.47a.75.75 0 1 0 1.06-1.06L9.06 8l1.47-1.47a.75.75 0 1 0-1.06-1.06L8 6.94z",clipRule:"evenodd"}))},42655:(e,s,t)=>{t.d(s,{y:()=>c});var a=t(59284),l=t(89169),i=t(77506),n=t(66781),o=t(60712);const d=(0,i.cn)("ydb-info-viewer-skeleton"),r=()=>(0,o.jsxs)("div",{className:d("label"),children:[(0,o.jsx)(l.E,{className:d("label__text")}),(0,o.jsx)("div",{className:d("label__dots")})]}),c=({rows:e=8,className:s,delay:t=600})=>{const[i]=(0,n.y)(t);let c=(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(r,{}),(0,o.jsx)(l.E,{className:d("value")})]});return i||(c=null),(0,o.jsx)("div",{className:d(null,s),children:[...new Array(e)].map(((e,s)=>(0,o.jsx)("div",{className:d("row"),children:c},`skeleton-row-${s}`)))})}},45659:(e,s,t)=>{t.d(s,{Q:()=>f});var a=t(87184),l=t(92459),i=t(7435),n=t(46549),o=t(56839),d=t(31684),r=t(12888),c=t(18863),u=t(25196),v=t(15132),m=t(33775),p=t(50672),h=t(60712);function f({pDisk:e,nodeId:s,withPDiskPageLink:t,className:f}){const g=(0,r.X)(),[x,k,j,b]=function({pDisk:e,nodeId:s,withPDiskPageLink:t,isUserAllowedToMakeChanges:r}){const{PDiskId:c,Path:f,Guid:g,Category:x,Type:k,Device:j,Realtime:b,State:N,SerialNumber:I,TotalSize:w,AllocatedSize:y,StatusV2:D,NumActiveSlots:S,ExpectedSlotCount:z,LogUsedSize:T,LogTotalSize:E,SystemSize:A,SharedWithOs:P}=e||{},R=[];(0,i.f8)(x)&&R.push({label:(0,p.D)("type"),value:k}),(0,i.f8)(f)&&R.push({label:(0,p.D)("path"),value:f}),(0,i.f8)(g)&&R.push({label:(0,p.D)("guid"),value:g}),I&&R.push({label:(0,p.D)("serial-number"),value:I}),P&&R.push({label:(0,p.D)("shared-with-os"),value:(0,p.D)("yes")});const C=[];(0,i.f8)(D)&&C.push({label:(0,p.D)("drive-status"),value:D}),(0,i.f8)(N)&&C.push({label:(0,p.D)("state"),value:N}),(0,i.f8)(j)&&C.push({label:(0,p.D)("device"),value:(0,h.jsx)(m.k,{status:j})}),(0,i.f8)(b)&&C.push({label:(0,p.D)("realtime"),value:(0,h.jsx)(m.k,{status:b})});const V=[];V.push({label:(0,p.D)("space"),value:(0,h.jsx)(v.O,{value:y,capacity:w,formatValues:o.vX,colorizeProgress:!0})}),(0,i.f8)(S)&&(0,i.f8)(z)&&V.push({label:(0,p.D)("slots"),value:(0,h.jsx)(v.O,{value:S,capacity:z})}),(0,i.f8)(T)&&(0,i.f8)(E)&&V.push({label:(0,p.D)("log-size"),value:(0,h.jsx)(v.O,{value:T,capacity:E,formatValues:o.vX})}),(0,i.f8)(A)&&V.push({label:(0,p.D)("system-size"),value:(0,n.z3)({value:A})});const L=[];if((t||r)&&(0,i.f8)(c)&&(0,i.f8)(s)){const e=(0,l.Ck)(c,s),i=(0,d.ar)({nodeId:s,pDiskId:c});L.push({label:(0,p.D)("links"),value:(0,h.jsxs)(a.s,{wrap:"wrap",gap:2,children:[t&&(0,h.jsx)(u.K,{title:(0,p.D)("pdisk-page"),url:e,external:!1}),r&&(0,h.jsx)(u.K,{title:(0,p.D)("developer-ui"),url:i})]})})}return[R,C,V,L]}({pDisk:e,nodeId:s,withPDiskPageLink:t,isUserAllowedToMakeChanges:g});return(0,h.jsxs)(a.s,{className:f,gap:2,direction:"row",wrap:!0,children:[(0,h.jsxs)(a.s,{direction:"column",gap:2,width:500,children:[(0,h.jsx)(c.z,{info:x,renderEmptyState:()=>null}),(0,h.jsx)(c.z,{info:j,renderEmptyState:()=>null})]}),(0,h.jsxs)(a.s,{direction:"column",gap:2,width:500,children:[(0,h.jsx)(c.z,{info:k,renderEmptyState:()=>null}),(0,h.jsx)(c.z,{info:b,renderEmptyState:()=>null})]})]})}},58389:(e,s,t)=>{t.d(s,{B:()=>u});var a=t(87184),l=t(77506),i=t(90053),n=t(70043),o=t(60712);const d=(0,l.cn)("ydb-page-meta"),r="\xa0\xa0\xb7\xa0\xa0";function c({items:e,loading:s}){return(0,o.jsx)("div",{className:d("info"),children:s?(0,o.jsx)(n.E,{className:d("skeleton")}):e.filter((e=>Boolean(e))).join(r)})}function u({className:e,...s}){return(0,o.jsxs)(a.s,{gap:1,alignItems:"center",justifyContent:"space-between",className:d(null,e),children:[(0,o.jsx)(c,{...s}),(0,o.jsx)(i.E,{})]})}},67808:(e,s,t)=>{t.d(s,{E:()=>k});t(59284);var a=t(87184),l=t(92459),i=t(7435),n=t(77506),o=t(56839),d=t(31684),r=t(7187),c=t(12888),u=t(41650),v=t(60073),m=t(25196),p=t(15132),h=t(33775),f=t(39110),g=t(60712);const x=(0,n.cn)("ydb-vdisk-info");function k({data:e,withVDiskPageLink:s,withTitle:t,...n}){var r,x;const k=(0,c.X)(),{AllocatedSize:b,DiskSpace:N,FrontQueues:I,Guid:w,Replicated:y,VDiskState:D,VDiskSlotId:S,Kind:z,SatisfactionRank:T,AvailableSize:E,HasUnreadableBlobs:A,IncarnationGuid:P,InstanceGuid:R,StoragePoolName:C,ReadThroughput:V,WriteThroughput:L,PDiskId:O,NodeId:M}=e||{},F=[];var $,q;((0,i.f8)(S)&&F.push({label:(0,f.r)("slot-id"),value:S}),(0,i.f8)(C)&&F.push({label:(0,f.r)("pool-name"),value:C}),(0,i.f8)(D)&&F.push({label:(0,f.r)("state-status"),value:D}),Number(b)>=0&&Number(E)>=0&&F.push({label:(0,f.r)("size"),value:(0,g.jsx)(p.O,{value:b,capacity:Number(b)+Number(E),formatValues:o.vX,colorizeProgress:!0})}),(0,i.f8)(z)&&F.push({label:(0,f.r)("kind"),value:z}),(0,i.f8)(w)&&F.push({label:(0,f.r)("guid"),value:w}),(0,i.f8)(P)&&F.push({label:(0,f.r)("incarnation-guid"),value:P}),(0,i.f8)(R)&&F.push({label:(0,f.r)("instance-guid"),value:R}),(0,i.f8)(y)&&F.push({label:(0,f.r)("replication-status"),value:y?(0,f.r)("yes"):(0,f.r)("no")}),(0,i.f8)(N)&&F.push({label:(0,f.r)("space-status"),value:(0,g.jsx)(h.k,{status:N})}),(0,i.f8)(null===T||void 0===T||null===(r=T.FreshRank)||void 0===r?void 0:r.Flag))&&F.push({label:(0,f.r)("fresh-rank-satisfaction"),value:(0,g.jsx)(h.k,{status:null===T||void 0===T||null===($=T.FreshRank)||void 0===$?void 0:$.Flag})});(0,i.f8)(null===T||void 0===T||null===(x=T.LevelRank)||void 0===x?void 0:x.Flag)&&F.push({label:(0,f.r)("level-rank-satisfaction"),value:(0,g.jsx)(h.k,{status:null===T||void 0===T||null===(q=T.LevelRank)||void 0===q?void 0:q.Flag})});(0,i.f8)(I)&&F.push({label:(0,f.r)("front-queues"),value:(0,g.jsx)(h.k,{status:I})}),(0,i.f8)(A)&&F.push({label:(0,f.r)("has-unreadable-blobs"),value:A?(0,f.r)("yes"):(0,f.r)("no")}),(0,i.f8)(V)&&F.push({label:(0,f.r)("read-throughput"),value:(0,u.O4)(V)}),(0,i.f8)(L)&&F.push({label:(0,f.r)("write-throughput"),value:(0,u.O4)(L)});if((0,i.f8)(O)&&(0,i.f8)(M)&&(0,i.f8)(S)){const e=[];if(s){const s=(0,l.yX)(S,O,M);e.push((0,g.jsx)(m.K,{title:(0,f.r)("vdisk-page"),url:s,external:!1},s))}if(k){const s=(0,d.Wg)({nodeId:M,pDiskId:O,vDiskSlotId:S});e.push((0,g.jsx)(m.K,{title:(0,f.r)("developer-ui"),url:s},s))}e.length&&F.push({label:(0,f.r)("links"),value:(0,g.jsx)(a.s,{wrap:"wrap",gap:2,children:e})})}const G=e&&t?(0,g.jsx)(j,{data:e}):null;return(0,g.jsx)(v.z_,{info:F,title:G,...n})}function j({data:e}){return(0,g.jsxs)("div",{className:x("title"),children:[(0,f.r)("vdiks-title"),(0,g.jsx)(h.k,{status:(0,r.XY)(e.Severity)}),e.StringifiedId]})}},70043:(e,s,t)=>{t.d(s,{E:()=>n});var a=t(89169),l=t(66781),i=t(60712);const n=({delay:e=600,className:s})=>{const[t]=(0,l.y)(e);return t?(0,i.jsx)(a.E,{className:s}):null}},71635:(e,s,t)=>{t.d(s,{C:()=>g});var a=t(44992),l=t(53850),i=t(62060),n=t.n(i),o=t(21334),d=t(24600);const r=o.F.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,{signal:s})=>{try{return{data:await window.api.viewer.getTabletsInfo(e,{signal:s})}}catch(t){return{error:t}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),c=(0,l.Mz)((e=>e),(e=>r.endpoints.getTabletsInfo.select(e)),{argsMemoize:l.i5,argsMemoizeOptions:{equalityCheck:n()}}),u=(0,l.Mz)((e=>e),((e,s)=>c(s)),((e,s)=>s(e).data)),v=(0,l.Mz)(((e,s)=>u(e,s)),(e=>(0,d.K)(e)),((e,s)=>null!==e&&void 0!==e&&e.TabletStateInfo?s?e.TabletStateInfo.map((e=>{var t;const a=void 0===e.NodeId||null===(t=s.get(e.NodeId))||void 0===t?void 0:t.Host;return{...e,fqdn:a}})):e.TabletStateInfo:[]));var m=t(7435),p=t(90182),h=t(88616),f=t(60712);function g({nodeId:e,path:s,database:t}){const[l]=(0,p.Nt)();let i={};(0,m.f8)(e)?i={nodeId:e,database:t}:s&&(i={path:s,database:t});const{isLoading:n,error:o}=r.useGetTabletsInfoQuery(0===Object.keys(i).length?a.hT:i,{pollingInterval:l}),d=(0,p.N4)((e=>v(e,i)));return(0,f.jsx)(h.Q,{tablets:d,database:t,loading:n,error:o})}},74321:(e,s,t)=>{t.d(s,{S:()=>r});var a=t(59284),l=t(64222),i=t(46898);function n(e){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 17",width:"16",height:"16",fill:"currentColor"},e),a.createElement("path",{d:"M4 7h9v3H4z"}))}function o(e){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 10",width:"16",height:"16",fill:"currentColor"},e),a.createElement("path",{d:"M.49 5.385l1.644-1.644 4.385 4.385L4.874 9.77.49 5.385zm4.384 1.096L10.356 1 12 2.644 6.519 8.126 4.874 6.48v.001z"}))}const d=(0,t(69220).om)("checkbox"),r=a.forwardRef((function(e,s){const{size:t="m",indeterminate:r,disabled:c=!1,content:u,children:v,title:m,style:p,className:h,qa:f}=e,{checked:g,inputProps:x}=(0,l.v)(e),k=u||v,j=a.createElement("span",{className:d("indicator")},a.createElement("span",{className:d("icon"),"aria-hidden":!0},r?a.createElement(n,{className:d("icon-svg",{type:"dash"})}):a.createElement(o,{className:d("icon-svg",{type:"tick"})})),a.createElement("input",Object.assign({},x,{className:d("control")})),a.createElement("span",{className:d("outline")}));return a.createElement(i.m,{ref:s,title:m,style:p,size:t,disabled:c,className:d({size:t,disabled:c,indeterminate:r,checked:g},h),qa:f,control:j},k)}))},76938:(e,s,t)=>{t.d(s,{A:()=>l});var a=t(59284);const l=e=>a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.5 6.5 0 1 1-6.445 7.348.75.75 0 1 1 1.487-.194A5.001 5.001 0 1 0 4.43 4.5h1.32a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 2 5.25v-3a.75.75 0 0 1 1.5 0v1.06A6.48 6.48 0 0 1 8 1.5",clipRule:"evenodd"}))}}]);