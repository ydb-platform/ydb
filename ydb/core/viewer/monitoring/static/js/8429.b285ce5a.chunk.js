"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[8429],{91816:(e,s,t)=>{t.d(s,{b:()=>i});var r=t(56711),a=t(24362),n=t(75859);const l=(0,a.cn)("ydb-info-viewer-skeleton"),o=()=>(0,n.jsxs)("div",{className:l("label"),children:[(0,n.jsx)(r.O,{className:l("label__text")}),(0,n.jsx)("div",{className:l("label__dots")})]}),i=e=>{let{rows:s=8,className:t}=e;return(0,n.jsx)("div",{className:l(null,t),children:[...new Array(s)].map(((e,s)=>(0,n.jsxs)("div",{className:l("row"),children:[(0,n.jsx)(o,{}),(0,n.jsx)(r.O,{className:l("value")})]},"skeleton-row-".concat(s))))})}},63104:(e,s,t)=>{t.d(s,{Y:()=>v});var r=t(54665),a=t(24362),n=t(52317),l=t(94790),o=t(74170),i=t(42784),d=t(27506),c=t(75859);const u=(0,a.cn)("tablet"),v=e=>{var s;let{tablet:t={},tenantName:a}=e;const{TabletId:v,NodeId:m,Type:h}=t,p=null===(s=t.Overall)||void 0===s?void 0:s.toLowerCase(),x=v&&(0,r.ax)(r.ZP.tablet,{id:v},{nodeId:m,tenantName:a,type:h});return(0,c.jsx)(l.f,{className:u("wrapper"),content:(0,c.jsx)(d.Fb,{data:t,className:u("popup-content")}),children:(0,c.jsx)(o.h,{to:x,children:(0,c.jsx)(i.v,{className:u({status:p}),text:(0,n.qV)(t.Type)})})})}},94178:(e,s,t)=>{t.d(s,{V:()=>l});var r=t(24362),a=t(75859);const n=(0,r.cn)("tag"),l=e=>{let{text:s,type:t}=e;return(0,a.jsx)("div",{className:n({type:t}),children:s})}},47057:(e,s,t)=>{t.d(s,{$:()=>o});var r=t(24362),a=t(94178),n=t(75859);const l=(0,r.cn)("tags"),o=e=>{let{tags:s,tagsType:t,className:r=""}=e;return(0,n.jsx)("div",{className:l(null,r),children:s&&s.map(((e,s)=>(0,n.jsx)(a.V,{text:e,type:t},s)))})}},33091:(e,s,t)=>{t.r(s),t.d(s,{Cluster:()=>Fe});var r=t(68963),a=t(56711),n=t(8179),l=t(49352),o=t(86974),i=t(52846),d=t(50422),c=t(69214),u=t(74170),v=t(54665),m=t(77915),h=t(51688);const p=t(905).h.injectEndpoints({endpoints:e=>({getClusterNodes:e.query({queryFn:async()=>{try{const e=await window.api.getClusterNodes(),{SystemStateInfo:s=[]}=e;return{data:s.map(h.Ns)}}catch(e){return{error:e}}},providesTags:["All"]})}),overrideExisting:"throw"});var x=t(79061),j=t(24362),N=t(52317),g=t(34051),b=t(94076),y=t(30601);const T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0;const t=e.reduce(((e,s)=>(s.Version&&(e[s.Version]?e[s.Version]=e[s.Version]+1:e[s.Version]=1),e)),{});return Object.keys(t).map((r=>({title:r,version:r,color:null===s||void 0===s?void 0:s.get((0,y.H)(r)),value:t[r]/e.length*100})))};var C=t(2335),w=t(70885),f=t(19812),S=t(17176),P=t(36985),E=t(26688),k=t(56350),O=t(68242),L=t(74221),A=t(2098),V=t(11551),D=t(47101),I=t(43070),z=t(27102),G=t(80839),M=t(36313),Z=t(43680),F=t.n(Z),R=t(75850),B=t(53809);const W=(0,M.P1)((e=>e),(e=>B.Xv.endpoints.getTenantsInfo.select({clusterName:e}))),H=(0,M.P1)((e=>e),((e,s)=>W(s)),((e,s)=>{var t;return null!==(t=s(e).data)&&void 0!==t?t:[]})),U=e=>e.tenants.searchValue,_=(0,M.P1)([H,G.qz,U],((e,s,t)=>{let r=((e,s)=>s===G.pu.ALL?e:e.filter((e=>e.Overall&&e.Overall!==R.K.Green)))(e,s);return r=((e,s)=>e.filter((e=>{const t=new RegExp(F()(s),"i");return t.test(e.Name||"")||t.test(e.controlPlaneName)})))(r,t),r}));var q=t(4119),Q=t(95478),Y=t(75859);const X=(0,j.cn)("tenants"),J=e=>{let{additionalTenantsProps:s}=e;const t=(0,g.zL)(),[a]=(0,g.Rj)(),{currentData:n,isFetching:l,error:o}=B.Xv.useGetTenantsInfoQuery({clusterName:z.qw},{pollingInterval:a}),i=l&&void 0===n,d=null!==n&&void 0!==n?n:[],u=(0,g.ix)(U),v=(0,g.ix)((e=>_(e,z.qw))),m=(0,g.ix)(G.qz),h=e=>{t((0,G.M6)(e))},p=e=>{t((0,B.gI)(e))};return o?(0,Y.jsx)(E.V,{error:o}):(0,Y.jsxs)(D.l,{children:[(0,Y.jsx)(D.l.Controls,{children:(0,Y.jsxs)(r.Fragment,{children:[(0,Y.jsx)(V.o,{value:u,onChange:p,placeholder:"Database name",className:X("search")}),(0,Y.jsx)(L.T,{value:m,onChange:h}),(0,Y.jsx)(P.C,{total:d.length,current:(null===v||void 0===v?void 0:v.length)||0,label:"Databases",loading:i})]})}),(0,Y.jsx)(D.l.Table,{loading:i,children:(()=>{const e=e=>{var t,r;const a=null!==(t=e.MonitoringEndpoint)&&void 0!==t?t:e.backend;return null===s||void 0===s||null===(r=s.prepareTenantBackend)||void 0===r?void 0:r.call(s,a)},t=[{name:"Name",header:"Database",render:t=>{var r;let{row:a}=t;const n=e(a),l=Boolean(n);return(0,Y.jsx)(c.A,{externalLink:l,className:X("name"),name:a.Name||"unknown database",withLeftTrim:!0,status:a.Overall,hasClipboardButton:!0,path:(0,Q.Sj)({name:a.Name,backend:n}),additionalControls:(0,Y.jsx)("span",{className:X("monitoring-button"),children:null===s||void 0===s||null===(r=s.getMonitoringLink)||void 0===r?void 0:r.call(s,a.Name,a.Type)})})},width:440,sortable:!0,defaultOrder:f.ZP.DESCENDING},{name:"controlPlaneName",header:"Name",render:e=>{let{row:s}=e;return s.controlPlaneName},width:200,sortable:!0,defaultOrder:f.ZP.DESCENDING},{name:"Type",width:200,resizeMinWidth:150,render:e=>{let{row:s}=e;return"Serverless"!==s.Type?s.Type:(0,Y.jsxs)("div",{className:X("type"),children:[(0,Y.jsx)("span",{className:X("type-value"),children:s.Type}),(0,Y.jsx)(S.z,{className:X("type-button"),onClick:()=>p(s.sharedTenantName||""),children:"Show shared"})]})}},{name:"State",width:90,render:e=>{let{row:s}=e;return s.State?s.State.toLowerCase():"\u2014"},customStyle:()=>({textTransform:"capitalize"})},{name:"cpu",header:"CPU",width:80,render:e=>{let{row:s}=e;return s.cpu&&s.cpu>1e4?(0,q.LO)(s.cpu):"\u2014"},align:f.ZP.RIGHT,defaultOrder:f.ZP.DESCENDING},{name:"memory",header:"Memory",width:120,render:e=>{let{row:s}=e;return s.memory?(0,q.SX)(s.memory):"\u2014"},align:f.ZP.RIGHT,defaultOrder:f.ZP.DESCENDING},{name:"storage",header:"Storage",width:120,render:e=>{let{row:s}=e;return s.storage?(0,q.SX)(s.storage):"\u2014"},align:f.ZP.RIGHT,defaultOrder:f.ZP.DESCENDING},{name:"nodesCount",header:"Nodes",width:100,render:e=>{let{row:s}=e;return s.nodesCount?(0,q.uf)(s.nodesCount):"\u2014"},align:f.ZP.RIGHT,defaultOrder:f.ZP.DESCENDING},{name:"groupsCount",header:"Groups",width:100,render:e=>{let{row:s}=e;return s.groupsCount?(0,q.uf)(s.groupsCount):"\u2014"},align:f.ZP.RIGHT,defaultOrder:f.ZP.DESCENDING},{name:"PoolStats",header:"Pools",width:100,resizeMinWidth:60,sortAccessor:e=>{let{PoolStats:s=[]}=e;return s.reduce(((e,s)=>e+(s.Usage||0)),0)},defaultOrder:f.ZP.DESCENDING,align:f.ZP.LEFT,render:e=>{let{row:s}=e;return(0,Y.jsx)(O.m,{pools:s.PoolStats})}},{name:"Tablets",header:"Tablets States",sortable:!1,width:500,resizeMinWidth:500,render:s=>{let{row:t}=s;const r=e(t);return t.Tablets?(0,Y.jsx)(I.e,{path:t.Name,tablets:t.Tablets,nodeIds:t.NodeIds||[],backend:r}):"\u2014"}}];return 0===v.length&&m!==G.pu.ALL?(0,Y.jsx)(k.Q,{name:"thumbsUp",width:"200"}):(0,Y.jsx)(A.G,{columnsWidthLSKey:"databasesTableColumnsWidth",data:v,columns:t,settings:N.LE,emptyDataMessage:"No such tenants"})})()})]})};var K=t(79734),$=t(48897),ee=t(16670),se=t(40067),te=t(67359),re=t(92398);const ae=[{name:"NodeId",header:"#",width:80,resizeMinWidth:80,align:f.ZP.LEFT,render:e=>{let{row:s}=e;return s.NodeId}},{name:"Host",render:e=>{var s;let{row:t}=e;const r=t.Endpoints&&(null===(s=t.Endpoints.find((e=>"http-mon"===e.Name)))||void 0===s?void 0:s.Address),a=t.Host&&"".concat(t.Host).concat(r||"")||"unknown",n=!(0,h.TA)(t)&&t.NodeId?(0,re.a3)(t.NodeId):void 0;return(0,Y.jsx)(c.A,{name:a,path:n,hasClipboardButton:!0,showStatus:!1})},width:400,align:f.ZP.LEFT},{name:"Endpoints",sortable:!1,render:e=>{let{row:s}=e;return s.Endpoints?s.Endpoints.map((e=>{let{Name:s,Address:t}=e;return"".concat(s," ").concat(t)})).join(", "):"-"},width:300,align:f.ZP.LEFT},{name:"Uptime",header:"Uptime",sortAccessor:e=>{let{StartTime:s}=e;return s&&-s},width:120,align:f.ZP.LEFT,render:e=>{let{row:s}=e;return s.Uptime}},{name:"MemoryUsed",header:"Memory used",sortAccessor:e=>{let{MemoryUsed:s=0}=e;return Number(s)},defaultOrder:f.ZP.DESCENDING,render:e=>{let{row:s}=e;return s.MemoryUsed?(0,q.td)(s.MemoryUsed):"\u2014"},width:120,align:f.ZP.RIGHT},{name:"MemoryLimit",header:"Memory limit",sortAccessor:e=>{let{MemoryLimit:s=0}=e;return Number(s)},defaultOrder:f.ZP.DESCENDING,render:e=>{let{row:s}=e;return s.MemoryLimit?(0,q.td)(s.MemoryLimit):"\u2014"},width:120,align:f.ZP.RIGHT},{name:"PoolStats",header:"Pools",sortAccessor:e=>{let{PoolStats:s=[]}=e;return s.reduce(((e,s)=>e+(s.Usage||0)),0)},defaultOrder:f.ZP.DESCENDING,width:80,resizeMinWidth:60,render:e=>{let{row:s}=e;return s.PoolStats?(0,Y.jsx)(O.m,{pools:s.PoolStats}):"\u2014"},align:f.ZP.LEFT},{name:"LoadAverage",header:"Load average",sortAccessor:e=>{let{LoadAveragePercents:s=[]}=e;return s[0]},defaultOrder:f.ZP.DESCENDING,width:140,resizeMinWidth:140,render:e=>{let{row:s}=e;return s.LoadAveragePercents&&s.LoadAveragePercents.length>0?(0,Y.jsx)(te.y,{value:s.LoadAveragePercents[0],percents:!0,capacity:100,colorizeProgress:!0}):"\u2014"},align:f.ZP.LEFT}],ne=e=>{let{nodes:s}=e;return(0,Y.jsx)(A.G,{columnsWidthLSKey:"versionsTableColumnsWidth",data:s,columns:ae,settings:N.LE})};var le=t(84893),oe=t(90861);const ie=(0,j.cn)("ydb-versions-nodes-tree-title"),de=e=>{let s,{title:t,nodes:r,items:a,versionColor:n,versionsValues:l}=e;return s=a?a.reduce(((e,s)=>s.nodes?e+s.nodes.length:e),0):r?r.length:0,(0,Y.jsxs)("div",{className:ie("overview"),children:[(0,Y.jsxs)("div",{className:ie("overview-container"),children:[n?(0,Y.jsx)("div",{className:ie("version-color"),style:{background:n}}):null,t?(0,Y.jsxs)("span",{className:ie("overview-title"),children:[t,(0,Y.jsx)(oe.m,{text:t,size:"s",className:ie("clipboard-button")})]}):null]}),(0,Y.jsxs)("div",{className:ie("overview-info"),children:[(0,Y.jsxs)("div",{children:[(0,Y.jsx)("span",{className:ie("info-value"),children:s}),(0,Y.jsx)("span",{className:ie("info-label",{margin:"left"}),children:"Nodes"})]}),l?(0,Y.jsxs)("div",{className:ie("version-progress"),children:[(0,Y.jsx)("span",{className:ie("info-label",{margin:"right"}),children:"Versions"}),(0,Y.jsx)(le.E,{size:"s",value:100,stack:l})]}):null]})]})},ce=(0,j.cn)("ydb-versions-grouped-node-tree"),ue=e=>{let{title:s,nodes:t,items:a,expanded:n=!1,versionColor:l,versionsValues:o,level:i=0}=e;const[d,c]=r.useState(!1);r.useEffect((()=>{c(n)}),[n]);const u=(0,Y.jsx)(de,{title:s,nodes:t,items:a,versionColor:l,versionsValues:o}),v=()=>{c((e=>!e))};return a?(0,Y.jsx)("div",{className:ce({"first-level":0===i}),children:(0,Y.jsx)(se.L,{name:u,collapsed:!d,hasArrow:!0,onClick:v,onArrowClick:v,children:a.map(((e,s)=>(0,Y.jsx)(ue,{title:e.title,nodes:e.nodes,expanded:n,versionColor:e.versionColor,level:i+1},s)))},s)}):(0,Y.jsx)("div",{className:ce({"first-level":0===i}),children:(0,Y.jsx)(se.L,{name:u,collapsed:!d,hasArrow:!0,onClick:v,onArrowClick:v,children:(0,Y.jsx)("div",{className:ce("dt-wrapper"),children:(0,Y.jsx)(ne,{nodes:t||[]})})},s)})};var ve=t(46754),me=t.n(ve);let he;!function(e){e.VERSION="Version",e.TENANT="Database",e.STORAGE="Storage"}(he||(he={}));const pe=(e,s)=>{var t;return(null===(t=e.title)||void 0===t?void 0:t.localeCompare(s.title||""))||-1},xe=(0,j.cn)("ydb-versions"),je=e=>{let{versionToColor:s}=e;const[t]=(0,g.Rj)(),{data:a=[],isLoading:n}=p.useGetClusterNodesQuery(void 0,{pollingInterval:t}),[l,o]=r.useState(he.VERSION),[i,d]=r.useState(!1),c=e=>{o(e)};if(n)return(0,Y.jsx)(ee.a,{});const u=((e,s,t)=>{if(e&&e.length){if(t===he.VERSION){const t=me()(e,"Version");return Object.keys(t).map((e=>{const r=t[e].filter((e=>{let{Tenants:s}=e;return Boolean(s)})),a=me()(r,"Tenants"),n=Object.keys(a).map((e=>({title:e,nodes:a[e]}))).sort(pe);return n.length?{title:e,items:n,versionColor:null===s||void 0===s?void 0:s.get((0,y.H)(e))}:null})).filter((e=>Boolean(e)))}{const t=e.filter((e=>{let{Tenants:s}=e;return Boolean(s)})),r=me()(t,"Tenants");return Object.keys(r).map((e=>{const t=T(r[e],s),a=me()(r[e],"Version"),n=Object.keys(a).map((e=>({title:e,nodes:a[e],versionColor:null===s||void 0===s?void 0:s.get((0,y.H)(e))})));return n.length?{title:e,items:n,versionsValues:t}:null})).filter((e=>Boolean(e))).sort(pe)}}})(a,s,l),v=((e,s)=>{if(!e||!e.length)return;const t=e.filter((e=>{let{Roles:s}=e;return null===s||void 0===s?void 0:s.includes("Storage")})),r=me()(t,"Version");return Object.keys(r).map((e=>({title:e,nodes:r[e],versionColor:null===s||void 0===s?void 0:s.get((0,y.H)(e))})))})(a,s),m=((e,s)=>{if(!e||!e.length)return;const t=e.filter((e=>{let{Roles:s}=e;return!s})),r=me()(t,"Version");return Object.keys(r).map((e=>({title:e,nodes:r[e],versionColor:null===s||void 0===s?void 0:s.get((0,y.H)(e))})))})(a,s),h=null!==v&&void 0!==v&&v.length?(0,Y.jsxs)(r.Fragment,{children:[(0,Y.jsx)("h3",{children:"Storage nodes"}),v.map((e=>{let{title:s,nodes:t,items:r,versionColor:a}=e;return(0,Y.jsx)(ue,{title:s,nodes:t,items:r,versionColor:a},"storage-nodes-".concat(s))}))]}):null,x=null!==u&&void 0!==u&&u.length?(0,Y.jsxs)(r.Fragment,{children:[(0,Y.jsx)("h3",{children:"Database nodes"}),(0,Y.jsxs)("div",{className:xe("controls"),children:[(0,Y.jsxs)("div",{className:xe("group"),children:[(0,Y.jsx)("span",{className:xe("label"),children:"Group by:"}),(0,Y.jsxs)(K.E,{value:l,onUpdate:c,children:[(0,Y.jsx)(K.E.Option,{value:he.TENANT,children:he.TENANT}),(0,Y.jsx)(K.E.Option,{value:he.VERSION,children:he.VERSION})]})]}),(0,Y.jsx)($.X,{className:xe("checkbox"),onChange:()=>d((e=>!e)),checked:i,children:"All expanded"})]}),u.map((e=>{let{title:s,nodes:t,items:r,versionColor:a,versionsValues:n}=e;return(0,Y.jsx)(ue,{title:s,nodes:t,items:r,expanded:i,versionColor:a,versionsValues:n},"tenant-nodes-".concat(s))}))]}):null,j=null!==m&&void 0!==m&&m.length?(0,Y.jsxs)(r.Fragment,{children:[(0,Y.jsx)("h3",{children:"Other nodes"}),m.map((e=>{let{title:s,nodes:t,items:r,versionColor:a,versionsValues:n}=e;return(0,Y.jsx)(ue,{title:s,nodes:t,items:r,versionColor:a,versionsValues:n},"other-nodes-".concat(s))}))]}):null;return(0,Y.jsxs)("div",{className:xe("versions"),children:[h,x,j]})};var Ne=t(94790),ge=t(23373),be=t(91816),ye=t(32270),Te=t(63104),Ce=t(47057),we=t(81854);const fe=(0,j.cn)("ydb-cluster-versions-bar"),Se=e=>{let{versionsValues:s=[]}=e;return(0,Y.jsxs)("div",{className:fe(),children:[(0,Y.jsx)(le.E,{value:100,stack:s,size:"s"}),(0,Y.jsx)("div",{className:fe("versions"),children:s.map(((e,t)=>(0,Y.jsx)("div",{className:fe("version-title"),style:{color:e.color},title:e.version,children:"".concat(e.version).concat(t===s.length-1?"":",")},e.version)))})]})};var Pe=t(30817);const Ee=JSON.parse('{"disk-type":"Disk Type","erasure":"Erasure","allocated":"Allocated","available":"Available","usage":"Usage","dc":"DC","tablets":"Tablets","databases":"Databases","nodes":"Nodes","load":"Load","storage-size":"Storage size","storage-groups":"Storage groups, {{diskType}}","links":"Links","versions":"Versions"}'),ke=JSON.parse('{"disk-type":"\u0422\u0438\u043f \u0434\u0438\u0441\u043a\u0430","erasure":"\u0420\u0435\u0436\u0438\u043c","allocated":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e","available":"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e","usage":"\u041f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u0435","dc":"\u0414\u0426","tablets":"\u0422\u0430\u0431\u043b\u0435\u0442\u043a\u0438","databases":"\u0411\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445","nodes":"\u0423\u0437\u043b\u044b","load":"\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430","storage-size":"\u0420\u0430\u0437\u043c\u0435\u0440 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430","storage-groups":"\u0413\u0440\u0443\u043f\u043f\u044b \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f, {{diskType}}","links":"\u0421\u0441\u044b\u043b\u043a\u0438","versions":"\u0412\u0435\u0440\u0441\u0438\u0438"}'),Oe=(0,Pe.wZ)("ydb-cluster",{ru:ke,en:Ee});var Le=t(28164);const Ae=(e,s)=>e.Type===Le.F.TxAllocator?1:s.Type===Le.F.TxAllocator?-1:0,Ve=(0,j.cn)("cluster-info"),De=e=>{let{stats:s}=e;const{diskType:t,erasure:r,allocatedSize:a,availableSize:n}=s,l=(0,we.dT)(Math.max(a,n),2),o=(0,we.td)({value:a,size:l}),i=(0,we.td)({value:n,size:l}),d=Math.round(a/(a+n)*100),c=[{label:Oe("disk-type"),value:t},{label:Oe("erasure"),value:r},{label:Oe("allocated"),value:o},{label:Oe("available"),value:i},{label:Oe("usage"),value:d+"%"}];return(0,Y.jsx)(ge.Z,{dots:!0,info:c,className:Ve("groups-stats-popup-content"),size:"s"})},Ie=e=>{let{stats:s}=e;return(0,Y.jsx)("div",{className:Ve("storage-groups-stats"),children:Object.values(s).map((e=>(0,Y.jsx)(Ne.f,{placement:["right"],content:(0,Y.jsx)(De,{stats:e}),children:(0,Y.jsx)(te.y,{className:Ve("groups-stats-bar"),value:e.createdGroups,capacity:e.totalGroups})},e.erasure)))})},ze=(e,s,t,r,a)=>{const n=[];if(e.DataCenters&&n.push({label:Oe("dc"),value:(0,Y.jsx)(Ce.$,{tags:e.DataCenters})}),e.SystemTablets){const s=e.SystemTablets.slice(0).sort(Ae);n.push({label:Oe("tablets"),value:(0,Y.jsx)("div",{className:Ve("system-tablets"),children:s.map(((e,s)=>(0,Y.jsx)(Te.Y,{tablet:e},s)))})})}return e.Tenants&&n.push({label:Oe("databases"),value:e.Tenants}),n.push({label:Oe("nodes"),value:(0,Y.jsx)(te.y,{value:null===e||void 0===e?void 0:e.NodesAlive,capacity:null===e||void 0===e?void 0:e.NodesTotal})},{label:Oe("load"),value:(0,Y.jsx)(te.y,{value:null===e||void 0===e?void 0:e.LoadAverage,capacity:null===e||void 0===e?void 0:e.NumberOfCpus})},{label:Oe("storage-size"),value:(0,Y.jsx)(te.y,{value:null===e||void 0===e?void 0:e.StorageUsed,capacity:null===e||void 0===e?void 0:e.StorageTotal,formatValues:q.QO})}),Object.keys(t).length&&n.push(...(e=>Object.keys(e).map((s=>({label:Oe("storage-groups",{diskType:s}),value:(0,Y.jsx)(Ie,{stats:e[s]})}))))(t)),n.push(...r,{label:Oe("links"),value:(0,Y.jsx)("div",{className:Ve("links"),children:a.map((e=>{let{title:s,url:t}=e;return(0,Y.jsx)(ye.j,{title:s,url:t},s)}))})},{label:Oe("versions"),value:(0,Y.jsx)(Se,{versionsValues:s})}),n},Ge=e=>{let{cluster:s={},versionsValues:t=[],groupsStats:r={},loading:a,error:n,additionalClusterProps:l={}}=e;const o=(0,g.ix)((e=>e.singleClusterMode));let i=z.y3+"/internal";o&&!z.j4&&(i="/internal");const{info:d=[],links:c=[]}=l,u=ze(s,t,r,d,[{title:N.Ah,url:i},...c]);return(0,Y.jsx)("div",{className:Ve(),children:(0,Y.jsx)("div",{className:Ve("info"),children:a?(0,Y.jsx)(be.b,{className:Ve("skeleton"),rows:9}):n?(0,Y.jsx)(E.V,{error:n,className:Ve("error")}):(0,Y.jsx)(ge.Z,{dots:!0,info:u})})})};var Me=t(81003);const Ze=(0,j.cn)("cluster");function Fe(e){var s,t;let{additionalClusterProps:h,additionalTenantsProps:j,additionalNodesProps:y,additionalVersionsProps:f}=e;const S=r.useRef(null),P=(0,g.zL)(),E=function(){const e=(0,g.zL)(),s=(0,g.ix)((e=>e.cluster.defaultClusterTab)),t=(0,o.$B)(v.ZP.cluster),{activeTab:a}=(null===t||void 0===t?void 0:t.params)||{};let n;n=(0,Me.V2)(a)?a:s;return r.useEffect((()=>{n!==s&&e((0,m.LQ)(n))}),[n,s,e]),n}(),[{clusterName:k,backend:O}]=(0,i.useQueryParams)({clusterName:i.StringParam,backend:i.StringParam}),[L]=(0,g.Rj)(),{data:{clusterData:A={},groupsStats:V}={},isLoading:D,error:I}=m.UM.useGetClusterInfoQuery(null!==k&&void 0!==k?k:void 0,{pollingInterval:L}),z=I&&"object"===typeof I?I:void 0,{data:G=[],isLoading:M}=p.useGetClusterNodesQuery(void 0),Z=D||M,{Name:F}=A;r.useEffect((()=>{P((0,x.J)("cluster",{}))}),[P,F]);const R=r.useMemo((()=>null!==f&&void 0!==f&&f.getVersionToColorMap?null===f||void 0===f?void 0:f.getVersionToColorMap():(0,b.ZP)(null===A||void 0===A?void 0:A.Versions)),[f,A]),B=r.useMemo((()=>T(G,R)),[G,R]),W=null!==(s=null!==(t=null===A||void 0===A?void 0:A.Name)&&void 0!==t?t:k)&&void 0!==s?s:N.DO,H=r.useMemo((()=>Me._Y.find((e=>{let{id:s}=e;return s===E}))),[E]);return(0,Y.jsxs)("div",{className:Ze(),ref:S,children:[(0,Y.jsx)(l.ql,{defaultTitle:"".concat(W," \u2014 YDB Monitoring"),titleTemplate:"%s \u2014 ".concat(W," \u2014 YDB Monitoring"),children:H?(0,Y.jsx)("title",{children:H.title}):null}),(0,Y.jsx)("div",{className:Ze("header"),children:(()=>{var e;return Z?(0,Y.jsx)(a.O,{className:Ze("title-skeleton")}):(0,Y.jsx)(c.A,{size:"m",status:null===A||void 0===A?void 0:A.Overall,name:null!==(e=null===A||void 0===A?void 0:A.Name)&&void 0!==e?e:N.DO,className:Ze("title")})})()}),(0,Y.jsxs)("div",{className:Ze("tabs"),children:[(0,Y.jsx)(n.m,{size:"l",allowNotSelected:!0,activeTab:E,items:Me._Y,wrapTo:(e,s)=>{let{id:t}=e;const r=(0,Me.B7)(t,{clusterName:k,backend:O});return(0,Y.jsx)(u.h,{to:r,onClick:()=>{P((0,m.LQ)(t))},children:s},t)}}),(0,Y.jsx)(d.q,{})]}),(0,Y.jsx)("div",{children:(0,Y.jsxs)(o.rs,{children:[(0,Y.jsx)(o.AW,{path:(0,v.Fz)((0,Me.B7)(Me.xu.overview)).pathname,children:(0,Y.jsx)(Ge,{cluster:A,groupsStats:V,versionsValues:B,loading:Z,error:z,additionalClusterProps:h})}),(0,Y.jsx)(o.AW,{path:(0,v.Fz)((0,Me.B7)(Me.xu.tenants)).pathname,children:(0,Y.jsx)(J,{additionalTenantsProps:j})}),(0,Y.jsx)(o.AW,{path:(0,v.Fz)((0,Me.B7)(Me.xu.nodes)).pathname,children:(0,Y.jsx)(C.G,{parentContainer:S.current,additionalNodesProps:y})}),(0,Y.jsx)(o.AW,{path:(0,v.Fz)((0,Me.B7)(Me.xu.storage)).pathname,children:(0,Y.jsx)(w.V,{parentContainer:S.current,additionalNodesProps:y})}),(0,Y.jsx)(o.AW,{path:(0,v.Fz)((0,Me.B7)(Me.xu.versions)).pathname,children:(0,Y.jsx)(je,{versionToColor:R})}),(0,Y.jsx)(o.AW,{render:()=>(0,Y.jsx)(o.l_,{to:(0,v.Fz)((0,Me.B7)(E))})})]})})]})}}}]);