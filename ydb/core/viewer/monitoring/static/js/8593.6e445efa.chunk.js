(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[8593],{5890:(e,t,s)=>{var n={"./simpleWorker":51929,"./simpleWorker.js":51929,"monaco-editor/esm/vs/base/common/worker/simpleWorker":51929,"monaco-editor/esm/vs/base/common/worker/simpleWorker.js":51929};function o(e){return Promise.resolve().then((()=>{if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s(n[e])}))}o.keys=()=>Object.keys(n),o.id=5890,e.exports=o},9068:(e,t,s)=>{"use strict";s.d(t,{AI:()=>a,Kd:()=>r,lu:()=>i,qI:()=>l});var n=s(59284),o=s(61674);const r=s.n(o)()({}),a={asHTML:!0,format:"json",compact:!1,escapeWhitespace:!0,showDecoded:!0,binaryAsHex:!1,indent:2,decodeUTF8:!1};function i(e){if(!e)return e;let t;try{t=r.converters.yson(e,a)}catch(s){console.error(s),t={_error:"JSON is invalid"}}return t}function l(e){return n.useMemo((()=>i(e)),[e])}},9204:(e,t,s)=>{var n={"./editorBaseApi":[73848],"./editorBaseApi.js":[73848],"./editorSimpleWorker":[16545],"./editorSimpleWorker.js":[16545],"./editorWorker":[10920],"./editorWorker.js":[10920],"./editorWorkerHost":[80718],"./editorWorkerHost.js":[80718],"./findSectionHeaders":[56691],"./findSectionHeaders.js":[56691],"./getIconClasses":[53068],"./getIconClasses.js":[53068],"./languageFeatureDebounce":[32500],"./languageFeatureDebounce.js":[32500],"./languageFeatures":[56942],"./languageFeatures.js":[56942],"./languageFeaturesService":[76007],"./languageFeaturesService.js":[76007],"./languageService":[17890],"./languageService.js":[17890],"./languagesAssociations":[99908],"./languagesAssociations.js":[99908],"./languagesRegistry":[69259],"./languagesRegistry.js":[69259],"./markerDecorations":[37550],"./markerDecorations.js":[37550],"./markerDecorationsService":[30707],"./markerDecorationsService.js":[30707],"./model":[23750],"./model.js":[23750],"./modelService":[16363],"./modelService.js":[16363],"./resolverService":[18938],"./resolverService.js":[18938],"./semanticTokensDto":[98232],"./semanticTokensDto.js":[98232],"./semanticTokensProviderStyling":[45538],"./semanticTokensProviderStyling.js":[45538],"./semanticTokensStyling":[74243],"./semanticTokensStyling.js":[74243],"./semanticTokensStylingService":[27004],"./semanticTokensStylingService.js":[27004],"./textModelSync/textModelSync.impl":[47443],"./textModelSync/textModelSync.impl.js":[47443],"./textModelSync/textModelSync.protocol":[28868,28868],"./textModelSync/textModelSync.protocol.js":[28868,28868],"./textResourceConfiguration":[90360],"./textResourceConfiguration.js":[90360],"./treeSitterParserService":[44432],"./treeSitterParserService.js":[44432],"./treeViewsDnd":[36723],"./treeViewsDnd.js":[36723],"./treeViewsDndService":[29100],"./treeViewsDndService.js":[29100],"./unicodeTextModelHighlighter":[74855],"./unicodeTextModelHighlighter.js":[74855],"monaco-editor/esm/vs/editor/common/services/editorBaseApi":[73848],"monaco-editor/esm/vs/editor/common/services/editorBaseApi.js":[73848],"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker":[16545],"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js":[16545],"monaco-editor/esm/vs/editor/common/services/editorWorker":[10920],"monaco-editor/esm/vs/editor/common/services/editorWorker.js":[10920],"monaco-editor/esm/vs/editor/common/services/editorWorkerHost":[80718],"monaco-editor/esm/vs/editor/common/services/editorWorkerHost.js":[80718],"monaco-editor/esm/vs/editor/common/services/findSectionHeaders":[56691],"monaco-editor/esm/vs/editor/common/services/findSectionHeaders.js":[56691],"monaco-editor/esm/vs/editor/common/services/getIconClasses":[53068],"monaco-editor/esm/vs/editor/common/services/getIconClasses.js":[53068],"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce":[32500],"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js":[32500],"monaco-editor/esm/vs/editor/common/services/languageFeatures":[56942],"monaco-editor/esm/vs/editor/common/services/languageFeatures.js":[56942],"monaco-editor/esm/vs/editor/common/services/languageFeaturesService":[76007],"monaco-editor/esm/vs/editor/common/services/languageFeaturesService.js":[76007],"monaco-editor/esm/vs/editor/common/services/languageService":[17890],"monaco-editor/esm/vs/editor/common/services/languageService.js":[17890],"monaco-editor/esm/vs/editor/common/services/languagesAssociations":[99908],"monaco-editor/esm/vs/editor/common/services/languagesAssociations.js":[99908],"monaco-editor/esm/vs/editor/common/services/languagesRegistry":[69259],"monaco-editor/esm/vs/editor/common/services/languagesRegistry.js":[69259],"monaco-editor/esm/vs/editor/common/services/markerDecorations":[37550],"monaco-editor/esm/vs/editor/common/services/markerDecorations.js":[37550],"monaco-editor/esm/vs/editor/common/services/markerDecorationsService":[30707],"monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js":[30707],"monaco-editor/esm/vs/editor/common/services/model":[23750],"monaco-editor/esm/vs/editor/common/services/model.js":[23750],"monaco-editor/esm/vs/editor/common/services/modelService":[16363],"monaco-editor/esm/vs/editor/common/services/modelService.js":[16363],"monaco-editor/esm/vs/editor/common/services/resolverService":[18938],"monaco-editor/esm/vs/editor/common/services/resolverService.js":[18938],"monaco-editor/esm/vs/editor/common/services/semanticTokensDto":[98232],"monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js":[98232],"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling":[45538],"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling.js":[45538],"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling":[74243],"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js":[74243],"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService":[27004],"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js":[27004],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl":[47443],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl.js":[47443],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol":[28868,28868],"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js":[28868,28868],"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration":[90360],"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration.js":[90360],"monaco-editor/esm/vs/editor/common/services/treeSitterParserService":[44432],"monaco-editor/esm/vs/editor/common/services/treeSitterParserService.js":[44432],"monaco-editor/esm/vs/editor/common/services/treeViewsDnd":[36723],"monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js":[36723],"monaco-editor/esm/vs/editor/common/services/treeViewsDndService":[29100],"monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js":[29100],"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter":[74855],"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter.js":[74855]};function o(e){if(!s.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return Promise.all(t.slice(1).map(s.e)).then((()=>s(o)))}o.keys=()=>Object.keys(n),o.id=9204,e.exports=o},28539:(e,t,s)=>{"use strict";s.d(t,{T:()=>n.T});var n=s(53755)},29529:(e,t,s)=>{"use strict";s.d(t,{b:()=>a});var n=s(49461);const o=(0,s(48372).g4)("ydb-clipboard-button",{en:{copy:"Copy"}});var r=s(60712);function a({size:e,className:t,copyText:s,withLabel:a,view:i}){if(!s)return null;const l=!1===a?null:a||o("copy");return(0,r.jsx)(n.b,{view:i,size:e||"xs",className:t,text:s,children:l})}},61323:(e,t,s)=>{"use strict";s.d(t,{U:()=>U});var n=s(59284),o=s(74281),r=s(69326),a=s(67028),i=s(77506),l=s(44508),c=s(77577),d=s(9068),u=s(98167);const m=s(21334).F.injectEndpoints({endpoints:e=>({getFeatureFlags:e.query({queryFn:async({database:e},{signal:t})=>{try{const s=await window.api.viewer.getFeatureFlags(e,{signal:t});return{data:s.Databases[0].FeatureFlags}}catch(s){return{error:s}}},providesTags:["All"]}),getConfig:e.query({queryFn:async({database:e},{signal:t})=>{try{const s=await window.api.viewer.getConfig(e,{signal:t}),{StartupConfigYaml:n,...o}=s;return{data:{current:o,startup:String(n)}}}catch(s){return{error:s}}},providesTags:["All"]})}),overrideExisting:"throw"});var v=s(87588),h=s(48372);const g=JSON.parse('{"td-feature-flag":"Feature flag","td-default":"Default","td-current":"Current","enabled":"Enabled","disabled":"Disabled","flag-touched":"Flag is changed","search-placeholder":"Search...","search-empty":"Empty search result","no-data":"No data","title_current":"Current","title_startup":"Startup","title_features":"Feature flags","action_copy-config":"Copy config"}'),p=(0,h.g4)("ydb-diagnostics-configs",{en:g});var x=s(60712);function f({database:e}){const[t]=(0,v.N)(),{currentData:s,isLoading:o,error:r}=m.useGetConfigQuery({database:e},{pollingInterval:t}),{current:a}=s||{},i=(0,d.qI)(a),h=n.useMemo((()=>JSON.stringify(a,null,4)),[a]);return(0,x.jsxs)(u.r,{loading:o,children:[a?(0,x.jsx)(c.p,{value:i,collapsedInitially:!0,withClipboardButton:{copyText:h,withLabel:p("action_copy-config")}}):null,r?(0,x.jsx)(l.o,{error:r}):null]})}var j=s(96589),b=s(58611),y=s(47653),S=s(72373),w=s(35400),k=s(95963),C=s(76086),T=s(47779),N=s(80987),I=s(370);const D={current:"current",features:"features",startup:"startup"},M=(I.z.nativeEnum(D).catch(D.current),{get current(){return p("title_current")},get features(){return p("title_features")},get startup(){return p("title_startup")}}),_=[D.current,D.startup,D.features],F=(0,N.createEnumParam)(_),P=(0,N.withDefault)(F,"current");function L(){const e=(0,a._Q)(),t=(0,a.a9)(),[{configType:s,search:o},r]=(0,N.useQueryParams)({configType:P,search:N.StringParam}),i=n.useCallback((e=>{r({configType:e||void 0},"replaceIn")}),[r]),l=n.useCallback((e=>{r({search:e||void 0},"replaceIn")}),[r]);return n.useEffect((()=>{t||e?e||s!==D.features?i(D.features):i(D.current):i(void 0)}),[e,t]),{configType:s,handleConfigTypeChange:i,search:o,handleSearchChange:l}}const A=(0,i.cn)("ydb-feature-flags"),R=[{name:"Touched",header:"",render:({row:e})=>e.Current?(0,x.jsx)(b.A,{content:p("flag-touched"),className:A("icon-touched",C.zQ),placement:"left",children:(0,x.jsx)(y.I,{data:j.A})}):null,width:36,sortable:!1,resizeable:!1},{name:"Name",get header(){return p("td-feature-flag")},render:({row:e})=>e.Current?(0,x.jsx)("b",{children:e.Name}):e.Name,width:400,sortable:!0,sortAccessor:({Current:e,Name:t})=>Number(!e)+t.toLowerCase()},{name:"Default",get header(){return p("td-default")},render:({row:e})=>{switch(e.Default){case!0:return p("enabled");case!1:return p("disabled");default:return"-"}},width:100,sortable:!1,resizeable:!1},{name:"Current",get header(){return p("td-current")},render:({row:e})=>{var t;return(0,x.jsx)(S.d,{disabled:!0,checked:(null!==(t=e.Current)&&void 0!==t?t:e.Default)||!1})},width:100,sortable:!1,resizeable:!1}],H=({database:e,className:t})=>{const{search:s,handleSearchChange:n}=L(),[o]=(0,T.Nt)(),{currentData:a=[],isLoading:i,error:c}=m.useGetFeatureFlagsQuery({database:e},{pollingInterval:o}),d=null===s||void 0===s?void 0:s.toLocaleLowerCase(),u=d?a.filter((e=>e.Name.toLocaleLowerCase().includes(d))):a;return(0,x.jsxs)(r.L,{className:t,children:[(0,x.jsx)(r.L.Controls,{children:(0,x.jsx)(k.v,{value:d,onChange:n,placeholder:p("search-placeholder"),width:300})}),(0,x.jsx)(r.L.Table,{loading:i,children:c?(0,x.jsx)(l.o,{error:c}):(0,x.jsx)(w.l,{emptyDataMessage:p(d?"search-empty":"no-data"),columnsWidthLSKey:"featureFlagsColumnsWidth",columns:R,data:u,settings:C.N3})})]})};var $=s(84279),O=s(6376);const W={automaticLayout:!0,selectOnLineNumbers:!0,readOnly:!0,minimap:{enabled:!1},wrappingIndent:"indent"};function E({database:e,className:t}){const[s]=(0,v.N)(),n=(0,$.i)(),{currentData:o,isLoading:r,error:a}=m.useGetConfigQuery({database:e},{pollingInterval:s}),{startup:i}=o||{};return(0,x.jsxs)(u.r,{loading:r,children:[a?(0,x.jsx)(l.o,{error:a}):null,i?(0,x.jsx)("div",{className:t,children:(0,x.jsx)(O.default,{language:"yaml",value:i,options:W,theme:`vs-${n}`})}):null]})}const V=(0,i.cn)("ydb-configs");function U({database:e,className:t,scrollContainerRef:s}){const{configType:o}=L(),i=(0,a._Q)(),l=(0,a.a9)(),c=n.useMemo((()=>{const e=[];return i&&e.push(D.features),l&&(e.push(D.current),e.push(D.startup)),e}),[i,l]);return(0,x.jsxs)(r.L,{fullHeight:!0,className:V(null,t),children:[(0,x.jsx)(r.L.Controls,{children:(0,x.jsx)(K,{options:c})}),(0,x.jsx)(r.L.Table,{scrollContainerRef:s,children:(()=>{switch(o){case D.current:return(0,x.jsx)(f,{database:e});case D.startup:return(0,x.jsx)(E,{database:e,className:V("startup")});case D.features:return(0,x.jsx)(H,{database:e,className:V("feature-flags")})}})()})]})}function K({options:e}){const{configType:t,handleConfigTypeChange:s}=L();return e.length?(0,x.jsx)(o.x,{value:t,onUpdate:s,children:e.map((e=>(0,x.jsx)(o.x.Option,{value:e,children:M[e]},e)))}):null}},77577:(e,t,s)=>{"use strict";s.d(t,{p:()=>ae});var n=s(59284),o=s(55111),r=s(2468),a=s(4557),i=s(32752),l=s(8979),c=s(80136),d=s(47653),u=s(17270),m=s(47779),v=s(29529),h=s(39439),g=s.n(h),p=s(60712);function x({className:e,text:t,start:s,length:o,hasComa:r}){const a=r?(0,p.jsx)(n.Fragment,{children:",\xa0"}):null;if(o&&"number"===typeof s&&s>=0&&s<t.length){const r=t.substring(0,s),i=t.substring(s,s+o),l=t.substring(s+o);return(0,p.jsxs)(n.Fragment,{children:[r&&(0,p.jsx)("span",{className:e(),children:r}),(0,p.jsx)("span",{className:e({highlighted:!0}),children:i}),l&&(0,p.jsx)("span",{className:e(),children:l}),a]})}return(0,p.jsxs)("span",{className:e(),children:[t,a]})}function f({className:e,text:t,starts:s,length:o,hasComa:r}){if(!o||!s.length){const s=r?(0,p.jsx)(n.Fragment,{children:",\xa0"}):null;return(0,p.jsxs)("span",{className:e(),children:[t,s]})}const a=[];for(let n=0,i=0;n<s.length&&i<t.length;++n){const l=n===s.length-1,c=s[n]+(l?t.length:o),d=t.substring(i,c);d&&a.push((0,p.jsx)(x,{className:e,text:d,start:s[n]-i,length:o,hasComa:l&&r})),i=c}return(0,p.jsx)(n.Fragment,{children:a})}const j=(0,s(77506).cn)("ydb-json-viewer");function b(e){const{collapsed:t,onToggle:s,path:n}=e;return(0,p.jsx)("span",{title:n,className:j("collapsed"),children:(0,p.jsx)(c.$,{onClick:s,view:"flat-secondary",size:"xs",children:(0,p.jsx)(c.$.Icon,{children:(0,p.jsx)("span",{className:"unipika",children:t?"[+]":"[-]"})})})})}var y=s(48372);const S=JSON.parse('{"action_collapse-all":"Collapse all","action_expand-all":"Expand all","action_next":"Next","action_back":"Back","description_search":"Search...","description_matched-rows":"Matched rows","description_full-value":"Full value","context_case-sensitive-search":"Case sensitive search enadled","context_case-sensitive-search-disabled":"Case sensitive search disabled","context_items-count":[" {{count}} item "," {{count}} items "," {{count}} items "," {{count}} items "]}'),w=(0,y.g4)("ydb-json-viewer",{en:S});var k=s(9068);function C(e){return t=>j("filtered",t,e)}var T=s(70983);function N(e){const{row:{level:t,open:s,close:o,key:r,value:a,hasDelimiter:i,path:l,collapsed:c,depth:d},settings:u,onToggleCollapse:m,matched:v,filter:h,showFullText:g,index:x}=e,f=n.useCallback((()=>{l&&m(l)}),[l,m]),y=n.useCallback((()=>{g(x)}),[g,x]);return(0,p.jsxs)("div",{className:j("cell","unipika"),children:[A(t),l&&(0,p.jsx)(b,{collapsed:c,path:l,onToggle:f}),(0,p.jsx)(I,{text:r,settings:u,matched:null===v||void 0===v?void 0:v.keyMatch,filter:h}),s&&(0,p.jsx)(P,{type:s,settings:u}),void 0!==d&&(0,p.jsx)("span",{className:"unipika",children:w("context_items-count",{count:d})}),void 0!==a&&(0,p.jsx)(D,{text:a,settings:u,matched:null===v||void 0===v?void 0:v.valueMatch,filter:h,showFullText:y,maxValueWidth:e.maxValueWidth}),c&&void 0===d&&(0,p.jsx)("span",{className:"unipika",children:"..."}),o&&(0,p.jsx)(P,{type:o,settings:u,close:!0}),i&&(0,p.jsx)(F,{text:","})]})}function I(e){const t=function(e){if(null===e||void 0===e||!e.text)return null;return _(e,j("key"))}(e);return t?(0,p.jsxs)(n.Fragment,{children:[t,(0,p.jsx)(F,{text:": "})]}):null}function D(e){var t;return(0,p.jsx)(n.Fragment,{children:M(e,j("value",{type:null===(t=e.text)||void 0===t?void 0:t.$type}))})}function M(e,t){var s;return"string"===(null===(s=e.text)||void 0===s?void 0:s.$type)?_(e,t):function(e,t){const{text:s,filter:n,settings:o,matched:r}=e;let a=null;if(r&&n){const e=k.Kd.format(s,{...o,asHTML:!1});a=(0,p.jsx)(f,{className:C(t),text:e,starts:r,length:null===n||void 0===n?void 0:n.length})}else a=s?function(e,t=k.AI){const s=k.Kd.formatValue(e,{...k.AI,...t},0);return(0,p.jsx)("span",{className:"unipika",dangerouslySetInnerHTML:{__html:s}})}(s,o):void 0;return a||null}(e,j("value"))}function _(e,t){const{text:s,settings:n=k.AI,matched:o=[],filter:r,showFullText:a,maxValueWidth:i=1/0}=e,l=k.Kd.format(s,{...n,maxStringSize:10,asHTML:!1}),c=l.length,u=l.substring(1,Math.min(c-1,i+1)),m=u.length<l.length-2;let v=!1;if(m)for(let d=o.length-1;d>=0;--d)if(u.length<o[d]+((null===r||void 0===r?void 0:r.length)||0)){v=!0;break}return(0,p.jsxs)("span",{children:[(0,p.jsx)(f,{className:C(t),text:u,starts:o,length:null===r||void 0===r?void 0:r.length}),m&&(0,p.jsxs)("span",{className:j("filtered",{highlighted:v,clickable:!0}),onClick:a,children:["\u2026",(0,p.jsx)(d.I,{data:T.A})]})]})}function F({text:e}){return(0,p.jsx)("span",{children:e})}function P(e){const{type:t,close:s}=e;switch(t){case"array":return(0,p.jsx)(F,{text:s?"]":"["});case"object":return(0,p.jsx)(F,{text:s?"}":"{"})}}const L={};function A(e){let t=L[e];if(!t){const s=g()(Array(3*e),"&nbsp;").join("");t=L[e]=(0,p.jsx)("span",{dangerouslySetInnerHTML:{__html:s}})}return t}var R=s(79602),H=s(59136),$=s(26195),O=s(94630);const W=n.forwardRef((function({matchIndex:e,matchedRows:t,value:s,onUpdate:n,onKeyDown:o,onNextMatch:r,onPrevMatch:a,caseSensitive:u,onUpdateCaseSensitive:m},v){const h=t.length,g=h?1+e%h:0;return(0,p.jsxs)(i.s,{gap:2,wrap:"nowrap",children:[(0,p.jsx)(R.k,{ref:v,className:j("filter"),hasClear:!0,size:"m",type:"text",value:s,placeholder:w("description_search"),onUpdate:n,autoFocus:!1,onKeyDown:o,endContent:(0,p.jsx)(l.m,{title:w(u?"context_case-sensitive-search":"context_case-sensitive-search-disabled"),children:(0,p.jsx)(c.$,{view:"flat-secondary",onClick:m,selected:u,children:(0,p.jsx)(d.I,{data:O.A})})})}),(0,p.jsxs)(i.s,{gap:1,wrap:"nowrap",children:[(0,p.jsx)(l.m,{title:w("action_next"),placement:"top-start",children:(0,p.jsx)(c.$,{className:j("match-btn"),view:"flat-secondary",onClick:r,disabled:!h,children:(0,p.jsx)(d.I,{data:H.A})})}),(0,p.jsx)(l.m,{title:w("action_back"),placement:"top-start",children:(0,p.jsx)(c.$,{className:j("match-btn"),view:"flat-secondary",onClick:a,disabled:!h,children:(0,p.jsx)(d.I,{data:$.A})})})]}),s&&(0,p.jsxs)("span",{className:j("match-counter"),title:w("description_matched-rows"),children:[g," / ",h||0]})]})}));var E=s(71989);function V({onClose:e,text:t,starts:s,length:n}){return(0,p.jsxs)(E.l,{open:!0,onClose:e,onOutsideClick:e=>{e.stopPropagation()},children:[(0,p.jsx)(E.l.Header,{caption:w("description_full-value")}),(0,p.jsx)(E.l.Divider,{}),(0,p.jsx)(E.l.Body,{children:(0,p.jsx)(i.s,{direction:"column",gap:2,width:"70vw",maxHeight:"80vh",children:(0,p.jsx)("div",{className:j("full-value"),children:(0,p.jsx)(f,{className:C(),starts:s,text:t,length:n})})})})]})}function U(e,t){const s={dst:[],levels:[],path:[],collapsedState:(null===t||void 0===t?void 0:t.collapsedState)||{},matchedPath:"",collapsedPath:""};K(e,0,s);const n=function(e,t,s){if(!t)return{};const n=Object.assign({},null===s||void 0===s?void 0:s.settings,{asHTML:!1}),o={};for(let r=0;r<e.length;++r){const{key:a,value:i}=e[r],l=se(a,t,n,null===s||void 0===s?void 0:s.caseSensitive),c=se(i,t,n,null===s||void 0===s?void 0:s.caseSensitive);(l||c)&&(o[r]=Object.assign({},l&&{keyMatch:l},c&&{valueMatch:c}))}return o}(s.dst,null===t||void 0===t?void 0:t.filter,{settings:null===t||void 0===t?void 0:t.settings,caseSensitive:null===t||void 0===t?void 0:t.caseSensitive});return{data:s.dst,searchIndex:n}}function K(e,t,s){return function(e,t=0,s){const n=s.dst.length,{type:o}=s.levels[s.levels.length-1]||{},r=function(e){return"object"===e}(o)?n-1:s.dst.length,a=J(s),i=function(e){return"map"===e.$type||"list"===e.$type}(e);let l=0;if(a)z(e,t,s);else{l=function(e,t,s,n){let o=0;const r=e&&J(n);if(r)z(t,s,n);else switch(t.$type){case"map":!function(e,t,s){const n=X("object",t,s,e.$value.length);(function(e,t,s,n){for(let o=0;o<e.length;++o){const[r,a]=e[o],i={key:r,level:t};s.dst.push(i),q(r.$value,s),K(a,t,s),++n.currentIndex,G(s)}})(e.$value,t+1,s,n),Y("object",t,s)}(t,s,n),o=t.$value.length;break;case"list":!function(e,t,s){const{$value:n}=e,o=X("array",t,s,n.length);for(let r=0;r<n.length;++r)q(String(r),s),K(n[r],t+1,s),++o.currentIndex,G(s);Y("array",t,s)}(t,s,n),o=t.$value.length;break;case"string":ee(function(e,t){const{$attributes:s,...n}=e;return{level:t,value:n}}(t,s),n);break;default:ee(function(e,t){const{$attributes:s,...n}=e;return{level:t,value:n}}(t,s),n)}return o}(i,e,t,s)}i&&l&&(s.dst[r].depth=l,B(s,r))}(e,t,s)}function z(e,t,s){switch(e.$type){case"map":Q("object",t,s,e.$value.length);break;case"list":Q("array",t,s,e.$value.length)}}function Q(e,t,s,n){X(e,t,s,0);const o=s.dst[s.dst.length-1];o.depth=n,o.collapsed=!0,B(s,s.dst.length-1),Y(e,t,s)}function B(e,t){e.collapsedPath.length&&(e.dst[t].path=e.collapsedPath)}function q(e,t){t.path.push(e),t.collapsedPath=t.collapsedPath.length?t.collapsedPath+"/"+e:e}function G(e){const t=e.path.pop();void 0!==t&&(e.collapsedPath=e.collapsedPath.substring(0,e.collapsedPath.length-t.length-1))}function J(e){return Boolean(e.collapsedState[e.collapsedPath])}function X(e,t,s,n){const{dst:o}=s,r=te(o);null!==r&&void 0!==r&&r.key&&r.level===t?r.open=e:o.push({level:t,open:e});const a={type:e,length:n,currentIndex:0};return s.levels.push(a),a}function Y(e,t,s){const n=s.levels.pop();if(n.type!==e)throw new Error(`The unipika tree cannot be converted to array, there is some mess with levels \n${JSON.stringify({type:e,level:t,info:n,ctx:s},null,2)}`);const o=s.dst[s.dst.length-1],r=o.level===t&&o.open===e,a=r?o:{level:t,close:e};Z(s)&&(a.hasDelimiter=!0),r?a.close=e:s.dst.push(a)}function Z(e){const{length:t,currentIndex:s}=e.levels[e.levels.length-1]||{};return void 0!==t&&s<t-1}function ee(e,t){const s=te(t.dst);s&&!s.open?Object.assign(s,e,{level:s.level}):t.dst.push(e);const n=t.dst[t.dst.length-1];Z(t)&&(n.hasDelimiter=!0)}function te(e){const t=e[e.length-1];return null===t||void 0===t||!t.key||null!==t&&void 0!==t&&t.close?null:t}function se(e,t,s,n){if(!e)return;const o=[];let r=k.Kd.formatValue(e,s);if(!r)return;r=String(r),"string"===e.$type&&(r=r.substring(1,r.length-1));let a=0,i=t;for(n||(r=r.toLowerCase(),i=t.toLowerCase());a>=0&&a<r.length;){const e=r.indexOf(i,a);if(-1===e)break;a=e+i.length,o.push(e)}return o.length?o:void 0}const ne={displayIndices:!1,dynamicRender:!0,sortable:!1,dynamicRenderMinSize:50};function oe(e){const{data:t}=U(e);return t.reduce(((e,{path:t})=>(t&&(e[t]=!0),e)),{})}function re(e,t,s,n){const o=U(e,{collapsedState:t,filter:s,caseSensitive:n});return Object.assign({},{flattenResult:o,matchedRows:Object.keys(o.searchIndex).map(Number)})}function ae(e){const{value:t}=e;return function(e){return!("_error"in e)}(t)?(0,p.jsx)(ie,{...e,value:t}):t._error}function ie({tableSettings:e,value:t,unipikaSettings:s,search:h=!0,extraTools:g,collapsedInitially:x,maxValueWidth:f=100,toolbarClassName:b,withClipboardButton:y}){const[S,C]=(0,m.iK)(u.GS.CASE_SENSITIVE_JSON_SEARCH,!1),[T,I]=n.useState((()=>x?oe(t):{})),[D,M]=n.useState(""),[_,F]=n.useState((()=>re(t,T,D,S))),[P,L]=n.useState(-1),[A,R]=n.useState(),H=n.useRef(null),$=n.useRef(null),O=n.useMemo((()=>({...ne,dynamicInnerRef:H,...e})),[e]),E=({row:e,index:t})=>{const{flattenResult:{searchIndex:n}}=_;return(0,p.jsx)(N,{matched:n[t],row:e,settings:s,onToggleCollapse:U,filter:D,showFullText:Y,index:t,maxValueWidth:f})},U=e=>{const t={...T};t[e]?delete t[e]:t[e]=!0,K({collapsedState:t})},K=(e,s)=>{const{collapsedState:n,matchIndex:o,filter:r,caseSensitive:a}=e;void 0!==n&&I(n),void 0!==o&&L(o),void 0!==r&&M(r);F(re(t,null!==n&&void 0!==n?n:T,null!==r&&void 0!==r?r:D,null!==a&&void 0!==a?a:S)),null===s||void 0===s||s()},z=()=>{K({collapsedState:{}},(()=>{q(null,0)}))},Q=()=>{const e=oe(t);K({collapsedState:e})},B=e=>{K({filter:e,matchIndex:0},(()=>{q(null,0)}))},q=(e,t=1)=>{var s,n;const{matchedRows:o}=_;if(!o.length)return;let r=(P+t)%o.length;r<0&&(r=o.length+r),r!==P&&L(r),null===(s=H.current)||void 0===s||s.scrollTo(o[r]-6),null===(n=$.current)||void 0===n||n.focus()},G=()=>{q(null,-1)},J=e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey?G():q(null))},X=()=>{const e=!S;C(e),K({caseSensitive:e})},Y=e=>{const{flattenResult:{searchIndex:t,data:s}}=_;R({value:s[e].value,searchInfo:t[e]})},Z=()=>{R(void 0)};return(0,p.jsxs)("div",{className:j(),children:[(0,p.jsxs)(i.s,{gap:2,wrap:"nowrap",className:j("toolbar",b),justifyContent:"space-between",children:[h&&(0,p.jsx)(W,{onUpdate:B,matchIndex:P,matchedRows:_.matchedRows,value:D,ref:$,onKeyDown:J,onNextMatch:q,onPrevMatch:G,caseSensitive:S,onUpdateCaseSensitive:X}),(0,p.jsxs)(i.s,{gap:2,wrap:"nowrap",children:[(0,p.jsx)(l.m,{title:w("action_expand-all"),placement:"top-start",children:(0,p.jsx)(c.$,{onClick:z,children:(0,p.jsx)(d.I,{data:o.A})})}),(0,p.jsx)(l.m,{title:w("action_collapse-all"),placement:"top-start",children:(0,p.jsx)(c.$,{onClick:Q,children:(0,p.jsx)(d.I,{data:r.A})})}),y&&(0,p.jsx)(v.b,{...y,size:"m",view:"normal"}),g]})]}),(()=>{const e=[{name:"content",render:E,header:null}],{flattenResult:{data:t}}=_;return(0,p.jsx)("div",{className:j("content"),children:(0,p.jsx)(a.Ay,{columns:e,data:t,theme:"yson",settings:O,rowClassName:()=>j("row")})})})(),(()=>{const{value:e,searchInfo:t}=null!==A&&void 0!==A?A:{},n=k.Kd.format(e,{...s,asHTML:!1});return e&&(0,p.jsx)(V,{onClose:Z,starts:(null===t||void 0===t?void 0:t.valueMatch)||[],text:n.substring(1,n.length-1),length:D.length})})()]})}},88616:(e,t,s)=>{"use strict";s.d(t,{Q:()=>M});var n=s(59284),o=s(76938),r=s(88908),a=s(47653),i=s(13847),l=s(80987),c=s(22983),d=s(28539),u=s(10508),m=s(44508),v=s(43615),h=s(35400),g=s(59134),p=s(69326),x=s(74591),f=s(27775),j=s(41826),b=s(21545),y=s(6354),S=s(76086),w=s(12888),k=s(48372);const C=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.kill-impossible-follower":"It\'s impossible to restart a follower","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),T=(0,k.g4)("ydb-tablets",{en:C});var N=s(60712);function I(e){return!1===e.Leader}function D(e){const t=I(e),s=e.State===y.r.Stopped||t,n=(0,w.X)(),[r]=b.X.useKillTabletMutation(),i=e.TabletId;if(!i)return null;let l;return l=T(t?"controls.kill-impossible-follower":n?"dialog.kill-header":"controls.kill-not-allowed"),(0,N.jsx)(c.B,{buttonView:"outlined",dialogHeader:T("dialog.kill-header"),dialogText:T("dialog.kill-text"),onConfirmAction:()=>r({id:i}).unwrap(),buttonDisabled:s||!n,withPopover:!0,popoverContent:l,popoverPlacement:["right","bottom"],popoverDisabled:!1,children:(0,N.jsx)(a.I,{data:o.A})})}function M({tablets:e,loading:t,error:s,scrollContainerRef:o,nodeId:a}){const[{tabletsSearch:c},b]=(0,l.useQueryParams)({tabletsSearch:l.StringParam}),[y,w]=n.useState(),k=n.useMemo((()=>function({nodeId:e}){const t=[{name:"Type",width:150,get header(){return T("Type")},render:({row:e})=>{const t=I(e);return(0,N.jsxs)("span",{children:[e.Type," ",t?(0,N.jsx)(r.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return T("Tablet")},render:({row:e})=>e.TabletId?(0,N.jsx)(x.$,{tabletId:e.TabletId,followerId:e.FollowerId||void 0}):S.Pd},{name:"State",get header(){return T("State")},render:({row:e})=>(0,N.jsx)(f.i,{state:e.State})}];return void 0===e&&t.push({name:"NodeId",get header(){return T("Node ID")},render:({row:e})=>(0,i.isNil)(e.NodeId)?S.Pd:(0,N.jsx)(v.W,{id:e.NodeId}),align:"right"},{name:"fqdn",get header(){return T("Node FQDN")},render:({row:e})=>e.fqdn?(0,N.jsx)(u.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):S.Pd}),t.push({name:"Generation",get header(){return T("Generation")},align:"right"},{name:"Uptime",get header(){return T("Uptime")},render:({row:e})=>(0,N.jsx)(j.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,N.jsx)(D,{...e})}),t}({nodeId:a})),[a]),C=n.useMemo((()=>e.filter((e=>String(e.TabletId).includes(null!==c&&void 0!==c?c:"")))),[e,c]);return(0,N.jsxs)(p.L,{fullHeight:!0,children:[(0,N.jsxs)(p.L.Controls,{children:[(0,N.jsx)(g.v,{placeholder:T("controls.search-placeholder"),onChange:e=>{b({tabletsSearch:e||void 0},"replaceIn")},value:null!==c&&void 0!==c?c:"",width:238}),(0,N.jsx)(d.T,{label:T("controls.entities-count-label"),loading:t,total:e.length,current:C.length})]}),s?(0,N.jsx)(m.o,{error:s}):null,(0,N.jsx)(p.L.Table,{scrollContainerRef:o,scrollDependencies:[c,y],loading:t,children:(0,N.jsx)(h.l,{columns:k,data:C,settings:S.N3,emptyDataMessage:T("noTabletsData"),onSortChange:w})})]})}},95963:(e,t,s)=>{"use strict";s.d(t,{v:()=>n.v});var n=s(59134)}}]);