"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[96079],{13758:(e,t,a)=>{a.r(t),a.d(t,{Node:()=>Ne});var i=a(59284),s=a(23871),n=a(44992),l=a(61750),o=a(10755),d=a(80987),r=a(3685),c=a(44508),u=a(87184),v=a(77506),h=a(31684),p=a(88655),m=a(12888);var g=a(18863),b=a(25196),f=a(60712);const x=(0,v.cn)("ydb-pool-usage"),I=e=>{let t="green";return e>60&&e<=80?t="yellow":e>80&&(t="red"),t},j=({data:e={}})=>{const{Threads:t,Name:a="Unknown",Usage:i=0}=e,s=i&&t,n=Math.floor(100*i),l=n>100?100:n;return(0,f.jsxs)("div",{className:x(),children:[(0,f.jsxs)("div",{className:x("info"),children:[(0,f.jsx)("div",{className:x("pool-name"),children:a}),s&&(0,f.jsxs)("div",{className:x("value"),children:[(0,f.jsxs)("div",{className:x("percents"),children:[n<1?"<1":n,"%"]}),(0,f.jsxs)("div",{className:x("threads"),children:["(\xd7",t,")"]})]})]}),(0,f.jsx)("div",{className:x("visual"),children:(0,f.jsx)("div",{className:x("usage-line",{type:I(l)}),style:{width:`${l}%`}})})]})};var k=a(15132),T=a(41826),w=a(48372);const N=JSON.parse('{"database":"Database","uptime":"Uptime","version":"Version","dc":"DC","rack":"Rack","links":"Links","la-interval-1m":"1 min","la-interval-5m":"5 min","la-interval-15m":"15 min","developer-ui":"Developer UI","no-data":"No data","title.common-info":"Common info","title.endpoints":"Endpoints","title.roles":"Roles","title.pools":"Pools","title.load-average":"Load average"}'),y=(0,w.g4)("ydb-node-info",{en:N}),S=(0,v.cn)("full-node-viewer"),D=({node:e,className:t})=>{var a,i,s,n,l;const o=function(e){const t=(0,p.E)();if((0,m.X)()){if(null!==t&&void 0!==t&&t.getNodeRef){const a=t.getNodeRef(e);return a?(0,h.Un)(a):void 0}if(null!==e&&void 0!==e&&e.NodeId){const t=(0,h.Kx)(e.NodeId);return(0,h.Un)(t)}}}(e),d=[];null!==e&&void 0!==e&&null!==(a=e.Tenants)&&void 0!==a&&a.length&&d.push({label:y("database"),value:e.Tenants[0]}),d.push({label:y("version"),value:null===e||void 0===e?void 0:e.Version},{label:y("uptime"),value:(0,f.jsx)(T.p,{StartTime:null===e||void 0===e?void 0:e.StartTime,DisconnectTime:null===e||void 0===e?void 0:e.DisconnectTime})},{label:y("dc"),value:(null===e||void 0===e?void 0:e.DataCenterDescription)||(null===e||void 0===e?void 0:e.DC)}),null!==e&&void 0!==e&&e.Rack&&d.push({label:y("rack"),value:null===e||void 0===e?void 0:e.Rack}),o&&d.push({label:y("links"),value:(0,f.jsx)(b.K,{url:o,title:y("developer-ui")})});const r=null===e||void 0===e||null===(i=e.Endpoints)||void 0===i?void 0:i.map((({Name:e,Address:t})=>({label:e,value:t}))),c=null===e||void 0===e||null===(s=e.LoadAveragePercents)||void 0===s?void 0:s.map(((e,t)=>{return{label:(a=t,[y("la-interval-1m"),y("la-interval-5m"),y("la-interval-15m")][a]),value:(0,f.jsx)(k.O,{value:e,percents:!0,colorizeProgress:!0,capacity:100})};var a}));return e?(0,f.jsx)("div",{className:S(null,t),children:(0,f.jsxs)(u.s,{wrap:!0,gap:4,children:[(0,f.jsxs)(u.s,{direction:"column",gap:2,children:[(0,f.jsx)(g.z,{title:y("title.common-info"),className:S("section"),info:d}),r&&r.length?(0,f.jsx)(g.z,{title:y("title.endpoints"),className:S("section"),info:r}):null]}),(0,f.jsxs)(u.s,{direction:"column",gap:2,children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:S("section-title"),children:y("title.pools")}),(0,f.jsx)("div",{className:S("section",{pools:!0}),children:null===e||void 0===e||null===(n=e.PoolStats)||void 0===n?void 0:n.map(((e,t)=>(0,f.jsx)(j,{data:e},t)))})]}),(0,f.jsx)(g.z,{title:y("title.load-average"),className:S("section",{average:!0}),info:c})]}),e.Roles&&e.Roles.length?(0,f.jsx)(u.s,{direction:"column",gap:2,children:(0,f.jsxs)("div",{className:S("section"),children:[(0,f.jsx)("div",{className:S("section-title"),children:y("title.roles")}),null===e||void 0===e||null===(l=e.Roles)||void 0===l?void 0:l.map((e=>(0,f.jsx)("div",{className:S("role"),children:e},e)))]})}):null]})}):(0,f.jsx)("div",{className:"error",children:y("no-data")})};var z=a(42655),A=a(44294),P=a(58389),C=a(92459),E=a(67028),V=a(40174),L=a(21334),q=a(78034);const R=e=>{var t;if(null===(t=e.SystemStateInfo)||void 0===t||!t.length)return{};const a=e.SystemStateInfo[0];return(0,q.q1)(a)},F=L.F.injectEndpoints({endpoints:e=>({getNodeInfo:e.query({queryFn:async({nodeId:e},{signal:t})=>{try{const a=await window.api.viewer.getNodeInfo(e,{signal:t});return{data:R(a)}}catch(a){return{error:a}}},providesTags:["All"]}),getNodeStructure:e.query({queryFn:async({nodeId:e},{signal:t})=>{try{return{data:await window.api.viewer.getStorageInfo({nodeId:e},{signal:t})}}catch(a){return{error:a}}},providesTags:["All"]})}),overrideExisting:"throw"});var M=a(90182),O=a(67079),U=a(71635),$=a(29819),G=a(905),Q=a.n(G),X=a(52248),H=a(53850),K=a(56839),B=a(27295);const W=(0,H.Mz)((e=>e),(e=>F.endpoints.getNodeStructure.select({nodeId:e}))),_=(0,H.Mz)((e=>e),((e,t)=>W(t)),((e,t)=>t(e).data)),Y=(0,H.Mz)(((e,t)=>Number(t)),((e,t)=>_(e,t)),((e,t)=>{const a=null===t||void 0===t?void 0:t.StoragePools,i={};null===a||void 0===a||a.forEach((t=>{const a=t.Groups;null===a||void 0===a||a.forEach((a=>{var s;const n=null===(s=a.VDisks)||void 0===s?void 0:s.filter((t=>t.NodeId===e)).map(B.WT);null===n||void 0===n||n.forEach((a=>{var s;const n=(0,K.U9)(a.VDiskId),l=null===(s=a.PDisk)||void 0===s?void 0:s.PDiskId;i[String(l)]||(i[String(l)]={vDisks:{},...a.PDisk}),i[String(l)].vDisks[n]={...a,PDiskId:l,NodeId:e,StoragePoolName:t.Name}}))}))}));return Object.keys(i).reduce(((e,t)=>{const a=i[t].vDisks,s=Object.keys(a).reduce(((e,t,i)=>(e.push({...a[t],id:t,order:i}),e)),[]);return e[t]={...i[t],vDisks:s},e}),{})}));var J=a(112),Z=a(45720),ee=a(4557),te=a(84476),ae=a(99991),ie=a(84375),se=a(33705),ne=a(45659),le=a(33775),oe=a(67808),de=a(54090),re=a(67375),ce=a(7435),ue=a(76086),ve=a(29971);const he=(0,v.cn)("kv-node-structure");function pe({label:e,value:t,className:a}){return(0,f.jsxs)("span",{className:he("pdisk-title-item",a),children:[e&&(0,f.jsxs)("span",{className:he("pdisk-title-item-label"),children:[e,":"]}),(0,f.jsx)("span",{className:he("pdisk-title-item-value"),children:t})]})}const me=(0,v.cn)("kv-node-structure");var ge=function(e){return e.slotId="VDiskSlotId",e.VDiskState="VDiskState",e.Size="Size",e.Info="Info",e}(ge||{});const be={VDiskSlotId:"Slot id",VDiskState:"Status",Size:"Size",Info:""};function fe({pDiskId:e,selectedVdiskId:t,nodeId:a,withDeveloperUILink:i}){return[{name:ge.slotId,header:be[ge.slotId],width:100,render:({row:s})=>{const n=s.VDiskSlotId;let l=null;return(0,ce.f8)(a)&&(0,ce.f8)(e)&&(0,ce.f8)(n)&&(l=(0,h.Wg)({nodeId:a,pDiskId:e,vDiskSlotId:n})),(0,f.jsxs)("div",{className:me("vdisk-id",{selected:s.id===t}),children:[(0,f.jsx)("span",{children:n}),l&&i?(0,f.jsx)(te.$,{size:"s",className:me("external-button",{hidden:!0}),href:l,target:"_blank",title:(0,ve.A)("vdisk.developer-ui-button-title"),children:(0,f.jsx)(ae.I,{data:J.A})}):null]})},align:ee.Ay.LEFT},{name:ge.VDiskState,header:be[ge.VDiskState],width:70,render:({row:e})=>(0,f.jsx)(le.k,{status:e.VDiskState===re.W.OK?de.m.Green:de.m.Red}),sortAccessor:e=>e.VDiskState===re.W.OK?1:0,align:ee.Ay.CENTER},{name:ge.Size,header:be[ge.Size],width:170,render:({row:e})=>(0,f.jsx)(k.O,{value:e.AllocatedSize,capacity:Number(e.AllocatedSize)+Number(e.AvailableSize),formatValues:K.vX,colorizeProgress:!0}),sortAccessor:e=>Number(e.AllocatedSize),align:ee.Ay.CENTER},{name:ge.Info,header:be[ge.Info],width:70,render:({row:e})=>(0,f.jsx)(ie.A,{placement:["right"],content:(0,f.jsx)(oe.E,{data:e,withTitle:!0,withVDiskPageLink:!0}),tooltipContentClassName:me("vdisk-details"),children:(0,f.jsx)(te.$,{view:"flat-secondary",className:me("vdisk-details-button",{selected:e.id===t}),children:(0,f.jsx)(ae.I,{data:Z.A,size:18})})}),sortable:!1}]}function xe({id:e,data:t,selectedVdiskId:a,nodeId:s,unfolded:n}){const l=(0,m.X)(),[o,d]=i.useState(null!==n&&void 0!==n&&n),{TotalSize:r=0,AvailableSize:c=0,Device:u,PDiskId:v,Type:h,vDisks:p}=t,g=Number(r),b=Number(c);return(0,f.jsxs)("div",{className:me("pdisk"),id:e,children:[(0,f.jsxs)("div",{className:me("pdisk-header"),children:[(0,f.jsxs)("div",{className:me("pdisk-title-wrapper"),children:[(0,f.jsx)(le.k,{status:u}),(0,f.jsx)(pe,{label:"PDiskID",value:v,className:me("pdisk-title-id")}),(0,f.jsx)(pe,{value:h,className:me("pdisk-title-type")}),(0,f.jsx)(k.O,{value:g-b,capacity:g,formatValues:K.vX,colorizeProgress:!0,className:me("pdisk-title-size")}),(0,f.jsx)(pe,{label:"VDisks",value:p.length})]}),(0,f.jsx)(te.$,{onClick:o?()=>{d(!1)}:()=>{d(!0)},view:"flat-secondary",children:(0,f.jsx)(se.I,{direction:o?"top":"bottom"})})]}),o&&(Q()(t)?(0,f.jsx)("div",{children:"No information about PDisk"}):(0,f.jsxs)("div",{children:[(0,f.jsx)(ne.Q,{pDisk:t,nodeId:s,className:me("pdisk-details"),withPDiskPageLink:!0}),(0,f.jsxs)("div",{className:me("vdisks-container"),children:[(0,f.jsx)("div",{className:me("vdisks-header"),children:"VDisks"}),(0,f.jsx)(ee.Ay,{theme:"yandex-cloud",data:p,columns:fe({nodeId:s,pDiskId:v,selectedVdiskId:a,withDeveloperUILink:l}),settings:{...ue.N3,dynamicRender:!1},rowClassName:e=>e.id===a?me("selected-vdisk"):""})]})]}))]})}const Ie=(0,v.cn)("kv-node-structure");function je({type:e,id:t}){return`${e}-${t}`}const ke=function({nodeId:e,className:t}){const a=(0,M.N4)((t=>Y(t,e))),[s]=(0,M.Nt)(),{currentData:n,isFetching:l,error:o}=F.useGetNodeStructureQuery({nodeId:e},{pollingInterval:s}),r=l&&void 0===n,[{pdiskId:u,vdiskId:v}]=(0,d.useQueryParams)({pdiskId:d.StringParam,vdiskId:d.StringParam}),h=i.useRef(null),p=i.useRef(!1);return i.useEffect((()=>{if(!Q()(a)&&!p.current&&h.current&&u){const t=document.getElementById(je({type:"pdisk",id:u}));let i=0;if(v){var e;const t=null===(e=a[u])||void 0===e?void 0:e.vDisks,s=null===t||void 0===t?void 0:t.find((e=>e.id===v)),n=s?document.querySelector(".data-table"):void 0,l=(null===s||void 0===s?void 0:s.order)||0;n&&(i+=n.offsetTop+40*l)}t&&(h.current.scrollTo({behavior:"smooth",top:i||t.offsetTop}),p.current=!0)}}),[a,u,v]),(0,f.jsxs)("div",{className:Ie(),ref:h,children:[o?(0,f.jsx)(c.o,{error:o,className:Ie("error")}):null,(0,f.jsx)("div",{className:t,children:r?(0,f.jsx)(X.a,{size:"m"}):o&&!n?null:(()=>{const t=Object.keys(a);return t.length>0?t.map((t=>(0,f.jsx)(xe,{data:a[t],id:je({type:"pdisk",id:t}),unfolded:u===t,selectedVdiskId:v,nodeId:e},t))):"There is no information about node structure."})()})]})},Te=(0,v.cn)("node"),we="Storage";function Ne(){var e,t;const a=i.useRef(null),s=(0,M.YQ)(),l=(0,o.W5)(C.Ay.node),r=null===l||void 0===l?void 0:l.params.id,u=null===l||void 0===l?void 0:l.params.activeTab,[{database:v}]=(0,d.useQueryParams)($.Gi),h=$.IK.parse(u),[p]=(0,M.Nt)(),m=r?{nodeId:r}:n.hT,{currentData:g,isLoading:b,error:x}=F.useGetNodeInfoQuery(m,{pollingInterval:p}),I=(0,E.Pm)(),j=(0,E.c2)(),k=b||!I,T=null===g||void 0===g||null===(e=g.Roles)||void 0===e?void 0:e.find((e=>e===we)),{activeTab:w,nodeTabs:N}=i.useMemo((()=>{var e;let t=T?$.GX:$.GX.filter((e=>"storage"!==e.id));j&&(t=t.filter((e=>"structure"!==e.id)));return{activeTab:null!==(e=t.find((({id:e})=>e===h)))&&void 0!==e?e:t[0],nodeTabs:t}}),[T,j,h]),y=(null===g||void 0===g||null===(t=g.Tenants)||void 0===t?void 0:t[0])||(null===v||void 0===v?void 0:v.toString());return i.useEffect((()=>{b||s((0,V.g)("node",{tenantName:y,nodeRole:T?"Storage":"Compute",nodeId:r}))}),[s,y,r,b,T]),(0,f.jsxs)("div",{className:Te(null),ref:a,children:[(0,f.jsx)(ye,{node:g,activeTabTitle:w.title}),(0,f.jsx)(Se,{node:g,loading:k}),(0,f.jsx)(De,{node:g}),x?(0,f.jsx)(c.o,{error:x,className:Te("error")}):null,(0,f.jsx)(ze,{node:g,loading:k}),r?(0,f.jsx)(Ae,{nodeId:r,tenantName:y,activeTabId:w.id,tabs:N,parentContainer:a}):null]})}function ye({node:e,activeTabTitle:t}){const a=null!==e&&void 0!==e&&e.Host?e.Host:(0,ve.A)("node");return(0,f.jsx)(l.mg,{titleTemplate:`%s \u2014 ${a} \u2014 YDB Monitoring`,defaultTitle:`${a} \u2014 YDB Monitoring`,children:(0,f.jsx)("title",{children:t})})}function Se({node:e,loading:t}){const a=null!==e&&void 0!==e&&e.Host?`${(0,ve.A)("fqdn")}: ${e.Host}`:void 0,i=null!==e&&void 0!==e&&e.DC?`${(0,ve.A)("dc")}: ${e.DC}`:void 0;return(0,f.jsx)(P.B,{loading:t,items:[a,i],className:Te("meta")})}function De({node:e}){return(0,f.jsx)(r.$,{entityName:(0,ve.A)("node"),status:null===e||void 0===e?void 0:e.SystemState,id:null===e||void 0===e?void 0:e.NodeId,className:Te("title")})}function ze({node:e,loading:t}){return t?(0,f.jsx)(z.y,{className:Te("info"),rows:10}):(0,f.jsx)(D,{node:e,className:Te("info")})}function Ae({nodeId:e,tenantName:t,activeTabId:a,tabs:n,parentContainer:l}){return(0,f.jsxs)(i.Fragment,{children:[(0,f.jsx)("div",{className:Te("tabs"),children:(0,f.jsx)(s.t,{size:"l",items:n,activeTab:a,wrapTo:({id:a},i)=>{const s=(0,$.vI)(e,{database:t},a);return(0,f.jsx)(A.E,{to:s,children:i},a)}})}),(()=>{switch(a){case"storage":return(0,f.jsx)(O.z,{nodeId:e,parentRef:l,viewContext:{nodeId:e}});case"tablets":return(0,f.jsx)(U.C,{nodeId:e,database:t,onlyActive:!0});case"structure":return(0,f.jsx)(ke,{nodeId:e});default:return!1}})()]})}},21545:(e,t,a)=>{a.d(t,{X:()=>s});var i=a(78034);const s=a(21334).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:a},{signal:s})=>{try{const[n,l,o]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:a},{signal:s}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:s}),window.api.viewer.getNodesList({signal:s})]),d=(0,i.nN)(o),r=Object.keys(l).reduce(((e,t)=>{var a;const i=null===(a=l[t])||void 0===a?void 0:a.TabletStateInfo;return null===i||void 0===i||i.forEach((a=>{var i;const{ChangeTime:s,Generation:n,State:l,Leader:o,FollowerId:r}=a,c=d&&t?null===(i=d.get(Number(t)))||void 0===i?void 0:i.Host:void 0;e.push({nodeId:t,generation:n,changeTime:s,state:l,leader:o,followerId:r,fqdn:c})})),e}),[]),{TabletStateInfo:c=[]}=n,u=void 0===a?c.find((e=>e.Leader)):c.find((e=>{var t;return(null===(t=e.FollowerId)||void 0===t?void 0:t.toString())===a})),{TabletId:v}=u||{};return{data:{id:v,data:u,history:r}}}catch(n){return{error:n}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e},{signal:t})=>{try{const a=await window.api.viewer.getTabletDescribe(e,{signal:t}),{SchemeShard:i,PathId:s}=e;return{data:(null===a||void 0===a?void 0:a.Path)||`${i}:${s}`}}catch(a){return{error:a}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(i){return{error:i}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(t){return{error:t}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(a){return{error:a}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})},27775:(e,t,a)=>{a.d(t,{i:()=>l});var i=a(47665),s=a(58267),n=a(60712);function l({state:e}){return(0,n.jsx)(i.J,{theme:(0,s._)(e),children:e})}},28539:(e,t,a)=>{a.d(t,{T:()=>i.T});var i=a(53755)},45659:(e,t,a)=>{a.d(t,{Q:()=>g});var i=a(87184),s=a(92459),n=a(7435),l=a(46549),o=a(56839),d=a(31684),r=a(12888),c=a(18863),u=a(25196),v=a(15132),h=a(33775),p=a(50672),m=a(60712);function g({pDisk:e,nodeId:t,withPDiskPageLink:a,className:g}){const b=(0,r.X)(),[f,x,I,j]=function({pDisk:e,nodeId:t,withPDiskPageLink:a,isUserAllowedToMakeChanges:r}){const{PDiskId:c,Path:g,Guid:b,Category:f,Type:x,Device:I,Realtime:j,State:k,SerialNumber:T,TotalSize:w,AllocatedSize:N,StatusV2:y,NumActiveSlots:S,ExpectedSlotCount:D,LogUsedSize:z,LogTotalSize:A,SystemSize:P,SharedWithOs:C}=e||{},E=[];(0,n.f8)(f)&&E.push({label:(0,p.D)("type"),value:x}),(0,n.f8)(g)&&E.push({label:(0,p.D)("path"),value:g}),(0,n.f8)(b)&&E.push({label:(0,p.D)("guid"),value:b}),T&&E.push({label:(0,p.D)("serial-number"),value:T}),C&&E.push({label:(0,p.D)("shared-with-os"),value:(0,p.D)("yes")});const V=[];(0,n.f8)(y)&&V.push({label:(0,p.D)("drive-status"),value:y}),(0,n.f8)(k)&&V.push({label:(0,p.D)("state"),value:k}),(0,n.f8)(I)&&V.push({label:(0,p.D)("device"),value:(0,m.jsx)(h.k,{status:I})}),(0,n.f8)(j)&&V.push({label:(0,p.D)("realtime"),value:(0,m.jsx)(h.k,{status:j})});const L=[];L.push({label:(0,p.D)("space"),value:(0,m.jsx)(v.O,{value:N,capacity:w,formatValues:o.vX,colorizeProgress:!0})}),(0,n.f8)(S)&&(0,n.f8)(D)&&L.push({label:(0,p.D)("slots"),value:(0,m.jsx)(v.O,{value:S,capacity:D})}),(0,n.f8)(z)&&(0,n.f8)(A)&&L.push({label:(0,p.D)("log-size"),value:(0,m.jsx)(v.O,{value:z,capacity:A,formatValues:o.vX})}),(0,n.f8)(P)&&L.push({label:(0,p.D)("system-size"),value:(0,l.z3)({value:P})});const q=[];if((a||r)&&(0,n.f8)(c)&&(0,n.f8)(t)){const e=(0,s.Ck)(c,t),n=(0,d.ar)({nodeId:t,pDiskId:c});q.push({label:(0,p.D)("links"),value:(0,m.jsxs)(i.s,{wrap:"wrap",gap:2,children:[a&&(0,m.jsx)(u.K,{title:(0,p.D)("pdisk-page"),url:e,external:!1}),r&&(0,m.jsx)(u.K,{title:(0,p.D)("developer-ui"),url:n})]})})}return[E,V,L,q]}({pDisk:e,nodeId:t,withPDiskPageLink:a,isUserAllowedToMakeChanges:b});return(0,m.jsxs)(i.s,{className:g,gap:2,direction:"row",wrap:!0,children:[(0,m.jsxs)(i.s,{direction:"column",gap:2,width:500,children:[(0,m.jsx)(c.z,{info:f,renderEmptyState:()=>null}),(0,m.jsx)(c.z,{info:I,renderEmptyState:()=>null})]}),(0,m.jsxs)(i.s,{direction:"column",gap:2,width:500,children:[(0,m.jsx)(c.z,{info:x,renderEmptyState:()=>null}),(0,m.jsx)(c.z,{info:j,renderEmptyState:()=>null})]})]})}},52248:(e,t,a)=>{a.d(t,{a:()=>i.a});var i=a(47334)},71635:(e,t,a)=>{a.d(t,{C:()=>b});var i=a(44992),s=a(53850),n=a(62060),l=a.n(n),o=a(21334),d=a(24600);const r=o.F.injectEndpoints({endpoints:e=>({getTabletsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await window.api.viewer.getTabletsInfo(e,{signal:t})}}catch(a){return{error:a}}},providesTags:["All",{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"}),c=(0,s.Mz)((e=>e),(e=>r.endpoints.getTabletsInfo.select(e)),{argsMemoize:s.i5,argsMemoizeOptions:{equalityCheck:l()}}),u=(0,s.Mz)((e=>e),((e,t)=>c(t)),((e,t)=>t(e).data)),v=(0,s.Mz)(((e,t)=>u(e,t)),(e=>(0,d.K)(e)),((e,t)=>null!==e&&void 0!==e&&e.TabletStateInfo?t?e.TabletStateInfo.map((e=>{var a;const i=void 0===e.NodeId||null===(a=t.get(e.NodeId))||void 0===a?void 0:a.Host;return{...e,fqdn:i}})):e.TabletStateInfo:[]));var h=a(7435),p=a(90182),m=a(88616),g=a(60712);function b({nodeId:e,path:t,database:a,onlyActive:s}){const[n]=(0,p.Nt)();let l={};const o=s?"(State!=Dead)":void 0;(0,h.f8)(e)?l={nodeId:e,database:a,filter:o}:t&&(l={path:t,database:a,filter:o});const{isLoading:d,error:c}=r.useGetTabletsInfoQuery(0===Object.keys(l).length?i.hT:l,{pollingInterval:n}),u=(0,p.N4)((e=>v(e,l)));return(0,g.jsx)(m.Q,{tablets:u,database:a,loading:d,error:c})}},76938:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(59284);const s=e=>i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),i.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 1.5a6.5 6.5 0 1 1-6.445 7.348.75.75 0 1 1 1.487-.194A5.001 5.001 0 1 0 4.43 4.5h1.32a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 2 5.25v-3a.75.75 0 0 1 1.5 0v1.06A6.48 6.48 0 0 1 8 1.5",clipRule:"evenodd"}))},88616:(e,t,a)=>{a.d(t,{Q:()=>z});var i=a(59284),s=a(76938),n=a(98089),l=a(99991),o=a(80987),d=a(22983),r=a(28539),c=a(10508),u=a(44508),v=a(44294),h=a(17594),p=a(41775),m=a(89073),g=a(80420),b=a(27775),f=a(41826),x=a(21545),I=a(6354),j=a(76086),k=a(12888),T=a(29819),w=a(48372);const N=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}'),y=(0,w.g4)("ydb-tablets",{en:N});var S=a(60712);function D(e){const t=e.State===I.r.Stopped,a=(0,k.X)(),[i]=x.X.useKillTabletMutation(),n=e.TabletId;return n?(0,S.jsx)(d.B,{buttonView:"outlined",buttonTitle:y("dialog.kill-header"),dialogHeader:y("dialog.kill-header"),dialogText:y("dialog.kill-text"),onConfirmAction:()=>i({id:n}).unwrap(),buttonDisabled:t||!a,withPopover:!0,popoverContent:y(a?"dialog.kill-header":"controls.kill-not-allowed"),popoverPlacement:["right","auto"],popoverDisabled:!1,children:(0,S.jsx)(l.I,{data:s.A})}):null}function z({database:e,tablets:t,loading:a,error:s}){const[{tabletsSearch:l},d]=(0,o.useQueryParams)({tabletsSearch:o.StringParam}),x=i.useMemo((()=>function({database:e}){return[{name:"Type",width:150,get header(){return y("Type")},render:({row:e})=>{const t=!1===e.Leader;return(0,S.jsxs)("span",{children:[e.Type," ",t?(0,S.jsx)(n.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return y("Tablet")},render:({row:t})=>t.TabletId?(0,S.jsx)(g.$,{tabletId:t.TabletId,database:e,followerId:t.FollowerId||void 0}):j.Pd},{name:"State",get header(){return y("State")},render:({row:e})=>(0,S.jsx)(b.i,{state:e.State})},{name:"NodeId",get header(){return y("Node ID")},render:({row:e})=>{const t=void 0===e.NodeId?void 0:(0,T.vI)(e.NodeId);return(0,S.jsx)(v.E,{to:t,children:e.NodeId})},align:"right"},{name:"fqdn",get header(){return y("Node FQDN")},render:({row:e})=>e.fqdn?(0,S.jsx)(c.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):(0,S.jsx)("span",{children:"\u2014"})},{name:"Generation",get header(){return y("Generation")},align:"right"},{name:"Uptime",get header(){return y("Uptime")},render:({row:e})=>(0,S.jsx)(f.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,S.jsx)(D,{...e})}]}({database:e})),[e]),I=i.useMemo((()=>t.filter((e=>String(e.TabletId).includes(null!==l&&void 0!==l?l:"")))),[t,l]);return(0,S.jsxs)(m.L,{children:[(0,S.jsxs)(m.L.Controls,{children:[(0,S.jsx)(p.v,{placeholder:y("controls.search-placeholder"),onChange:e=>{d({tabletsSearch:e||void 0},"replaceIn")},value:null!==l&&void 0!==l?l:"",width:238}),(0,S.jsx)(r.T,{label:y("controls.entities-count-label"),loading:a,total:t.length,current:I.length})]}),s?(0,S.jsx)(u.o,{error:s}):null,(0,S.jsx)(m.L.Table,{loading:a,children:(0,S.jsx)(h.l,{columns:x,data:I,settings:j.N3,emptyDataMessage:y("noTabletsData")})})]})}}}]);