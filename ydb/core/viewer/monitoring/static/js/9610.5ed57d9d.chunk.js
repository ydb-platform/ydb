"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[9610],{50422:(e,s,t)=>{t.d(s,{q:()=>h});var r=t(84317),a=t(17176),o=t(2418),n=t(905),l=t(24362),i=t(17096),d=t(30817);const u=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),c=(0,d.wZ)("ydb-diagnostics-autorefresh-control",{en:u});var m=t(75859);const p=(0,l.cn)("auto-refresh-control");function h(e){let{className:s}=e;const t=(0,i.zL)(),[l,d]=(0,i.Rj)();return(0,m.jsxs)("div",{className:p(null,s),children:[(0,m.jsx)(a.z,{view:"flat",onClick:()=>{t(n.h.util.invalidateTags(["All"]))},extraProps:{"aria-label":c("Refresh")},children:(0,m.jsx)(a.z.Icon,{children:(0,m.jsx)(r.Z,{})})}),(0,m.jsxs)(o.P,{value:[String(l)],onUpdate:e=>{d(Number(e))},width:85,children:[(0,m.jsx)(o.P.Option,{value:"0",children:c("None")}),(0,m.jsx)(o.P.Option,{value:"15000",children:c("15 sec")}),(0,m.jsx)(o.P.Option,{value:"60000",children:c("1 min")}),(0,m.jsx)(o.P.Option,{value:"120000",children:c("2 min")}),(0,m.jsx)(o.P.Option,{value:"300000",children:c("5 min")})]})]})}},99683:(e,s,t)=>{t.d(s,{l:()=>l});var r=t(68330),a=t(24362),o=t(75859);const n=(0,a.cn)("ydb-cell-with-popover");function l(e){let{children:s,className:t,wrapperClassName:a,...l}=e;return(0,o.jsx)("div",{className:n(null,a),children:(0,o.jsx)(r.J,{className:n("popover",t),...l,children:s})})}},90861:(e,s,t)=>{t.d(s,{m:()=>c});var r=t(27320),a=t(17176),o=t(11050),n=t(81434),l=t(24362),i=t(75859);const d=(0,l.cn)("clipboard-button");function u(e){let{className:s,status:t,title:n,...l}=e;return(0,i.jsx)(r.u,{content:"success"===t?"Copied!":n||"Copy",placement:"bottom-start",children:(0,i.jsx)(a.z,{...l,className:d(null,s),children:(0,i.jsx)(a.z.Icon,{children:(0,i.jsx)(o.K,{status:t,size:16})})})})}function c(e){let{text:s,...t}=e;return(0,i.jsx)(n.h,{text:s,timeout:1e3,children:e=>(0,i.jsx)(u,{...t,status:e})})}},41919:(e,s,t)=>{t.d(s,{Q:()=>d});var r=t(39683),a=t(17176),o=t(88776),n=t(24362),l=t(75859);const i=(0,n.cn)("developer-ui-link-button");function d(e){let{href:s,visible:t=!1,className:n}=e;return(0,l.jsx)(a.z,{size:"s",href:s,className:i({visible:t},n),target:"_blank",children:(0,l.jsx)(o.J,{data:r.Z})})}},1796:(e,s,t)=>{t.d(s,{p:()=>d});t(68963);var r=t(24362),a=t(52317),o=t(92666),n=t(17096),l=t(75859);const i=(0,r.cn)("storage-disk-progress-bar");function d(e){let{diskAllocatedPercent:s=-1,severity:t,compact:r,faded:d,inactive:u,empty:c,content:m,className:p}=e;const[h]=(0,n.yu)(a.yT),v={inverted:h,compact:r,faded:d,empty:c,inactive:u},g=void 0!==t&&(0,o.b2)(t);g&&(v[g.toLocaleLowerCase()]=!0);return(0,l.jsxs)("div",{className:i(v,p),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":s,children:[(()=>{if(r)return(0,l.jsx)("div",{className:i("fill-bar",v),style:{width:"100%"}});const e=h?100-s:s;return s>=0?(0,l.jsx)("div",{className:i("fill-bar",v),style:{width:`${e}%`}}):null})(),m||(!r&&s>=0?(0,l.jsx)("div",{className:i("title"),children:`${Math.round(s)}%`}):null)]})}},49201:(e,s,t)=>{t.d(s,{C:()=>i});var r=t(14979),a=t(24362);const o=(0,t(30817).wZ)("ydb-entities-count",{ru:{of:"\u0438\u0437"},en:{of:"of"}});var n=t(75859);const l=(0,a.cn)("ydb-entities-count"),i=e=>{let{total:s,current:t,label:a,loading:i,className:d}=e,u="";return a&&(u+=`${a}: `),i?u+="...":(u+=`${t}`,s&&Number(s)!==Number(t)&&(u+=` ${o("of")} ${s}`)),(0,n.jsx)(r._,{theme:"info",size:"m",className:l(null,d),children:u})}},69214:(e,s,t)=>{t.d(s,{A:()=>c});var r=t(86017),a=t(75850),o=t(24362),n=t(90861),l=t(68036),i=t(98366),d=t(75859);const u=(0,o.cn)("entity-status");function c(e){let{status:s=a.K.Grey,name:t="",label:o,path:c,iconPath:m,size:p="s",mode:h="color",showStatus:v=!0,externalLink:g=!1,withLeftTrim:N=!1,hasClipboardButton:b,clipboardButtonAlwaysVisible:k=!1,className:D,additionalControls:S}=e;const w=()=>v?(0,d.jsx)(i.J,{className:u("icon"),status:s,size:p,mode:h}):null;return(0,d.jsxs)("div",{className:u(null,D),title:t,children:[m?(y=m,(0,d.jsx)(r.r,{target:"_blank",href:y,children:w()})):w(),o&&(0,d.jsx)("span",{title:o,className:u("label",{size:p,state:s.toLowerCase()}),children:o}),(0,d.jsx)("span",{className:u("link",{"with-left-trim":N}),children:c?g?(0,d.jsx)(r.r,{className:u("name"),href:c,children:t}):(0,d.jsx)(l.h,{className:u("name"),to:c,children:t}):t&&(0,d.jsx)("span",{className:u("name"),children:t})}),b&&(0,d.jsx)(n.m,{text:t,size:"s",className:u("clipboard-button",{visible:k})}),S&&(0,d.jsx)("span",{className:u("additional-controls "),children:S})]});var y}},89778:(e,s,t)=>{t.d(s,{k:()=>m});var r=t(10502),a=t(92398),o=t(48169),n=t(51688),l=t(99683),i=t(41919),d=t(69214),u=t(27506),c=t(75859);const m=e=>{let{node:s,getNodeRef:t,database:m}=e;if(!s.Host)return(0,c.jsx)("span",{children:"\u2014"});const p=!(0,n.TA)(s);let h;t?h=t(s)+"internal":s.NodeId&&(h=(0,o.wq)(s.NodeId)+"internal");const v=p?(0,a.a3)(s.NodeId,{tenantName:null!==m&&void 0!==m?m:s.TenantName}):void 0,g=h?(0,c.jsx)(i.Q,{href:h}):null;return(0,c.jsx)(l.l,{disabled:!p,content:(0,c.jsx)(u.bP,{data:s}),placement:["top","bottom"],behavior:r.x.Immediate,children:(0,c.jsx)(d.A,{name:s.Host,status:s.SystemState,path:v,hasClipboardButton:!0,additionalControls:g})})}},40073:(e,s,t)=>{t.d(s,{J:()=>v,b:()=>h});var r=t(68963),a=t(44920),o=t(75850),n=t(24362),l=t(52317),i=t(92666),d=t(55850),u=t(62206),c=t(75859);const m=(0,n.cn)("pdisk-storage-popup"),p=[o.K.Orange,o.K.Red,o.K.Yellow],h=(e,s)=>{var t;const{AvailableSize:r,TotalSize:a,State:o,PDiskId:n,NodeId:u,Path:c,Realtime:m,Type:h,Device:v}=e,g=[{label:"PDisk",value:null!==(t=(0,i.CH)(u,n))&&void 0!==t?t:l.jX},{label:"State",value:o||"not available"},{label:"Type",value:h||"unknown"}];return u&&g.push({label:"Node Id",value:u}),s&&u&&s.get(u)&&g.push({label:"Host",value:s.get(u)}),c&&g.push({label:"Path",value:c}),g.push({label:"Available",value:`${(0,d.Uz)(r)} of ${(0,d.Uz)(a)}`}),m&&p.includes(m)&&g.push({label:"Realtime",value:m}),v&&p.includes(v)&&g.push({label:"Device",value:v}),g},v=e=>{let{data:s,nodes:t,...o}=e;const n=r.useMemo((()=>h(s,t)),[s,t]);return(0,c.jsx)(a.G,{contentClassName:m(),placement:["top","bottom"],hasArrow:!0,offset:[0,12],...o,children:(0,c.jsx)(u._P,{title:"PDisk",info:n,size:"s"})})}},67359:(e,s,t)=>{t.d(s,{y:()=>c});var r=t(56829),a=t(24362),o=t(34301),n=t(55850),l=t(75859);const i=(0,a.cn)("progress-viewer"),d=e=>(0,o.uf)((0,o.W0)(Number(e),2)),u=(e,s)=>[d(e),d(s)];function c(e){let{value:s,capacity:t,formatValues:a=u,percents:o,className:d,size:c="xs",colorizeProgress:m,inverseColorize:p,warningThreshold:h=60,dangerThreshold:v=80}=e;const g=(0,r.F)();let N=Math.round(parseFloat(String(s))/parseFloat(String(t))*100)||0;N=N>100?100:N;let b=s,k=t,D="/";o?(b=N+"%",k="",D=""):a&&([b,k]=a(Number(s),Number(t)));let S=p?"danger":"good";m&&(N>h&&N<=v?S="warning":N>v&&(S=p?"good":"danger"),(0,n.kE)(t)||(N=100));const w={width:N+"%"};return(0,n.kE)(s)?(0,l.jsxs)("div",{className:i({size:c,theme:g,status:S},d),children:[(0,l.jsx)("div",{className:i("line"),style:w}),(0,l.jsx)("span",{className:i("text"),children:(0,n.kE)(t)?`${b} ${D} ${k}`:b})]}):(0,l.jsx)("div",{className:`${i({size:c})} ${d} error`,children:"no data"})}},2098:(e,s,t)=>{t.d(s,{G:()=>d});var r=t(2639),a=t(19812),o=t(24362),n=t(89712),l=t(75859);const i=(0,o.cn)("ydb-resizeable-data-table");function d(e){let{columnsWidthLSKey:s,columns:t,settings:o,wrapperClassName:d,...u}=e;const[c,m]=(0,n.M)(s),p=(0,r.B)(t,c),h={...o,defaultResizeable:!0};return(0,l.jsx)("div",{className:i(null,d),children:(0,l.jsx)(a.ZP,{theme:"yandex-cloud",columns:p,onResize:m,settings:h,...u})})}},30629:(e,s,t)=>{t.d(s,{o:()=>i});var r=t(68963),a=t(77264),o=t(24362),n=t(75859);const l=(0,o.cn)("ydb-search"),i=e=>{let{onChange:s,value:t="",className:o,debounce:i=200,placeholder:d}=e;const[u,c]=r.useState(t),m=r.useRef();r.useEffect((()=>{c((e=>e!==t?t:e))}),[t]);return(0,n.jsx)(a.o,{hasClear:!0,autoFocus:!0,className:l(null,o),placeholder:d,value:u,onUpdate:e=>{c(e),window.clearTimeout(m.current),m.current=window.setTimeout((()=>{null===s||void 0===s||s(e)}),i)}})}},98366:(e,s,t)=>{t.d(s,{J:()=>m});var r=t(67585),a=t(57225),o=t(71586),n=t(88776),l=t(75850),i=t(24362),d=t(75859);const u=(0,i.cn)("ydb-status-icon"),c={[l.K.Blue]:r.Z,[l.K.Yellow]:a.Z,[l.K.Orange]:o.Z,[l.K.Red]:a.Z};function m(e){let{status:s=l.K.Grey,size:t="s",mode:r="color",className:a}=e;const o={state:s.toLowerCase(),size:t};return"icons"===r&&s in c?(0,d.jsx)(n.J,{className:u("status-icon",o,a),data:c[s]}):(0,d.jsx)("div",{className:u("status-color",o,a)})}},22692:(e,s,t)=>{t.d(s,{h:()=>l});var r=t(56711),a=t(24362),o=t(75859);const n=(0,a.cn)("table-skeleton"),l=e=>{let{rows:s=2,className:t}=e;return(0,o.jsxs)("div",{className:n(null,t),children:[(0,o.jsxs)("div",{className:n("row"),children:[(0,o.jsx)(r.O,{className:n("col-1")}),(0,o.jsx)(r.O,{className:n("col-2")}),(0,o.jsx)(r.O,{className:n("col-3")}),(0,o.jsx)(r.O,{className:n("col-4")}),(0,o.jsx)(r.O,{className:n("col-5")})]}),[...new Array(s)].map(((e,s)=>(0,o.jsx)("div",{className:n("row"),children:(0,o.jsx)(r.O,{className:n("col-full")})},`skeleton-row-${s}`)))]})}},47101:(e,s,t)=>{t.d(s,{l:()=>l});var r=t(24362),a=t(22692),o=t(75859);const n=(0,r.cn)("ydb-table-with-controls-layout"),l=e=>{let{children:s,className:t}=e;return(0,o.jsx)("div",{className:n(null,t),children:s})};l.Controls=function(e){let{children:s,className:t}=e;return(0,o.jsx)("div",{className:n("controls-wrapper"),children:(0,o.jsx)("div",{className:n("controls",t),children:s})})},l.Table=function(e){let{children:s,loading:t,className:r}=e;return t?(0,o.jsx)(a.h,{className:n("loader")}):(0,o.jsx)("div",{className:n("table",r),children:s})}},43989:(e,s,t)=>{t.d(s,{X:()=>n});var r=t(79734),a=t(51688),o=t(75859);const n=e=>{let{value:s,onChange:t,className:n}=e;return(0,o.jsxs)(r.E,{value:s,onUpdate:t,className:n,children:[(0,o.jsx)(r.E.Option,{value:a.Uu.All,children:a.qU[a.Uu.All]}),(0,o.jsx)(r.E.Option,{value:a.Uu.SmallUptime,children:a.qU[a.Uu.SmallUptime]})]})}},80816:(e,s,t)=>{t.d(s,{a:()=>l});var r=t(14979),a=t(24362),o=t(75859);const n=(0,a.cn)("ydb-usage-label");function l(e){let{value:s,overloadThreshold:t=90,theme:a,...l}=e;return(0,o.jsxs)(r._,{theme:a,className:n({overload:Number(s)>=t}),...l,children:[s||0,"%"]})}},79255:(e,s,t)=>{t.d(s,{c:()=>j});var r=t(34301),a=t(92666),o=t(68963),n=t(24362),l=t(75859);const i=(0,n.cn)("stack"),d=e=>{let{children:s,className:t}=e;return(0,l.jsx)("div",{className:i(null,t),children:o.Children.map(s,((e,s)=>o.isValidElement(e)?(0,l.jsx)("div",{className:i("layer"),style:{"--ydb-stack-level":s},children:e}):null))})};var u=t(92398),c=t(54665),m=t(17880),p=t(5922),h=t(1796),v=t(74170),g=t(44920),N=t(14979),b=t(75850),k=t(52317),D=t(55850),S=t(62206),w=t(40073);const y=(0,n.cn)("vdisk-storage-popup"),f=e=>{let{data:s,nodes:t,...n}=e;const i=(0,a.Iz)(s),d=o.useMemo((()=>i?(e=>{var s,t,a,o;const{VDiskId:n,VDiskState:l,SatisfactionRank:i,DiskSpace:d,FrontQueues:u,Replicated:c,UnsyncedVDisks:m,AllocatedSize:p,ReadThroughput:h,WriteThroughput:v,StoragePoolName:g}=e,N=[{label:"VDisk",value:(0,r.a2)(n)},{label:"State",value:null!==l&&void 0!==l?l:"not available"}];var k,S;return g&&N.push({label:"StoragePool",value:g}),i&&(null===(s=i.FreshRank)||void 0===s?void 0:s.Flag)!==b.K.Green&&N.push({label:"Fresh",value:null===(k=i.FreshRank)||void 0===k?void 0:k.Flag}),i&&(null===(t=i.LevelRank)||void 0===t?void 0:t.Flag)!==b.K.Green&&N.push({label:"Level",value:null===(S=i.LevelRank)||void 0===S?void 0:S.Flag}),i&&null!==(a=i.FreshRank)&&void 0!==a&&a.RankPercent&&N.push({label:"Fresh",value:i.FreshRank.RankPercent}),i&&null!==(o=i.LevelRank)&&void 0!==o&&o.RankPercent&&N.push({label:"Level",value:i.LevelRank.RankPercent}),d&&d!==b.K.Green&&N.push({label:"Space",value:d}),u&&u!==b.K.Green&&N.push({label:"FrontQueues",value:u}),c||N.push({label:"Replicated",value:"NO"}),m&&N.push({label:"UnsyncVDisks",value:m}),Number(p)&&N.push({label:"Allocated",value:(0,D.Uz)(p)}),Number(h)&&N.push({label:"Read",value:(0,D.Qt)(h)}),Number(v)&&N.push({label:"Write",value:(0,D.Qt)(v)}),N})(s):(e=>{const{NodeId:s,PDiskId:t,VSlotId:r,StoragePoolName:a}=e,o=[{label:"State",value:"not available"}];return a&&o.push({label:"StoragePool",value:a}),o.push({label:"NodeId",value:null!==s&&void 0!==s?s:k.jX},{label:"PDiskId",value:null!==t&&void 0!==t?t:k.jX},{label:"VSlotId",value:null!==r&&void 0!==r?r:k.jX}),o})(s)),[s,i]),u=o.useMemo((()=>i&&s.PDisk&&(0,w.b)(s.PDisk,t)),[s,t,i]);return(0,l.jsxs)(g.G,{contentClassName:y(),placement:["top","bottom"],hasArrow:!0,offset:[0,12],...n,children:[s.DonorMode&&(0,l.jsx)(N._,{className:y("donor-label"),children:"Donor"}),(0,l.jsx)(S._P,{title:"VDisk",info:d,size:"s"}),u&&(0,l.jsx)(S._P,{title:"PDisk",info:u,size:"s"})]})},x=(0,n.cn)("ydb-vdisk-component"),I=e=>{let{data:s={},nodes:t,compact:n,inactive:i,showPopup:d,onShowPopup:g,onHidePopup:N,progressBarClassName:b}=e;const k=(0,a.Iz)(s),D=(0,m.X_)(),[S,w]=o.useState(!1),y=o.useRef(null);let I;return D&&(0,p.D)(s.VDiskSlotId)&&(0,p.D)(s.PDiskId)&&(0,p.D)(s.NodeId)?I=(0,c.By)(s.VDiskSlotId,s.PDiskId,s.NodeId):(0,p.D)(s.NodeId)&&k&&(I=(0,c.ax)(c.ZP.node,{id:s.NodeId,activeTab:u.pV},{pdiskId:s.PDiskId,vdiskId:(0,r.a2)(s.VDiskId)})),(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)("div",{className:x(),ref:y,onMouseEnter:()=>{w(!0),null===g||void 0===g||g()},onMouseLeave:()=>{w(!1),null===N||void 0===N||N()},children:(0,l.jsx)(v.h,{to:I,className:x("content"),children:(0,l.jsx)(h.p,{diskAllocatedPercent:s.AllocatedPercent,severity:s.Severity,compact:n,inactive:i,className:b})})}),(0,l.jsx)(f,{data:s,nodes:t,anchorRef:y,open:S||d})]})};function j(e){let{data:s,className:t,stackClassName:o,...n}=e;const i=null===s||void 0===s?void 0:s.Donors,u=i&&i.length>0?(0,l.jsxs)(d,{className:o,children:[(0,l.jsx)(I,{data:s,...n}),i.map((e=>{const s=(0,a.Iz)(e);return(0,l.jsx)(I,{data:e,...n},(0,r.a2)(s?e.VDiskId:e))}))]}):(0,l.jsx)(I,{data:s,...n});return(0,l.jsx)("div",{className:t,children:u})}},54997:(e,s,t)=>{t.d(s,{P3:()=>d,xv:()=>i,Pr:()=>c,t5:()=>n,pM:()=>l,nn:()=>u});var r=t(30817);const a=JSON.parse('{"node-id":"Node Id","host":"Host","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Memory","cpu":"CPU","tablets":"Tablets","load-average":"Load Average","load":"Load","process":"Process","caches":"Caches","sessions":"Sessions"}'),o=(0,r.wZ)("ydb-nodes-columns",{en:a}),n="nodesTableColumnsWidth",l="nodesTableSelectedColumns",i={NodeId:"NodeId",Host:"Host",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",CPU:"CPU",LoadAverage:"LoadAverage",Tablets:"Tablets",TopNodesLoadAverage:"TopNodesLoadAverage",TopNodesMemory:"TopNodesMemory",SharedCacheUsage:"SharedCacheUsage",TotalSessions:"TotalSessions"},d=["NodeId","Host","DC","Rack","Version","Uptime","Memory","CPU","LoadAverage","Tablets"],u=["NodeId"],c={get NodeId(){return o("node-id")},get Host(){return o("host")},get DC(){return o("dc")},get Rack(){return o("rack")},get Version(){return o("version")},get Uptime(){return o("uptime")},get Memory(){return o("memory")},get CPU(){return o("cpu")},get LoadAverage(){return o("load-average")},get Tablets(){return o("tablets")},get TopNodesLoadAverage(){return o("load")},get TopNodesMemory(){return o("process")},get SharedCacheUsage(){return o("caches")},get TotalSessions(){return o("sessions")}}},59625:(e,s,t)=>{t.d(s,{y:()=>c});var r=t(17176),a=t(79023),o=t(56350),n=t(30817);const l=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),i=JSON.parse('{"default_message":"\u0412\u0441\u0451 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435!","default_button_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"}'),d=(0,n.wZ)("ydb-storage-empty-filter",{ru:i,en:l});var u=t(75859);const c=e=>{let{title:s,message:t=d("default_message"),showAll:n=d("default_button_label"),onShowAll:l}=e;return(0,u.jsx)(a.u,{image:(0,u.jsx)(o.Q,{name:"thumbsUp"}),position:"left",title:s,description:t,actions:l&&[(0,u.jsx)(r.z,{onClick:l,children:n},"show-all")]})}},17931:(e,s,t)=>{t.d(s,{l:()=>g});var r=t(68963),a=t(1796),o=t(74170),n=t(40073),l=t(79255),i=t(54665),d=t(17880),u=t(5922),c=t(24362),m=t(34301),p=t(92398),h=t(75859);const v=(0,c.cn)("pdisk-storage"),g=e=>{let{data:s={},vDisks:t,inactiveVdisks:c,showPopup:g,onShowPopup:N,onHidePopup:b,className:k,progressBarClassName:D}=e;const[S,w]=r.useState(!1),y=(0,d.X_)(),f=r.useRef(null),{NodeId:x,PDiskId:I}=s,j=(0,u.D)(x)&&(0,u.D)(I);let P;return j&&(P=(0,i.ax)(i.ZP.node,{id:x,activeTab:p.pV},{pdiskId:I})),j&&y&&(P=(0,i.ds)(I,x)),(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:v(null,k),ref:f,children:[null!==t&&void 0!==t&&t.length?(0,h.jsx)("div",{className:v("vdisks"),children:t.map((e=>(0,h.jsx)("div",{className:v("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,h.jsx)(l.c,{data:e,inactive:null===c||void 0===c?void 0:c.includes(e),stackClassName:v("donors-stack"),compact:!0})},(0,m.a2)(e.VDiskId))))}):null,(0,h.jsxs)(o.h,{to:P,className:v("content"),onMouseEnter:()=>{w(!0),null===N||void 0===N||N()},onMouseLeave:()=>{w(!1),null===b||void 0===b||b()},children:[(0,h.jsx)(a.p,{diskAllocatedPercent:s.AllocatedPercent,severity:s.Severity,className:D}),(0,h.jsx)("div",{className:v("media-type"),children:s.Type})]})]}),(0,h.jsx)(n.J,{data:s,anchorRef:f,open:S||g})]})}},45578:(e,s,t)=>{t.d(s,{K:()=>z});var r=t(68963),a=t(52846),o=t(86969),n=t(1440),l=t(26688),i=t(47101),d=t(17880),u=t(77915),c=t(95829),m=t(15106),p=t(14223);const h=e=>e.trim().toLowerCase(),v=(e,s)=>{const t=h(s);return t?e.filter((e=>{var s,r;return(null===(s=e.NodeId)||void 0===s?void 0:s.toString().includes(t))||(null===(r=e.Host)||void 0===r?void 0:r.toLowerCase().includes(t))})):e},g=(e,s)=>{const t=h(s);return t?e.filter((e=>{var s,r;return(null===(s=e.PoolName)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(r=e.GroupId)||void 0===r?void 0:r.toString().includes(t))})):e},N=(e,s)=>Array.isArray(s)&&0!==s.length?e.filter((e=>{const t=e.Usage;return s.some((e=>Number(e)<=t&&t<Number(e)+5))})):e;var b=t(33058),k=t(30553),D=t(5922),S=t(52317),w=t(17096),y=t(51688),f=t(41616),x=t(93856),I=t(2098),j=t(64782),P=t(51323),C=t(43817),G=t(75859);function R(e){let{data:s,columns:t,tableSettings:r,visibleEntities:a,onShowAll:o,sort:n,handleSort:l}=e;return s.length||a===c.G.all?(0,G.jsx)(I.G,{columnsWidthLSKey:P.Ty,data:s,columns:t,settings:r,emptyDataMessage:(0,C.Z)("empty.default"),sortOrder:n,onSort:l},a):(0,G.jsx)(j.a,{onShowAll:o,visibleEntities:a})}var E=t(46393),U=t(64682),T=t(55434),V=t(73790),L=t(20108);function O(e){let{data:s,columns:t,tableSettings:r,visibleEntities:a,nodesUptimeFilter:o,sort:n,onShowAll:l,handleSort:i}=e;return s.length||a===c.G.all&&o===y.Uu.All?(0,G.jsx)(I.G,{columnsWidthLSKey:T.Wj,data:s,columns:t,settings:{...r,dynamicRenderType:"variable"},emptyDataMessage:(0,V.Z)("empty.default"),rowClassName:L.q,sortOrder:n,onSort:i},a):(0,G.jsx)(U.r,{visibleEntities:a,nodesUptimeFilter:o,onShowAll:l})}var M=t(24733),A=t(77643),F=t(10703);const _=(0,a.withDefault)({encode:a.ArrayParam.encode,decode:e=>null===e||void 0===e?e:Array.isArray(e)?e.filter(Boolean):e?[e]:[]},[]),z=e=>{var s;let{database:t,nodeId:h,groupId:I,pDiskId:j}=e;const{balancer:P}=(0,u.kW)(),{additionalNodesProps:C}=(0,f.f)({balancer:P}),U=(0,d.rU)(),T=(0,d.tS)(),[V]=(0,w.Rj)(),[L,z]=(0,a.useQueryParams)({type:a.StringParam,visible:a.StringParam,search:a.StringParam,uptimeFilter:a.StringParam,usageFilter:_}),Z=k.Y.parse(L.type),H="groups"===Z,W="nodes"===Z,K=k.z.parse(L.visible),J=null!==(s=L.search)&&void 0!==s?s:"",Q=y.U8.parse(L.uptimeFilter),Y=L.usageFilter,[$,B]=r.useState({sortOrder:void 0,sortValue:void 0}),q=$.sortValue?$:F.TP,[X,ee]=r.useState({sortOrder:void 0,sortValue:void 0}),se=X.sortOrder?X:(0,F._r)(K),{columnsToShow:te,columnsToSelect:re,setColumns:ae}=(0,M.i)({additionalNodesProps:C,visibleEntities:K,database:t,groupId:null===I||void 0===I?void 0:I.toString()}),{columnsToShow:oe,columnsToSelect:ne,setColumns:le}=(0,E.k)(K),ie=b.y.useGetStorageNodesInfoQuery({database:t,with:K,node_id:h,group_id:(0,D.D)(h)?void 0:I},{skip:!W,pollingInterval:V}),de=b.y.useGetStorageGroupsInfoQuery({database:t,with:K,nodeId:h,groupId:I,pDiskId:j,shouldUseGroupsHandler:T},{skip:!H||!U,pollingInterval:V}),{currentData:ue,isFetching:ce,error:me}=W?ie:de,{currentData:{nodes:pe=[]}={}}=ie,{currentData:{groups:he=[]}={}}=de,{nodes:ve,groups:ge,...Ne}=null!==ue&&void 0!==ue?ue:{found:0,total:0},be=void 0===ue&&ce,ke=r.useMemo((()=>function(e,s,t){let r=e||[];return r=v(r,s),r=(0,p.f)(r,t),r}(pe,J,Q)),[J,pe,Q]),De=r.useMemo((()=>function(e,s,t){let r=e||[];return r=g(r,s),r=N(r,t),r}(he,J,Y)),[J,he,Y]),Se=r.useMemo((()=>function(e){const s={};return null===e||void 0===e||e.forEach((e=>{const t=(0,m.I)(e,5);Object.prototype.hasOwnProperty.call(s,t)||(s[t]=0),s[t]+=1})),Object.entries(s).map((e=>{let[s,t]=e;return{threshold:Number(s),count:t}})).sort(((e,s)=>s.threshold-e.threshold))}(he)),[he]),[we,ye]=(0,w.sC)(q,(e=>B(e))),[fe,xe]=(0,w.sC)(se,(e=>ee(e))),Ie=e=>{z({usageFilter:e.length?e:void 0},"replaceIn")},je=e=>{z({search:e||void 0},"replaceIn")},Pe=e=>{z({visible:e},"replaceIn")},Ce=e=>{z({type:e},"replaceIn")},Ge=e=>{z({uptimeFilter:e},"replaceIn")},Re=()=>{Pe(c.G.all),Ge(y.Uu.All)};return(0,n.u)(me)?(0,G.jsx)(o.J,{position:"left"}):(0,G.jsxs)(i.l,{children:[(0,G.jsx)(i.l.Controls,{children:(()=>{const e=H?De.length:ke.length,s=H?ne:re,t=H?le:ae;return(0,G.jsx)(x.m,{searchValue:J,handleSearchValueChange:je,withTypeSelector:!0,storageType:Z,handleStorageTypeChange:Ce,visibleEntities:K,handleVisibleEntitiesChange:Pe,nodesUptimeFilter:Q,handleNodesUptimeFilterChange:Ge,groupsUsageFilter:Y,groupsUsageFilterOptions:Se,handleGroupsUsageFilterChange:Ie,entitiesCountCurrent:e,entitiesCountTotal:Ne.total,entitiesLoading:be,columnsToSelect:s,handleSelectedColumnsUpdate:t})})()}),me?(0,G.jsx)(l.V,{error:me}):null,(0,G.jsx)(i.l.Table,{loading:be||!U,className:(0,A.b)("table"),children:ue?(0,G.jsxs)(r.Fragment,{children:[H?(0,G.jsx)(R,{visibleEntities:K,data:De,tableSettings:S.LE,onShowAll:()=>Pe(c.G.all),sort:fe,handleSort:xe,columns:oe},"groups"):null,W?(0,G.jsx)(O,{visibleEntities:K,nodesUptimeFilter:Q,data:ke,tableSettings:S.LE,onShowAll:Re,sort:we,handleSort:ye,columns:te},"nodes"):null]}):null})]})}},93856:(e,s,t)=>{t.d(s,{m:()=>C});var r=t(68963),a=t(48857),o=t(49201),n=t(30629),l=t(43989),i=t(95829),d=t(79734),u=t(75859);const c={[i.d.groups]:"Groups",[i.d.nodes]:"Nodes"},m=e=>{let{value:s,onChange:t}=e;return(0,u.jsxs)(d.E,{value:s,onUpdate:t,qa:"storage-type-filter",children:[(0,u.jsx)(d.E.Option,{value:i.d.groups,children:c[i.d.groups]}),(0,u.jsx)(d.E.Option,{value:i.d.nodes,children:c[i.d.nodes]})]})},p={[i.G.all]:"All",[i.G.missing]:"Degraded",[i.G.space]:"Out of Space"},h=e=>{let{value:s,onChange:t}=e;return(0,u.jsxs)(d.E,{value:s,onUpdate:t,qa:"storage-visible-entities-filter",children:[(0,u.jsx)(d.E.Option,{value:i.G.missing,children:p[i.G.missing]}),(0,u.jsx)(d.E.Option,{value:i.G.space,children:p[i.G.space]}),(0,u.jsx)(d.E.Option,{value:i.G.all,children:p[i.G.all]})]})};var v=t(2418),g=t(69214),N=t(24362),b=t(10703),k=t(30817);const D=JSON.parse('{"label":"Usage:","default_value":"Any","groups_count":["{{count}} group","{{count}} groups","{{count}} groups","No groups"]}'),S=JSON.parse('{"label":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435:","default_value":"\u041b\u044e\u0431\u043e\u0435","groups_count":["{{count}} \u0433\u0440\u0443\u043f\u043f\u0430","{{count}} \u0433\u0440\u0443\u043f\u043f\u044b","{{count}} \u0433\u0440\u0443\u043f\u043f","\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f"]}'),w=(0,k.wZ)("ydb-usage-filter",{ru:S,en:D}),y=(0,N.cn)("usage-filter"),f=e=>{const{className:s,value:t=[],groups:a=[],onChange:o,debounce:n=200}=e,[l,i]=r.useState(t),d=r.useRef();r.useEffect((()=>{i((e=>e.join(",")!==t.join(",")?t:e))}),[t]);const c=r.useMemo((()=>a.map((e=>{let{threshold:s,count:t}=e;return{value:String(s),text:`${s}%`,data:{count:t}}}))),[a]),m=Math.max(...a.map((e=>{let{count:s}=e;return s})));return(0,u.jsx)(v.P,{className:y(null,s),label:w("label"),value:l,placeholder:w("default_value"),options:c,multiple:!0,onUpdate:e=>{i(e),window.clearTimeout(d.current),d.current=window.setTimeout((()=>{null===o||void 0===o||o(e)}),n)},renderOption:e=>{let{value:s,data:t,text:r}=e;return(0,u.jsxs)("div",{className:y("option"),children:[(0,u.jsx)(g.A,{className:y("option-title"),status:(0,b.CZ)(Number(s)),name:r,size:"xs"}),(0,u.jsxs)("div",{className:y("option-meta"),children:[w("groups_count",{count:t.count}),(0,u.jsx)("div",{className:y("option-bar"),style:{width:t.count/m*100+"%"}})]})]})},getOptionHeight:()=>50,popupWidth:280,disabled:0===a.length})},x=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN"}'),I=JSON.parse('{"groups":"\u0413\u0440\u0443\u043f\u043f\u044b","nodes":"\u041d\u043e\u0434\u044b","controls_groups-search-placeholder":"ID \u0433\u0440\u0443\u043f\u043f\u044b, \u0438\u043c\u044f \u043f\u0443\u043b\u0430","controls_nodes-search-placeholder":"ID \u0443\u0437\u043b\u0430, FQDN"}'),j=(0,k.wZ)("ydb-storage",{ru:I,en:x});var P=t(77643);const C=e=>{let{searchValue:s,handleSearchValueChange:t,withTypeSelector:d,storageType:c,handleStorageTypeChange:p,visibleEntities:v,handleVisibleEntitiesChange:g,nodesUptimeFilter:N,handleNodesUptimeFilterChange:b,withGroupsUsageFilter:k,groupsUsageFilter:D,groupsUsageFilterOptions:S,handleGroupsUsageFilterChange:w,entitiesCountCurrent:y,entitiesCountTotal:x,entitiesLoading:I,columnsToSelect:C,handleSelectedColumnsUpdate:G}=e;const R=c===i.d.nodes,E=c===i.d.groups,U=j(R?"nodes":"groups");return(0,u.jsxs)(r.Fragment,{children:[(0,u.jsx)(n.o,{value:s,onChange:t,placeholder:j(R?"controls_nodes-search-placeholder":"controls_groups-search-placeholder"),className:(0,P.b)("search")}),d&&(0,u.jsx)(m,{value:c,onChange:p}),(0,u.jsx)(h,{value:v,onChange:g}),R&&(0,u.jsx)(l.X,{value:N,onChange:b}),E&&k&&(0,u.jsx)(f,{value:D,onChange:w,groups:S}),(0,u.jsx)(o.C,{label:U,loading:I,total:x,current:y}),(0,u.jsx)(a.N,{popupWidth:200,items:C,showStatus:!0,onUpdate:G,sortable:!1})]})}},64782:(e,s,t)=>{t.d(s,{a:()=>l});var r=t(95829),a=t(59625),o=t(43817),n=t(75859);const l=e=>{let s,{visibleEntities:t,onShowAll:l}=e;return t===r.G.space&&(s=(0,o.Z)("empty.out_of_space")),t===r.G.missing&&(s=(0,o.Z)("empty.degraded")),s?(0,n.jsx)(a.y,{title:s,showAll:(0,o.Z)("show_all"),onShowAll:l}):null}},6130:(e,s,t)=>{t.d(s,{V:()=>H,m:()=>Z});var r=t(68963),a=t(71549),o=t(19812),n=t(10502),l=t(14979),i=t(68330),d=t(88776),u=t(99683),c=t(69214),m=t(74170),p=t(80816),h=t(79255),v=t(54665),g=t(24362),N=t(34301),b=t(15106),k=t(55850),D=t(92666),S=t(17931),w=t(75859);const y=(0,g.cn)("ydb-storage-disks");function f(e){let{vDisks:s=[],nodes:t}=e;const[a,o]=r.useState();return s.length?(0,w.jsxs)("div",{className:y(null),children:[(0,w.jsx)("div",{className:y("vdisks-wrapper"),children:null===s||void 0===s?void 0:s.map((e=>(0,w.jsx)(x,{vDisk:e,nodes:t,highlightedVDisk:a,setHighlightedVDisk:o},(0,N.a2)(e.VDiskId))))}),(0,w.jsx)("div",{className:y("pdisks-wrapper"),children:null===s||void 0===s?void 0:s.map((e=>{var s;return(0,w.jsx)(I,{vDisk:e,nodes:t,highlightedVDisk:a,setHighlightedVDisk:o},(0,D.CH)(e.NodeId,null===e||void 0===e||null===(s=e.PDisk)||void 0===s?void 0:s.PDiskId))}))})]}):null}function x(e){let{nodes:s,vDisk:t,highlightedVDisk:r,setHighlightedVDisk:a}=e;const o={...t,PDisk:void 0},n=(0,N.a2)(t.VDiskId);return(0,w.jsx)("div",{style:{flexGrow:Number(t.AllocatedSize)||1},className:y("vdisk-item"),children:(0,w.jsx)(h.c,{data:o,nodes:s,compact:!0,showPopup:r===n,onShowPopup:()=>a(n),onHidePopup:()=>a(void 0),progressBarClassName:y("vdisk-progress-bar")})})}function I(e){let{vDisk:s,highlightedVDisk:t,setHighlightedVDisk:r}=e;const a=(0,N.a2)(s.VDiskId);return s.PDisk?(0,w.jsx)(S.l,{className:y("pdisk-item"),progressBarClassName:y("pdisk-progress-bar"),data:s.PDisk,showPopup:t===a,onShowPopup:()=>r(a),onHidePopup:()=>r(void 0)}):null}var j=t(10703),P=t(43817),C=t(51323);const G=(0,g.cn)("ydb-storage-groups-columns"),R={name:C.tn.PoolName,header:C.G0.PoolName,width:250,render:e=>{var s;let{row:t}=e;const r=null===(s=t.PoolName)||void 0===s?void 0:s.split("/");return r&&(0,w.jsx)(u.l,{wrapperClassName:G("pool-name-wrapper"),content:t.PoolName,placement:["right"],behavior:n.x.Immediate,children:r[r.length-1]})},align:o.ZP.LEFT},E={name:C.tn.MediaType,header:C.G0.MediaType,width:100,resizeMinWidth:100,align:o.ZP.LEFT,render:e=>{let{row:s}=e;return(0,w.jsxs)(r.Fragment,{children:[(0,w.jsx)(l._,{children:s.MediaType||"\u2014"}),"\xa0",s.Encryption&&(0,w.jsx)(i.J,{content:(0,P.Z)("encrypted"),placement:"right",behavior:n.x.Immediate,children:(0,w.jsx)(l._,{children:(0,w.jsx)(d.J,{data:a.Z,size:18})})})]})},sortable:!1},U={name:C.tn.Erasure,header:C.G0.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:e=>{let{row:s}=e;return s.ErasureSpecies?s.ErasureSpecies:"-"},align:o.ZP.LEFT},T={name:C.tn.Degraded,header:C.G0.Degraded,width:110,resizeMinWidth:110,render:e=>{let{row:s}=e;return s.Degraded?(0,w.jsxs)(l._,{theme:(0,j._O)(s),children:["Degraded: ",s.Degraded]}):"-"},align:o.ZP.LEFT,defaultOrder:o.ZP.DESCENDING},V={name:C.tn.Usage,header:C.G0.Usage,width:75,resizeMinWidth:75,render:e=>{let{row:s}=e;return s.Limit?(0,w.jsx)(p.a,{value:s.Usage,theme:(0,j.YC)(s.Usage)}):"-"},sortAccessor:e=>e.Limit?e.Usage:null,align:o.ZP.LEFT},L={name:C.tn.GroupId,header:C.G0.GroupId,width:130,render:e=>{let{row:s}=e;return s.GroupId?(0,w.jsx)(m.h,{className:G("group-id"),to:(0,v.Uu)(s.GroupId),children:s.GroupId}):"-"},sortAccessor:e=>Number(e.GroupId),align:o.ZP.RIGHT},O={name:C.tn.Used,header:C.G0.Used,width:100,render:e=>{let{row:s}=e;return(0,k.Uz)(s.Used,!0)},align:o.ZP.RIGHT},M={name:C.tn.Limit,header:C.G0.Limit,width:100,render:e=>{let{row:s}=e;return(0,k.Uz)(s.Limit)},align:o.ZP.RIGHT},A={name:C.tn.DiskSpace,header:C.G0.DiskSpace,width:110,render:e=>{let{row:s}=e;return(0,w.jsx)(c.A,{status:s.DiskSpace})},align:o.ZP.CENTER},F={name:C.tn.Read,header:C.G0.Read,width:100,render:e=>{let{row:s}=e;return s.Read?(0,k.Qt)(s.Read):"-"},align:o.ZP.RIGHT},_={name:C.tn.Write,header:C.G0.Write,width:100,render:e=>{let{row:s}=e;return s.Write?(0,k.Qt)(s.Write):"-"},align:o.ZP.RIGHT},z=e=>({name:C.tn.VDisksPDisks,header:C.G0.VDisksPDisks,className:G("disks-column"),render:s=>{let{row:t}=s;return(0,w.jsx)(f,{vDisks:t.VDisks,nodes:e})},align:o.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),Z=()=>[L,E,U,V,O,M].map((e=>({...e,sortable:!1}))),H=e=>{var s;return[L,R,E,U,T,V,O,M,A,F,_,(s=null===e||void 0===e?void 0:e.nodes,{name:C.tn.VDisks,header:C.G0.VDisks,className:G("vdisks-column"),render:e=>{var t;let{row:r}=e;return(0,w.jsx)("div",{className:G("vdisks-wrapper"),children:null===(t=r.VDisks)||void 0===t?void 0:t.map((e=>(0,w.jsx)(h.c,{data:e,nodes:s,className:G("vdisks-item")},(0,N.a2)(e.VDiskId))))})},align:o.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),z(null===e||void 0===e?void 0:e.nodes)].map((e=>({...e,sortable:(0,b.P)(e.name)})))}},51323:(e,s,t)=>{t.d(s,{nu:()=>d,Rt:()=>u,tn:()=>i,G0:()=>c,Ty:()=>n,j0:()=>l});var r=t(30817);const a=JSON.parse('{"pool-name":"Pool Name","type":"Type","erasure":"Erasure","degraded":"Degraded","usage":"Usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}'),o=(0,r.wZ)("ydb-storage-groups-columns",{en:a}),n="storageGroupsColumnsWidth",l="storageGroupsSelectedColumns",i={GroupId:"GroupId",PoolName:"PoolName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",Degraded:"Degraded"},d=["GroupId","PoolName","MediaType","Erasure","Used","Limit","Usage","Read","Write","VDisks"],u=["GroupId"],c={get PoolName(){return o("pool-name")},get MediaType(){return o("type")},get Erasure(){return o("erasure")},get GroupId(){return o("group-id")},get Used(){return o("used")},get Limit(){return o("limit")},get Usage(){return o("usage")},get DiskSpace(){return o("space")},get Read(){return o("read")},get Write(){return o("write")},get VDisks(){return o("vdisks")},get VDisksPDisks(){return o("vdisks-pdisks")},get Degraded(){return o("degraded")}}},46393:(e,s,t)=>{t.d(s,{k:()=>u});var r=t(68963),a=t(99337),o=t(95829),n=t(17096),l=t(57344),i=t(6130),d=t(51323);function u(e){const s=function(){const e=(0,n.ix)(a.d);return r.useMemo((()=>(0,i.V)({nodes:e})),[e])}(),t=r.useMemo((()=>e===o.G.missing?[...d.Rt,d.tn.Degraded]:e===o.G.space?[...d.Rt,d.tn.DiskSpace]:d.Rt),[e]);return(0,l.N)(s,d.j0,d.G0,d.nu,t)}},43817:(e,s,t)=>{t.d(s,{Z:()=>n});var r=t(30817);const a=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),o=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),n=(0,r.wZ)("ydb-storage-groups",{ru:o,en:a})},64682:(e,s,t)=>{t.d(s,{r:()=>i});var r=t(95829),a=t(51688),o=t(59625),n=t(73790),l=t(75859);const i=e=>{let s,{visibleEntities:t,nodesUptimeFilter:i,onShowAll:d}=e;return t===r.G.space&&(s=(0,n.Z)("empty.out_of_space")),t===r.G.missing&&(s=(0,n.Z)("empty.degraded")),i===a.Uu.SmallUptime&&(s=(0,n.Z)("empty.small_uptime")),t!==r.G.all&&i!==a.Uu.All&&(s=(0,n.Z)("empty.several_filters")),s?(0,l.jsx)(o.y,{title:s,showAll:(0,n.Z)("show_all"),onShowAll:d}):null}},55434:(e,s,t)=>{t.d(s,{wn:()=>d,ae:()=>u,rC:()=>i,NU:()=>c,Wj:()=>n,rm:()=>l});var r=t(30817);const a=JSON.parse('{"nodes-id":"Node ID","host":"Host","dc":"DC","rack":"Rack","uptime":"Uptime","missing":"Missing","pdisks":"PDisks"}'),o=(0,r.wZ)("ydb-storage-nodes-columns",{en:a}),n="storageNodesColumnsWidth",l="storageNodesSelectedColumns",i={NodeId:"NodeId",Host:"Host",DC:"DC",Rack:"Rack",Uptime:"Uptime",PDisks:"PDisks",Missing:"Missing"},d=["NodeId","Host","DC","Rack","Uptime","PDisks"],u=["NodeId"],c={get NodeId(){return o("nodes-id")},get Host(){return o("host")},get DC(){return o("dc")},get Rack(){return o("rack")},get Uptime(){return o("uptime")},get PDisks(){return o("pdisks")},get Missing(){return o("missing")}}},24733:(e,s,t)=>{t.d(s,{i:()=>g});var r=t(68963),a=t(95829),o=t(57344),n=t(19812),l=t(89778),i=t(24362),d=t(52317),u=t(51688),c=t(17931),m=t(55434),p=t(75859);const h=(0,i.cn)("ydb-storage-nodes-columns"),v=e=>{let{additionalNodesProps:s,database:t,groupId:r}=e;const a=((e,s,t)=>{const r=null===e||void 0===e?void 0:e.getNodeRef;return[{name:m.rC.NodeId,header:m.NU.NodeId,width:100,align:n.ZP.RIGHT,render:e=>{let{row:s}=e;return s.NodeId}},{name:m.rC.Host,header:m.NU.Host,width:350,render:e=>{let{row:t}=e;return(0,p.jsx)(l.k,{node:t,getNodeRef:r,database:s})},align:n.ZP.LEFT},{name:m.rC.DC,header:m.NU.DC,width:100,render:e=>{let{row:s}=e;return s.DC||d.jX},align:n.ZP.LEFT},{name:m.rC.Rack,header:m.NU.Rack,width:100,render:e=>{let{row:s}=e;return s.Rack||"\u2014"},align:n.ZP.LEFT},{name:m.rC.Uptime,header:m.NU.Uptime,width:130,sortAccessor:e=>{let{StartTime:s}=e;return s?-s:0},align:n.ZP.RIGHT,render:e=>{let{row:s}=e;return s.Uptime}},{name:m.rC.Missing,header:m.NU.Missing,width:100,align:n.ZP.CENTER,defaultOrder:n.ZP.DESCENDING,render:e=>{let{row:s}=e;return s.Missing}},{name:m.rC.PDisks,header:m.NU.PDisks,className:h("pdisks-column"),render:e=>{var s;let{row:r}=e;return(0,p.jsx)("div",{className:h("pdisks-wrapper"),children:null===(s=r.PDisks)||void 0===s?void 0:s.map((e=>{var s;const a=null===(s=r.VDisks)||void 0===s?void 0:s.filter((s=>s.PDiskId===e.PDiskId)),o=null===a||void 0===a?void 0:a.filter((e=>{var s;return t&&(null===(s=e.VDiskId)||void 0===s?void 0:s.GroupID)!==Number(t)}));return(0,p.jsx)("div",{className:h("pdisks-item"),children:(0,p.jsx)(c.l,{data:e,vDisks:a,inactiveVdisks:o})},e.PDiskId)}))})},align:n.ZP.CENTER,sortable:!1,width:900,resizeable:!1}]})(s,t,r);return a.map((e=>({...e,sortable:(0,u.oh)(e.name)})))};function g(e){let{visibleEntities:s,database:t,additionalNodesProps:n,groupId:l}=e;const i=r.useMemo((()=>v({database:t,additionalNodesProps:n,groupId:l})),[t,n,l]),d=r.useMemo((()=>s===a.G.missing?[...m.ae,m.rC.Missing]:m.ae),[s]);return(0,o.N)(i,m.rm,m.NU,m.wn,d)}},73790:(e,s,t)=>{t.d(s,{Z:()=>n});var r=t(30817);const a=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),o=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432","empty.out_of_space":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0443\u0437\u043b\u043e\u0432","empty.small_uptime":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432 \u0441 uptime < 1h","empty.several_filters":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0443\u0437\u043b\u044b"}'),n=(0,r.wZ)("ydb-storage-nodes",{ru:o,en:a})},20108:(e,s,t)=>{t.d(s,{q:()=>n});var r=t(24362),a=t(51688);const o=(0,r.cn)("ydb-storage-nodes"),n=e=>o("node",{unavailable:(0,a.TA)(e)})},77643:(e,s,t)=>{t.d(s,{b:()=>r});const r=(0,t(24362).cn)("global-storage")},10703:(e,s,t)=>{t.d(s,{CZ:()=>p,TP:()=>h,YC:()=>m,_O:()=>c,_r:()=>b});var r=t(81413),a=t(95829),o=t(75850),n=t(99106),l=t(54997),i=t(51323);const d=(0,n.p)(1,2,["success","warning","danger"]),u={"block-4-2":(0,n.p)(1,2,["success","warning","danger"]),"mirror-3-dc":(0,n.p)(1,3,["success","warning","danger"])},c=e=>{var s;return(void 0!==(s=e.ErasureSpecies)&&s in u?u[e.ErasureSpecies]:d)(e.Degraded)},m=(0,n.p)(80,85,["success","warning","danger"]),p=(0,n.p)(80,85,[o.K.Green,o.K.Yellow,o.K.Red]),h={sortValue:l.xv.NodeId,sortOrder:r.zE},v={sortValue:i.tn.PoolName,sortOrder:r.zE},g={sortValue:i.tn.Degraded,sortOrder:r.hr},N={sortValue:i.tn.Usage,sortOrder:r.hr};function b(e){return e===a.G.missing?g:e===a.G.space?N:v}},14223:(e,s,t)=>{t.d(s,{A:()=>m,f:()=>u});var r=t(75850),a=t(52317),o=t(34301),n=t(27070),l=t(51688),i=t(80839);const d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(arguments.length>1?arguments[1]:void 0)===i.pu.ALL?e:e.filter((e=>{let{SystemState:s}=e;return s&&s!==r.K.Green}))},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(arguments.length>1?arguments[1]:void 0)===l.Uu.All?e:e.filter((e=>{let{StartTime:s}=e;return!s||(0,o.OW)(s)<a.RQ}))},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0;if(!s)return e;const t=(0,n.Y)(s);return e.filter((e=>!e.Host||(t.test(e.Host)||t.test(String(e.NodeId)))))};function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{uptimeFilter:s,searchValue:t,problemFilter:r}=arguments.length>1?arguments[1]:void 0,a=u(e,s);return a=d(a,r),a=c(a,t),a}},95829:(e,s,t)=>{t.d(s,{G:()=>r,d:()=>a});const r={all:"all",missing:"missing",space:"space"},a={groups:"groups",nodes:"nodes"}},26491:(e,s,t)=>{t.d(s,{R:()=>a});var r=t(92092);async function a(e,s){let{version:t="v2",shouldUseGroupsHandler:a,...o}=e;if(a&&"v1"!==t){const e=await window.api.getStorageGroups({...o},s);return(0,r._u)(e)}{const e=await window.api.getStorageInfo({version:t,...o},s);return(0,r.S9)(e)}}},33058:(e,s,t)=>{t.d(s,{y:()=>n});var r=t(905),a=t(26491),o=t(92092);const n=r.h.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,s)=>{let{signal:t}=s;try{const s=await window.api.getNodes({storage:!0,type:"static",...e},{signal:t});return{data:(0,o.Y2)(s)}}catch(r){return{error:r}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,s)=>{let{signal:t}=s;try{return{data:await(0,a.R)(e,{signal:t})}}catch(r){return{error:r}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},30553:(e,s,t)=>{t.d(s,{Y:()=>n,z:()=>o});var r=t(95408),a=t(95829);const o=r.z.nativeEnum(a.G).catch(a.G.all),n=r.z.nativeEnum(a.d).catch(a.d.groups)},92092:(e,s,t)=>{t.d(s,{S9:()=>v,Y2:()=>h,_u:()=>g});var r=t(21897),a=t(17632),o=t(92666),n=t(3764),l=t(51688),i=t(15106);function d(e){const{DiskSpace:s,VDisks:t=[]}=e;return s||(0,o.b2)(Math.max(...t.map((e=>(0,o.Or)(e.DiskSpace)))))}const u=(e,s)=>{var t;const r=(0,n.w)(e);return{...r,StoragePoolName:s,Donors:null===r||void 0===r||null===(t=r.Donors)||void 0===t?void 0:t.map((e=>({...e,StoragePoolName:s})))}},c=e=>{const{VDisks:s=[],PoolName:t,Usage:r=0,Read:a=0,Write:o=0,Used:n=0,Limit:l=0,Degraded:i=0,Kind:c,MediaType:m,GroupID:p,Overall:h,GroupGeneration:v}=e,g=s.map((e=>u(e,t))),N=Math.floor(100*Number(r)),b=d(e);return{...e,PoolName:t,GroupId:p,MediaType:m||c,VDisks:g,Usage:N,Overall:h,GroupGeneration:v?String(v):void 0,Read:Number(a),Write:Number(o),Used:Number(n),Limit:Number(l),Degraded:Number(i),DiskSpace:b}},m=(e,s)=>{let t=[];return e?t=e.map(c):null===s||void 0===s||s.forEach((e=>{var s;null===(s=e.Groups)||void 0===s||s.forEach((s=>{t.push(((e,s)=>{var t;let o,l=0,c=0,m=0,p=0,h=0;const{Name:v,MediaType:g}=s;if(e.VDisks)for(const i of e.VDisks){const{Replicated:e,VDiskState:s,AvailableSize:t,AllocatedSize:d,PDisk:u,ReadThroughput:v,WriteThroughput:g}=i,{Type:N,State:b,AvailableSize:k}=(0,n.b)(u);e&&b===r.w.Normal&&s===a.H.OK||(l+=1);const D=Number(null!==t&&void 0!==t?t:k)||0,S=Number(d)||0;c+=S,m+=D+S,p+=Number(v)||0,h+=Number(g)||0,o=!N||N!==o&&o?"Mixed":N}const N=null===(t=e.VDisks)||void 0===t?void 0:t.map((e=>u(e,v))),b=(0,i.I)({Used:c,Limit:m},5),k=d(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:N,Usage:b,Read:p,Write:h,PoolName:v,Used:c,Limit:m,Degraded:l,MediaType:g||o||void 0,DiskSpace:k}})(s,e))}))})),t},p=e=>{var s,t,a;const o=(null===(s=e.PDisks)||void 0===s?void 0:s.filter((e=>e.State!==r.w.Normal)).length)||0,i=null===(t=e.PDisks)||void 0===t?void 0:t.map((s=>({...(0,n.b)(s),NodeId:e.NodeId}))),d=null===(a=e.VDisks)||void 0===a?void 0:a.map((s=>({...(0,n.w)(s),NodeId:e.NodeId})));return{...(0,l.Ns)(e.SystemState),NodeId:e.NodeId,PDisks:i,VDisks:d,Missing:o}},h=e=>{const{Nodes:s,TotalNodes:t,FoundNodes:r}=e,a=null===s||void 0===s?void 0:s.map(p);return{nodes:a,total:Number(t)||(null===a||void 0===a?void 0:a.length),found:Number(r)}},v=e=>{const{StoragePools:s,StorageGroups:t,TotalGroups:r,FoundGroups:a}=e,o=m(t,s);return{groups:o,total:Number(r)||o.length,found:Number(a)}};function g(e){const{FoundGroups:s,TotalGroups:t,StorageGroups:r=[]}=e,a=r.map((e=>{const{Usage:s,Read:t,Write:r,Used:a,Limit:o,MissingDisks:l,VDisks:i=[],Overall:u}=e,c=i.map((e=>{var s;const t=e.Whiteboard,r=null===(s=e.PDisk)||void 0===s?void 0:s.Whiteboard,a=e.NodeId,o={...t,PDiskId:null===r||void 0===r?void 0:r.PDiskId,NodeId:a,PDisk:{...r,NodeId:a}};return(0,n.w)(o)})),m=d(e);return{...e,Usage:Math.floor(Number(s))||0,Read:Number(t),Write:Number(r),Used:Number(a),Limit:Number(o),Degraded:Number(l),Overall:u,VDisks:c,DiskSpace:m}}));return{groups:a,total:Number(t)||a.length,found:Number(s)}}},21897:(e,s,t)=>{let r;t.d(s,{w:()=>r}),function(e){e.Initial="Initial",e.InitialFormatRead="InitialFormatRead",e.InitialFormatReadError="InitialFormatReadError",e.InitialSysLogRead="InitialSysLogRead",e.InitialSysLogReadError="InitialSysLogReadError",e.InitialSysLogParseError="InitialSysLogParseError",e.InitialCommonLogRead="InitialCommonLogRead",e.InitialCommonLogReadError="InitialCommonLogReadError",e.InitialCommonLogParseError="InitialCommonLogParseError",e.CommonLoggerInitError="CommonLoggerInitError",e.Normal="Normal",e.OpenFileError="OpenFileError",e.ChunkQuotaError="ChunkQuotaError",e.DeviceIoError="DeviceIoError",e.Missing="Missing",e.Timeout="Timeout",e.NodeDisconnected="NodeDisconnected",e.Unknown="Unknown"}(r||(r={}))},17632:(e,s,t)=>{let r;t.d(s,{H:()=>r}),function(e){e.Initial="Initial",e.LocalRecoveryError="LocalRecoveryError",e.SyncGuidRecovery="SyncGuidRecovery",e.SyncGuidRecoveryError="SyncGuidRecoveryError",e.OK="OK",e.PDiskError="PDiskError"}(r||(r={}))},77072:(e,s,t)=>{t.d(s,{i6:()=>l,mG:()=>n,mr:()=>d,oO:()=>o,s:()=>i,tH:()=>u});var r=t(21897),a=t(17632);const o={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},n=Object.entries(o).reduce(((e,s)=>{let[t,r]=s;return{...e,[r]:t}}),{}),l=o.Grey,i=n[l],d={[a.H.OK]:o.Green,[a.H.Initial]:o.Yellow,[a.H.SyncGuidRecovery]:o.Yellow,[a.H.LocalRecoveryError]:o.Red,[a.H.SyncGuidRecoveryError]:o.Red,[a.H.PDiskError]:o.Red},u={[r.w.Initial]:o.Grey,[r.w.Normal]:o.Green,[r.w.InitialFormatRead]:o.Yellow,[r.w.InitialSysLogRead]:o.Yellow,[r.w.InitialCommonLogRead]:o.Yellow,[r.w.InitialFormatReadError]:o.Red,[r.w.InitialSysLogReadError]:o.Red,[r.w.InitialSysLogParseError]:o.Red,[r.w.InitialCommonLogReadError]:o.Red,[r.w.InitialCommonLogParseError]:o.Red,[r.w.CommonLoggerInitError]:o.Red,[r.w.OpenFileError]:o.Red,[r.w.ChunkQuotaError]:o.Red,[r.w.DeviceIoError]:o.Red}},92666:(e,s,t)=>{t.d(s,{CH:()=>i,FR:()=>d,Iz:()=>o,Or:()=>l,b2:()=>n});var r=t(5922),a=t(77072);function o(e){return"VDiskId"in e}function n(e){return void 0===e?a.s:a.mG[e]||a.s}function l(e){return e?a.oO[e]:0}function i(e,s){if((0,r.D)(e)&&(0,r.D)(s))return`${e}-${s}`}function d(e,s,t){return[e,s,t].join("-")}},3764:(e,s,t)=>{t.d(s,{b:()=>h,w:()=>p});var r=t(75850),a=t(99106),o=t(77072);const n=(0,a.p)(85,95,[r.K.Green,r.K.Yellow,r.K.Red]);function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const t=function(e){return s=e,void 0!==s&&s in o.tH?o.tH[e]:o.i6;var s}(e.State),r=n(s);return t!==o.i6&&r?Math.max(t,o.oO[r]):t}var i=t(92666);function d(e){if(!(0,i.Iz)(e))return o.i6;const{DiskSpace:s,VDiskState:t,FrontQueues:r,Replicated:a,DonorMode:n}=e;if(!t)return o.i6;const l=u(s),d=function(e){var s;if(!e)return o.i6;return null!==(s=o.mr[e])&&void 0!==s?s:o.i6}(t),c=Math.min(o.oO.Orange,u(r));let m=Math.max(l,d,c);return a||n||m!==o.oO.Green||(m=o.oO.Blue),m}function u(e){var s;return e&&null!==(s=o.oO[e])&&void 0!==s?s:o.i6}const c={HDD:"HDD",SSD:"SSD",MVME:"NVME"};function m(e){if(!e)return;const s=function(e,s){const t={};return Object.entries(s).reduce(((s,r)=>{let[a,o]=r;const n=e.length-s,l=n-o;return t[a]=e.substring(l,n)||"0",s+o}),0),t}(BigInt(e).toString(2),{isSolidState:1,kind:55,typeExt:8});if("1"===s.isSolidState)switch(parseInt(s.typeExt,2)){case 0:return c.SSD;case 2:return c.MVME}else if("0"===s.typeExt)return c.HDD}function p(){var e,s,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=a.PDisk?h({...a.PDisk,NodeId:null!==(e=a.PDisk.NodeId)&&void 0!==e?e:a.NodeId}):void 0,n=null!==(s=a.PDiskId)&&void 0!==s?s:null===o||void 0===o?void 0:o.PDiskId,l=Number(null!==(t=a.AvailableSize)&&void 0!==t?t:null===o||void 0===o?void 0:o.AvailableSize),i=Number(a.AllocatedSize),u=i+l,c=Math.round(100*i/u),m=null===(r=a.Donors)||void 0===r?void 0:r.map((e=>p({...e,DonorMode:!0}))),v=d(a);return{...a,PDisk:o,PDiskId:n,Donors:m,Severity:v,TotalSize:u,AllocatedPercent:c}}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{AvailableSize:t,TotalSize:r,Category:a}=e,o=m(a),n=Number(t),i=Number(r),d=i-n,u=Math.round(100*d/i),c=l(e,u);return{...s,...e,Type:o,Severity:c,AllocatedSize:d,AllocatedPercent:u}}},27070:(e,s,t)=>{t.d(s,{A:()=>n,Y:()=>l});var r=t(81413),a=t(43680),o=t.n(a);const n=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.hr)===r.hr?`-${e}`:e},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(o()(e),"i")}},99106:(e,s,t)=>{t.d(s,{p:()=>r});const r=(e,s,t)=>r=>0<=r&&r<e?t[0]:e<=r&&r<s?t[1]:s<=r?t[2]:void 0},57344:(e,s,t)=>{t.d(s,{N:()=>o});var r=t(68963),a=t(18193);const o=(e,s,t,o,n)=>{const[l,i]=r.useState((()=>a.r.readUserSettingsValue(s,o)));return{columnsToShow:r.useMemo((()=>e.filter((e=>l.find((s=>s===e.name))))),[e,l]),columnsToSelect:r.useMemo((()=>e.map((e=>e.name)).map((e=>{const s=null===n||void 0===n?void 0:n.includes(e),r=l.includes(e);return{id:e,title:t[e],selected:s||r,required:s,sticky:s?"start":void 0}}))),[e,t,n,l]),setColumns:r.useCallback((e=>{const t=e.filter((e=>e.selected)).map((e=>e.id));a.r.setUserSettingsValue(s,t),i(t)}),[s])}}},89712:(e,s,t)=>{t.d(s,{M:()=>n});var r=t(68963),a=t(2639),o=t(18193);const n=e=>{const s=r.useCallback((()=>e?o.r.readUserSettingsValue(e,{}):{}),[e]),t=r.useCallback((s=>{e&&o.r.setUserSettingsValue(e,s)}),[e]);return(0,a.M)({saveSizes:t,getSizes:s})}},15106:(e,s,t)=>{t.d(s,{I:()=>r,P:()=>o});const r=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const t=e.Limit?100*e.Used/e.Limit:0;return Math.floor(t/s)*s},a=["PoolName","Kind","MediaType","Erasure","Degraded","Usage","GroupId","Used","Limit","Read","Write"],o=e=>a.includes(e)}}]);