"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([[99796],{3218:(e,t,s)=>{s.d(t,{Ep:()=>g,OH:()=>c,QQ:()=>h,b0:()=>p,k_:()=>u});var r=s(59284),a=s(24600),n=s(7435),o=s(16439),i=s(90182);const l=(0,o.H)(["success","warning","danger"],1,2),d={"block-4-2":(0,o.H)(["success","warning","danger"],1,2),"mirror-3-dc":(0,o.H)(["success","warning","danger"],1,3)},u=e=>{var t;return(void 0!==(t=e.ErasureSpecies)&&t in d?d[e.ErasureSpecies]:l)(e.Degraded)};function c(e,t){var s;let r=!0;return(0,n.f8)(null===(s=e.VDiskId)||void 0===s?void 0:s.GroupID)&&null!==t&&void 0!==t&&t.groupId&&(r&&=String(e.VDiskId.GroupID)===t.groupId),(0,n.f8)(e.NodeId)&&null!==t&&void 0!==t&&t.nodeId&&(r&&=String(e.NodeId)===t.nodeId),(0,n.f8)(e.PDiskId)&&null!==t&&void 0!==t&&t.pDiskId&&(r&&=String(e.PDiskId)===t.pDiskId),(0,n.f8)(e.VDiskSlotId)&&null!==t&&void 0!==t&&t.vDiskSlotId&&(r&&=String(e.VDiskSlotId)===t.vDiskSlotId),r}const m=10;function p(e){return(0,n.f8)(null===e||void 0===e?void 0:e.nodeId)||(0,n.f8)(null===e||void 0===e?void 0:e.pDiskId)||(0,n.f8)(null===e||void 0===e?void 0:e.vDiskSlotId)?1:m}function h(e){return(0,n.f8)(null===e||void 0===e?void 0:e.groupId)||(0,n.f8)(null===e||void 0===e?void 0:e.vDiskSlotId)?1:m}function g(e=[],t){const s=(0,i.N4)(a.K);return r.useMemo((()=>{const r=[];return function(e){return"mirror-3-dc"===e||"mirror-3of4"===e}(t)?(e.forEach(((t,a)=>{var n,o,i;(null===s||void 0===s||null===(n=s.get(Number(null===t||void 0===t?void 0:t.NodeId)))||void 0===n?void 0:n.DC)!==(null===s||void 0===s||null===(o=s.get(Number(null===(i=e[a+1])||void 0===i?void 0:i.NodeId)))||void 0===o?void 0:o.DC)&&r.push(a)})),r):r}),[t,e,s])}},5707:(e,t,s)=>{s.d(t,{A$:()=>o,Km:()=>i,Yh:()=>l,aW:()=>n,iZ:()=>u,qs:()=>d});var r=s(94025),a=s(67375);const n={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},o=Object.entries(n).reduce(((e,[t,s])=>({...e,[s]:t})),{}),i=n.Grey,l=o[i],d={[a.W.OK]:n.Green,[a.W.Initial]:n.Yellow,[a.W.SyncGuidRecovery]:n.Yellow,[a.W.LocalRecoveryError]:n.Red,[a.W.SyncGuidRecoveryError]:n.Red,[a.W.PDiskError]:n.Red},u={[r.t.Normal]:n.Green,[r.t.Initial]:n.Yellow,[r.t.InitialFormatRead]:n.Yellow,[r.t.InitialSysLogRead]:n.Yellow,[r.t.InitialCommonLogRead]:n.Yellow,[r.t.InitialFormatReadError]:n.Red,[r.t.InitialSysLogReadError]:n.Red,[r.t.InitialSysLogParseError]:n.Red,[r.t.InitialCommonLogReadError]:n.Red,[r.t.InitialCommonLogParseError]:n.Red,[r.t.CommonLoggerInitError]:n.Red,[r.t.OpenFileError]:n.Red,[r.t.ChunkQuotaError]:n.Red,[r.t.DeviceIoError]:n.Red,[r.t.Stopped]:n.Red}},7187:(e,t,s)=>{s.d(t,{H7:()=>c,NJ:()=>i,SW:()=>d,XY:()=>u,gh:()=>p,r$:()=>m});var r=s(7435),a=s(54090),n=s(16439),o=s(5707);function i(e){return"VDiskId"in e}const l=(0,n.H)([a.m.Green,a.m.Yellow,a.m.Red]),d=e=>(0,r.f8)(e)?c(l(e)):0;function u(e){return void 0===e?o.Yh:o.A$[e]||o.Yh}function c(e){return e?o.aW[e]:0}function m({nodeId:e,pDiskId:t}){if((0,r.f8)(e)&&(0,r.f8)(t))return`${e}-${t}`}function p(e,t,s){return[e,t,s].join("-")}},8809:(e,t,s)=>{s.d(t,{y:()=>E});var r=s(77506),a=s(88226),n=s(13096),o=s(44294),i=s(59284),l=s(87184),d=s(47665),u=s(92459),c=s(24600),m=s(54090),p=s(7435),h=s(76086),g=s(31684),v=s(7187),f=s(90182),S=s(12888),k=s(41650),y=s(60073),N=s(25196),b=s(96927),x=s(29819),D=s(56839);function w(e){let t;const s=(0,v.NJ)(e)?e.VDiskSlotId:e.VSlotId;if((0,p.f8)(s)&&(0,p.f8)(e.PDiskId)&&(0,p.f8)(e.NodeId))t=(0,u.yX)(s,e.PDiskId,e.NodeId);else if((0,p.f8)(e.NodeId)&&(0,v.NJ)(e)){var r;t=(0,x.vI)(e.NodeId,{pdiskId:null===(r=e.PDiskId)||void 0===r?void 0:r.toString(),vdiskId:(0,D.U9)(e.VDiskId)},"structure")}return t}var I=s(39110),C=s(60712);const P=(0,r.cn)("vdisk-storage-popup"),j=({data:e})=>{const t=(0,v.NJ)(e),s=(0,S.X)(),r=i.useMemo((()=>t?((e,t)=>{var s,r,a,n;const{NodeId:o,PDiskId:i,VDiskSlotId:d,StringifiedId:c,VDiskState:h,SatisfactionRank:v,DiskSpace:f,FrontQueues:S,Replicated:y,UnsyncedVDisks:b,AllocatedSize:x,ReadThroughput:D,WriteThroughput:w,StoragePoolName:P}=e,j=[{label:"VDisk",value:c},{label:"State",value:null!==h&&void 0!==h?h:"not available"}];var A,E;if(P&&j.push({label:"StoragePool",value:P}),v&&(null===(s=v.FreshRank)||void 0===s?void 0:s.Flag)!==m.m.Green&&j.push({label:"Fresh",value:null===(A=v.FreshRank)||void 0===A?void 0:A.Flag}),v&&(null===(r=v.LevelRank)||void 0===r?void 0:r.Flag)!==m.m.Green&&j.push({label:"Level",value:null===(E=v.LevelRank)||void 0===E?void 0:E.Flag}),v&&null!==(a=v.FreshRank)&&void 0!==a&&a.RankPercent&&j.push({label:"Fresh",value:v.FreshRank.RankPercent}),v&&null!==(n=v.LevelRank)&&void 0!==n&&n.RankPercent&&j.push({label:"Level",value:v.LevelRank.RankPercent}),f&&f!==m.m.Green&&j.push({label:"Space",value:f}),S&&S!==m.m.Green&&j.push({label:"FrontQueues",value:S}),!1===y&&j.push({label:"Replicated",value:"NO"}),b&&j.push({label:"UnsyncVDisks",value:b}),Number(x)&&j.push({label:"Allocated",value:(0,k.wb)(x)}),Number(D)&&j.push({label:"Read",value:(0,k.O4)(D)}),Number(w)&&j.push({label:"Write",value:(0,k.O4)(w)}),t&&(0,p.f8)(o)&&(0,p.f8)(i)&&(0,p.f8)(d)){const e=(0,g.Wg)({nodeId:o,pDiskId:i,vDiskSlotId:d}),t=(0,u.yX)(d,i,o);j.push({label:"Links",value:(0,C.jsxs)(l.s,{wrap:"wrap",gap:2,children:[(0,C.jsx)(N.K,{title:(0,I.r)("vdisk-page"),url:t,external:!1},t),(0,C.jsx)(N.K,{title:(0,I.r)("developer-ui"),url:e})]})})}return j})(e,s):((e,t)=>{const{NodeId:s,PDiskId:r,VSlotId:a,StoragePoolName:n}=e,o=[{label:"State",value:"not available"}];if(n&&o.push({label:"StoragePool",value:n}),o.push({label:"NodeId",value:null!==s&&void 0!==s?s:h.Pd},{label:"PDiskId",value:null!==r&&void 0!==r?r:h.Pd},{label:"VSlotId",value:null!==a&&void 0!==a?a:h.Pd}),t&&(0,p.f8)(s)&&(0,p.f8)(r)&&(0,p.f8)(a)){const e=(0,g.Wg)({nodeId:s,pDiskId:r,vDiskSlotId:a});o.push({label:"Links",value:(0,C.jsx)(N.K,{title:"Developer UI",url:e})})}return o})(e,s)),[e,t,s]),a=(0,f.N4)(c.K),n=(0,p.f8)(e.NodeId)?null===a||void 0===a?void 0:a.get(e.NodeId):void 0,x=i.useMemo((()=>t&&e.PDisk&&(0,b.f)(e.PDisk,n,s)),[e,n,t,s]),D=[];if("Donors"in e&&e.Donors){const t=e.Donors;for(const e of t)D.push({label:"VDisk",value:(0,C.jsx)(o.E,{to:w(e),children:e.StringifiedId})})}return(0,C.jsxs)("div",{className:P(),children:[e.DonorMode&&(0,C.jsx)(d.J,{className:P("donor-label"),children:"Donor"}),(0,C.jsx)(y.z_,{title:"VDisk",info:r,size:"s"}),x&&(0,C.jsx)(y.z_,{title:"PDisk",info:x,size:"s"}),D.length>0&&(0,C.jsx)(y.z_,{title:"Donors",info:D,size:"s"})]})},A=(0,r.cn)("ydb-vdisk-component"),E=({data:e={},compact:t,inactive:s,showPopup:r,onShowPopup:i,onHidePopup:l,progressBarClassName:d,delayClose:u,delayOpen:c})=>{const m=w(e);return(0,C.jsx)(n.P,{showPopup:r,onShowPopup:i,onHidePopup:l,renderPopupContent:()=>(0,C.jsx)(j,{data:e}),offset:[0,5],delayClose:u,delayOpen:c,children:(0,C.jsx)("div",{className:A(),children:(0,C.jsx)(o.E,{to:m,className:A("content"),children:(0,C.jsx)(a.V,{diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,compact:t,inactive:s,className:d})})})})}},10174:(e,t,s)=>{s.d(t,{S:()=>o});var r=s(21334),a=s(16029),n=s(11905);const o=r.F.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,{signal:t})=>{try{const s=await window.api.viewer.getNodes({storage:!0,type:"static",...e},{signal:t});return{data:(0,n.rz)(s)}}catch(s){return{error:s}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await(0,a.t)(e,{signal:t})}}catch(s){return{error:s}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},10360:(e,t,s)=>{s.d(t,{hu:()=>m,YX:()=>k,LO:()=>p,UW:()=>d,H6:()=>h,qK:()=>i,SE:()=>f,zY:()=>l,GP:()=>N,Ai:()=>c,i4:()=>b,kY:()=>S});var r=s(370),a=s(48372);const n=JSON.parse('{"pool-name":"Pool Name","type":"Type","encryption":"Encryption","erasure":"Erasure","degraded":"Degraded","missing-disks":"Missing Disks","state":"State","usage":"Usage","disk-usage":"Disk usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","latency":"Latency","allocation-units":"Allocation Units","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}'),o=(0,a.g4)("ydb-storage-groups-columns",{en:n}),i="storageGroupsColumnsWidth",l="storageGroupsSelectedColumns",d={GroupId:"GroupId",PoolName:"PoolName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",Degraded:"Degraded",State:"State"},u=["DiskSpaceUsage","Latency","AllocationUnits","VDisksPDisks"];function c(e){return u.includes(e)}const m=["GroupId","PoolName","Erasure","Used","VDisks"],p=["GroupId"],h={get PoolName(){return o("pool-name")},get MediaType(){return o("type")},get Erasure(){return o("erasure")},get GroupId(){return o("group-id")},get Used(){return o("used")},get Limit(){return o("limit")},get Usage(){return o("usage")},get DiskSpaceUsage(){return o("disk-usage")},get DiskSpace(){return o("space")},get Read(){return o("read")},get Write(){return o("write")},get Latency(){return o("latency")},get AllocationUnits(){return o("allocation-units")},get VDisks(){return o("vdisks")},get VDisksPDisks(){return o("vdisks-pdisks")},get Degraded(){return o("missing-disks")},get State(){return o("state")}},g={get GroupId(){return o("group-id")},get Erasure(){return o("erasure")},get Usage(){return o("usage")},get DiskSpaceUsage(){return o("disk-usage")},get PoolName(){return o("pool-name")},get Kind(){return o("type")},get Encryption(){return o("encryption")},get MediaType(){return o("type")},get MissingDisks(){return o("missing-disks")},get State(){return o("state")},get Latency(){return o("latency")}},v=["PoolName","MediaType","Encryption","Erasure","Usage","DiskSpaceUsage","State","MissingDisks","Latency"],f=v.map((e=>({value:e,content:g[e]}))),S=r.z.custom((e=>v.includes(e))).catch(void 0),k={GroupId:["GroupId"],PoolName:["PoolName"],MediaType:["MediaType","Encryption"],Erasure:["Erasure"],Used:["Used"],Limit:["Limit"],Usage:["Usage"],DiskSpaceUsage:["DiskSpaceUsage"],DiskSpace:["State"],Read:["Read"],Write:["Write"],Latency:["Latency"],AllocationUnits:["AllocationUnits"],VDisks:["VDisk","PDisk","Read","Write"],VDisksPDisks:["VDisk","PDisk","Read","Write"],Degraded:["MissingDisks"],State:["State"]},y={GroupId:"GroupId",PoolName:"PoolName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:void 0,Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:void 0,VDisksPDisks:void 0,Degraded:"Degraded",State:"State"};function N(e){return y[e]}function b(e){return Boolean(N(e))}},10576:(e,t,s)=>{s.d(t,{E:()=>g});var r=s(59284),a=s(88226),n=s(13096),o=s(44294),i=s(96927),l=s(8809),d=s(92459),u=s(7435),c=s(77506),m=s(3218),p=s(60712);const h=(0,c.cn)("pdisk-storage"),g=({data:e={},vDisks:t,showPopup:s,onShowPopup:c,onHidePopup:g,className:v,progressBarClassName:f,viewContext:S})=>{const{NodeId:k,PDiskId:y}=e,N=(0,u.f8)(k)&&(0,u.f8)(y),b=r.useRef(null);let x;return N&&(x=(0,d.Ck)(y,k)),(0,p.jsxs)("div",{className:h(null,v),ref:b,children:[null!==t&&void 0!==t&&t.length?(0,p.jsx)("div",{className:h("vdisks"),children:t.map((e=>(0,p.jsx)("div",{className:h("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,p.jsx)(l.y,{data:e,inactive:!(0,m.OH)(e,S),compact:!0,delayClose:200,delayOpen:200})},e.StringifiedId)))}):null,(0,p.jsx)(n.P,{showPopup:s,offset:[0,5],anchorRef:b,onShowPopup:c,onHidePopup:g,renderPopupContent:()=>(0,p.jsx)(i.O,{data:e}),delayClose:200,children:(0,p.jsxs)(o.E,{to:x,className:h("content"),children:[(0,p.jsx)(a.V,{diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,className:f}),(0,p.jsx)("div",{className:h("media-type"),children:e.Type})]})})]})}},11905:(e,t,s)=>{s.d(t,{Rv:()=>y,rz:()=>S,Qi:()=>k});var r=s(94025),a=s(67375),n=s(7187),o=s(27295),i=s(78034);var l=s(73891),d=s(56839),u=s(51930),c=s(64036),m=s(78461);function p(e={}){var t,s,r,a;const{Whiteboard:i={},PDisk:l,...h}=e,g={...i,...h,VDiskId:i.VDiskId},v=function(e={}){var t,s,r;const{Whiteboard:a,...i}=e,l={...a,...i,PDiskId:null===a||void 0===a?void 0:a.PDiskId},d=i.PDiskId||(0,n.r$)({nodeId:l.NodeId,pDiskId:l.PDiskId}),{AllocatedPercent:c,AllocatedSize:p,AvailableSize:h,TotalSize:g}=(0,o.hK)({AvailableSize:l.AvailableSize,TotalSize:l.TotalSize}),v=null!==(t=null===(s=i.Type)||void 0===s?void 0:s.toUpperCase())&&void 0!==t?t:(0,m.Y)(null===a||void 0===a?void 0:a.Category),f=(0,u.d)({State:null===a||void 0===a?void 0:a.State,AllocatedPercent:c}),S=null!==(r=i.SlotSize)&&void 0!==r?r:null===a||void 0===a?void 0:a.EnforcedDynamicSlotSize;return{...l,StringifiedId:d,AllocatedPercent:c,AllocatedSize:p,AvailableSize:h,TotalSize:g,Type:v,Severity:f,SlotSize:S}}({...l,NodeId:g.NodeId}),f=null!==(t=null===v||void 0===v?void 0:v.PDiskId)&&void 0!==t?t:null===i||void 0===i?void 0:i.PDiskId,S=null!==(s=h.VDiskId)&&void 0!==s?s:(0,d.U9)(i.VDiskId),k=(0,c.b)(g),y=(0,o.LW)({AvailableSize:null!==(r=g.AvailableSize)&&void 0!==r?r:null===l||void 0===l?void 0:l.AvailableSize,AllocatedSize:g.AllocatedSize}),N=null===(a=h.Donors)||void 0===a?void 0:a.map((e=>p({...e,Whiteboard:{...e.Whiteboard,DonorMode:!0}})));return{...g,...y,PDisk:v,Donors:N,PDiskId:f,StringifiedId:S,Severity:k}}function h(e){const{DiskSpace:t,VDisks:s=[]}=e;return t||(0,n.XY)(Math.max(...s.map((e=>(0,n.H7)(e.DiskSpace)))))}const g=(e,t)=>{var s;const r=(0,o.WT)(e);return{...r,StoragePoolName:t,Donors:null===r||void 0===r||null===(s=r.Donors)||void 0===s?void 0:s.map((e=>({...e,StoragePoolName:t})))}},v=(e,t)=>{var s;let n,i=0,l=0,d=0,u=0,c=0;const{Name:m,MediaType:p}=t;if(e.VDisks)for(const h of e.VDisks){const{Replicated:e,VDiskState:t,AvailableSize:s,AllocatedSize:m,PDisk:p,ReadThroughput:g,WriteThroughput:v}=h,{Type:f,State:S,AvailableSize:k}=(0,o.or)(p);!1!==e&&S===r.t.Normal&&t===a.W.OK||(i+=1);const y=Number(null!==s&&void 0!==s?s:k)||0,N=Number(m)||0;l+=N,d+=y+N,u+=Number(g)||0,c+=Number(v)||0,n=!f||f!==n&&n?"Mixed":f}const v=null===(s=e.VDisks)||void 0===s?void 0:s.map((e=>g(e,m))),f=d?((e,t=1)=>{const s=e.Limit?100*e.Used/e.Limit:0;return Math.floor(s/t)*t})({Used:l,Limit:d},5):void 0,S=h(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:v,Usage:f,Read:u,Write:c,PoolName:m,Used:l,Limit:d,Degraded:i,MediaType:p||n||void 0,DiskSpace:S}},f=e=>{const{VDisks:t=[],PoolName:s,Usage:r=0,Read:a=0,Write:n=0,Used:o=0,Limit:i=0,Degraded:l=0,Kind:d,MediaType:u,GroupID:c,Overall:m,GroupGeneration:p}=e,v=t.map((e=>g(e,s))),f=100*Number(r),S=h(e);return{...e,PoolName:s,GroupId:c,MediaType:u||d,VDisks:v,Usage:f,Overall:m,GroupGeneration:p?String(p):void 0,Read:Number(a),Write:Number(n),Used:Number(o),Limit:Number(i),Degraded:Number(l),DiskSpace:S}},S=e=>{const{Nodes:t,TotalNodes:s,FoundNodes:a,NodeGroups:n,MaximumSlotsPerDisk:l,MaximumDisksPerNode:d}=e,u=null===n||void 0===n?void 0:n.map((({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e))),c=((e,t)=>{if(t)return t;const s=(e||[]).flatMap((e=>{const t=e.PDisks||[],s=e.VDisks||[];return t.map((e=>s.filter((t=>t.PDiskId===e.PDiskId)).length||0))})),r=Math.max(1,...s);return String(r)})(t,l),m=((e,t)=>{if(t)return t;const s=(e||[]).map((e=>{var t;return(null===(t=e.PDisks)||void 0===t?void 0:t.length)||0})),r=Math.max(1,...s);return String(r)})(t,d),p=null===t||void 0===t?void 0:t.map((e=>((e,t,s)=>{var a,n,l;const d=(null===(a=e.PDisks)||void 0===a?void 0:a.filter((e=>e.State!==r.t.Normal)).length)||0,u=null===(n=e.PDisks)||void 0===n?void 0:n.map((t=>({...(0,o.or)(t),NodeId:e.NodeId}))),c=null===(l=e.VDisks)||void 0===l?void 0:l.map((t=>({...(0,o.WT)(t),NodeId:e.NodeId})));return{...(0,i.q1)(e.SystemState),NodeId:e.NodeId,DiskSpaceUsage:e.DiskSpaceUsage,PDisks:u,VDisks:c,Missing:d,MaximumSlotsPerDisk:t,MaximumDisksPerNode:s}})(e,c,m)));return{nodes:p,total:Number(s)||(null===p||void 0===p?void 0:p.length),found:Number(a),tableGroups:u}},k=e=>{const{StoragePools:t,StorageGroups:s,TotalGroups:r,FoundGroups:a}=e,n=((e,t)=>{let s=[];return e?s=e.map(f):null===t||void 0===t||t.forEach((e=>{var t;null===(t=e.Groups)||void 0===t||t.forEach((t=>{s.push(v(t,e))}))})),s})(s,t);return{groups:n,total:Number(r)||n.length,found:Number(a)}};function y(e){const{FoundGroups:t,TotalGroups:s,StorageGroups:r=[],StorageGroupGroups:a}=e,n=r.map((e=>{const{Usage:t,DiskSpaceUsage:s,Read:r,Write:a,Used:n,Limit:o,MissingDisks:i,VDisks:d=[],Overall:u,LatencyPutTabletLog:c,LatencyPutUserData:m,LatencyGetFast:g}=e,v=d.map(p),f=h(e);return{...e,Usage:t,DiskSpaceUsage:s,Read:Number(r),Write:Number(a),Used:Number(n),Limit:Number(o),LatencyPutTabletLogMs:(0,l.Jc)(c),LatencyPutUserDataMs:(0,l.Jc)(m),LatencyGetFastMs:(0,l.Jc)(g),Degraded:Number(i),Overall:u,VDisks:v,DiskSpace:f}})),o=null===a||void 0===a?void 0:a.map((({GroupName:e,GroupCount:t})=>{if(e&&t)return{name:e,count:Number(t)}})).filter((e=>Boolean(e)));return{groups:n,total:Number(s)||n.length,found:Number(t),tableGroups:o}}},13096:(e,t,s)=>{s.d(t,{P:()=>u});var r=s(59284),a=s(39238),n=s(43781),o=s.n(n),i=s(77506),l=s(60712);const d=(0,i.cn)("hover-popup"),u=({children:e,renderPopupContent:t,showPopup:s,offset:n,anchorRef:i,onShowPopup:u,onHidePopup:c,placement:m=["top","bottom"],contentClassName:p,delayClose:h=100,delayOpen:g=100})=>{const[v,f]=r.useState(!1),S=r.useRef(null),k=r.useMemo((()=>o()((()=>{f(!0),null===u||void 0===u||u()}),g)),[u,g]),y=r.useCallback((()=>{f(!1),null===c||void 0===c||c()}),[c]),N=r.useMemo((()=>o()(y,h)),[y,h]),b=k,[x,D]=r.useState(!1),[w,I]=r.useState(!1),C=r.useCallback((()=>{D(!0)}),[]),P=r.useCallback((()=>{D(!1)}),[]),j=r.useCallback((()=>{I(!0)}),[]),A=r.useCallback((()=>{I(!1)}),[]),E=r.useCallback((()=>{I(!1),D(!1),y()}),[y]),T=v||s||x||w;return(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)("span",{ref:S,onMouseEnter:b,onMouseLeave:()=>{k.cancel(),N()},children:e}),T?(0,l.jsx)(a.z,{contentClassName:d(null,p),anchorRef:i||S,onMouseEnter:C,onMouseLeave:P,onEscapeKeyDown:E,onBlur:A,placement:m,hasArrow:!0,open:!0,offset:n||[0,12],children:(0,l.jsx)("div",{onContextMenu:j,children:t()})}):null]})}},15132:(e,t,s)=>{s.d(t,{O:()=>m});var r=s(38501),a=s(77506),n=s(56839),o=s(35736),i=s(41650),l=s(60712);const d=(0,a.cn)("progress-viewer"),u=e=>(0,n.ZV)((0,n.CR)(Number(e),2)),c=(e,t)=>[u(e),u(t)];function m({value:e,capacity:t,formatValues:s=c,percents:a,className:n,size:u="xs",colorizeProgress:m,inverseColorize:p,warningThreshold:h,dangerThreshold:g,hideCapacity:v}){const f=(0,r.D)();let S=Math.round(parseFloat(String(e))/parseFloat(String(t))*100)||0;S=S>100?100:S;let k=e,y=t,N="/";a?(k=S+"%",y="",N=""):s&&([k,y]=s(Number(e),Number(t)));const b=(0,o.w)({fillWidth:S,warningThreshold:h,dangerThreshold:g,colorizeProgress:m,inverseColorize:p});m&&!(0,i.kf)(t)&&(S=100);const x={width:S+"%"};return(0,i.kf)(e)?(0,l.jsxs)("div",{className:d({size:u,theme:f,status:b},n),children:[(0,l.jsx)("div",{className:d("line"),style:x}),(0,l.jsx)("span",{className:d("text"),children:(0,i.kf)(t)&&!v?`${k} ${N} ${y}`:k})]}):(0,l.jsx)("div",{className:`${d({size:u})} ${n} error`,children:"no data"})}},16029:(e,t,s)=>{s.d(t,{t:()=>a});var r=s(11905);async function a({version:e="v2",shouldUseGroupsHandler:t,...s},a){if(t&&"v1"!==e){const e=await window.api.storage.getStorageGroups({...s},a);return(0,r.Rv)(e)}{const t=await window.api.viewer.getStorageInfo({version:e,...s},a);return(0,r.Qi)(t)}}},19228:(e,t,s)=>{s.d(t,{Q:()=>l});var r=s(89169),a=s(77506),n=s(66781),o=s(60712);const i=(0,a.cn)("table-skeleton"),l=({rows:e=2,delay:t=600,className:s})=>{const[a]=(0,n.y)(t);return(0,o.jsxs)("div",{className:i("wrapper",{hidden:!a},s),children:[(0,o.jsxs)("div",{className:i("row"),children:[(0,o.jsx)(r.E,{className:i("col-1")}),(0,o.jsx)(r.E,{className:i("col-2")}),(0,o.jsx)(r.E,{className:i("col-3")}),(0,o.jsx)(r.E,{className:i("col-4")}),(0,o.jsx)(r.E,{className:i("col-5")})]}),[...new Array(e)].map(((e,t)=>(0,o.jsx)("div",{className:i("row"),children:(0,o.jsx)(r.E,{className:i("col-full")})},`skeleton-row-${t}`)))]})}},20831:(e,t,s)=>{s.d(t,{J:()=>oe,k:()=>ne});var r=s(79879),a=s(4557),n=s(63291),o=s(47665),i=s(84375),l=s(99991),d=s(71661),u=s(10508),c=s(33775),m=s(13342),p=s(92459),h=s(7435),g=s(77506),v=s(76086),f=s(56839),S=s(16439),k=s(73891),y=s(41650),N=s(59284),b=s(69033),x=s(87184),D=s(8809),w=s(10576),I=s(3218),C=s(60712);const P=(0,g.cn)("ydb-storage-disks");function j({vDisks:e=[],viewContext:t,erasure:s}){const[r,a]=N.useState(),n=(0,I.Ep)(e,s),{theme:{spaceBaseSize:o}}=(0,b.L)();if(!e.length)return null;const i=(300-o*(e.length-1))/e.length;return(0,C.jsxs)("div",{className:P(null),children:[(0,C.jsx)(x.s,{direction:"row",gap:1,grow:!0,style:{width:300},children:null===e||void 0===e?void 0:e.map(((e,s)=>(0,C.jsx)(A,{vDisk:e,inactive:!(0,I.OH)(e,t),highlightedVDisk:r,setHighlightedVDisk:a,unavailableVDiskWidth:i},e.StringifiedId||s)))}),(0,C.jsx)("div",{className:P("pdisks-wrapper"),children:null===e||void 0===e?void 0:e.map(((e,t)=>{var s;return(0,C.jsx)(E,{vDisk:e,highlightedVDisk:r,setHighlightedVDisk:a,withDCMargin:n.includes(t)},(null===e||void 0===e||null===(s=e.PDisk)||void 0===s?void 0:s.StringifiedId)||t)}))})]})}function A({vDisk:e,highlightedVDisk:t,inactive:s,setHighlightedVDisk:r,unavailableVDiskWidth:a}){const n={...e,PDisk:void 0},o=e.StringifiedId,i=(0,y.kf)(n.AllocatedSize)?void 0:a,l=Number(n.AllocatedSize)||1;return(0,C.jsx)("div",{style:{flexGrow:l,minWidth:i},className:P("vdisk-item"),children:(0,C.jsx)(D.y,{data:n,compact:!0,inactive:s,showPopup:t===o,onShowPopup:()=>r(o),onHidePopup:()=>r(void 0),progressBarClassName:P("vdisk-progress-bar")})})}function E({vDisk:e,highlightedVDisk:t,setHighlightedVDisk:s,withDCMargin:r}){const a=e.StringifiedId;return e.PDisk?(0,C.jsx)(w.E,{className:P("pdisk-item",{"with-dc-margin":r}),progressBarClassName:P("pdisk-progress-bar"),data:e.PDisk,showPopup:t===a,onShowPopup:()=>s(a),onHidePopup:()=>s(void 0)}):null}var T=s(7187);const U="--ydb-stack-level",R=(0,g.cn)("stack"),M=({children:e,className:t})=>(0,C.jsx)("div",{className:R(null,t),children:N.Children.map(e,((e,t)=>N.isValidElement(e)?(0,C.jsx)("div",{className:R("layer"),style:{[U]:t},children:e}):null))});function G({data:e,className:t,stackClassName:s,...r}){const{Donors:a,...n}=e||{},o=a&&a.length>0?(0,C.jsxs)(M,{className:s,children:[(0,C.jsx)(D.y,{data:n,...r}),a.map((e=>{const t=(0,T.NJ)(e);return(0,C.jsx)(D.y,{data:e,...r},(0,f.U9)(t?e.VDiskId:e))}))]}):(0,C.jsx)(D.y,{data:e,...r});return(0,C.jsx)("div",{className:t,children:o})}const L=(0,g.cn)("ydb-storage-vdisks");function z({vDisks:e,viewContext:t,erasure:s}){const r=(0,I.Ep)(e,s);return(0,C.jsx)("div",{className:L("wrapper"),children:null===e||void 0===e?void 0:e.map(((e,s)=>(0,C.jsx)(G,{data:e,inactive:!(0,I.OH)(e,t),className:L("item",{"with-dc-margin":r.includes(s)})},e.StringifiedId)))})}var V=s(61456),W=s(10360);const O=(0,g.cn)("ydb-storage-groups-columns"),H={name:W.UW.PoolName,header:W.H6.PoolName,width:250,render:({row:e})=>e.PoolName?(0,C.jsx)(d.s,{content:e.PoolName,placement:["right"],behavior:n.m.Immediate,className:O("pool-name-wrapper"),children:(0,C.jsx)("span",{className:O("pool-name"),children:e.PoolName})}):v.Pd,align:a.Ay.LEFT},F={name:W.UW.MediaType,header:W.H6.MediaType,width:100,resizeMinWidth:100,align:a.Ay.LEFT,render:({row:e})=>(0,C.jsxs)("div",{children:[(0,C.jsx)(o.J,{children:e.MediaType||"\u2014"}),"\xa0",e.Encryption&&(0,C.jsx)(i.A,{content:(0,V.A)("encrypted"),placement:"right",behavior:n.m.Immediate,children:(0,C.jsx)(o.J,{children:(0,C.jsx)(l.I,{data:r.A,size:18})})})]}),sortable:!1},_={name:W.UW.Erasure,header:W.H6.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:({row:e})=>e.ErasureSpecies?e.ErasureSpecies:"-",align:a.Ay.LEFT},B={name:W.UW.Degraded,header:W.H6.Degraded,width:110,resizeMinWidth:110,render:({row:e})=>e.Degraded?(0,C.jsxs)(o.J,{theme:(0,I.k_)(e),children:["Degraded: ",e.Degraded]}):"-",align:a.Ay.LEFT,defaultOrder:a.Ay.DESCENDING},$={name:W.UW.State,header:W.H6.State,width:150,render:({row:e})=>{var t;return null!==(t=e.State)&&void 0!==t?t:v.Pd},align:a.Ay.LEFT,defaultOrder:a.Ay.DESCENDING},Y={name:W.UW.Usage,header:W.H6.Usage,width:85,resizeMinWidth:75,render:({row:e})=>(0,h.f8)(e.Usage)?(0,C.jsx)(m.U,{value:Math.floor(e.Usage),theme:(0,S.f)(e.Usage)}):v.Pd,align:a.Ay.LEFT},K={name:W.UW.DiskSpaceUsage,header:W.H6.DiskSpaceUsage,width:115,resizeMinWidth:75,render:({row:e})=>(0,h.f8)(e.DiskSpaceUsage)?(0,C.jsx)(m.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,S.f)(e.DiskSpaceUsage)}):v.Pd,align:a.Ay.LEFT},J={name:W.UW.GroupId,header:W.H6.GroupId,width:140,render:({row:e})=>e.GroupId?(0,C.jsx)(u.c,{name:String(e.GroupId),path:(0,p._g)(e.GroupId),hasClipboardButton:!0,showStatus:!1}):"-",sortAccessor:e=>Number(e.GroupId),align:a.Ay.LEFT},Q={name:W.UW.Used,header:W.H6.Used,width:100,render:({row:e})=>(0,y.wb)(e.Used,!0),align:a.Ay.RIGHT},X={name:W.UW.Limit,header:W.H6.Limit,width:100,render:({row:e})=>(0,y.wb)(e.Limit),align:a.Ay.RIGHT},q={name:W.UW.DiskSpace,header:W.H6.DiskSpace,width:70,render:({row:e})=>(0,C.jsx)(c.k,{status:e.DiskSpace}),align:a.Ay.CENTER},Z={name:W.UW.Read,header:W.H6.Read,width:100,render:({row:e})=>e.Read?(0,y.O4)(e.Read):"-",align:a.Ay.RIGHT},ee={name:W.UW.Write,header:W.H6.Write,width:100,render:({row:e})=>e.Write?(0,y.O4)(e.Write):"-",align:a.Ay.RIGHT},te={name:W.UW.Latency,header:W.H6.Latency,width:100,render:({row:e})=>(0,h.f8)(e.LatencyPutTabletLogMs)?(0,k.Xo)(e.LatencyPutTabletLogMs):v.Pd,align:a.Ay.RIGHT},se={name:W.UW.AllocationUnits,header:W.H6.AllocationUnits,width:150,render:({row:e})=>(0,h.f8)(e.AllocationUnits)?(0,f.ZV)(e.AllocationUnits):v.Pd,align:a.Ay.RIGHT},re=e=>({name:W.UW.VDisks,header:W.H6.VDisks,className:O("vdisks-column"),render:({row:t})=>(0,C.jsx)(z,{vDisks:t.VDisks,viewContext:null===e||void 0===e?void 0:e.viewContext,erasure:t.ErasureSpecies}),align:a.Ay.CENTER,width:780,resizeable:!1,sortable:!1}),ae=e=>({name:W.UW.VDisksPDisks,header:W.H6.VDisksPDisks,className:O("disks-column"),render:({row:t})=>(0,C.jsx)(j,{vDisks:t.VDisks,viewContext:null===e||void 0===e?void 0:e.viewContext,erasure:t.ErasureSpecies}),align:a.Ay.CENTER,width:900,resizeable:!1,sortable:!1}),ne=()=>[J,F,_,Y,Q,X],oe=e=>[J,H,F,_,B,$,Y,K,Q,X,q,Z,ee,te,se,re(e),ae(e)].map((e=>({...e,sortable:(0,W.i4)(e.name)})))},24543:(e,t,s)=>{s.d(t,{u:()=>o});var r=s(59284),a=s(39238),n=s(60712);const o=({children:e,content:t,className:s,pinOnClick:o,hasArrow:i=!0,placement:l=["top","bottom"],...d})=>{const[u,c]=r.useState(!1),[m,p]=r.useState(!1),h=r.useRef(null);return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)(a.z,{anchorRef:h,open:m||u,placement:l,hasArrow:i,onOutsideClick:()=>{p(!1)},...d,children:t}),(0,n.jsx)("span",{className:s,ref:h,onClick:o?()=>{p(!0)}:void 0,onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:e})]})}},27295:(e,t,s)=>{s.d(t,{LW:()=>u,WT:()=>l,hK:()=>c,or:()=>d});var r=s(56839),a=s(51930),n=s(64036),o=s(78461),i=s(7187);function l(e={}){var t;if(!(0,i.NJ)(e)){const{NodeId:t,PDiskId:s,VSlotId:a}=e;return{StringifiedId:(0,r.U9)({NodeId:t,PDiskId:s,VSlotId:a}),NodeId:t,PDiskId:s,VDiskSlotId:a}}const{PDisk:s,PDiskId:a,VDiskId:o,NodeId:c,Donors:m,AvailableSize:p,AllocatedSize:h,...g}=e,v=s?d({...s,NodeId:null!==(t=null===s||void 0===s?void 0:s.NodeId)&&void 0!==t?t:c}):void 0,f=null!==a&&void 0!==a?a:null===v||void 0===v?void 0:v.PDiskId,S=u({AvailableSize:null!==p&&void 0!==p?p:null===s||void 0===s?void 0:s.AvailableSize,AllocatedSize:h}),k=(0,n.b)(e),y=(0,r.U9)(o);return{...g,...S,VDiskId:o,NodeId:c,PDiskId:f,PDisk:v,Donors:null===m||void 0===m?void 0:m.map((e=>l({...e,DonorMode:!0}))),Severity:k,StringifiedId:y}}function d(e={}){const{AvailableSize:t,TotalSize:s,Category:r,State:n,PDiskId:l,NodeId:d,EnforcedDynamicSlotSize:u,...m}=e,p=(0,i.r$)({nodeId:d,pDiskId:l}),h=(0,o.Y)(r),g=c({AvailableSize:t,TotalSize:s}),v=(0,a.d)({State:n,AllocatedPercent:g.AllocatedPercent});return{...m,...g,PDiskId:l,NodeId:d,StringifiedId:p,Type:h,Category:r,State:n,Severity:v,SlotSize:u}}function u({AvailableSize:e,AllocatedSize:t}){const s=Number(e),r=Number(t),a=r+s;return{AvailableSize:s,AllocatedSize:r,TotalSize:a,AllocatedPercent:Math.round(100*r/a)}}function c({AvailableSize:e,TotalSize:t}){const s=Number(e),r=Number(t),a=r-s;return{AvailableSize:s,TotalSize:r,AllocatedSize:a,AllocatedPercent:Math.round(100*a/r)}}},31911:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(48372);const a=JSON.parse('{"node-id":"Node ID","host":"Host","database":"Database","node-name":"Node Name","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Detailed Memory","ram":"RAM","cpu":"CPU","pools":"Pools","disk-usage":"Disk Usage","tablets":"Tablets","load-average":"Load Average","load":"Load","sessions":"Sessions","missing":"Missing","pdisks":"PDisks","field_memory-used":"Memory used","field_memory-limit":"Memory limit","system-state":"System State","connect-status":"Connect Status","utilization":"Utilization","network-utilization":"Network Utilization","connections":"Connections","clock-skew":"Clock Skew","skew":"Skew","ping-time":"Ping Time","ping":"Ping","send":"Send","receive":"Receive","max":"Max","min":"Min","avg":"Avg","sum":"Sum"}'),n=(0,r.g4)("ydb-nodes-columns",{en:a})},35736:(e,t,s)=>{s.d(t,{w:()=>a});var r=s(76086);function a({inverseColorize:e,warningThreshold:t=r.Hh,dangerThreshold:s=r.Ed,colorizeProgress:a,fillWidth:n}){let o=e?"danger":"good";return a&&(n>t&&n<=s?o="warning":n>s&&(o=e?"good":"danger")),o}},39110:(e,t,s)=>{s.d(t,{r:()=>n});var r=s(48372);const a=JSON.parse('{"slot-id":"VDisk Slot Id","pool-name":"Storage Pool Name","kind":"Kind","guid":"GUID","incarnation-guid":"Incarnation GUID","instance-guid":"Instance GUID","replication-status":"Replicated","state-status":"VDisk State","space-status":"Disk Space","fresh-rank-satisfaction":"Fresh Rank Satisfaction","level-rank-satisfaction":"Level Rank Satisfaction","front-queues":"Front Queues","has-unreadable-blobs":"Has Unreadable Blobs","size":"Size","read-throughput":"Read Throughput","write-throughput":"Write Throughput","links":"Links","vdisk-page":"VDisk page","developer-ui":"Developer UI","yes":"Yes","no":"No","vdiks-title":"VDisk"}'),n=(0,r.g4)("ydb-vDisk-info",{en:a})},40427:(e,t,s)=>{s.d(t,{k5:()=>E});var r=s(59284),a=s(89073);const n=s(21334).F.injectEndpoints({endpoints:function(e){return{fetchTableChunk:e.query({queryFn:async({offset:e,limit:t,sortParams:s,filters:r,columnsIds:a,fetchData:n},{signal:o})=>{try{return{data:await n({limit:t,offset:e,filters:r,sortParams:s,columnsIds:a,signal:o})}}catch(i){return{error:i}}},providesTags:["All"]})}}});var o=s(7435),i=s(90182),l=s(44508),d=s(89169);const u=!0;const c=(0,s(77506).cn)("ydb-paginated-table");const m=r.memo;var p=s(60712);const h=({children:e,className:t,height:s,width:r,align:a="left",resizeable:n})=>(0,p.jsx)("td",{className:c("row-cell",{align:a},t),style:{height:`${s}px`,width:`${r}px`,maxWidth:n?`${r}px`:void 0},children:e}),g=m((function({columns:e,height:t}){return(0,p.jsx)("tr",{className:c("row",{loading:!0}),children:e.map((e=>{var s;const r=null!==(s=e.resizeable)&&void 0!==s?s:u;return(0,p.jsx)(h,{height:t,width:e.width,align:e.align,className:e.className,resizeable:r,children:(0,p.jsx)(d.E,{className:c("row-skeleton"),style:{width:"80%",height:"50%"}})},e.name)}))})})),v=({row:e,columns:t,getRowClassName:s,height:r})=>{const a=null===s||void 0===s?void 0:s(e);return(0,p.jsx)("tr",{className:c("row",a),children:t.map((t=>{var s;const a=null!==(s=t.resizeable)&&void 0!==s?s:u;return(0,p.jsx)(h,{height:r,width:t.width,align:t.align,className:t.className,resizeable:a,children:t.render({row:e})},t.name)}))})},f=({columns:e,children:t})=>(0,p.jsx)("tr",{className:c("row",{empty:!0}),children:(0,p.jsx)("td",{colSpan:e.length,className:c("td"),children:t})});var S=s(48372);const k=JSON.parse('{"empty":"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"}'),y=(0,S.g4)("ydb-paginated-table",{ru:k,en:{empty:"No data"}}),N=m((function({id:e,chunkSize:t,calculatedCount:s,rowHeight:a,columns:d,fetchData:u,tableName:c,filters:m,sortParams:h,getRowClassName:S,renderErrorMessage:k,renderEmptyDataMessage:N,onDataFetched:b,isActive:x}){var D;const[w,I]=r.useState(!0),[C]=(0,i.Nt)(),P={offset:e*t,limit:t,fetchData:u,filters:m,sortParams:h,columnsIds:d.map((e=>e.name)),tableName:c};n.useFetchTableChunkQuery(P,{skip:w||!x,pollingInterval:C});const{currentData:j,error:A}=n.endpoints.fetchTableChunk.useQueryState(P);r.useEffect((()=>{let e=0;return x&&w&&(e=window.setTimeout((()=>{I(!1)}),200)),()=>{window.clearTimeout(e)}}),[x,w]),r.useEffect((()=>{if(j&&x){const{total:e=0,found:t=0}=j;b(e,t)}}),[j,x,b]);const E=(null===j||void 0===j||null===(D=j.data)||void 0===D?void 0:D.length)||s;return(0,p.jsx)("tbody",{id:e.toString(),style:{height:E*a+"px",display:x?"table-row-group":"block"},children:(()=>{var e;if(!x)return null;if(!j){if(A){const e=A;return(0,p.jsx)(f,{columns:d,children:k?k(e):(0,p.jsx)(l.o,{error:e})})}return(0,o._e)(E).map((e=>(0,p.jsx)(g,{columns:d,height:a},e)))}return null!==(e=j.data)&&void 0!==e&&e.length?j.data.map(((e,t)=>(0,p.jsx)(v,{row:e,columns:d,height:a,getRowClassName:S},t))):(0,p.jsx)(f,{columns:d,children:N?N():y("empty")})})()})}));function b({minWidth:e,maxWidth:t,getCurrentColumnWidth:s,onResize:a}){const n=r.useRef(null),[o,i]=r.useState(!1);return r.useEffect((()=>{const r=n.current;if(!r)return;let o,l,d;const u=function(e){let t,s=null;return function(...r){t=r,"number"!==typeof s&&(s=requestAnimationFrame((()=>{e(...t),s=null})))}}((s=>{if(x(s),"number"!==typeof o||"number"!==typeof l)return;const r=s.clientX-o,n=function(e,t=40,s=1/0){return Math.max(t,Math.min(e,s))}(l+r,e,t);n!==d&&(d=n,null===a||void 0===a||a(d))})),c=e=>{x(e),void 0!==d&&(null===a||void 0===a||a(d)),i(!1),o=void 0,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)},m=e=>{l=s(),x(e),o=e.clientX,i(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)};return r.addEventListener("mousedown",m),()=>{r.removeEventListener("mousedown",m),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)}}),[a,e,t,s]),(0,p.jsx)("span",{ref:n,className:c("resize-handler",{resizing:o}),onClick:e=>x(e)})}function x(e){e.preventDefault(),e.stopPropagation()}const D=({order:e})=>(0,p.jsx)("svg",{className:c("sort-icon",{desc:-1===e}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,p.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})}),w=({sortOrder:e,sortable:t,defaultSortOrder:s})=>t?(0,p.jsx)("span",{className:c("sort-icon-container",{shadow:!e}),children:(0,p.jsx)(D,{order:e||s})}):null,I=({column:e,resizeable:t,sortOrder:s,defaultSortOrder:a,onSort:n,rowHeight:o,onCellMount:i,onCellUnMount:l,onColumnsResize:d})=>{var u;const m=r.useRef(null);r.useEffect((()=>{const e=m.current;return e&&(null===i||void 0===i||i(e)),()=>{e&&(null===l||void 0===l||l(e))}}),[i,l]);const h=r.useCallback((()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect().width}),[]),g=r.useCallback((t=>{null===d||void 0===d||d(e.name,t)}),[d,e.name]),v=null!==(u=e.header)&&void 0!==u?u:e.name,f={height:`${o}px`,width:`${e.width}px`,minWidth:t?`${e.width}px`:void 0,maxWidth:t?`${e.width}px`:void 0};return(0,p.jsxs)("th",{ref:m,className:c("head-cell-wrapper"),style:f,children:[(0,p.jsxs)("div",{className:c("head-cell",{align:e.align,sortable:e.sortable},e.className),onClick:()=>{e.sortable&&(null===n||void 0===n||n(e.name))},children:[(0,p.jsx)("div",{className:c("head-cell-content"),children:v}),(0,p.jsx)(w,{sortOrder:s,sortable:e.sortable,defaultSortOrder:a})]}),t?(0,p.jsx)(b,{maxWidth:e.resizeMaxWidth,minWidth:e.resizeMinWidth,getCurrentColumnWidth:h,onResize:g}):null]})},C=({columns:e,onSort:t,onColumnsResize:s,defaultSortOrder:a=-1,rowHeight:n=41})=>{const[o,i]=r.useState({}),l=e=>{let s={};if(e===o.columnId){if(o.sortOrder&&o.sortOrder!==a)return i(s),void(null===t||void 0===t||t(s));s={sortOrder:1===o.sortOrder?-1:1,columnId:e}}else s={sortOrder:a,columnId:e};null===t||void 0===t||t(s),i(s)};return(0,p.jsxs)(r.Fragment,{children:[(0,p.jsx)("colgroup",{children:e.map((e=>(0,p.jsx)("col",{style:{width:`${e.width}px`}},e.name)))}),(0,p.jsx)("thead",{className:c("head"),children:(0,p.jsx)("tr",{children:e.map((e=>{var t;const r=o.columnId===e.name?o.sortOrder:void 0,i=s&&(null!==(t=e.resizeable)&&void 0!==t?t:u);return(0,p.jsx)(I,{column:e,resizeable:i,sortOrder:r,defaultSortOrder:a,onSort:l,rowHeight:n,onColumnsResize:s},e.name)}))})})]})};var P=s(13847);const j=({limit:e=20,initialEntitiesCount:t,fetchData:s,filters:n,tableName:o,columns:i,getRowClassName:l,rowHeight:d=41,parentRef:u,initialSortParams:m,onColumnsResize:h,renderControls:g,renderErrorMessage:v,renderEmptyDataMessage:f,containerClassName:S})=>{const k=t||0,y=t||1,[b,x]=r.useState(m),[D,w]=r.useState(k),[I,j]=r.useState(y),[A,E]=r.useState(!0),T=r.useRef(null),U=(({parentRef:e,tableRef:t,totalItems:s,rowHeight:a,chunkSize:n,overscanCount:o=1})=>{const i=r.useMemo((()=>Math.ceil(s/n)),[n,s]),[l,d]=r.useState(0),[u,c]=r.useState(Math.min(o,Math.max(i-1,0))),m=r.useCallback((()=>{const s=null===e||void 0===e?void 0:e.current,r=t.current;if(!s||!r)return null;const l=function(e,t){let s=e,r=0;for(;s&&s!==t;)r+=s.offsetTop,s=s.offsetParent;return r}(r,s),d=s.scrollTop,u=Math.max(d-l,0),c=u+s.clientHeight;return{start:Math.max(Math.floor(u/a/n)-o,0),end:Math.min(Math.floor(c/a/n)+o,Math.max(i-1,0))}}),[e,t,a,n,o,i]),p=r.useCallback((()=>{const e=m();e&&(d(e.start),c(e.end))}),[m]);return r.useEffect((()=>{const t=null===e||void 0===e?void 0:e.current;if(!t)return;const s=(0,P.throttle)(p,100,{leading:!0,trailing:!0});return t.addEventListener("scroll",s),()=>{t.removeEventListener("scroll",s),s.cancel()}}),[p,e]),r.useMemo((()=>{const e=Array(i).fill(!1);for(let t=l;t<=u;t++)e[t]=!0;return e}),[i,l,u])})({parentRef:u,tableRef:T,totalItems:I,rowHeight:d,chunkSize:e}),R=r.useMemo((()=>I?I%e||e:1),[I,e]),M=r.useCallback(((e,t)=>{w(e),j(t),E(!1)}),[]);r.useLayoutEffect((()=>{w(k),j(y),E(!0),null!==u&&void 0!==u&&u.current&&u.current.scrollTo(0,0)}),[n,y,k,u]);const G=()=>(0,p.jsxs)("table",{className:c("table"),children:[(0,p.jsx)(C,{columns:i,onSort:x,onColumnsResize:h}),U.map(((t,r)=>(0,p.jsx)(N,{id:r,calculatedCount:r===U.length-1?R:e,chunkSize:e,rowHeight:d,columns:i,fetchData:s,filters:n,tableName:o,sortParams:b,getRowClassName:l,renderErrorMessage:v,renderEmptyDataMessage:f,onDataFetched:M,isActive:t},r)))]});return(0,p.jsx)("div",{ref:T,className:c(null,S),children:g?(0,p.jsxs)(a.L,{children:[(0,p.jsx)(a.L.Controls,{children:g({inited:!A,totalEntities:D,foundEntities:I})}),(0,p.jsx)(a.L.Table,{children:G()})]}):G()})};var A=s(16819);function E({columnsWidthLSKey:e,columns:t,...s}){const[r,a]=(0,A.a)(e),n=function(e,t){return e.map((e=>{var s;return{...e,width:null!==(s=t[e.name])&&void 0!==s?s:e.width}}))}(t,r);return(0,p.jsx)(j,{columns:n,onColumnsResize:a,containerClassName:c("resizeable-table-container"),...s})}},40781:(e,t,s)=>{function r(e,t){const s=e.reduce(((e,s)=>(t[s].forEach((t=>{e.add(t)})),e)),new Set);return Array.from(s).sort()}s.d(t,{R:()=>r})},41775:(e,t,s)=>{s.d(t,{v:()=>l});var r=s(59284),a=s(28664),n=s(77506),o=s(60712);const i=(0,n.cn)("ydb-search"),l=({onChange:e,value:t="",width:s,className:n,debounce:l=200,placeholder:d})=>{const[u,c]=r.useState(t),m=r.useRef();r.useEffect((()=>{c((e=>e!==t?t:e))}),[t]);return(0,o.jsx)(a.k,{hasClear:!0,autoFocus:!0,style:{width:s},className:i(null,n),placeholder:d,value:u,onUpdate:t=>{c(t),window.clearTimeout(m.current),m.current=window.setTimeout((()=>{null===e||void 0===e||e(t)}),l)}})}},43951:(e,t,s)=>{s.d(t,{K:()=>n});var r=s(59284),a=s(59001);const n=(e,t,s,n,o)=>{const[i,l]=r.useState((()=>a.f.readUserSettingsValue(t,n)));return{columnsToShow:r.useMemo((()=>e.filter((e=>{const t=e.name,s=i.includes(t),r=null===o||void 0===o?void 0:o.includes(t);return s||r}))),[e,o,i]),columnsToSelect:r.useMemo((()=>e.map((e=>e.name)).map((e=>{const t=null===o||void 0===o?void 0:o.includes(e),r=i.includes(e);return{id:e,title:s[e],selected:t||r,required:t,sticky:t?"start":void 0}}))),[e,s,o,i]),setColumns:r.useCallback((e=>{const s=e.filter((e=>e.selected)).map((e=>e.id));a.f.setUserSettingsValue(t,s),l(s)}),[t])}}},48295:(e,t,s)=>{s.d(t,{_:()=>u});var r=s(77506),a=s(24543),n=s(80176),o=s(60712);const i=(0,r.cn)("ydb-pool-bar"),l=({data:e={}})=>{const{Usage:t=0}=e,s=Math.min(100*t,100),r=(e=>e>=75?"danger":e>=50&&e<75?"warning":"normal")(s);return(0,o.jsx)(a.u,{className:i({type:r}),content:(0,o.jsx)(n.HG,{data:e,className:i("popup-content")}),children:(0,o.jsx)("div",{style:{height:`${s}%`},className:i("value",{type:r})})})},d=(0,r.cn)("ydb-pools-graph"),u=({pools:e=[]})=>(0,o.jsx)("div",{className:d(),children:e.map(((e,t)=>(0,o.jsx)(l,{data:e},t)))})},50672:(e,t,s)=>{s.d(t,{D:()=>n});var r=s(48372);const a=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","pdisk-page":"PDisk page","yes":"Yes"}'),n=(0,r.g4)("ydb-pDisk-info",{en:a})},51930:(e,t,s)=>{s.d(t,{d:()=>n});var r=s(5707),a=s(7187);function n(e){const t=function(e){return t=e,void 0!==t&&t in r.iZ?r.iZ[e]:r.Km;var t}(e.State),s=(0,a.SW)(e.AllocatedPercent);return t!==r.Km&&s?Math.max(t,s):t}},53755:(e,t,s)=>{s.d(t,{T:()=>l});var r=s(47665),a=s(77506);const n=(0,s(48372).g4)("ydb-entities-count",{ru:{of:"\u0438\u0437"},en:{of:"of"}});var o=s(60712);const i=(0,a.cn)("ydb-entities-count"),l=({total:e,current:t,label:s,loading:a,className:l})=>{let d="";return s&&(d+=`${s}: `),a?d+="...":(d+=`${t}`,e&&Number(e)!==Number(t)&&(d+=` ${n("of")} ${e}`)),(0,o.jsx)(r.J,{theme:"info",size:"m",className:i(null,l),children:d})}},58267:(e,t,s)=>{s.d(t,{P:()=>o,_:()=>i});var r=s(54090),a=s(6354);const n={[a.r.Dead]:r.m.Red,[a.r.Created]:r.m.Yellow,[a.r.ResolveStateStorage]:r.m.Yellow,[a.r.Candidate]:r.m.Yellow,[a.r.BlockBlobStorage]:r.m.Yellow,[a.r.WriteZeroEntry]:r.m.Yellow,[a.r.Restored]:r.m.Yellow,[a.r.Discover]:r.m.Yellow,[a.r.Lock]:r.m.Yellow,[a.r.Stopped]:r.m.Yellow,[a.r.ResolveLeader]:r.m.Yellow,[a.r.RebuildGraph]:r.m.Yellow,[a.r.Deleted]:r.m.Green,[a.r.Active]:r.m.Green},o=e=>{if(!e)return r.m.Grey;return t=e,Object.values(r.m).includes(t)?e:n[e];var t};function i(e){if(!e)return"unknown";switch(e){case a.r.Dead:return"danger";case a.r.Active:case a.r.Deleted:return"success";default:return"warning"}}},61456:(e,t,s)=>{s.d(t,{A:()=>o});var r=s(48372);const a=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),n=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),o=(0,r.g4)("ydb-storage-groups",{ru:n,en:a})},62710:(e,t,s)=>{s.d(t,{$:()=>a});var r=s(59284);function a(e){const[t,s]=r.useState({});r.useEffect((()=>{null!==e&&void 0!==e&&e.length&&s((t=>e.reduce(((e,{name:s})=>{const r=t[s];return{...e,[s]:null!==r&&void 0!==r&&r}}),{})))}),[e]);return{expandedGroups:t,setIsGroupExpanded:r.useCallback(((e,t)=>{s((s=>({...s,[e]:t})))}),[])}}},64036:(e,t,s)=>{s.d(t,{b:()=>n});var r=s(54090),a=s(5707);function n(e){const{DiskSpace:t,VDiskState:s,FrontQueues:r,Replicated:n}=e;if(!s)return a.Km;const i=o(t),l=function(e){var t;if(!e)return a.Km;return null!==(t=a.qs[e])&&void 0!==t?t:a.Km}(s),d=Math.min(a.aW.Orange,o(r));let u=Math.max(i,l,d);return!1===n&&u===a.aW.Green&&(u=a.aW.Blue),u}function o(e){var t;return e?e===r.m.Blue?a.aW.Green:null!==(t=a.aW[e])&&void 0!==t?t:a.Km:a.Km}},64934:(e,t,s)=>{s.d(t,{j:()=>o});var r=s(44433),a=s(78034),n=s(60712);const o=({value:e,onChange:t,className:s})=>(0,n.jsxs)(r.a,{value:e,onUpdate:t,className:s,children:[(0,n.jsx)(r.a.Option,{value:a.cW.All,children:a.DG[a.cW.All]}),(0,n.jsx)(r.a.Option,{value:a.cW.SmallUptime,children:a.DG[a.cW.SmallUptime]})]})},67375:(e,t,s)=>{s.d(t,{W:()=>r});let r=function(e){return e.Initial="Initial",e.LocalRecoveryError="LocalRecoveryError",e.SyncGuidRecovery="SyncGuidRecovery",e.SyncGuidRecoveryError="SyncGuidRecoveryError",e.OK="OK",e.PDiskError="PDiskError",e}({})},69464:(e,t,s)=>{s.d(t,{T:()=>a});var r=s(6388);s(23536);const a=(e,t=r.xN)=>t===r.xN?`-${e}`:e},71708:(e,t,s)=>{s.d(t,{Q:()=>d});s(59284);var r=s(33705),a=s(98089),n=s(47665),o=s(77506),i=s(60712);const l=(0,o.cn)("ydb-table-group");function d({children:e,title:t,entityName:s,count:o,expanded:d=!1,onIsExpandedChange:u}){const c=()=>{u(t,!d)};return(0,i.jsxs)("div",{className:l(null),children:[(0,i.jsx)("button",{onClick:c,className:l("button"),title:t,children:(0,i.jsxs)("div",{className:l("title-wrapper"),children:[(0,i.jsx)(r.I,{direction:d?"top":"bottom"}),(0,i.jsxs)("div",{className:l("title"),children:[(0,i.jsx)(a.E,{variant:"subheader-2",children:t}),(0,i.jsxs)(a.E,{variant:"body-2",color:"secondary",className:l("count"),children:[s,": ",(0,i.jsx)(n.J,{theme:"normal",children:o})]})]})]})}),d?(0,i.jsx)("div",{className:l("content"),children:e}):null]})}},73473:(e,t,s)=>{s.d(t,{S:()=>N});var r=s(38501),a=s(23900),n=s(46549),o=s(77506),i=s(76086),l=s(35736),d=s(41650),u=s(13096),c=s(15132),m=s(48372);const p=JSON.parse('{"text_external-consumption":"External Consumption","text_allocator-caches":"Allocator Caches","text_shared-cache":"Shared Cache","text_memtable":"MemTable","text_query-execution":"Query Execution","text_usage":"Usage","text_soft-limit":"Soft Limit","text_hard-limit":"Hard Limit","text_other":"Other"}'),h=(0,m.g4)("ydb-memory-viewer",{en:p});function g(e){return(0,d.kf)(e)?parseFloat(String(e)):void 0}var v=s(60712);const f=1,S=.01*i.J7,k=(0,o.cn)("memory-viewer"),y=(e,t)=>[(0,n.z3)({value:e,size:"gb",withSizeLabel:!1,precision:2}),(0,n.z3)({value:t,size:"gb",withSizeLabel:!0,precision:1})];function N({stats:e,percents:t,formatValues:s,className:o,warningThreshold:i,dangerThreshold:m}){var p;const N=null!==(p=e.AnonRss)&&void 0!==p?p:function(e){const t=g(e.AllocatedMemory)||0,s=g(e.AllocatorCachesMemory)||0;return String(t+s)}(e),b=e.HardLimit,x=(0,r.D)();let D=Math.round(parseFloat(String(N))/parseFloat(String(b))*100)||0;D=D>100?100:D;let w=N,I=b,C="/";t?(w=D+"%",I="",C=""):s&&([w,I]=s(Number(N),Number(b)));const P=function(e,t){const s=[{label:h("text_shared-cache"),key:"SharedCacheConsumption",value:g(e.SharedCacheConsumption),capacity:g(e.SharedCacheLimit),isInfo:!1},{label:h("text_query-execution"),key:"QueryExecutionConsumption",value:g(e.QueryExecutionConsumption),capacity:g(e.QueryExecutionLimit),isInfo:!1},{label:h("text_memtable"),key:"MemTableConsumption",value:g(e.MemTableConsumption),capacity:g(e.MemTableLimit),isInfo:!1},{label:h("text_allocator-caches"),key:"AllocatorCachesMemory",value:g(e.AllocatorCachesMemory),isInfo:!1}],r=s.filter((e=>void 0!==e.value)).reduce(((e,t)=>e+t.value),0),a=Math.max(0,t-r);return s.push({label:h("text_other"),key:"Other",value:a,isInfo:!1}),s.push({label:h("text_external-consumption"),key:"ExternalConsumption",value:g(e.ExternalConsumption),isInfo:!0},{label:h("text_usage"),key:"Usage",value:t,isInfo:!0},{label:h("text_soft-limit"),key:"SoftLimit",value:g(e.SoftLimit),isInfo:!0},{label:h("text_hard-limit"),key:"HardLimit",value:g(e.HardLimit),isInfo:!0}),s.filter((e=>void 0!==e.value))}(e,Number(N)),j=(0,l.w)({fillWidth:D,warningThreshold:i,dangerThreshold:m,colorizeProgress:!0});let A=0;return(0,v.jsx)(u.P,{renderPopupContent:()=>(0,v.jsx)(a.u,{responsive:!0,children:P.map((({label:e,value:t,capacity:s,key:r})=>(0,v.jsx)(a.u.Item,{name:(0,v.jsxs)("div",{className:k("container"),children:[(0,v.jsx)("div",{className:k("legend",{type:r})}),(0,v.jsx)("div",{className:k("name"),children:e})]}),children:s?(0,v.jsx)(c.O,{value:t,capacity:s,formatValues:y,colorizeProgress:!0}):(0,n.z3)({value:t,size:"gb",withSizeLabel:!0,precision:2})},e)))}),children:(0,v.jsx)("div",{className:k({theme:x,status:j},o),children:(0,v.jsxs)("div",{className:k("progress-container"),children:[P.filter((({isInfo:e})=>!e)).map((e=>{if(e.value<S)return null;const t=Math.max((s=e.value,N?s/parseFloat(String(b))*100:0),f);var s;const r=A;return A+=t,(0,v.jsx)("div",{className:k("segment",{type:e.key}),style:{width:`${t}%`,left:`${r}%`}},e.key)})),(0,v.jsx)("div",{className:k("text"),children:(0,d.kf)(b)?`${w} ${C} ${I}`:w})]})})})}},78461:(e,t,s)=>{s.d(t,{Y:()=>a});const r={HDD:"HDD",SSD:"SSD",MVME:"NVME"};function a(e){if(!e)return;const t=function(e,t){const s={};return Object.entries(t).reduce(((t,[r,a])=>{const n=e.length-t,o=n-a;return s[r]=e.substring(o,n)||"0",t+a}),0),s}(BigInt(e).toString(2),{isSolidState:1,kind:55,typeExt:8});if("1"===t.isSolidState)switch(parseInt(t.typeExt,2)){case 0:return r.SSD;case 2:return r.MVME}else if("0"===t.typeExt)return r.HDD}},78762:(e,t,s)=>{s.d(t,{pt:()=>se,SH:()=>X,fr:()=>_,uk:()=>L,Bg:()=>Y,Nh:()=>M,ID:()=>B,fR:()=>$,iX:()=>H,Vz:()=>Q,H:()=>q,_E:()=>R,eT:()=>G,wN:()=>te,kv:()=>F,pH:()=>O,OX:()=>z,ui:()=>ee,DH:()=>Z,oz:()=>K,qp:()=>J,jl:()=>W,Rn:()=>V});var r=s(4557),a=s(23900),n=s(7435),o=s(77506),i=s(76086),l=s(56839),d=s(16439),u=s(41650),c=s(71661),m=s(73473),p=s(29819),h=s(31684),g=s(78034),v=s(10508),f=s(80176),S=s(60712);const k=({node:e,getNodeRef:t,database:s,statusForIcon:r})=>{if(!e.Host)return(0,S.jsx)("span",{children:"\u2014"});const a="ConnectStatus"===r?e.ConnectStatus:e.SystemState,n=!(0,g.X7)(e);let o;if(t){const s=t(e);o=s?(0,h.Un)(s):void 0}else if(e.NodeId){const t=(0,h.Kx)(e.NodeId);o=(0,h.Un)(t)}const i=n?(0,p.vI)(e.NodeId,{database:null!==s&&void 0!==s?s:e.TenantName},e.TenantName?"tablets":"storage"):void 0;return(0,S.jsx)(v.c,{name:e.Host,status:a,path:i,hasClipboardButton:!0,infoPopoverContent:n?(0,S.jsx)(f.p,{data:e,nodeHref:o}):null})};var y=s(48295),N=s(15132),b=s(52905),x=s(58267);const D=(0,o.cn)("tablets-statistic"),w=({tablets:e=[],database:t,nodeId:s})=>{const r=(e=>e.map((e=>({label:(0,i.bk)(e.Type),type:e.Type,count:e.Count,state:(0,x.P)(e.State)}))).sort(((e,t)=>String(e.label).localeCompare(String(t.label)))))(e);return(0,S.jsx)("div",{className:D(),children:r.map(((e,r)=>{var a;const n=(0,p.vI)(s,{database:t},"tablets"),o=`${e.label}: ${e.count}`,i=D("tablet",{state:null===(a=e.state)||void 0===a?void 0:a.toLowerCase()});return(0,S.jsx)(b.N_,{to:n,className:i,children:o},r)}))})};var I=s(41826),C=s(13342),P=s(86782),j=s(31911),A=s(73891);function E(e){return(0,A.Xo)((0,A.Jc)(e,1))}function T(e){const t=(0,A.Jc)(e,1);return(Number(t)<=0?"":"+")+(0,A.Xo)(t)}const U=(0,o.cn)("ydb-nodes-columns");function R(){return{name:P.vg.NodeId,header:"#",width:80,resizeMinWidth:80,render:({row:e})=>e.NodeId,align:r.Ay.RIGHT}}function M({getNodeRef:e,database:t},{statusForIcon:s="SystemState"}={}){return{name:P.vg.Host,header:P.uG.Host,render:({row:r})=>(0,S.jsx)(k,{node:r,getNodeRef:e,database:t,statusForIcon:s}),width:350,align:r.Ay.LEFT}}function G(){return{name:P.vg.NodeName,header:P.uG.NodeName,align:r.Ay.LEFT,render:({row:e})=>e.NodeName||i.Pd,width:200}}function L(){return{name:P.vg.DC,header:P.uG.DC,align:r.Ay.LEFT,render:({row:e})=>e.DC||i.Pd,width:60}}function z(){return{name:P.vg.Rack,header:P.uG.Rack,align:r.Ay.LEFT,render:({row:e})=>e.Rack||i.Pd,width:100}}function V(){return{name:P.vg.Version,header:P.uG.Version,width:200,align:r.Ay.LEFT,render:({row:e})=>(0,S.jsx)(c.s,{content:e.Version,children:e.Version})}}function W(){return{name:P.vg.Uptime,header:P.uG.Uptime,sortAccessor:({StartTime:e})=>e?-e:0,render:({row:e})=>(0,S.jsx)(I.p,{StartTime:e.StartTime,DisconnectTime:e.DisconnectTime}),align:r.Ay.RIGHT,width:120}}function O(){return{name:P.vg.RAM,header:P.uG.RAM,sortAccessor:({MemoryUsed:e=0})=>Number(e),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>{const[t,s]=(0,u.kf)(e.MemoryUsed)&&(0,u.kf)(e.MemoryLimit)?(0,l.j9)(Number(e.MemoryUsed),Number(e.MemoryLimit),"gb",void 0,!0):[0,0];return(0,S.jsx)(c.s,{placement:["top","auto"],fullWidth:!0,content:(0,S.jsxs)(a.u,{responsive:!0,children:[(0,S.jsx)(a.u.Item,{name:(0,j.A)("field_memory-used"),children:t}),(0,S.jsx)(a.u.Item,{name:(0,j.A)("field_memory-limit"),children:s})]}),children:(0,S.jsx)(N.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:(e,t)=>(0,l.j9)(e,t,"gb",void 0,!0),className:U("column-ram"),colorizeProgress:!0,hideCapacity:!0})})},align:r.Ay.LEFT,width:80,resizeMinWidth:40}}function H(){return{name:P.vg.Memory,header:P.uG.Memory,defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.MemoryStats?(0,S.jsx)(m.S,{formatValues:l.vX,stats:e.MemoryStats}):(0,S.jsx)(N.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:l.vX,colorizeProgress:!0}),align:r.Ay.LEFT,width:300,resizeMinWidth:170}}function F(){return{name:P.vg.Pools,header:P.uG.Pools,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map((({Usage:e})=>Number(e)))),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.PoolStats?(0,S.jsx)(y._,{pools:e.PoolStats}):i.Pd,align:r.Ay.LEFT,width:80,resizeMinWidth:60}}function _(){return{name:P.vg.CPU,header:P.uG.CPU,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map((({Usage:e})=>Number(e)))),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>{if(!e.PoolStats)return i.Pd;let t=(0,u.kf)(e.CoresUsed)&&(0,u.kf)(e.CoresTotal)?e.CoresUsed/e.CoresTotal:void 0;if(void 0===t){let s=0;t=e.PoolStats.reduce(((e,t)=>(s+=Number(t.Threads),e+Number(t.Usage)*Number(t.Threads))),0),t/=s}return(0,S.jsx)(c.s,{placement:["top","auto"],fullWidth:!0,content:(0,S.jsx)(a.u,{responsive:!0,children:e.PoolStats.map((e=>(0,u.kf)(e.Usage)?(0,S.jsx)(a.u.Item,{name:e.Name,children:(0,f.Qz)("Usage",e.Usage).value},e.Name):null))}),children:(0,S.jsx)(N.O,{className:U("column-cpu"),value:t,capacity:1,colorizeProgress:!0,percents:!0})})},align:r.Ay.LEFT,width:80,resizeMinWidth:40}}function B(){return{name:P.vg.LoadAverage,header:P.uG.LoadAverage,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:r.Ay.DESCENDING,render:({row:e})=>(0,S.jsx)(N.O,{value:e.LoadAveragePercents&&e.LoadAveragePercents.length>0?e.LoadAveragePercents[0]:void 0,percents:!0,colorizeProgress:!0,capacity:100}),align:r.Ay.LEFT,width:170,resizeMinWidth:170}}function $(){return{name:P.vg.Load,header:P.uG.Load,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.LoadAveragePercents&&e.LoadAveragePercents.length>0?(0,S.jsx)(C.U,{value:e.LoadAveragePercents[0].toFixed(),theme:(0,d.f)(e.LoadAveragePercents[0])}):i.Pd,align:r.Ay.LEFT,width:80,resizeMinWidth:70}}function Y(){return{name:P.vg.DiskSpaceUsage,header:P.uG.DiskSpaceUsage,render:({row:e})=>(0,n.f8)(e.DiskSpaceUsage)?(0,S.jsx)(C.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,d.f)(e.DiskSpaceUsage)}):i.Pd,align:r.Ay.LEFT,width:115,resizeMinWidth:75}}function K(){return{name:P.vg.TotalSessions,header:P.uG.TotalSessions,render:({row:e})=>{var t;return null!==(t=e.TotalSessions)&&void 0!==t?t:i.Pd},align:r.Ay.RIGHT,width:100}}function J({database:e}){return{name:P.vg.Tablets,header:P.uG.Tablets,width:500,resizeMinWidth:500,render:({row:t})=>t.Tablets?(0,S.jsx)(w,{database:null!==e&&void 0!==e?e:t.TenantName,nodeId:t.NodeId,tablets:t.Tablets}):i.Pd,align:r.Ay.LEFT,sortable:!1}}function Q(){return{name:P.vg.Missing,header:P.uG.Missing,render:({row:e})=>e.Missing,align:r.Ay.CENTER,defaultOrder:r.Ay.DESCENDING}}function X(){return{name:P.vg.Connections,header:P.uG.Connections,render:({row:e})=>(0,u.kf)(e.Connections)?e.Connections:i.Pd,align:r.Ay.RIGHT,width:130}}function q(){return{name:P.vg.NetworkUtilization,header:P.uG.NetworkUtilization,render:({row:e})=>{const{NetworkUtilization:t,NetworkUtilizationMin:s=0,NetworkUtilizationMax:r=0}=e;return(0,u.kf)(t)?(0,S.jsx)(c.s,{placement:["top","auto"],fullWidth:!0,content:(0,S.jsxs)(a.u,{responsive:!0,children:[(0,S.jsx)(a.u.Item,{name:(0,j.A)("sum"),children:(0,l.l9)(t)},"NetworkUtilization"),(0,S.jsx)(a.u.Item,{name:(0,j.A)("min"),children:(0,l.l9)(s)},"NetworkUtilizationMin"),(0,S.jsx)(a.u.Item,{name:(0,j.A)("max"),children:(0,l.l9)(r)},"NetworkUtilizationMax")]}),children:(0,l.l9)(t)}):i.Pd},align:r.Ay.RIGHT,width:110}}function Z(){return{name:P.vg.SendThroughput,header:P.uG.SendThroughput,render:({row:e})=>(0,u.kf)(e.SendThroughput)?(0,u.O4)(e.SendThroughput):i.Pd,align:r.Ay.RIGHT,width:110}}function ee(){return{name:P.vg.ReceiveThroughput,header:P.uG.ReceiveThroughput,render:({row:e})=>(0,u.kf)(e.ReceiveThroughput)?(0,u.O4)(e.ReceiveThroughput):i.Pd,align:r.Ay.RIGHT,width:110}}function te(){return{name:P.vg.PingTime,header:P.uG.PingTime,render:({row:e})=>{const{PingTimeUs:t,PingTimeMinUs:s=0,PingTimeMaxUs:r=0}=e;return(0,u.kf)(t)?(0,S.jsx)(c.s,{placement:["top","auto"],fullWidth:!0,content:(0,S.jsxs)(a.u,{responsive:!0,children:[(0,S.jsx)(a.u.Item,{name:(0,j.A)("avg"),children:E(t)},"PingTimeUs"),(0,S.jsx)(a.u.Item,{name:(0,j.A)("min"),children:E(s)},"PingTimeMinUs"),(0,S.jsx)(a.u.Item,{name:(0,j.A)("max"),children:E(r)},"PingTimeMaxUs")]}),children:E(t)}):i.Pd},align:r.Ay.RIGHT,width:110}}function se(){return{name:P.vg.ClockSkew,header:P.uG.ClockSkew,render:({row:e})=>{const{ClockSkewUs:t,ClockSkewMinUs:s=0,ClockSkewMaxUs:r=0}=e;return(0,u.kf)(t)?(0,S.jsx)(c.s,{placement:["top","auto"],fullWidth:!0,content:(0,S.jsxs)(a.u,{responsive:!0,children:[(0,S.jsx)(a.u.Item,{name:(0,j.A)("avg"),children:T(t)},"ClockSkewUs"),(0,S.jsx)(a.u.Item,{name:(0,j.A)("min"),children:T(s)},"ClockSkewMinUs"),(0,S.jsx)(a.u.Item,{name:(0,j.A)("max"),children:T(r)},"ClockSkewMaxUs")]}),children:T(t)}):i.Pd},align:r.Ay.RIGHT,width:110}}},86782:(e,t,s)=>{s.d(t,{fN:()=>c,kU:()=>p,kn:()=>u,sp:()=>h,uG:()=>l,vg:()=>n,xd:()=>i,zO:()=>a});var r=s(31911);const a="nodesTableColumnsWidth",n={NodeId:"NodeId",Host:"Host",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"RAM",CPU:"CPU",Pools:"Pools",LoadAverage:"LoadAverage",Load:"Load",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:"TotalSessions",Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:"Tablets",PDisks:"PDisks"},o=["Pools","Memory"];function i(e){return o.includes(e)}const l={get NodeId(){return(0,r.A)("node-id")},get Host(){return(0,r.A)("host")},get Database(){return(0,r.A)("database")},get NodeName(){return(0,r.A)("node-name")},get DC(){return(0,r.A)("dc")},get Rack(){return(0,r.A)("rack")},get Version(){return(0,r.A)("version")},get Uptime(){return(0,r.A)("uptime")},get Memory(){return(0,r.A)("memory")},get RAM(){return(0,r.A)("ram")},get Pools(){return(0,r.A)("pools")},get CPU(){return(0,r.A)("cpu")},get LoadAverage(){return(0,r.A)("load-average")},get Load(){return(0,r.A)("load")},get DiskSpaceUsage(){return(0,r.A)("disk-usage")},get TotalSessions(){return(0,r.A)("sessions")},get Connections(){return(0,r.A)("connections")},get NetworkUtilization(){return(0,r.A)("utilization")},get SendThroughput(){return(0,r.A)("send")},get ReceiveThroughput(){return(0,r.A)("receive")},get PingTime(){return(0,r.A)("ping")},get ClockSkew(){return(0,r.A)("skew")},get Missing(){return(0,r.A)("missing")},get Tablets(){return(0,r.A)("tablets")},get PDisks(){return(0,r.A)("pdisks")}},d={get NodeId(){return(0,r.A)("node-id")},get Host(){return(0,r.A)("host")},get NodeName(){return(0,r.A)("node-name")},get Database(){return(0,r.A)("database")},get DiskSpaceUsage(){return(0,r.A)("disk-usage")},get DC(){return(0,r.A)("dc")},get Rack(){return(0,r.A)("rack")},get Missing(){return(0,r.A)("missing")},get Uptime(){return(0,r.A)("uptime")},get Version(){return(0,r.A)("version")},get SystemState(){return(0,r.A)("system-state")},get ConnectStatus(){return(0,r.A)("connect-status")},get NetworkUtilization(){return(0,r.A)("network-utilization")},get ClockSkew(){return(0,r.A)("clock-skew")},get PingTime(){return(0,r.A)("ping-time")}};function u(e){return d[e]}const c={NodeId:["NodeId"],Host:["Host","Rack","Database","SystemState"],Database:["Database"],NodeName:["NodeName"],DC:["DC"],Rack:["Rack"],Version:["Version"],Uptime:["Uptime","DisconnectTime"],Memory:["Memory","MemoryDetailed"],RAM:["Memory"],Pools:["CPU"],CPU:["CPU"],LoadAverage:["LoadAverage"],Load:["LoadAverage"],DiskSpaceUsage:["DiskSpaceUsage"],TotalSessions:["SystemState"],Connections:["Connections"],NetworkUtilization:["NetworkUtilization"],SendThroughput:["SendThroughput"],ReceiveThroughput:["ReceiveThroughput"],PingTime:["PingTime"],ClockSkew:["ClockSkew"],Missing:["Missing"],Tablets:["Tablets","Database"],PDisks:["PDisks"]},m={NodeId:"NodeId",Host:"Host",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"Memory",CPU:"CPU",Pools:"CPU",LoadAverage:"LoadAverage",Load:"LoadAverage",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:void 0,Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:void 0,PDisks:void 0};function p(e){return m[e]}function h(e){return Boolean(p(e))}},88226:(e,t,s)=>{s.d(t,{V:()=>d});s(59284);var r=s(77506),a=s(76086),n=s(7187),o=s(90182),i=s(60712);const l=(0,r.cn)("storage-disk-progress-bar");function d({diskAllocatedPercent:e=-1,severity:t,compact:s,faded:r,inactive:d,empty:u,content:c,className:m}){const[p]=(0,o.iK)(a.TJ),h={inverted:p,compact:s,faded:r,empty:u,inactive:d},g=void 0!==t&&(0,n.XY)(t);g&&(h[g.toLocaleLowerCase()]=!0);return(0,i.jsxs)("div",{className:l(h,m),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":e,children:[(()=>{if(s)return(0,i.jsx)("div",{className:l("fill-bar",h),style:{width:"100%"}});const t=p?100-e:e;return e>=0?(0,i.jsx)("div",{className:l("fill-bar",h),style:{width:`${t}%`}}):null})(),c||(!s&&e>=0?(0,i.jsx)("div",{className:l("title"),children:`${Math.round(e)}%`}):null)]})}},89073:(e,t,s)=>{s.d(t,{L:()=>i});var r=s(77506),a=s(19228),n=s(60712);const o=(0,r.cn)("ydb-table-with-controls-layout"),i=({children:e,className:t})=>(0,n.jsx)("div",{className:o(null,t),children:e});i.Controls=function({children:e,className:t}){return(0,n.jsx)("div",{className:o("controls-wrapper"),children:(0,n.jsx)("div",{className:o("controls",t),children:e})})},i.Table=function({children:e,loading:t,className:s}){return t?(0,n.jsx)(a.Q,{className:o("loader")}):(0,n.jsx)("div",{className:o("table",s),children:e})}},90053:(e,t,s)=>{s.d(t,{E:()=>h});var r=s(8873),a=s(84476),n=s(24555),o=s(21334),i=s(77506),l=s(90182),d=s(48372);const u=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),c=(0,d.g4)("ydb-diagnostics-autorefresh-control",{en:u});var m=s(60712);const p=(0,i.cn)("auto-refresh-control");function h({className:e,onManualRefresh:t}){const s=(0,l.YQ)(),[i,d]=(0,l.Nt)();return(0,m.jsxs)("div",{className:p(null,e),children:[(0,m.jsx)(a.$,{view:"flat-secondary",onClick:()=>{s(o.F.util.invalidateTags(["All"])),null===t||void 0===t||t()},extraProps:{"aria-label":c("Refresh")},children:(0,m.jsx)(a.$.Icon,{children:(0,m.jsx)(r.A,{})})}),(0,m.jsxs)(n.l,{value:[String(i)],onUpdate:e=>{d(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,m.jsx)(n.l.Option,{value:"0",children:c("None")}),(0,m.jsx)(n.l.Option,{value:"15000",children:c("15 sec")}),(0,m.jsx)(n.l.Option,{value:"60000",children:c("1 min")}),(0,m.jsx)(n.l.Option,{value:"120000",children:c("2 min")}),(0,m.jsx)(n.l.Option,{value:"300000",children:c("5 min")})]})]})}},94025:(e,t,s)=>{s.d(t,{t:()=>r});let r=function(e){return e.Initial="Initial",e.InitialFormatRead="InitialFormatRead",e.InitialFormatReadError="InitialFormatReadError",e.InitialSysLogRead="InitialSysLogRead",e.InitialSysLogReadError="InitialSysLogReadError",e.InitialSysLogParseError="InitialSysLogParseError",e.InitialCommonLogRead="InitialCommonLogRead",e.InitialCommonLogReadError="InitialCommonLogReadError",e.InitialCommonLogParseError="InitialCommonLogParseError",e.CommonLoggerInitError="CommonLoggerInitError",e.Normal="Normal",e.OpenFileError="OpenFileError",e.ChunkQuotaError="ChunkQuotaError",e.DeviceIoError="DeviceIoError",e.Stopped="Stopped",e.Missing="Missing",e.Timeout="Timeout",e.NodeDisconnected="NodeDisconnected",e.Unknown="Unknown",e}({})},96927:(e,t,s)=>{s.d(t,{O:()=>y,f:()=>k});var r=s(59284),a=s(87184),n=s(92459),o=s(24600),i=s(54090),l=s(7435),d=s(76086),u=s(31684),c=s(90182),m=s(12888),p=s(41650),h=s(60073),g=s(25196),v=s(50672),f=s(60712);const S=[i.m.Orange,i.m.Red,i.m.Yellow],k=(e,t,s)=>{const{AvailableSize:r,TotalSize:o,State:i,PDiskId:c,NodeId:m,StringifiedId:h,Path:k,Realtime:y,Type:N,Device:b}=e,x=[{label:"PDisk",value:null!==h&&void 0!==h?h:d.Pd},{label:"State",value:i||"not available"},{label:"Type",value:N||"unknown"}];if(m&&x.push({label:"Node Id",value:m}),null!==t&&void 0!==t&&t.Host&&x.push({label:"Host",value:t.Host}),null!==t&&void 0!==t&&t.DC&&x.push({label:"DC",value:t.DC}),k&&x.push({label:"Path",value:k}),(0,p.kf)(o)&&x.push({label:"Available",value:`${(0,p.wb)(r)} of ${(0,p.wb)(o)}`}),y&&S.includes(y)&&x.push({label:"Realtime",value:y}),b&&S.includes(b)&&x.push({label:"Device",value:b}),s&&(0,l.f8)(m)&&(0,l.f8)(c)){const e=(0,u.ar)({nodeId:m,pDiskId:c}),t=(0,n.Ck)(c,m);x.push({label:"Links",value:(0,f.jsxs)(a.s,{gap:2,wrap:"wrap",children:[(0,f.jsx)(g.K,{title:(0,v.D)("pdisk-page"),url:t,external:!1}),(0,f.jsx)(g.K,{title:(0,v.D)("developer-ui"),url:e})]})})}return x},y=({data:e})=>{const t=(0,m.X)(),s=(0,c.N4)(o.K),a=(0,l.f8)(e.NodeId)?null===s||void 0===s?void 0:s.get(e.NodeId):void 0,n=r.useMemo((()=>k(e,a,t)),[e,a,t]);return(0,f.jsx)(h.z_,{title:"PDisk",info:n,size:"s"})}},99936:(e,t,s)=>{s.d(t,{z:()=>Ve});var r=s(12888),a=s(59284),n=s(79553),o=s(98167),i=s(89073),l=s(67028),d=s(10174),u=s(90182),c=s(69775),m=s(98089),p=s(24555),h=s(53755),g=s(41775),v=s(64934),f=s(10360),S=s(370),k=s(86782);const y=["NodeId","Host","Uptime","CPU","RAM","PDisks"],N=["NodeId"],b=["Host","DC","Rack","Version","Uptime","Missing","DiskSpaceUsage"],x=b.map((e=>({value:e,content:(0,k.kn)(e)}))),D=S.z.custom((e=>b.includes(e))).catch(void 0);var w=s(44433);const I={all:"all",missing:"missing",space:"space"},C={groups:"groups",nodes:"nodes"};var P=s(60712);const j={[C.groups]:"Groups",[C.nodes]:"Nodes"},A=({value:e,onChange:t})=>(0,P.jsxs)(w.a,{value:e,onUpdate:t,qa:"storage-type-filter",children:[(0,P.jsx)(w.a.Option,{value:C.groups,children:j[C.groups]}),(0,P.jsx)(w.a.Option,{value:C.nodes,children:j[C.nodes]})]}),E={[I.all]:"All",[I.missing]:"Degraded",[I.space]:"Out of Space"},T=({value:e,onChange:t})=>(0,P.jsxs)(w.a,{value:e,onUpdate:t,qa:"storage-visible-entities-filter",children:[(0,P.jsx)(w.a.Option,{value:I.missing,children:E[I.missing]}),(0,P.jsx)(w.a.Option,{value:I.space,children:E[I.space]}),(0,P.jsx)(w.a.Option,{value:I.all,children:E[I.all]})]});var U=s(48372);const R=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN","controls_group-by-placeholder":"Group by:","no-nodes":"No such nodes","no-groups":"No such groups"}'),M=(0,U.g4)("ydb-storage",{en:R});var G=s(59109),L=s(44508),z=s(77506);const V=(0,z.cn)("global-storage"),W=e=>403===e.status?(0,P.jsx)(G.O,{position:"left"}):(0,P.jsx)(L.o,{error:e});var O=s(67087);const H=S.z.nativeEnum(I).catch(I.all),F=S.z.nativeEnum(C).catch(C.groups);var _=s(78034);function B(){var e;const[t,s]=(0,O.useQueryParams)({type:O.StringParam,visible:O.StringParam,search:O.StringParam,uptimeFilter:O.StringParam,storageNodesGroupBy:O.StringParam,storageGroupsGroupBy:O.StringParam}),r=F.parse(t.type),a=H.parse(t.visible),n=null!==(e=t.search)&&void 0!==e?e:"",o=_.Bm.parse(t.uptimeFilter),i=f.kY.parse(t.storageGroupsGroupBy),l=D.parse(t.storageNodesGroupBy),d=e=>{s({visible:e},"replaceIn")},u=e=>{s({uptimeFilter:e},"replaceIn")};return{storageType:r,visibleEntities:a,searchValue:n,nodesUptimeFilter:o,storageGroupsGroupByParam:i,storageNodesGroupByParam:l,handleTextFilterChange:e=>{s({search:e||void 0},"replaceIn")},handleVisibleEntitiesChange:d,handleStorageTypeChange:e=>{s({type:e},"replaceIn")},handleUptimeFilterChange:u,handleStorageGroupsGroupByParamChange:e=>{s({storageGroupsGroupBy:e},"replaceIn")},handleStorageNodesGroupByParamChange:e=>{s({storageNodesGroupBy:e},"replaceIn")},handleShowAllGroups:()=>{d("all")},handleShowAllNodes:()=>{d("all"),u(_.cW.All)}}}function $({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:s,entitiesCountTotal:n,entitiesLoading:o,columnsToSelect:i,handleSelectedColumnsUpdate:l}){const{searchValue:d,storageType:u,visibleEntities:v,storageGroupsGroupByParam:S,handleTextFilterChange:k,handleStorageTypeChange:y,handleVisibleEntitiesChange:N,handleStorageGroupsGroupByParamChange:b}=B(),x=(0,r.X)(),D=e&&x;return(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(g.v,{value:d,onChange:k,placeholder:M("controls_groups-search-placeholder"),className:V("search")}),D&&(0,P.jsx)(A,{value:u,onChange:y}),t?null:(0,P.jsx)(T,{value:v,onChange:N}),(0,P.jsx)(c.O,{popupWidth:200,items:i,showStatus:!0,onUpdate:l,sortable:!1}),t?(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(m.E,{variant:"body-2",children:M("controls_group-by-placeholder")}),(0,P.jsx)(p.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:S?[S]:void 0,onUpdate:e=>{b(e[0])},options:f.SE})]}):null,(0,P.jsx)(h.T,{label:M("groups"),loading:o,total:n,current:s})]})}function Y({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:s,entitiesCountTotal:r,entitiesLoading:n,columnsToSelect:o,handleSelectedColumnsUpdate:i}){const{searchValue:l,storageType:d,visibleEntities:u,nodesUptimeFilter:f,storageNodesGroupByParam:S,handleTextFilterChange:k,handleStorageTypeChange:y,handleVisibleEntitiesChange:N,handleUptimeFilterChange:b,handleStorageNodesGroupByParamChange:D}=B();return(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(g.v,{value:l,onChange:k,placeholder:M("controls_nodes-search-placeholder"),className:V("search")}),e&&(0,P.jsx)(A,{value:d,onChange:y}),t?null:(0,P.jsx)(T,{value:u,onChange:N}),t?null:(0,P.jsx)(v.j,{value:f,onChange:b}),(0,P.jsx)(c.O,{popupWidth:200,items:o,showStatus:!0,onUpdate:i,sortable:!1}),t?(0,P.jsxs)(a.Fragment,{children:[(0,P.jsx)(m.E,{variant:"body-2",children:M("controls_group-by-placeholder")}),(0,P.jsx)(p.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:S?[S]:void 0,onUpdate:e=>{D(e[0])},options:x})]}):null,(0,P.jsx)(h.T,{label:M("nodes"),loading:n,total:r,current:s})]})}var K=s(40427),J=s(84476),Q=s(7889),X=s(78524);const q=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),Z=JSON.parse('{"default_message":"\u0412\u0441\u0451 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435!","default_button_label":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"}'),ee=(0,U.g4)("ydb-storage-empty-filter",{ru:Z,en:q}),te=({title:e,message:t=ee("default_message"),showAll:s=ee("default_button_label"),onShowAll:r})=>(0,P.jsx)(Q.p,{image:(0,P.jsx)(X.v,{name:"thumbsUp"}),position:"left",title:e,description:t,actions:r&&[(0,P.jsx)(J.$,{onClick:r,children:s},"show-all")]});var se=s(61456);const re=({visibleEntities:e,onShowAll:t})=>{let s;return e===I.space&&(s=(0,se.A)("empty.out_of_space")),e===I.missing&&(s=(0,se.A)("empty.degraded")),s?(0,P.jsx)(te,{title:s,showAll:(0,se.A)("show_all"),onShowAll:t}):null};var ae=s(16029),ne=s(69464),oe=s(40781);const ie=({columns:e,database:t,nodeId:s,groupId:r,pDiskId:n,filterGroup:i,filterGroupBy:d,searchValue:u,visibleEntities:c,onShowAll:m,parentRef:p,renderControls:h,renderErrorMessage:g,initialEntitiesCount:v})=>{const S=(0,l.Pm)(),k=(0,l.YA)(),y=(N=k,a.useCallback((async e=>{const{limit:t,offset:s,sortParams:r,filters:a,columnsIds:n}=e,{sortOrder:o,columnId:i}=null!==r&&void 0!==r?r:{},{searchValue:l,visibleEntities:d,database:u,nodeId:c,groupId:m,pDiskId:p,filterGroup:h,filterGroupBy:g}=null!==a&&void 0!==a?a:{},v=(0,f.GP)(i),S=v?(0,ne.T)(v,o):void 0,k=(0,oe.R)(n,f.YX),{groups:y,found:b,total:x}=await(0,ae.t)({limit:t,offset:s,sort:S,filter:l,with:d,database:u,nodeId:c,groupId:m,pDiskId:p,filter_group:h,filter_group_by:g,fieldsRequired:k,shouldUseGroupsHandler:N});return{data:y||[],found:b||0,total:x||0}}),[N]));var N;const b=a.useMemo((()=>({searchValue:u,visibleEntities:c,database:t,nodeId:s,groupId:r,pDiskId:n,filterGroup:i,filterGroupBy:d})),[u,c,t,s,r,n,i,d]);return(0,P.jsx)(o.r,{loading:!S,children:(0,P.jsx)(K.k5,{columnsWidthLSKey:f.qK,parentRef:p,columns:e,fetchData:y,initialEntitiesCount:v,renderControls:h,renderErrorMessage:g,renderEmptyDataMessage:()=>c!==I.all?(0,P.jsx)(re,{onShowAll:m,visibleEntities:c}):(0,se.A)("empty.default"),filters:b,tableName:"storage-groups"})})};var le=s(43951),de=s(20831);function ue({visibleEntities:e,viewContext:t}){const s=(0,r.X)(),n=a.useMemo((()=>{const e=(0,de.J)({viewContext:t});return s?e:e.filter((e=>!(0,f.Ai)(e.name)))}),[s,t]),o=a.useMemo((()=>e===I.missing?[...f.LO,f.UW.Degraded]:e===I.space?[...f.LO,f.UW.DiskSpace]:f.LO),[e]);return(0,le.K)(n,f.zY,f.H6,f.hu,o)}var ce=s(71708),me=s(62710);function pe(e){const{storageGroupsGroupByParam:t,visibleEntities:s,handleShowAllGroups:r}=B(),n=(0,l.Pm)(),i=(0,l.SA)();a.useEffect((()=>{i&&"all"!==s&&r()}),[r,i,s]);return(0,P.jsx)(o.r,{loading:!n,children:i&&t?(0,P.jsx)(ge,{...e}):(0,P.jsx)(he,{...e})})}function he({database:e,nodeId:t,groupId:s,pDiskId:r,viewContext:a,parentRef:n,initialEntitiesCount:o}){const{searchValue:i,visibleEntities:d,handleShowAllGroups:u}=B(),c=(0,l.SA)(),{columnsToShow:m,columnsToSelect:p,setColumns:h}=ue({visibleEntities:d,viewContext:a});return(0,P.jsx)(ie,{database:e,nodeId:t,groupId:s,pDiskId:r,searchValue:i,visibleEntities:d,onShowAll:u,parentRef:n,renderControls:({totalEntities:e,foundEntities:t,inited:s})=>(0,P.jsx)($,{withTypeSelector:!0,withGroupBySelect:c,entitiesCountCurrent:t,entitiesCountTotal:e,entitiesLoading:!s,columnsToSelect:p,handleSelectedColumnsUpdate:h}),renderErrorMessage:W,columns:m,initialEntitiesCount:o})}function ge({database:e,nodeId:t,groupId:s,pDiskId:r,parentRef:a,viewContext:o}){const[l]=(0,u.Nt)(),{searchValue:c,storageGroupsGroupByParam:m,visibleEntities:p,handleShowAllGroups:h}=B(),{columnsToShow:g,columnsToSelect:v,setColumns:f}=ue({visibleEntities:p,viewContext:o}),{currentData:S,isFetching:k,error:y}=d.S.useGetStorageGroupsInfoQuery({database:e,with:"all",nodeId:t,groupId:s,pDiskId:r,filter:c,shouldUseGroupsHandler:!0,group:m},{pollingInterval:l}),N=void 0===S&&k,{tableGroups:b,found:x=0,total:D=0}=S||{},{expandedGroups:w,setIsGroupExpanded:I}=(0,me.$)(b);return(0,P.jsxs)(i.L,{children:[(0,P.jsx)(i.L.Controls,{children:(0,P.jsx)($,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:x,entitiesCountTotal:D,entitiesLoading:N,columnsToSelect:v,handleSelectedColumnsUpdate:f})}),y?(0,P.jsx)(n.o,{error:y}):null,(0,P.jsx)(i.L.Table,{loading:N,className:V("groups-wrapper"),children:null!==b&&void 0!==b&&b.length?b.map((({name:n,count:o})=>{const i=w[n];return(0,P.jsx)(ce.Q,{title:n,count:o,entityName:M("groups"),expanded:i,onIsExpandedChange:I,children:(0,P.jsx)(ie,{database:e,parentRef:a,nodeId:t,groupId:s,pDiskId:r,filterGroup:n,filterGroupBy:m,searchValue:c,visibleEntities:"all",onShowAll:h,renderErrorMessage:W,columns:g,initialEntitiesCount:o})},n)})):M("no-groups")})]})}var ve=s(88655);const fe=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),Se=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432","empty.out_of_space":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0443\u0437\u043b\u043e\u0432","empty.small_uptime":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432 \u0441 uptime < 1h","empty.several_filters":"\u041d\u0435\u0442 \u0443\u0437\u043b\u043e\u0432, \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0443\u0437\u043b\u044b"}'),ke=(0,U.g4)("ydb-storage-nodes",{ru:Se,en:fe}),ye=({visibleEntities:e,nodesUptimeFilter:t,onShowAll:s})=>{let r;return e===I.space&&(r=ke("empty.out_of_space")),e===I.missing&&(r=ke("empty.degraded")),t===_.cW.SmallUptime&&(r=ke("empty.small_uptime")),e!==I.all&&t!==_.cW.All&&(r=ke("empty.several_filters")),r?(0,P.jsx)(te,{title:r,showAll:ke("show_all"),onShowAll:s}):null};var Ne=s(11905);const be=async e=>{const{type:t="static",storage:s=!0,limit:r,offset:a,sortParams:n,filters:o,columnsIds:i}=e,{searchValue:l,nodesUptimeFilter:d,visibleEntities:u,database:c,nodeId:m,groupId:p,filterGroup:h,filterGroupBy:g}=null!==o&&void 0!==o?o:{},{sortOrder:v,columnId:f}=null!==n&&void 0!==n?n:{},S=(0,k.kU)(f),y=S?(0,ne.T)(S,v):void 0,N=(0,oe.R)(i,k.fN),b=await window.api.viewer.getNodes({type:t,storage:s,limit:r,offset:a,sort:y,filter:l,uptime:(0,_.Fo)(d),with:u,database:c,node_id:m,group_id:p,filter_group:h,filter_group_by:g,fieldsRequired:N}),x=(0,Ne.rz)(b);return{data:x.nodes||[],found:x.found||0,total:x.total||0}},xe=(0,z.cn)("ydb-storage-nodes"),De=e=>xe("node",{unavailable:(0,_.X7)(e)}),we=({columns:e,database:t,nodeId:s,groupId:r,filterGroup:n,filterGroupBy:o,searchValue:i,visibleEntities:l,nodesUptimeFilter:d,onShowAll:u,parentRef:c,renderControls:m,renderErrorMessage:p,initialEntitiesCount:h})=>{const g=a.useMemo((()=>({searchValue:i,visibleEntities:l,nodesUptimeFilter:d,database:t,nodeId:s,groupId:r,filterGroup:n,filterGroupBy:o})),[i,l,d,t,s,r,n,o]);return(0,P.jsx)(K.k5,{columnsWidthLSKey:"storageNodesColumnsWidth",parentRef:c,columns:e,fetchData:be,rowHeight:51,initialEntitiesCount:h,renderControls:m,renderErrorMessage:p,renderEmptyDataMessage:()=>l!==I.all||d!==_.cW.All?(0,P.jsx)(ye,{onShowAll:u,nodesUptimeFilter:d,visibleEntities:l}):ke("empty.default"),getRowClassName:De,filters:g,tableName:"storage-nodes"})};var Ie=s(4557),Ce=s(78762),Pe=s(10576);const je=(0,z.cn)("ydb-storage-nodes-columns"),Ae="--maximum-slots",Ee="--maximum-disks",Te=({viewContext:e})=>({name:k.vg.PDisks,header:k.uG.PDisks,className:je("pdisks-column"),render:({row:t})=>{var s;const r={[Ae]:t.MaximumSlotsPerDisk,[Ee]:t.MaximumDisksPerNode};return(0,P.jsx)("div",{className:je("pdisks-wrapper"),style:r,children:null===(s=t.PDisks)||void 0===s?void 0:s.map((s=>{var r;const a=null===(r=t.VDisks)||void 0===r?void 0:r.filter((e=>e.PDiskId===s.PDiskId));return(0,P.jsx)("div",{className:je("pdisks-item"),children:(0,P.jsx)(Pe.E,{data:s,vDisks:a,viewContext:e})},s.PDiskId)}))})},align:Ie.Ay.CENTER,sortable:!1,resizeable:!1});function Ue({visibleEntities:e,database:t,additionalNodesProps:s,viewContext:r}){const n=a.useMemo((()=>(({database:e,additionalNodesProps:t,viewContext:s})=>{const r=null===t||void 0===t?void 0:t.getNodeRef;return[(0,Ce._E)(),(0,Ce.Nh)({getNodeRef:r,database:e}),(0,Ce.eT)(),(0,Ce.uk)(),(0,Ce.OX)(),(0,Ce.jl)(),(0,Ce.fr)(),(0,Ce.kv)(),(0,Ce.pH)(),(0,Ce.iX)(),(0,Ce.Bg)(),(0,Ce.Rn)(),(0,Ce.Vz)(),Te({viewContext:s})].map((e=>({...e,sortable:(0,k.sp)(e.name)})))})({database:t,additionalNodesProps:s,viewContext:r})),[t,s,r]),o=a.useMemo((()=>e===I.missing?[...N,k.vg.Missing]:N),[e]);return(0,le.K)(n,"storageNodesSelectedColumns",k.uG,y,o)}const Re=e=>{const{storageNodesGroupByParam:t,visibleEntities:s,nodesUptimeFilter:r,handleShowAllNodes:n}=B(),i=(0,l.Pm)(),d=(0,l.Ye)();a.useEffect((()=>{!d||"all"===s&&r===_.cW.All||n()}),[n,r,d,s]);return(0,P.jsx)(o.r,{loading:!i,children:d&&t?(0,P.jsx)(Ge,{...e}):(0,P.jsx)(Me,{...e})})};function Me({database:e,nodeId:t,groupId:s,viewContext:r,parentRef:a,initialEntitiesCount:n}){const{searchValue:o,visibleEntities:i,nodesUptimeFilter:d,handleShowAllNodes:u}=B(),c=(0,l.Ye)(),{columnsToShow:m,columnsToSelect:p,setColumns:h}=Le({database:e,viewContext:r});return(0,P.jsx)(we,{database:e,nodeId:t,groupId:s,searchValue:o,visibleEntities:i,nodesUptimeFilter:d,onShowAll:u,parentRef:a,renderControls:({totalEntities:e,foundEntities:t,inited:s})=>(0,P.jsx)(Y,{withTypeSelector:!0,withGroupBySelect:c,entitiesCountCurrent:t,entitiesCountTotal:e,entitiesLoading:!s,columnsToSelect:p,handleSelectedColumnsUpdate:h}),renderErrorMessage:W,columns:m,initialEntitiesCount:n})}function Ge({database:e,groupId:t,nodeId:s,viewContext:r,parentRef:a}){const[n]=(0,u.Nt)(),{searchValue:o,storageNodesGroupByParam:l,handleShowAllNodes:c}=B(),{columnsToShow:m,columnsToSelect:p,setColumns:h}=Le({database:e,viewContext:r}),{currentData:g,isFetching:v,error:f}=d.S.useGetStorageNodesInfoQuery({database:e,with:"all",filter:o,node_id:s,group_id:t,group:l},{pollingInterval:n}),S=void 0===g&&v,{tableGroups:k,found:y=0,total:N=0}=g||{},{expandedGroups:b,setIsGroupExpanded:x}=(0,me.$)(k);return(0,P.jsxs)(i.L,{children:[(0,P.jsx)(i.L.Controls,{children:(0,P.jsx)(Y,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:y,entitiesCountTotal:N,entitiesLoading:S,columnsToSelect:p,handleSelectedColumnsUpdate:h})}),f?(0,P.jsx)(L.o,{error:f}):null,(0,P.jsx)(i.L.Table,{loading:S,className:V("groups-wrapper"),children:null!==k&&void 0!==k&&k.length?k.map((({name:r,count:n})=>{const i=b[r];return(0,P.jsx)(ce.Q,{title:r,count:n,entityName:M("nodes"),expanded:i,onIsExpandedChange:x,children:(0,P.jsx)(we,{database:e,parentRef:a,nodeId:s,groupId:t,searchValue:o,visibleEntities:"all",nodesUptimeFilter:_.cW.All,onShowAll:c,filterGroup:r,filterGroupBy:l,renderErrorMessage:W,columns:m,initialEntitiesCount:n})},r)})):M("no-nodes")})]})}function Le({database:e,viewContext:t}){const s=(0,ve.E)(),{visibleEntities:r}=B();return Ue({additionalNodesProps:s,visibleEntities:r,database:e,viewContext:t})}var ze=s(3218);const Ve=e=>{const{storageType:t}=B(),s=(0,r.X)();return"nodes"===t&&s?(0,P.jsx)(Re,{initialEntitiesCount:(0,ze.b0)(e.viewContext),...e}):(0,P.jsx)(pe,{initialEntitiesCount:(0,ze.QQ)(e.viewContext),...e})}}}]);