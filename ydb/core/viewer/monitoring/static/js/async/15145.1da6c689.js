(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([["15145"],{94084:function(e,t,s){"use strict";s.d(t,{A:()=>r});var n=s(96540);let r=e=>n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),n.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M1.25 8A.75.75 0 0 1 2 7.25h10.19L9.47 4.53a.75.75 0 0 1 1.06-1.06l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 1 1-1.06-1.06l2.72-2.72H2A.75.75 0 0 1 1.25 8",clipRule:"evenodd"}))},63945:function(e){e.exports=function(e,t,s,n){for(var r=-1,a=null==e?0:e.length;++r<a;){var l=e[r];t(n,l,s(l),e)}return n}},62429:function(e,t,s){var n=s(80909);e.exports=function(e,t,s,r){return n(e,function(e,n,a){t(r,e,s(e),a)}),r}},42e3:function(e,t,s){var n=s(63945),r=s(62429),a=s(15389),l=s(56449);e.exports=function(e,t){return function(s,i){var o=l(s)?n:r,c=t?t():{};return o(s,e,a(i,2),c)}}},94394:function(e,t,s){var n=s(43360),r=s(42e3),a=Object.prototype.hasOwnProperty;e.exports=r(function(e,t,s){a.call(e,s)?e[s].push(t):n(e,s,[t])})},86691:function(e,t,s){"use strict";s.d(t,{y:()=>d});var n=s(74848),r=s(96540),a=s(86268),l=s(25247),i=s(28544);let o=(0,l.cn)("ydb-info-viewer-skeleton"),c=()=>(0,n.jsxs)("div",{className:o("label"),children:[(0,n.jsx)(a.E,{className:o("label__text")}),(0,n.jsx)("div",{className:o("label__dots")})]}),d=({rows:e=8,className:t,delay:s=600})=>{let[l]=(0,i.y)(s),d=(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)(c,{}),(0,n.jsx)(a.E,{className:o("value")})]});return l||(d=null),(0,n.jsx)("div",{className:o(null,t),children:[...Array(e)].map((e,t)=>(0,n.jsx)("div",{className:o("row"),children:d},`skeleton-row-${t}`))})}},40700:function(e,t,s){"use strict";s.d(t,{E:()=>l});var n=s(74848),r=s(86268),a=s(28544);let l=({delay:e=600,className:t})=>{let[s]=(0,a.y)(e);return s?(0,n.jsx)(r.E,{className:t}):null}},82370:function(e,t,s){"use strict";s.r(t),s.d(t,{Cluster:()=>tv});var n,r=s(74848),a=s(96540),l=s(86268),i=s(4329),o=s(38482),c=s(65127),d=s(85902),u=s(56347),h=s(22708),m=s(23273),p=s(96927),x=s(60117),j=s(53788),v=s(15749),f=s(6390),b=s(4858),g=s(8946),y=s(1459),N=s(71790),w=s(39471),A=s(40897),C=s(67222),E=s(25247),_=s(35537),k=s(61738),O=s(88831),S=s(75442),T=s(12499),D=s(35461),V=s(11025),M=s(25041),I=s(6168),R=s(2837),P=s(81709),L=s(58492),z=s(43125);function H({scrollContainerRef:e,additionalTenantsProps:t}){let s=(0,P.H)(),n=(0,L.e)(),[a]=(0,k.iK)(R.GS.SHOW_DOMAIN_DATABASE);return(0,r.jsx)(z.A,{clusterName:s,environmentName:void 0,isMetaDatabasesAvailable:n,scrollContainerRef:e,additionalTenantsProps:t,showDomainDatabase:a,showPoolsColumn:!0,showWithProblemsFilter:!0})}var B=s(49612),G=s(14399),q=s(43834),W=s(85169),$=s(77269),Z=s(24629),K=s(17427),U=s(14476),Q=s(42724),Y=s(41982),F=s(75043),J=s(74010),X=s(65943),ee=s(87669);let et=({nodes:e})=>{var t;let s=(0,y.Z9)(),n=(t={},[(0,X._E)(),(0,X.Nh)(t),(0,X.OV)(),(0,X.jl)(),(0,X.pH)(),(0,X.fr)(),(0,X.ID)()]),a=s?n:n.filter(e=>e.name!==ee.vg.PileName);return(0,r.jsx)(J.l,{columnsWidthLSKey:"versionsTableColumnsWidth",data:e,columns:a,settings:_.N3})};var es=s(94084),en=s(88464),er=s(48171),ea=s(88786),el=s(66111),ei=s(51432),eo=JSON.parse('{"title_overall":"Overall","title_storage-nodes":"Storage Nodes","title_database-nodes":"Database Nodes","title_other-nodes":"Other Nodes","title_database":"Database","title_version":"Version","nodes-count":{"one":"{{count}} node","other":"{{count}} nodes"},"group-by":"Group by:","action_expand":"Expand all","action_collapse":"Collapse all"}');let ec=(0,ei.g4)("ydb-versions",{en:eo}),ed=(0,E.cn)("ydb-versions-nodes-tree-title"),eu=({title:e,isDatabase:t,expanded:s,nodes:n,items:l,versionColor:i,preparedVersions:o,onClick:c})=>{let d=(0,u.W6)(),h=a.useCallback(e=>{e.nativeEvent.composedPath().some(eh)||c?.()},[c]),m=a.useMemo(()=>l?l.reduce((e,t)=>t.nodes?e+t.nodes.length:e,0):n?n.length:0,[l,n]);return(0,r.jsxs)("div",{className:ed("overview"),onClick:h,children:[(0,r.jsxs)(W.s,{gap:2,alignItems:"center",children:[i&&!t?(0,r.jsx)("div",{className:ed("version-color"),style:{background:i}}):null,t?(0,r.jsx)(K.I,{data:en.A}):null,e?(0,r.jsxs)(a.Fragment,{children:[e,(0,r.jsx)(el.b,{text:e,size:"s",className:ed("clipboard-button"),view:"flat"})]}):null,t?(0,r.jsxs)(Z.$,{size:"s",onClick:()=>d.push((0,g.YL)({database:e,diagnosticsTab:"nodes"})),children:[ec("nodes-count",{count:m}),(0,r.jsx)(K.I,{data:es.A})]}):(0,r.jsx)($.E,{variant:"body-2",color:"hint",children:ec("nodes-count",{count:m})})]}),(0,r.jsxs)(W.s,{alignItems:"center",gap:4,children:[t&&o?(0,r.jsx)("div",{className:ed("version-progress"),children:(0,r.jsx)(Y.p,{preparedVersions:o,withTitles:!1})}):null,(0,r.jsx)(K.I,{className:ed("icon"),data:s?er.A:ea.A})]})]})};function eh(e){return e instanceof HTMLElement&&("BUTTON"===e.nodeName&&!e.hasAttribute("disabled")&&"true"!==e.getAttribute("aria-disabled")||e.hasAttribute("tabindex")&&e.tabIndex>-1)}let em=(0,E.cn)("ydb-versions-block"),ep=({expanded:e,renderHeader:t,renderContent:s})=>(0,r.jsxs)("div",{className:em(null),children:[t(),e?(0,r.jsx)(W.s,{direction:"column",className:em("content"),children:s()}):null]}),ex=(0,E.cn)("ydb-versions-grouped-node-tree"),ej=({title:e,isDatabase:t,nodes:s,items:n,expanded:l=!1,versionColor:i,preparedVersions:o})=>{let[c,d]=a.useState(!1);a.useEffect(()=>{d(l)},[l]);let u=()=>{d(e=>!e)};return(0,r.jsx)("div",{className:ex("wrapper"),children:(0,r.jsx)(ep,{expanded:c,renderHeader:()=>(0,r.jsx)(eu,{title:e,isDatabase:t,expanded:c,nodes:s,items:n,versionColor:i,preparedVersions:o,onClick:u}),renderContent:()=>n?n?.map((e,t)=>(0,r.jsx)(ej,{title:e.title,isDatabase:e.isDatabase,nodes:e.nodes,expanded:l,versionColor:e.versionColor,preparedVersions:e.preparedVersions},t)):(0,r.jsx)(et,{nodes:s||[]})})})};var ev=s(94394),ef=s.n(ev),eb=s(65101),eg=s(43049),ey=s(94307),eN=s(12139);let ew=(e=[],t)=>{let s=e.reduce((e,t)=>(t.Version&&(e[t.Version]?e[t.Version]=e[t.Version]+1:e[t.Version]=1),e),{}),n=Object.keys(s).map(e=>{let n=(0,ey.U)(e),r=t?.get(n);return{title:e,version:e,count:s[e],minorVersion:n,...r}});return(0,eN.M)(n)};function eA(e,t){let s=e.map(e=>{let s=(0,ey.U)(e.name),n=t?.get(s);return{title:e.name,version:e.name,count:e.count,minorVersion:s,color:n?.color??eg.OT,...n}});return(0,eN.M)(s)}var eC=((n={}).VERSION="Version",n.TENANT="Database",n.STORAGE="Storage",n);let eE=(e,t)=>e.title?.localeCompare(t.title||"")||-1;var e_=s(18117),ek=s(8466),eO=s(79909),eS=s(65848);let eT=(0,E.cn)("ydb-versions");function eD({cluster:e,loading:t}){let s,[n]=(0,k.Nt)(),{currentData:l,isLoading:i}=F.s.useGetNodesQuery({tablets:!1,fieldsRequired:["SystemState","SubDomainKey"]},{pollingInterval:n}),o=(s=function(){let[e]=(0,h.useQueryParam)("clusterName",h.StringParam),t=(0,k.N4)(e=>e.singleClusterMode),{data:s}=ek.ub.useGetClustersListQuery(void 0,{skip:t});return a.useMemo(()=>{if(t)return;let n=(s||[]).find(t=>t.name===e),r=n?.versions||[];return()=>(0,eS.kG)((0,eS.HD)(r))},[t,s,e])}(),a.useMemo(()=>s?s():(0,eg.jh)(e?.Versions),[e?.Versions,s])),c=function({cluster:e,versionsDataMap:t,clusterLoading:s}){let{currentData:n}=F.s.useGetNodesQuery((0,eO.LH)(e)||s?e_.hT:{tablets:!1,fieldsRequired:["SystemState","SubDomainKey"],group:"Version"});return a.useMemo(()=>(0,eO.LH)(e)&&e.MapVersions?eA(Object.entries(e.MapVersions).map(([e,t])=>({name:e,count:t})),t):n?Array.isArray(n.tableGroups)?eA(n.tableGroups,t):ew(n.nodes,t):[],[n,t,e])}({cluster:e,versionsDataMap:o,clusterLoading:t});return(0,r.jsx)(Q.r,{loading:t||i,children:(0,r.jsx)(eM,{preparedVersions:c,nodes:l?.nodes,versionsDataMap:o})})}let eV=U.z.nativeEnum(eC).catch(eC.VERSION);function eM({preparedVersions:e,nodes:t,versionsDataMap:s}){let[{groupBy:n},l]=(0,h.useQueryParams)({groupBy:h.StringParam}),i=eV.parse(n),o=a.useMemo(()=>((e,t,s)=>{if(e&&e.length)if(s===eC.VERSION){let s=ef()(e,"Version");return Object.keys(s).map(e=>{let n=s[e].filter(eb.lv),r=ef()(n,"Tenants"),a=Object.keys(r).map(e=>({title:e,isDatabase:!0,nodes:r[e]})).sort(eE);return a.length?{title:e,items:a,versionColor:(0,eg.xH)(e,t)}:null}).filter(e=>!!e)}else{let s=e.filter(eb.lv),n=ef()(s,"Tenants");return Object.keys(n).map(e=>{let s=ew(n[e],t),r=ef()(n[e],"Version"),a=Object.keys(r).map(e=>({title:e,nodes:r[e],versionColor:(0,eg.xH)(e,t)}));return a.length?{title:e,isDatabase:!0,items:a,preparedVersions:s}:null}).filter(e=>!!e).sort(eE)}})(t,s,i),[i,t,s]),c=a.useMemo(()=>((e,t)=>{if(!e||!e.length)return;let s=e.filter(eb.wH),n=ef()(s,"Version");return Object.keys(n).map(e=>({title:e,nodes:n[e],versionColor:(0,eg.xH)(e,t)}))})(t,s),[t,s]),d=a.useMemo(()=>((e,t)=>{if(!e||!e.length)return;let s=e.filter(e=>!(0,eb.wH)(e)&&!(0,eb.lv)(e)&&e.Version),n=ef()(s,"Version");return Object.keys(n).map(e=>({title:e,nodes:n[e],versionColor:(0,eg.xH)(e,t)}))})(t,s),[t,s]);return(0,r.jsxs)(W.s,{className:eT(),direction:"column",gap:6,children:[(0,r.jsxs)(W.s,{gap:3,direction:"column",className:eT("overall"),children:[(0,r.jsx)($.E,{variant:"subheader-3",children:ec("title_overall")}),(0,r.jsx)(Y.p,{preparedVersions:e,size:"m"})]}),(0,r.jsx)(eI,{sectionTitle:ec("title_storage-nodes"),nodes:c}),(0,r.jsx)(eI,{sectionTitle:ec("title_database-nodes"),nodes:o,renderControls:()=>{let e=[{value:eC.TENANT,content:ec("title_database")},{value:eC.VERSION,content:ec("title_version")}];return(0,r.jsx)(q.l,{label:ec("group-by"),value:[i],options:e,onUpdate:e=>{l({groupBy:e[0]},"replaceIn")},width:200,size:"m"})}}),(0,r.jsx)(eI,{sectionTitle:ec("title_other-nodes"),nodes:d})]})}function eI({sectionTitle:e,renderControls:t,nodes:s}){let[n,l]=a.useState(!1);return s?.length?(0,r.jsxs)(W.s,{gap:3,direction:"column",children:[(0,r.jsxs)(W.s,{justifyContent:"space-between",children:[(0,r.jsxs)(W.s,{gap:3,children:[(0,r.jsx)($.E,{variant:"subheader-3",children:e}),t?.()]}),(0,r.jsxs)(Z.$,{onClick:()=>l(e=>!e),children:[(0,r.jsx)(K.I,{data:n?B.A:G.A}),n?ec("action_collapse"):ec("action_expand")]})]}),s.map(({title:e,isDatabase:t,nodes:s,items:a,versionColor:l,preparedVersions:i})=>(0,r.jsx)(ej,{title:e,isDatabase:t,nodes:s,items:a,versionColor:l,expanded:n,preparedVersions:i},e))]}):null}var eR=s(51655),eP=s(67103),eL=s(33172),ez=s(77252),eH=s(66918),eB=s(86691),eG=s(60318),eq=s(97855),eW=s(5434),e$=s(93226);let eZ=(0,E.cn)("bridge-info-table"),eK=a.memo(function({pile:e}){let t=a.useCallback(()=>{if(!e.State)return _.Pd;let t=function(e){if(!e)return"unknown";switch(e.toUpperCase()){case"PRIMARY":case"PROMOTED":case"SYNCHRONIZED":return"success";case"NOT_SYNCHRONIZED":return"warning";case"SUSPENDED":case"DISCONNECTED":return"danger";default:return"unknown"}}(e.State);return(0,r.jsx)(eW.J,{theme:t,children:e.State})},[e.State]),s=a.useMemo(()=>[{name:(0,e$.A)("field_state"),content:t()},{name:(0,e$.A)("field_nodes"),content:void 0===e.Nodes?_.Pd:(0,eq.ZV)(e.Nodes)}],[t,e.Nodes]);return(0,r.jsxs)(W.s,{direction:"column",gap:3,className:eZ("pile-card"),children:[(0,r.jsx)($.E,{variant:"body-2",children:e.Name||_.Pd}),(0,r.jsx)(eH.u,{nameMaxWidth:160,children:s.map(({name:e,content:t})=>(0,r.jsx)(eH.u.Item,{name:e,children:t},e))})]})}),eU=a.memo(function({piles:e}){let t=a.useMemo(()=>e.map((e,t)=>(0,r.jsx)(eK,{pile:e},e.PileId??t)),[e]);return(0,r.jsx)(W.s,{gap:2,className:eZ(),children:t})});var eQ=s(54549);let eY=(0,E.cn)("cluster-info");var eF=s(52705);let eJ=({tags:e,className:t="",gap:s=1})=>(0,r.jsx)(W.s,{className:t,gap:s,wrap:"wrap",alignItems:"center",children:e&&e.map((e,t)=>(0,r.jsx)(eW.J,{size:"s",children:e},t))});var eX=s(47037),e0=s(9849),e5=s(5577);let e2=(0,E.cn)("ydb-disk-groups-stats"),e1={good:"success",warning:"warning",danger:"danger"};function e4({stats:e,storageType:t}){let{erasure:s,allocatedSize:n,availableSize:a}=e,l=(0,e0.fn)(Math.max(n,a)),i=(0,e0.z3)({value:n,size:l}),o=(0,e0.z3)({value:a,size:l}),c=Math.floor(n/(n+a)*100),d=[{name:(0,e$.A)("erasure"),content:s},{name:(0,e$.A)("allocated"),content:i},{name:(0,e$.A)("available"),content:o},{name:(0,e$.A)("usage"),content:(0,r.jsxs)(W.s,{gap:2,alignItems:"center",children:[(0,r.jsx)(eX.k,{theme:e1[(0,e5.w)({fillWidth:c})],className:e2("progress"),value:c,size:"s"}),(0,r.jsxs)($.E,{color:"secondary",children:[c,"%"]})]})}];return(0,r.jsxs)(W.s,{direction:"column",gap:3,className:e2(),children:[(0,r.jsxs)($.E,{variant:"body-2",children:[t," ",(0,r.jsx)($.E,{color:"secondary",variant:"body-2",children:`${(0,eq.ZV)(e.createdGroups)} ${(0,e$.A)("context_of")} ${(0,eq.ZV)(e.totalGroups)}`})]}),(0,r.jsx)(eH.u,{nameMaxWidth:160,children:d.map(({name:e,content:t})=>(0,r.jsx)(eH.u.Item,{name:e,children:t},e))})]})}let e6={Green:5,Blue:4,Yellow:3,Orange:2,Red:1,Grey:0},e7=({cluster:e,loading:t,error:s,additionalClusterProps:n={},groupStats:l={},bridgePiles:i})=>{let o,c,{info:d=[],links:u=[]}=n,h=function(){let{cores:e,logging:t}=(0,N.Zd)();return a.useMemo(()=>{let s=[];return e?.url&&s.push({title:(0,e$.A)("link_cores"),url:e?.url}),t?.url&&s.push({title:(0,e$.A)("link_logging"),url:t?.url}),t?.slo_logs_url&&s.push({title:(0,e$.A)("link_slo-logs"),url:t.slo_logs_url}),s},[e,t])}(),m=u.concat(h),p=((e,t)=>{let s=[],n=(e=>{if((0,eO.LH)(e)&&e.MapDataCenters)return Object.entries(e.MapDataCenters).map(([e,t])=>(0,r.jsxs)(a.Fragment,{children:[e," : ",(0,eq.ZV)(t)]},e))})(e);if(n?.length&&s.push({label:(0,e$.A)("label_dc"),value:(0,r.jsx)(eJ,{tags:n,gap:2,className:eY("dc")})}),(0,eO.LH)(e)&&e.MapNodeStates){let t=Object.entries(e.MapNodeStates);t.sort((e,t)=>e6[t[0]]-e6[e[0]]);let n=t.map(([e,t])=>(0,r.jsx)(x.c.Label,{withStatusName:!1,status:e,size:"s",iconSize:12,children:(0,eq.ZV)(t)},e));s.push({label:(0,e$.A)("label_nodes-state"),value:(0,r.jsx)(W.s,{gap:2,children:n})})}return s.push({label:(0,e$.A)("label_load"),value:(0,r.jsx)(eF.O,{value:e?.LoadAverage,capacity:e?.RealNumberOfCpus??e?.NumberOfCpus})}),s.push(...t),s})(e??{},d),j=(0,eQ.lq)(l);return(0,r.jsxs)(W.s,{gap:4,direction:"column",className:eY(),children:[s?(0,r.jsx)(eP.o,{error:s,className:eY("error")}):null,(0,r.jsxs)(e3,{children:[(0,r.jsx)($.E,{as:"div",variant:"subheader-2",className:eY("section-title"),children:(0,e$.A)("title_details")}),t?(0,r.jsx)(eB.y,{className:eY("skeleton"),rows:4}):s&&!e?null:(0,r.jsxs)(eH.u,{nameMaxWidth:200,children:[p.map(({label:e,value:t})=>(0,r.jsx)(eH.u.Item,{name:e,children:t},e)),m.length>0&&(0,r.jsx)(eH.u.Item,{name:(0,e$.A)("title_links"),children:(0,r.jsx)(W.s,{direction:"column",gap:2,children:m.map(({title:e,url:t})=>(0,r.jsx)(eG.K,{title:e,url:t},e))})})]})]}),(c=(o=[],Object.entries(l).forEach(([e,t])=>{Object.values(t).forEach(t=>{o.push((0,r.jsx)(e4,{stats:t,storageType:e},`${e}|${t.erasure}`))})}),o),t?null:(0,r.jsx)(e3,{children:(0,r.jsxs)(W.s,{gap:6,width:"full",children:[(0,r.jsxs)(W.s,{direction:"column",gap:2,children:[(0,r.jsxs)($.E,{as:"div",variant:"subheader-2",className:eY("section-title"),children:[(0,e$.A)("title_storage-groups")," ",(0,r.jsx)($.E,{variant:"subheader-2",color:"secondary",children:(0,eq.ZV)(j)})]}),(0,r.jsx)(W.s,{gap:2,children:c})]}),i?.length?(0,r.jsxs)(W.s,{direction:"column",gap:2,className:eY("bridge-table"),children:[(0,r.jsxs)($.E,{as:"div",variant:"subheader-2",className:eY("section-title"),children:[(0,e$.A)("title_bridge")," ",(0,r.jsx)($.E,{variant:"subheader-2",color:"secondary",children:(0,eq.ZV)(i.length)})]}),(0,r.jsx)(eU,{piles:i})]}):null]})}))]})};function e3({children:e}){return(0,r.jsx)(W.s,{direction:"column",gap:3,children:e})}var e8=s(96945),e9=s(40700);let te=(0,E.cn)("ydb-cluster-dashboard"),tt={good:A.m.Green,warning:A.m.Yellow,danger:A.m.Red};function ts({children:e,className:t,collapsed:s}){return(0,r.jsx)(W.s,{gap:"6",alignItems:"center",className:te("card",{collapsed:s},t),children:e})}function tn({title:e,children:t,legend:s,collapsed:n,...a}){let{main:l,secondary:i,note:o}=s;if(n){let{status:t,fillWidth:s}=a,n=s.toFixed(s>0?0:1);return(0,r.jsx)(x.c.Label,{withStatusName:!1,status:tt[t],children:`${e} : ${n}%`})}return(0,r.jsxs)(ts,{children:[(0,r.jsx)(e8.e,{...a,children:t}),(0,r.jsxs)("div",{className:te("legend-wrapper"),children:[l&&(0,r.jsx)(e8.e.Legend,{children:l}),i&&(0,r.jsx)(e8.e.Legend,{color:"secondary",note:o,variant:"body-1",children:i})]})]})}function tr({collapsed:e}){return(0,r.jsx)(ts,{className:te("skeleton-wrapper"),collapsed:e,children:(0,r.jsx)(e9.E,{className:te("skeleton")})})}function ta({collapsed:e}){return(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(tr,{collapsed:e}),(0,r.jsx)(tr,{collapsed:e}),(0,r.jsx)(tr,{collapsed:e})]})}var tl=s(9471),ti=s(47635);function to({collapsed:e,value:t,capacity:s,...n}){let{status:a,percents:l,legend:i,fill:o}=(0,ti.s)({value:t,capacity:s,legendFormatter:tl.vs,...n});return(0,r.jsx)(tn,{collapsed:e,status:a,fillWidth:o,title:(0,e$.A)("title_cpu"),legend:{main:i,secondary:(0,e$.A)("context_cpu"),note:(0,e$.A)("context_cpu-description")},children:(0,r.jsx)(e8.e.Value,{children:l})})}function tc({value:e,capacity:t,collapsed:s,...n}){let{status:a,percents:l,legend:i,fill:o}=(0,ti.s)({value:e,capacity:t,legendFormatter:tl.cO,...n});return(0,r.jsx)(tn,{status:a,fillWidth:o,title:(0,e$.A)("title_memory"),collapsed:s,legend:{main:i,secondary:(0,e$.A)("context_memory"),note:(0,e$.A)("context_memory-description")},children:(0,r.jsx)(e8.e.Value,{children:l})})}function td({percentsValue:e,throughput:t,collapsed:s,...n}){let[a]=(0,S.i)(R.GS.SHOW_NETWORK_UTILIZATION);if(!a)return null;let{status:l,percents:i,fill:o}=(0,ti.v)({fillWidth:100*e,...n}),c=(0,e0.z3)({value:t,withSpeedLabel:!0});return(0,r.jsx)(tn,{status:l,fillWidth:o,title:(0,e$.A)("title_network"),collapsed:s,legend:{main:c,secondary:(0,e$.A)("context_network"),note:(0,e$.A)("context_network-description")},children:(0,r.jsx)(e8.e.Value,{children:i})})}function tu({value:e,capacity:t,groups:s,collapsed:n,...a}){let{status:l,percents:i,legend:o,fill:c}=(0,ti.s)({value:e,capacity:t,legendFormatter:tl.cO,...a});return(0,r.jsx)(tn,{status:l,fillWidth:c,title:(0,e$.A)("title_storage"),collapsed:n,legend:{main:o,secondary:(0,e$.A)("context_storage",{count:s}),note:(0,e$.A)("context_storage-description")},children:(0,r.jsx)(e8.e.Value,{children:i})})}let th=e=>(0,r.jsx)("svg",{viewBox:"0 0 16 15",...e,children:(0,r.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.98 1.826a.75.75 0 0 0-.96-1.152L10.376 3.71a1.25 1.25 0 0 1-1.196.225l-2.155-.718a2.75 2.75 0 0 0-2.973.837L.926 7.767a.75.75 0 1 0 1.148.966l3.125-3.712a1.25 1.25 0 0 1 1.352-.38l2.155.718a2.75 2.75 0 0 0 2.63-.496zM13.5 8h-2a.5.5 0 0 0-.5.5V13a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5V8.5a.5.5 0 0 0-.5-.5m-4 5a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5v-2.5A.5.5 0 0 1 7 10h2a.5.5 0 0 1 .5.5zM5 13a.5.5 0 0 1-.5.5h-2A.5.5 0 0 1 2 13v-.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5zm-2.5 2h11a2 2 0 0 0 2-2V8.5a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v.063A2 2 0 0 0 9 8.5H7a2 2 0 0 0-2 2v.063a2 2 0 0 0-.5-.063h-2a2 2 0 0 0-2 2v.5a2 2 0 0 0 2 2",clipRule:"evenodd"})});function tm(e){let[t,s]=(0,S.i)(R.GS.EXPAND_CLUSTER_DASHBOARD);(0,ez.u)([t],110);let n=(0,y.Z9)(),l=a.useMemo(()=>{if(!n||!(0,eO.E5)(e.cluster))return;let{BridgeInfo:t}=e.cluster;return t?.Piles?.length?t.Piles:void 0},[e.cluster,n]);return e.error?(0,r.jsx)(eP.o,{error:e.error,className:te("error")}):(0,r.jsx)(eR.E,{arrowPosition:"end",size:"l",expanded:t,onUpdate:()=>s(!t),className:te("overview-wrapper",{collapsed:!t}),summary:(0,r.jsxs)(W.s,{alignItems:"center",justifyContent:"space-between",width:"100%",className:te("disclosure-summary"),children:[(0,r.jsxs)(W.s,{gap:2,alignItems:"center",children:[(0,r.jsx)(K.I,{data:th,size:16}),(0,r.jsx)($.E,{variant:"body-2",color:"primary",className:te("title"),children:(0,e$.A)("label_overview")})]}),!t&&(0,r.jsx)(tp,{...e,collapsed:!0})]}),children:(0,r.jsxs)("div",{className:te("disclosure-content"),children:[(0,r.jsx)(tp,{...e}),(0,r.jsx)(e7,{...e,bridgePiles:l})]})})}function tp({collapsed:e,...t}){return(0,y.fp)()?(0,r.jsx)(W.s,{wrap:!0,className:te("dashboard-wrapper",{collapsed:e}),children:(0,r.jsx)(tx,{...t,collapsed:e})}):null}function tx({cluster:e,groupStats:t={},loading:s,collapsed:n}){if(s)return(0,r.jsx)(ta,{collapsed:n});let a=[];if((0,eO.LH)(e)){let{CoresUsed:t,NumberOfCpus:s,CoresTotal:l}=e,i=l??s;(0,eL.f8)(t)&&(0,eL.f8)(i)&&a.push((0,r.jsx)(to,{value:t,capacity:i,collapsed:n},"cores"))}let{StorageTotal:l,StorageUsed:i}=e;if((0,eL.f8)(l)&&(0,eL.f8)(i)){let e=(0,eQ.lq)(t);a.push((0,r.jsx)(tu,{value:i,capacity:l,groups:e,collapsed:n},"storage"))}let{MemoryTotal:o,MemoryUsed:c}=e;if((0,eL.f8)(o)&&(0,eL.f8)(c)&&a.push((0,r.jsx)(tc,{value:c,capacity:o,collapsed:n},"memory")),(0,eO.E5)(e)){let{NetworkUtilization:t,NetworkWriteThroughput:s}=e;(0,eL.f8)(t)&&a.push((0,r.jsx)(td,{percentsValue:t,throughput:s,collapsed:n},"network"))}return a}let tj=(0,E.cn)("ydb-cluster");function tv({additionalClusterProps:e,additionalTenantsProps:t}){let s=a.useRef(null),n=(0,y.fp)(),E=(0,b.s)(),R=(0,eQ.iJ)(),P=(0,O.b)(),L=(0,y.RK)(),z=P&&L,[B]=(0,k.Nt)(),G=(0,k.YQ)(),{activeTabId:q,onClusterTabClick:W}=function(){let e=(0,k.YQ)(),t=(0,k.N4)(e=>e.cluster.defaultClusterTab),[s,n]=(0,S.i)(_.fY,N.Oy),r=a.useMemo(()=>(0,eQ.eC)(s)?s:void 0,[s]),l=r??t,i=(0,b.s)(),o=(0,eQ.iJ)(),c=(0,u.W5)(g.Ay.cluster),{activeTab:d}=c?.params||{},h=!i&&d===eQ.Bi.network,m=!o&&d===eQ.Bi.events;return{activeTabId:h||m?N.Oy:(0,eQ.eC)(d)?d:l,onClusterTabClick:a.useCallback(s=>{if(0!==s.button||s.metaKey||s.ctrlKey||s.shiftKey)return;let a=s.currentTarget.getAttribute("data-cluster-tab-id");a&&(0,eQ.eC)(a)&&(a!==t&&e((0,N.Yv)(a)),a!==r&&n(a))},[t,e,r,n])}}(),[{clusterName:$,backend:Z}]=(0,h.useQueryParams)({clusterName:h.StringParam,backend:h.StringParam}),K=(0,k.N4)(e=>(0,N.zR)(e,$??void 0)),{title:U}=(0,N.Zd)(),Q=U??K,{data:{clusterData:Y,groupsStats:F}={},isLoading:J,error:X}=N.Zh.useGetClusterInfoQuery($??void 0,{pollingInterval:B}),ee=(0,k.N4)(e=>(0,N.ds)(e,$??void 0));a.useEffect(()=>{G((0,w.g)("cluster",{}))},[G]);let et=a.useMemo(()=>{let e=[];return E||e.push(eQ.Bi.network),R||e.push(eQ.Bi.events),z||e.push(eQ.Bi.configs),eQ.bn.filter(t=>!e.includes(t.id))},[R,E,z]),es=a.useMemo(()=>et.find(({id:e})=>e===q),[q,et]),{appTitle:en}=(0,T.J)();return(0,r.jsx)(p.e,{children:(0,r.jsxs)("div",{className:tj(),ref:s,children:[(0,r.jsx)(d.mg,{defaultTitle:`${Q} — ${en}`,titleTemplate:`%s — ${Q} — ${en}`,children:es?(0,r.jsx)("title",{children:es.title}):null}),(0,r.jsx)("div",{className:tj("header"),children:(()=>{if(J)return(0,r.jsx)(l.E,{className:tj("title-skeleton")});let e=Y?.Overall||A.m.Grey;return(0,r.jsxs)(x.c,{className:tj("title"),children:[Q,(0,r.jsx)(x.c.Label,{status:e,note:j.D[e]})]})})()}),(0,r.jsx)("div",{className:tj("sticky-wrapper"),children:(0,r.jsx)(m.E,{className:tj("auto-refresh-control")})}),n&&(0,r.jsx)("div",{className:tj("dashboard"),children:(0,r.jsx)(tm,{cluster:Y??{},groupStats:F,loading:J,error:(X&&"object"==typeof X?X:void 0)||Y?.error,additionalClusterProps:e})}),(0,r.jsx)("div",{className:tj("tabs-sticky-wrapper"),children:(0,r.jsx)(i.f,{value:q,children:(0,r.jsx)(o.w,{size:"l",children:et.map(({id:e,title:t})=>{let s=(0,g.a)({activeTab:e},{clusterName:$,backend:Z});return(0,r.jsx)(c.o,{value:e,children:(0,r.jsx)(v.E,{view:"primary",as:"tab",to:s,"data-cluster-tab-id":e,onClick:W,children:t})},e)})})})}),(0,r.jsx)("div",{className:tj("content"),children:(0,r.jsxs)(u.dO,{children:[(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.tablets})).pathname,children:(0,r.jsx)(I.Q,{loading:J,tablets:ee,scrollContainerRef:s})}),(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.tenants})).pathname,children:(0,r.jsx)(H,{additionalTenantsProps:t,scrollContainerRef:s})}),(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.nodes})).pathname,children:(0,r.jsx)(V.G,{scrollContainerRef:s})}),(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.storage})).pathname,children:(0,r.jsx)(M.z,{scrollContainerRef:s})}),E&&(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.network})).pathname,children:(0,r.jsx)(f.x,{scrollContainerRef:s})}),(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.versions})).pathname,children:(0,r.jsx)(eD,{cluster:Y,loading:J})}),R&&(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.events})).pathname,children:C.J.renderEvents?.({scrollContainerRef:s})}),z&&(0,r.jsx)(u.qh,{path:(0,g.a3)((0,g.a)({activeTab:eQ.Bi.configs})).pathname,children:(0,r.jsx)(D.U,{className:tj("cluster-configs"),scrollContainerRef:s})}),(0,r.jsx)(u.qh,{render:()=>(0,r.jsx)(u.rd,{to:(0,g.a3)((0,g.a)({activeTab:q}))})})]})})]})})}},51655:function(e,t,s){"use strict";s.d(t,{E:()=>N});var n=s(74848),r=s(96540),a=s(27783),l=s(53681);let i=r.createContext(void 0),o=r.createContext(void 0);function c(e){let{size:t,disabled:s,defaultExpanded:a,arrowPosition:c,summary:d,keepMounted:u,onUpdate:h,onSummaryKeyDown:m,expanded:p}=e,[x,j]=r.useState(()=>!!a),v=void 0!==p,f=(0,l.u)(),b=`disclosure${f}`;return(0,n.jsx)(i.Provider,{value:{size:t,disabled:s,summary:d,arrowPosition:c,keepMounted:u,expanded:v?p:x,ariaControls:f,ariaLabelledby:b,onSummaryKeyDown:m},children:(0,n.jsx)(o.Provider,{value:()=>{j(e=>!e),h(v?!p:!x)},children:e.children})})}function d(){let e=r.useContext(i);if(void 0===e)throw Error("useDisclosureAttributes must be used within DisclosureProvider");return e}var u=s(56706),h=s(5189);let m=(0,s(54699).om)("disclosure");function p({children:e,qa:t,className:s}){let a=r.useRef(null),{ariaControls:l,ariaLabelledby:i,keepMounted:o,expanded:c}=d();return(0,n.jsx)(u.A,{nodeRef:a,in:c,addEndListener:e=>a.current?.addEventListener("animationend",e),classNames:(0,h.L)(m),mountOnEnter:!o,unmountOnExit:!o,appear:!0,children:(0,n.jsx)("div",{ref:a,id:l,role:"region","aria-labelledby":i,className:m("content",{visible:c},s),"data-qa":t||"disclosure-details",children:e})})}p.displayName="DisclosureDetails";var x=s(94866),j=s(47954);let v={m:14,l:16,xl:20};function f(){(0,j.m)('[Disclosure] Physical values (left, right) of "arrowPosition" property are deprecated. Use logical values (start, end) instead.')}function b({children:e,qa:t}){let s=function(){let e=r.useContext(o);if(void 0===e)throw Error("useToggleDisclosure must be used within DisclosureProvider");return e}(),{ariaControls:a,ariaLabelledby:l,expanded:i,disabled:c,onSummaryKeyDown:u}=d(),h={onClick:s,ariaControls:a,id:l,expanded:i,disabled:c,qa:t,onKeyDown:u};return e(h,(0,n.jsx)(g,{...h}))}let g=r.forwardRef(function({onClick:e,ariaControls:t,id:s,expanded:r,disabled:a,qa:l,onKeyDown:i,className:o},c){let{size:u,summary:h,arrowPosition:p}=d(),j=p;return"left"===j&&(f(),j="start"),"right"===j&&(f(),j="end"),(0,n.jsxs)("button",{type:"button","aria-expanded":r,className:m("trigger",{disabled:a,arrow:j},o),"aria-controls":t,id:s,onClick:e,disabled:a,"data-qa":l||"disclosure-summary",onKeyDown:i,ref:c,children:[(0,n.jsx)(x.I,{size:v[u],direction:r?"top":"bottom"}),h]})});b.displayName="DisclosureSummary";let y=(0,a.g)(b),N=r.forwardRef(function(e,t){let{size:s="m",disabled:a=!1,defaultExpanded:l=!1,arrowPosition:i="start",summary:o="",className:d,keepMounted:u=!0,children:h,onUpdate:x=()=>{},onSummaryKeyDown:j,expanded:v,qa:f}=e,[N,w]=function(e,{disclosureQa:t}){let s,a,l=r.Children.toArray(e),i=[];for(let e of l){if(y(e)){if(s)throw Error("Only one <Disclosure.Summary> component is allowed");s=e;continue}i.push(e)}return i.length>0&&(a=(0,n.jsx)(p,{qa:t&&`${t}-details`,children:i})),s||(s=(0,n.jsx)(b,{qa:t&&`${t}-summary`,children:e=>(0,n.jsx)(g,{...e})})),[s,a]}(h,{disclosureQa:f});return(0,n.jsx)(c,{disabled:a,defaultExpanded:l,expanded:v,keepMounted:u,size:s,summary:o,arrowPosition:i,onUpdate:x,onSummaryKeyDown:j,children:(0,n.jsxs)("section",{ref:t,className:m({size:s},d),"data-qa":f,children:[N,w]})})});N.Summary=b,N.Details=p,N.displayName="Disclosure"}}]);