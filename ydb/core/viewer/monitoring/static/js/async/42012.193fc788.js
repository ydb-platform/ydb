"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([["42012"],{23273:function(e,t,r){r.d(t,{E:()=>h});var n=r(74848),a=r(32065),s=r(24629),i=r(43834),l=r(56496),o=r(25247),d=r(81882),u=r(51432),c=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}');let m=(0,u.g4)("ydb-diagnostics-autorefresh-control",{en:c}),p=(0,o.cn)("auto-refresh-control");function h({className:e,onManualRefresh:t}){let r=(0,d.YQ)(),[o,u]=(0,d.Nt)();return(0,n.jsxs)("div",{className:p(null,e),children:[(0,n.jsx)(s.$,{view:"flat-secondary",onClick:()=>{r(l.F.util.invalidateTags(["All"])),t?.()},"aria-label":m("Refresh"),children:(0,n.jsx)(s.$.Icon,{children:(0,n.jsx)(a.A,{})})}),(0,n.jsxs)(i.l,{value:[String(o)],onUpdate:e=>{u(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,n.jsx)(i.l.Option,{value:"0",children:m("None")}),(0,n.jsx)(i.l.Option,{value:"15000",children:m("15 sec")}),(0,n.jsx)(i.l.Option,{value:"60000",children:m("1 min")}),(0,n.jsx)(i.l.Option,{value:"120000",children:m("2 min")}),(0,n.jsx)(i.l.Option,{value:"300000",children:m("5 min")})]})]})}},80720:function(e,t,r){r.d(t,{u:()=>i});var n=r(74848),a=r(96540),s=r(54403);let i=({children:e,content:t,className:r,pinOnClick:i,hasArrow:l=!0,placement:o=["top","bottom"],...d})=>{let[u,c]=a.useState(!1),[m,p]=a.useState(!1),h=a.useRef(null);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)(s.z,{anchorElement:h.current,open:m||u,placement:o,hasArrow:l,onOutsideClick:()=>{p(!1)},...d,children:t}),(0,n.jsx)("span",{className:r,ref:h,onClick:i?()=>{p(!0)}:void 0,onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:e})]})}},50504:function(e,t,r){r.d(t,{V:()=>m});var n=r(74848);r(96540);var a=r(17427),s=r(85169),i=r(2837),l=r(25247),o=r(95980),d=r(7360),u=r(81882);let c=(0,l.cn)("storage-disk-progress-bar");function m({diskAllocatedPercent:e=-1,severity:t,compact:r,faded:l,inactive:m,empty:p,content:h,striped:g,className:f,isDonor:v,withIcon:k}){let[N]=(0,u.iK)(i.GS.INVERTED_DISKS),x={inverted:N,compact:r,faded:l,empty:p,inactive:m,striped:g};if(v)x[o.r4.toLocaleLowerCase()]=!0;else{let e=void 0!==t&&(0,d.XY)(t);e&&(x[e.toLocaleLowerCase()]=!0)}let S=null;if(k){let e=(0,d.PH)(t,v);e&&(S=(0,n.jsx)(a.I,{className:c("icon"),data:e,size:12}))}let b=!!S;return(0,n.jsxs)(s.s,{alignItems:"center",justifyContent:b?"space-between":"flex-end",className:c(x,f),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":e,children:[S,(()=>{if(r)return(0,n.jsx)("div",{className:c("fill-bar",x),style:{width:"100%"}});let t=Math.min(e,100);return(N&&(t=Math.max(100-e,0)),e>=0)?(0,n.jsx)("div",{className:c("fill-bar",x),style:{width:`${t}%`}}):null})(),h||(!r&&e>=0?(0,n.jsx)("div",{className:c("title"),children:`${Math.floor(e)}%`}):null)]})}},78799:function(e,t,r){r.d(t,{U:()=>c});var n=r(74848),a=r(24629),s=r(78636),i=r(78870),l=r(51432),o=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),d=JSON.parse('{"default_message":"Всё в порядке!","default_button_label":"Показать все"}');let u=(0,l.g4)("ydb-storage-empty-filter",{ru:d,en:o}),c=({title:e,message:t=u("default_message"),showAll:r=u("default_button_label"),onShowAll:l,image:o=(0,n.jsx)(i.v,{name:"thumbsUp",width:200})})=>(0,n.jsx)(s.pp,{image:o,position:"left",title:e,description:t,actions:l&&[(0,n.jsx)(a.$,{onClick:l,children:r},"show-all")]})},53211:function(e,t,r){r.d(t,{T:()=>o});var n=r(74848),a=r(5434),s=r(25247);let i=(0,r(51432).g4)("ydb-entities-count",{ru:{of:"из"},en:{of:"of"}}),l=(0,s.cn)("ydb-entities-count"),o=({total:e,current:t,label:r,loading:s,className:o})=>{let d="";return r&&(d+=`${r}: `),s?d+="...":(d+=`${t}`,e&&Number(e)!==Number(t)&&(d+=` ${i("of")} ${e}`)),(0,n.jsx)(a.J,{theme:"info",size:"m",className:l(null,o),children:d})}},15474:function(e,t,r){r.d(t,{P:()=>u});var n=r(74848),a=r(96540),s=r(54403),i=r(38221),l=r.n(i),o=r(35537);let d=100,u=({children:e,renderPopupContent:t,showPopup:r,offset:i,anchorRef:u,onShowPopup:c,onHidePopup:m,placement:p=["top","bottom"],contentClassName:h,delayClose:g=d,delayOpen:f=d})=>{let[v,k]=a.useState(!1),N=a.useRef(null),x=a.useMemo(()=>l()(()=>{k(!0),c?.()},f),[c,f]),S=a.useCallback(()=>{k(!1),m?.()},[m]),b=a.useMemo(()=>l()(S,g),[S,g]),[y,D]=a.useState(!1),[w,I]=a.useState(!1),j=a.useCallback(()=>{D(!0)},[]),P=a.useCallback(()=>{D(!1)},[]),C=a.useCallback(()=>{I(!0)},[]),A=a.useCallback(()=>{I(!1)},[]),E=a.useCallback(()=>{I(!1),D(!1),S()},[S]);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("span",{ref:N,onMouseEnter:x,onMouseLeave:()=>{x.cancel(),b()},children:e}),v||r||y||w?(0,n.jsx)(s.z,{anchorElement:u?.current||N.current,onOpenChange:(e,t,r)=>{"escape-key"===r&&E()},placement:p,hasArrow:!0,open:!0,offset:i||{mainAxis:12,crossAxis:0},children:(0,n.jsx)("div",{className:h,onContextMenu:C,onMouseEnter:j,onMouseLeave:P,onBlur:A,children:(0,n.jsx)("div",{className:o.zQ,children:t()})})}):null]})}},11342:function(e,t,r){r.d(t,{A:()=>s});var n=r(51432),a=JSON.parse('{"text_external-consumption":"External Consumption","text_allocator-caches":"Allocator Caches","text_shared-cache":"Shared Cache","text_memtable":"MemTable","text_query-execution":"Query Execution","text_usage":"Usage","text_soft-limit":"Soft Limit","text_hard-limit":"Hard Limit","text_other":"Other","text_memory-details":"Memory Details"}');let s=(0,n.g4)("ydb-memory-viewer",{en:a})},26552:function(e,t,r){r.d(t,{AB:()=>o,HW:()=>s,Sb:()=>d});var n=r(28241),a=r(11342);function s(e){return String((i(e.AllocatedMemory)||0)+(i(e.AllocatorCachesMemory)||0))}function i(e){return(0,n.kf)(e)?parseFloat(String(e)):void 0}let l={AllocatorCachesMemory:"var(--g-color-base-danger-medium)",SharedCacheConsumption:"var(--g-color-base-info-medium)",MemTableConsumption:"var(--g-color-base-warning-medium)",QueryExecutionConsumption:"var(--g-color-base-positive-medium)",Other:"var(--g-color-base-neutral-medium)"};function o(e){return l[e]||l.Other}function d(e,t){let r=[{label:(0,a.A)("text_shared-cache"),key:"SharedCacheConsumption",value:i(e.SharedCacheConsumption),capacity:i(e.SharedCacheLimit),isInfo:!1},{label:(0,a.A)("text_query-execution"),key:"QueryExecutionConsumption",value:i(e.QueryExecutionConsumption),capacity:i(e.QueryExecutionLimit),isInfo:!1},{label:(0,a.A)("text_memtable"),key:"MemTableConsumption",value:i(e.MemTableConsumption),capacity:i(e.MemTableLimit),isInfo:!1},{label:(0,a.A)("text_allocator-caches"),key:"AllocatorCachesMemory",value:i(e.AllocatorCachesMemory),isInfo:!1}],n=Math.max(0,t-r.filter(e=>void 0!==e.value).reduce((e,t)=>e+t.value,0));return r.push({label:(0,a.A)("text_other"),key:"Other",value:n,isInfo:!1}),r.push({label:(0,a.A)("text_external-consumption"),key:"ExternalConsumption",value:i(e.ExternalConsumption),isInfo:!0},{label:(0,a.A)("text_usage"),key:"Usage",value:t,isInfo:!0},{label:(0,a.A)("text_soft-limit"),key:"SoftLimit",value:i(e.SoftLimit),isInfo:!0},{label:(0,a.A)("text_hard-limit"),key:"HardLimit",value:i(e.HardLimit),isInfo:!0}),r.filter(e=>void 0!==e.value)}},79517:function(e,t,r){r.d(t,{D:()=>s});var n=r(51432),a=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","usage":"Usage","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","yes":"Yes"}');let s=(0,n.g4)("ydb-pDisk-info",{en:a})},39235:function(e,t,r){r.d(t,{L:()=>d});var n=r(74848),a=r(8946),s=r(60318),i=r(51432),l=JSON.parse('{"pdisk-page":"PDisk page"}');let o=(0,i.g4)("ydb-pDisk-link",{en:l});function d({pDiskId:e,nodeId:t}){return(0,n.jsx)(s.K,{title:o("pdisk-page"),url:(0,a.Ck)(e,t),external:!1})}},78331:function(e,t,r){r.d(t,{fX:()=>j,Oy:()=>A,pF:()=>C,JT:()=>P});var n=r(74848),a=r(96540),s=r(5434),i=r(85169),l=r(2543),o=r(56321),d=r(40897),u=r(35537),c=r(88387),m=r(93639),p=r(95980),h=r(81882),g=r(81709),f=r(88831),v=r(28241),k=r(60318),N=r(79517),x=r(39235),S=r(17989),b=r(70073),y=r(51432),D=JSON.parse('{"context_not-available":"Not available","label_type":"Type","label_node-id":"Node Id","label_host":"Host","label_dc":"DC","label_path":"Path","label_available":"Available","label_realtime":"Realtime","label_device":"Device","value_unknown":"unknown","value_of":"of"}');let w=(0,y.g4)("ydb-pDisk-popup",{en:D}),I=[d.m.Orange,d.m.Red,d.m.Yellow],j=(e,t)=>{let{AvailableSize:r,TotalSize:a,NodeId:i,Path:l,Realtime:o,Type:d,Device:u}=e,c=[{name:w("label_type"),content:d||w("value_unknown")}];return i&&c.push({name:w("label_node-id"),content:i}),t?.Host&&c.push({name:w("label_host"),content:t.Host}),t?.DC&&c.push({name:w("label_dc"),content:(0,n.jsx)(s.J,{children:t.DC})}),l&&c.push({name:w("label_path"),content:l}),(0,v.kf)(a)&&(0,v.kf)(r)&&c.push({name:w("label_available"),content:`${(0,v.wb)(r)} ${w("value_of")} ${(0,v.wb)(a)}`}),o&&I.includes(o)&&c.push({name:w("label_realtime"),content:(0,n.jsx)(S.k,{mode:"icons",status:o})}),u&&I.includes(u)&&c.push({name:w("label_device"),content:(0,n.jsx)(S.k,{mode:"icons",status:u})}),c},P=e=>{let t=[],{State:r}=e;if(!r)return t.push({id:"state",value:w("context_not-available")}),t;if(r){let e=(0,m.J)(r),{theme:n,icon:a}=p.nr[e];t.push({id:"state",value:r,theme:n,icon:a})}return t},C=(e,t)=>{let{NodeId:r,PDiskId:a}=e;if(!t||(0,l.isNil)(r)||(0,l.isNil)(a))return null;let s=(0,c.ar)({nodeId:r,pDiskId:a});return(0,n.jsxs)(i.s,{gap:2,wrap:"wrap",children:[(0,n.jsx)(x.L,{pDiskId:a,nodeId:r}),(0,n.jsx)(k.K,{title:(0,N.D)("developer-ui"),url:s})]})},A=({data:e})=>{let t=(0,g.J)(),r=(0,f.X)(),s=(0,h.N4)(e=>(0,o.K)(e,t)),i=(0,l.isNil)(e.NodeId)?void 0:s?.get(e.NodeId),d=a.useMemo(()=>j(e,i),[e,i]),c=a.useMemo(()=>P(e),[e]),m=a.useMemo(()=>C(e,r),[e,r]),p=e.StringifiedId;return(0,n.jsx)(b.n,{compact:!0,title:"PDisk",titleSuffix:p??u.Pd,items:d,headerLabels:c,footer:m,nameMaxWidth:100})}},12623:function(e,t,r){r.d(t,{WV:()=>o,jV:()=>l});var n=r(74848),a=r(96540);let s={sortParams:void 0,totalEntities:0,foundEntities:0,isInitialLoad:!0},i=a.createContext({tableState:s,setSortParams:()=>void 0,setTotalEntities:()=>void 0,setFoundEntities:()=>void 0,setIsInitialLoad:()=>void 0}),l=({children:e,initialState:t={},noBatching:r})=>{let[l,o]=a.useState(t.sortParams??s.sortParams),[d,u]=a.useState(t.totalEntities??s.totalEntities),[c,m]=a.useState(t.foundEntities??s.foundEntities),[p,h]=a.useState(t.isInitialLoad??s.isInitialLoad),g=a.useMemo(()=>({sortParams:l,totalEntities:d,foundEntities:c,isInitialLoad:p}),[l,d,c,p]),f=a.useMemo(()=>({tableState:g,noBatching:r,setSortParams:o,setTotalEntities:u,setFoundEntities:m,setIsInitialLoad:h}),[g,r]);return(0,n.jsx)(i.Provider,{value:f,children:e})},o=()=>{let e=a.useContext(i);if(void 0===e)throw Error("usePaginatedTableState must be used within a PaginatedTableStateProvider");return e}},41254:function(e,t,r){r.d(t,{o:()=>u});var n=r(74848),a=r(96540),s=r(48849),i=r(12623);let l=({table:e,tableWrapperProps:t})=>{let{tableState:r}=(0,i.WV)(),{sortParams:l}=r,o=a.useMemo(()=>{let e=t?.scrollDependencies||[];return{...t,scrollDependencies:[...e,l]}},[t,l]);return(0,n.jsx)(s.L.Table,{...o,children:e})},o=({controls:e,extraControls:t})=>e||t?(0,n.jsx)(s.L.Controls,{renderExtraControls:()=>t,children:e}):null,d=({error:e})=>e?(0,n.jsx)(a.Fragment,{children:e}):null,u=({controls:e,extraControls:t,table:r,tableWrapperProps:a,error:u,initialState:c,noBatching:m,fullHeight:p=!0})=>(0,n.jsx)(i.jV,{initialState:c,noBatching:m,children:(0,n.jsxs)(s.L,{fullHeight:p,children:[(0,n.jsx)(o,{controls:e,extraControls:t}),(0,n.jsx)(d,{error:u}),(0,n.jsx)(l,{table:r,tableWrapperProps:a})]})})},74104:function(e,t,r){r.d(t,{U3:()=>41,k5:()=>V,qr:()=>n});let n={NODES:"nodes",STORAGE_NODES:"storage-nodes",STORAGE_GROUPS:"storage-groups",TOPIC_DATA:"topic-data",NODE_PEERS:"node-peers"},a={[n.NODES]:!0,[n.STORAGE_NODES]:!0,[n.STORAGE_GROUPS]:!0,[n.TOPIC_DATA]:!0,[n.NODE_PEERS]:!1};var s=r(74848),i=r(96540),l=r(12623);class o{requestQueue=new Map;batchTimeout=null;BATCH_DELAY=50;queueRequest(e,t){return new Promise((r,n)=>{let a=this.createBatchKey(e);this.requestQueue.has(a)||this.requestQueue.set(a,[]),this.requestQueue.get(a).push({params:e,resolve:r,reject:n,signal:t}),this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.processBatch()},this.BATCH_DELAY)})}createBatchKey(e){return JSON.stringify({tableName:e.tableName,filters:e.filters,sortParams:e.sortParams,columnsIds:e.columnsIds,limit:e.limit})}groupConsecutiveRequests(e){if(0===e.length)return[];let t=e.sort((e,t)=>e.params.offset-t.params.offset),r=[],n=[t[0]],a=t[0].params.limit;for(let e=1;e<t.length;e++){let s=n[n.length-1].params.offset+a;t[e].params.offset===s?n.push(t[e]):(r.push(this.createBatchGroup(n)),n=[t[e]])}return r.push(this.createBatchGroup(n)),r}createBatchGroup(e){let t=Math.min(...e.map(e=>e.params.offset)),r=Math.max(...e.map(e=>e.params.offset)),n=e[0].params.limit,a=e.length*n;return{requests:e,batchKey:this.createBatchKey(e[0].params),minOffset:t,maxOffset:r,totalLimit:a}}async executeBatch(e){let t=e.requests[0],r={...t.params,offset:e.minOffset,limit:e.totalLimit};try{let n=await t.params.fetchData({limit:r.limit,offset:r.offset,filters:r.filters,sortParams:r.sortParams,columnsIds:r.columnsIds,signal:t.signal});this.splitAndDistributeResponse(e,n)}catch(t){e.requests.forEach(e=>{e.resolve({error:t})})}}splitAndDistributeResponse(e,t){let r=e.requests[0].params.limit;e.requests.forEach((e,n)=>{let a=n*r,s=t.data.slice(a,a+r),i={...t,data:s,total:t.total,found:t.found};e.resolve({data:i})})}async processBatch(){let e=Array.from(this.requestQueue.entries());for(let[t,r]of(this.requestQueue.clear(),this.batchTimeout=null,e)){let e=this.groupConsecutiveRequests(r);await Promise.all(e.map(e=>this.executeBatch(e)))}}}let d=new o,u=r(56496).F.injectEndpoints({endpoints:function(e){return{fetchTableChunk:e.query({queryFn:async({offset:e,limit:t,sortParams:r,filters:n,columnsIds:a,fetchData:s,tableName:i,noBatching:l},{signal:o})=>{try{if(l)return{data:await s({limit:t,offset:e,filters:n,sortParams:r,columnsIds:a,signal:o})};{let l=await d.queueRequest({offset:e,limit:t,sortParams:r,filters:n,columnsIds:a,fetchData:s,tableName:i},o);if("error"in l)return{error:l.error};return l}}catch(e){return{error:e}}},providesTags:["All"]})}}});var c=r(33172),m=r(81882),p=r(67103),h=r(86268);let g=(0,r(25247).cn)("ydb-paginated-table");function f(e){let t,r=null;return function(...n){t=n,"number"!=typeof r&&(r=requestAnimationFrame(()=>{e(...t),r=null}))}}let v=i.memo,k=({children:e,className:t,height:r,width:n,align:a="left",resizeable:i})=>(0,s.jsx)("td",{className:g("row-cell",{align:a},t),style:{height:`${r}px`,width:`${n}px`,maxWidth:i?`${n}px`:void 0},children:e}),N=v(function({columns:e,height:t}){return(0,s.jsx)("tr",{className:g("row",{loading:!0}),style:{height:t},children:e.map(e=>{let r=e.resizeable??!0;return(0,s.jsx)(k,{height:t,width:e.width,align:e.align,className:e.className,resizeable:r,children:(0,s.jsx)(h.E,{className:g("row-skeleton"),style:{width:"80%",height:"50%"}})},e.name)})})}),x=({row:e,columns:t,getRowClassName:r,height:n})=>{let a=r?.(e);return(0,s.jsx)("tr",{className:g("row",a),style:{height:n},children:t.map(t=>{let r=t.resizeable??!0;return(0,s.jsx)(k,{height:n,width:t.width,align:t.align,className:t.className,resizeable:r,children:t.render({row:e})},t.name)})})},S=({columns:e,children:t,height:r})=>(0,s.jsx)("tr",{className:g("row",{empty:!0}),style:{height:r},children:(0,s.jsx)("td",{colSpan:e.length,className:g("td"),children:t})});var b=r(51432),y=JSON.parse('{"empty":"Нет данных"}');let D=(0,b.g4)("ydb-paginated-table",{ru:y,en:{empty:"No data"}}),w=v(function({id:e,chunkSize:t,calculatedCount:r,rowHeight:n,columns:o,fetchData:d,tableName:h,filters:g,sortParams:f,getRowClassName:v,renderErrorMessage:k,renderEmptyDataMessage:b,onDataFetched:y,shouldFetch:w,shouldRender:I,keepCache:j}){let[P,C]=i.useState(!0),[A]=(0,m.Nt)(),{noBatching:E}=(0,l.WV)(),T=a[h]??!1,M={offset:e*t,limit:t,fetchData:d,filters:g,sortParams:f,columnsIds:i.useMemo(()=>T?o.map(e=>e.name).toSorted():[],[o,T]),tableName:h,noBatching:E};u.useFetchTableChunkQuery(M,{skip:P||!w,pollingInterval:A,refetchOnMountOrArgChange:!j});let{currentData:U,error:R}=u.endpoints.fetchTableChunk.useQueryState(M);i.useEffect(()=>{let e=0;return w&&P&&(e=window.setTimeout(()=>{C(!1)},200)),()=>{window.clearTimeout(e)}},[w,P]),i.useEffect(()=>{U&&y({...U,data:U.data,found:U.found||0,total:U.total||0})},[U,y]);let L=U?.data?.length||r;return I?(()=>{if(!U)if(R)return(0,s.jsx)(S,{columns:o,height:L*n,children:k?k(R):(0,s.jsx)(p.o,{error:R})});else return(0,c._e)(L).map(e=>(0,s.jsx)(N,{columns:o,height:n},e));return U.data?.length?U.data.map((e,t)=>(0,s.jsx)(x,{row:e,columns:o,height:n,getRowClassName:v},t)):(0,s.jsx)(S,{columns:o,height:L*n,children:b?b():D("empty")})})():null});var I=r(2543);let j=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?1:2,P=4,C=({scrollContainerRef:e,tableRef:t,foundEntities:r,chunkSize:n,rowHeight:a,columns:l,fetchData:o,filters:d,tableName:u,sortParams:c,getRowClassName:m,renderErrorMessage:p,renderEmptyDataMessage:h,onDataFetched:v,keepCache:k})=>{let N=(({scrollContainerRef:e,tableRef:t,totalItems:r,rowHeight:n,chunkSize:a,renderOverscan:s=j,fetchOverscan:l=P})=>{let o=i.useMemo(()=>Math.ceil(r/a),[a,r]),[d,u]=i.useState(0),[c,m]=i.useState(0),p=i.useCallback(()=>{let s,i,l=e?.current,d=t.current;if(!l||!d)return null;let u=(s=d.getBoundingClientRect(),i=l.getBoundingClientRect(),s.top-i.top+l.scrollTop),c=Math.max(l.scrollTop-u,0),m=c+l.clientHeight,p=function(e){let{container:t,currentTableOffset:r,totalItems:n,rowHeight:a,freezeMarginPx:s}=e,i=t.scrollTop,l=i+t.clientHeight,o="number"==typeof s?s:t.clientHeight;return l<r-o||i>r+n*a+o}({container:l,currentTableOffset:u,totalItems:r,rowHeight:n});return{start:Math.max(Math.floor(c/n/a),0),end:Math.min(Math.floor(m/n/a),Math.max(o-1,0)),skipUpdate:p}},[e,t,n,a,o,r]),h=i.useCallback(()=>{let e=p();if(e){let{start:t,end:r,skipUpdate:n}=e;if(n)return;u(t),m(r)}},[p]);i.useEffect(()=>{h()},[o,h]);let g=i.useCallback(()=>{h()},[h]);return i.useEffect(()=>{let e=f(()=>{h()});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[h]),i.useEffect(()=>{let t=e?.current;if(!t)return;let r=(0,I.throttle)(g,200,{trailing:!0,leading:!0});return t.addEventListener("scroll",r,{passive:!0}),()=>{t.removeEventListener("scroll",r)}},[g,e]),i.useMemo(()=>{let e=Math.max(d-s,0),t=Math.min(c+s,Math.max(o-1,0)),r=Math.max(d-l,0),n=Math.min(c+l,Math.max(o-1,0));return Array(o).fill(null).map((a,s)=>({shouldRender:s>=e&&s<=t,shouldFetch:s>=r&&s<=n}))},[o,d,c,s,l])})({scrollContainerRef:e,tableRef:t,totalItems:r||1,rowHeight:a,chunkSize:n}),x=i.useMemo(()=>r?r%n||n:1,[r,n]),S=i.useCallback(()=>({firstRenderIndex:N.findIndex(e=>e.shouldRender),lastRenderIndex:N.findLastIndex(e=>e.shouldRender)}),[N]),b=i.useCallback(()=>({firstFetchIndex:N.findIndex(e=>e.shouldFetch),lastFetchIndex:N.findLastIndex(e=>e.shouldFetch)}),[N]),y=i.useCallback((e,t)=>{let r=0;for(let s=e;s<t;s++)r+=(s===N.length-1?x:n)*a;return r},[n,N.length,x,a]),D=i.useCallback((e,t,r)=>{let n=y(e,t);return(0,s.jsx)("tr",{style:{height:`${n}px`},className:g(r),children:(0,s.jsx)("td",{colSpan:l.length,style:{padding:0,border:"none"}})},r)},[y,l.length]),C=i.useCallback(e=>{let t=N[e];return(0,s.jsx)(w,{id:e,calculatedCount:e===N.length-1?x:n,chunkSize:n,rowHeight:a,columns:l,fetchData:o,filters:d,tableName:u,sortParams:c,getRowClassName:m,renderErrorMessage:p,renderEmptyDataMessage:h,onDataFetched:v,shouldFetch:t.shouldFetch,shouldRender:t.shouldRender,keepCache:k},e)},[n,N,l,o,d,m,k,x,v,h,p,a,c,u]),A=i.useCallback(()=>{let{firstFetchIndex:e,lastFetchIndex:t}=b(),{firstRenderIndex:r,lastRenderIndex:n}=S(),a=[];if(-1===e)return a;r>0&&a.push(D(0,r,"separator-beginning"));for(let r=e;r<=t;r++)a.push(C(r));return n<N.length-1&&a.push(D(n+1,N.length,"separator-end")),a},[N.length,C,D,b,S]);return(0,s.jsx)(i.Fragment,{children:A()})};var A=r(46086);function E({minWidth:e,maxWidth:t,getCurrentColumnWidth:r,onResize:n}){let a=i.useRef(null),[l,o]=i.useState(!1);return i.useEffect(()=>{let s,i,l,d=a.current;if(!d)return;let u=f(r=>{if(T(r),"number"!=typeof s||"number"!=typeof i)return;let a=r.clientX-s,o=function(e,t=40,r=1/0){return Math.max(t,Math.min(e,r))}(i+a,e,t);o!==l&&(l=o,n?.(l))}),c=e=>{T(e),void 0!==l&&n?.(l),o(!1),s=void 0,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)},m=e=>{i=r(),T(e),s=e.clientX,o(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)};return d.addEventListener("mousedown",m),()=>{d.removeEventListener("mousedown",m),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)}},[n,e,t,r]),(0,s.jsx)("span",{ref:a,className:g("resize-handler",{resizing:l}),onClick:e=>T(e)})}function T(e){e.preventDefault(),e.stopPropagation()}let M=({order:e})=>(0,s.jsx)("svg",{className:g("sort-icon",{desc:-1===e}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,s.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})}),U=({sortOrder:e,sortable:t,defaultSortOrder:r})=>t?(0,s.jsx)("span",{className:g("sort-icon-container",{shadow:!e}),children:(0,s.jsx)(M,{order:e||r})}):null,R={left:"right",right:"left",center:"right"},L=({column:e,resizeable:t,sortOrder:r,defaultSortOrder:n,onSort:a,rowHeight:l,onCellMount:o,onCellUnMount:d,onColumnsResize:u})=>{let c=i.useRef(null);i.useEffect(()=>{let e=c.current;return e&&o?.(e),()=>{e&&d?.(e)}},[o,d]);let m=i.useCallback(()=>c.current?.getBoundingClientRect().width,[]),p=i.useCallback(t=>{u?.(e.name,t)},[u,e.name]),h=e.header??e.name,f={height:`${l}px`,width:`${e.width}px`,minWidth:t?`${e.width}px`:void 0,maxWidth:t?`${e.width}px`:void 0};return(0,s.jsxs)("th",{ref:c,className:g("head-cell-wrapper"),style:f,children:[(0,s.jsxs)("div",{className:g("head-cell",{align:e.align,sortable:e.sortable},e.className),onClick:()=>{e.sortable&&a?.(e.name)},children:[(0,s.jsxs)("div",{className:g("head-cell-content-container"),children:[(0,s.jsx)("div",{className:g("head-cell-content"),children:h}),e.note&&(0,s.jsx)(A.H,{popoverProps:{placement:R[e.align]},className:g("head-cell-note"),children:e.note})]}),(0,s.jsx)(U,{sortOrder:r,sortable:e.sortable,defaultSortOrder:n})]}),t?(0,s.jsx)(E,{maxWidth:e.resizeMaxWidth,minWidth:e.resizeMinWidth,getCurrentColumnWidth:m,onResize:p}):null]})},G=({columns:e,onSort:t,onColumnsResize:r,defaultSortOrder:n=-1,rowHeight:a=41})=>{let[l,o]=i.useState({}),d=e=>{let r={};if(e===l.columnId){if(l.sortOrder&&l.sortOrder!==n){o(r),t?.(r);return}r={sortOrder:1===l.sortOrder?-1:1,columnId:e}}else r={sortOrder:n,columnId:e};t?.(r),o(r)};return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)("colgroup",{children:e.map(e=>(0,s.jsx)("col",{style:{width:`${e.width}px`}},e.name))}),(0,s.jsx)("thead",{className:g("head"),children:(0,s.jsx)("tr",{children:e.map(e=>{let t=l.columnId===e.name?l.sortOrder:void 0,i=r&&(e.resizeable??!0);return(0,s.jsx)(L,{column:e,resizeable:i,sortOrder:t,defaultSortOrder:n,onSort:d,rowHeight:a,onColumnsResize:r},e.name)})})})]})},_=20,O=({limit:e=_,initialEntitiesCount:t,fetchData:r,filters:n,tableName:a,columns:o,getRowClassName:d,rowHeight:u=41,scrollContainerRef:c,onColumnsResize:m,renderErrorMessage:p,renderEmptyDataMessage:h,containerClassName:f,onDataFetched:v,keepCache:k=!0})=>{let{tableState:N,setSortParams:x,setTotalEntities:S,setFoundEntities:b,setIsInitialLoad:y}=(0,l.WV)(),{sortParams:D,foundEntities:w}=N,I=i.useRef(null),[j,P]=i.useState(n);i.useEffect(()=>{P(n)},[n]);let A=i.useCallback(e=>{e&&(S(e.total),b(e.found),y(!1),v?.(e))},[v,b,y,S]);return i.useLayoutEffect(()=>{let e=c.current;e&&"transform"!==window.getComputedStyle(e).willChange&&(e.style.willChange="transform")},[c.current]),i.useLayoutEffect(()=>{let e=t||0,r=t||1;S(e),b(r),y(!0)},[t,S,b,y]),(0,s.jsx)("div",{ref:I,className:g(null,f),children:(0,s.jsxs)("table",{className:g("table"),children:[(0,s.jsx)(G,{columns:o,onSort:x,onColumnsResize:m}),(0,s.jsx)("tbody",{children:(0,s.jsx)(C,{scrollContainerRef:c,tableRef:I,foundEntities:w,chunkSize:e,rowHeight:u,columns:o,fetchData:r,filters:j,tableName:a,sortParams:D,getRowClassName:d,renderErrorMessage:p,renderEmptyDataMessage:h,onDataFetched:A,keepCache:k})})]})})};var W=r(40563),z=r(78951);function V({columnsWidthLSKey:e,columns:t,...r}){let[n,a,i]=(0,W.a)(e),l=t.map(e=>({...e,width:n[e.name]??e.width}));return i?(0,s.jsx)(z.Q,{}):(0,s.jsx)(O,{columns:l,onColumnsResize:a,containerClassName:g("resizeable-table-container"),...r})}},48649:function(e,t,r){r.d(t,{_:()=>u});var n=r(74848),a=r(25247),s=r(80720),i=r(18016);let l=(0,a.cn)("ydb-pool-bar"),o=({data:e={}})=>{let{Usage:t=0}=e,r=Math.min(100*t,100),a=r>=75?"danger":r>=50&&r<75?"warning":"normal";return(0,n.jsx)(s.u,{className:l({type:a}),content:(0,n.jsx)(i.HG,{data:e,className:l("popup-content")}),children:(0,n.jsx)("div",{style:{height:`${r}%`},className:l("value",{type:a})})})},d=(0,a.cn)("ydb-pools-graph"),u=({pools:e=[]})=>(0,n.jsx)("div",{className:d(),children:e.map((e,t)=>(0,n.jsx)(o,{data:e},t))})},52705:function(e,t,r){r.d(t,{O:()=>d});var n=r(74848),a=r(29714),s=r(25247),i=r(5577),l=r(28241);let o=(0,s.cn)("progress-viewer");function d({value:e,capacity:t,formatValues:r=i.g,percents:s,withOverflow:d,className:u,size:c="xs",colorizeProgress:m,inverseColorize:p,warningThreshold:h,dangerThreshold:g,hideCapacity:f}){let v=(0,a.D)(),k=Math.floor(parseFloat(String(e))/parseFloat(String(t))*100)||0,N=k;k=k>100?100:k;let x=e,S=t,b="/";s?(x=(d?N:k)+"%",S="",b=""):r&&([x,S]=r(Number(e),Number(t)));let y=(0,i.w)({fillWidth:k,warningThreshold:h,dangerThreshold:g,colorizeProgress:m,inverseColorize:p});m&&!(0,l.kf)(t)&&(k=100);let D={width:k+"%"};return(0,l.kf)(e)?(0,n.jsxs)("div",{className:o({size:c,theme:v,status:y},u),children:[(0,n.jsx)("div",{className:o("line"),style:D}),(0,n.jsx)("span",{className:o("text"),children:(0,l.kf)(t)&&!f?`${x} ${b} ${S}`:x})]}):(0,n.jsx)("div",{className:`${o({size:c})} ${u} error`,children:"no data"})}},29472:function(e,t,r){r.d(t,{v:()=>d});var n=r(74848);r(96540);var a=r(25247),s=r(33777),i=r(36354);let l=({onUpdate:e,value:t="",debounce:r=200,...a})=>{let[l,o]=(0,i.o)({value:t,onUpdate:e,debounce:r});return(0,n.jsx)(s.k,{value:l,onUpdate:o,...a})},o=(0,a.cn)("ydb-search"),d=({onChange:e,value:t="",width:r,className:a,debounce:s,inputRef:i,...d})=>(0,n.jsx)(l,{debounce:s,hasClear:!0,autoFocus:!0,controlRef:i,style:{width:r},className:o(null,a),value:t,onUpdate:e,...d})},31596:function(e,t,r){r.d(t,{O:()=>d});var n=r(74848),a=r(64482),s=r(77269),i=r(24629),l=r(17427),o=r(98537);function d(e){let{items:t,showStatus:r,disabled:d}=e;return(0,n.jsx)(o.O,{...e,renderSwitcher:e=>(0,n.jsxs)(i.$,{disabled:d,onClick:e.onClick,children:[(0,n.jsx)(l.I,{data:a.A}),(()=>{if(!r)return null;let e=t.reduce((e,t)=>t.selected?e+1:e,0),a=t.length;return(0,n.jsxs)(s.E,{color:"secondary",children:[e,"/",a]})})()]}),hideApplyButton:!0})}},48849:function(e,t,r){r.d(t,{L:()=>d});var n=r(74848),a=r(96540),s=r(85169),i=r(25247),l=r(78951);let o=(0,i.cn)("ydb-table-with-controls-layout"),d=({children:e,className:t,fullHeight:r})=>(0,n.jsx)("div",{className:o({"full-height":r},t),children:e});d.Controls=function({children:e,renderExtraControls:t,className:r}){return(0,n.jsxs)(s.s,{justifyContent:"space-between",className:o("controls-wrapper"),gap:2,children:[(0,n.jsx)("div",{className:o("controls",r),children:e}),(0,n.jsx)("div",{className:o("extra-controls"),children:t?.()})]})},d.Table=function({children:e,loading:t,className:r,scrollContainerRef:s,scrollDependencies:i=[]}){let d=a.useRef(null);return((({tableContainerRef:e,scrollContainerRef:t,dependencies:r=[]})=>{let n=a.useCallback(()=>{if(e?.current){let t=window.getComputedStyle(e.current).getPropertyValue("--data-table-sticky-header-offset");return t?parseInt(t,10):0}return 0},[e]),s=a.useCallback(()=>{if(e?.current&&t?.current){let r=n(),a=e.current.getBoundingClientRect(),s=t.current.getBoundingClientRect(),i=a.top-s.top+t.current.scrollTop;a.top-r<s.top&&t.current.scrollTo(0,i-r)}},[t,e,n]);return a.useLayoutEffect(()=>{e&&t&&s()},[s,e,t,...r])})({tableContainerRef:d,scrollContainerRef:s,dependencies:i}),t)?(0,n.jsx)(l.Q,{className:o("loader")}):(0,n.jsx)("div",{ref:d,className:o("table",r),children:e})}},92961:function(e,t,r){r.d(t,{j:()=>i});var n=r(74848),a=r(81392),s=r(65101);let i=({value:e,onChange:t,className:r})=>(0,n.jsxs)(a.x,{value:e,onUpdate:t,className:r,children:[(0,n.jsx)(a.x.Option,{value:"All",children:s.DG.All}),(0,n.jsx)(a.x.Option,{value:"SmallUptime",children:s.DG.SmallUptime})]})},80184:function(e,t,r){r.d(t,{y:()=>G});var n=r(74848),a=r(8946),s=r(25247),i=r(95980),l=r(50504),o=r(15474),d=r(15749),u=r(96540),c=r(85169),m=r(65066),p=r(2543),h=r(56321),g=r(40897),f=r(35537),v=r(97855),k=r(88387),N=r(16021),x=r(7360),S=r(81882),b=r(81709),y=r(88831),D=r(28241),w=r(60318),I=r(78331),j=r(17989),P=r(65153),C=r(70073),A=r(51432),E=JSON.parse('{"context_not-available":"not available","label_no-data":"No data","label_storage-pool":"StoragePool","label_donor":"Donor","label_node-id":"NodeId","label_pdisk-id":"PDiskId","label_vslot-id":"VSlotId","label_links":"Links","label_vdisk":"VDisk","label_fresh":"Fresh","label_level":"Level","label_space":"Space","label_front-queues":"FrontQueues","label_replicated":"Replicated","label_progress":"Progress","label_remaining":"Remaining","label_unsync-vdisks":"UnsyncVDisks","label_allocated":"Allocated","label_read":"Read","label_write":"Write","label_replication":"Replication","label_recipient":"Recipient"}');let T=(0,A.g4)("ydb-vDisk-popup",{en:E}),M=(0,s.cn)("vdisk-storage-popup"),U=({nodeId:e,stringifiedId:t,getVDiskLinkFn:r})=>{if((0,p.isNil)(t))return(0,n.jsx)("span",{children:f.Pd});if((0,p.isNil)(e))return(0,n.jsx)("span",{children:t});let a=r?.({nodeId:e,vDiskId:t});return(0,n.jsxs)(d.E,{to:a,children:[T("label_vdisk")," ",t]})},R=({data:e})=>{let t=(0,x.NJ)(e),r=(0,y.b)(),s=(0,y.X)(),l=(0,a.Z$)(),o=(0,b.J)(),d=u.useMemo(()=>t?((e,t)=>{let{VDiskState:r,SatisfactionRank:a,DiskSpace:s,FrontQueues:l,Replicated:o,ReplicationProgress:d,ReplicationSecondsRemaining:u,UnsyncedVDisks:m,AllocatedSize:h,ReadThroughput:f,WriteThroughput:k,StoragePoolName:N,Donors:x,DonorMode:S,Recipient:b,Severity:y}=e,w=[];if(N&&w.push({name:T("label_storage-pool"),content:N}),x?.length&&y===i.aW.Blue&&w.push({name:T("label_donor"),content:(0,n.jsx)(c.s,{direction:"column",children:x.map(e=>(0,n.jsx)(U,{nodeId:e.NodeId,stringifiedId:e.StringifiedId,getVDiskLinkFn:t},e.StringifiedId))})}),S&&b&&w.push({name:T("label_recipient"),content:(0,n.jsx)(U,{nodeId:b.NodeId,stringifiedId:b.StringifiedId,getVDiskLinkFn:t})}),a&&a.FreshRank?.Flag!==g.m.Green&&w.push({name:T("label_fresh"),content:a.FreshRank?.Flag}),a&&a.LevelRank?.Flag!==g.m.Green&&w.push({name:T("label_level"),content:a.LevelRank?.Flag}),a&&a.FreshRank?.RankPercent&&w.push({name:T("label_fresh"),content:a.FreshRank.RankPercent}),a&&a.LevelRank?.RankPercent&&w.push({name:T("label_level"),content:a.LevelRank.RankPercent}),s&&w.push({name:T("label_space"),content:(0,n.jsx)(j.k,{mode:"icons",status:s})}),l&&w.push({name:T("label_front-queues"),content:(0,n.jsx)(j.k,{mode:"icons",status:l})}),!1===o&&"OK"===r){if(w.push({name:T("label_replicated"),content:"NO"}),!(0,p.isNil)(d)){let e=Math.round(100*d);w.push({name:T("label_progress"),content:`${e}%`})}if(!(0,p.isNil)(u)){let e=(0,v.je)(u);e&&w.push({name:T("label_remaining"),content:e})}}return m&&w.push({name:T("label_unsync-vdisks"),content:m}),Number(h)&&w.push({name:T("label_allocated"),content:(0,D.wb)(h)}),Number(f)&&w.push({name:T("label_read"),content:(0,D.O4)(f)}),Number(k)&&w.push({name:T("label_write"),content:(0,D.O4)(k)}),w})(e,l):(e=>{let{NodeId:t,PDiskId:r,VSlotId:n,StoragePoolName:a}=e,s=[];return a&&s.push({name:T("label_storage-pool"),content:a}),s.push({name:T("label_node-id"),content:t??f.Pd},{name:T("label_pdisk-id"),content:r??f.Pd},{name:T("label_vslot-id"),content:n??f.Pd}),s})(e),[e,t,l]),A=u.useMemo(()=>t?(e=>{let t=[],{VDiskState:r,DonorMode:n,Severity:a}=e,s=a===i.aW.Blue;if(n){let e=i.WK.donor;t.push({id:"donor",value:T("label_donor"),theme:e.theme,icon:e.icon})}if(s){if(!n){let e=i.WK.replica;t.push({id:"replication",value:T("label_replication"),theme:e.theme,icon:e.icon})}return t}let l=r?(0,N.J)(r):i.Km,{theme:o,icon:d}=i.nr[l],u=r??T("label_no-data");return t.push({id:"state",value:u,theme:o,icon:d}),t})(e):[],[e,t]),E=u.useMemo(()=>t?((e,t,r)=>{if(!t)return null;let{NodeId:a,PDiskId:s,VDiskSlotId:i,StringifiedId:l}=e;if((0,p.isNil)(a)||(0,p.isNil)(s)||(0,p.isNil)(i)&&(0,p.isNil)(l))return null;let o=(0,p.isNil)(i)?void 0:(0,k.Wg)({nodeId:a,pDiskId:s,vDiskSlotId:i}),d=r?.({nodeId:a,vDiskId:l});return d?(0,n.jsxs)(c.s,{className:M("links"),wrap:"wrap",gap:2,children:[d&&(0,n.jsx)(w.K,{title:(0,P.r)("vdisk-page"),url:d,external:!1},d),o&&(0,n.jsx)(w.K,{title:(0,P.r)("developer-ui"),url:o})]}):null})(e,s,l):((e,t)=>{let{NodeId:r,PDiskId:a,VSlotId:s}=e;if(!t||(0,p.isNil)(r)||(0,p.isNil)(a)||(0,p.isNil)(s))return null;let i=(0,k.Wg)({nodeId:r,pDiskId:a,vDiskSlotId:s});return(0,n.jsx)("div",{className:M("links"),children:(0,n.jsx)(w.K,{title:"Developer UI",url:i})})})(e,s),[e,t,s,l]),R=(0,S.N4)(e=>(0,h.K)(e,o)),L=(0,p.isNil)(e.NodeId)?void 0:R?.get(e.NodeId),G=u.useMemo(()=>t&&e.PDisk&&(0,I.fX)(e.PDisk,L),[e,L,t]),_=u.useMemo(()=>t&&e.PDisk?(0,I.JT)(e.PDisk):[],[e,t]),O=u.useMemo(()=>t&&e.PDisk?(0,I.pF)(e.PDisk,s):null,[e,t,s]),W=t?e.StringifiedId:void 0,z=t?e.PDisk?.StringifiedId:void 0;return(0,n.jsxs)("div",{className:M(),children:[(0,n.jsx)(C.n,{compact:!0,title:"VDisk",titleSuffix:W??f.Pd,items:d,headerLabels:A,nameMaxWidth:100,footer:E}),G&&r&&(0,n.jsxs)(u.Fragment,{children:[(0,n.jsx)(m.c,{className:M("custom-divider")}),(0,n.jsx)(C.n,{compact:!0,title:"PDisk",titleSuffix:z??f.Pd,items:G,headerLabels:_,footer:O,nameMaxWidth:100})]})]})},L=(0,s.cn)("ydb-vdisk-component"),G=({data:e={},compact:t,inactive:r,showPopup:s,onShowPopup:u,onHidePopup:c,progressBarClassName:m,delayClose:p,delayOpen:h,withIcon:g})=>{let f=(0,a.Z$)()({nodeId:e.NodeId,vDiskId:e.StringifiedId}),v=e.Severity,k=v===i.aW.Blue,N=e.DonorMode&&k;return(0,n.jsx)(o.P,{showPopup:s,onShowPopup:u,onHidePopup:c,renderPopupContent:()=>(0,n.jsx)(R,{data:e}),offset:{mainAxis:2,crossAxis:0},delayClose:p,delayOpen:h,children:(0,n.jsx)("div",{className:L(),children:(0,n.jsx)(d.E,{to:f,className:L("content"),children:(0,n.jsx)(l.V,{diskAllocatedPercent:e.AllocatedPercent,severity:v,compact:t,inactive:r,striped:k,isDonor:N,className:m,withIcon:g})})})})}},65153:function(e,t,r){r.d(t,{r:()=>s});var n=r(51432),a=JSON.parse('{"slot-id":"VDisk Slot Id","label_pdisk-id":"PDisk Id","pool-name":"Storage Pool Name","kind":"Kind","guid":"GUID","incarnation-guid":"Incarnation GUID","instance-guid":"Instance GUID","replication-status":"Replicated","replication-progress":"Replication Progress","replication-time-remaining":"Time Remaining","donors":"Donors","state-status":"VDisk State","space-status":"Disk Space","fresh-rank-satisfaction":"Fresh Rank Satisfaction","level-rank-satisfaction":"Level Rank Satisfaction","front-queues":"Front Queues","has-unreadable-blobs":"Has Unreadable Blobs","size":"Size","usage":"Usage","read-throughput":"Read Throughput","write-throughput":"Write Throughput","links":"Links","vdisk-page":"VDisk page","developer-ui":"Developer UI","yes":"Yes","no":"No","vdiks-title":"VDisk"}');let s=(0,n.g4)("ydb-vDisk-info",{en:a})},70073:function(e,t,r){r.d(t,{n:()=>h});var n=r(74848),a=r(96540),s=r(85169),i=r(5434),l=r(17427),o=r(66918),d=r(25247),u=r(51432),c=JSON.parse('{"no-data":"No data"}');let m=(0,u.g4)("ydb-definition-list",{en:c}),p=(0,d.cn)("ydb-definition-list");function h({title:e,titleSuffix:t,titleSeparator:r="•",headerLabels:d,iconSize:u=12,labelSize:c="xs",footer:h,items:g,compact:f,nameMaxWidth:v=220,className:k,...N}){let x=!!(e||t||d&&d.length);return(0,n.jsxs)("div",{className:p({compact:f}),children:[x?(0,n.jsxs)(s.s,{className:p("header"),justifyContent:"space-between",gap:2,alignItems:"center",children:[e&&(0,n.jsxs)(s.s,{gap:"1",alignItems:"center",children:[(0,n.jsx)("div",{className:p("title"),children:e}),t&&(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{className:p("title-suffix"),children:r}),(0,n.jsx)("div",{className:p("title-suffix"),children:t})]})]}),d&&d.length>0&&(0,n.jsx)(s.s,{gap:1,alignItems:"center",children:d.map(e=>(0,n.jsx)(i.J,{theme:e.theme,icon:e.icon?(0,n.jsx)(l.I,{data:e.icon,size:u}):void 0,size:c,children:e.value},e.id))})]}):null,g.length?(0,n.jsx)(o.u,{nameMaxWidth:v,className:p("properties-list",k),...N,children:g.map(e=>(0,n.jsx)(o.u.Item,{children:e.content,...e},e.name))}):m("no-data"),h?(0,n.jsx)("div",{className:p("footer"),children:h}):null]})}},65943:function(e,t,r){r.d(t,{LD:()=>eh,pH:()=>Q,DH:()=>ed,SH:()=>el,pt:()=>em,jl:()=>K,ID:()=>et,Bg:()=>en,OV:()=>J,Nh:()=>H,uk:()=>$,fR:()=>er,kv:()=>Z,qp:()=>es,b8:()=>F,Rn:()=>q,eT:()=>B,oz:()=>ea,wN:()=>ec,ui:()=>eu,OX:()=>Y,H:()=>eo,fr:()=>ee,iX:()=>X,Vz:()=>ei,rU:()=>ep,_E:()=>V});var n=r(74848),a=r(29581),s=r(66918),i=r(33172),l=r(25247),o=r(35537),d=r(97855),u=r(14016),c=r(51630),m=r(28241),p=r(5948),h=r(29714),g=r(85169),f=r(9849),v=r(5577),k=r(15474),N=r(52705),x=r(26552);let S=.01*o.J7,b=(0,l.cn)("memory-viewer"),y=(e,t)=>[(0,f.z3)({value:e,size:"gb",withSizeLabel:!1,precision:2}),(0,f.z3)({value:t,size:"gb",withSizeLabel:!0,precision:1})];function D({stats:e,percents:t,formatValues:r,className:a,warningThreshold:i,dangerThreshold:l}){let o=e.AnonRss??(0,x.HW)(e),d=e.HardLimit,u=(0,h.D)(),c=Math.floor(parseFloat(String(o))/parseFloat(String(d))*100)||0;c=c>100?100:c;let p=o,D=d,w="/";t?(p=c+"%",D="",w=""):r&&([p,D]=r(Number(o),Number(d)));let I=(0,x.Sb)(e,Number(o)),j=(0,v.w)({fillWidth:c,warningThreshold:i,dangerThreshold:l,colorizeProgress:!0}),P=0;return(0,n.jsx)(k.P,{renderPopupContent:()=>(0,n.jsx)(s.u,{responsive:!0,children:I.map(({label:e,value:t,capacity:r,key:a})=>(0,n.jsx)(s.u.Item,{name:(0,n.jsxs)(g.s,{alignItems:"center",gap:"1",className:b("container"),children:[(0,n.jsx)("div",{className:b("legend",{type:a})}),(0,n.jsx)("div",{className:b("name"),children:e})]}),children:r?(0,n.jsx)(N.O,{value:t,capacity:r,formatValues:y,colorizeProgress:!0}):(0,f.z3)({value:t,size:"gb",withSizeLabel:!0,precision:2})},e))}),children:(0,n.jsx)("div",{className:b({theme:u,status:j},a),children:(0,n.jsxs)("div",{className:b("progress-container"),children:[I.filter(({isInfo:e})=>!e).map(e=>{var t;if(e.value<S)return null;let r=Math.max((t=e.value,o?t/parseFloat(String(d))*100:0),1),a=P;return P+=r,(0,n.jsx)("div",{className:b("segment",{type:e.key}),style:{width:`${r}%`,left:`${a}%`}},e.key)}),(0,n.jsx)(g.s,{justifyContent:"center",alignItems:"center",className:b("text"),children:(0,m.kf)(d)?`${p} ${w} ${D}`:p})]})})})}var w=r(8946),I=r(65101),j=r(93397),P=r(18016);let C=({node:e,database:t,statusForIcon:r="SystemState"})=>{if(!e.Host)return o.Pd;let a="ConnectStatus"===r?e.ConnectStatus:e.SystemState,s=!(0,I.X7)(e),i=(0,I.wH)(e)?void 0:t??e.TenantName,l=s?(0,w.vI)({id:e.NodeId,activeTab:e.TenantName?"tablets":"storage"},{database:i}):void 0;return(0,n.jsx)(j.c,{name:e.Host,status:a,path:l,hasClipboardButton:!0,infoPopoverContent:s?(0,n.jsx)(P.p,{data:e}):null})};var A=r(48649),E=r(54625),T=r(53486);let M=(0,l.cn)("tablets-statistic"),U=({tablets:e=[],database:t,nodeId:r})=>{let a=e.map(e=>({label:(0,o.bk)(e.Type),type:e.Type,count:e.Count,state:(0,T.P)(e.State)})).sort((e,t)=>String(e.label).localeCompare(String(t.label)));return(0,n.jsx)("div",{className:M(),children:a.map((e,a)=>{let s=(0,w.vI)({id:r,activeTab:"tablets"},{database:t}),i=`${e.label}: ${e.count}`,l=M("tablet",{state:e.state?.toLowerCase()});return(0,n.jsx)(E.N_,{to:s,className:l,children:i},a)})})};var R=r(9753),L=r(79092),G=r(87669),_=r(47456);function O(e){return(0,c.Xo)((0,c.Jc)(e,1))}function W(e){let t=(0,c.Jc)(e,1);return(0>=Number(t)?"":"+")+(0,c.Xo)(t)}let z=(0,l.cn)("ydb-nodes-columns");function V(){return{name:G.vg.NodeId,header:"#",width:80,resizeMinWidth:80,render:({row:e})=>e.NodeId,align:a.Ay.RIGHT}}function H({database:e}){return{name:G.vg.Host,header:G.uG.Host,render:({row:t})=>(0,n.jsx)(C,{node:t,database:e}),width:350,align:a.Ay.LEFT}}function F({database:e}){return{name:G.vg.NetworkHost,header:G.uG.NetworkHost,render:({row:t})=>(0,n.jsx)(C,{node:t,database:e,statusForIcon:"ConnectStatus"}),width:350,align:a.Ay.LEFT}}function B(){return{name:G.vg.NodeName,header:G.uG.NodeName,align:a.Ay.LEFT,render:({row:e})=>e.NodeName||o.Pd,width:200}}function $(){return{name:G.vg.DC,header:G.uG.DC,align:a.Ay.LEFT,render:({row:e})=>e.DC||o.Pd,width:60}}function Y(){return{name:G.vg.Rack,header:G.uG.Rack,align:a.Ay.LEFT,render:({row:e})=>e.Rack||o.Pd,width:100}}function J(){return{name:G.vg.PileName,header:(0,_.A)("field_pile-name"),align:a.Ay.LEFT,render:({row:e})=>e.PileName||o.Pd,width:100}}function q(){return{name:G.vg.Version,header:G.uG.Version,width:200,align:a.Ay.LEFT,render:({row:e})=>(0,n.jsx)(p.s,{content:e.Version,children:e.Version})}}function K(){return{name:G.vg.Uptime,header:G.uG.Uptime,sortAccessor:({StartTime:e})=>e?-e:0,render:({row:e})=>(0,n.jsx)(R.p,{StartTime:e.StartTime,DisconnectTime:e.DisconnectTime}),align:a.Ay.RIGHT,width:120}}function Q(){return{name:G.vg.RAM,header:G.uG.RAM,sortAccessor:({MemoryUsed:e=0})=>Number(e),defaultOrder:a.Ay.DESCENDING,render:({row:e})=>{let[t,r]=(0,m.kf)(e.MemoryUsed)&&(0,m.kf)(e.MemoryLimit)?(0,d.j9)(Number(e.MemoryUsed),Number(e.MemoryLimit),"gb",void 0,!0):[0,0];return(0,n.jsx)(p.s,{placement:["top","bottom"],fullWidth:!0,content:(0,n.jsxs)(s.u,{responsive:!0,children:[(0,n.jsx)(s.u.Item,{name:(0,_.A)("field_memory-used"),children:t}),(0,n.jsx)(s.u.Item,{name:(0,_.A)("field_memory-limit"),children:r})]}),children:(0,n.jsx)(N.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:(e,t)=>(0,d.j9)(e,t,"gb",void 0,!0),className:z("column-ram"),colorizeProgress:!0,hideCapacity:!0})})},align:a.Ay.LEFT,width:80,resizeMinWidth:40}}function X(){return{name:G.vg.Memory,header:G.uG.Memory,defaultOrder:a.Ay.DESCENDING,render:({row:e})=>e.MemoryStats?(0,n.jsx)(D,{formatValues:d.vX,stats:e.MemoryStats}):(0,n.jsx)(N.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:d.vX,colorizeProgress:!0}),align:a.Ay.LEFT,width:300,resizeMinWidth:170}}function Z(){return{name:G.vg.Pools,header:G.uG.Pools,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map(({Usage:e})=>Number(e))),defaultOrder:a.Ay.DESCENDING,render:({row:e})=>e.PoolStats?(0,n.jsx)(A._,{pools:e.PoolStats}):o.Pd,align:a.Ay.LEFT,width:80,resizeMinWidth:60}}function ee(){return{name:G.vg.CPU,header:G.uG.CPU,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map(({Usage:e})=>Number(e))),defaultOrder:a.Ay.DESCENDING,render:({row:e})=>{if(!e.PoolStats)return o.Pd;let t=(0,m.kf)(e.CoresUsed)&&(0,m.kf)(e.CoresTotal)?e.CoresUsed/e.CoresTotal:void 0;if(void 0===t){let r=0;t=e.PoolStats.reduce((e,t)=>(r+=Number(t.Threads),e+Number(t.Usage)*Number(t.Threads)),0)/r}return(0,n.jsx)(p.s,{placement:["top","bottom"],fullWidth:!0,content:(0,n.jsx)(s.u,{responsive:!0,children:e.PoolStats.map(e=>(0,m.kf)(e.Usage)?(0,n.jsx)(s.u.Item,{name:e.Name,children:(0,P.Qz)("Usage",e.Usage).value},e.Name):null)}),children:(0,n.jsx)(N.O,{className:z("column-cpu"),value:t,capacity:1,colorizeProgress:!0,percents:!0})})},align:a.Ay.LEFT,width:80,resizeMinWidth:40}}function et(){return{name:G.vg.LoadAverage,header:G.uG.LoadAverage,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:a.Ay.DESCENDING,render:({row:e})=>(0,n.jsx)(N.O,{value:e.LoadAveragePercents&&e.LoadAveragePercents.length>0?e.LoadAveragePercents[0]:void 0,percents:!0,colorizeProgress:!0,capacity:100}),align:a.Ay.LEFT,width:170,resizeMinWidth:170}}function er(){return{name:G.vg.Load,header:G.uG.Load,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:a.Ay.DESCENDING,render:({row:e})=>e.LoadAveragePercents&&e.LoadAveragePercents.length>0?(0,n.jsx)(L.U,{value:e.LoadAveragePercents[0].toFixed(),theme:(0,u.f)(e.LoadAveragePercents[0])}):o.Pd,align:a.Ay.LEFT,width:80,resizeMinWidth:70}}function en(){return{name:G.vg.DiskSpaceUsage,header:G.uG.DiskSpaceUsage,render:({row:e})=>(0,i.f8)(e.DiskSpaceUsage)?(0,n.jsx)(L.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,u.f)(e.DiskSpaceUsage)}):o.Pd,align:a.Ay.LEFT,width:115,resizeMinWidth:75}}function ea(){return{name:G.vg.TotalSessions,header:G.uG.TotalSessions,render:({row:e})=>e.TotalSessions??o.Pd,align:a.Ay.RIGHT,width:100}}function es({database:e}){return{name:G.vg.Tablets,header:G.uG.Tablets,width:500,resizeMinWidth:500,render:({row:t})=>t.Tablets?(0,n.jsx)(U,{database:e??t.TenantName,nodeId:t.NodeId,tablets:t.Tablets}):o.Pd,align:a.Ay.LEFT,sortable:!1}}function ei(){return{name:G.vg.Missing,header:G.uG.Missing,render:({row:e})=>e.Missing,align:a.Ay.CENTER,defaultOrder:a.Ay.DESCENDING,width:100}}function el(){return{name:G.vg.Connections,header:G.uG.Connections,render:({row:e})=>(0,m.kf)(e.Connections)?e.Connections:o.Pd,align:a.Ay.RIGHT,width:130}}function eo(){return{name:G.vg.NetworkUtilization,header:G.uG.NetworkUtilization,render:({row:e})=>{let{NetworkUtilization:t,NetworkUtilizationMin:r=0,NetworkUtilizationMax:a=0}=e;return(0,m.kf)(t)?(0,n.jsx)(p.s,{placement:["top","bottom"],content:(0,n.jsxs)(s.u,{responsive:!0,children:[(0,n.jsx)(s.u.Item,{name:(0,_.A)("sum"),children:(0,d.l9)(t)},"NetworkUtilization"),(0,n.jsx)(s.u.Item,{name:(0,_.A)("min"),children:(0,d.l9)(r)},"NetworkUtilizationMin"),(0,n.jsx)(s.u.Item,{name:(0,_.A)("max"),children:(0,d.l9)(a)},"NetworkUtilizationMax")]}),children:(0,d.l9)(t)}):o.Pd},align:a.Ay.RIGHT,width:110}}function ed(){return{name:G.vg.SendThroughput,header:G.uG.SendThroughput,render:({row:e})=>(0,m.kf)(e.SendThroughput)?(0,m.O4)(e.SendThroughput,1):o.Pd,align:a.Ay.RIGHT,width:110}}function eu(){return{name:G.vg.ReceiveThroughput,header:G.uG.ReceiveThroughput,render:({row:e})=>(0,m.kf)(e.ReceiveThroughput)?(0,m.O4)(e.ReceiveThroughput,1):o.Pd,align:a.Ay.RIGHT,width:110}}function ec(){return{name:G.vg.PingTime,header:G.uG.PingTime,render:({row:e})=>{let{PingTimeUs:t,PingTimeMinUs:r=0,PingTimeMaxUs:a=0}=e;return(0,m.kf)(t)?(0,n.jsx)(p.s,{placement:["top","bottom"],content:(0,n.jsxs)(s.u,{responsive:!0,children:[(0,n.jsx)(s.u.Item,{name:(0,_.A)("avg"),children:O(t)},"PingTimeUs"),(0,n.jsx)(s.u.Item,{name:(0,_.A)("min"),children:O(r)},"PingTimeMinUs"),(0,n.jsx)(s.u.Item,{name:(0,_.A)("max"),children:O(a)},"PingTimeMaxUs")]}),children:O(t)}):o.Pd},align:a.Ay.RIGHT,width:110}}function em(){return{name:G.vg.ClockSkew,header:G.uG.ClockSkew,render:({row:e})=>{let{ClockSkewUs:t,ClockSkewMinUs:r=0,ClockSkewMaxUs:a=0}=e;return(0,m.kf)(t)?(0,n.jsx)(p.s,{placement:["top","bottom"],content:(0,n.jsxs)(s.u,{responsive:!0,children:[(0,n.jsx)(s.u.Item,{name:(0,_.A)("avg"),children:W(t)},"ClockSkewUs"),(0,n.jsx)(s.u.Item,{name:(0,_.A)("min"),children:W(r)},"ClockSkewMinUs"),(0,n.jsx)(s.u.Item,{name:(0,_.A)("max"),children:W(a)},"ClockSkewMaxUs")]}),children:W(t)}):o.Pd},align:a.Ay.RIGHT,width:110}}function ep(){return{name:G.vg.ClockSkew,header:G.uG.ClockSkew,align:a.Ay.RIGHT,width:110,resizeMinWidth:90,render:({row:e})=>(0,m.kf)(e.ClockSkewUs)?(0,c.Xo)((0,c.Jc)(e.ClockSkewUs,1)):o.Pd}}function eh(){return{name:G.vg.PingTime,header:G.uG.PingTime,align:a.Ay.RIGHT,width:110,resizeMinWidth:90,render:({row:e})=>(0,m.kf)(e.PingTimeUs)?(0,c.Xo)((0,c.Jc)(e.PingTimeUs)):o.Pd}}},87669:function(e,t,r){r.d(t,{fN:()=>p,kU:()=>g,kn:()=>m,ri:()=>d,sp:()=>f,uG:()=>u,vg:()=>s,xd:()=>l,zO:()=>a});var n=r(47456);let a="nodesTableColumnsWidth",s={NodeId:"NodeId",Host:"Host",NetworkHost:"NetworkHost",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"RAM",CPU:"CPU",Pools:"Pools",LoadAverage:"LoadAverage",Load:"Load",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:"TotalSessions",Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:"Tablets",PDisks:"PDisks",PileName:"PileName"},i=["Pools","Memory"];function l(e){return i.includes(e)}let o=["LoadAverage","PDisks"];function d(e){return o.some(t=>t===e)}let u={get NodeId(){return(0,n.A)("node-id")},get Host(){return(0,n.A)("host")},get NetworkHost(){return(0,n.A)("host")},get Database(){return(0,n.A)("database")},get NodeName(){return(0,n.A)("node-name")},get DC(){return(0,n.A)("dc")},get Rack(){return(0,n.A)("rack")},get Version(){return(0,n.A)("version")},get Uptime(){return(0,n.A)("uptime")},get Memory(){return(0,n.A)("memory")},get RAM(){return(0,n.A)("ram")},get Pools(){return(0,n.A)("pools")},get CPU(){return(0,n.A)("cpu")},get LoadAverage(){return(0,n.A)("load-average")},get Load(){return(0,n.A)("load")},get DiskSpaceUsage(){return(0,n.A)("disk-usage")},get TotalSessions(){return(0,n.A)("sessions")},get Connections(){return(0,n.A)("connections")},get NetworkUtilization(){return(0,n.A)("utilization")},get SendThroughput(){return(0,n.A)("send")},get ReceiveThroughput(){return(0,n.A)("receive")},get PingTime(){return(0,n.A)("ping")},get ClockSkew(){return(0,n.A)("skew")},get Missing(){return(0,n.A)("missing")},get Tablets(){return(0,n.A)("tablets")},get PDisks(){return(0,n.A)("pdisks")},get PileName(){return(0,n.A)("field_pile-name")}},c={get NodeId(){return(0,n.A)("node-id")},get Host(){return(0,n.A)("host")},get NodeName(){return(0,n.A)("node-name")},get Database(){return(0,n.A)("database")},get DiskSpaceUsage(){return(0,n.A)("disk-usage")},get DC(){return(0,n.A)("dc")},get Rack(){return(0,n.A)("rack")},get Missing(){return(0,n.A)("missing")},get Uptime(){return(0,n.A)("uptime")},get Version(){return(0,n.A)("version")},get SystemState(){return(0,n.A)("system-state")},get ConnectStatus(){return(0,n.A)("connect-status")},get NetworkUtilization(){return(0,n.A)("network-utilization")},get ClockSkew(){return(0,n.A)("clock-skew")},get PingTime(){return(0,n.A)("ping-time")},get PileName(){return(0,n.A)("field_pile-name")}};function m(e){return c[e]}let p={NodeId:["NodeId"],Host:["Host","Rack","Database","SystemState"],NetworkHost:["Host","Rack","Database","SystemState","ConnectStatus"],Database:["Database"],NodeName:["NodeName"],DC:["DC"],Rack:["Rack"],Version:["Version"],Uptime:["Uptime","DisconnectTime"],Memory:["Memory","MemoryDetailed"],RAM:["Memory"],Pools:["CPU"],CPU:["CPU"],LoadAverage:["LoadAverage"],Load:["LoadAverage"],DiskSpaceUsage:["DiskSpaceUsage"],TotalSessions:["SystemState"],Connections:["Connections"],NetworkUtilization:["NetworkUtilization"],SendThroughput:["SendThroughput"],ReceiveThroughput:["ReceiveThroughput"],PingTime:["PingTime"],ClockSkew:["ClockSkew"],Missing:["Missing"],Tablets:["Tablets","Database"],PDisks:["PDisks"],PileName:["PileName"]},h={NodeId:"NodeId",Host:"Host",NetworkHost:"Host",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"Memory",CPU:"CPU",Pools:"CPU",LoadAverage:"LoadAverage",Load:"LoadAverage",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:void 0,Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:void 0,PDisks:void 0,PileName:void 0};function g(e){return h[e]}function f(e){return!!h[e]}},47456:function(e,t,r){r.d(t,{A:()=>s});var n=r(51432),a=JSON.parse('{"node-id":"Node ID","host":"Host","database":"Database","node-name":"Node Name","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Detailed Memory","ram":"RAM","cpu":"CPU","pools":"Pools","disk-usage":"Disk Usage","tablets":"Tablets","load-average":"Load Average","load":"Load","sessions":"Sessions","missing":"Missing","pdisks":"PDisks","field_memory-used":"Memory used","field_memory-limit":"Memory limit","field_pile-name":"Pile Name","system-state":"System State","connect-status":"Connect Status","utilization":"Utilization","network-utilization":"Network Utilization","connections":"Connections","clock-skew":"Clock Skew","skew":"Skew","ping-time":"Ping Time","ping":"Ping","send":"Send","receive":"Receive","max":"Max","min":"Min","avg":"Avg","sum":"Sum"}');let s=(0,n.g4)("ydb-nodes-columns",{en:a})},18046:function(e,t,r){r.d(t,{E:()=>f});var n=r(74848),a=r(96540),s=r(2543),i=r(50504),l=r(15474),o=r(15749),d=r(78331),u=r(80184),c=r(8946),m=r(25247),p=r(37296),h=r(96099);let g=(0,m.cn)("pdisk-storage"),f=({data:e={},vDisks:t,showPopup:r,onShowPopup:m,onHidePopup:f,className:v,progressBarClassName:k,viewContext:N,width:x,delayOpen:S=p.s,delayClose:b=p.s,withIcon:y})=>{let D,{NodeId:w,PDiskId:I}=e,j=!(0,s.isNil)(w)&&!(0,s.isNil)(I),P=a.useRef(null);return j&&(D=(0,c.Ck)(I,w)),(0,n.jsxs)("div",{className:g(null,v),ref:P,style:{width:x},children:[t?.length?(0,n.jsx)("div",{className:g("vdisks"),children:t.map(e=>(0,n.jsx)("div",{className:g("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,n.jsx)(u.y,{withIcon:y,data:e,inactive:!(0,h.OH)(e,N),compact:!0,delayOpen:S,delayClose:b})},e.StringifiedId))}):null,(0,n.jsx)(l.P,{showPopup:r,offset:{mainAxis:2,crossAxis:0},anchorRef:P,onShowPopup:m,onHidePopup:f,renderPopupContent:()=>(0,n.jsx)(d.Oy,{data:e}),delayOpen:S,delayClose:b,children:(0,n.jsx)(o.E,{to:D,className:g("content"),children:(0,n.jsx)(i.V,{withIcon:y,diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,className:k})})})]})}},20687:function(e,t,r){r.d(t,{z:()=>eA});var n=r(74848),a=r(88831),s=r(96540),i=r(42724),l=r(1459),o=r(22708),d=r(2837),u=r(4283),c=r(14476);let m=c.z.nativeEnum(u.r).catch(u.r.all),p=c.z.nativeEnum(u.G).catch(u.G.groups);var h=r(81882),g=r(65101),f=r(38512),v=r(87669);let k=["NodeId","Host","Uptime","CPU","RAM","PDisks"],N=["NodeId"],x=["Host","DC","Rack","Version","Uptime","Missing","DiskSpaceUsage"],S=x.map(e=>({value:e,content:(0,v.kn)(e)})),b=c.z.custom(e=>x.includes(e)).catch(void 0),y={groups:"groupsSearch",nodes:"nodesSearch"};function D(){let[e,t]=(0,o.useQueryParams)({type:o.StringParam,visible:o.StringParam,groupsSearch:o.StringParam,nodesSearch:o.StringParam,search:o.StringParam,uptimeFilter:o.StringParam,storageNodesGroupBy:o.StringParam,storageGroupsGroupBy:o.StringParam}),[r,n]=(0,h.iK)(d.GS.STORAGE_TYPE,u.G.groups),a=p.parse(e.type),i=m.parse(e.visible),l=e.groupsSearch??"",c=e.nodesSearch??"",v=g.Bm.parse(e.uptimeFilter),k=f.kY.parse(e.storageGroupsGroupBy),N=b.parse(e.storageNodesGroupBy);s.useEffect(()=>{if(e.search){let r={search:void 0};r[y[a]]=e.search,t(r,"replaceIn")}},[e.search,a,t]);let x=e=>{t({visible:e},"replaceIn")},S=s.useCallback(e=>{t({type:e},"replaceIn"),n(e)},[t,n]),D=e=>{t({uptimeFilter:e},"replaceIn")};return{storageType:a,visibleEntities:i,groupsSearchValue:l,nodesSearchValue:c,nodesUptimeFilter:v,storageGroupsGroupByParam:k,storageNodesGroupByParam:N,handleTextFilterGroupsChange:e=>{t({groupsSearch:e||void 0},"replaceIn")},handleTextFilterNodesChange:e=>{t({nodesSearch:e||void 0},"replaceIn")},handleVisibleEntitiesChange:x,handleStorageTypeChange:S,handleUptimeFilterChange:D,handleStorageGroupsGroupByParamChange:e=>{t({storageGroupsGroupBy:e},"replaceIn")},handleStorageNodesGroupByParamChange:e=>{t({storageNodesGroupBy:e},"replaceIn")},handleShowAllGroups:()=>{x("all")},handleShowAllNodes:()=>{x("all"),D("All")}}}var w=r(73232),I=r(41254),j=r(31596),P=r(65615),C=r(282),A=r(74104),E=r(78799),T=r(49745);let M=({visibleEntities:e,onShowAll:t})=>{let r;return(e===u.r.space&&(r=(0,T.A)("empty.out_of_space")),e===u.r.missing&&(r=(0,T.A)("empty.degraded")),r)?(0,n.jsx)(E.U,{title:r,showAll:(0,T.A)("show_all"),onShowAll:t}):null};var U=r(2230),R=r(33583),L=r(36712);let G=({columns:e,database:t,nodeId:r,groupId:a,pDiskId:o,filterGroup:d,filterGroupBy:c,searchValue:m,visibleEntities:p,onShowAll:h,scrollContainerRef:g,renderErrorMessage:v,initialEntitiesCount:k})=>{var N;let x=(0,l.Pm)(),S=(N=(0,l.YA)(),s.useCallback(async e=>{let{limit:t,offset:r,sortParams:n,filters:a,columnsIds:s}=e,{sortOrder:i,columnId:l}=n??{},{searchValue:o,visibleEntities:d,database:u,nodeId:c,groupId:m,pDiskId:p,filterGroup:h,filterGroupBy:g}=a??{},v=(0,f.GP)(l),k=v?(0,R.T)(v,i):void 0,x=(0,L.R)(s,f.YX),{groups:S,found:b,total:y}=await (0,U.t)({limit:t,offset:r,sort:k,filter:o,with:d,database:u,nodeId:c,groupId:m,pDiskId:p,filter_group:h,filter_group_by:g,fieldsRequired:x,shouldUseGroupsHandler:N});return{data:S||[],found:b||0,total:y||0}},[N])),b=s.useMemo(()=>({searchValue:m,visibleEntities:p,database:t,nodeId:r,groupId:a,pDiskId:o,filterGroup:d,filterGroupBy:c}),[m,p,t,r,a,o,d,c]);return(0,n.jsx)(i.r,{loading:!x,children:(0,n.jsx)(A.k5,{columnsWidthLSKey:f.qK,scrollContainerRef:g,columns:e,fetchData:S,initialEntitiesCount:k,renderErrorMessage:v,renderEmptyDataMessage:()=>p!==u.r.all?(0,n.jsx)(M,{onShowAll:h,visibleEntities:p}):(0,T.A)("empty.default"),filters:b,tableName:A.qr.STORAGE_GROUPS})})};var _=r(33702),O=r(13195);function W({visibleEntities:e,viewContext:t}){let r=(0,a.X)(),n=(0,a.b)(),i=(0,l.Z9)(),o=s.useMemo(()=>{let e=(0,O.J)({viewContext:t}),a=i?e:e.filter(e=>e.name!==f.UW.PileName);if(r)return a;let s=a.filter(e=>!(0,f.Ai)(e.name));return n?s:s.filter(e=>!(0,f.RY)(e.name))},[r,t,n,i]),d=s.useMemo(()=>e===u.r.missing?[...f.LO,f.UW.Degraded]:e===u.r.space?[...f.LO,f.UW.DiskSpace]:f.LO,[e]),c=s.useMemo(()=>i?f.hu.includes(f.UW.PileName)?f.hu:[...f.hu,f.UW.PileName]:f.hu,[i]);return(0,_.K)(o,f.zY,f.H6,c,d)}var z=r(51670),V=r(4627),H=r(51432),F=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN","controls_group-by-placeholder":"Group by:","no-nodes":"No such nodes","no-groups":"No such groups"}');let B=(0,H.g4)("ydb-storage",{en:F});var $=r(37296),Y=r(77269),J=r(43834),q=r(53211),K=r(12623),Q=r(29472),X=r(81392);let Z={[u.G.groups]:"Groups",[u.G.nodes]:"Nodes"},ee=({value:e,onChange:t})=>(0,n.jsxs)(X.x,{value:e,onUpdate:t,qa:"storage-type-filter",children:[(0,n.jsx)(X.x.Option,{value:u.G.groups,children:Z[u.G.groups]}),(0,n.jsx)(X.x.Option,{value:u.G.nodes,children:Z[u.G.nodes]})]}),et={[u.r.all]:"All",[u.r.missing]:"Degraded",[u.r.space]:"Out of Space"},er=({value:e,onChange:t})=>(0,n.jsxs)(X.x,{value:e,onUpdate:t,qa:"storage-visible-entities-filter",children:[(0,n.jsx)(X.x.Option,{value:u.r.missing,children:et[u.r.missing]}),(0,n.jsx)(X.x.Option,{value:u.r.space,children:et[u.r.space]}),(0,n.jsx)(X.x.Option,{value:u.r.all,children:et[u.r.all]})]});function en({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:r,entitiesCountTotal:i,entitiesLoading:o}){let{groupsSearchValue:d,storageType:u,visibleEntities:c,storageGroupsGroupByParam:m,handleTextFilterGroupsChange:p,handleStorageTypeChange:h,handleVisibleEntitiesChange:g,handleStorageGroupsGroupByParamChange:v}=D(),k=(0,a.X)(),N=(0,l.Z9)(),x=s.useMemo(()=>N?f.SE:f.SE.filter(e=>"PileName"!==e.value),[N]);return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)(Q.v,{value:d,onChange:p,placeholder:B("controls_groups-search-placeholder"),className:(0,$.b)("search")}),e&&k&&(0,n.jsx)(ee,{value:u,onChange:h}),t?null:(0,n.jsx)(er,{value:c,onChange:g}),t?(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)(Y.E,{variant:"body-2",children:B("controls_group-by-placeholder")}),(0,n.jsx)(J.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:m?[m]:void 0,onUpdate:e=>{v(e[0])},options:x})]}):null,(0,n.jsx)(q.T,{label:B("groups"),loading:o,total:i,current:r})]})}function ea({withTypeSelector:e,withGroupBySelect:t}){let{tableState:r}=(0,K.WV)();return(0,n.jsx)(en,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:r.foundEntities,entitiesCountTotal:r.totalEntities,entitiesLoading:r.isInitialLoad})}let es=s.memo(function({name:e,count:t,isExpanded:r,database:a,nodeId:s,groupId:i,pDiskId:l,searchValue:o,scrollContainerRef:d,filterGroupBy:u,columns:c,onIsExpandedChange:m,handleShowAllGroups:p}){return(0,n.jsx)(z.Q,{title:e,count:t,entityName:B("groups"),expanded:r,onIsExpandedChange:m,children:(0,n.jsx)(I.o,{initialState:{sortParams:void 0},table:(0,n.jsx)(G,{database:a,scrollContainerRef:d,nodeId:s,groupId:i,pDiskId:l,filterGroup:e,filterGroupBy:u,searchValue:o,visibleEntities:"all",onShowAll:p,renderErrorMessage:C.$,columns:c,initialEntitiesCount:t}),tableWrapperProps:{scrollContainerRef:d}})},e)});function ei({database:e,nodeId:t,groupId:r,pDiskId:a,scrollContainerRef:i,viewContext:l}){let[o]=(0,h.Nt)(),{groupsSearchValue:d,storageGroupsGroupByParam:u,visibleEntities:c,handleShowAllGroups:m}=D(),{columnsToShow:p,columnsToSelect:g,setColumns:f}=W({visibleEntities:c,viewContext:l}),{currentData:v,isFetching:k,error:N}=P.S.useGetStorageGroupsInfoQuery({database:e,with:"all",nodeId:t,groupId:r,pDiskId:a,filter:d,shouldUseGroupsHandler:!0,group:u},{pollingInterval:o}),x=void 0===v&&k,{tableGroups:S,found:b=0,total:y=0}=v||{},{expandedGroups:C,setIsGroupExpanded:A}=(0,V.$)(S),E=s.useMemo(()=>({foundEntities:b,totalEntities:y,isInitialLoad:x,sortParams:void 0}),[b,y,x]);return(0,n.jsx)(I.o,{controls:(0,n.jsx)(en,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:b,entitiesCountTotal:y,entitiesLoading:x}),extraControls:(0,n.jsx)(j.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:f}),error:N?(0,n.jsx)(w.o,{error:N}):null,table:S?.length?S.map(({name:s,count:l})=>{let o=C[s];return(0,n.jsx)(es,{name:s,count:l,isExpanded:o,database:e,nodeId:t,groupId:r,pDiskId:a,filterGroupBy:u,searchValue:d,visibleEntities:"all",scrollContainerRef:i,onIsExpandedChange:A,handleShowAllGroups:m,columns:p},s)}):B("no-groups"),initialState:E,tableWrapperProps:{scrollContainerRef:i,scrollDependencies:[d,u,S],loading:x,className:(0,$.b)("groups-wrapper")}})}function el({database:e,nodeId:t,groupId:r,pDiskId:a,viewContext:s,scrollContainerRef:i,initialEntitiesCount:o}){let{groupsSearchValue:d,visibleEntities:u,handleShowAllGroups:c}=D(),m=(0,l.SA)(),{columnsToShow:p,columnsToSelect:h,setColumns:g}=W({visibleEntities:u,viewContext:s});return(0,n.jsx)(I.o,{controls:(0,n.jsx)(ea,{withTypeSelector:!0,withGroupBySelect:m}),extraControls:(0,n.jsx)(j.O,{popupWidth:200,items:h,showStatus:!0,onUpdate:g}),table:(0,n.jsx)(G,{database:e,nodeId:t,groupId:r,pDiskId:a,searchValue:d,visibleEntities:u,onShowAll:c,scrollContainerRef:i,renderErrorMessage:C.$,columns:p,initialEntitiesCount:o}),tableWrapperProps:{scrollContainerRef:i,scrollDependencies:[d,u]}})}function eo(e){let{storageGroupsGroupByParam:t,visibleEntities:r,handleShowAllGroups:a}=D(),o=(0,l.Pm)(),d=(0,l.SA)();return s.useEffect(()=>{d&&"all"!==r&&a()},[a,d,r]),(0,n.jsx)(i.r,{loading:!o,children:d&&t?(0,n.jsx)(ei,{...e}):(0,n.jsx)(el,{...e})})}var ed=r(67103),eu=r(25247),ec=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),em=JSON.parse('{"empty.default":"Нет узлов","empty.out_of_space":"Нет узлов, в которых кончается место","empty.degraded":"Нет деградировавших узлов","empty.small_uptime":"Нет узлов с uptime < 1h","empty.several_filters":"Нет узлов, подходящих под текущие фильтры","show_all":"Показать все узлы"}');let ep=(0,H.g4)("ydb-storage-nodes",{ru:em,en:ec}),eh=({visibleEntities:e,nodesUptimeFilter:t,onShowAll:r})=>{let a;return(e===u.r.space&&(a=ep("empty.out_of_space")),e===u.r.missing&&(a=ep("empty.degraded")),"SmallUptime"===t&&(a=ep("empty.small_uptime")),e!==u.r.all&&"All"!==t&&(a=ep("empty.several_filters")),a)?(0,n.jsx)(E.U,{title:a,showAll:ep("show_all"),onShowAll:r}):null};var eg=r(58405);let ef=async e=>{let{type:t="static",storage:r=!0,limit:n,offset:a,sortParams:s,filters:i,columnsIds:l}=e,{searchValue:o,nodesUptimeFilter:d,visibleEntities:u,database:c,nodeId:m,groupId:p,filterGroup:h,filterGroupBy:f}=i??{},{sortOrder:k,columnId:N}=s??{},x=(0,v.kU)(N),S=x?(0,R.T)(x,k):void 0,b=(0,L.R)(l,v.fN),y=await window.api.viewer.getNodes({type:t,storage:r,limit:n,offset:a,sort:S,filter:o,uptime:(0,g.Fo)(d),with:u,database:c,node_id:m,group_id:p,filter_group:h,filter_group_by:f,fieldsRequired:b}),D=(0,eg.rz)(y);return{data:D.nodes||[],found:D.found||0,total:D.total||0,columnsSettings:D.columnsSettings}},ev=(0,eu.cn)("ydb-storage-nodes"),ek=e=>ev("node",{unavailable:(0,g.X7)(e)}),eN=({columns:e,database:t,nodeId:r,groupId:a,filterGroup:i,filterGroupBy:l,searchValue:o,visibleEntities:d,nodesUptimeFilter:c,onShowAll:m,scrollContainerRef:p,renderErrorMessage:h,initialEntitiesCount:g,onDataFetched:f})=>{let v=s.useMemo(()=>({searchValue:o,visibleEntities:d,nodesUptimeFilter:c,database:t,nodeId:r,groupId:a,filterGroup:i,filterGroupBy:l}),[o,d,c,t,r,a,i,l]);return(0,n.jsx)(A.k5,{columnsWidthLSKey:"storageNodesColumnsWidth",scrollContainerRef:p,columns:e,fetchData:ef,rowHeight:51,initialEntitiesCount:g,renderErrorMessage:h,renderEmptyDataMessage:()=>d!==u.r.all||"All"!==c?(0,n.jsx)(eh,{onShowAll:m,nodesUptimeFilter:c,visibleEntities:d}):ep("empty.default"),getRowClassName:ek,filters:v,tableName:A.qr.STORAGE_NODES,onDataFetched:f})};var ex=r(96099),eS=r(92961);function eb({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:r,entitiesCountTotal:a,entitiesLoading:i}){let{nodesSearchValue:l,storageType:o,visibleEntities:d,nodesUptimeFilter:u,storageNodesGroupByParam:c,handleTextFilterNodesChange:m,handleStorageTypeChange:p,handleVisibleEntitiesChange:h,handleUptimeFilterChange:g,handleStorageNodesGroupByParamChange:f}=D();return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)(Q.v,{value:l,onChange:m,placeholder:B("controls_nodes-search-placeholder"),className:(0,$.b)("search")}),e&&(0,n.jsx)(ee,{value:o,onChange:p}),t?null:(0,n.jsx)(er,{value:d,onChange:h}),t?null:(0,n.jsx)(eS.j,{value:u,onChange:g}),t?(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)(Y.E,{variant:"body-2",children:B("controls_group-by-placeholder")}),(0,n.jsx)(J.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:c?[c]:void 0,onUpdate:e=>{f(e[0])},options:S})]}):null,(0,n.jsx)(q.T,{label:B("nodes"),loading:i,total:a,current:r})]})}function ey({withTypeSelector:e,withGroupBySelect:t}){let{tableState:r}=(0,K.WV)();return(0,n.jsx)(eb,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:r.foundEntities,entitiesCountTotal:r.totalEntities,entitiesLoading:r.isInitialLoad})}var eD=r(96917);function ew({database:e,viewContext:t,columnsSettings:r}){let{visibleEntities:n}=D();return function({visibleEntities:e,database:t,viewContext:r,columnsSettings:n}){let a=(0,l.Z9)(),i=s.useMemo(()=>{let e=(0,eD.C)({database:t,viewContext:r,columnsSettings:n});return a?e:e.filter(e=>e.name!==v.vg.PileName)},[t,r,n,a]),o=s.useMemo(()=>e===u.r.missing?[...N,v.vg.Missing]:N,[e]),d=s.useMemo(()=>a?k.includes(v.vg.PileName)?k:[...k,v.vg.PileName]:k,[a]);return(0,_.K)(i,"storageNodesSelectedColumns",v.uG,d,o)}({visibleEntities:n,database:e,viewContext:t,columnsSettings:r})}let eI=s.memo(function({name:e,count:t,isExpanded:r,database:a,nodeId:s,groupId:i,searchValue:l,scrollContainerRef:o,filterGroupBy:d,columns:u,onIsExpandedChange:c,handleShowAllNodes:m,onDataFetched:p}){return(0,n.jsx)(z.Q,{title:e,count:t,entityName:B("nodes"),expanded:r,onIsExpandedChange:c,children:(0,n.jsx)(I.o,{initialState:{sortParams:void 0},table:(0,n.jsx)(eN,{database:a,scrollContainerRef:o,nodeId:s,groupId:i,filterGroup:e,filterGroupBy:d,searchValue:l,visibleEntities:"all",nodesUptimeFilter:"All",onShowAll:m,renderErrorMessage:C.$,columns:u,initialEntitiesCount:t,onDataFetched:p}),tableWrapperProps:{scrollContainerRef:o}})},e)});function ej({database:e,groupId:t,nodeId:r,viewContext:a,scrollContainerRef:i}){let[l]=(0,h.Nt)(),{nodesSearchValue:o,storageNodesGroupByParam:d,handleShowAllNodes:u}=D(),{handleDataFetched:c,columnsSettings:m}=(0,ex.fj)(),{columnsToShow:p,columnsToSelect:g,setColumns:f}=ew({database:e,viewContext:a,columnsSettings:m}),{currentData:v,isFetching:k,error:N}=P.S.useGetStorageNodesInfoQuery({database:e,with:"all",filter:o,node_id:r,group_id:t,group:d},{pollingInterval:l}),x=void 0===v&&k,{tableGroups:S,found:b=0,total:y=0}=v||{},{expandedGroups:w,setIsGroupExpanded:C}=(0,V.$)(S),A=s.useMemo(()=>({foundEntities:b,totalEntities:y,isInitialLoad:x,sortParams:void 0}),[b,y,x]);return(0,n.jsx)(I.o,{controls:(0,n.jsx)(eb,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:b,entitiesCountTotal:y,entitiesLoading:x}),extraControls:(0,n.jsx)(j.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:f}),error:N?(0,n.jsx)(ed.o,{error:N}):null,table:S?.length?S.map(({name:a,count:s})=>{let l=w[a];return(0,n.jsx)(eI,{name:a,count:s,isExpanded:l,database:e,nodeId:r,groupId:t,searchValue:o,visibleEntities:"all",filterGroupBy:d,scrollContainerRef:i,onIsExpandedChange:C,handleShowAllNodes:u,columns:p,onDataFetched:c},a)}):B("no-nodes"),initialState:A,tableWrapperProps:{scrollContainerRef:i,scrollDependencies:[o,d,S],loading:x,className:(0,$.b)("groups-wrapper")}})}function eP({database:e,nodeId:t,groupId:r,viewContext:a,scrollContainerRef:s,initialEntitiesCount:i}){let{nodesSearchValue:o,visibleEntities:d,nodesUptimeFilter:u,handleShowAllNodes:c}=D(),m=(0,l.Ye)(),{handleDataFetched:p,columnsSettings:h}=(0,ex.fj)(),{columnsToShow:g,columnsToSelect:f,setColumns:v}=ew({database:e,viewContext:a,columnsSettings:h});return(0,n.jsx)(I.o,{controls:(0,n.jsx)(ey,{withTypeSelector:!0,withGroupBySelect:m}),extraControls:(0,n.jsx)(j.O,{popupWidth:200,items:f,showStatus:!0,onUpdate:v}),table:(0,n.jsx)(eN,{database:e,nodeId:t,groupId:r,searchValue:o,visibleEntities:d,nodesUptimeFilter:u,onShowAll:c,scrollContainerRef:s,renderErrorMessage:C.$,columns:g,initialEntitiesCount:i,onDataFetched:p}),tableWrapperProps:{scrollContainerRef:s,scrollDependencies:[o,d,u]}})}function eC(e){let{storageNodesGroupByParam:t,visibleEntities:r,nodesUptimeFilter:a,handleShowAllNodes:o}=D(),d=(0,l.Pm)(),u=(0,l.Ye)();return s.useEffect(()=>{u&&("all"!==r||"All"!==a)&&o()},[o,a,u,r]),(0,n.jsx)(i.r,{loading:!d,children:u&&t?(0,n.jsx)(ej,{...e}):(0,n.jsx)(eP,{...e})})}let eA=e=>{let{storageType:t}=D();!function(){let[e,t]=(0,o.useQueryParam)("type",o.StringParam),[r]=(0,h.iK)(d.GS.STORAGE_TYPE,u.G.groups),n=s.useMemo(()=>p.parse(e??r),[e,r]);s.useEffect(()=>{n!==e&&t(n)},[n,e,t])}();let r=(0,a.X)();return"nodes"===t&&r?(0,n.jsx)(eC,{initialEntitiesCount:(0,ex.b0)(e.viewContext),...e}):(0,n.jsx)(eo,{initialEntitiesCount:(0,ex.QQ)(e.viewContext),...e})}},13195:function(e,t,r){r.d(t,{k:()=>en,J:()=>ea});var n=r(74848),a=r(82687),s=r(29581),i=r(85169),l=r(5434),o=r(29901),d=r(17427),u=r(2543),c=r(5948),m=r(93397),p=r(17989),h=r(79092),g=r(8946),f=r(25247),v=r(35537),k=r(97855),N=r(14016),x=r(51630),S=r(28241),b=r(96540),y=r(70900),D=r(80184),w=r(18046),I=r(37296),j=r(96099);let P=(0,f.cn)("ydb-storage-disks");function C({vDisks:e=[],viewContext:t,erasure:r,withIcon:a}){let[s,l]=b.useState(),o=(0,j.Ep)(e,r),{theme:{spaceBaseSize:d}}=(0,y.L)();if(!e.length)return null;let u=(300-d*(e.length-1))/e.length;return(0,n.jsxs)("div",{className:P(null),children:[(0,n.jsx)(i.s,{direction:"row",gap:1,grow:!0,style:{width:300},children:e?.map((e,r)=>(0,n.jsx)(A,{vDisk:e,inactive:!(0,j.OH)(e,t),highlightedVDisk:s,setHighlightedVDisk:l,unavailableVDiskWidth:u,withIcon:a},e.StringifiedId||r))}),(0,n.jsx)("div",{className:P("pdisks-wrapper"),children:e?.map((e,t)=>(0,n.jsx)(E,{vDisk:e,highlightedVDisk:s,setHighlightedVDisk:l,withDCMargin:o.includes(t),withIcon:a},e?.PDisk?.StringifiedId||t))})]})}function A({vDisk:e,highlightedVDisk:t,inactive:r,setHighlightedVDisk:a,unavailableVDiskWidth:s,withIcon:i}){let l={...e,PDisk:void 0},o=e.StringifiedId,d=(0,S.kf)(l.AllocatedSize)?void 0:s,u=Number(l.AllocatedSize)||1;return(0,n.jsx)("div",{style:{flexGrow:u,minWidth:d},className:P("vdisk-item"),children:(0,n.jsx)(D.y,{data:l,compact:!0,withIcon:i,inactive:r,showPopup:t===o,delayOpen:I.s,delayClose:I.s,onShowPopup:()=>a(o),onHidePopup:()=>a(void 0),progressBarClassName:P("vdisk-progress-bar")})})}function E({vDisk:e,highlightedVDisk:t,setHighlightedVDisk:r,withDCMargin:a,withIcon:s}){let i=e.StringifiedId;return e.PDisk?(0,n.jsx)(w.E,{className:P("pdisk-item",{"with-dc-margin":a}),progressBarClassName:P("pdisk-progress-bar"),data:e.PDisk,showPopup:t===i,delayOpen:I.s,delayClose:I.s,onShowPopup:()=>r(i),onHidePopup:()=>r(void 0),withIcon:s}):null}var T=r(7360);let M=(0,f.cn)("stack"),U=({children:e,className:t})=>(0,n.jsx)("div",{className:M(null,t),children:b.Children.map(e,(e,t)=>b.isValidElement(e)?(0,n.jsx)("div",{className:M("layer"),style:{"--ydb-stack-level":t},children:e}):null)});function R({data:e,className:t,stackClassName:r,withIcon:a,...s}){let{Donors:i,...l}=e||{},o=i&&i.length>0?(0,n.jsxs)(U,{className:r,children:[(0,n.jsx)(D.y,{data:l,withIcon:a,...s}),i.map(e=>{let t=(0,T.NJ)(e);return(0,n.jsx)(D.y,{data:e,withIcon:a,...s},(0,k.U9)(t?e.VDiskId:e))})]}):(0,n.jsx)(D.y,{withIcon:a,data:e,...s});return(0,n.jsx)("div",{className:t,children:o})}let L=(0,f.cn)("ydb-storage-vdisks");function G({vDisks:e,viewContext:t,erasure:r,withIcon:a}){let s=(0,j.Ep)(e,r);return(0,n.jsx)("div",{className:L("wrapper"),children:e?.map((e,r)=>(0,n.jsx)(R,{withIcon:a,data:e,inactive:!(0,j.OH)(e,t),delayOpen:I.s,delayClose:I.s,className:L("item",{"with-dc-margin":s.includes(r)})},e.StringifiedId))})}var _=r(49745),O=r(38512);let W=(0,f.cn)("ydb-storage-groups-columns"),z={name:O.UW.PoolName,header:O.H6.PoolName,width:250,render:({row:e})=>e.PoolName?(0,n.jsx)(c.s,{content:e.PoolName,placement:["right"],openDelay:0,className:W("pool-name-wrapper"),children:(0,n.jsx)("span",{className:W("pool-name"),children:e.PoolName})}):v.Pd,align:s.Ay.LEFT},V={name:O.UW.PileName,header:O.H6.PileName,width:120,render:({row:e})=>e.PileName||v.Pd,align:s.Ay.LEFT},H={name:O.UW.MediaType,header:O.H6.MediaType,width:100,resizeMinWidth:100,align:s.Ay.LEFT,render:({row:e})=>(0,n.jsxs)(i.s,{children:[(0,n.jsx)(l.J,{children:e.MediaType||v.Pd}),"\xa0",e.Encryption&&(0,n.jsx)(o.A,{content:(0,_.A)("encrypted"),placement:"right",className:v.zQ,children:(0,n.jsx)(l.J,{children:(0,n.jsx)(d.I,{data:a.A,size:18})})})]}),sortable:!1},F={name:O.UW.Erasure,header:O.H6.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:({row:e})=>e.ErasureSpecies?e.ErasureSpecies:"-",align:s.Ay.LEFT},B={name:O.UW.Degraded,header:O.H6.Degraded,width:110,resizeMinWidth:110,render:({row:e})=>e.Degraded?(0,n.jsxs)(l.J,{theme:(0,j.k_)(e),children:["Degraded: ",e.Degraded]}):"-",align:s.Ay.LEFT,defaultOrder:s.Ay.DESCENDING},$={name:O.UW.State,header:O.H6.State,width:150,render:({row:e})=>e.State??v.Pd,align:s.Ay.LEFT,defaultOrder:s.Ay.DESCENDING},Y={name:O.UW.Usage,header:O.H6.Usage,width:85,resizeMinWidth:75,render:({row:e})=>(0,u.isNil)(e.Usage)?v.Pd:(0,n.jsx)(h.U,{value:Math.floor(e.Usage),theme:(0,N.f)(e.Usage)}),align:s.Ay.LEFT},J={name:O.UW.DiskSpaceUsage,header:O.H6.DiskSpaceUsage,width:115,resizeMinWidth:75,render:({row:e})=>(0,u.isNil)(e.DiskSpaceUsage)?v.Pd:(0,n.jsx)(h.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,N.f)(e.DiskSpaceUsage)}),align:s.Ay.LEFT},q={name:O.UW.GroupId,header:O.H6.GroupId,width:140,render:({row:e})=>e.GroupId?(0,n.jsx)(es,{id:e.GroupId}):"-",sortAccessor:e=>Number(e.GroupId),align:s.Ay.LEFT},K={name:O.UW.Used,header:O.H6.Used,width:100,render:({row:e})=>(0,S.wb)(e.Used,!0),align:s.Ay.RIGHT},Q={name:O.UW.Limit,header:O.H6.Limit,width:100,render:({row:e})=>(0,S.wb)(e.Limit),align:s.Ay.RIGHT},X={name:O.UW.DiskSpace,header:O.H6.DiskSpace,width:70,render:({row:e})=>(0,n.jsx)(p.k,{status:e.DiskSpace}),align:s.Ay.CENTER},Z={name:O.UW.Read,header:O.H6.Read,width:100,render:({row:e})=>e.Read?(0,S.O4)(e.Read):"-",align:s.Ay.RIGHT},ee={name:O.UW.Write,header:O.H6.Write,width:100,render:({row:e})=>e.Write?(0,S.O4)(e.Write):"-",align:s.Ay.RIGHT},et={name:O.UW.Latency,header:O.H6.Latency,width:100,render:({row:e})=>(0,u.isNil)(e.LatencyPutTabletLogMs)?v.Pd:(0,x.Xo)(e.LatencyPutTabletLogMs),align:s.Ay.RIGHT},er={name:O.UW.AllocationUnits,header:O.H6.AllocationUnits,width:150,render:({row:e})=>(0,u.isNil)(e.AllocationUnits)?v.Pd:(0,k.ZV)(e.AllocationUnits),align:s.Ay.RIGHT},en=()=>[q,H,F,Y,K,Q],ea=e=>[q,z,V,H,F,B,$,Y,J,K,Q,X,Z,ee,et,er,{name:O.UW.VDisks,header:O.H6.VDisks,className:W("vdisks-column"),render:({row:t})=>(0,n.jsx)(G,{vDisks:t.VDisks,viewContext:e?.viewContext,erasure:t.ErasureSpecies,withIcon:!0}),align:s.Ay.CENTER,width:780,resizeable:!1,sortable:!1},{name:O.UW.VDisksPDisks,header:O.H6.VDisksPDisks,className:W("disks-column"),render:({row:t})=>(0,n.jsx)(C,{vDisks:t.VDisks,viewContext:e?.viewContext,erasure:t.ErasureSpecies,withIcon:!0}),align:s.Ay.CENTER,width:900,resizeable:!1,sortable:!1}].map(e=>({...e,sortable:(0,O.i4)(e.name)}));function es({id:e}){let t=(0,g.zO)();return(0,n.jsx)(m.c,{name:String(e),path:t(e),hasClipboardButton:!0,showStatus:!1})}},38512:function(e,t,r){r.d(t,{YX:()=>S,Ai:()=>c,UW:()=>d,i4:()=>D,qK:()=>l,SE:()=>N,hu:()=>m,LO:()=>g,H6:()=>f,zY:()=>o,GP:()=>y,RY:()=>h,kY:()=>x});var n=r(14476),a=r(51432),s=JSON.parse('{"pool-name":"Pool Name","pile-name":"Pile Name","type":"Type","encryption":"Encryption","erasure":"Erasure","degraded":"Degraded","missing-disks":"Missing Disks","state":"State","usage":"Usage","disk-usage":"Disk usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","latency":"Latency","allocation-units":"Allocation Units","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}');let i=(0,a.g4)("ydb-storage-groups-columns",{en:s}),l="storageGroupsColumnsWidth",o="storageGroupsSelectedColumns",d={GroupId:"GroupId",PoolName:"PoolName",PileName:"PileName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",Degraded:"Degraded",State:"State"},u=["DiskSpaceUsage","Latency","AllocationUnits","VDisksPDisks"];function c(e){return u.includes(e)}let m=["GroupId","PoolName","Erasure","Used","VDisks"],p=["DiskSpace"];function h(e){return p.some(t=>t===e)}let g=["GroupId"],f={get PoolName(){return i("pool-name")},get MediaType(){return i("type")},get PileName(){return i("pile-name")},get Erasure(){return i("erasure")},get GroupId(){return i("group-id")},get Used(){return i("used")},get Limit(){return i("limit")},get Usage(){return i("usage")},get DiskSpaceUsage(){return i("disk-usage")},get DiskSpace(){return i("space")},get Read(){return i("read")},get Write(){return i("write")},get Latency(){return i("latency")},get AllocationUnits(){return i("allocation-units")},get VDisks(){return i("vdisks")},get VDisksPDisks(){return i("vdisks-pdisks")},get Degraded(){return i("missing-disks")},get State(){return i("state")}},v={get GroupId(){return i("group-id")},get Erasure(){return i("erasure")},get Usage(){return i("usage")},get DiskSpaceUsage(){return i("disk-usage")},get PoolName(){return i("pool-name")},get PileName(){return i("pile-name")},get Kind(){return i("type")},get Encryption(){return i("encryption")},get MediaType(){return i("type")},get MissingDisks(){return i("missing-disks")},get State(){return i("state")},get Latency(){return i("latency")}},k=["PoolName","PileName","MediaType","Encryption","Erasure","Usage","DiskSpaceUsage","State","MissingDisks","Latency"],N=k.map(e=>({value:e,content:v[e]})),x=n.z.custom(e=>k.includes(e)).catch(void 0),S={GroupId:["GroupId"],PoolName:["PoolName"],PileName:["PileName"],MediaType:["MediaType","Encryption"],Erasure:["Erasure"],Used:["Used"],Limit:["Limit"],Usage:["Usage"],DiskSpaceUsage:["DiskSpaceUsage"],DiskSpace:["State"],Read:["Read"],Write:["Write"],Latency:["Latency"],AllocationUnits:["AllocationUnits"],VDisks:["VDisk","PDisk","Read","Write"],VDisksPDisks:["VDisk","PDisk","Read","Write"],Degraded:["MissingDisks"],State:["State"]},b={GroupId:"GroupId",PoolName:"PoolName",PileName:void 0,MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:void 0,Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:void 0,VDisksPDisks:void 0,Degraded:"Degraded",State:"State"};function y(e){return b[e]}function D(e){return!!b[e]}},49745:function(e,t,r){r.d(t,{A:()=>i});var n=r(51432),a=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),s=JSON.parse('{"empty.default":"Нет групп","empty.out_of_space":"Нет групп, в которых кончается место","empty.degraded":"Нет деградировавших групп","show_all":"Показать все группы","encrypted":"Зашифрованная группа"}');let i=(0,n.g4)("ydb-storage-groups",{ru:s,en:a})},96917:function(e,t,r){r.d(t,{t:()=>u,C:()=>c});var n=r(74848),a=r(29581),s=r(65943),i=r(87669),l=r(25247),o=r(18046);let d=(0,l.cn)("ydb-storage-nodes-columns"),u=({viewContext:e,columnsSettings:t})=>({name:i.vg.PDisks,header:i.uG.PDisks,className:d("pdisks-column"),width:t?.pDiskContainerWidth,render:({row:r})=>(0,n.jsx)("div",{className:d("pdisks-wrapper"),children:r.PDisks?.map(a=>{let s=r.VDisks?.filter(e=>e.PDiskId===a.PDiskId);return(0,n.jsx)("div",{className:d("pdisks-item"),children:(0,n.jsx)(o.E,{data:a,vDisks:s,viewContext:e,width:t?.pDiskWidth})},a.PDiskId)})}),align:a.Ay.CENTER,sortable:!1,resizeable:!1}),c=({database:e,viewContext:t,columnsSettings:r})=>[(0,s._E)(),(0,s.Nh)({database:e}),(0,s.eT)(),(0,s.uk)(),(0,s.OV)(),(0,s.OX)(),(0,s.jl)(),(0,s.fr)(),(0,s.kv)(),(0,s.pH)(),(0,s.iX)(),(0,s.Bg)(),(0,s.Rn)(),(0,s.Vz)(),u({viewContext:t,columnsSettings:r}),(0,s.qp)({database:e})].map(e=>({...e,sortable:(0,i.sp)(e.name)}))},51670:function(e,t,r){r.d(t,{Q:()=>o});var n=r(74848);r(96540);var a=r(94866),s=r(77269),i=r(5434);let l=(0,r(25247).cn)("ydb-table-group"),o=({children:e,title:t,entityName:r,count:o,expanded:d=!1,onIsExpandedChange:u})=>(0,n.jsxs)("div",{className:l(null),children:[(0,n.jsx)("button",{onClick:()=>{u(t,!d)},className:l("button"),title:t,children:(0,n.jsxs)("div",{className:l("title-wrapper"),children:[(0,n.jsx)(a.I,{direction:d?"top":"bottom"}),(0,n.jsxs)("div",{className:l("title"),children:[(0,n.jsx)(s.E,{variant:"subheader-2",children:t}),(0,n.jsxs)(s.E,{variant:"body-2",color:"secondary",className:l("count"),children:[r,": ",(0,n.jsx)(i.J,{theme:"normal",children:o})]})]})]})}),d?(0,n.jsx)("div",{className:l("content"),children:e}):null]});o.displayName="TableGroup"},4627:function(e,t,r){r.d(t,{$:()=>a});var n=r(96540);function a(e){let[t,r]=n.useState({});return n.useEffect(()=>{e?.length&&r(t=>e.reduce((e,{name:r})=>{let n=t[r];return{...e,[r]:n??!1}},{}))},[e]),{expandedGroups:t,setIsGroupExpanded:n.useCallback((e,t)=>{r(r=>({...r,[e]:t}))},[])}}},37296:function(e,t,r){r.d(t,{b:()=>n,s:()=>a});let n=(0,r(25247).cn)("global-storage"),a=200},96099:function(e,t,r){r.d(t,{k_:()=>m,QQ:()=>g,b0:()=>h,OH:()=>p,fj:()=>d,Ep:()=>f});var n=r(96540),a=r(56321),s=r(33172),i=r(14016),l=r(81882),o=r(81709);function d(){let[e,t]=n.useState(void 0),[r,a]=n.useState(void 0);return{handleDataFetched:n.useCallback(r=>{if(r?.columnsSettings&&!e){let{maxSlotsPerDisk:e,maxDisksPerNode:n}=r.columnsSettings,s=e||1,i=n||1,l=Math.max(3*s+(s-1)*2,120);t(l),a(i*l+(i-1)*10+20)}},[e]),columnsSettings:n.useMemo(()=>({pDiskWidth:e||120,pDiskContainerWidth:r}),[r,e])}}let u=(0,i.H)(["success","warning","danger"],1,2),c={"block-4-2":(0,i.H)(["success","warning","danger"],1,2),"mirror-3-dc":(0,i.H)(["success","warning","danger"],1,3)},m=e=>{let t;return(void 0!==(t=e.ErasureSpecies)&&t in c?c[e.ErasureSpecies]:u)(e.Degraded)};function p(e,t){let r=!0;return(0,s.f8)(e.VDiskId?.GroupID)&&t?.groupId&&(r&&=String(e.VDiskId.GroupID)===t.groupId),(0,s.f8)(e.NodeId)&&t?.nodeId&&(r&&=String(e.NodeId)===t.nodeId),(0,s.f8)(e.PDiskId)&&t?.pDiskId&&(r&&=String(e.PDiskId)===t.pDiskId),(0,s.f8)(e.VDiskSlotId)&&t?.vDiskSlotId&&(r&&=String(e.VDiskSlotId)===t.vDiskSlotId),r}function h(e){return(0,s.f8)(e?.nodeId)||(0,s.f8)(e?.pDiskId)||(0,s.f8)(e?.vDiskSlotId)?1:10}function g(e){return(0,s.f8)(e?.groupId)||(0,s.f8)(e?.vDiskSlotId)?1:10}function f(e=[],t){let r=(0,o.J)(),s=(0,l.N4)(e=>(0,a.K)(e,r));return n.useMemo(()=>{let r=[];return"mirror-3-dc"!==t&&"mirror-3of4"!==t||e.forEach((t,n)=>{s?.get(Number(t?.NodeId))?.DC!==s?.get(Number(e[n+1]?.NodeId))?.DC&&r.push(n)}),r},[t,e,s])}},98567:function(e,t,r){r.d(t,{b:()=>function e(t={}){let{Whiteboard:r={},PDisk:d,...u}=t,c={...r,...u,VDiskId:r.VDiskId},m=function(e={}){let{Whiteboard:t,...r}=e,n={...t,...r,PDiskId:t?.PDiskId};if(void 0===n.PDiskId&&r.PDiskId){let e=Number(r.PDiskId.split("-")[1]);isNaN(e)||(n.PDiskId=e)}let s=r.PDiskId||(0,l.r$)({nodeId:n.NodeId,pDiskId:n.PDiskId}),{AllocatedPercent:d,AllocatedSize:u,AvailableSize:c,TotalSize:m}=(0,o.hK)({AvailableSize:n.AvailableSize,TotalSize:n.TotalSize}),p=r.Type?.toUpperCase()??(0,i.Y)(t?.Category),h=(0,a.d)({State:t?.State,AllocatedPercent:d}),g=r.SlotSize??t?.EnforcedDynamicSlotSize;return{...n,StringifiedId:s,AllocatedPercent:d,AllocatedSize:u,AvailableSize:c,TotalSize:m,Type:p,Severity:h,SlotSize:g}}({...d,NodeId:c.NodeId}),p=m?.PDiskId??r?.PDiskId,h=u.VDiskId??(0,n.U9)(r.VDiskId),g=(0,s.b)(c),f=(0,o.LW)({AvailableSize:c.AvailableSize,AllocatedSize:c.AllocatedSize,SlotSize:d?.SlotSize}),v=u.Donors?.map(t=>e({...t,Whiteboard:{...t.Whiteboard,DonorMode:!0}}));return{...c,...f,PDisk:m,Donors:v,PDiskId:p,StringifiedId:h,Severity:g}}});var n=r(97855),a=r(93639),s=r(16021),i=r(96360),l=r(7360),o=r(22530)},2230:function(e,t,r){r.d(t,{t:()=>a});var n=r(58405);async function a({version:e="v2",shouldUseGroupsHandler:t,...r},a){if(t&&"v1"!==e){let e=await window.api.storage.getStorageGroups({...r},a);return(0,n.Rv)(e)}{let t=await window.api.viewer.getStorageInfo({version:e,...r},a);return(0,n.Qi)(t)}}},65615:function(e,t,r){r.d(t,{S:()=>i});var n=r(56496),a=r(2230),s=r(58405);let i=n.F.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,{signal:t})=>{try{let r=await window.api.viewer.getNodes({storage:!0,type:"static",...e},{signal:t});return{data:(0,s.rz)(r)}}catch(e){return{error:e}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await (0,a.t)(e,{signal:t})}}catch(e){return{error:e}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},58405:function(e,t,r){r.d(t,{Qi:()=>g,Rv:()=>f,rz:()=>h});var n=r(2543),a=r(97855),s=r(7360),i=r(22530),l=r(65101),o=r(51630),d=r(98567);function u(e){let{DiskSpace:t,VDisks:r=[]}=e;return t||(0,s.XY)(Math.max(...r.map(e=>(0,s.H7)(e.DiskSpace))))}let c=(e,t)=>{let r=(0,i.WT)(e);return{...r,StoragePoolName:t,Donors:r?.Donors?.map(e=>({...e,StoragePoolName:t}))}},m=e=>{let{VDisks:t=[],PoolName:r,Usage:n=0,Read:a=0,Write:s=0,Used:i=0,Limit:l=0,Degraded:o=0,Kind:d,MediaType:m,GroupID:p,Overall:h,GroupGeneration:g}=e,f=t.map(e=>c(e,r)),v=100*Number(n),k=u(e);return{...e,PoolName:r,GroupId:p,MediaType:m||d,VDisks:f,Usage:v,Overall:h,GroupGeneration:g?String(g):void 0,Read:Number(a),Write:Number(s),Used:Number(i),Limit:Number(l),Degraded:Number(o),DiskSpace:k}},p=(e,t,r)=>{if(!((0,n.isNil)(e)||(0,n.isNil)(t)||(0,n.isNil)(r)))return(0,a.U9)({NodeId:e,PDiskId:t,VSlotId:r})},h=e=>{let{Nodes:t,TotalNodes:r,FoundNodes:n,NodeGroups:a,MaximumSlotsPerDisk:s,MaximumDisksPerNode:o}=e,d=a?.map(({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}}).filter(e=>!!e),u=s&&!isNaN(Number(s))?Number(s):Math.max(1,...(t||[]).flatMap(e=>{let t=e.PDisks||[],r=e.VDisks||[];return t.map(e=>r.filter(t=>t.PDiskId===e.PDiskId).length||0)})),c=o&&!isNaN(Number(o))?Number(o):Math.max(1,...(t||[]).map(e=>e.PDisks?.length||0)),m=t?.map(e=>((e,t,r)=>{let{SystemState:n,NodeId:a,PDisks:s,VDisks:o,...d}=e,u=s?.filter(e=>"Normal"!==e.State).length||0,c=s?.map(e=>({...(0,i.or)(e),NodeId:a})),m=o?.map(e=>({...(0,i.WT)(e),NodeId:a}));return{...d,...(0,l.q1)(n),NodeId:a,PDisks:c,VDisks:m,Missing:u,MaximumSlotsPerDisk:t,MaximumDisksPerNode:r}})(e,u,c));return(e=>{if(!e?.length)return;let t=new Map;e.forEach(e=>{e.VDisks?.forEach(e=>{let r=p(e.NodeId,e.PDiskId,e.VDiskSlotId);r&&t.set(r,e)})}),e.forEach(e=>{e.VDisks?.forEach(e=>{!e.Replicated&&e.Donors?.length&&e.Donors.forEach(r=>{let n=p(r.NodeId,r.PDiskId,r.VDiskSlotId);if(!n)return;let a=t.get(n);a&&(a.Recipient={NodeId:e.NodeId,StringifiedId:e.StringifiedId},r.StringifiedId!==a.StringifiedId&&(r.StringifiedId=a.StringifiedId))})})})})(m),{nodes:m,total:Number(r)||m?.length,found:Number(n),tableGroups:d,columnsSettings:{maxSlotsPerDisk:u,maxDisksPerNode:c}}},g=e=>{let t,{StoragePools:r,StorageGroups:n,TotalGroups:a,FoundGroups:s}=e,l=(t=[],n?t=n.map(m):r?.forEach(e=>{e.Groups?.forEach(r=>{t.push(((e,t)=>{let r,n=0,a=0,s=0,l=0,o=0,{Name:d,MediaType:m}=t;if(e.VDisks)for(let t of e.VDisks){let{Replicated:e,VDiskState:d,AvailableSize:u,AllocatedSize:c,PDisk:m,ReadThroughput:p,WriteThroughput:h}=t,{Type:g,State:f,AvailableSize:v}=(0,i.or)(m);(!1===e||"Normal"!==f||"OK"!==d)&&(n+=1);let k=Number(u??v)||0,N=Number(c)||0;a+=N,s+=k+N,l+=Number(p)||0,o+=Number(h)||0,r=g&&(g===r||!r)?g:"Mixed"}let p=e.VDisks?.map(e=>c(e,d)),h=s?((e,t=1)=>Math.floor((e.Limit?100*e.Used/e.Limit:0)/t)*t)({Used:a,Limit:s},5):void 0,g=u(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:p,Usage:h,Read:l,Write:o,PoolName:d,Used:a,Limit:s,Degraded:n,MediaType:m||r||void 0,DiskSpace:g}})(r,e))})}),t);return{groups:l,total:Number(a)||l.length,found:Number(s)}};function f(e){let{FoundGroups:t,TotalGroups:r,StorageGroups:n=[],StorageGroupGroups:a}=e,s=n.map(e=>{let{Usage:t,DiskSpaceUsage:r,Read:n,Write:a,Used:s,Limit:i,MissingDisks:l,VDisks:c=[],Overall:m,LatencyPutTabletLog:p,LatencyPutUserData:h,LatencyGetFast:g}=e,f=c.map(d.b),v=u(e);return{...e,Usage:t,DiskSpaceUsage:r,Read:Number(n),Write:Number(a),Used:Number(s),Limit:Number(i),LatencyPutTabletLogMs:(0,o.Jc)(p),LatencyPutUserDataMs:(0,o.Jc)(h),LatencyGetFastMs:(0,o.Jc)(g),Degraded:Number(l),Overall:m,VDisks:f,DiskSpace:v}}),i=a?.map(({GroupName:e,GroupCount:t})=>{if(e&&t)return{name:e,count:Number(t)}}).filter(e=>!!e);return{groups:s,total:Number(r)||s.length,found:Number(t),tableGroups:i}}},93639:function(e,t,r){r.d(t,{J:()=>i,d:()=>s});var n=r(95980),a=r(7360);function s(e){let t=i(e.State),r=(0,a.SW)(e.AllocatedPercent);return t!==n.Km&&r?Math.max(t,r):t}function i(e){var t;return void 0!==(t=e)&&t in n.iZ?n.iZ[e]:n.Km}},16021:function(e,t,r){r.d(t,{J:()=>i,b:()=>s});var n=r(40897),a=r(95980);function s(e){let{DiskSpace:t,VDiskState:r,FrontQueues:n,Replicated:s}=e;if(!r)return a.Km;let o=Math.max(Math.min(a.aW.Yellow,l(t)),i(r),Math.min(a.aW.Yellow,l(n)));return!1===s&&o===a.aW.Green&&(o=a.aW.Blue),o}function i(e){return e?a.qs[e]??a.Km:a.Km}function l(e){return e?e===n.m.Blue?a.aW.Green:a.aW[e]??a.Km:a.Km}},95980:function(e,t,r){r.d(t,{A$:()=>c,Km:()=>m,WK:()=>N,Yh:()=>p,aW:()=>d,iZ:()=>g,nG:()=>k,nZ:()=>v,nr:()=>f,qs:()=>h,r4:()=>u});var n=r(11169),a=r(14204),s=r(21852),i=r(32065),l=r(52555),o=r(52457);let d={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},u="DarkGrey",c=Object.entries(d).reduce((e,[t,r])=>({...e,[r]:t}),{}),m=d.Grey,p=c[m],h={OK:d.Green,Initial:d.Yellow,SyncGuidRecovery:d.Yellow,LocalRecoveryError:d.Red,SyncGuidRecoveryError:d.Red,PDiskError:d.Red},g={Normal:d.Green,Initial:d.Yellow,InitialFormatRead:d.Yellow,InitialSysLogRead:d.Yellow,InitialCommonLogRead:d.Yellow,InitialFormatReadError:d.Red,InitialSysLogReadError:d.Red,InitialSysLogParseError:d.Red,InitialCommonLogReadError:d.Red,InitialCommonLogParseError:d.Red,CommonLoggerInitError:d.Red,OpenFileError:d.Red,ChunkQuotaError:d.Red,DeviceIoError:d.Red,Stopped:d.Red},f={[d.Green]:{theme:"success",icon:n.A},[d.Yellow]:{theme:"warning",icon:a.A},[d.Red]:{theme:"danger",icon:s.A},[d.Blue]:{theme:"info",icon:i.A},[d.Grey]:{theme:"normal"}},v=l.A,k=o.A,N={donor:{theme:"unknown",icon:v},replica:{theme:f[d.Blue].theme,icon:f[d.Blue].icon}}},96360:function(e,t,r){r.d(t,{Y:()=>n});function n(e){var t;let r;if(!e)return;let n=(t=BigInt(e).toString(2),r={},Object.entries({isSolidState:1,kind:55,typeExt:8}).reduce((e,[n,a])=>{let s=t.length-e;return r[n]=t.substring(s-a,s)||"0",e+a},0),r);if("1"===n.isSolidState)switch(parseInt(n.typeExt,2)){case 0:return"SSD";case 2:return"NVME"}else if("0"===n.typeExt)return"HDD"}},7360:function(e,t,r){r.d(t,{H7:()=>c,NJ:()=>l,PH:()=>h,SW:()=>d,XY:()=>u,nC:()=>p,r$:()=>m});var n=r(2543),a=r(40897),s=r(14016),i=r(95980);function l(e){return"VDiskId"in e}let o=(0,s.H)([a.m.Green,a.m.Yellow,a.m.Red]),d=e=>(0,n.isNil)(e)?0:c(o(e));function u(e){return void 0===e?i.Yh:i.A$[e]||i.Yh}function c(e){return e?i.aW[e]:0}function m({nodeId:e,pDiskId:t}){if(!(0,n.isNil)(e)&&!(0,n.isNil)(t))return`${e}-${t}`}function p(e){return("vDiskId"in e?[e.vDiskId]:[e.nodeId,e.pDiskId,e.vDiskSlotId]).join("-")}function h(e,t){if(void 0===e)return;let r=e===i.aW.Red;return e===i.aW.Blue&&t?i.nZ:r?i.nG:void 0}},22530:function(e,t,r){r.d(t,{LW:()=>u,WT:()=>function e(t={}){if(!(0,o.NJ)(t)){let{NodeId:e,PDiskId:r,VSlotId:s}=t,i=(0,n.isNil)(s)||(0,n.isNil)(r)||(0,n.isNil)(e)?void 0:{NodeId:e,PDiskId:r,VSlotId:s};return{StringifiedId:(0,a.U9)(i),NodeId:e,PDiskId:r,VDiskSlotId:s}}let{PDisk:r,PDiskId:s,VDiskId:l,NodeId:c,Donors:m,AvailableSize:p,AllocatedSize:h,...g}=t,f=r?d({...r,NodeId:r?.NodeId??c}):void 0,v=s??f?.PDiskId,k=u({AvailableSize:p,AllocatedSize:h,SlotSize:r?.EnforcedDynamicSlotSize}),N=(0,i.b)(t),x=(0,a.U9)(l),S=m?.map(t=>{if((0,o.NJ)(t))return e({...t,DonorMode:!0});{let{NodeId:e,PDiskId:r,VSlotId:a}=t,s=(0,n.isNil)(e)||(0,n.isNil)(r)||(0,n.isNil)(a)?"":`${e}-${r}-${a}`;return{NodeId:e,PDiskId:r,VDiskSlotId:a,StringifiedId:s,DonorMode:!0}}});return{...g,...k,VDiskId:l,NodeId:c,PDiskId:v,PDisk:f,Donors:S,Severity:N,StringifiedId:x}},hK:()=>c,or:()=>d});var n=r(2543),a=r(97855),s=r(93639),i=r(16021),l=r(96360),o=r(7360);function d(e={}){let{AvailableSize:t,TotalSize:r,Category:n,State:a,PDiskId:i,NodeId:u,EnforcedDynamicSlotSize:m,...p}=e,h=(0,o.r$)({nodeId:u,pDiskId:i}),g=(0,l.Y)(n),f=c({AvailableSize:t,TotalSize:r}),v=(0,s.d)({State:a,AllocatedPercent:f.AllocatedPercent});return{...p,...f,PDiskId:i,NodeId:u,StringifiedId:h,Type:g,Category:n,State:a,Severity:v,SlotSize:m}}function u({AvailableSize:e,AllocatedSize:t,SlotSize:r}){let n=Number(e??0),a=Number(t),s=Number(r),i=a+n;!n&&s&&(i=s);let l=i>0?Math.floor(100*a/i):NaN;return{AvailableSize:n,AllocatedSize:a,SizeLimit:i,AllocatedPercent:l}}function c({AvailableSize:e,TotalSize:t}){let r=Number(e),n=Number(t),a=n-r,s=Math.floor(100*a/n);return{AvailableSize:r,TotalSize:n,AllocatedSize:a,AllocatedPercent:s}}},33583:function(e,t,r){r.d(t,{T:()=>n}),r(60680);let n=(e,t=-1)=>-1===t?`-${e}`:e},36354:function(e,t,r){r.d(t,{o:()=>a});var n=r(96540);function a({value:e,onUpdate:t,debounce:r=200}){let[a,s]=n.useState(e),i=n.useRef();return n.useEffect(()=>{s(t=>t!==e?e:t)},[e]),[a,e=>{s(e),window.clearTimeout(i.current),i.current=window.setTimeout(()=>{t?.(e)},r)}]}},33702:function(e,t,r){r.d(t,{K:()=>i});var n=r(96540),a=r(99286);function s(e){if("string"==typeof e)return{id:e,selected:!0};if(e&&"object"==typeof e&&"id"in e&&"string"==typeof e.id){let t="selected"in e&&!!e.selected;return{id:e.id,selected:t}}}let i=(e,t,r,i,l)=>{let[o,d]=n.useState(()=>{let r=a.f.readUserSettingsValue(t,i).map(s);return e.reduce((e,t)=>{let n=r.find(e=>e&&e.id===t.name);return n?e.push(n):e.push({id:t.name,selected:!1}),e},[])}),u=n.useMemo(()=>o.reduce((t,{id:n,selected:a})=>{let s=l?.includes(n),i=e.find(e=>e.name===n);return i&&t.push({id:n,title:r[n],selected:a||s,required:s,sticky:s?"start":void 0,column:i}),t},[]).toSorted((e,t)=>Number(!!t.required)-Number(!!e.required)),[e,r,l,o]);return{columnsToShow:n.useMemo(()=>u.filter(e=>e.selected).map(e=>e.column),[u]),columnsToSelect:u,setColumns:n.useCallback(e=>{let r=e.map(({id:e,selected:t})=>({id:e,selected:t}));a.f.setUserSettingsValue(t,r),d(r)},[t])}}},5577:function(e,t,r){r.d(t,{g:()=>i,w:()=>l});var n=r(35537),a=r(97855);let s=e=>(0,a.ZV)((0,a.CR)(e||0,2)),i=(e,t)=>[s(e),s(t)];function l({inverseColorize:e,warningThreshold:t=n.Hh,dangerThreshold:r=n.Ed,colorizeProgress:a,fillWidth:s}){let i=e?"danger":"good";return a&&(s>t&&s<=r?i="warning":s>r&&(i=e?"good":"danger")),i}},282:function(e,t,r){r.d(t,{$:()=>i});var n=r(74848),a=r(19583),s=r(67103);let i=e=>403===e.status?(0,n.jsx)(a.O,{position:"left"}):(0,n.jsx)(s.o,{error:e})},36712:function(e,t,r){r.d(t,{R:()=>n});function n(e,t){return Array.from(e.reduce((e,r)=>(t[r].forEach(t=>{e.add(t)}),e),new Set)).sort()}},53486:function(e,t,r){r.d(t,{P:()=>s,_:()=>i});var n=r(40897);let a={Dead:n.m.Red,Created:n.m.Yellow,ResolveStateStorage:n.m.Yellow,Candidate:n.m.Yellow,BlockBlobStorage:n.m.Yellow,WriteZeroEntry:n.m.Yellow,Restored:n.m.Yellow,Discover:n.m.Yellow,Lock:n.m.Yellow,Stopped:n.m.Yellow,ResolveLeader:n.m.Yellow,RebuildGraph:n.m.Yellow,Terminating:n.m.Yellow,Deleted:n.m.Green,Active:n.m.Green},s=e=>e?Object.values(n.m).includes(e)?e:a[e]:n.m.Grey;function i(e){if(!e)return"unknown";switch(e){case"Dead":return"danger";case"Active":case"Deleted":return"success";default:return"warning"}}}}]);