"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([["45132"],{23273:function(e,t,a){a.d(t,{E:()=>p});var i=a(74848),r=a(32065),n=a(24629),s=a(43834),l=a(56496),o=a(25247),d=a(61738),u=a(51432),c=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}');let m=(0,u.g4)("ydb-diagnostics-autorefresh-control",{en:c}),h=(0,o.cn)("auto-refresh-control");function p({className:e,onManualRefresh:t}){let a=(0,d.YQ)(),[o,u]=(0,d.Nt)();return(0,i.jsxs)("div",{className:h(null,e),children:[(0,i.jsx)(n.$,{view:"flat-secondary",onClick:()=>{a(l.F.util.invalidateTags(["All"])),t?.()},"aria-label":m("Refresh"),children:(0,i.jsx)(n.$.Icon,{children:(0,i.jsx)(r.A,{})})}),(0,i.jsxs)(s.l,{value:[String(o)],onUpdate:e=>{u(Number(e))},width:85,qa:"ydb-autorefresh-select",children:[(0,i.jsx)(s.l.Option,{value:"0",children:m("None")}),(0,i.jsx)(s.l.Option,{value:"15000",children:m("15 sec")}),(0,i.jsx)(s.l.Option,{value:"60000",children:m("1 min")}),(0,i.jsx)(s.l.Option,{value:"120000",children:m("2 min")}),(0,i.jsx)(s.l.Option,{value:"300000",children:m("5 min")})]})]})}},50504:function(e,t,a){a.d(t,{V:()=>h});var i=a(74848);a(96540);var r=a(17427),n=a(85169),s=a(2837),l=a(25247),o=a(95980),d=a(7360),u=a(61738),c=a(28241);let m=(0,l.cn)("storage-disk-progress-bar");function h({diskAllocatedPercent:e=-1,severity:t,compact:a,faded:l,inactive:h,empty:p,content:g,striped:f,className:v,isDonor:k,withIcon:N,highlighted:S,noDataPlaceholder:b}){let[x]=(0,u.iK)(s.GS.INVERTED_DISKS),y={inverted:x,compact:a,faded:l,empty:p,inactive:h,striped:f,highlighted:S};if(k)y[o.r4.toLocaleLowerCase()]=!0;else{let e=void 0!==t&&(0,d.XY)(t);e&&(y[e.toLocaleLowerCase()]=!0)}let D=(0,c.kf)(e)&&e>=0,w=null;if(N){let e=(0,d.PH)(t,k);e&&(w=(0,i.jsx)(r.I,{className:m("icon"),data:e,size:12}))}let I=!!w;return(0,i.jsxs)(n.s,{alignItems:"center",justifyContent:I?"space-between":"flex-end",className:m(y,v),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":D?e:void 0,children:[w,(()=>{if(a)return(0,i.jsx)("div",{className:m("fill-bar",y),style:{width:"100%"}});if(!D)return null;let t=Math.min(e,100);return x&&(t=Math.max(100-e,0)),(0,i.jsx)("div",{className:m("fill-bar",y),style:{width:`${t}%`}})})(),g||(!a&&D?(0,i.jsx)("div",{className:m("title"),children:`${Math.floor(e)}%`}):a||D||!b?null:(0,i.jsx)("div",{className:m("title"),children:b}))]})}},78799:function(e,t,a){a.d(t,{U:()=>c});var i=a(74848),r=a(24629),n=a(78636),s=a(78870),l=a(51432),o=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),d=JSON.parse('{"default_message":"Всё в порядке!","default_button_label":"Показать все"}');let u=(0,l.g4)("ydb-storage-empty-filter",{ru:d,en:o}),c=({title:e,message:t=u("default_message"),showAll:a=u("default_button_label"),onShowAll:l,image:o=(0,i.jsx)(s.v,{name:"thumbsUp",width:200})})=>(0,i.jsx)(n.pp,{image:o,position:"left",title:e,description:t,actions:l&&[(0,i.jsx)(r.$,{onClick:l,children:a},"show-all")]})},15474:function(e,t,a){a.d(t,{P:()=>u});var i=a(74848),r=a(96540),n=a(54403),s=a(38221),l=a.n(s),o=a(35537);let d=100,u=({children:e,renderPopupContent:t,showPopup:a,offset:s,anchorRef:u,onShowPopup:c,onHidePopup:m,placement:h=["top","bottom"],contentClassName:p,delayClose:g=d,delayOpen:f=d})=>{let[v,k]=r.useState(!1),[N,S]=r.useState(!1),[b,x]=r.useState(!1),y=r.useRef(null),D=r.useRef(!1),w=r.useCallback(e=>{D.current!==e&&(D.current=e,e?c?.():m?.())},[c,m]),I=r.useMemo(()=>l()(()=>{k(!0),w(!0)},f),[f,w]),P=r.useCallback(()=>{k(!1)},[]),j=r.useMemo(()=>l()(()=>{P(),w(!1)},g),[g,w,P]),A=r.useCallback(()=>{j.cancel(),S(!0),w(!0)},[w,j]),C=r.useCallback(()=>{S(!1),j()},[j]),E=r.useCallback(()=>{x(!0),w(!0)},[w]),T=r.useCallback(()=>{x(!1)},[]),M=r.useCallback(()=>{x(!1),S(!1),P(),w(!1)},[P,w]),U=u?.current||y.current;return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)("span",{ref:y,onMouseEnter:()=>{j.cancel(),I()},onMouseLeave:()=>{I.cancel(),j()},children:e}),U?(0,i.jsx)(n.z,{anchorElement:U,onOpenChange:(e,t,a)=>{"escape-key"===a&&M()},placement:h,hasArrow:!0,open:v||N||b||a,offset:s||{mainAxis:12,crossAxis:0},children:(0,i.jsx)("div",{className:p,onContextMenu:E,onMouseEnter:A,onMouseLeave:C,onBlur:T,children:(0,i.jsx)("div",{className:o.zQ,children:t()})})}):null]})}},11342:function(e,t,a){a.d(t,{A:()=>n});var i=a(51432),r=JSON.parse('{"text_external-consumption":"External Consumption","text_allocator-caches":"Allocator Caches","text_shared-cache":"Shared Cache","text_memtable":"MemTable","text_query-execution":"Query Execution","text_usage":"Usage","text_soft-limit":"Soft Limit","text_hard-limit":"Hard Limit","text_other":"Other","text_memory-details":"Memory Details"}');let n=(0,i.g4)("ydb-memory-viewer",{en:r})},26552:function(e,t,a){a.d(t,{AB:()=>o,HW:()=>n,Sb:()=>d});var i=a(28241),r=a(11342);function n(e){return String((s(e.AllocatedMemory)||0)+(s(e.AllocatorCachesMemory)||0))}function s(e){return(0,i.kf)(e)?parseFloat(String(e)):void 0}let l={AllocatorCachesMemory:"var(--g-color-base-danger-medium)",SharedCacheConsumption:"var(--g-color-base-info-medium)",MemTableConsumption:"var(--g-color-base-warning-medium)",QueryExecutionConsumption:"var(--g-color-base-positive-medium)",Other:"var(--g-color-base-neutral-medium)"};function o(e){return l[e]||l.Other}function d(e,t){let a=[{label:(0,r.A)("text_shared-cache"),key:"SharedCacheConsumption",value:s(e.SharedCacheConsumption),capacity:s(e.SharedCacheLimit),isInfo:!1},{label:(0,r.A)("text_query-execution"),key:"QueryExecutionConsumption",value:s(e.QueryExecutionConsumption),capacity:s(e.QueryExecutionLimit),isInfo:!1},{label:(0,r.A)("text_memtable"),key:"MemTableConsumption",value:s(e.MemTableConsumption),capacity:s(e.MemTableLimit),isInfo:!1},{label:(0,r.A)("text_allocator-caches"),key:"AllocatorCachesMemory",value:s(e.AllocatorCachesMemory),isInfo:!1}],i=Math.max(0,t-a.filter(e=>void 0!==e.value).reduce((e,t)=>e+t.value,0));return a.push({label:(0,r.A)("text_other"),key:"Other",value:i,isInfo:!1}),a.push({label:(0,r.A)("text_external-consumption"),key:"ExternalConsumption",value:s(e.ExternalConsumption),isInfo:!0},{label:(0,r.A)("text_usage"),key:"Usage",value:t,isInfo:!0},{label:(0,r.A)("text_soft-limit"),key:"SoftLimit",value:s(e.SoftLimit),isInfo:!0},{label:(0,r.A)("text_hard-limit"),key:"HardLimit",value:s(e.HardLimit),isInfo:!0}),a.filter(e=>void 0!==e.value)}},79517:function(e,t,a){a.d(t,{D:()=>n});var i=a(51432),r=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","usage":"Usage","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","yes":"Yes"}');let n=(0,i.g4)("ydb-pDisk-info",{en:r})},39235:function(e,t,a){a.d(t,{L:()=>d});var i=a(74848),r=a(8946),n=a(60318),s=a(51432),l=JSON.parse('{"pdisk-page":"PDisk page"}');let o=(0,s.g4)("ydb-pDisk-link",{en:l});function d({pDiskId:e,nodeId:t}){return(0,i.jsx)(n.K,{title:o("pdisk-page"),url:(0,r.Ck)(e,t),external:!1})}},78331:function(e,t,a){a.d(t,{fX:()=>P,Oy:()=>C,pF:()=>A,JT:()=>j});var i=a(74848),r=a(96540),n=a(5434),s=a(85169),l=a(2543),o=a(56321),d=a(40897),u=a(35537),c=a(88387),m=a(93639),h=a(95980),p=a(61738),g=a(81709),f=a(88831),v=a(28241),k=a(60318),N=a(79517),S=a(39235),b=a(17989),x=a(70073),y=a(51432),D=JSON.parse('{"context_not-available":"Not available","label_type":"Type","label_node-id":"Node Id","label_host":"Host","label_dc":"DC","label_path":"Path","label_available":"Available","label_realtime":"Realtime","label_device":"Device","value_unknown":"unknown","value_of":"of"}');let w=(0,y.g4)("ydb-pDisk-popup",{en:D}),I=[d.m.Orange,d.m.Red,d.m.Yellow],P=(e,t)=>{let{AvailableSize:a,TotalSize:r,NodeId:s,Path:l,Realtime:o,Type:d,Device:u}=e,c=[{name:w("label_type"),content:d||w("value_unknown")}];return s&&c.push({name:w("label_node-id"),content:s}),t?.Host&&c.push({name:w("label_host"),content:t.Host}),t?.DC&&c.push({name:w("label_dc"),content:(0,i.jsx)(n.J,{children:t.DC})}),l&&c.push({name:w("label_path"),content:l}),(0,v.kf)(r)&&(0,v.kf)(a)&&c.push({name:w("label_available"),content:`${(0,v.wb)(a)} ${w("value_of")} ${(0,v.wb)(r)}`}),o&&I.includes(o)&&c.push({name:w("label_realtime"),content:(0,i.jsx)(b.k,{mode:"icons",status:o})}),u&&I.includes(u)&&c.push({name:w("label_device"),content:(0,i.jsx)(b.k,{mode:"icons",status:u})}),c},j=e=>{let t=[],{State:a}=e;if(!a)return t.push({id:"state",value:w("context_not-available")}),t;if(a){let e=(0,m.J)(a),{theme:i,icon:r}=h.nr[e];t.push({id:"state",value:a,theme:i,icon:r})}return t},A=(e,t)=>{let{NodeId:a,PDiskId:r}=e;if(!t||(0,l.isNil)(a)||(0,l.isNil)(r))return null;let n=(0,c.ar)({nodeId:a,pDiskId:r});return(0,i.jsxs)(s.s,{gap:2,wrap:"wrap",children:[(0,i.jsx)(S.L,{pDiskId:r,nodeId:a}),(0,i.jsx)(k.K,{title:(0,N.D)("developer-ui"),url:n})]})},C=({data:e})=>{let t=(0,g.J)(),a=(0,f.X)(),n=(0,p.N4)(e=>(0,o.K)(e,t)),s=(0,l.isNil)(e.NodeId)?void 0:n?.get(e.NodeId),d=r.useMemo(()=>P(e,s),[e,s]),c=r.useMemo(()=>j(e),[e]),m=r.useMemo(()=>A(e,a),[e,a]),h=e.StringifiedId;return(0,i.jsx)(x.n,{compact:!0,title:"PDisk",titleSuffix:h??u.Pd,items:d,headerLabels:c,footer:m,nameMaxWidth:100})}},12623:function(e,t,a){a.d(t,{WV:()=>o,jV:()=>l});var i=a(74848),r=a(96540);let n={sortParams:void 0,totalEntities:0,foundEntities:0,isInitialLoad:!0},s=r.createContext({tableState:n,setSortParams:()=>void 0,setTotalEntities:()=>void 0,setFoundEntities:()=>void 0,setIsInitialLoad:()=>void 0}),l=({children:e,initialState:t={},noBatching:a})=>{let[l,o]=r.useState(t.sortParams??n.sortParams),[d,u]=r.useState(t.totalEntities??n.totalEntities),[c,m]=r.useState(t.foundEntities??n.foundEntities),[h,p]=r.useState(t.isInitialLoad??n.isInitialLoad),g=r.useMemo(()=>({sortParams:l,totalEntities:d,foundEntities:c,isInitialLoad:h}),[l,d,c,h]),f=r.useMemo(()=>({tableState:g,noBatching:a,setSortParams:o,setTotalEntities:u,setFoundEntities:m,setIsInitialLoad:p}),[g,a]);return(0,i.jsx)(s.Provider,{value:f,children:e})},o=()=>{let e=r.useContext(s);if(void 0===e)throw Error("usePaginatedTableState must be used within a PaginatedTableStateProvider");return e}},41254:function(e,t,a){a.d(t,{o:()=>u});var i=a(74848),r=a(96540),n=a(48849),s=a(12623);let l=({table:e,tableWrapperProps:t})=>{let{tableState:a}=(0,s.WV)(),{sortParams:l}=a,o=r.useMemo(()=>{let e=t?.scrollDependencies||[];return{...t,scrollDependencies:[...e,l]}},[t,l]);return(0,i.jsx)(n.L.Table,{...o,children:e})},o=({controls:e,extraControls:t})=>e||t?(0,i.jsx)(n.L.Controls,{renderExtraControls:()=>t,children:e}):null,d=({error:e})=>e?(0,i.jsx)(r.Fragment,{children:e}):null,u=({controls:e,extraControls:t,table:a,tableWrapperProps:r,error:u,initialState:c,noBatching:m,fullHeight:h=!0})=>(0,i.jsx)(s.jV,{initialState:c,noBatching:m,children:(0,i.jsxs)(n.L,{fullHeight:h,children:[(0,i.jsx)(o,{controls:e,extraControls:t}),(0,i.jsx)(d,{error:u}),(0,i.jsx)(l,{table:a,tableWrapperProps:r})]})})},74104:function(e,t,a){a.d(t,{U3:()=>41,k5:()=>H,qr:()=>i});let i={NODES:"nodes",STORAGE_NODES:"storage-nodes",STORAGE_GROUPS:"storage-groups",TOPIC_DATA:"topic-data",NODE_PEERS:"node-peers"},r={[i.NODES]:!0,[i.STORAGE_NODES]:!0,[i.STORAGE_GROUPS]:!0,[i.TOPIC_DATA]:!0,[i.NODE_PEERS]:!1};var n=a(74848),s=a(96540),l=a(12623);class o{requestQueue=new Map;batchTimeout=null;BATCH_DELAY=50;queueRequest(e,t){return new Promise((a,i)=>{let r=this.createBatchKey(e);this.requestQueue.has(r)||this.requestQueue.set(r,[]),this.requestQueue.get(r).push({params:e,resolve:a,reject:i,signal:t}),this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.processBatch()},this.BATCH_DELAY)})}createBatchKey(e){return JSON.stringify({tableName:e.tableName,filters:e.filters,sortParams:e.sortParams,columnsIds:e.columnsIds,limit:e.limit})}groupConsecutiveRequests(e){if(0===e.length)return[];let t=e.sort((e,t)=>e.params.offset-t.params.offset),a=[],i=[t[0]],r=t[0].params.limit;for(let e=1;e<t.length;e++){let n=i[i.length-1].params.offset+r;t[e].params.offset===n?i.push(t[e]):(a.push(this.createBatchGroup(i)),i=[t[e]])}return a.push(this.createBatchGroup(i)),a}createBatchGroup(e){let t=Math.min(...e.map(e=>e.params.offset)),a=Math.max(...e.map(e=>e.params.offset)),i=e[0].params.limit,r=e.length*i;return{requests:e,batchKey:this.createBatchKey(e[0].params),minOffset:t,maxOffset:a,totalLimit:r}}async executeBatch(e){let t=e.requests[0],a={...t.params,offset:e.minOffset,limit:e.totalLimit};try{let i=await t.params.fetchData({limit:a.limit,offset:a.offset,filters:a.filters,sortParams:a.sortParams,columnsIds:a.columnsIds,signal:t.signal});this.splitAndDistributeResponse(e,i)}catch(t){e.requests.forEach(e=>{e.resolve({error:t})})}}splitAndDistributeResponse(e,t){let a=e.requests[0].params.limit;e.requests.forEach((e,i)=>{let r=i*a,n=t.data.slice(r,r+a),s={...t,data:n,total:t.total,found:t.found};e.resolve({data:s})})}async processBatch(){let e=Array.from(this.requestQueue.entries());for(let[t,a]of(this.requestQueue.clear(),this.batchTimeout=null,e)){let e=this.groupConsecutiveRequests(a);await Promise.all(e.map(e=>this.executeBatch(e)))}}}let d=new o,u=a(56496).F.injectEndpoints({endpoints:function(e){return{fetchTableChunk:e.query({queryFn:async({offset:e,limit:t,sortParams:a,filters:i,columnsIds:r,fetchData:n,tableName:s,noBatching:l},{signal:o})=>{try{if(l)return{data:await n({limit:t,offset:e,filters:i,sortParams:a,columnsIds:r,signal:o})};{let l=await d.queueRequest({offset:e,limit:t,sortParams:a,filters:i,columnsIds:r,fetchData:n,tableName:s},o);if("error"in l)return{error:l.error};return l}}catch(e){return{error:e}}},providesTags:["All"]})}}});var c=a(33172),m=a(61738),h=a(67103),p=a(86268);let g=(0,a(25247).cn)("ydb-paginated-table");function f(e){let t,a=null;return function(...i){t=i,"number"!=typeof a&&(a=requestAnimationFrame(()=>{e(...t),a=null}))}}let v=s.memo,k=({children:e,className:t,height:a,width:i,align:r="left",resizeable:s})=>(0,n.jsx)("td",{className:g("row-cell",{align:r},t),style:{height:`${a}px`,width:`${i}px`,maxWidth:s?`${i}px`:void 0},children:e}),N=v(function({columns:e,height:t}){return(0,n.jsx)("tr",{className:g("row",{loading:!0}),style:{height:t},children:e.map(e=>{let a=e.resizeable??!0;return(0,n.jsx)(k,{height:t,width:e.width,align:e.align,className:e.className,resizeable:a,children:(0,n.jsx)(p.E,{className:g("row-skeleton"),style:{width:"80%",height:"50%"}})},e.name)})})}),S=({row:e,columns:t,getRowClassName:a,height:i})=>{let r=a?.(e);return(0,n.jsx)("tr",{className:g("row",r),style:{height:i},children:t.map(t=>{let a=t.resizeable??!0;return(0,n.jsx)(k,{height:i,width:t.width,align:t.align,className:t.className,resizeable:a,children:t.render({row:e})},t.name)})})},b=({columns:e,children:t,height:a})=>(0,n.jsx)("tr",{className:g("row",{empty:!0}),style:{height:a},children:(0,n.jsx)("td",{colSpan:e.length,className:g("td"),children:t})});var x=a(51432),y=JSON.parse('{"empty":"Нет данных"}');let D=(0,x.g4)("ydb-paginated-table",{ru:y,en:{empty:"No data"}}),w=v(function({id:e,chunkSize:t,calculatedCount:a,rowHeight:i,columns:o,fetchData:d,tableName:p,filters:g,sortParams:f,getRowClassName:v,renderErrorMessage:k,renderEmptyDataMessage:x,onDataFetched:y,shouldFetch:w,shouldRender:I,keepCache:P}){let[j,A]=s.useState(!0),[C]=(0,m.Nt)(),{noBatching:E}=(0,l.WV)(),T=r[p]??!1,M={offset:e*t,limit:t,fetchData:d,filters:g,sortParams:f,columnsIds:s.useMemo(()=>T?o.map(e=>e.name).toSorted():[],[o,T]),tableName:p,noBatching:E};u.useFetchTableChunkQuery(M,{skip:j||!w,pollingInterval:C,refetchOnMountOrArgChange:!P});let{currentData:U,error:R}=u.endpoints.fetchTableChunk.useQueryState(M);s.useEffect(()=>{let e=0;return w&&j&&(e=window.setTimeout(()=>{A(!1)},200)),()=>{window.clearTimeout(e)}},[w,j]),s.useEffect(()=>{U&&y({...U,data:U.data,found:U.found||0,total:U.total||0})},[U,y]);let L=U?.data?.length||a;return I?(()=>{if(!U)if(R)return(0,n.jsx)(b,{columns:o,height:L*i,children:k?k(R):(0,n.jsx)(h.o,{error:R})});else return(0,c._e)(L).map(e=>(0,n.jsx)(N,{columns:o,height:i},e));return U.data?.length?U.data.map((e,t)=>(0,n.jsx)(S,{row:e,columns:o,height:i,getRowClassName:v},t)):(0,n.jsx)(b,{columns:o,height:L*i,children:x?x():D("empty")})})():null});var I=a(2543);let P=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?1:2,j=4,A=({scrollContainerRef:e,tableRef:t,foundEntities:a,chunkSize:i,rowHeight:r,columns:l,fetchData:o,filters:d,tableName:u,sortParams:c,getRowClassName:m,renderErrorMessage:h,renderEmptyDataMessage:p,onDataFetched:v,keepCache:k})=>{let N=(({scrollContainerRef:e,tableRef:t,totalItems:a,rowHeight:i,chunkSize:r,renderOverscan:n=P,fetchOverscan:l=j})=>{let o=s.useMemo(()=>Math.ceil(a/r),[r,a]),[d,u]=s.useState(0),[c,m]=s.useState(0),h=s.useCallback(()=>{let n,s,l=e?.current,d=t.current;if(!l||!d)return null;let u=(n=d.getBoundingClientRect(),s=l.getBoundingClientRect(),n.top-s.top+l.scrollTop),c=Math.max(l.scrollTop-u,0),m=c+l.clientHeight,h=function(e){let{container:t,currentTableOffset:a,totalItems:i,rowHeight:r,freezeMarginPx:n}=e,s=t.scrollTop,l=s+t.clientHeight,o="number"==typeof n?n:t.clientHeight;return l<a-o||s>a+i*r+o}({container:l,currentTableOffset:u,totalItems:a,rowHeight:i});return{start:Math.max(Math.floor(c/i/r),0),end:Math.min(Math.floor(m/i/r),Math.max(o-1,0)),skipUpdate:h}},[e,t,i,r,o,a]),p=s.useCallback(()=>{let e=h();if(e){let{start:t,end:a,skipUpdate:i}=e;if(i)return;u(t),m(a)}},[h]);s.useEffect(()=>{p()},[o,p]);let g=s.useCallback(()=>{p()},[p]);return s.useEffect(()=>{let e=f(()=>{p()});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[p]),s.useEffect(()=>{let t=e?.current;if(!t)return;let a=(0,I.throttle)(g,200,{trailing:!0,leading:!0});return t.addEventListener("scroll",a,{passive:!0}),()=>{t.removeEventListener("scroll",a)}},[g,e]),s.useMemo(()=>{let e=Math.max(d-n,0),t=Math.min(c+n,Math.max(o-1,0)),a=Math.max(d-l,0),i=Math.min(c+l,Math.max(o-1,0));return Array(o).fill(null).map((r,n)=>({shouldRender:n>=e&&n<=t,shouldFetch:n>=a&&n<=i}))},[o,d,c,n,l])})({scrollContainerRef:e,tableRef:t,totalItems:a||1,rowHeight:r,chunkSize:i}),S=s.useMemo(()=>a?a%i||i:1,[a,i]),b=s.useCallback(()=>({firstRenderIndex:N.findIndex(e=>e.shouldRender),lastRenderIndex:N.findLastIndex(e=>e.shouldRender)}),[N]),x=s.useCallback(()=>({firstFetchIndex:N.findIndex(e=>e.shouldFetch),lastFetchIndex:N.findLastIndex(e=>e.shouldFetch)}),[N]),y=s.useCallback((e,t)=>{let a=0;for(let n=e;n<t;n++)a+=(n===N.length-1?S:i)*r;return a},[i,N.length,S,r]),D=s.useCallback((e,t,a)=>{let i=y(e,t);return(0,n.jsx)("tr",{style:{height:`${i}px`},className:g(a),children:(0,n.jsx)("td",{colSpan:l.length,style:{padding:0,border:"none"}})},a)},[y,l.length]),A=s.useCallback(e=>{let t=N[e];return(0,n.jsx)(w,{id:e,calculatedCount:e===N.length-1?S:i,chunkSize:i,rowHeight:r,columns:l,fetchData:o,filters:d,tableName:u,sortParams:c,getRowClassName:m,renderErrorMessage:h,renderEmptyDataMessage:p,onDataFetched:v,shouldFetch:t.shouldFetch,shouldRender:t.shouldRender,keepCache:k},e)},[i,N,l,o,d,m,k,S,v,p,h,r,c,u]),C=s.useCallback(()=>{let{firstFetchIndex:e,lastFetchIndex:t}=x(),{firstRenderIndex:a,lastRenderIndex:i}=b(),r=[];if(-1===e)return r;a>0&&r.push(D(0,a,"separator-beginning"));for(let a=e;a<=t;a++)r.push(A(a));return i<N.length-1&&r.push(D(i+1,N.length,"separator-end")),r},[N.length,A,D,x,b]);return(0,n.jsx)(s.Fragment,{children:C()})};var C=a(46086);function E({minWidth:e,maxWidth:t,getCurrentColumnWidth:a,onResize:i}){let r=s.useRef(null),[l,o]=s.useState(!1);return s.useEffect(()=>{let n,s,l,d=r.current;if(!d)return;let u=f(a=>{if(T(a),"number"!=typeof n||"number"!=typeof s)return;let r=a.clientX-n,o=function(e,t=40,a=1/0){return Math.max(t,Math.min(e,a))}(s+r,e,t);o!==l&&(l=o,i?.(l))}),c=e=>{T(e),void 0!==l&&i?.(l),o(!1),n=void 0,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)},m=e=>{s=a(),T(e),n=e.clientX,o(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)};return d.addEventListener("mousedown",m),()=>{d.removeEventListener("mousedown",m),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)}},[i,e,t,a]),(0,n.jsx)("span",{ref:r,className:g("resize-handler",{resizing:l}),onClick:e=>T(e)})}function T(e){e.preventDefault(),e.stopPropagation()}let M=({order:e})=>(0,n.jsx)("svg",{className:g("sort-icon",{desc:-1===e}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,n.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})}),U=({sortOrder:e,sortable:t,defaultSortOrder:a})=>t?(0,n.jsx)("span",{className:g("sort-icon-container",{shadow:!e}),children:(0,n.jsx)(M,{order:e||a})}):null,R={left:"right",right:"left",center:"right"},L=({column:e,resizeable:t,sortOrder:a,defaultSortOrder:i,onSort:r,rowHeight:l,onCellMount:o,onCellUnMount:d,onColumnsResize:u})=>{let c=s.useRef(null);s.useEffect(()=>{let e=c.current;return e&&o?.(e),()=>{e&&d?.(e)}},[o,d]);let m=s.useCallback(()=>c.current?.getBoundingClientRect().width,[]),h=s.useCallback(t=>{u?.(e.name,t)},[u,e.name]),p=e.header??e.name,f={height:`${l}px`,width:`${e.width}px`,minWidth:t?`${e.width}px`:void 0,maxWidth:t?`${e.width}px`:void 0};return(0,n.jsxs)("th",{ref:c,className:g("head-cell-wrapper"),style:f,children:[(0,n.jsxs)("div",{className:g("head-cell",{align:e.align,sortable:e.sortable},e.className),onClick:()=>{e.sortable&&r?.(e.name)},children:[(0,n.jsxs)("div",{className:g("head-cell-content-container"),children:[(0,n.jsx)("div",{className:g("head-cell-content"),children:p}),e.note&&(0,n.jsx)(C.H,{popoverProps:{placement:R[e.align]},className:g("head-cell-note"),children:e.note})]}),(0,n.jsx)(U,{sortOrder:a,sortable:e.sortable,defaultSortOrder:i})]}),t?(0,n.jsx)(E,{maxWidth:e.resizeMaxWidth,minWidth:e.resizeMinWidth,getCurrentColumnWidth:m,onResize:h}):null]})},G=({columns:e,onSort:t,onColumnsResize:a,defaultSortOrder:i=-1,rowHeight:r=41})=>{let[l,o]=s.useState({}),d=e=>{let a={};if(e===l.columnId){if(l.sortOrder&&l.sortOrder!==i){o(a),t?.(a);return}a={sortOrder:1===l.sortOrder?-1:1,columnId:e}}else a={sortOrder:i,columnId:e};t?.(a),o(a)};return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)("colgroup",{children:e.map(e=>(0,n.jsx)("col",{style:{width:`${e.width}px`}},e.name))}),(0,n.jsx)("thead",{className:g("head"),children:(0,n.jsx)("tr",{children:e.map(e=>{let t=l.columnId===e.name?l.sortOrder:void 0,s=a&&(e.resizeable??!0);return(0,n.jsx)(L,{column:e,resizeable:s,sortOrder:t,defaultSortOrder:i,onSort:d,rowHeight:r,onColumnsResize:a},e.name)})})})]})},_=20,O=({limit:e=_,initialEntitiesCount:t,fetchData:a,filters:i,tableName:r,columns:o,getRowClassName:d,rowHeight:u=41,scrollContainerRef:c,onColumnsResize:m,renderErrorMessage:h,renderEmptyDataMessage:p,containerClassName:f,onDataFetched:v,keepCache:k=!0})=>{let{tableState:N,setSortParams:S,setTotalEntities:b,setFoundEntities:x,setIsInitialLoad:y}=(0,l.WV)(),{sortParams:D,foundEntities:w}=N,I=s.useRef(null),[P,j]=s.useState(i);s.useEffect(()=>{j(i)},[i]);let C=s.useCallback(e=>{e&&(b(e.total),x(e.found),y(!1),v?.(e))},[v,x,y,b]);return s.useLayoutEffect(()=>{let e=c.current;e&&"transform"!==window.getComputedStyle(e).willChange&&(e.style.willChange="transform")},[c.current]),s.useLayoutEffect(()=>{let e=t||0,a=t||1;b(e),x(a),y(!0)},[t,b,x,y]),(0,n.jsx)("div",{ref:I,className:g(null,f),children:(0,n.jsxs)("table",{className:g("table"),children:[(0,n.jsx)(G,{columns:o,onSort:S,onColumnsResize:m}),(0,n.jsx)("tbody",{children:(0,n.jsx)(A,{scrollContainerRef:c,tableRef:I,foundEntities:w,chunkSize:e,rowHeight:u,columns:o,fetchData:a,filters:P,tableName:r,sortParams:D,getRowClassName:d,renderErrorMessage:h,renderEmptyDataMessage:p,onDataFetched:C,keepCache:k})})]})})};var W=a(17854),z=a(78951);function H({columnsWidthLSKey:e,columns:t,...a}){let[i,r,s]=(0,W.a)(e),l=t.map(e=>({...e,width:i[e.name]??e.width}));return s?(0,n.jsx)(z.Q,{}):(0,n.jsx)(O,{columns:l,onColumnsResize:r,containerClassName:g("resizeable-table-container"),...a})}},52705:function(e,t,a){a.d(t,{O:()=>d});var i=a(74848),r=a(29714),n=a(25247),s=a(5577),l=a(28241);let o=(0,n.cn)("progress-viewer");function d({value:e,capacity:t,formatValues:a=s.g,percents:n,withOverflow:d,className:u,size:c="xs",colorizeProgress:m,inverseColorize:h,warningThreshold:p,dangerThreshold:g,hideCapacity:f}){let v=(0,r.D)(),k=Math.floor(parseFloat(String(e))/parseFloat(String(t))*100)||0,N=k;k=k>100?100:k;let S=e,b=t,x="/";n?(S=(d?N:k)+"%",b="",x=""):a&&([S,b]=a(Number(e),Number(t)));let y=(0,s.w)({fillWidth:k,warningThreshold:p,dangerThreshold:g,colorizeProgress:m,inverseColorize:h});m&&!(0,l.kf)(t)&&(k=100);let D={width:k+"%"};return(0,l.kf)(e)?(0,i.jsxs)("div",{className:o({size:c,theme:v,status:y},u),children:[(0,i.jsx)("div",{className:o("line"),style:D}),(0,i.jsx)("span",{className:o("text"),children:(0,l.kf)(t)&&!f?`${S} ${x} ${b}`:S})]}):(0,i.jsx)("div",{className:`${o({size:c})} ${u} error`,children:"no data"})}},92961:function(e,t,a){a.d(t,{j:()=>s});var i=a(74848),r=a(81392),n=a(65101);let s=({value:e,onChange:t,className:a})=>(0,i.jsxs)(r.x,{value:e,onUpdate:t,className:a,children:[(0,i.jsx)(r.x.Option,{value:"All",children:n.DG.All}),(0,i.jsx)(r.x.Option,{value:"SmallUptime",children:n.DG.SmallUptime})]})},80184:function(e,t,a){a.d(t,{y:()=>G});var i=a(74848),r=a(8946),n=a(25247),s=a(95980),l=a(50504),o=a(15474),d=a(15749),u=a(96540),c=a(85169),m=a(65066),h=a(2543),p=a(56321),g=a(40897),f=a(35537),v=a(97855),k=a(88387),N=a(16021),S=a(7360),b=a(61738),x=a(81709),y=a(88831),D=a(28241),w=a(60318),I=a(78331),P=a(17989),j=a(65153),A=a(70073),C=a(51432),E=JSON.parse('{"context_not-available":"not available","label_no-data":"No data","label_storage-pool":"StoragePool","label_donor":"Donor","label_node-id":"NodeId","label_pdisk-id":"PDiskId","label_vslot-id":"VSlotId","label_links":"Links","label_vdisk":"VDisk","label_fresh":"Fresh","label_level":"Level","label_space":"Space","label_front-queues":"FrontQueues","label_replicated":"Replicated","label_progress":"Progress","label_remaining":"Remaining","label_unsync-vdisks":"UnsyncVDisks","label_allocated":"Allocated","label_available":"Available","label_read":"Read","label_write":"Write","label_replication":"Replication","label_recipient":"Recipient"}');let T=(0,C.g4)("ydb-vDisk-popup",{en:E}),M=(0,n.cn)("vdisk-storage-popup"),U=({nodeId:e,stringifiedId:t,getVDiskLinkFn:a})=>{if((0,h.isNil)(t))return(0,i.jsx)("span",{children:f.Pd});if((0,h.isNil)(e))return(0,i.jsx)("span",{children:t});let r=a?.({nodeId:e,vDiskId:t});return(0,i.jsxs)(d.E,{to:r,children:[T("label_vdisk")," ",t]})},R=({data:e})=>{let t=(0,S.NJ)(e),a=(0,y.b)(),n=(0,y.X)(),l=(0,r.Z$)(),o=(0,x.J)(),d=u.useMemo(()=>t?((e,t)=>{let{VDiskState:a,SatisfactionRank:r,DiskSpace:n,FrontQueues:l,Replicated:o,ReplicationProgress:d,ReplicationSecondsRemaining:u,UnsyncedVDisks:m,AllocatedSize:p,AvailableSize:f,ReadThroughput:k,WriteThroughput:N,StoragePoolName:S,Donors:b,DonorMode:x,Recipient:y,Severity:w}=e,I=[];if(S&&I.push({name:T("label_storage-pool"),content:S}),b?.length&&w===s.aW.Blue&&I.push({name:T("label_donor"),content:(0,i.jsx)(c.s,{direction:"column",children:b.map(e=>(0,i.jsx)(U,{nodeId:e.NodeId,stringifiedId:e.StringifiedId,getVDiskLinkFn:t},e.StringifiedId))})}),x&&y&&I.push({name:T("label_recipient"),content:(0,i.jsx)(U,{nodeId:y.NodeId,stringifiedId:y.StringifiedId,getVDiskLinkFn:t})}),r&&r.FreshRank?.Flag!==g.m.Green&&I.push({name:T("label_fresh"),content:r.FreshRank?.Flag}),r&&r.LevelRank?.Flag!==g.m.Green&&I.push({name:T("label_level"),content:r.LevelRank?.Flag}),r&&r.FreshRank?.RankPercent&&I.push({name:T("label_fresh"),content:r.FreshRank.RankPercent}),r&&r.LevelRank?.RankPercent&&I.push({name:T("label_level"),content:r.LevelRank.RankPercent}),n&&I.push({name:T("label_space"),content:(0,i.jsx)(P.k,{mode:"icons",status:n})}),l&&I.push({name:T("label_front-queues"),content:(0,i.jsx)(P.k,{mode:"icons",status:l})}),!1===o&&"OK"===a){if(I.push({name:T("label_replicated"),content:"NO"}),!(0,h.isNil)(d)){let e=Math.round(100*d);I.push({name:T("label_progress"),content:`${e}%`})}if(!(0,h.isNil)(u)){let e=(0,v.je)(u);e&&I.push({name:T("label_remaining"),content:e})}}return m&&I.push({name:T("label_unsync-vdisks"),content:m}),Number(p)&&I.push({name:T("label_allocated"),content:(0,D.wb)(p)}),Number(f)&&I.push({name:T("label_available"),content:(0,D.wb)(f)}),Number(k)&&I.push({name:T("label_read"),content:(0,D.O4)(k)}),Number(N)&&I.push({name:T("label_write"),content:(0,D.O4)(N)}),I})(e,l):(e=>{let{NodeId:t,PDiskId:a,VSlotId:i,StoragePoolName:r}=e,n=[];return r&&n.push({name:T("label_storage-pool"),content:r}),n.push({name:T("label_node-id"),content:t??f.Pd},{name:T("label_pdisk-id"),content:a??f.Pd},{name:T("label_vslot-id"),content:i??f.Pd}),n})(e),[e,t,l]),C=u.useMemo(()=>t?(e=>{let t=[],{VDiskState:a,DonorMode:i,Severity:r}=e,n=r===s.aW.Blue;if(i){let e=s.WK.donor;t.push({id:"donor",value:T("label_donor"),theme:e.theme,icon:e.icon})}else if(n){let e=s.WK.replica;t.push({id:"replication",value:T("label_replication"),theme:e.theme,icon:e.icon})}let l=a?(0,N.J)(a):s.Ne,{theme:o,icon:d}=s.nr[l],u=a??T("label_no-data");return t.push({id:"state",value:u,theme:o,icon:d}),t})(e):[],[e,t]),E=u.useMemo(()=>t?((e,t,a)=>{if(!t)return null;let{NodeId:r,PDiskId:n,VDiskSlotId:s,StringifiedId:l}=e;if((0,h.isNil)(r)||(0,h.isNil)(n)||(0,h.isNil)(s)&&(0,h.isNil)(l))return null;let o=(0,h.isNil)(s)?void 0:(0,k.Wg)({nodeId:r,pDiskId:n,vDiskSlotId:s}),d=a?.({nodeId:r,vDiskId:l});return d?(0,i.jsxs)(c.s,{className:M("links"),wrap:"wrap",gap:2,children:[d&&(0,i.jsx)(w.K,{title:(0,j.r)("vdisk-page"),url:d,external:!1},d),o&&(0,i.jsx)(w.K,{title:(0,j.r)("developer-ui"),url:o})]}):null})(e,n,l):((e,t)=>{let{NodeId:a,PDiskId:r,VSlotId:n}=e;if(!t||(0,h.isNil)(a)||(0,h.isNil)(r)||(0,h.isNil)(n))return null;let s=(0,k.Wg)({nodeId:a,pDiskId:r,vDiskSlotId:n});return(0,i.jsx)("div",{className:M("links"),children:(0,i.jsx)(w.K,{title:"Developer UI",url:s})})})(e,n),[e,t,n,l]),R=(0,b.N4)(e=>(0,p.K)(e,o)),L=(0,h.isNil)(e.NodeId)?void 0:R?.get(e.NodeId),G=u.useMemo(()=>t&&e.PDisk&&(0,I.fX)(e.PDisk,L),[e,L,t]),_=u.useMemo(()=>t&&e.PDisk?(0,I.JT)(e.PDisk):[],[e,t]),O=u.useMemo(()=>t&&e.PDisk?(0,I.pF)(e.PDisk,n):null,[e,t,n]),W=t?e.StringifiedId:void 0,z=t?e.PDisk?.StringifiedId:void 0;return(0,i.jsxs)("div",{className:M(),children:[(0,i.jsx)(A.n,{compact:!0,title:"VDisk",titleSuffix:W??f.Pd,items:d,headerLabels:C,nameMaxWidth:100,footer:E}),G&&a&&(0,i.jsxs)(u.Fragment,{children:[(0,i.jsx)(m.c,{className:M("custom-divider")}),(0,i.jsx)(A.n,{compact:!0,title:"PDisk",titleSuffix:z??f.Pd,items:G,headerLabels:_,footer:O,nameMaxWidth:100})]})]})},L=(0,n.cn)("ydb-vdisk-component"),G=({data:e={},compact:t,inactive:a,showPopup:n,onShowPopup:u,onHidePopup:c,progressBarClassName:m,delayClose:h,delayOpen:p,withIcon:g,highlighted:f})=>{let v=(0,r.Z$)()({nodeId:e.NodeId,vDiskId:e.StringifiedId}),k=e.Severity,N=k===s.aW.Blue,S=e.DonorMode;return(0,i.jsx)(o.P,{showPopup:n,onShowPopup:u,onHidePopup:c,renderPopupContent:()=>(0,i.jsx)(R,{data:e}),offset:{mainAxis:2,crossAxis:0},delayClose:h,delayOpen:p,children:(0,i.jsx)("div",{className:L(),children:(0,i.jsx)(d.E,{to:v,className:L("content"),children:(0,i.jsx)(l.V,{diskAllocatedPercent:e.AllocatedPercent,severity:k,compact:t,inactive:a,striped:N||S,isDonor:S,className:m,withIcon:g,highlighted:f})})})})}},65153:function(e,t,a){a.d(t,{r:()=>n});var i=a(51432),r=JSON.parse('{"slot-id":"VDisk Slot Id","label_pdisk-id":"PDisk Id","pool-name":"Storage Pool Name","kind":"Kind","guid":"GUID","incarnation-guid":"Incarnation GUID","instance-guid":"Instance GUID","replication-status":"Replicated","replication-progress":"Replication Progress","replication-time-remaining":"Time Remaining","donors":"Donors","state-status":"VDisk State","space-status":"Disk Space","fresh-rank-satisfaction":"Fresh Rank Satisfaction","level-rank-satisfaction":"Level Rank Satisfaction","front-queues":"Front Queues","has-unreadable-blobs":"Has Unreadable Blobs","size":"Size","usage":"Usage","read-throughput":"Read Throughput","write-throughput":"Write Throughput","links":"Links","vdisk-page":"VDisk page","developer-ui":"Developer UI","yes":"Yes","no":"No","vdiks-title":"VDisk"}');let n=(0,i.g4)("ydb-vDisk-info",{en:r})},70073:function(e,t,a){a.d(t,{n:()=>p});var i=a(74848),r=a(96540),n=a(85169),s=a(5434),l=a(17427),o=a(66918),d=a(25247),u=a(51432),c=JSON.parse('{"no-data":"No data"}');let m=(0,u.g4)("ydb-definition-list",{en:c}),h=(0,d.cn)("ydb-definition-list");function p({title:e,titleSuffix:t,titleSeparator:a="•",headerLabels:d,iconSize:u=12,labelSize:c="xs",footer:p,items:g,compact:f,nameMaxWidth:v=220,className:k,titleClassname:N,...S}){let b=!!(e||t||d&&d.length);return(0,i.jsxs)("div",{className:h({compact:f}),children:[b?(0,i.jsxs)(n.s,{className:h("header"),justifyContent:"space-between",gap:2,alignItems:"center",children:[e&&(0,i.jsxs)(n.s,{gap:"1",alignItems:"center",children:[(0,i.jsx)("div",{className:h("title",N),children:e}),t&&(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)("div",{className:h("title-suffix"),children:a}),(0,i.jsx)("div",{className:h("title-suffix"),children:t})]})]}),d&&d.length>0&&(0,i.jsx)(n.s,{gap:1,alignItems:"center",children:d.map(e=>(0,i.jsx)(s.J,{theme:e.theme,icon:e.icon?(0,i.jsx)(l.I,{data:e.icon,size:u}):void 0,size:c,children:e.value},e.id))})]}):null,(()=>{if(g.length){let e="auto"===v?S:{...S,nameMaxWidth:v};return(0,i.jsx)(o.u,{className:h("properties-list",k),...e,children:g.map(e=>(0,i.jsx)(o.u.Item,{children:e.content,...e},e.name))})}return m("no-data")})(),p?(0,i.jsx)("div",{className:h("footer"),children:p}):null]})}},65943:function(e,t,a){a.d(t,{LD:()=>ep,pH:()=>Q,DH:()=>ed,SH:()=>el,pt:()=>em,jl:()=>K,ID:()=>et,Bg:()=>ei,OV:()=>J,Nh:()=>V,uk:()=>Y,fR:()=>ea,kv:()=>Z,qp:()=>en,b8:()=>F,Rn:()=>q,eT:()=>B,oz:()=>er,wN:()=>ec,ui:()=>eu,OX:()=>$,H:()=>eo,fr:()=>ee,iX:()=>X,Vz:()=>es,rU:()=>eh,_E:()=>H});var i=a(74848),r=a(29581),n=a(66918),s=a(33172),l=a(25247),o=a(35537),d=a(97855),u=a(14016),c=a(51630),m=a(28241),h=a(5948),p=a(29714),g=a(85169),f=a(9849),v=a(5577),k=a(15474),N=a(52705),S=a(26552);let b=.01*o.J7,x=(0,l.cn)("memory-viewer"),y=(e,t)=>[(0,f.z3)({value:e,size:"gb",withSizeLabel:!1,precision:2}),(0,f.z3)({value:t,size:"gb",withSizeLabel:!0,precision:1})];function D({stats:e,percents:t,formatValues:a,className:r,warningThreshold:s,dangerThreshold:l}){let o=e.AnonRss??(0,S.HW)(e),d=e.HardLimit,u=(0,p.D)(),c=Math.floor(parseFloat(String(o))/parseFloat(String(d))*100)||0;c=c>100?100:c;let h=o,D=d,w="/";t?(h=c+"%",D="",w=""):a&&([h,D]=a(Number(o),Number(d)));let I=(0,S.Sb)(e,Number(o)),P=(0,v.w)({fillWidth:c,warningThreshold:s,dangerThreshold:l,colorizeProgress:!0}),j=0;return(0,i.jsx)(k.P,{renderPopupContent:()=>(0,i.jsx)(n.u,{responsive:!0,children:I.map(({label:e,value:t,capacity:a,key:r})=>(0,i.jsx)(n.u.Item,{name:(0,i.jsxs)(g.s,{alignItems:"center",gap:"1",className:x("container"),children:[(0,i.jsx)("div",{className:x("legend",{type:r})}),(0,i.jsx)("div",{className:x("name"),children:e})]}),children:a?(0,i.jsx)(N.O,{value:t,capacity:a,formatValues:y,colorizeProgress:!0}):(0,f.z3)({value:t,size:"gb",withSizeLabel:!0,precision:2})},e))}),children:(0,i.jsx)("div",{className:x({theme:u,status:P},r),children:(0,i.jsxs)("div",{className:x("progress-container"),children:[I.filter(({isInfo:e})=>!e).map(e=>{var t;if(e.value<b)return null;let a=Math.max((t=e.value,o?t/parseFloat(String(d))*100:0),1),r=j;return j+=a,(0,i.jsx)("div",{className:x("segment",{type:e.key}),style:{width:`${a}%`,left:`${r}%`}},e.key)}),(0,i.jsx)(g.s,{justifyContent:"center",alignItems:"center",className:x("text"),children:(0,m.kf)(d)?`${h} ${w} ${D}`:h})]})})})}var w=a(8946),I=a(65101),P=a(93397),j=a(18016);let A=({node:e,database:t,statusForIcon:a="SystemState"})=>{if(!e.Host)return o.Pd;let r="ConnectStatus"===a?e.ConnectStatus:e.SystemState,n=!(0,I.X7)(e),s=(0,I.wH)(e)?void 0:t??e.TenantName,l=n?(0,w.vI)({id:e.NodeId,activeTab:e.TenantName?"tablets":"storage"},{database:s}):void 0;return(0,i.jsx)(P.c,{name:e.Host,status:r,path:l,hasClipboardButton:!0,infoPopoverContent:n?(0,i.jsx)(j.p,{data:e}):null})};var C=a(48649),E=a(54625),T=a(53486);let M=(0,l.cn)("tablets-statistic"),U=({tablets:e=[],database:t,nodeId:a})=>{let r=e.map(e=>({label:(0,o.bk)(e.Type),type:e.Type,count:e.Count,state:(0,T.P)(e.State)})).sort((e,t)=>String(e.label).localeCompare(String(t.label)));return(0,i.jsx)("div",{className:M(),children:r.map((e,r)=>{let n=(0,w.vI)({id:a,activeTab:"tablets"},{database:t}),s=`${e.label}: ${e.count}`,l=M("tablet",{state:e.state?.toLowerCase()});return(0,i.jsx)(E.N_,{to:n,className:l,children:s},r)})})};var R=a(9753),L=a(79092),G=a(87669),_=a(47456);function O(e){return(0,c.Xo)((0,c.Jc)(e,1))}function W(e){let t=(0,c.Jc)(e,1);return(0>=Number(t)?"":"+")+(0,c.Xo)(t)}let z=(0,l.cn)("ydb-nodes-columns");function H(){return{name:G.vg.NodeId,header:"#",width:80,resizeMinWidth:80,render:({row:e})=>e.NodeId,align:r.Ay.RIGHT}}function V({database:e}){return{name:G.vg.Host,header:G.uG.Host,render:({row:t})=>(0,i.jsx)(A,{node:t,database:e}),width:350,align:r.Ay.LEFT}}function F({database:e}){return{name:G.vg.NetworkHost,header:G.uG.NetworkHost,render:({row:t})=>(0,i.jsx)(A,{node:t,database:e,statusForIcon:"ConnectStatus"}),width:350,align:r.Ay.LEFT}}function B(){return{name:G.vg.NodeName,header:G.uG.NodeName,align:r.Ay.LEFT,render:({row:e})=>e.NodeName||o.Pd,width:200}}function Y(){return{name:G.vg.DC,header:G.uG.DC,align:r.Ay.LEFT,render:({row:e})=>e.DC||o.Pd,width:60}}function $(){return{name:G.vg.Rack,header:G.uG.Rack,align:r.Ay.LEFT,render:({row:e})=>e.Rack||o.Pd,width:100}}function J(){return{name:G.vg.PileName,header:(0,_.A)("field_pile-name"),align:r.Ay.LEFT,render:({row:e})=>e.PileName||o.Pd,width:100}}function q(){return{name:G.vg.Version,header:G.uG.Version,width:200,align:r.Ay.LEFT,render:({row:e})=>(0,i.jsx)(h.s,{content:e.Version,children:e.Version})}}function K(){return{name:G.vg.Uptime,header:G.uG.Uptime,sortAccessor:({StartTime:e})=>e?-e:0,render:({row:e})=>(0,i.jsx)(R.p,{StartTime:e.StartTime,DisconnectTime:e.DisconnectTime}),align:r.Ay.RIGHT,width:120}}function Q(){return{name:G.vg.RAM,header:G.uG.RAM,sortAccessor:({MemoryUsed:e=0})=>Number(e),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>{let[t,a]=(0,d.j9)((0,m.kf)(e.MemoryUsed)?Number(e.MemoryUsed):void 0,(0,m.kf)(e.MemoryLimit)?Number(e.MemoryLimit):void 0,"gb",void 0,!0),r=t||a;return(0,i.jsx)(h.s,{placement:["top","bottom"],fullWidth:!0,disabled:!r,content:(0,i.jsxs)(n.u,{responsive:!0,children:[t&&(0,i.jsx)(n.u.Item,{name:(0,_.A)("field_memory-used"),children:t}),a&&(0,i.jsx)(n.u.Item,{name:(0,_.A)("field_memory-limit"),children:a})]}),children:(0,i.jsx)(N.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:(e,t)=>(0,d.j9)(e,t,"gb",void 0,!0),className:z("column-ram"),colorizeProgress:!0,hideCapacity:!0})})},align:r.Ay.LEFT,width:80,resizeMinWidth:40}}function X(){return{name:G.vg.Memory,header:G.uG.Memory,defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.MemoryStats?(0,i.jsx)(D,{formatValues:d.vX,stats:e.MemoryStats}):(0,i.jsx)(N.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:d.vX,colorizeProgress:!0}),align:r.Ay.LEFT,width:300,resizeMinWidth:170}}function Z(){return{name:G.vg.Pools,header:G.uG.Pools,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map(({Usage:e})=>Number(e))),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.PoolStats?(0,i.jsx)(C._,{pools:e.PoolStats}):o.Pd,align:r.Ay.LEFT,width:80,resizeMinWidth:60}}function ee(){return{name:G.vg.CPU,header:G.uG.CPU,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map(({Usage:e})=>Number(e))),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>{let t=(0,m.kf)(e.CoresUsed)&&(0,m.kf)(e.CoresTotal)?e.CoresUsed/e.CoresTotal:void 0;if(void 0===t&&e.PoolStats){let a=0;t=e.PoolStats.reduce((e,t)=>(a+=Number(t.Threads),e+Number(t.Usage)*Number(t.Threads)),0)/a}return(0,i.jsx)(h.s,{placement:["top","bottom"],fullWidth:!0,disabled:!e.PoolStats,content:(0,i.jsx)(n.u,{responsive:!0,children:e.PoolStats?.map(e=>(0,m.kf)(e.Usage)?(0,i.jsx)(n.u.Item,{name:e.Name,children:(0,j.Qz)("Usage",e.Usage).value},e.Name):null)}),children:(0,i.jsx)(N.O,{className:z("column-cpu"),value:t,capacity:1,colorizeProgress:!0,percents:!0})})},align:r.Ay.LEFT,width:80,resizeMinWidth:40}}function et(){return{name:G.vg.LoadAverage,header:G.uG.LoadAverage,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:r.Ay.DESCENDING,render:({row:e})=>(0,i.jsx)(N.O,{value:e.LoadAveragePercents&&e.LoadAveragePercents.length>0?e.LoadAveragePercents[0]:void 0,percents:!0,colorizeProgress:!0,capacity:100}),align:r.Ay.LEFT,width:170,resizeMinWidth:170}}function ea(){return{name:G.vg.Load,header:G.uG.Load,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.LoadAveragePercents&&e.LoadAveragePercents.length>0?(0,i.jsx)(L.U,{value:e.LoadAveragePercents[0].toFixed(),theme:(0,u.f)(e.LoadAveragePercents[0])}):o.Pd,align:r.Ay.LEFT,width:80,resizeMinWidth:70}}function ei(){return{name:G.vg.DiskSpaceUsage,header:G.uG.DiskSpaceUsage,render:({row:e})=>(0,s.f8)(e.DiskSpaceUsage)?(0,i.jsx)(L.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,u.f)(e.DiskSpaceUsage)}):o.Pd,align:r.Ay.LEFT,width:115,resizeMinWidth:75}}function er(){return{name:G.vg.TotalSessions,header:G.uG.TotalSessions,render:({row:e})=>e.TotalSessions??o.Pd,align:r.Ay.RIGHT,width:100}}function en({database:e}){return{name:G.vg.Tablets,header:G.uG.Tablets,width:500,resizeMinWidth:500,render:({row:t})=>t.Tablets?(0,i.jsx)(U,{database:e??t.TenantName,nodeId:t.NodeId,tablets:t.Tablets}):o.Pd,align:r.Ay.LEFT,sortable:!1}}function es(){return{name:G.vg.Missing,header:G.uG.Missing,render:({row:e})=>e.Missing,align:r.Ay.CENTER,defaultOrder:r.Ay.DESCENDING,width:100}}function el(){return{name:G.vg.Connections,header:G.uG.Connections,render:({row:e})=>(0,m.kf)(e.Connections)?e.Connections:o.Pd,align:r.Ay.RIGHT,width:130}}function eo(){return{name:G.vg.NetworkUtilization,header:G.uG.NetworkUtilization,render:({row:e})=>{let{NetworkUtilization:t,NetworkUtilizationMin:a=0,NetworkUtilizationMax:r=0}=e;return(0,m.kf)(t)?(0,i.jsx)(h.s,{placement:["top","bottom"],content:(0,i.jsxs)(n.u,{responsive:!0,children:[(0,i.jsx)(n.u.Item,{name:(0,_.A)("sum"),children:(0,d.l9)(t)},"NetworkUtilization"),(0,i.jsx)(n.u.Item,{name:(0,_.A)("min"),children:(0,d.l9)(a)},"NetworkUtilizationMin"),(0,i.jsx)(n.u.Item,{name:(0,_.A)("max"),children:(0,d.l9)(r)},"NetworkUtilizationMax")]}),children:(0,d.l9)(t)}):o.Pd},align:r.Ay.RIGHT,width:110}}function ed(){return{name:G.vg.SendThroughput,header:G.uG.SendThroughput,render:({row:e})=>(0,m.kf)(e.SendThroughput)?(0,m.O4)(e.SendThroughput,1):o.Pd,align:r.Ay.RIGHT,width:110}}function eu(){return{name:G.vg.ReceiveThroughput,header:G.uG.ReceiveThroughput,render:({row:e})=>(0,m.kf)(e.ReceiveThroughput)?(0,m.O4)(e.ReceiveThroughput,1):o.Pd,align:r.Ay.RIGHT,width:110}}function ec(){return{name:G.vg.PingTime,header:G.uG.PingTime,render:({row:e})=>{let{PingTimeUs:t,PingTimeMinUs:a=0,PingTimeMaxUs:r=0}=e;return(0,m.kf)(t)?(0,i.jsx)(h.s,{placement:["top","bottom"],content:(0,i.jsxs)(n.u,{responsive:!0,children:[(0,i.jsx)(n.u.Item,{name:(0,_.A)("avg"),children:O(t)},"PingTimeUs"),(0,i.jsx)(n.u.Item,{name:(0,_.A)("min"),children:O(a)},"PingTimeMinUs"),(0,i.jsx)(n.u.Item,{name:(0,_.A)("max"),children:O(r)},"PingTimeMaxUs")]}),children:O(t)}):o.Pd},align:r.Ay.RIGHT,width:110}}function em(){return{name:G.vg.ClockSkew,header:G.uG.ClockSkew,render:({row:e})=>{let{ClockSkewUs:t,ClockSkewMinUs:a=0,ClockSkewMaxUs:r=0}=e;return(0,m.kf)(t)?(0,i.jsx)(h.s,{placement:["top","bottom"],content:(0,i.jsxs)(n.u,{responsive:!0,children:[(0,i.jsx)(n.u.Item,{name:(0,_.A)("avg"),children:W(t)},"ClockSkewUs"),(0,i.jsx)(n.u.Item,{name:(0,_.A)("min"),children:W(a)},"ClockSkewMinUs"),(0,i.jsx)(n.u.Item,{name:(0,_.A)("max"),children:W(r)},"ClockSkewMaxUs")]}),children:W(t)}):o.Pd},align:r.Ay.RIGHT,width:110}}function eh(){return{name:G.vg.ClockSkew,header:G.uG.ClockSkew,align:r.Ay.RIGHT,width:110,resizeMinWidth:90,render:({row:e})=>(0,m.kf)(e.ClockSkewUs)?(0,c.Xo)((0,c.Jc)(e.ClockSkewUs,1)):o.Pd}}function ep(){return{name:G.vg.PingTime,header:G.uG.PingTime,align:r.Ay.RIGHT,width:110,resizeMinWidth:90,render:({row:e})=>(0,m.kf)(e.PingTimeUs)?(0,c.Xo)((0,c.Jc)(e.PingTimeUs)):o.Pd}}},87669:function(e,t,a){a.d(t,{fN:()=>h,kU:()=>g,kn:()=>m,ri:()=>d,sp:()=>f,uG:()=>u,vg:()=>n,xd:()=>l,zO:()=>r});var i=a(47456);let r="nodesTableColumnsWidth",n={NodeId:"NodeId",Host:"Host",NetworkHost:"NetworkHost",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"RAM",CPU:"CPU",Pools:"Pools",LoadAverage:"LoadAverage",Load:"Load",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:"TotalSessions",Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:"Tablets",PDisks:"PDisks",PileName:"PileName"},s=["Pools","Memory"];function l(e){return s.includes(e)}let o=["LoadAverage","PDisks"];function d(e){return o.some(t=>t===e)}let u={get NodeId(){return(0,i.A)("node-id")},get Host(){return(0,i.A)("host")},get NetworkHost(){return(0,i.A)("host")},get Database(){return(0,i.A)("database")},get NodeName(){return(0,i.A)("node-name")},get DC(){return(0,i.A)("dc")},get Rack(){return(0,i.A)("rack")},get Version(){return(0,i.A)("version")},get Uptime(){return(0,i.A)("uptime")},get Memory(){return(0,i.A)("memory")},get RAM(){return(0,i.A)("ram")},get Pools(){return(0,i.A)("pools")},get CPU(){return(0,i.A)("cpu")},get LoadAverage(){return(0,i.A)("load-average")},get Load(){return(0,i.A)("load")},get DiskSpaceUsage(){return(0,i.A)("disk-usage")},get TotalSessions(){return(0,i.A)("sessions")},get Connections(){return(0,i.A)("connections")},get NetworkUtilization(){return(0,i.A)("utilization")},get SendThroughput(){return(0,i.A)("send")},get ReceiveThroughput(){return(0,i.A)("receive")},get PingTime(){return(0,i.A)("ping")},get ClockSkew(){return(0,i.A)("skew")},get Missing(){return(0,i.A)("missing")},get Tablets(){return(0,i.A)("tablets")},get PDisks(){return(0,i.A)("pdisks")},get PileName(){return(0,i.A)("field_pile-name")}},c={get NodeId(){return(0,i.A)("node-id")},get Host(){return(0,i.A)("host")},get NodeName(){return(0,i.A)("node-name")},get Database(){return(0,i.A)("database")},get DiskSpaceUsage(){return(0,i.A)("disk-usage")},get DC(){return(0,i.A)("dc")},get Rack(){return(0,i.A)("rack")},get Missing(){return(0,i.A)("missing")},get Uptime(){return(0,i.A)("uptime")},get Version(){return(0,i.A)("version")},get SystemState(){return(0,i.A)("system-state")},get ConnectStatus(){return(0,i.A)("connect-status")},get NetworkUtilization(){return(0,i.A)("network-utilization")},get ClockSkew(){return(0,i.A)("clock-skew")},get PingTime(){return(0,i.A)("ping-time")},get PileName(){return(0,i.A)("field_pile-name")}};function m(e){return c[e]}let h={NodeId:["NodeId"],Host:["Host","Rack","Database","SystemState"],NetworkHost:["Host","Rack","Database","SystemState","ConnectStatus"],Database:["Database"],NodeName:["NodeName"],DC:["DC"],Rack:["Rack"],Version:["Version"],Uptime:["Uptime","DisconnectTime"],Memory:["Memory","MemoryDetailed"],RAM:["Memory"],Pools:["CPU"],CPU:["CPU"],LoadAverage:["LoadAverage"],Load:["LoadAverage"],DiskSpaceUsage:["DiskSpaceUsage"],TotalSessions:["SystemState"],Connections:["Connections"],NetworkUtilization:["NetworkUtilization"],SendThroughput:["SendThroughput"],ReceiveThroughput:["ReceiveThroughput"],PingTime:["PingTime"],ClockSkew:["ClockSkew"],Missing:["Missing"],Tablets:["Tablets","Database"],PDisks:["PDisks"],PileName:["PileName"]},p={NodeId:"NodeId",Host:"Host",NetworkHost:"Host",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"Memory",CPU:"CPU",Pools:"CPU",LoadAverage:"LoadAverage",Load:"LoadAverage",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:void 0,Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:void 0,PDisks:void 0,PileName:void 0};function g(e){return p[e]}function f(e){return!!p[e]}},47456:function(e,t,a){a.d(t,{A:()=>n});var i=a(51432),r=JSON.parse('{"node-id":"Node ID","host":"Host","database":"Database","node-name":"Node Name","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Detailed Memory","ram":"RAM","cpu":"CPU","pools":"Pools","disk-usage":"Disk Usage","tablets":"Tablets","load-average":"Load Average","load":"Load","sessions":"Sessions","missing":"Missing","pdisks":"PDisks","field_memory-used":"Memory used","field_memory-limit":"Memory limit","field_pile-name":"Pile Name","system-state":"System State","connect-status":"Connect Status","utilization":"Utilization","network-utilization":"Network Utilization","connections":"Connections","clock-skew":"Clock Skew","skew":"Skew","ping-time":"Ping Time","ping":"Ping","send":"Send","receive":"Receive","max":"Max","min":"Min","avg":"Avg","sum":"Sum"}');let n=(0,i.g4)("ydb-nodes-columns",{en:r})},28504:function(e,t,a){a.d(t,{E:()=>v});var i=a(74848),r=a(96540),n=a(2543),s=a(50504),l=a(15474),o=a(15749),d=a(78331),u=a(80184),c=a(8946),m=a(25247),h=a(9263),p=a(37296),g=a(96099);let f=(0,m.cn)("pdisk-storage"),v=({data:e={},vDisks:t,showPopup:a,onShowPopup:m,onHidePopup:v,className:k,progressBarClassName:N,viewContext:S,width:b,delayOpen:x=p.s,delayClose:y=p.s,withIcon:D,highlighted:w,highlightedDisk:I,setHighlightedDisk:P})=>{let j,{NodeId:A,PDiskId:C}=e,E=!(0,n.isNil)(A)&&!(0,n.isNil)(C),T=r.useRef(null);return E&&(j=(0,c.Ck)(C,A)),(0,i.jsxs)("div",{className:f(null,k),ref:T,style:{width:b},children:[t?.length?(0,i.jsx)("div",{className:f("vdisks"),children:t.map(e=>{let t=e.StringifiedId,a=I===t;return(0,i.jsx)("div",{className:f("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,i.jsx)(u.y,{withIcon:D,data:e,inactive:!(0,g.OH)(e,S),compact:!0,delayOpen:x,delayClose:y,showPopup:a,onShowPopup:()=>P?.(t),onHidePopup:()=>P?.(void 0),highlighted:a})},t)})}):null,(0,i.jsx)(l.P,{showPopup:a,offset:{mainAxis:2,crossAxis:0},anchorRef:T,onShowPopup:m,onHidePopup:v,renderPopupContent:()=>(0,i.jsx)(d.Oy,{data:e}),delayOpen:x,delayClose:y,children:(0,i.jsx)(o.E,{to:j,className:f("content"),children:(0,i.jsx)(s.V,{withIcon:D,diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,className:N,highlighted:w,noDataPlaceholder:(0,h.A)("no-data")})})})]})}},25041:function(e,t,a){a.d(t,{z:()=>eA});var i=a(74848),r=a(88831),n=a(96540),s=a(42724),l=a(1459),o=a(22708),d=a(2837),u=a(4283),c=a(14476);let m=c.z.nativeEnum(u.r).catch(u.r.all),h=c.z.nativeEnum(u.G).catch(u.G.groups);var p=a(61738),g=a(65101),f=a(38512),v=a(87669);let k=["NodeId","Host","Uptime","CPU","RAM","PDisks"],N=["NodeId"],S=["Host","DC","Rack","Version","Uptime","Missing","DiskSpaceUsage"],b=S.map(e=>({value:e,content:(0,v.kn)(e)})),x=c.z.custom(e=>S.includes(e)).catch(void 0),y={groups:"groupsSearch",nodes:"nodesSearch"};function D(){let[e,t]=(0,o.useQueryParams)({type:o.StringParam,visible:o.StringParam,groupsSearch:o.StringParam,nodesSearch:o.StringParam,search:o.StringParam,uptimeFilter:o.StringParam,storageNodesGroupBy:o.StringParam,storageGroupsGroupBy:o.StringParam}),[a,i]=(0,p.iK)(d.GS.STORAGE_TYPE,u.G.groups),r=h.parse(e.type),s=m.parse(e.visible),l=e.groupsSearch??"",c=e.nodesSearch??"",v=g.Bm.parse(e.uptimeFilter),k=f.kY.parse(e.storageGroupsGroupBy),N=x.parse(e.storageNodesGroupBy);n.useEffect(()=>{if(e.search){let a={search:void 0};a[y[r]]=e.search,t(a,"replaceIn")}},[e.search,r,t]);let S=e=>{t({visible:e},"replaceIn")},b=n.useCallback(e=>{t({type:e},"replaceIn"),i(e)},[t,i]),D=e=>{t({uptimeFilter:e},"replaceIn")};return{storageType:r,visibleEntities:s,groupsSearchValue:l,nodesSearchValue:c,nodesUptimeFilter:v,storageGroupsGroupByParam:k,storageNodesGroupByParam:N,handleTextFilterGroupsChange:e=>{t({groupsSearch:e||void 0},"replaceIn")},handleTextFilterNodesChange:e=>{t({nodesSearch:e||void 0},"replaceIn")},handleVisibleEntitiesChange:S,handleStorageTypeChange:b,handleUptimeFilterChange:D,handleStorageGroupsGroupByParamChange:e=>{t({storageGroupsGroupBy:e},"replaceIn")},handleStorageNodesGroupByParamChange:e=>{t({storageNodesGroupBy:e},"replaceIn")},handleShowAllGroups:()=>{S("all")},handleShowAllNodes:()=>{S("all"),D("All")}}}var w=a(73232),I=a(41254),P=a(31596),j=a(65615),A=a(282),C=a(74104),E=a(78799),T=a(49745);let M=({visibleEntities:e,onShowAll:t})=>{let a;return(e===u.r.space&&(a=(0,T.A)("empty.out_of_space")),e===u.r.missing&&(a=(0,T.A)("empty.degraded")),a)?(0,i.jsx)(E.U,{title:a,showAll:(0,T.A)("show_all"),onShowAll:t}):null};var U=a(2230),R=a(33583),L=a(36712);let G=({columns:e,database:t,nodeId:a,groupId:r,pDiskId:o,filterGroup:d,filterGroupBy:c,searchValue:m,visibleEntities:h,onShowAll:p,scrollContainerRef:g,renderErrorMessage:v,initialEntitiesCount:k})=>{var N;let S=(0,l.Pm)(),b=(N=(0,l.YA)(),n.useCallback(async e=>{let{limit:t,offset:a,sortParams:i,filters:r,columnsIds:n}=e,{sortOrder:s,columnId:l}=i??{},{searchValue:o,visibleEntities:d,database:u,nodeId:c,groupId:m,pDiskId:h,filterGroup:p,filterGroupBy:g}=r??{},v=(0,f.GP)(l),k=v?(0,R.T)(v,s):void 0,S=(0,L.R)(n,f.YX),{groups:b,found:x,total:y}=await (0,U.t)({limit:t,offset:a,sort:k,filter:o,with:d,database:u,nodeId:c,groupId:m,pDiskId:h,filter_group:p,filter_group_by:g,fieldsRequired:S,shouldUseGroupsHandler:N});return{data:b||[],found:x||0,total:y||0}},[N])),x=n.useMemo(()=>({searchValue:m,visibleEntities:h,database:t,nodeId:a,groupId:r,pDiskId:o,filterGroup:d,filterGroupBy:c}),[m,h,t,a,r,o,d,c]);return(0,i.jsx)(s.r,{loading:!S,children:(0,i.jsx)(C.k5,{columnsWidthLSKey:f.qK,scrollContainerRef:g,columns:e,fetchData:b,initialEntitiesCount:k,renderErrorMessage:v,renderEmptyDataMessage:()=>h!==u.r.all?(0,i.jsx)(M,{onShowAll:p,visibleEntities:h}):(0,T.A)("empty.default"),filters:x,tableName:C.qr.STORAGE_GROUPS})})};var _=a(33702),O=a(15491);function W({visibleEntities:e,viewContext:t}){let a=(0,r.X)(),i=(0,r.b)(),s=(0,l.Z9)(),o=n.useMemo(()=>{let e=(0,O.J)({viewContext:t}),r=s?e:e.filter(e=>e.name!==f.UW.PileName);if(a)return r;let n=r.filter(e=>!(0,f.Ai)(e.name));return i?n:n.filter(e=>!(0,f.RY)(e.name))},[a,t,i,s]),d=n.useMemo(()=>e===u.r.missing?[...f.LO,f.UW.Degraded]:e===u.r.space?[...f.LO,f.UW.DiskSpace]:f.LO,[e]),c=n.useMemo(()=>s?f.hu.includes(f.UW.PileName)?f.hu:[...f.hu,f.UW.PileName]:f.hu,[s]);return(0,_.K)(o,f.zY,f.H6,c,d)}var z=a(51670),H=a(4627),V=a(9263),F=a(37296),B=a(77269),Y=a(43834),$=a(53211),J=a(12623),q=a(29472),K=a(81392);let Q={[u.G.groups]:"Groups",[u.G.nodes]:"Nodes"},X=({value:e,onChange:t})=>(0,i.jsxs)(K.x,{value:e,onUpdate:t,qa:"storage-type-filter",children:[(0,i.jsx)(K.x.Option,{value:u.G.groups,children:Q[u.G.groups]}),(0,i.jsx)(K.x.Option,{value:u.G.nodes,children:Q[u.G.nodes]})]}),Z={[u.r.all]:"All",[u.r.missing]:"Degraded",[u.r.space]:"Out of Space"},ee=({value:e,onChange:t})=>(0,i.jsxs)(K.x,{value:e,onUpdate:t,qa:"storage-visible-entities-filter",children:[(0,i.jsx)(K.x.Option,{value:u.r.missing,children:Z[u.r.missing]}),(0,i.jsx)(K.x.Option,{value:u.r.space,children:Z[u.r.space]}),(0,i.jsx)(K.x.Option,{value:u.r.all,children:Z[u.r.all]})]});function et({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a,entitiesCountTotal:s,entitiesLoading:o}){let{groupsSearchValue:d,storageType:u,visibleEntities:c,storageGroupsGroupByParam:m,handleTextFilterGroupsChange:h,handleStorageTypeChange:p,handleVisibleEntitiesChange:g,handleStorageGroupsGroupByParamChange:v}=D(),k=(0,r.X)(),N=(0,l.Z9)(),S=n.useMemo(()=>N?f.SE:f.SE.filter(e=>"PileName"!==e.value),[N]);return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(q.v,{value:d,onChange:h,placeholder:(0,V.A)("controls_groups-search-placeholder"),className:(0,F.b)("search")}),e&&k&&(0,i.jsx)(X,{value:u,onChange:p}),t?null:(0,i.jsx)(ee,{value:c,onChange:g}),t?(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(B.E,{variant:"body-2",children:(0,V.A)("controls_group-by-placeholder")}),(0,i.jsx)(Y.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:m?[m]:void 0,onUpdate:e=>{v(e[0])},options:S})]}):null,(0,i.jsx)($.T,{label:(0,V.A)("groups"),loading:o,total:s,current:a})]})}function ea({withTypeSelector:e,withGroupBySelect:t}){let{tableState:a}=(0,J.WV)();return(0,i.jsx)(et,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a.foundEntities,entitiesCountTotal:a.totalEntities,entitiesLoading:a.isInitialLoad})}let ei=n.memo(function({name:e,count:t,isExpanded:a,database:r,nodeId:n,groupId:s,pDiskId:l,searchValue:o,scrollContainerRef:d,filterGroupBy:u,columns:c,onIsExpandedChange:m,handleShowAllGroups:h}){return(0,i.jsx)(z.Q,{title:e,count:t,entityName:(0,V.A)("groups"),expanded:a,onIsExpandedChange:m,children:(0,i.jsx)(I.o,{initialState:{sortParams:void 0},table:(0,i.jsx)(G,{database:r,scrollContainerRef:d,nodeId:n,groupId:s,pDiskId:l,filterGroup:e,filterGroupBy:u,searchValue:o,visibleEntities:"all",onShowAll:h,renderErrorMessage:A.$,columns:c,initialEntitiesCount:t}),tableWrapperProps:{scrollContainerRef:d}})},e)});function er({database:e,nodeId:t,groupId:a,pDiskId:r,scrollContainerRef:s,viewContext:l}){let[o]=(0,p.Nt)(),{groupsSearchValue:d,storageGroupsGroupByParam:u,visibleEntities:c,handleShowAllGroups:m}=D(),{columnsToShow:h,columnsToSelect:g,setColumns:f}=W({visibleEntities:c,viewContext:l}),{currentData:v,isFetching:k,error:N}=j.S.useGetStorageGroupsInfoQuery({database:e,with:"all",nodeId:t,groupId:a,pDiskId:r,filter:d,shouldUseGroupsHandler:!0,group:u},{pollingInterval:o}),S=void 0===v&&k,{tableGroups:b,found:x=0,total:y=0}=v||{},{expandedGroups:A,setIsGroupExpanded:C}=(0,H.$)(b),E=n.useMemo(()=>({foundEntities:x,totalEntities:y,isInitialLoad:S,sortParams:void 0}),[x,y,S]);return(0,i.jsx)(I.o,{controls:(0,i.jsx)(et,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:x,entitiesCountTotal:y,entitiesLoading:S}),extraControls:(0,i.jsx)(P.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:f}),error:N?(0,i.jsx)(w.o,{error:N}):null,table:b?.length?b.map(({name:n,count:l})=>{let o=A[n];return(0,i.jsx)(ei,{name:n,count:l,isExpanded:o,database:e,nodeId:t,groupId:a,pDiskId:r,filterGroupBy:u,searchValue:d,visibleEntities:"all",scrollContainerRef:s,onIsExpandedChange:C,handleShowAllGroups:m,columns:h},n)}):(0,V.A)("no-groups"),initialState:E,tableWrapperProps:{scrollContainerRef:s,scrollDependencies:[d,u,b],loading:S,className:(0,F.b)("groups-wrapper")}})}function en({database:e,nodeId:t,groupId:a,pDiskId:r,viewContext:n,scrollContainerRef:s,initialEntitiesCount:o}){let{groupsSearchValue:d,visibleEntities:u,handleShowAllGroups:c}=D(),m=(0,l.SA)(),{columnsToShow:h,columnsToSelect:p,setColumns:g}=W({visibleEntities:u,viewContext:n});return(0,i.jsx)(I.o,{controls:(0,i.jsx)(ea,{withTypeSelector:!0,withGroupBySelect:m}),extraControls:(0,i.jsx)(P.O,{popupWidth:200,items:p,showStatus:!0,onUpdate:g}),table:(0,i.jsx)(G,{database:e,nodeId:t,groupId:a,pDiskId:r,searchValue:d,visibleEntities:u,onShowAll:c,scrollContainerRef:s,renderErrorMessage:A.$,columns:h,initialEntitiesCount:o}),tableWrapperProps:{scrollContainerRef:s,scrollDependencies:[d,u]}})}function es(e){let{storageGroupsGroupByParam:t,visibleEntities:a,handleShowAllGroups:r}=D(),o=(0,l.Pm)(),d=(0,l.SA)();return n.useEffect(()=>{d&&"all"!==a&&r()},[r,d,a]),(0,i.jsx)(s.r,{loading:!o,children:d&&t?(0,i.jsx)(er,{...e}):(0,i.jsx)(en,{...e})})}var el=a(67103),eo=a(25247),ed=a(51432),eu=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),ec=JSON.parse('{"empty.default":"Нет узлов","empty.out_of_space":"Нет узлов, в которых кончается место","empty.degraded":"Нет деградировавших узлов","empty.small_uptime":"Нет узлов с uptime < 1h","empty.several_filters":"Нет узлов, подходящих под текущие фильтры","show_all":"Показать все узлы"}');let em=(0,ed.g4)("ydb-storage-nodes",{ru:ec,en:eu}),eh=({visibleEntities:e,nodesUptimeFilter:t,onShowAll:a})=>{let r;return(e===u.r.space&&(r=em("empty.out_of_space")),e===u.r.missing&&(r=em("empty.degraded")),"SmallUptime"===t&&(r=em("empty.small_uptime")),e!==u.r.all&&"All"!==t&&(r=em("empty.several_filters")),r)?(0,i.jsx)(E.U,{title:r,showAll:em("show_all"),onShowAll:a}):null};var ep=a(58405);let eg=async e=>{let{type:t="static",storage:a=!0,limit:i,offset:r,sortParams:n,filters:s,columnsIds:l}=e,{searchValue:o,nodesUptimeFilter:d,visibleEntities:u,database:c,nodeId:m,groupId:h,filterGroup:p,filterGroupBy:f}=s??{},{sortOrder:k,columnId:N}=n??{},S=(0,v.kU)(N),b=S?(0,R.T)(S,k):void 0,x=(0,L.R)(l,v.fN),y=await window.api.viewer.getNodes({type:t,storage:a,limit:i,offset:r,sort:b,filter:o,uptime:(0,g.Fo)(d),with:u,database:c,node_id:m,group_id:h,filter_group:p,filter_group_by:f,fieldsRequired:x}),D=(0,ep.rz)(y);return{data:D.nodes||[],found:D.found||0,total:D.total||0,columnsSettings:D.columnsSettings}},ef=(0,eo.cn)("ydb-storage-nodes"),ev=e=>ef("node",{unavailable:(0,g.X7)(e)}),ek=({columns:e,database:t,nodeId:a,groupId:r,filterGroup:s,filterGroupBy:l,searchValue:o,visibleEntities:d,nodesUptimeFilter:c,onShowAll:m,scrollContainerRef:h,renderErrorMessage:p,initialEntitiesCount:g,onDataFetched:f})=>{let v=n.useMemo(()=>({searchValue:o,visibleEntities:d,nodesUptimeFilter:c,database:t,nodeId:a,groupId:r,filterGroup:s,filterGroupBy:l}),[o,d,c,t,a,r,s,l]);return(0,i.jsx)(C.k5,{columnsWidthLSKey:"storageNodesColumnsWidth",scrollContainerRef:h,columns:e,fetchData:eg,rowHeight:51,initialEntitiesCount:g,renderErrorMessage:p,renderEmptyDataMessage:()=>d!==u.r.all||"All"!==c?(0,i.jsx)(eh,{onShowAll:m,nodesUptimeFilter:c,visibleEntities:d}):em("empty.default"),getRowClassName:ev,filters:v,tableName:C.qr.STORAGE_NODES,onDataFetched:f})};var eN=a(96099),eS=a(92961);function eb({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a,entitiesCountTotal:r,entitiesLoading:s}){let{nodesSearchValue:l,storageType:o,visibleEntities:d,nodesUptimeFilter:u,storageNodesGroupByParam:c,handleTextFilterNodesChange:m,handleStorageTypeChange:h,handleVisibleEntitiesChange:p,handleUptimeFilterChange:g,handleStorageNodesGroupByParamChange:f}=D();return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(q.v,{value:l,onChange:m,placeholder:(0,V.A)("controls_nodes-search-placeholder"),className:(0,F.b)("search")}),e&&(0,i.jsx)(X,{value:o,onChange:h}),t?null:(0,i.jsx)(ee,{value:d,onChange:p}),t?null:(0,i.jsx)(eS.j,{value:u,onChange:g}),t?(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(B.E,{variant:"body-2",children:(0,V.A)("controls_group-by-placeholder")}),(0,i.jsx)(Y.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:c?[c]:void 0,onUpdate:e=>{f(e[0])},options:b})]}):null,(0,i.jsx)($.T,{label:(0,V.A)("nodes"),loading:s,total:r,current:a})]})}function ex({withTypeSelector:e,withGroupBySelect:t}){let{tableState:a}=(0,J.WV)();return(0,i.jsx)(eb,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a.foundEntities,entitiesCountTotal:a.totalEntities,entitiesLoading:a.isInitialLoad})}var ey=a(40159);function eD({database:e,viewContext:t,columnsSettings:a}){let{visibleEntities:i}=D();return function({visibleEntities:e,database:t,viewContext:a,columnsSettings:i}){let r=(0,l.Z9)(),s=n.useMemo(()=>{let e=(0,ey.C)({database:t,viewContext:a,columnsSettings:i});return r?e:e.filter(e=>e.name!==v.vg.PileName)},[t,a,i,r]),o=n.useMemo(()=>e===u.r.missing?[...N,v.vg.Missing]:N,[e]),d=n.useMemo(()=>r?k.includes(v.vg.PileName)?k:[...k,v.vg.PileName]:k,[r]);return(0,_.K)(s,"storageNodesSelectedColumns",v.uG,d,o)}({visibleEntities:i,database:e,viewContext:t,columnsSettings:a})}let ew=n.memo(function({name:e,count:t,isExpanded:a,database:r,nodeId:n,groupId:s,searchValue:l,scrollContainerRef:o,filterGroupBy:d,columns:u,onIsExpandedChange:c,handleShowAllNodes:m,onDataFetched:h}){return(0,i.jsx)(z.Q,{title:e,count:t,entityName:(0,V.A)("nodes"),expanded:a,onIsExpandedChange:c,children:(0,i.jsx)(I.o,{initialState:{sortParams:void 0},table:(0,i.jsx)(ek,{database:r,scrollContainerRef:o,nodeId:n,groupId:s,filterGroup:e,filterGroupBy:d,searchValue:l,visibleEntities:"all",nodesUptimeFilter:"All",onShowAll:m,renderErrorMessage:A.$,columns:u,initialEntitiesCount:t,onDataFetched:h}),tableWrapperProps:{scrollContainerRef:o}})},e)});function eI({database:e,groupId:t,nodeId:a,viewContext:r,scrollContainerRef:s}){let[l]=(0,p.Nt)(),{nodesSearchValue:o,storageNodesGroupByParam:d,handleShowAllNodes:u}=D(),{handleDataFetched:c,columnsSettings:m}=(0,eN.fj)(),{columnsToShow:h,columnsToSelect:g,setColumns:f}=eD({database:e,viewContext:r,columnsSettings:m}),{currentData:v,isFetching:k,error:N}=j.S.useGetStorageNodesInfoQuery({database:e,with:"all",filter:o,node_id:a,group_id:t,group:d},{pollingInterval:l}),S=void 0===v&&k,{tableGroups:b,found:x=0,total:y=0}=v||{},{expandedGroups:w,setIsGroupExpanded:A}=(0,H.$)(b),C=n.useMemo(()=>({foundEntities:x,totalEntities:y,isInitialLoad:S,sortParams:void 0}),[x,y,S]);return(0,i.jsx)(I.o,{controls:(0,i.jsx)(eb,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:x,entitiesCountTotal:y,entitiesLoading:S}),extraControls:(0,i.jsx)(P.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:f}),error:N?(0,i.jsx)(el.o,{error:N}):null,table:b?.length?b.map(({name:r,count:n})=>{let l=w[r];return(0,i.jsx)(ew,{name:r,count:n,isExpanded:l,database:e,nodeId:a,groupId:t,searchValue:o,visibleEntities:"all",filterGroupBy:d,scrollContainerRef:s,onIsExpandedChange:A,handleShowAllNodes:u,columns:h,onDataFetched:c},r)}):(0,V.A)("no-nodes"),initialState:C,tableWrapperProps:{scrollContainerRef:s,scrollDependencies:[o,d,b],loading:S,className:(0,F.b)("groups-wrapper")}})}function eP({database:e,nodeId:t,groupId:a,viewContext:r,scrollContainerRef:n,initialEntitiesCount:s}){let{nodesSearchValue:o,visibleEntities:d,nodesUptimeFilter:u,handleShowAllNodes:c}=D(),m=(0,l.Ye)(),{handleDataFetched:h,columnsSettings:p}=(0,eN.fj)(),{columnsToShow:g,columnsToSelect:f,setColumns:v}=eD({database:e,viewContext:r,columnsSettings:p});return(0,i.jsx)(I.o,{controls:(0,i.jsx)(ex,{withTypeSelector:!0,withGroupBySelect:m}),extraControls:(0,i.jsx)(P.O,{popupWidth:200,items:f,showStatus:!0,onUpdate:v}),table:(0,i.jsx)(ek,{database:e,nodeId:t,groupId:a,searchValue:o,visibleEntities:d,nodesUptimeFilter:u,onShowAll:c,scrollContainerRef:n,renderErrorMessage:A.$,columns:g,initialEntitiesCount:s,onDataFetched:h}),tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[o,d,u]}})}function ej(e){let{storageNodesGroupByParam:t,visibleEntities:a,nodesUptimeFilter:r,handleShowAllNodes:o}=D(),d=(0,l.Pm)(),u=(0,l.Ye)();return n.useEffect(()=>{u&&("all"!==a||"All"!==r)&&o()},[o,r,u,a]),(0,i.jsx)(s.r,{loading:!d,children:u&&t?(0,i.jsx)(eI,{...e}):(0,i.jsx)(eP,{...e})})}let eA=e=>{let{storageType:t}=D();!function(){let[e,t]=(0,o.useQueryParam)("type",o.StringParam),[a]=(0,p.iK)(d.GS.STORAGE_TYPE,u.G.groups),i=n.useMemo(()=>h.parse(e??a),[e,a]);n.useEffect(()=>{i!==e&&t(i)},[i,e,t])}();let a=(0,r.X)();return"nodes"===t&&a?(0,i.jsx)(ej,{initialEntitiesCount:(0,eN.b0)(e.viewContext),...e}):(0,i.jsx)(es,{initialEntitiesCount:(0,eN.QQ)(e.viewContext),...e})}},15491:function(e,t,a){a.d(t,{k:()=>ei,J:()=>er});var i=a(74848),r=a(82687),n=a(29581),s=a(85169),l=a(5434),o=a(29901),d=a(17427),u=a(2543),c=a(5948),m=a(93397),h=a(17989),p=a(79092),g=a(8946),f=a(25247),v=a(35537),k=a(97855),N=a(14016),S=a(51630),b=a(28241),x=a(96540),y=a(70900),D=a(80184),w=a(28504),I=a(37296),P=a(96099);let j=(0,f.cn)("ydb-storage-disks");function A({vDisks:e=[],viewContext:t,erasure:a,withIcon:r}){let n=(0,P.Ep)(e,a),[l,o]=x.useState(),{theme:{spaceBaseSize:d}}=(0,y.L)();if(!e.length)return null;let u=(316-d*(e.length-1))/e.length;return(0,i.jsxs)("div",{className:j(null),children:[(0,i.jsx)(s.s,{direction:"row",gap:1,grow:!0,style:{width:316},children:e?.map((e,a)=>(0,i.jsx)(C,{vDisk:e,inactive:!(0,P.OH)(e,t),highlightedVDisk:l,setHighlightedVDisk:o,unavailableVDiskWidth:u,withIcon:r},e.StringifiedId||a))}),(0,i.jsx)("div",{className:j("pdisks-wrapper"),children:e?.map((e,t)=>(0,i.jsx)(E,{vDisk:e,highlightedVDisk:l,setHighlightedVDisk:o,withDCMargin:n.includes(t),withIcon:r},e?.PDisk?.StringifiedId||t))})]})}function C({vDisk:e,highlightedVDisk:t,inactive:a,setHighlightedVDisk:r,unavailableVDiskWidth:n,withIcon:s}){let l={...e,PDisk:void 0},o=e.StringifiedId,d=(0,b.kf)(l.AllocatedSize)?void 0:n,u=Number(l.AllocatedSize)||1,c=t===o;return(0,i.jsx)("div",{style:{flexGrow:u,minWidth:d},className:j("vdisk-item"),children:(0,i.jsx)(D.y,{data:l,compact:!0,withIcon:s,inactive:a,showPopup:c,delayOpen:I.s,delayClose:I.s,onShowPopup:()=>r?.(o),onHidePopup:()=>r?.(void 0),progressBarClassName:j("vdisk-progress-bar"),highlighted:c})})}function E({vDisk:e,highlightedVDisk:t,setHighlightedVDisk:a,withDCMargin:r,withIcon:n}){let s=e.StringifiedId,l=t===s;return e.PDisk?(0,i.jsx)(w.E,{className:j("pdisk-item",{"with-dc-margin":r}),progressBarClassName:j("pdisk-progress-bar"),data:e.PDisk,showPopup:l,delayOpen:I.s,delayClose:I.s,onShowPopup:()=>a?.(s),onHidePopup:()=>a?.(void 0),withIcon:n,highlighted:l}):null}var T=a(7360);let M=(0,f.cn)("stack"),U=({children:e,className:t})=>(0,i.jsx)("div",{className:M(null,t),children:x.Children.map(e,(e,t)=>x.isValidElement(e)?(0,i.jsx)("div",{className:M("layer"),style:{"--ydb-stack-level":t},children:e}):null)});function R({data:e,className:t,stackClassName:a,withIcon:r,highlightedVDisk:n,setHighlightedVDisk:s,...l}){let{Donors:o,...d}=e||{},u=e?.StringifiedId,c=!!(u&&n===u),m={withIcon:r,showPopup:c,highlighted:c,onShowPopup:x.useCallback(()=>{u&&s?.(u)},[u,s]),onHidePopup:x.useCallback(()=>{s?.(void 0)},[s]),...l},h=o&&o.length>0?(0,i.jsxs)(U,{className:a,children:[(0,i.jsx)(D.y,{data:d,...m}),o.map(e=>{let t=(0,T.NJ)(e);return(0,i.jsx)(D.y,{data:e,...m},(0,k.U9)(t?e.VDiskId:e))})]}):(0,i.jsx)(D.y,{data:e,withIcon:r,...m});return(0,i.jsx)("div",{className:t,children:h})}let L=(0,f.cn)("ydb-storage-vdisks");function G({vDisks:e,viewContext:t,erasure:a,withIcon:r}){let n=(0,P.Ep)(e,a),[s,l]=x.useState();return(0,i.jsx)("div",{className:L("wrapper"),children:e?.map((e,a)=>(0,i.jsx)(R,{withIcon:r,data:e,inactive:!(0,P.OH)(e,t),delayOpen:I.s,delayClose:I.s,className:L("item",{"with-dc-margin":n.includes(a)}),highlightedVDisk:s,setHighlightedVDisk:l,progressBarClassName:L("vdisks-progress-bar")},e.StringifiedId))})}var _=a(49745),O=a(38512);let W=(0,f.cn)("ydb-storage-groups-columns"),z={name:O.UW.PoolName,header:O.H6.PoolName,width:250,render:({row:e})=>e.PoolName?(0,i.jsx)(c.s,{content:e.PoolName,placement:["right"],openDelay:0,className:W("pool-name-wrapper"),children:(0,i.jsx)("span",{className:W("pool-name"),children:e.PoolName})}):v.Pd,align:n.Ay.LEFT},H={name:O.UW.PileName,header:O.H6.PileName,width:120,render:({row:e})=>e.PileName||v.Pd,align:n.Ay.LEFT},V={name:O.UW.MediaType,header:O.H6.MediaType,width:100,resizeMinWidth:100,align:n.Ay.LEFT,render:({row:e})=>(0,i.jsxs)(s.s,{children:[(0,i.jsx)(l.J,{children:e.MediaType||v.Pd}),"\xa0",e.Encryption&&(0,i.jsx)(o.A,{content:(0,_.A)("encrypted"),placement:"right",className:v.zQ,children:(0,i.jsx)(l.J,{children:(0,i.jsx)(d.I,{data:r.A,size:18})})})]}),sortable:!1},F={name:O.UW.Erasure,header:O.H6.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:({row:e})=>e.ErasureSpecies?e.ErasureSpecies:"-",align:n.Ay.LEFT},B={name:O.UW.Degraded,header:O.H6.Degraded,width:110,resizeMinWidth:110,render:({row:e})=>e.Degraded?(0,i.jsxs)(l.J,{theme:(0,P.k_)(e),children:["Degraded: ",e.Degraded]}):"-",align:n.Ay.LEFT,defaultOrder:n.Ay.DESCENDING},Y={name:O.UW.State,header:O.H6.State,width:150,render:({row:e})=>e.State??v.Pd,align:n.Ay.LEFT,defaultOrder:n.Ay.DESCENDING},$={name:O.UW.Usage,header:O.H6.Usage,width:85,resizeMinWidth:75,render:({row:e})=>(0,u.isNil)(e.Usage)?v.Pd:(0,i.jsx)(p.U,{value:Math.floor(e.Usage),theme:(0,N.f)(e.Usage)}),align:n.Ay.LEFT},J={name:O.UW.DiskSpaceUsage,header:O.H6.DiskSpaceUsage,width:115,resizeMinWidth:75,render:({row:e})=>(0,u.isNil)(e.DiskSpaceUsage)?v.Pd:(0,i.jsx)(p.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,N.f)(e.DiskSpaceUsage)}),align:n.Ay.LEFT},q={name:O.UW.GroupId,header:O.H6.GroupId,width:140,render:({row:e})=>e.GroupId?(0,i.jsx)(en,{id:e.GroupId}):"-",sortAccessor:e=>Number(e.GroupId),align:n.Ay.LEFT},K={name:O.UW.Used,header:O.H6.Used,width:100,render:({row:e})=>(0,b.wb)(e.Used,!0),align:n.Ay.RIGHT},Q={name:O.UW.Limit,header:O.H6.Limit,width:100,render:({row:e})=>(0,b.wb)(e.Limit),align:n.Ay.RIGHT},X={name:O.UW.DiskSpace,header:O.H6.DiskSpace,width:70,render:({row:e})=>(0,i.jsx)(h.k,{status:e.DiskSpace}),align:n.Ay.CENTER},Z={name:O.UW.Read,header:O.H6.Read,width:100,render:({row:e})=>e.Read?(0,b.O4)(e.Read):"-",align:n.Ay.RIGHT},ee={name:O.UW.Write,header:O.H6.Write,width:100,render:({row:e})=>e.Write?(0,b.O4)(e.Write):"-",align:n.Ay.RIGHT},et={name:O.UW.Latency,header:O.H6.Latency,width:100,render:({row:e})=>(0,u.isNil)(e.LatencyPutTabletLogMs)?v.Pd:(0,S.Xo)(e.LatencyPutTabletLogMs),align:n.Ay.RIGHT},ea={name:O.UW.AllocationUnits,header:O.H6.AllocationUnits,width:150,render:({row:e})=>(0,u.isNil)(e.AllocationUnits)?v.Pd:(0,k.ZV)(e.AllocationUnits),align:n.Ay.RIGHT},ei=()=>[q,V,F,$,K,Q],er=e=>[q,z,H,V,F,B,Y,$,J,K,Q,X,Z,ee,et,ea,{name:O.UW.VDisks,header:O.H6.VDisks,className:W("vdisks-column"),render:({row:t})=>(0,i.jsx)(G,{vDisks:t.VDisks,viewContext:e?.viewContext,erasure:t.ErasureSpecies,withIcon:!0}),align:n.Ay.CENTER,width:475,resizeable:!1,sortable:!1},{name:O.UW.VDisksPDisks,header:O.H6.VDisksPDisks,className:W("disks-column"),render:({row:t})=>(0,i.jsx)(A,{vDisks:t.VDisks,viewContext:e?.viewContext,erasure:t.ErasureSpecies,withIcon:!0}),align:n.Ay.CENTER,width:800,resizeable:!1,sortable:!1}].map(e=>({...e,sortable:(0,O.i4)(e.name)}));function en({id:e}){let t=(0,g.zO)();return(0,i.jsx)(m.c,{name:String(e),path:t(e),hasClipboardButton:!0,showStatus:!1})}},38512:function(e,t,a){a.d(t,{YX:()=>b,Ai:()=>c,UW:()=>d,i4:()=>D,qK:()=>l,SE:()=>N,hu:()=>m,LO:()=>g,H6:()=>f,zY:()=>o,GP:()=>y,RY:()=>p,kY:()=>S});var i=a(14476),r=a(51432),n=JSON.parse('{"pool-name":"Pool Name","pile-name":"Pile Name","type":"Type","encryption":"Encryption","erasure":"Erasure","degraded":"Degraded","missing-disks":"Missing Disks","state":"State","usage":"Usage","disk-usage":"Disk usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","latency":"Latency","allocation-units":"Allocation Units","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}');let s=(0,r.g4)("ydb-storage-groups-columns",{en:n}),l="storageGroupsColumnsWidth",o="storageGroupsSelectedColumns",d={GroupId:"GroupId",PoolName:"PoolName",PileName:"PileName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",Degraded:"Degraded",State:"State"},u=["DiskSpaceUsage","Latency","AllocationUnits","VDisksPDisks"];function c(e){return u.includes(e)}let m=["GroupId","PoolName","Erasure","Used","VDisks"],h=["DiskSpace"];function p(e){return h.some(t=>t===e)}let g=["GroupId"],f={get PoolName(){return s("pool-name")},get MediaType(){return s("type")},get PileName(){return s("pile-name")},get Erasure(){return s("erasure")},get GroupId(){return s("group-id")},get Used(){return s("used")},get Limit(){return s("limit")},get Usage(){return s("usage")},get DiskSpaceUsage(){return s("disk-usage")},get DiskSpace(){return s("space")},get Read(){return s("read")},get Write(){return s("write")},get Latency(){return s("latency")},get AllocationUnits(){return s("allocation-units")},get VDisks(){return s("vdisks")},get VDisksPDisks(){return s("vdisks-pdisks")},get Degraded(){return s("missing-disks")},get State(){return s("state")}},v={get GroupId(){return s("group-id")},get Erasure(){return s("erasure")},get Usage(){return s("usage")},get DiskSpaceUsage(){return s("disk-usage")},get PoolName(){return s("pool-name")},get PileName(){return s("pile-name")},get Kind(){return s("type")},get Encryption(){return s("encryption")},get MediaType(){return s("type")},get MissingDisks(){return s("missing-disks")},get State(){return s("state")},get Latency(){return s("latency")}},k=["PoolName","PileName","MediaType","Encryption","Erasure","Usage","DiskSpaceUsage","State","MissingDisks","Latency"],N=k.map(e=>({value:e,content:v[e]})),S=i.z.custom(e=>k.includes(e)).catch(void 0),b={GroupId:["GroupId"],PoolName:["PoolName"],PileName:["PileName"],MediaType:["MediaType","Encryption"],Erasure:["Erasure"],Used:["Used"],Limit:["Limit"],Usage:["Usage"],DiskSpaceUsage:["DiskSpaceUsage"],DiskSpace:["State"],Read:["Read"],Write:["Write"],Latency:["Latency"],AllocationUnits:["AllocationUnits"],VDisks:["VDisk","PDisk","Read","Write"],VDisksPDisks:["VDisk","PDisk","Read","Write"],Degraded:["MissingDisks"],State:["State"]},x={GroupId:"GroupId",PoolName:"PoolName",PileName:void 0,MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:void 0,Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:void 0,VDisksPDisks:void 0,Degraded:"Degraded",State:"State"};function y(e){return x[e]}function D(e){return!!x[e]}},49745:function(e,t,a){a.d(t,{A:()=>s});var i=a(51432),r=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),n=JSON.parse('{"empty.default":"Нет групп","empty.out_of_space":"Нет групп, в которых кончается место","empty.degraded":"Нет деградировавших групп","show_all":"Показать все группы","encrypted":"Зашифрованная группа"}');let s=(0,i.g4)("ydb-storage-groups",{ru:n,en:r})},40159:function(e,t,a){a.d(t,{t:()=>h,C:()=>p});var i=a(74848),r=a(29581),n=a(65943),s=a(87669),l=a(25247),o=a(96540),d=a(28504);let u=(0,l.cn)("ydb-storage-pdisks");function c({pDisks:e=[],vDisks:t=[],viewContext:a,pDiskWidth:r}){let[n,s]=o.useState();return e.length?(0,i.jsx)("div",{className:u("pdisks-wrapper"),children:e.map(e=>{let l=e.StringifiedId,o=t.filter(t=>t.PDiskId===e.PDiskId),c=n===l;return(0,i.jsx)("div",{className:u("pdisks-item"),children:(0,i.jsx)(d.E,{data:e,vDisks:o,viewContext:a,width:r,showPopup:c,onShowPopup:()=>s(l),onHidePopup:()=>s(void 0),highlighted:c,highlightedDisk:n,setHighlightedDisk:s})},l)})}):null}let m=(0,l.cn)("ydb-storage-nodes-columns"),h=({viewContext:e,columnsSettings:t})=>({name:s.vg.PDisks,header:s.uG.PDisks,className:m("pdisks-column"),width:t?.pDiskContainerWidth,render:({row:a})=>(0,i.jsx)(c,{pDisks:a.PDisks,vDisks:a.VDisks,viewContext:e,pDiskWidth:t?.pDiskWidth}),align:r.Ay.CENTER,sortable:!1,resizeable:!1}),p=({database:e,viewContext:t,columnsSettings:a})=>[(0,n._E)(),(0,n.Nh)({database:e}),(0,n.eT)(),(0,n.uk)(),(0,n.OV)(),(0,n.OX)(),(0,n.jl)(),(0,n.fr)(),(0,n.kv)(),(0,n.pH)(),(0,n.iX)(),(0,n.Bg)(),(0,n.Rn)(),(0,n.Vz)(),h({viewContext:t,columnsSettings:a}),(0,n.qp)({database:e})].map(e=>({...e,sortable:(0,s.sp)(e.name)}))},51670:function(e,t,a){a.d(t,{Q:()=>o});var i=a(74848);a(96540);var r=a(94866),n=a(77269),s=a(5434);let l=(0,a(25247).cn)("ydb-table-group"),o=({children:e,title:t,entityName:a,count:o,expanded:d=!1,onIsExpandedChange:u})=>(0,i.jsxs)("div",{className:l(null),children:[(0,i.jsx)("button",{onClick:()=>{u(t,!d)},className:l("button"),title:t,children:(0,i.jsxs)("div",{className:l("title-wrapper"),children:[(0,i.jsx)(r.I,{direction:d?"top":"bottom"}),(0,i.jsxs)("div",{className:l("title"),children:[(0,i.jsx)(n.E,{variant:"subheader-2",children:t}),(0,i.jsxs)(n.E,{variant:"body-2",color:"secondary",className:l("count"),children:[a,": ",(0,i.jsx)(s.J,{theme:"normal",children:o})]})]})]})}),d?(0,i.jsx)("div",{className:l("content"),children:e}):null]});o.displayName="TableGroup"},4627:function(e,t,a){a.d(t,{$:()=>r});var i=a(96540);function r(e){let[t,a]=i.useState({});return i.useEffect(()=>{e?.length&&a(t=>e.reduce((e,{name:a})=>{let i=t[a];return{...e,[a]:i??!1}},{}))},[e]),{expandedGroups:t,setIsGroupExpanded:i.useCallback((e,t)=>{a(a=>({...a,[e]:t}))},[])}}},9263:function(e,t,a){a.d(t,{A:()=>n});var i=a(51432),r=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN","controls_group-by-placeholder":"Group by:","no-nodes":"No such nodes","no-groups":"No such groups","no-data":"no data"}');let n=(0,i.g4)("ydb-storage",{en:r})},37296:function(e,t,a){a.d(t,{b:()=>i,s:()=>r});let i=(0,a(25247).cn)("global-storage"),r=200},96099:function(e,t,a){a.d(t,{k_:()=>m,QQ:()=>g,b0:()=>p,OH:()=>h,fj:()=>d,Ep:()=>f});var i=a(96540),r=a(2543),n=a(56321),s=a(14016),l=a(61738),o=a(81709);function d(){let[e,t]=i.useState(void 0),[a,r]=i.useState(void 0);return{handleDataFetched:i.useCallback(a=>{if(a?.columnsSettings&&!e){let{maxSlotsPerDisk:e,maxDisksPerNode:i}=a.columnsSettings,n=e||1,s=i||1,l=Math.max(3*n+(n-1)*2,165);t(l),r(s*l+(s-1)*10+20)}},[e]),columnsSettings:i.useMemo(()=>({pDiskWidth:e||165,pDiskContainerWidth:a}),[a,e])}}let u=(0,s.H)(["success","warning","danger"],1,2),c={"block-4-2":(0,s.H)(["success","warning","danger"],1,2),"mirror-3-dc":(0,s.H)(["success","warning","danger"],1,3)},m=e=>{let t;return(void 0!==(t=e.ErasureSpecies)&&t in c?c[e.ErasureSpecies]:u)(e.Degraded)};function h(e,t){let a=!0;return!(0,r.isNil)(e.VDiskId?.GroupID)&&t?.groupId&&(a&&=String(e.VDiskId.GroupID)===t.groupId),!(0,r.isNil)(e.NodeId)&&t?.nodeId&&(a&&=String(e.NodeId)===t.nodeId),!(0,r.isNil)(e.PDiskId)&&t?.pDiskId&&(a&&=String(e.PDiskId)===t.pDiskId),!(0,r.isNil)(e.VDiskSlotId)&&t?.vDiskSlotId&&(a&&=String(e.VDiskSlotId)===t.vDiskSlotId),a}function p(e){return(0,r.isNil)(e?.nodeId)&&(0,r.isNil)(e?.pDiskId)&&(0,r.isNil)(e?.vDiskSlotId)?10:1}function g(e){return(0,r.isNil)(e?.groupId)&&(0,r.isNil)(e?.vDiskSlotId)?10:1}function f(e=[],t){let a=(0,o.J)(),r=(0,l.N4)(e=>(0,n.K)(e,a));return i.useMemo(()=>{let a=[];return"mirror-3-dc"!==t&&"mirror-3of4"!==t||e.forEach((t,i)=>{r?.get(Number(t?.NodeId))?.DC!==r?.get(Number(e[i+1]?.NodeId))?.DC&&a.push(i)}),a},[t,e,r])}},98567:function(e,t,a){a.d(t,{b:()=>function e(t={}){let{Whiteboard:a={},PDisk:d,...u}=t,c={...a,...u,VDiskId:a.VDiskId},m=function(e={}){let{Whiteboard:t,...a}=e,i={...t,...a,PDiskId:t?.PDiskId};if(void 0===i.PDiskId&&a.PDiskId){let e=Number(a.PDiskId.split("-")[1]);isNaN(e)||(i.PDiskId=e)}let n=a.PDiskId||(0,l.r$)({nodeId:i.NodeId,pDiskId:i.PDiskId}),{AllocatedPercent:d,AllocatedSize:u,AvailableSize:c,TotalSize:m}=(0,o.hK)({AvailableSize:i.AvailableSize,TotalSize:i.TotalSize}),h=a.Type?.toUpperCase()??(0,s.Y)(t?.Category),p=(0,r.d)({State:t?.State,AllocatedPercent:d}),g=a.SlotSize??t?.EnforcedDynamicSlotSize;return{...i,StringifiedId:n,AllocatedPercent:d,AllocatedSize:u,AvailableSize:c,TotalSize:m,Type:h,Severity:p,SlotSize:g}}({...d,NodeId:c.NodeId}),h=m?.PDiskId??a?.PDiskId,p=u.VDiskId??(0,i.U9)(a.VDiskId),g=(0,n.b)(c),f=(0,o.LW)({AvailableSize:c.AvailableSize,AllocatedSize:c.AllocatedSize,SlotSize:d?.SlotSize}),v=u.Donors?.map(t=>e({...t,Whiteboard:{...t.Whiteboard,DonorMode:!0}}));return{...c,...f,PDisk:m,Donors:v,PDiskId:h,StringifiedId:p,Severity:g}}});var i=a(97855),r=a(93639),n=a(16021),s=a(96360),l=a(7360),o=a(22530)},2230:function(e,t,a){a.d(t,{t:()=>r});var i=a(58405);async function r({version:e="v2",shouldUseGroupsHandler:t,...a},r){if(t&&"v1"!==e){let e=await window.api.storage.getStorageGroups({...a},r);return(0,i.Rv)(e)}{let t=await window.api.viewer.getStorageInfo({version:e,...a},r);return(0,i.Qi)(t)}}},65615:function(e,t,a){a.d(t,{S:()=>s});var i=a(56496),r=a(2230),n=a(58405);let s=i.F.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,{signal:t})=>{try{let a=await window.api.viewer.getNodes({storage:!0,type:"static",...e},{signal:t});return{data:(0,n.rz)(a)}}catch(e){return{error:e}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await (0,r.t)(e,{signal:t})}}catch(e){return{error:e}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},58405:function(e,t,a){a.d(t,{Qi:()=>g,Rv:()=>f,rz:()=>p});var i=a(2543),r=a(97855),n=a(7360),s=a(22530),l=a(65101),o=a(51630),d=a(98567);function u(e){let{DiskSpace:t,VDisks:a=[]}=e;return t||(0,n.XY)(Math.max(...a.map(e=>(0,n.H7)(e.DiskSpace))))}let c=(e,t)=>{let a=(0,s.WT)(e);return{...a,StoragePoolName:t,Donors:a?.Donors?.map(e=>({...e,StoragePoolName:t}))}},m=e=>{let{VDisks:t=[],PoolName:a,Usage:i=0,Read:r=0,Write:n=0,Used:s=0,Limit:l=0,Degraded:o=0,Kind:d,MediaType:m,GroupID:h,Overall:p,GroupGeneration:g}=e,f=t.map(e=>c(e,a)),v=100*Number(i),k=u(e);return{...e,PoolName:a,GroupId:h,MediaType:m||d,VDisks:f,Usage:v,Overall:p,GroupGeneration:g?String(g):void 0,Read:Number(r),Write:Number(n),Used:Number(s),Limit:Number(l),Degraded:Number(o),DiskSpace:k}},h=(e,t,a)=>{if(!((0,i.isNil)(e)||(0,i.isNil)(t)||(0,i.isNil)(a)))return(0,r.U9)({NodeId:e,PDiskId:t,VSlotId:a})},p=e=>{let{Nodes:t,TotalNodes:a,FoundNodes:i,NodeGroups:r,MaximumSlotsPerDisk:n,MaximumDisksPerNode:o}=e,d=r?.map(({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}}).filter(e=>!!e),u=n&&!isNaN(Number(n))?Number(n):Math.max(1,...(t||[]).flatMap(e=>{let t=e.PDisks||[],a=e.VDisks||[];return t.map(e=>a.filter(t=>t.PDiskId===e.PDiskId).length||0)})),c=o&&!isNaN(Number(o))?Number(o):Math.max(1,...(t||[]).map(e=>e.PDisks?.length||0)),m=t?.map(e=>((e,t,a)=>{let{SystemState:i,NodeId:r,PDisks:n,VDisks:o,...d}=e,u=n?.filter(e=>"Normal"!==e.State).length||0,c=n?.map(e=>({...(0,s.or)(e),NodeId:r})),m=o?.map(e=>({...(0,s.WT)(e),NodeId:r}));return{...d,...(0,l.q1)(i),NodeId:r,PDisks:c,VDisks:m,Missing:u,MaximumSlotsPerDisk:t,MaximumDisksPerNode:a}})(e,u,c));return(e=>{if(!e?.length)return;let t=new Map;e.forEach(e=>{e.VDisks?.forEach(e=>{let a=h(e.NodeId,e.PDiskId,e.VDiskSlotId);a&&t.set(a,e)})}),e.forEach(e=>{e.VDisks?.forEach(e=>{!e.Replicated&&e.Donors?.length&&e.Donors.forEach(a=>{let i=h(a.NodeId,a.PDiskId,a.VDiskSlotId);if(!i)return;let r=t.get(i);r&&(r.Recipient={NodeId:e.NodeId,StringifiedId:e.StringifiedId},a.StringifiedId!==r.StringifiedId&&(a.StringifiedId=r.StringifiedId))})})})})(m),{nodes:m,total:Number(a)||m?.length,found:Number(i),tableGroups:d,columnsSettings:{maxSlotsPerDisk:u,maxDisksPerNode:c}}},g=e=>{let t,{StoragePools:a,StorageGroups:i,TotalGroups:r,FoundGroups:n}=e,l=(t=[],i?t=i.map(m):a?.forEach(e=>{e.Groups?.forEach(a=>{t.push(((e,t)=>{let a,i=0,r=0,n=0,l=0,o=0,{Name:d,MediaType:m}=t;if(e.VDisks)for(let t of e.VDisks){let{Replicated:e,VDiskState:d,AvailableSize:u,AllocatedSize:c,PDisk:m,ReadThroughput:h,WriteThroughput:p}=t,{Type:g,State:f,AvailableSize:v}=(0,s.or)(m);(!1===e||"Normal"!==f||"OK"!==d)&&(i+=1);let k=Number(u??v)||0,N=Number(c)||0;r+=N,n+=k+N,l+=Number(h)||0,o+=Number(p)||0,a=g&&(g===a||!a)?g:"Mixed"}let h=e.VDisks?.map(e=>c(e,d)),p=n?((e,t=1)=>Math.floor((e.Limit?100*e.Used/e.Limit:0)/t)*t)({Used:r,Limit:n},5):void 0,g=u(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:h,Usage:p,Read:l,Write:o,PoolName:d,Used:r,Limit:n,Degraded:i,MediaType:m||a||void 0,DiskSpace:g}})(a,e))})}),t);return{groups:l,total:Number(r)||l.length,found:Number(n)}};function f(e){let{FoundGroups:t,TotalGroups:a,StorageGroups:i=[],StorageGroupGroups:r}=e,n=i.map(e=>{let{Usage:t,DiskSpaceUsage:a,Read:i,Write:r,Used:n,Limit:s,MissingDisks:l,VDisks:c=[],Overall:m,LatencyPutTabletLog:h,LatencyPutUserData:p,LatencyGetFast:g}=e,f=c.map(d.b),v=u(e);return{...e,Usage:t,DiskSpaceUsage:a,Read:Number(i),Write:Number(r),Used:Number(n),Limit:Number(s),LatencyPutTabletLogMs:(0,o.Jc)(h),LatencyPutUserDataMs:(0,o.Jc)(p),LatencyGetFastMs:(0,o.Jc)(g),Degraded:Number(l),Overall:m,VDisks:f,DiskSpace:v}}),s=r?.map(({GroupName:e,GroupCount:t})=>{if(e&&t)return{name:e,count:Number(t)}}).filter(e=>!!e);return{groups:n,total:Number(a)||n.length,found:Number(t),tableGroups:s}}},93639:function(e,t,a){a.d(t,{J:()=>s,d:()=>n});var i=a(95980),r=a(7360);function n(e){let t=s(e.State),a=(0,r.SW)(e.AllocatedPercent);return t!==i.Km&&a?Math.max(t,a):t}function s(e){var t;return void 0!==(t=e)&&t in i.iZ?i.iZ[e]:i.Km}},16021:function(e,t,a){a.d(t,{J:()=>s,b:()=>n});var i=a(40897),r=a(95980);function n(e){let{DiskSpace:t,VDiskState:a,FrontQueues:i,Replicated:n}=e;if(!a)return r.Ne;let o=Math.max(Math.min(r.aW.Yellow,l(t)),s(a),Math.min(r.aW.Yellow,l(i)));return!1===n&&o===r.aW.Green&&(o=r.aW.Blue),o}function s(e){return e?r.qs[e]??r.Km:r.Ne}function l(e){return e?e===i.m.Blue?r.aW.Green:r.aW[e]??r.Km:r.Km}},95980:function(e,t,a){a.d(t,{A$:()=>c,Km:()=>m,Ne:()=>p,WK:()=>S,Yh:()=>h,aW:()=>d,iZ:()=>f,nG:()=>N,nZ:()=>k,nr:()=>v,qs:()=>g,r4:()=>u});var i=a(11169),r=a(14204),n=a(21852),s=a(32065),l=a(52555),o=a(52457);let d={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},u="DarkGrey",c=Object.entries(d).reduce((e,[t,a])=>({...e,[a]:t}),{}),m=d.Grey,h=c[m],p=d.Red,g={OK:d.Green,Initial:d.Yellow,SyncGuidRecovery:d.Yellow,LocalRecoveryError:d.Red,SyncGuidRecoveryError:d.Red,PDiskError:d.Red},f={Normal:d.Green,Initial:d.Yellow,InitialFormatRead:d.Yellow,InitialSysLogRead:d.Yellow,InitialCommonLogRead:d.Yellow,InitialFormatReadError:d.Red,InitialSysLogReadError:d.Red,InitialSysLogParseError:d.Red,InitialCommonLogReadError:d.Red,InitialCommonLogParseError:d.Red,CommonLoggerInitError:d.Red,OpenFileError:d.Red,ChunkQuotaError:d.Red,DeviceIoError:d.Red,Stopped:d.Red},v={[d.Green]:{theme:"success",icon:i.A},[d.Yellow]:{theme:"warning",icon:r.A},[d.Red]:{theme:"danger",icon:n.A},[d.Blue]:{theme:"info",icon:s.A},[d.Grey]:{theme:"normal"}},k=l.A,N=o.A,S={donor:{theme:"unknown",icon:k},replica:{theme:v[d.Blue].theme,icon:v[d.Blue].icon}}},96360:function(e,t,a){a.d(t,{Y:()=>i});function i(e){var t;let a;if(!e)return;let i=(t=BigInt(e).toString(2),a={},Object.entries({isSolidState:1,kind:55,typeExt:8}).reduce((e,[i,r])=>{let n=t.length-e;return a[i]=t.substring(n-r,n)||"0",e+r},0),a);if("1"===i.isSolidState)switch(parseInt(i.typeExt,2)){case 0:return"SSD";case 2:return"NVME"}else if("0"===i.typeExt)return"HDD"}},7360:function(e,t,a){a.d(t,{H7:()=>c,NJ:()=>l,PH:()=>p,SW:()=>d,XY:()=>u,nC:()=>h,r$:()=>m});var i=a(2543),r=a(40897),n=a(14016),s=a(95980);function l(e){return"VDiskId"in e}let o=(0,n.H)([r.m.Green,r.m.Yellow,r.m.Red]),d=e=>(0,i.isNil)(e)?0:c(o(e));function u(e){return void 0===e?s.Yh:s.A$[e]||s.Yh}function c(e){return e?s.aW[e]:0}function m({nodeId:e,pDiskId:t}){if(!(0,i.isNil)(e)&&!(0,i.isNil)(t))return`${e}-${t}`}function h(e){return("vDiskId"in e?[e.vDiskId]:[e.nodeId,e.pDiskId,e.vDiskSlotId]).join("-")}function p(e,t){if(void 0===e)return;let a=e===s.aW.Red;return t?s.nZ:a?s.nG:void 0}},22530:function(e,t,a){a.d(t,{LW:()=>u,WT:()=>function e(t={}){if(!(0,o.NJ)(t)){let{NodeId:e,PDiskId:a,VSlotId:n}=t,s=(0,i.isNil)(n)||(0,i.isNil)(a)||(0,i.isNil)(e)?void 0:{NodeId:e,PDiskId:a,VSlotId:n};return{StringifiedId:(0,r.U9)(s),NodeId:e,PDiskId:a,VDiskSlotId:n}}let{PDisk:a,PDiskId:n,VDiskId:l,NodeId:c,Donors:m,AvailableSize:h,AllocatedSize:p,...g}=t,f=a?d({...a,NodeId:a?.NodeId??c}):void 0,v=n??f?.PDiskId,k=u({AvailableSize:h,AllocatedSize:p,SlotSize:a?.EnforcedDynamicSlotSize}),N=(0,s.b)(t),S=(0,r.U9)(l),b=m?.map(t=>{if((0,o.NJ)(t))return e({...t,DonorMode:!0});{let{NodeId:e,PDiskId:a,VSlotId:r}=t,n=(0,i.isNil)(e)||(0,i.isNil)(a)||(0,i.isNil)(r)?"":`${e}-${a}-${r}`;return{NodeId:e,PDiskId:a,VDiskSlotId:r,StringifiedId:n,DonorMode:!0}}});return{...g,...k,VDiskId:l,NodeId:c,PDiskId:v,PDisk:f,Donors:b,Severity:N,StringifiedId:S}},hK:()=>c,or:()=>d});var i=a(2543),r=a(97855),n=a(93639),s=a(16021),l=a(96360),o=a(7360);function d(e={}){let{AvailableSize:t,TotalSize:a,Category:i,State:r,PDiskId:s,NodeId:u,EnforcedDynamicSlotSize:m,...h}=e,p=(0,o.r$)({nodeId:u,pDiskId:s}),g=(0,l.Y)(i),f=c({AvailableSize:t,TotalSize:a}),v=(0,n.d)({State:r,AllocatedPercent:f.AllocatedPercent});return{...h,...f,PDiskId:s,NodeId:u,StringifiedId:p,Type:g,Category:i,State:r,Severity:v,SlotSize:m}}function u({AvailableSize:e,AllocatedSize:t,SlotSize:a}){let i=Number(e??0),r=Number(t),n=Number(a),s=r+i;!i&&n&&(s=n);let l=s>0?Math.floor(100*r/s):NaN;return{AvailableSize:i,AllocatedSize:r,SizeLimit:s,AllocatedPercent:l}}function c({AvailableSize:e,TotalSize:t}){let a=Number(e),i=Number(t),r=i-a,n=Math.floor(100*r/i);return{AvailableSize:a,TotalSize:i,AllocatedSize:r,AllocatedPercent:n}}},33583:function(e,t,a){a.d(t,{T:()=>i}),a(60680);let i=(e,t=-1)=>-1===t?`-${e}`:e},5577:function(e,t,a){a.d(t,{g:()=>s,w:()=>l});var i=a(35537),r=a(97855);let n=e=>(0,r.ZV)((0,r.CR)(e||0,2)),s=(e,t)=>[n(e),n(t)];function l({inverseColorize:e,warningThreshold:t=i.Hh,dangerThreshold:a=i.Ed,colorizeProgress:r,fillWidth:n}){let s=e?"danger":"good";return r&&(n>t&&n<=a?s="warning":n>a&&(s=e?"good":"danger")),s}},282:function(e,t,a){a.d(t,{$:()=>s});var i=a(74848),r=a(19583),n=a(67103);let s=e=>403===e.status?(0,i.jsx)(r.O,{position:"left"}):(0,i.jsx)(n.o,{error:e})},36712:function(e,t,a){a.d(t,{R:()=>i});function i(e,t){return Array.from(e.reduce((e,a)=>(t[a].forEach(t=>{e.add(t)}),e),new Set)).sort()}},53486:function(e,t,a){a.d(t,{P:()=>n,_:()=>s});var i=a(40897);let r={Dead:i.m.Red,Created:i.m.Yellow,ResolveStateStorage:i.m.Yellow,Candidate:i.m.Yellow,BlockBlobStorage:i.m.Yellow,WriteZeroEntry:i.m.Yellow,Restored:i.m.Yellow,Discover:i.m.Yellow,Lock:i.m.Yellow,Stopped:i.m.Yellow,ResolveLeader:i.m.Yellow,RebuildGraph:i.m.Yellow,Terminating:i.m.Yellow,Deleted:i.m.Green,Active:i.m.Green},n=e=>e?Object.values(i.m).includes(e)?e:r[e]:i.m.Grey;function s(e){if(!e)return"unknown";switch(e){case"Dead":return"danger";case"Active":case"Deleted":return"success";default:return"warning"}}}}]);