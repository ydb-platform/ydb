(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([["47691"],{50698:function(e,t,a){var n={"./simpleWorker.js":"45585","./simpleWorker":"45585"};function r(e){return Promise.resolve().then(function(){if(!a.o(n,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a(n[e])})}r.keys=()=>Object.keys(n),r.id=50698,e.exports=r},9204:function(e,t,a){var n={"./textModelSync/textModelSync.protocol":["45628","9485"],"./treeSitterParserService":["35320"],"./markerDecorations":["80886"],"./languageService.js":["83930"],"./languageService":["83930"],"./markerDecorationsService":["90011"],"./markerDecorationsService.js":["90011"],"./modelService.js":["40931"],"./resolverService":["37042"],"./semanticTokensProviderStyling":["330"],"./languageFeatureDebounce":["12060"],"./editorSimpleWorker":["42910"],"./textModelSync/textModelSync.impl.js":["70267"],"./modelService":["40931"],"./semanticTokensDto.js":["19376"],"./textModelSync/textModelSync.impl":["70267"],"./model":["64830"],"./treeViewsDnd":["2603"],"./languagesRegistry":["66995"],"./model.js":["64830"],"./findSectionHeaders.js":["99307"],"./editorBaseApi":["93059"],"./treeSitterParserService.js":["35320"],"./resolverService.js":["37042"],"./semanticTokensProviderStyling.js":["330"],"./getIconClasses.js":["78148"],"./languageFeatures":["52230"],"./semanticTokensDto":["19376"],"./semanticTokensStylingService":["38148"],"./editorBaseApi.js":["93059"],"./textResourceConfiguration":["41504"],"./treeViewsDndService":["26756"],"./semanticTokensStyling":["82891"],"./textResourceConfiguration.js":["41504"],"./treeViewsDnd.js":["2603"],"./editorWorker.js":["90304"],"./unicodeTextModelHighlighter":["49887"],"./unicodeTextModelHighlighter.js":["49887"],"./editorSimpleWorker.js":["42910"],"./languagesAssociations.js":["55996"],"./languageFeatures.js":["52230"],"./treeViewsDndService.js":["26756"],"./languageFeatureDebounce.js":["12060"],"./languageFeaturesService.js":["72101"],"./editorWorker":["90304"],"./textModelSync/textModelSync.protocol.js":["45628","9485"],"./findSectionHeaders":["99307"],"./languageFeaturesService":["72101"],"./semanticTokensStyling.js":["82891"],"./languagesAssociations":["55996"],"./editorWorkerHost":["96358"],"./editorWorkerHost.js":["96358"],"./getIconClasses":["78148"],"./languagesRegistry.js":["66995"],"./semanticTokensStylingService.js":["38148"],"./markerDecorations.js":["80886"]};function r(e){if(!a.o(n,e))return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],r=t[0];return Promise.all(t.slice(1).map(a.e)).then(function(){return a(r)})}r.keys=()=>Object.keys(n),r.id=9204,e.exports=r},78830:function(e){function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=78830,e.exports=t},9243:function(e,t,a){"use strict";a.d(t,{b:()=>l});var n=a(74848),r=a(66111);let s=(0,a(51432).g4)("ydb-clipboard-button",{en:{copy:"Copy"}});function l({size:e,className:t,copyText:a,withLabel:l,view:i}){if(!a)return null;let o=!1===l?null:l||s("copy");return(0,n.jsx)(r.b,{view:i,size:e||"xs",className:t,text:a,children:o})}},61058:function(e,t,a){"use strict";a.d(t,{T:()=>n.T});var n=a(53211)},81537:function(e,t,a){"use strict";a.d(t,{p:()=>en});var n=a(74848),r=a(96540),s=a(14399),l=a(49612),i=a(29581),o=a(85169),c=a(6876),d=a(24629),u=a(17427),h=a(2837),p=a(81882),g=a(9243),m=a(16423),f=a.n(m);function b({className:e,text:t,start:a,length:s,hasComa:l}){let i=l?(0,n.jsx)(r.Fragment,{children:",\xa0"}):null;if(s&&"number"==typeof a&&a>=0&&a<t.length){let l=t.substring(0,a),o=t.substring(a,a+s),c=t.substring(a+s);return(0,n.jsxs)(r.Fragment,{children:[l&&(0,n.jsx)("span",{className:e(),children:l}),(0,n.jsx)("span",{className:e({highlighted:!0}),children:o}),c&&(0,n.jsx)("span",{className:e(),children:c}),i]})}return(0,n.jsxs)("span",{className:e(),children:[t,i]})}function x({className:e,text:t,starts:a,length:s,hasComa:l}){if(!s||!a.length){let a=l?(0,n.jsx)(r.Fragment,{children:",\xa0"}):null;return(0,n.jsxs)("span",{className:e(),children:[t,a]})}let i=[];for(let r=0,o=0;r<a.length&&o<t.length;++r){let c=r===a.length-1,d=a[r]+(c?t.length:s),u=t.substring(o,d);u&&i.push((0,n.jsx)(b,{className:e,text:u,start:a[r]-o,length:s,hasComa:c&&l})),o=d}return(0,n.jsx)(r.Fragment,{children:i})}let v=(0,a(25247).cn)("ydb-json-viewer");function j(e){let{collapsed:t,onToggle:a,path:r}=e;return(0,n.jsx)("span",{title:r,className:v("collapsed"),children:(0,n.jsx)(d.$,{onClick:a,view:"flat-secondary",size:"xs",children:(0,n.jsx)(d.$.Icon,{children:(0,n.jsx)("span",{className:"unipika",children:t?"[+]":"[-]"})})})})}var y=a(51432),w=JSON.parse('{"action_collapse-all":"Collapse all","action_expand-all":"Expand all","action_next":"Next","action_back":"Back","description_search":"Search...","description_matched-rows":"Matched rows","description_full-value":"Full value","context_case-sensitive-search":"Case sensitive search enadled","context_case-sensitive-search-disabled":"Case sensitive search disabled","context_items-count":[" {{count}} item "," {{count}} items "," {{count}} items "," {{count}} items "]}');let S=(0,y.g4)("ydb-json-viewer",{en:w});var T=a(46371);function N(e){return t=>v("filtered",t,e)}var k=a(51167);function C(e){let{row:{level:t,open:a,close:s,key:l,value:i,hasDelimiter:o,path:c,collapsed:d,depth:u},settings:h,onToggleCollapse:p,matched:g,filter:m,showFullText:b,index:x}=e,y=r.useCallback(()=>{c&&p(c)},[c,p]),w=r.useCallback(()=>{b(x)},[b,x]);return(0,n.jsxs)("div",{className:v("cell","unipika"),children:[function(e){let t=M[e];if(!t){let a=f()(Array(3*e),"&nbsp;").join("");t=M[e]=(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:a}})}return t}(t),c&&(0,n.jsx)(j,{collapsed:d,path:c,onToggle:y}),(0,n.jsx)(I,{text:l,settings:h,matched:g?.keyMatch,filter:m}),a&&(0,n.jsx)(P,{type:a,settings:h}),void 0!==u&&(0,n.jsx)("span",{className:"unipika",children:S("context_items-count",{count:u})}),void 0!==i&&(0,n.jsx)(D,{text:i,settings:h,matched:g?.valueMatch,filter:m,showFullText:w,maxValueWidth:e.maxValueWidth}),d&&void 0===u&&(0,n.jsx)("span",{className:"unipika",children:"..."}),s&&(0,n.jsx)(P,{type:s,settings:h,close:!0}),o&&(0,n.jsx)(_,{text:","})]})}function I(e){var t;let a=(t=e,t?.text?F(t,v("key")):null);return a?(0,n.jsxs)(r.Fragment,{children:[a,(0,n.jsx)(_,{text:": "})]}):null}function D(e){var t,a;return(0,n.jsx)(r.Fragment,{children:(t=e,a=v("value",{type:e.text?.$type}),"string"===t.text?.$type?F(t,a):function(e,t){let{text:a,filter:r,settings:s,matched:l}=e,i=null;if(l&&r){let e=T.Kd.format(a,{...s,asHTML:!1});i=(0,n.jsx)(x,{className:N(t),text:e,starts:l,length:r?.length})}else i=a?function(e,t=T.AI){let a=T.Kd.formatValue(e,{...T.AI,...t},0);return(0,n.jsx)("span",{className:"unipika",dangerouslySetInnerHTML:{__html:a}})}(a,s):void 0;return i||null}(t,v("value")))})}function F(e,t){let{text:a,settings:r=T.AI,matched:s=[],filter:l,showFullText:i,maxValueWidth:o=1/0}=e,c=T.Kd.format(a,{...r,maxStringSize:10,asHTML:!1}),d=c.length,h=c.substring(1,Math.min(d-1,o+1)),p=h.length<c.length-2,g=!1;if(p){for(let e=s.length-1;e>=0;--e)if(h.length<s[e]+(l?.length||0)){g=!0;break}}return(0,n.jsxs)("span",{children:[(0,n.jsx)(x,{className:N(t),text:h,starts:s,length:l?.length}),p&&(0,n.jsxs)("span",{className:v("filtered",{highlighted:g,clickable:!0}),onClick:i,children:["â€¦",(0,n.jsx)(u.I,{data:k.A})]})]})}function _({text:e}){return(0,n.jsx)("span",{children:e})}function P(e){let{type:t,close:a}=e;switch(t){case"array":return(0,n.jsx)(_,{text:a?"]":"["});case"object":return(0,n.jsx)(_,{text:a?"}":"{"})}}let M={};var A=a(33777),L=a(20008),O=a(39355),$=a(24302);let H=r.forwardRef(function({matchIndex:e,matchedRows:t,value:a,onUpdate:r,onKeyDown:s,onNextMatch:l,onPrevMatch:i,caseSensitive:h,onUpdateCaseSensitive:p},g){let m=t.length;return(0,n.jsxs)(o.s,{gap:2,wrap:"nowrap",children:[(0,n.jsx)(A.k,{ref:g,className:v("filter"),hasClear:!0,size:"m",type:"text",value:a,placeholder:S("description_search"),onUpdate:r,autoFocus:!1,onKeyDown:s,endContent:(0,n.jsx)(c.m,{title:h?S("context_case-sensitive-search"):S("context_case-sensitive-search-disabled"),children:(0,n.jsx)(d.$,{view:"flat-secondary",onClick:p,selected:h,children:(0,n.jsx)(u.I,{data:$.A})})})}),(0,n.jsxs)(o.s,{gap:1,wrap:"nowrap",children:[(0,n.jsx)(c.m,{title:S("action_next"),placement:"top-start",children:(0,n.jsx)(d.$,{className:v("match-btn"),view:"flat-secondary",onClick:l,disabled:!m,children:(0,n.jsx)(u.I,{data:L.A})})}),(0,n.jsx)(c.m,{title:S("action_back"),placement:"top-start",children:(0,n.jsx)(d.$,{className:v("match-btn"),view:"flat-secondary",onClick:i,disabled:!m,children:(0,n.jsx)(u.I,{data:O.A})})})]}),a&&(0,n.jsxs)("span",{className:v("match-counter"),title:S("description_matched-rows"),children:[m?1+e%m:0," / ",m||0]})]})});var R=a(74101);function E({onClose:e,text:t,starts:a,length:r}){return(0,n.jsxs)(R.l,{open:!0,onClose:e,onOutsideClick:e=>{e.stopPropagation()},children:[(0,n.jsx)(R.l.Header,{caption:S("description_full-value")}),(0,n.jsx)(R.l.Divider,{}),(0,n.jsx)(R.l.Body,{children:(0,n.jsx)(o.s,{direction:"column",gap:2,width:"70vw",maxHeight:"80vh",children:(0,n.jsx)("div",{className:v("full-value"),children:(0,n.jsx)(x,{className:N(),starts:a,text:t,length:r})})})})]})}function U(e,t){let a={dst:[],levels:[],path:[],collapsedState:t?.collapsedState||{},matchedPath:"",collapsedPath:""};q(e,0,a);let n=function(e,t,a){if(!t)return{};let n=Object.assign({},a?.settings,{asHTML:!1}),r={};for(let s=0;s<e.length;++s){let{key:l,value:i}=e[s],o=Z(l,t,n,a?.caseSensitive),c=Z(i,t,n,a?.caseSensitive);(o||c)&&(r[s]=Object.assign({},o&&{keyMatch:o},c&&{valueMatch:c}))}return r}(a.dst,t?.filter,{settings:t?.settings,caseSensitive:t?.caseSensitive});return{data:a.dst,searchIndex:n}}function q(e,t=0,a){var n;let r=a.dst.length,{type:s}=a.levels[a.levels.length-1]||{},l="object"===s?r-1:a.dst.length,i=V(a),o="map"===(n=e).$type||"list"===n.$type,c=0;i?W(e,t,a):c=function(e,t,a,n){let r=0;if(e&&V(n))W(t,a,n);else switch(t.$type){case"map":var s,l,i;let o;s=t,o=z("object",l=a,i=n,s.$value.length),function(e,t,a,n){for(let r=0;r<e.length;++r){let[s,l]=e[r],i={key:s,level:t};a.dst.push(i),K(s.$value,a),q(l,t,a),++n.currentIndex,Q(a)}}(s.$value,l+1,i,o),J("object",l,i),r=t.$value.length;break;case"list":(function(e,t,a){let{$value:n}=e,r=z("array",t,a,n.length);for(let e=0;e<n.length;++e)K(String(e),a),q(n[e],t+1,a),++r.currentIndex,Q(a);J("array",t,a)})(t,a,n),r=t.$value.length;break;default:(function(e,t){let a=Y(t.dst);a&&!a.open?Object.assign(a,e,{level:a.level}):t.dst.push(e);let n=t.dst[t.dst.length-1];X(t)&&(n.hasDelimiter=!0)})(function(e,t){let{$attributes:a,...n}=e;return{level:t,value:n}}(t,a),n)}return r}(o,e,t,a),o&&c&&(a.dst[l].depth=c,G(a,l))}function W(e,t,a){switch(e.$type){case"map":B("object",t,a,e.$value.length);break;case"list":B("array",t,a,e.$value.length)}}function B(e,t,a,n){z(e,t,a,0);let r=a.dst[a.dst.length-1];r.depth=n,r.collapsed=!0,G(a,a.dst.length-1),J(e,t,a)}function G(e,t){e.collapsedPath.length&&(e.dst[t].path=e.collapsedPath)}function K(e,t){t.path.push(e),t.collapsedPath=t.collapsedPath.length?t.collapsedPath+"/"+e:e}function Q(e){let t=e.path.pop();void 0!==t&&(e.collapsedPath=e.collapsedPath.substring(0,e.collapsedPath.length-t.length-1))}function V(e){return!!e.collapsedState[e.collapsedPath]}function z(e,t,a,n){let{dst:r}=a,s=Y(r);s?.key&&s.level===t?s.open=e:r.push({level:t,open:e});let l={type:e,length:n,currentIndex:0};return a.levels.push(l),l}function J(e,t,a){let n=a.levels.pop();if(n.type!==e)throw Error(`The unipika tree cannot be converted to array, there is some mess with levels 
${JSON.stringify({type:e,level:t,info:n,ctx:a},null,2)}`);let r=a.dst[a.dst.length-1],s=r.level===t&&r.open===e,l=s?r:{level:t,close:e};X(a)&&(l.hasDelimiter=!0),s?l.close=e:a.dst.push(l)}function X(e){let{length:t,currentIndex:a}=e.levels[e.levels.length-1]||{};return void 0!==t&&a<t-1}function Y(e){let t=e[e.length-1];return t?.key&&!t?.close?t:null}function Z(e,t,a,n){if(!e)return;let r=[],s=T.Kd.formatValue(e,a);if(!s)return;s=String(s),"string"===e.$type&&(s=s.substring(1,s.length-1));let l=0,i=t;for(n||(s=s.toLowerCase(),i=t.toLowerCase());l>=0&&l<s.length;){let e=s.indexOf(i,l);if(-1===e)break;l=e+i.length,r.push(e)}return r.length?r:void 0}let ee={displayIndices:!1,dynamicRender:!0,sortable:!1,dynamicRenderMinSize:50};function et(e){let{data:t}=U(e);return t.reduce((e,{path:t})=>(t&&(e[t]=!0),e),{})}function ea(e,t,a,n){let r=U(e,{collapsedState:t,filter:a,caseSensitive:n});return Object.assign({},{flattenResult:r,matchedRows:Object.keys(r.searchIndex).map(Number)})}function en(e){let{value:t}=e;return"_error"in t?t._error:(0,n.jsx)(er,{...e,value:t})}function er({tableSettings:e,value:t,unipikaSettings:a,search:m=!0,extraTools:f,collapsedInitially:b,maxValueWidth:x=100,toolbarClassName:j,withClipboardButton:y}){let[w,N]=(0,p.iK)(h.GS.CASE_SENSITIVE_JSON_SEARCH,!1),[k,I]=r.useState(()=>b?et(t):{}),[D,F]=r.useState(""),[_,P]=r.useState(()=>ea(t,k,D,w)),[M,A]=r.useState(-1),[L,O]=r.useState(),$=r.useRef(null),R=r.useRef(null),U=r.useMemo(()=>({...ee,dynamicInnerRef:$,...e}),[e]),q=({row:e,index:t})=>{let{flattenResult:{searchIndex:r}}=_;return(0,n.jsx)(C,{matched:r[t],row:e,settings:a,onToggleCollapse:W,filter:D,showFullText:Q,index:t,maxValueWidth:x})},W=e=>{let t={...k};t[e]?delete t[e]:t[e]=!0,B({collapsedState:t})},B=(e,a)=>{let{collapsedState:n,matchIndex:r,filter:s,caseSensitive:l}=e;void 0!==n&&I(n),void 0!==r&&A(r),void 0!==s&&F(s),P(ea(t,n??k,s??D,l??w)),a?.()},G=(e,t=1)=>{let{matchedRows:a}=_;if(!a.length)return;let n=(M+t)%a.length;n<0&&(n=a.length+n),n!==M&&A(n),$.current?.scrollTo(a[n]-6),R.current?.focus()},K=()=>{G(null,-1)},Q=e=>{let{flattenResult:{searchIndex:t,data:a}}=_;O({value:a[e].value,searchInfo:t[e]})},V=()=>{O(void 0)};return(0,n.jsxs)("div",{className:v(),children:[(0,n.jsxs)(o.s,{gap:2,wrap:"nowrap",className:v("toolbar",j),justifyContent:"space-between",children:[m&&(0,n.jsx)(H,{onUpdate:e=>{B({filter:e,matchIndex:0},()=>{G(null,0)})},matchIndex:M,matchedRows:_.matchedRows,value:D,ref:R,onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey?K():G(null))},onNextMatch:G,onPrevMatch:K,caseSensitive:w,onUpdateCaseSensitive:()=>{let e=!w;N(e),B({caseSensitive:e})}}),(0,n.jsxs)(o.s,{gap:2,wrap:"nowrap",children:[(0,n.jsx)(c.m,{title:S("action_expand-all"),placement:"top-start",children:(0,n.jsx)(d.$,{onClick:()=>{B({collapsedState:{}},()=>{G(null,0)})},children:(0,n.jsx)(u.I,{data:s.A})})}),(0,n.jsx)(c.m,{title:S("action_collapse-all"),placement:"top-start",children:(0,n.jsx)(d.$,{onClick:()=>{B({collapsedState:et(t)})},children:(0,n.jsx)(u.I,{data:l.A})})}),y&&(0,n.jsx)(g.b,{...y,size:"m",view:"normal"}),f]})]}),(()=>{let{flattenResult:{data:e}}=_;return(0,n.jsx)("div",{className:v("content"),children:(0,n.jsx)(i.Ay,{columns:[{name:"content",render:q,header:null}],data:e,theme:"yson",settings:U,rowClassName:()=>v("row")})})})(),(()=>{let{value:e,searchInfo:t}=L??{},r=T.Kd.format(e,{...a,asHTML:!1});return e&&(0,n.jsx)(E,{onClose:V,starts:t?.valueMatch||[],text:r.substring(1,r.length-1),length:D.length})})()]})}},46371:function(e,t,a){"use strict";a.d(t,{AI:()=>l,Kd:()=>s,lu:()=>i,qI:()=>o});var n=a(96540),r=a(52402);let s=a.n(r)()({}),l={asHTML:!0,format:"json",compact:!1,escapeWhitespace:!0,showDecoded:!0,binaryAsHex:!1,indent:2,decodeUTF8:!1};function i(e){let t;if(!e)return e;try{t=s.converters.yson(e,l)}catch(e){console.error(e),t={_error:"JSON is invalid"}}return t}function o(e){return n.useMemo(()=>i(e),[e])}},4320:function(e,t,a){"use strict";a.d(t,{v:()=>n.v});var n=a(29472)},66660:function(e,t,a){"use strict";a.d(t,{i:()=>l});var n=a(74848),r=a(5434),s=a(53486);function l({state:e}){return(0,n.jsx)(r.J,{theme:(0,s._)(e),children:e})}},2819:function(e,t,a){"use strict";a.d(t,{U:()=>W});var n=a(74848),r=a(96540),s=a(81392),l=a(48849),i=a(1459),o=a(25247),c=a(67103),d=a(81537),u=a(46371),h=a(42724);let p=a(56496).F.injectEndpoints({endpoints:e=>({getFeatureFlags:e.query({queryFn:async({database:e},{signal:t})=>{try{return{data:(await window.api.viewer.getFeatureFlags(e,{signal:t})).Databases[0].FeatureFlags}}catch(e){return{error:e}}},providesTags:["All"]}),getConfig:e.query({queryFn:async({database:e},{signal:t})=>{try{let{StartupConfigYaml:a,...n}=await window.api.viewer.getConfig(e,{signal:t});return{data:{current:n,startup:String(a)}}}catch(e){return{error:e}}},providesTags:["All"]})}),overrideExisting:"throw"});var g=a(46385),m=a(51432),f=JSON.parse('{"td-feature-flag":"Feature flag","td-default":"Default","td-current":"Current","enabled":"Enabled","disabled":"Disabled","flag-touched":"Flag is changed","search-placeholder":"Search...","search-empty":"Empty search result","no-data":"No data","title_current":"Current","title_startup":"Startup","title_features":"Feature flags","action_copy-config":"Copy config"}');let b=(0,m.g4)("ydb-diagnostics-configs",{en:f});function x({database:e}){let[t]=(0,g.N)(),{currentData:a,isLoading:s,error:l}=p.useGetConfigQuery({database:e},{pollingInterval:t}),{current:i}=a||{},o=(0,u.qI)(i),m=r.useMemo(()=>JSON.stringify(i,null,4),[i]);return(0,n.jsxs)(h.r,{loading:s,children:[i?(0,n.jsx)(d.p,{value:o,collapsedInitially:!0,withClipboardButton:{copyText:m,withLabel:b("action_copy-config")}}):null,l?(0,n.jsx)(c.o,{error:l}):null]})}var v=a(17093),j=a(29901),y=a(17427),w=a(50626),S=a(74010),T=a(4320),N=a(35537),k=a(81882),C=a(22708),I=a(14476);let D={current:"current",features:"features",startup:"startup"};I.z.nativeEnum(D).catch(D.current);let F={get current(){return b("title_current")},get features(){return b("title_features")},get startup(){return b("title_startup")}},_=[D.current,D.startup,D.features],P=(0,C.createEnumParam)(_),M=(0,C.withDefault)(P,"current");function A(){let e=(0,i._Q)(),t=(0,i.a9)(),[{configType:a,search:n},s]=(0,C.useQueryParams)({configType:M,search:C.StringParam}),l=r.useCallback(e=>{s({configType:e||void 0},"replaceIn")},[s]),o=r.useCallback(e=>{s({search:e||void 0},"replaceIn")},[s]);return r.useEffect(()=>{t||e?e||a!==D.features?l(D.features):l(D.current):l(void 0)},[e,t]),{configType:a,handleConfigTypeChange:l,search:n,handleSearchChange:o}}let L=(0,o.cn)("ydb-feature-flags"),O=[{name:"Touched",header:"",render:({row:e})=>e.Current?(0,n.jsx)(j.A,{content:b("flag-touched"),className:L("icon-touched",N.zQ),placement:"left",children:(0,n.jsx)(y.I,{data:v.A})}):null,width:36,sortable:!1,resizeable:!1},{name:"Name",get header(){return b("td-feature-flag")},render:({row:e})=>e.Current?(0,n.jsx)("b",{children:e.Name}):e.Name,width:400,sortable:!0,sortAccessor:({Current:e,Name:t})=>Number(!e)+t.toLowerCase()},{name:"Default",get header(){return b("td-default")},render:({row:e})=>{switch(e.Default){case!0:return b("enabled");case!1:return b("disabled");default:return"-"}},width:100,sortable:!1,resizeable:!1},{name:"Current",get header(){return b("td-current")},render:({row:e})=>(0,n.jsx)(w.d,{disabled:!0,checked:(e.Current??e.Default)||!1}),width:100,sortable:!1,resizeable:!1}],$=({database:e,className:t})=>{let{search:a,handleSearchChange:r}=A(),[s]=(0,k.Nt)(),{currentData:i=[],isLoading:o,error:d}=p.useGetFeatureFlagsQuery({database:e},{pollingInterval:s}),u=a?.toLocaleLowerCase(),h=u?i.filter(e=>e.Name.toLocaleLowerCase().includes(u)):i;return(0,n.jsxs)(l.L,{className:t,children:[(0,n.jsx)(l.L.Controls,{children:(0,n.jsx)(T.v,{value:u,onChange:r,placeholder:b("search-placeholder"),width:300})}),(0,n.jsx)(l.L.Table,{loading:o,children:d?(0,n.jsx)(c.o,{error:d}):(0,n.jsx)(S.l,{emptyDataMessage:b(u?"search-empty":"no-data"),columnsWidthLSKey:"featureFlagsColumnsWidth",columns:O,data:h,settings:N.N3})})]})};var H=a(94169),R=a(34495);let E={automaticLayout:!0,selectOnLineNumbers:!0,readOnly:!0,minimap:{enabled:!1},wrappingIndent:"indent"};function U({database:e,className:t}){let[a]=(0,g.N)(),r=(0,H.i)(),{currentData:s,isLoading:l,error:i}=p.useGetConfigQuery({database:e},{pollingInterval:a}),{startup:o}=s||{};return(0,n.jsxs)(h.r,{loading:l,children:[i?(0,n.jsx)(c.o,{error:i}):null,o?(0,n.jsx)("div",{className:t,children:(0,n.jsx)(R.default,{language:"yaml",value:o,options:E,theme:`vs-${r}`})}):null]})}let q=(0,o.cn)("ydb-configs");function W({database:e,className:t,scrollContainerRef:a}){let{configType:s}=A(),o=(0,i._Q)(),c=(0,i.a9)(),d=r.useMemo(()=>{let e=[];return o&&e.push(D.features),c&&(e.push(D.current),e.push(D.startup)),e},[o,c]);return(0,n.jsxs)(l.L,{fullHeight:!0,className:q(null,t),children:[(0,n.jsx)(l.L.Controls,{children:(0,n.jsx)(B,{options:d})}),(0,n.jsx)(l.L.Table,{scrollContainerRef:a,children:(()=>{switch(s){case D.current:return(0,n.jsx)(x,{database:e});case D.startup:return(0,n.jsx)(U,{database:e,className:q("startup")});case D.features:return(0,n.jsx)($,{database:e,className:q("feature-flags")})}})()})]})}function B({options:e}){let{configType:t,handleConfigTypeChange:a}=A();return e.length?(0,n.jsx)(s.x,{value:t,onUpdate:a,children:e.map(e=>(0,n.jsx)(s.x.Option,{value:e,children:F[e]},e))}):null}},48515:function(e,t,a){"use strict";a.d(t,{Df:()=>r,P0:()=>l,pW:()=>s});var n=a(49106);let r=["database","static","other","any"],s={get database(){return(0,n.A)("database")},get static(){return(0,n.A)("static")},get other(){return(0,n.A)("other")},get any(){return(0,n.A)("any")}};function l(e,t){return r.find(t=>t===e)??t}},81788:function(e,t,a){"use strict";a.d(t,{Ch:()=>d,S$:()=>l,fZ:()=>i,iw:()=>c,jr:()=>r,uS:()=>s});var n=a(87669);let r="nodesTableSelectedColumns",s=["NodeId","Host","Uptime","CPU","RAM","Version","Tablets"],l=["NodeId"],i=["SystemState","Host","DC","Rack","Database","Version","Uptime"];function o(e,t){return t?e:e.filter(e=>"SystemState"!==e)}function c(e,t){return o(e,t).map(e=>({value:e,content:(0,n.kn)(e)}))}function d(e,t,a){return o(t,a).find(t=>t===e)}},49106:function(e,t,a){"use strict";a.d(t,{A:()=>s});var n=a(51432),r=JSON.parse('{"nodes":"Nodes","empty.default":"No such nodes","no-nodes-groups":"No nodes groups","controls_search-placeholder":"Host name","controls_group-by-placeholder":"Group by:","controls_peer-role-label":"Peer role:","database":"database","static":"static","other":"other","any":"any"}');let s=(0,n.g4)("ydb-nodes",{en:r})},93658:function(e,t,a){"use strict";a.d(t,{y:()=>d});var n=a(96540),r=a(22708),s=a(1459),l=a(88831),i=a(65101),o=a(48515),c=a(81788);function d(e,t){let a,[d,u]=(0,r.useQueryParams)({uptimeFilter:r.StringParam,peerRole:r.StringParam,search:r.StringParam,nodesGroupBy:r.StringParam,withProblems:r.BooleanParam}),h=(0,l.b)(),p=i.Bm.parse(d.uptimeFilter),g=d.search??"",m=!!d.withProblems;t&&(a=h?(0,o.P0)(d.peerRole,"database"):"database");let f=(0,s.DM)(),b=(0,c.Ch)(d.nodesGroupBy,e??[],f),x=n.useCallback(e=>{u({search:e||void 0},"replaceIn")},[u]),v=n.useCallback(e=>{u({uptimeFilter:e},"replaceIn")},[u]),j=n.useCallback(e=>{u({peerRole:e},"replaceIn")},[u]);return{uptimeFilter:p,searchValue:g,peerRoleFilter:a,groupByParam:b,withProblems:m,handleSearchQueryChange:x,handleUptimeFilterChange:v,handlePeerRoleFilterChange:j,handleGroupByParamChange:n.useCallback(e=>{u({nodesGroupBy:e},"replaceIn")},[u]),handleWithProblemsChange:n.useCallback(e=>{u({withProblems:e||void 0},"replaceIn")},[u])}}},6168:function(e,t,a){"use strict";a.d(t,{Q:()=>D});var n=a(74848),r=a(96540),s=a(28722),l=a(77269),i=a(17427),o=a(2543),c=a(22708),d=a(32692),u=a(61058),h=a(93397),p=a(67103),g=a(29432),m=a(74010),f=a(29472),b=a(48849),x=a(50668),v=a(66660),j=a(9753),y=a(56946),w=a(35537),S=a(88831),T=a(51432),N=JSON.parse('{"noTabletsData":"No tablets data","Type":"Type","Tablet":"Tablet","State":"State","Node ID":"Node ID","Node FQDN":"Node FQDN","Generation":"Generation","Uptime":"Uptime","dialog.kill-header":"Restart tablet","dialog.kill-text":"The tablet will be restarted. Do you want to proceed?","controls.kill-not-allowed":"You don\'t have enough rights to restart tablet","controls.kill-impossible-follower":"It\'s impossible to restart a follower","controls.search-placeholder":"Tablet ID","controls.entities-count-label":"Tablets"}');let k=(0,T.g4)("ydb-tablets",{en:N});function C(e){return!1===e.Leader}function I(e){let t,a=C(e),r="Stopped"===e.State||a,l=(0,S.X)(),[o]=y.X.useKillTabletMutation(),c=e.TabletId;return c?(t=a?k("controls.kill-impossible-follower"):l?k("dialog.kill-header"):k("controls.kill-not-allowed"),(0,n.jsx)(d.B,{buttonView:"outlined",dialogHeader:k("dialog.kill-header"),dialogText:k("dialog.kill-text"),onConfirmAction:()=>o({id:c}).unwrap(),buttonDisabled:r||!l,withPopover:!0,popoverContent:t,popoverPlacement:["right","bottom"],popoverDisabled:!1,children:(0,n.jsx)(i.I,{data:s.A})})):null}function D({tablets:e,loading:t,error:a,scrollContainerRef:s,nodeId:i}){let[{tabletsSearch:d},y]=(0,c.useQueryParams)({tabletsSearch:c.StringParam}),[S,T]=r.useState(),N=r.useMemo(()=>(function({nodeId:e}){let t=[{name:"Type",width:150,get header(){return k("Type")},render:({row:e})=>{let t=C(e);return(0,n.jsxs)("span",{children:[e.Type," ",t?(0,n.jsx)(l.E,{color:"secondary",children:"follower"}):""]})}},{name:"TabletId",width:220,get header(){return k("Tablet")},render:({row:e})=>e.TabletId?(0,n.jsx)(x.$,{tabletId:e.TabletId,followerId:e.FollowerId||void 0}):w.Pd},{name:"State",get header(){return k("State")},render:({row:e})=>(0,n.jsx)(v.i,{state:e.State})}];return void 0===e&&t.push({name:"NodeId",get header(){return k("Node ID")},render:({row:e})=>(0,o.isNil)(e.NodeId)?w.Pd:(0,n.jsx)(g.W,{id:e.NodeId}),align:"right"},{name:"fqdn",get header(){return k("Node FQDN")},render:({row:e})=>e.fqdn?(0,n.jsx)(h.c,{name:e.fqdn,showStatus:!1,hasClipboardButton:!0}):w.Pd}),t.push({name:"Generation",get header(){return k("Generation")},align:"right"},{name:"Uptime",get header(){return k("Uptime")},render:({row:e})=>(0,n.jsx)(j.H,{ChangeTime:e.ChangeTime}),sortAccessor:e=>-Number(e.ChangeTime),align:"right",width:120},{name:"Actions",sortable:!1,resizeable:!1,header:"",render:({row:e})=>(0,n.jsx)(I,{...e})}),t})({nodeId:i}),[i]),D=r.useMemo(()=>e.filter(e=>String(e.TabletId).includes(d??"")),[e,d]);return(0,n.jsxs)(b.L,{fullHeight:!0,children:[(0,n.jsxs)(b.L.Controls,{children:[(0,n.jsx)(f.v,{placeholder:k("controls.search-placeholder"),onChange:e=>{y({tabletsSearch:e||void 0},"replaceIn")},value:d??"",width:238}),(0,n.jsx)(u.T,{label:k("controls.entities-count-label"),loading:t,total:e.length,current:D.length})]}),a?(0,n.jsx)(p.o,{error:a}):null,(0,n.jsx)(b.L.Table,{scrollContainerRef:s,scrollDependencies:[d,S],loading:t,children:(0,n.jsx)(m.l,{columns:N,data:D,settings:w.N3,emptyDataMessage:k("noTabletsData"),onSortChange:T})})]})}},56946:function(e,t,a){"use strict";a.d(t,{X:()=>r});var n=a(65101);let r=a(56496).F.injectEndpoints({endpoints:e=>({getTablet:e.query({queryFn:async({id:e,database:t,followerId:a},{signal:r})=>{try{let[s,l,i]=await Promise.all([window.api.viewer.getTablet({id:e,database:t,followerId:a},{signal:r}),window.api.viewer.getTabletHistory({id:e,database:t},{signal:r}),window.api.viewer.getNodesList({database:t},{signal:r})]),o=(0,n.nN)(i),c=Object.keys(l).reduce((e,t)=>{let a=l[t]?.TabletStateInfo;return a?.forEach(a=>{let{ChangeTime:n,Generation:r,State:s,Leader:l,FollowerId:i}=a,c=o&&t?o.get(Number(t))?.Host:void 0;e.push({nodeId:t,generation:r,changeTime:n,state:s,leader:l,followerId:i,fqdn:c})}),e},[]),{TabletStateInfo:d=[]}=s,u=void 0===a?d.find(e=>e.Leader):d.find(e=>e.FollowerId?.toString()===a),{TabletId:h}=u||{};return{data:{id:h,data:u,history:c}}}catch(e){return{error:e}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),getTabletDescribe:e.query({queryFn:async({tenantId:e,database:t},{signal:a})=>{try{let n=await window.api.viewer.getTabletDescribe(e,t,{signal:a}),{SchemeShard:r,PathId:s}=e;return{data:n?.Path||`${r}:${s}`}}catch(e){return{error:e}}},providesTags:["All"]}),getAdvancedTableInfo:e.query({queryFn:async({id:e,hiveId:t},{signal:a})=>{try{return{data:await window.api.tablets.getTabletFromHive({id:e,hiveId:t},{signal:a})}}catch(e){return{error:e}}},providesTags:(e,t,a)=>["All",{type:"Tablet",id:a.id}]}),killTablet:e.mutation({queryFn:async({id:e})=>{try{return{data:await window.api.tablets.killTablet(e)}}catch(e){return{error:e}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),stopTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.stopTablet(e,t)}}catch(e){return{error:e}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]}),resumeTablet:e.mutation({queryFn:async({id:e,hiveId:t})=>{try{return{data:await window.api.tablets.resumeTablet(e,t)}}catch(e){return{error:e}}},invalidatesTags:(e,t,a)=>[{type:"Tablet",id:a.id},{type:"Tablet",id:"LIST"}]})}),overrideExisting:"throw"})}}]);