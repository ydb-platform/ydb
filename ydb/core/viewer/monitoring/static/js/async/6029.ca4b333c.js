"use strict";(globalThis.webpackChunkydb_embedded_ui=globalThis.webpackChunkydb_embedded_ui||[]).push([["6029"],{50504:function(e,t,a){a.d(t,{V:()=>p});var i=a(74848);a(96540);var r=a(17427),s=a(85169),n=a(2837),l=a(25247),o=a(95980),d=a(7360),u=a(61738),c=a(28241);let m=(0,l.cn)("storage-disk-progress-bar");function p({diskAllocatedPercent:e=-1,severity:t,compact:a,faded:l,inactive:p,empty:h,content:g,striped:f,className:k,isDonor:v,withIcon:x,highlighted:S,noDataPlaceholder:N}){let[y]=(0,u.iK)(n.GS.INVERTED_DISKS),D={inverted:y,compact:a,faded:l,empty:h,inactive:p,striped:f,highlighted:S};if(v)D[o.r4.toLocaleLowerCase()]=!0;else{let e=void 0!==t&&(0,d.XY)(t);e&&(D[e.toLocaleLowerCase()]=!0)}let b=(0,c.kf)(e)&&e>=0,w=null;if(x){let e=(0,d.PH)(t,v);e&&(w=(0,i.jsx)(r.I,{className:m("icon"),data:e,size:12}))}let P=!!w;return(0,i.jsxs)(s.s,{alignItems:"center",justifyContent:P?"space-between":"flex-end",className:m(D,k),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":b?e:void 0,children:[w,(()=>{if(a)return(0,i.jsx)("div",{className:m("fill-bar",D),style:{width:"100%"}});if(!b)return null;let t=Math.min(e,100);return y&&(t=Math.max(100-e,0)),(0,i.jsx)("div",{className:m("fill-bar",D),style:{width:`${t}%`}})})(),g||(!a&&b?(0,i.jsx)("div",{className:m("title"),children:`${Math.floor(e)}%`}):a||b||!N?null:(0,i.jsx)("div",{className:m("title"),children:N}))]})}},78799:function(e,t,a){a.d(t,{U:()=>c});var i=a(74848),r=a(24629),s=a(78636),n=a(78870),l=a(51432),o=JSON.parse('{"default_message":"Everything is fine!","default_button_label":"Show All"}'),d=JSON.parse('{"default_message":"Всё в порядке!","default_button_label":"Показать все"}');let u=(0,l.g4)("ydb-storage-empty-filter",{ru:d,en:o}),c=({title:e,message:t=u("default_message"),showAll:a=u("default_button_label"),onShowAll:l,image:o=(0,i.jsx)(n.v,{name:"thumbsUp",width:200})})=>(0,i.jsx)(s.pp,{image:o,position:"left",title:e,description:t,actions:l&&[(0,i.jsx)(r.$,{onClick:l,children:a},"show-all")]})},15474:function(e,t,a){a.d(t,{P:()=>u});var i=a(74848),r=a(96540),s=a(54403),n=a(38221),l=a.n(n),o=a(35537);let d=100,u=({children:e,renderPopupContent:t,showPopup:a,offset:n,anchorRef:u,onShowPopup:c,onHidePopup:m,placement:p=["top","bottom"],contentClassName:h,delayClose:g=d,delayOpen:f=d})=>{let[k,v]=r.useState(!1),[x,S]=r.useState(!1),[N,y]=r.useState(!1),D=r.useRef(null),b=r.useRef(!1),w=r.useCallback(e=>{b.current!==e&&(b.current=e,e?c?.():m?.())},[c,m]),P=r.useMemo(()=>l()(()=>{v(!0),w(!0)},f),[f,w]),A=r.useCallback(()=>{v(!1)},[]),I=r.useMemo(()=>l()(()=>{A(),w(!1)},g),[g,w,A]),C=r.useCallback(()=>{I.cancel(),S(!0),w(!0)},[w,I]),j=r.useCallback(()=>{S(!1),I()},[I]),M=r.useCallback(()=>{y(!0),w(!0)},[w]),U=r.useCallback(()=>{y(!1)},[]),E=r.useCallback(()=>{y(!1),S(!1),A(),w(!1)},[A,w]),T=u?.current||D.current;return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)("span",{ref:D,onMouseEnter:()=>{I.cancel(),P()},onMouseLeave:()=>{P.cancel(),I()},children:e}),T?(0,i.jsx)(s.z,{anchorElement:T,onOpenChange:(e,t,a)=>{"escape-key"===a&&E()},placement:p,hasArrow:!0,open:k||x||N||a,offset:n||{mainAxis:12,crossAxis:0},children:(0,i.jsx)("div",{className:h,onContextMenu:M,onMouseEnter:C,onMouseLeave:j,onBlur:U,children:(0,i.jsx)("div",{className:o.zQ,children:t()})})}):null]})}},11342:function(e,t,a){a.d(t,{A:()=>s});var i=a(51432),r=JSON.parse('{"text_external-consumption":"External Consumption","text_allocator-caches":"Allocator Caches","text_shared-cache":"Shared Cache","text_memtable":"MemTable","text_query-execution":"Query Execution","text_usage":"Usage","text_soft-limit":"Soft Limit","text_hard-limit":"Hard Limit","text_other":"Other","text_memory-details":"Memory Details"}');let s=(0,i.g4)("ydb-memory-viewer",{en:r})},26552:function(e,t,a){a.d(t,{AB:()=>o,HW:()=>s,Sb:()=>d});var i=a(28241),r=a(11342);function s(e){return String((n(e.AllocatedMemory)||0)+(n(e.AllocatorCachesMemory)||0))}function n(e){return(0,i.kf)(e)?parseFloat(String(e)):void 0}let l={AllocatorCachesMemory:"var(--g-color-base-danger-medium)",SharedCacheConsumption:"var(--g-color-base-info-medium)",MemTableConsumption:"var(--g-color-base-warning-medium)",QueryExecutionConsumption:"var(--g-color-base-positive-medium)",Other:"var(--g-color-base-neutral-medium)"};function o(e){return l[e]||l.Other}function d(e,t){let a=[{label:(0,r.A)("text_shared-cache"),key:"SharedCacheConsumption",value:n(e.SharedCacheConsumption),capacity:n(e.SharedCacheLimit),isInfo:!1},{label:(0,r.A)("text_query-execution"),key:"QueryExecutionConsumption",value:n(e.QueryExecutionConsumption),capacity:n(e.QueryExecutionLimit),isInfo:!1},{label:(0,r.A)("text_memtable"),key:"MemTableConsumption",value:n(e.MemTableConsumption),capacity:n(e.MemTableLimit),isInfo:!1},{label:(0,r.A)("text_allocator-caches"),key:"AllocatorCachesMemory",value:n(e.AllocatorCachesMemory),isInfo:!1}],i=Math.max(0,t-a.filter(e=>void 0!==e.value).reduce((e,t)=>e+t.value,0));return a.push({label:(0,r.A)("text_other"),key:"Other",value:i,isInfo:!1}),a.push({label:(0,r.A)("text_external-consumption"),key:"ExternalConsumption",value:n(e.ExternalConsumption),isInfo:!0},{label:(0,r.A)("text_usage"),key:"Usage",value:t,isInfo:!0},{label:(0,r.A)("text_soft-limit"),key:"SoftLimit",value:n(e.SoftLimit),isInfo:!0},{label:(0,r.A)("text_hard-limit"),key:"HardLimit",value:n(e.HardLimit),isInfo:!0}),a.filter(e=>void 0!==e.value)}},79517:function(e,t,a){a.d(t,{D:()=>s});var i=a(51432),r=JSON.parse('{"type":"Type","path":"Path","guid":"GUID","serial-number":"Serial Number","shared-with-os":"SharedWithOs","drive-status":"Drive Status","state":"State","device":"Device","realtime":"Realtime","space":"Space","usage":"Usage","slots":"Slots","log-size":"Log Size","system-size":"System Size","links":"Links","developer-ui":"Developer UI","yes":"Yes"}');let s=(0,i.g4)("ydb-pDisk-info",{en:r})},39235:function(e,t,a){a.d(t,{L:()=>d});var i=a(74848),r=a(8946),s=a(60318),n=a(51432),l=JSON.parse('{"pdisk-page":"PDisk page"}');let o=(0,n.g4)("ydb-pDisk-link",{en:l});function d({pDiskId:e,nodeId:t}){return(0,i.jsx)(s.K,{title:o("pdisk-page"),url:(0,r.Ck)(e,t),external:!1})}},78331:function(e,t,a){a.d(t,{fX:()=>A,Oy:()=>j,pF:()=>C,JT:()=>I});var i=a(74848),r=a(96540),s=a(5434),n=a(85169),l=a(2543),o=a(56321),d=a(40897),u=a(35537),c=a(88387),m=a(93639),p=a(95980),h=a(61738),g=a(81709),f=a(88831),k=a(28241),v=a(60318),x=a(79517),S=a(39235),N=a(17989),y=a(70073),D=a(51432),b=JSON.parse('{"context_not-available":"Not available","label_type":"Type","label_node-id":"Node Id","label_host":"Host","label_dc":"DC","label_path":"Path","label_available":"Available","label_realtime":"Realtime","label_device":"Device","value_unknown":"unknown","value_of":"of"}');let w=(0,D.g4)("ydb-pDisk-popup",{en:b}),P=[d.m.Orange,d.m.Red,d.m.Yellow],A=(e,t)=>{let{AvailableSize:a,TotalSize:r,NodeId:n,Path:l,Realtime:o,Type:d,Device:u}=e,c=[{name:w("label_type"),content:d||w("value_unknown")}];return n&&c.push({name:w("label_node-id"),content:n}),t?.Host&&c.push({name:w("label_host"),content:t.Host}),t?.DC&&c.push({name:w("label_dc"),content:(0,i.jsx)(s.J,{children:t.DC})}),l&&c.push({name:w("label_path"),content:l}),(0,k.kf)(r)&&(0,k.kf)(a)&&c.push({name:w("label_available"),content:`${(0,k.wb)(a)} ${w("value_of")} ${(0,k.wb)(r)}`}),o&&P.includes(o)&&c.push({name:w("label_realtime"),content:(0,i.jsx)(N.k,{mode:"icons",status:o})}),u&&P.includes(u)&&c.push({name:w("label_device"),content:(0,i.jsx)(N.k,{mode:"icons",status:u})}),c},I=e=>{let t=[],{State:a}=e;if(!a)return t.push({id:"state",value:w("context_not-available")}),t;if(a){let e=(0,m.J)(a),{theme:i,icon:r}=p.nr[e];t.push({id:"state",value:a,theme:i,icon:r})}return t},C=(e,t)=>{let{NodeId:a,PDiskId:r}=e;if(!t||(0,l.isNil)(a)||(0,l.isNil)(r))return null;let s=(0,c.ar)({nodeId:a,pDiskId:r});return(0,i.jsxs)(n.s,{gap:2,wrap:"wrap",children:[(0,i.jsx)(S.L,{pDiskId:r,nodeId:a}),(0,i.jsx)(v.K,{title:(0,x.D)("developer-ui"),url:s})]})},j=({data:e})=>{let t=(0,g.J)(),a=(0,f.X)(),s=(0,h.N4)(e=>(0,o.K)(e,t)),n=(0,l.isNil)(e.NodeId)?void 0:s?.get(e.NodeId),d=r.useMemo(()=>A(e,n),[e,n]),c=r.useMemo(()=>I(e),[e]),m=r.useMemo(()=>C(e,a),[e,a]),p=e.StringifiedId;return(0,i.jsx)(y.n,{compact:!0,title:"PDisk",titleSuffix:p??u.Pd,items:d,headerLabels:c,footer:m,nameMaxWidth:100})}},12623:function(e,t,a){a.d(t,{WV:()=>o,jV:()=>l});var i=a(74848),r=a(96540);let s={sortParams:void 0,totalEntities:0,foundEntities:0,isInitialLoad:!0},n=r.createContext({tableState:s,setSortParams:()=>void 0,setTotalEntities:()=>void 0,setFoundEntities:()=>void 0,setIsInitialLoad:()=>void 0}),l=({children:e,initialState:t={},noBatching:a})=>{let[l,o]=r.useState(t.sortParams??s.sortParams),[d,u]=r.useState(t.totalEntities??s.totalEntities),[c,m]=r.useState(t.foundEntities??s.foundEntities),[p,h]=r.useState(t.isInitialLoad??s.isInitialLoad),g=r.useMemo(()=>({sortParams:l,totalEntities:d,foundEntities:c,isInitialLoad:p}),[l,d,c,p]),f=r.useMemo(()=>({tableState:g,noBatching:a,setSortParams:o,setTotalEntities:u,setFoundEntities:m,setIsInitialLoad:h}),[g,a]);return(0,i.jsx)(n.Provider,{value:f,children:e})},o=()=>{let e=r.useContext(n);if(void 0===e)throw Error("usePaginatedTableState must be used within a PaginatedTableStateProvider");return e}},41254:function(e,t,a){a.d(t,{o:()=>u});var i=a(74848),r=a(96540),s=a(48849),n=a(12623);let l=({table:e,tableWrapperProps:t})=>{let{tableState:a}=(0,n.WV)(),{sortParams:l}=a,o=r.useMemo(()=>{let e=t?.scrollDependencies||[];return{...t,scrollDependencies:[...e,l]}},[t,l]);return(0,i.jsx)(s.L.Table,{...o,children:e})},o=({controls:e,extraControls:t})=>e||t?(0,i.jsx)(s.L.Controls,{renderExtraControls:()=>t,children:e}):null,d=({error:e})=>e?(0,i.jsx)(r.Fragment,{children:e}):null,u=({controls:e,extraControls:t,table:a,tableWrapperProps:r,error:u,initialState:c,noBatching:m,fullHeight:p=!0})=>(0,i.jsx)(n.jV,{initialState:c,noBatching:m,children:(0,i.jsxs)(s.L,{fullHeight:p,children:[(0,i.jsx)(o,{controls:e,extraControls:t}),(0,i.jsx)(d,{error:u}),(0,i.jsx)(l,{table:a,tableWrapperProps:r})]})})},74104:function(e,t,a){a.d(t,{U3:()=>41,k5:()=>W,qr:()=>i});let i={NODES:"nodes",STORAGE_NODES:"storage-nodes",STORAGE_GROUPS:"storage-groups",TOPIC_DATA:"topic-data",NODE_PEERS:"node-peers"},r={[i.NODES]:!0,[i.STORAGE_NODES]:!0,[i.STORAGE_GROUPS]:!0,[i.TOPIC_DATA]:!0,[i.NODE_PEERS]:!1};var s=a(74848),n=a(96540),l=a(12623);class o{requestQueue=new Map;batchTimeout=null;BATCH_DELAY=50;queueRequest(e,t){return new Promise((a,i)=>{let r=this.createBatchKey(e);this.requestQueue.has(r)||this.requestQueue.set(r,[]),this.requestQueue.get(r).push({params:e,resolve:a,reject:i,signal:t}),this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.processBatch()},this.BATCH_DELAY)})}createBatchKey(e){return JSON.stringify({tableName:e.tableName,filters:e.filters,sortParams:e.sortParams,columnsIds:e.columnsIds,limit:e.limit})}groupConsecutiveRequests(e){if(0===e.length)return[];let t=e.sort((e,t)=>e.params.offset-t.params.offset),a=[],i=[t[0]],r=t[0].params.limit;for(let e=1;e<t.length;e++){let s=i[i.length-1].params.offset+r;t[e].params.offset===s?i.push(t[e]):(a.push(this.createBatchGroup(i)),i=[t[e]])}return a.push(this.createBatchGroup(i)),a}createBatchGroup(e){let t=Math.min(...e.map(e=>e.params.offset)),a=Math.max(...e.map(e=>e.params.offset)),i=e[0].params.limit,r=e.length*i;return{requests:e,batchKey:this.createBatchKey(e[0].params),minOffset:t,maxOffset:a,totalLimit:r}}async executeBatch(e){let t=e.requests[0],a={...t.params,offset:e.minOffset,limit:e.totalLimit};try{let i=await t.params.fetchData({limit:a.limit,offset:a.offset,filters:a.filters,sortParams:a.sortParams,columnsIds:a.columnsIds,signal:t.signal});this.splitAndDistributeResponse(e,i)}catch(t){e.requests.forEach(e=>{e.resolve({error:t})})}}splitAndDistributeResponse(e,t){let a=e.requests[0].params.limit;e.requests.forEach((e,i)=>{let r=i*a,s=t.data.slice(r,r+a),n={...t,data:s,total:t.total,found:t.found};e.resolve({data:n})})}async processBatch(){let e=Array.from(this.requestQueue.entries());for(let[t,a]of(this.requestQueue.clear(),this.batchTimeout=null,e)){let e=this.groupConsecutiveRequests(a);await Promise.all(e.map(e=>this.executeBatch(e)))}}}let d=new o,u=a(56496).F.injectEndpoints({endpoints:function(e){return{fetchTableChunk:e.query({queryFn:async({offset:e,limit:t,sortParams:a,filters:i,columnsIds:r,fetchData:s,tableName:n,noBatching:l},{signal:o})=>{try{if(l)return{data:await s({limit:t,offset:e,filters:i,sortParams:a,columnsIds:r,signal:o})};{let l=await d.queueRequest({offset:e,limit:t,sortParams:a,filters:i,columnsIds:r,fetchData:s,tableName:n},o);if("error"in l)return{error:l.error};return l}}catch(e){return{error:e}}},providesTags:["All"]})}}});var c=a(33172),m=a(61738),p=a(67103),h=a(86268);let g=(0,a(25247).cn)("ydb-paginated-table");function f(e){let t,a=null;return function(...i){t=i,"number"!=typeof a&&(a=requestAnimationFrame(()=>{e(...t),a=null}))}}let k=n.memo,v=({children:e,className:t,height:a,width:i,align:r="left",resizeable:n})=>(0,s.jsx)("td",{className:g("row-cell",{align:r},t),style:{height:`${a}px`,width:`${i}px`,maxWidth:n?`${i}px`:void 0},children:e}),x=k(function({columns:e,height:t}){return(0,s.jsx)("tr",{className:g("row",{loading:!0}),style:{height:t},children:e.map(e=>{let a=e.resizeable??!0;return(0,s.jsx)(v,{height:t,width:e.width,align:e.align,className:e.className,resizeable:a,children:(0,s.jsx)(h.E,{className:g("row-skeleton"),style:{width:"80%",height:"50%"}})},e.name)})})}),S=({row:e,columns:t,getRowClassName:a,height:i})=>{let r=a?.(e);return(0,s.jsx)("tr",{className:g("row",r),style:{height:i},children:t.map(t=>{let a=t.resizeable??!0;return(0,s.jsx)(v,{height:i,width:t.width,align:t.align,className:t.className,resizeable:a,children:t.render({row:e})},t.name)})})},N=({columns:e,children:t,height:a})=>(0,s.jsx)("tr",{className:g("row",{empty:!0}),style:{height:a},children:(0,s.jsx)("td",{colSpan:e.length,className:g("td"),children:t})});var y=a(51432),D=JSON.parse('{"empty":"Нет данных"}');let b=(0,y.g4)("ydb-paginated-table",{ru:D,en:{empty:"No data"}}),w=k(function({id:e,chunkSize:t,calculatedCount:a,rowHeight:i,columns:o,fetchData:d,tableName:h,filters:g,sortParams:f,getRowClassName:k,renderErrorMessage:v,renderEmptyDataMessage:y,onDataFetched:D,shouldFetch:w,shouldRender:P,keepCache:A}){let[I,C]=n.useState(!0),[j]=(0,m.Nt)(),{noBatching:M}=(0,l.WV)(),U=r[h]??!1,E={offset:e*t,limit:t,fetchData:d,filters:g,sortParams:f,columnsIds:n.useMemo(()=>U?o.map(e=>e.name).toSorted():[],[o,U]),tableName:h,noBatching:M};u.useFetchTableChunkQuery(E,{skip:I||!w,pollingInterval:j,refetchOnMountOrArgChange:!A});let{currentData:T,error:R}=u.endpoints.fetchTableChunk.useQueryState(E);n.useEffect(()=>{let e=0;return w&&I&&(e=window.setTimeout(()=>{C(!1)},200)),()=>{window.clearTimeout(e)}},[w,I]),n.useEffect(()=>{T&&D({...T,data:T.data,found:T.found||0,total:T.total||0})},[T,D]);let G=T?.data?.length||a;return P?(()=>{if(!T)if(R)return(0,s.jsx)(N,{columns:o,height:G*i,children:v?v(R):(0,s.jsx)(p.o,{error:R})});else return(0,c._e)(G).map(e=>(0,s.jsx)(x,{columns:o,height:i},e));return T.data?.length?T.data.map((e,t)=>(0,s.jsx)(S,{row:e,columns:o,height:i,getRowClassName:k},t)):(0,s.jsx)(N,{columns:o,height:G*i,children:y?y():b("empty")})})():null});var P=a(2543);let A=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?1:2,I=4,C=({scrollContainerRef:e,tableRef:t,foundEntities:a,chunkSize:i,rowHeight:r,columns:l,fetchData:o,filters:d,tableName:u,sortParams:c,getRowClassName:m,renderErrorMessage:p,renderEmptyDataMessage:h,onDataFetched:k,keepCache:v})=>{let x=(({scrollContainerRef:e,tableRef:t,totalItems:a,rowHeight:i,chunkSize:r,renderOverscan:s=A,fetchOverscan:l=I})=>{let o=n.useMemo(()=>Math.ceil(a/r),[r,a]),[d,u]=n.useState(0),[c,m]=n.useState(0),p=n.useCallback(()=>{let s,n,l=e?.current,d=t.current;if(!l||!d)return null;let u=(s=d.getBoundingClientRect(),n=l.getBoundingClientRect(),s.top-n.top+l.scrollTop),c=Math.max(l.scrollTop-u,0),m=c+l.clientHeight,p=function(e){let{container:t,currentTableOffset:a,totalItems:i,rowHeight:r,freezeMarginPx:s}=e,n=t.scrollTop,l=n+t.clientHeight,o="number"==typeof s?s:t.clientHeight;return l<a-o||n>a+i*r+o}({container:l,currentTableOffset:u,totalItems:a,rowHeight:i});return{start:Math.max(Math.floor(c/i/r),0),end:Math.min(Math.floor(m/i/r),Math.max(o-1,0)),skipUpdate:p}},[e,t,i,r,o,a]),h=n.useCallback(()=>{let e=p();if(e){let{start:t,end:a,skipUpdate:i}=e;if(i)return;u(t),m(a)}},[p]);n.useEffect(()=>{h()},[o,h]);let g=n.useCallback(()=>{h()},[h]);return n.useEffect(()=>{let e=f(()=>{h()});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[h]),n.useEffect(()=>{let t=e?.current;if(!t)return;let a=(0,P.throttle)(g,200,{trailing:!0,leading:!0});return t.addEventListener("scroll",a,{passive:!0}),()=>{t.removeEventListener("scroll",a)}},[g,e]),n.useMemo(()=>{let e=Math.max(d-s,0),t=Math.min(c+s,Math.max(o-1,0)),a=Math.max(d-l,0),i=Math.min(c+l,Math.max(o-1,0));return Array(o).fill(null).map((r,s)=>({shouldRender:s>=e&&s<=t,shouldFetch:s>=a&&s<=i}))},[o,d,c,s,l])})({scrollContainerRef:e,tableRef:t,totalItems:a||1,rowHeight:r,chunkSize:i}),S=n.useMemo(()=>a?a%i||i:1,[a,i]),N=n.useCallback(()=>({firstRenderIndex:x.findIndex(e=>e.shouldRender),lastRenderIndex:x.findLastIndex(e=>e.shouldRender)}),[x]),y=n.useCallback(()=>({firstFetchIndex:x.findIndex(e=>e.shouldFetch),lastFetchIndex:x.findLastIndex(e=>e.shouldFetch)}),[x]),D=n.useCallback((e,t)=>{let a=0;for(let s=e;s<t;s++)a+=(s===x.length-1?S:i)*r;return a},[i,x.length,S,r]),b=n.useCallback((e,t,a)=>{let i=D(e,t);return(0,s.jsx)("tr",{style:{height:`${i}px`},className:g(a),children:(0,s.jsx)("td",{colSpan:l.length,style:{padding:0,border:"none"}})},a)},[D,l.length]),C=n.useCallback(e=>{let t=x[e];return(0,s.jsx)(w,{id:e,calculatedCount:e===x.length-1?S:i,chunkSize:i,rowHeight:r,columns:l,fetchData:o,filters:d,tableName:u,sortParams:c,getRowClassName:m,renderErrorMessage:p,renderEmptyDataMessage:h,onDataFetched:k,shouldFetch:t.shouldFetch,shouldRender:t.shouldRender,keepCache:v},e)},[i,x,l,o,d,m,v,S,k,h,p,r,c,u]),j=n.useCallback(()=>{let{firstFetchIndex:e,lastFetchIndex:t}=y(),{firstRenderIndex:a,lastRenderIndex:i}=N(),r=[];if(-1===e)return r;a>0&&r.push(b(0,a,"separator-beginning"));for(let a=e;a<=t;a++)r.push(C(a));return i<x.length-1&&r.push(b(i+1,x.length,"separator-end")),r},[x.length,C,b,y,N]);return(0,s.jsx)(n.Fragment,{children:j()})};var j=a(46086);function M({minWidth:e,maxWidth:t,getCurrentColumnWidth:a,onResize:i}){let r=n.useRef(null),[l,o]=n.useState(!1);return n.useEffect(()=>{let s,n,l,d=r.current;if(!d)return;let u=f(a=>{if(U(a),"number"!=typeof s||"number"!=typeof n)return;let r=a.clientX-s,o=function(e,t=40,a=1/0){return Math.max(t,Math.min(e,a))}(n+r,e,t);o!==l&&(l=o,i?.(l))}),c=e=>{U(e),void 0!==l&&i?.(l),o(!1),s=void 0,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)},m=e=>{n=a(),U(e),s=e.clientX,o(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)};return d.addEventListener("mousedown",m),()=>{d.removeEventListener("mousedown",m),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)}},[i,e,t,a]),(0,s.jsx)("span",{ref:r,className:g("resize-handler",{resizing:l}),onClick:e=>U(e)})}function U(e){e.preventDefault(),e.stopPropagation()}let E=({order:e})=>(0,s.jsx)("svg",{className:g("sort-icon",{desc:-1===e}),viewBox:"0 0 10 6",width:"10",height:"6",children:(0,s.jsx)("path",{fill:"currentColor",d:"M0 5h10l-5 -5z"})}),T=({sortOrder:e,sortable:t,defaultSortOrder:a})=>t?(0,s.jsx)("span",{className:g("sort-icon-container",{shadow:!e}),children:(0,s.jsx)(E,{order:e||a})}):null,R={left:"right",right:"left",center:"right"},G=({column:e,resizeable:t,sortOrder:a,defaultSortOrder:i,onSort:r,rowHeight:l,onCellMount:o,onCellUnMount:d,onColumnsResize:u})=>{let c=n.useRef(null);n.useEffect(()=>{let e=c.current;return e&&o?.(e),()=>{e&&d?.(e)}},[o,d]);let m=n.useCallback(()=>c.current?.getBoundingClientRect().width,[]),p=n.useCallback(t=>{u?.(e.name,t)},[u,e.name]),h=e.header??e.name,f={height:`${l}px`,width:`${e.width}px`,minWidth:t?`${e.width}px`:void 0,maxWidth:t?`${e.width}px`:void 0};return(0,s.jsxs)("th",{ref:c,className:g("head-cell-wrapper"),style:f,children:[(0,s.jsxs)("div",{className:g("head-cell",{align:e.align,sortable:e.sortable},e.className),onClick:()=>{e.sortable&&r?.(e.name)},children:[(0,s.jsxs)("div",{className:g("head-cell-content-container"),children:[(0,s.jsx)("div",{className:g("head-cell-content"),children:h}),e.note&&(0,s.jsx)(j.H,{popoverProps:{placement:R[e.align]},className:g("head-cell-note"),children:e.note})]}),(0,s.jsx)(T,{sortOrder:a,sortable:e.sortable,defaultSortOrder:i})]}),t?(0,s.jsx)(M,{maxWidth:e.resizeMaxWidth,minWidth:e.resizeMinWidth,getCurrentColumnWidth:m,onResize:p}):null]})},L=({columns:e,onSort:t,onColumnsResize:a,defaultSortOrder:i=-1,rowHeight:r=41})=>{let[l,o]=n.useState({}),d=e=>{let a={};if(e===l.columnId){if(l.sortOrder&&l.sortOrder!==i){o(a),t?.(a);return}a={sortOrder:1===l.sortOrder?-1:1,columnId:e}}else a={sortOrder:i,columnId:e};t?.(a),o(a)};return(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("colgroup",{children:e.map(e=>(0,s.jsx)("col",{style:{width:`${e.width}px`}},e.name))}),(0,s.jsx)("thead",{className:g("head"),children:(0,s.jsx)("tr",{children:e.map(e=>{let t=l.columnId===e.name?l.sortOrder:void 0,n=a&&(e.resizeable??!0);return(0,s.jsx)(G,{column:e,resizeable:n,sortOrder:t,defaultSortOrder:i,onSort:d,rowHeight:r,onColumnsResize:a},e.name)})})})]})},_=20,V=({limit:e=_,initialEntitiesCount:t,fetchData:a,filters:i,tableName:r,columns:o,getRowClassName:d,rowHeight:u=41,scrollContainerRef:c,onColumnsResize:m,renderErrorMessage:p,renderEmptyDataMessage:h,containerClassName:f,onDataFetched:k,keepCache:v=!0})=>{let{tableState:x,setSortParams:S,setTotalEntities:N,setFoundEntities:y,setIsInitialLoad:D}=(0,l.WV)(),{sortParams:b,foundEntities:w}=x,P=n.useRef(null),[A,I]=n.useState(i);n.useEffect(()=>{I(i)},[i]);let j=n.useCallback(e=>{e&&(N(e.total),y(e.found),D(!1),k?.(e))},[k,y,D,N]);return n.useLayoutEffect(()=>{let e=c.current;e&&"transform"!==window.getComputedStyle(e).willChange&&(e.style.willChange="transform")},[c.current]),n.useLayoutEffect(()=>{let e=t||0,a=t||1;N(e),y(a),D(!0)},[t,N,y,D]),(0,s.jsx)("div",{ref:P,className:g(null,f),children:(0,s.jsxs)("table",{className:g("table"),children:[(0,s.jsx)(L,{columns:o,onSort:S,onColumnsResize:m}),(0,s.jsx)("tbody",{children:(0,s.jsx)(C,{scrollContainerRef:c,tableRef:P,foundEntities:w,chunkSize:e,rowHeight:u,columns:o,fetchData:a,filters:A,tableName:r,sortParams:b,getRowClassName:d,renderErrorMessage:p,renderEmptyDataMessage:h,onDataFetched:j,keepCache:v})})]})})};var O=a(17854),z=a(78951);function W({columnsWidthLSKey:e,columns:t,...a}){let[i,r,n]=(0,O.a)(e),l=t.map(e=>({...e,width:i[e.name]??e.width}));return n?(0,s.jsx)(z.Q,{}):(0,s.jsx)(V,{columns:l,onColumnsResize:r,containerClassName:g("resizeable-table-container"),...a})}},52705:function(e,t,a){a.d(t,{O:()=>d});var i=a(74848),r=a(29714),s=a(25247),n=a(5577),l=a(28241);let o=(0,s.cn)("progress-viewer");function d({value:e,capacity:t,formatValues:a=n.g,percents:s,withOverflow:d,className:u,size:c="xs",colorizeProgress:m,inverseColorize:p,warningThreshold:h,dangerThreshold:g,hideCapacity:f}){let k=(0,r.D)(),v=Math.floor(parseFloat(String(e))/parseFloat(String(t))*100)||0,x=v;v=v>100?100:v;let S=e,N=t,y="/";s?(S=(d?x:v)+"%",N="",y=""):a&&([S,N]=a(Number(e),Number(t)));let D=(0,n.w)({fillWidth:v,warningThreshold:h,dangerThreshold:g,colorizeProgress:m,inverseColorize:p});m&&!(0,l.kf)(t)&&(v=100);let b={width:v+"%"};return(0,l.kf)(e)?(0,i.jsxs)("div",{className:o({size:c,theme:k,status:D},u),children:[(0,i.jsx)("div",{className:o("line"),style:b}),(0,i.jsx)("span",{className:o("text"),children:(0,l.kf)(t)&&!f?`${S} ${y} ${N}`:S})]}):(0,i.jsx)("div",{className:`${o({size:c})} ${u} error`,children:"no data"})}},92961:function(e,t,a){a.d(t,{j:()=>n});var i=a(74848),r=a(81392),s=a(65101);let n=({value:e,onChange:t,className:a})=>(0,i.jsxs)(r.x,{value:e,onUpdate:t,className:a,children:[(0,i.jsx)(r.x.Option,{value:"All",children:s.DG.All}),(0,i.jsx)(r.x.Option,{value:"SmallUptime",children:s.DG.SmallUptime})]})},80184:function(e,t,a){a.d(t,{y:()=>L});var i=a(74848),r=a(8946),s=a(25247),n=a(95980),l=a(50504),o=a(15474),d=a(15749),u=a(96540),c=a(85169),m=a(65066),p=a(2543),h=a(56321),g=a(40897),f=a(35537),k=a(97855),v=a(88387),x=a(16021),S=a(7360),N=a(61738),y=a(81709),D=a(88831),b=a(28241),w=a(60318),P=a(78331),A=a(17989),I=a(65153),C=a(70073),j=a(51432),M=JSON.parse('{"context_not-available":"not available","label_no-data":"No data","label_storage-pool":"StoragePool","label_donor":"Donor","label_node-id":"NodeId","label_pdisk-id":"PDiskId","label_vslot-id":"VSlotId","label_links":"Links","label_vdisk":"VDisk","label_fresh":"Fresh","label_level":"Level","label_space":"Space","label_front-queues":"FrontQueues","label_replicated":"Replicated","label_progress":"Progress","label_remaining":"Remaining","label_unsync-vdisks":"UnsyncVDisks","label_allocated":"Allocated","label_available":"Available","label_read":"Read","label_write":"Write","label_replication":"Replication","label_recipient":"Recipient"}');let U=(0,j.g4)("ydb-vDisk-popup",{en:M}),E=(0,s.cn)("vdisk-storage-popup"),T=({nodeId:e,stringifiedId:t,getVDiskLinkFn:a})=>{if((0,p.isNil)(t))return(0,i.jsx)("span",{children:f.Pd});if((0,p.isNil)(e))return(0,i.jsx)("span",{children:t});let r=a?.({nodeId:e,vDiskId:t});return(0,i.jsxs)(d.E,{to:r,children:[U("label_vdisk")," ",t]})},R=({data:e})=>{let t=(0,S.NJ)(e),a=(0,D.b)(),s=(0,D.X)(),l=(0,r.Z$)(),o=(0,y.J)(),d=u.useMemo(()=>t?((e,t)=>{let{VDiskState:a,SatisfactionRank:r,DiskSpace:s,FrontQueues:l,Replicated:o,ReplicationProgress:d,ReplicationSecondsRemaining:u,UnsyncedVDisks:m,AllocatedSize:h,AvailableSize:f,ReadThroughput:v,WriteThroughput:x,StoragePoolName:S,Donors:N,DonorMode:y,Recipient:D,Severity:w}=e,P=[];if(S&&P.push({name:U("label_storage-pool"),content:S}),N?.length&&w===n.aW.Blue&&P.push({name:U("label_donor"),content:(0,i.jsx)(c.s,{direction:"column",children:N.map(e=>(0,i.jsx)(T,{nodeId:e.NodeId,stringifiedId:e.StringifiedId,getVDiskLinkFn:t},e.StringifiedId))})}),y&&D&&P.push({name:U("label_recipient"),content:(0,i.jsx)(T,{nodeId:D.NodeId,stringifiedId:D.StringifiedId,getVDiskLinkFn:t})}),r&&r.FreshRank?.Flag!==g.m.Green&&P.push({name:U("label_fresh"),content:r.FreshRank?.Flag}),r&&r.LevelRank?.Flag!==g.m.Green&&P.push({name:U("label_level"),content:r.LevelRank?.Flag}),r&&r.FreshRank?.RankPercent&&P.push({name:U("label_fresh"),content:r.FreshRank.RankPercent}),r&&r.LevelRank?.RankPercent&&P.push({name:U("label_level"),content:r.LevelRank.RankPercent}),s&&P.push({name:U("label_space"),content:(0,i.jsx)(A.k,{mode:"icons",status:s})}),l&&P.push({name:U("label_front-queues"),content:(0,i.jsx)(A.k,{mode:"icons",status:l})}),!1===o&&"OK"===a){if(P.push({name:U("label_replicated"),content:"NO"}),!(0,p.isNil)(d)){let e=Math.round(100*d);P.push({name:U("label_progress"),content:`${e}%`})}if(!(0,p.isNil)(u)){let e=(0,k.je)(u);e&&P.push({name:U("label_remaining"),content:e})}}return m&&P.push({name:U("label_unsync-vdisks"),content:m}),Number(h)&&P.push({name:U("label_allocated"),content:(0,b.wb)(h)}),Number(f)&&P.push({name:U("label_available"),content:(0,b.wb)(f)}),Number(v)&&P.push({name:U("label_read"),content:(0,b.O4)(v)}),Number(x)&&P.push({name:U("label_write"),content:(0,b.O4)(x)}),P})(e,l):(e=>{let{NodeId:t,PDiskId:a,VSlotId:i,StoragePoolName:r}=e,s=[];return r&&s.push({name:U("label_storage-pool"),content:r}),s.push({name:U("label_node-id"),content:t??f.Pd},{name:U("label_pdisk-id"),content:a??f.Pd},{name:U("label_vslot-id"),content:i??f.Pd}),s})(e),[e,t,l]),j=u.useMemo(()=>t?(e=>{let t=[],{VDiskState:a,DonorMode:i,Severity:r}=e,s=r===n.aW.Blue;if(i){let e=n.WK.donor;t.push({id:"donor",value:U("label_donor"),theme:e.theme,icon:e.icon})}else if(s){let e=n.WK.replica;t.push({id:"replication",value:U("label_replication"),theme:e.theme,icon:e.icon})}let l=a?(0,x.J)(a):n.Ne,{theme:o,icon:d}=n.nr[l],u=a??U("label_no-data");return t.push({id:"state",value:u,theme:o,icon:d}),t})(e):[],[e,t]),M=u.useMemo(()=>t?((e,t,a)=>{if(!t)return null;let{NodeId:r,PDiskId:s,VDiskSlotId:n,StringifiedId:l}=e;if((0,p.isNil)(r)||(0,p.isNil)(s)||(0,p.isNil)(n)&&(0,p.isNil)(l))return null;let o=(0,p.isNil)(n)?void 0:(0,v.Wg)({nodeId:r,pDiskId:s,vDiskSlotId:n}),d=a?.({nodeId:r,vDiskId:l});return d?(0,i.jsxs)(c.s,{className:E("links"),wrap:"wrap",gap:2,children:[d&&(0,i.jsx)(w.K,{title:(0,I.r)("vdisk-page"),url:d,external:!1},d),o&&(0,i.jsx)(w.K,{title:(0,I.r)("developer-ui"),url:o})]}):null})(e,s,l):((e,t)=>{let{NodeId:a,PDiskId:r,VSlotId:s}=e;if(!t||(0,p.isNil)(a)||(0,p.isNil)(r)||(0,p.isNil)(s))return null;let n=(0,v.Wg)({nodeId:a,pDiskId:r,vDiskSlotId:s});return(0,i.jsx)("div",{className:E("links"),children:(0,i.jsx)(w.K,{title:"Developer UI",url:n})})})(e,s),[e,t,s,l]),R=(0,N.N4)(e=>(0,h.K)(e,o)),G=(0,p.isNil)(e.NodeId)?void 0:R?.get(e.NodeId),L=u.useMemo(()=>t&&e.PDisk&&(0,P.fX)(e.PDisk,G),[e,G,t]),_=u.useMemo(()=>t&&e.PDisk?(0,P.JT)(e.PDisk):[],[e,t]),V=u.useMemo(()=>t&&e.PDisk?(0,P.pF)(e.PDisk,s):null,[e,t,s]),O=t?e.StringifiedId:void 0,z=t?e.PDisk?.StringifiedId:void 0;return(0,i.jsxs)("div",{className:E(),children:[(0,i.jsx)(C.n,{compact:!0,title:"VDisk",titleSuffix:O??f.Pd,items:d,headerLabels:j,nameMaxWidth:100,footer:M}),L&&a&&(0,i.jsxs)(u.Fragment,{children:[(0,i.jsx)(m.c,{className:E("custom-divider")}),(0,i.jsx)(C.n,{compact:!0,title:"PDisk",titleSuffix:z??f.Pd,items:L,headerLabels:_,footer:V,nameMaxWidth:100})]})]})},G=(0,s.cn)("ydb-vdisk-component"),L=({data:e={},compact:t,inactive:a,showPopup:s,onShowPopup:u,onHidePopup:c,progressBarClassName:m,delayClose:p,delayOpen:h,withIcon:g,highlighted:f})=>{let k=(0,r.Z$)()({nodeId:e.NodeId,vDiskId:e.StringifiedId}),v=e.Severity,x=v===n.aW.Blue,S=e.DonorMode;return(0,i.jsx)(o.P,{showPopup:s,onShowPopup:u,onHidePopup:c,renderPopupContent:()=>(0,i.jsx)(R,{data:e}),offset:{mainAxis:2,crossAxis:0},delayClose:p,delayOpen:h,children:(0,i.jsx)("div",{className:G(),children:(0,i.jsx)(d.E,{to:k,className:G("content"),children:(0,i.jsx)(l.V,{diskAllocatedPercent:e.AllocatedPercent,severity:v,compact:t,inactive:a,striped:x||S,isDonor:S,className:m,withIcon:g,highlighted:f})})})})}},65153:function(e,t,a){a.d(t,{r:()=>s});var i=a(51432),r=JSON.parse('{"slot-id":"VDisk Slot Id","label_pdisk-id":"PDisk Id","pool-name":"Storage Pool Name","kind":"Kind","guid":"GUID","incarnation-guid":"Incarnation GUID","instance-guid":"Instance GUID","replication-status":"Replicated","replication-progress":"Replication Progress","replication-time-remaining":"Time Remaining","donors":"Donors","state-status":"VDisk State","space-status":"Disk Space","fresh-rank-satisfaction":"Fresh Rank Satisfaction","level-rank-satisfaction":"Level Rank Satisfaction","front-queues":"Front Queues","has-unreadable-blobs":"Has Unreadable Blobs","size":"Size","usage":"Usage","read-throughput":"Read Throughput","write-throughput":"Write Throughput","links":"Links","vdisk-page":"VDisk page","developer-ui":"Developer UI","yes":"Yes","no":"No","vdiks-title":"VDisk"}');let s=(0,i.g4)("ydb-vDisk-info",{en:r})},70073:function(e,t,a){a.d(t,{n:()=>h});var i=a(74848),r=a(96540),s=a(85169),n=a(5434),l=a(17427),o=a(66918),d=a(25247),u=a(51432),c=JSON.parse('{"no-data":"No data"}');let m=(0,u.g4)("ydb-definition-list",{en:c}),p=(0,d.cn)("ydb-definition-list");function h({title:e,titleSuffix:t,titleSeparator:a="•",headerLabels:d,iconSize:u=12,labelSize:c="xs",footer:h,items:g,compact:f,nameMaxWidth:k=220,className:v,titleClassname:x,...S}){let N=!!(e||t||d&&d.length);return(0,i.jsxs)("div",{className:p({compact:f}),children:[N?(0,i.jsxs)(s.s,{className:p("header"),justifyContent:"space-between",gap:2,alignItems:"center",children:[e&&(0,i.jsxs)(s.s,{gap:"1",alignItems:"center",children:[(0,i.jsx)("div",{className:p("title",x),children:e}),t&&(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)("div",{className:p("title-suffix"),children:a}),(0,i.jsx)("div",{className:p("title-suffix"),children:t})]})]}),d&&d.length>0&&(0,i.jsx)(s.s,{gap:1,alignItems:"center",children:d.map(e=>(0,i.jsx)(n.J,{theme:e.theme,icon:e.icon?(0,i.jsx)(l.I,{data:e.icon,size:u}):void 0,size:c,children:e.value},e.id))})]}):null,(()=>{if(g.length){let e="auto"===k?S:{...S,nameMaxWidth:k};return(0,i.jsx)(o.u,{className:p("properties-list",v),...e,children:g.map(e=>(0,i.jsx)(o.u.Item,{children:e.content,...e},e.name))})}return m("no-data")})(),h?(0,i.jsx)("div",{className:p("footer"),children:h}):null]})}},62113:function(e,t,a){a.d(t,{H0:()=>m,T5:()=>c,fh:()=>p,jP:()=>g,nX:()=>h});var i=a(74848),r=a(29581),s=a(2543),n=a(15045),l=a(35537),o=a(97855),d=a(28241),u=a(28974);function c(){return{name:u.Z.MaxPDiskUsage,header:u.S.MaxPDiskUsage,width:150,render:({row:e})=>(0,d.kf)(e.MaxPDiskUsage)?(0,o.l9)(e.MaxPDiskUsage,2,{fixed:!0}):l.Pd,align:r.Ay.RIGHT}}function m(){return{name:u.Z.MaxVDiskSlotUsage,header:u.S.MaxVDiskSlotUsage,width:180,render:({row:e})=>(0,d.kf)(e.MaxVDiskSlotUsage)?(0,o.l9)(e.MaxVDiskSlotUsage,2,{fixed:!0}):l.Pd,align:r.Ay.RIGHT}}function p(){return{name:u.Z.CapacityAlert,header:u.S.CapacityAlert,width:150,render:({row:e})=>{if((0,s.isNil)(e.CapacityAlert))return l.Pd;let t=(0,n.e)(e.CapacityAlert);return(0,i.jsx)("span",{style:t?{color:t}:void 0,children:e.CapacityAlert})},align:r.Ay.CENTER}}function h(){return{name:u.Z.MaxVDiskRawUsage,header:u.S.MaxVDiskRawUsage,width:180,render:({row:e})=>(0,d.kf)(e.MaxVDiskRawUsage)?(0,o.l9)(e.MaxVDiskRawUsage,2,{fixed:!0}):l.Pd,align:r.Ay.RIGHT}}function g(){return{name:u.Z.MaxNormalizedOccupancy,header:u.S.MaxNormalizedOccupancy,width:200,render:({row:e})=>(0,d.kf)(e.MaxNormalizedOccupancy)?Number(e.MaxNormalizedOccupancy).toFixed(2):l.Pd,align:r.Ay.RIGHT}}},28974:function(e,t,a){a.d(t,{S:()=>l,Z:()=>n});var i=a(51432),r=JSON.parse('{"field_pdisk-usage":"PDisk Usage","field_vdisk-slot-usage":"VDisk Slot Usage","field_vdisk-raw-usage":"VDisk Raw Usage","field_normalized-occupancy":"Normalized Occupancy","field_capacity-alert":"Capacity Alert"}');let s=(0,i.g4)("ydb-capacity-metrics-columns",{en:r}),n={MaxPDiskUsage:"MaxPDiskUsage",MaxVDiskSlotUsage:"MaxVDiskSlotUsage",MaxVDiskRawUsage:"MaxVDiskRawUsage",MaxNormalizedOccupancy:"MaxNormalizedOccupancy",CapacityAlert:"CapacityAlert"},l={get MaxPDiskUsage(){return s("field_pdisk-usage")},get MaxVDiskSlotUsage(){return s("field_vdisk-slot-usage")},get MaxVDiskRawUsage(){return s("field_vdisk-raw-usage")},get MaxNormalizedOccupancy(){return s("field_normalized-occupancy")},get CapacityAlert(){return s("field_capacity-alert")}}},65943:function(e,t,a){a.d(t,{LD:()=>ef,pH:()=>Z,DH:()=>ec,SH:()=>ed,pt:()=>eh,jl:()=>X,ID:()=>ei,Bg:()=>es,OV:()=>K,Nh:()=>F,uk:()=>$,fR:()=>er,kv:()=>et,qp:()=>el,b8:()=>B,Rn:()=>Q,K6:()=>J,eT:()=>Y,oz:()=>en,wN:()=>ep,ui:()=>em,OX:()=>q,H:()=>eu,fr:()=>ea,iX:()=>ee,Vz:()=>eo,rU:()=>eg,_E:()=>H});var i=a(74848),r=a(29581),s=a(78419),n=a(66918),l=a(33172),o=a(25247),d=a(35537),u=a(97855),c=a(14016),m=a(51630),p=a(28241),h=a(5948),g=a(29714),f=a(85169),k=a(9849),v=a(5577),x=a(15474),S=a(52705),N=a(26552);let y=.01*d.J7,D=(0,o.cn)("memory-viewer"),b=(e,t)=>[(0,k.z3)({value:e,size:"gb",withSizeLabel:!1,precision:2}),(0,k.z3)({value:t,size:"gb",withSizeLabel:!0,precision:1})];function w({stats:e,percents:t,formatValues:a,className:r,warningThreshold:s,dangerThreshold:l}){let o=e.AnonRss??(0,N.HW)(e),d=e.HardLimit,u=(0,g.D)(),c=Math.floor(parseFloat(String(o))/parseFloat(String(d))*100)||0;c=c>100?100:c;let m=o,h=d,w="/";t?(m=c+"%",h="",w=""):a&&([m,h]=a(Number(o),Number(d)));let P=(0,N.Sb)(e,Number(o)),A=(0,v.w)({fillWidth:c,warningThreshold:s,dangerThreshold:l,colorizeProgress:!0}),I=0;return(0,i.jsx)(x.P,{renderPopupContent:()=>(0,i.jsx)(n.u,{responsive:!0,children:P.map(({label:e,value:t,capacity:a,key:r})=>(0,i.jsx)(n.u.Item,{name:(0,i.jsxs)(f.s,{alignItems:"center",gap:"1",className:D("container"),children:[(0,i.jsx)("div",{className:D("legend",{type:r})}),(0,i.jsx)("div",{className:D("name"),children:e})]}),children:a?(0,i.jsx)(S.O,{value:t,capacity:a,formatValues:b,colorizeProgress:!0}):(0,k.z3)({value:t,size:"gb",withSizeLabel:!0,precision:2})},e))}),children:(0,i.jsx)("div",{className:D({theme:u,status:A},r),children:(0,i.jsxs)("div",{className:D("progress-container"),children:[P.filter(({isInfo:e})=>!e).map(e=>{var t;if(e.value<y)return null;let a=Math.max((t=e.value,o?t/parseFloat(String(d))*100:0),1),r=I;return I+=a,(0,i.jsx)("div",{className:D("segment",{type:e.key}),style:{width:`${a}%`,left:`${r}%`}},e.key)}),(0,i.jsx)(f.s,{justifyContent:"center",alignItems:"center",className:D("text"),children:(0,p.kf)(d)?`${m} ${w} ${h}`:m})]})})})}var P=a(8946),A=a(65101),I=a(93397),C=a(18016);let j=({node:e,database:t,statusForIcon:a="SystemState"})=>{if(!e.Host)return d.Pd;let r="ConnectStatus"===a?e.ConnectStatus:e.SystemState,s=!(0,A.X7)(e),n=(0,A.wH)(e)?void 0:t??e.TenantName,l=s?(0,P.vI)({id:e.NodeId,activeTab:e.TenantName?"tablets":"storage"},{database:n}):void 0;return(0,i.jsx)(I.c,{name:e.Host,status:r,path:l,hasClipboardButton:!0,infoPopoverContent:s?(0,i.jsx)(C.p,{data:e}):null})};var M=a(48649),U=a(54625),E=a(53486);let T=(0,o.cn)("tablets-statistic"),R=({tablets:e=[],database:t,nodeId:a})=>{let r=e.map(e=>({label:(0,d.bk)(e.Type),type:e.Type,count:e.Count,state:(0,E.P)(e.State)})).sort((e,t)=>String(e.label).localeCompare(String(t.label)));return(0,i.jsx)("div",{className:T(),children:r.map((e,r)=>{let s=(0,P.vI)({id:a,activeTab:"tablets"},{database:t}),n=`${e.label}: ${e.count}`,l=T("tablet",{state:e.state?.toLowerCase()});return(0,i.jsx)(U.N_,{to:s,className:l,children:n},r)})})};var G=a(9753),L=a(79092),_=a(87669),V=a(47456);function O(e){return(0,m.Xo)((0,m.Jc)(e,1))}function z(e){let t=(0,m.Jc)(e,1);return(0>=Number(t)?"":"+")+(0,m.Xo)(t)}let W=(0,o.cn)("ydb-nodes-columns");function H(){return{name:_.vg.NodeId,header:"#",width:80,resizeMinWidth:80,render:({row:e})=>e.NodeId,align:r.Ay.RIGHT}}function F({database:e}){return{name:_.vg.Host,header:_.uG.Host,render:({row:t})=>(0,i.jsx)(j,{node:t,database:e}),width:350,align:r.Ay.LEFT}}function B({database:e}){return{name:_.vg.NetworkHost,header:_.uG.NetworkHost,render:({row:t})=>(0,i.jsx)(j,{node:t,database:e,statusForIcon:"ConnectStatus"}),width:350,align:r.Ay.LEFT}}function Y(){return{name:_.vg.NodeName,header:_.uG.NodeName,align:r.Ay.LEFT,render:({row:e})=>e.NodeName||d.Pd,width:200}}function J(){return{name:_.vg.Database,header:_.uG.Database,align:r.Ay.LEFT,render:({row:e})=>e.Database?(0,i.jsx)(s.m,{content:e.Database,children:(0,i.jsx)("span",{children:e.Database})}):d.Pd,width:200}}function $(){return{name:_.vg.DC,header:_.uG.DC,align:r.Ay.LEFT,render:({row:e})=>e.DC||d.Pd,width:60}}function q(){return{name:_.vg.Rack,header:_.uG.Rack,align:r.Ay.LEFT,render:({row:e})=>e.Rack||d.Pd,width:100}}function K(){return{name:_.vg.PileName,header:(0,V.A)("field_pile-name"),align:r.Ay.LEFT,render:({row:e})=>e.PileName||d.Pd,width:100}}function Q(){return{name:_.vg.Version,header:_.uG.Version,width:200,align:r.Ay.LEFT,render:({row:e})=>(0,i.jsx)(h.s,{content:e.Version,children:e.Version})}}function X(){return{name:_.vg.Uptime,header:_.uG.Uptime,sortAccessor:({StartTime:e})=>e?-e:0,render:({row:e})=>(0,i.jsx)(G.p,{StartTime:e.StartTime,DisconnectTime:e.DisconnectTime}),align:r.Ay.RIGHT,width:120}}function Z(){return{name:_.vg.RAM,header:_.uG.RAM,sortAccessor:({MemoryUsed:e=0})=>Number(e),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>{let[t,a]=(0,u.j9)((0,p.kf)(e.MemoryUsed)?Number(e.MemoryUsed):void 0,(0,p.kf)(e.MemoryLimit)?Number(e.MemoryLimit):void 0,"gb",void 0,!0),r=t||a;return(0,i.jsx)(h.s,{placement:["top","bottom"],fullWidth:!0,disabled:!r,content:(0,i.jsxs)(n.u,{responsive:!0,children:[t&&(0,i.jsx)(n.u.Item,{name:(0,V.A)("field_memory-used"),children:t}),a&&(0,i.jsx)(n.u.Item,{name:(0,V.A)("field_memory-limit"),children:a})]}),children:(0,i.jsx)(S.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:(e,t)=>(0,u.j9)(e,t,"gb",void 0,!0),className:W("column-ram"),colorizeProgress:!0,hideCapacity:!0})})},align:r.Ay.LEFT,width:80,resizeMinWidth:40}}function ee(){return{name:_.vg.Memory,header:_.uG.Memory,defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.MemoryStats?(0,i.jsx)(w,{formatValues:u.vX,stats:e.MemoryStats}):(0,i.jsx)(S.O,{value:e.MemoryUsed,capacity:e.MemoryLimit,formatValues:u.vX,colorizeProgress:!0}),align:r.Ay.LEFT,width:300,resizeMinWidth:170}}function et(){return{name:_.vg.Pools,header:_.uG.Pools,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map(({Usage:e})=>Number(e))),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.PoolStats?(0,i.jsx)(M._,{pools:e.PoolStats}):d.Pd,align:r.Ay.LEFT,width:80,resizeMinWidth:60}}function ea(){return{name:_.vg.CPU,header:_.uG.CPU,sortAccessor:({PoolStats:e=[]})=>Math.max(...e.map(({Usage:e})=>Number(e))),defaultOrder:r.Ay.DESCENDING,render:({row:e})=>{let t=(0,p.kf)(e.CoresUsed)&&(0,p.kf)(e.CoresTotal)?e.CoresUsed/e.CoresTotal:void 0;if(void 0===t&&e.PoolStats){let a=0;t=e.PoolStats.reduce((e,t)=>(a+=Number(t.Threads),e+Number(t.Usage)*Number(t.Threads)),0)/a}return(0,i.jsx)(h.s,{placement:["top","bottom"],fullWidth:!0,disabled:!e.PoolStats,content:(0,i.jsx)(n.u,{responsive:!0,children:e.PoolStats?.map(e=>(0,p.kf)(e.Usage)?(0,i.jsx)(n.u.Item,{name:e.Name,children:(0,C.Qz)("Usage",e.Usage).value},e.Name):null)}),children:(0,i.jsx)(S.O,{className:W("column-cpu"),value:t,capacity:1,colorizeProgress:!0,percents:!0})})},align:r.Ay.LEFT,width:80,resizeMinWidth:40}}function ei(){return{name:_.vg.LoadAverage,header:_.uG.LoadAverage,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:r.Ay.DESCENDING,render:({row:e})=>(0,i.jsx)(S.O,{value:e.LoadAveragePercents&&e.LoadAveragePercents.length>0?e.LoadAveragePercents[0]:void 0,percents:!0,colorizeProgress:!0,capacity:100}),align:r.Ay.LEFT,width:170,resizeMinWidth:170}}function er(){return{name:_.vg.Load,header:_.uG.Load,sortAccessor:({LoadAveragePercents:e=[]})=>e[0],defaultOrder:r.Ay.DESCENDING,render:({row:e})=>e.LoadAveragePercents&&e.LoadAveragePercents.length>0?(0,i.jsx)(L.U,{value:e.LoadAveragePercents[0].toFixed(),theme:(0,c.f)(e.LoadAveragePercents[0])}):d.Pd,align:r.Ay.LEFT,width:80,resizeMinWidth:70}}function es(){return{name:_.vg.DiskSpaceUsage,header:_.uG.DiskSpaceUsage,render:({row:e})=>(0,l.f8)(e.DiskSpaceUsage)?(0,i.jsx)(L.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,c.f)(e.DiskSpaceUsage)}):d.Pd,align:r.Ay.LEFT,width:115,resizeMinWidth:75}}function en(){return{name:_.vg.TotalSessions,header:_.uG.TotalSessions,render:({row:e})=>e.TotalSessions??d.Pd,align:r.Ay.RIGHT,width:100}}function el({database:e}){return{name:_.vg.Tablets,header:_.uG.Tablets,width:500,resizeMinWidth:500,render:({row:t})=>t.Tablets?(0,i.jsx)(R,{database:e??t.TenantName,nodeId:t.NodeId,tablets:t.Tablets}):d.Pd,align:r.Ay.LEFT,sortable:!1}}function eo(){return{name:_.vg.Missing,header:_.uG.Missing,render:({row:e})=>e.Missing,align:r.Ay.CENTER,defaultOrder:r.Ay.DESCENDING,width:100}}function ed(){return{name:_.vg.Connections,header:_.uG.Connections,render:({row:e})=>(0,p.kf)(e.Connections)?e.Connections:d.Pd,align:r.Ay.RIGHT,width:130}}function eu(){return{name:_.vg.NetworkUtilization,header:_.uG.NetworkUtilization,render:({row:e})=>{let{NetworkUtilization:t,NetworkUtilizationMin:a=0,NetworkUtilizationMax:r=0}=e;return(0,p.kf)(t)?(0,i.jsx)(h.s,{placement:["top","bottom"],content:(0,i.jsxs)(n.u,{responsive:!0,children:[(0,i.jsx)(n.u.Item,{name:(0,V.A)("sum"),children:(0,u.l9)(t)},"NetworkUtilization"),(0,i.jsx)(n.u.Item,{name:(0,V.A)("min"),children:(0,u.l9)(a)},"NetworkUtilizationMin"),(0,i.jsx)(n.u.Item,{name:(0,V.A)("max"),children:(0,u.l9)(r)},"NetworkUtilizationMax")]}),children:(0,u.l9)(t)}):d.Pd},align:r.Ay.RIGHT,width:110}}function ec(){return{name:_.vg.SendThroughput,header:_.uG.SendThroughput,render:({row:e})=>(0,p.kf)(e.SendThroughput)?(0,p.O4)(e.SendThroughput,1):d.Pd,align:r.Ay.RIGHT,width:110}}function em(){return{name:_.vg.ReceiveThroughput,header:_.uG.ReceiveThroughput,render:({row:e})=>(0,p.kf)(e.ReceiveThroughput)?(0,p.O4)(e.ReceiveThroughput,1):d.Pd,align:r.Ay.RIGHT,width:110}}function ep(){return{name:_.vg.PingTime,header:_.uG.PingTime,render:({row:e})=>{let{PingTimeUs:t,PingTimeMinUs:a=0,PingTimeMaxUs:r=0}=e;return(0,p.kf)(t)?(0,i.jsx)(h.s,{placement:["top","bottom"],content:(0,i.jsxs)(n.u,{responsive:!0,children:[(0,i.jsx)(n.u.Item,{name:(0,V.A)("avg"),children:O(t)},"PingTimeUs"),(0,i.jsx)(n.u.Item,{name:(0,V.A)("min"),children:O(a)},"PingTimeMinUs"),(0,i.jsx)(n.u.Item,{name:(0,V.A)("max"),children:O(r)},"PingTimeMaxUs")]}),children:O(t)}):d.Pd},align:r.Ay.RIGHT,width:110}}function eh(){return{name:_.vg.ClockSkew,header:_.uG.ClockSkew,render:({row:e})=>{let{ClockSkewUs:t,ClockSkewMinUs:a=0,ClockSkewMaxUs:r=0}=e;return(0,p.kf)(t)?(0,i.jsx)(h.s,{placement:["top","bottom"],content:(0,i.jsxs)(n.u,{responsive:!0,children:[(0,i.jsx)(n.u.Item,{name:(0,V.A)("avg"),children:z(t)},"ClockSkewUs"),(0,i.jsx)(n.u.Item,{name:(0,V.A)("min"),children:z(a)},"ClockSkewMinUs"),(0,i.jsx)(n.u.Item,{name:(0,V.A)("max"),children:z(r)},"ClockSkewMaxUs")]}),children:z(t)}):d.Pd},align:r.Ay.RIGHT,width:110}}function eg(){return{name:_.vg.ClockSkew,header:_.uG.ClockSkew,align:r.Ay.RIGHT,width:110,resizeMinWidth:90,render:({row:e})=>(0,p.kf)(e.ClockSkewUs)?(0,m.Xo)((0,m.Jc)(e.ClockSkewUs,1)):d.Pd}}function ef(){return{name:_.vg.PingTime,header:_.uG.PingTime,align:r.Ay.RIGHT,width:110,resizeMinWidth:90,render:({row:e})=>(0,p.kf)(e.PingTimeUs)?(0,m.Xo)((0,m.Jc)(e.PingTimeUs)):d.Pd}}},87669:function(e,t,a){a.d(t,{fN:()=>h,kU:()=>f,kn:()=>p,ri:()=>u,sp:()=>k,uG:()=>c,vg:()=>n,xd:()=>o,zO:()=>s});var i=a(28974),r=a(47456);let s="nodesTableColumnsWidth",n={NodeId:"NodeId",Host:"Host",NetworkHost:"NetworkHost",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"RAM",CPU:"CPU",Pools:"Pools",LoadAverage:"LoadAverage",Load:"Load",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:"TotalSessions",Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:"Tablets",PDisks:"PDisks",PileName:"PileName",PDiskUsage:i.Z.MaxPDiskUsage,VDiskSlotUsage:i.Z.MaxVDiskSlotUsage,CapacityAlert:i.Z.CapacityAlert},l=["Pools","Memory"];function o(e){return l.includes(e)}let d=["LoadAverage","PDisks"];function u(e){return d.some(t=>t===e)}let c={get NodeId(){return(0,r.A)("node-id")},get Host(){return(0,r.A)("host")},get NetworkHost(){return(0,r.A)("host")},get Database(){return(0,r.A)("database")},get NodeName(){return(0,r.A)("node-name")},get DC(){return(0,r.A)("dc")},get Rack(){return(0,r.A)("rack")},get Version(){return(0,r.A)("version")},get Uptime(){return(0,r.A)("uptime")},get Memory(){return(0,r.A)("memory")},get RAM(){return(0,r.A)("ram")},get Pools(){return(0,r.A)("pools")},get CPU(){return(0,r.A)("cpu")},get LoadAverage(){return(0,r.A)("load-average")},get Load(){return(0,r.A)("load")},get DiskSpaceUsage(){return(0,r.A)("disk-usage")},get TotalSessions(){return(0,r.A)("sessions")},get Connections(){return(0,r.A)("connections")},get NetworkUtilization(){return(0,r.A)("utilization")},get SendThroughput(){return(0,r.A)("send")},get ReceiveThroughput(){return(0,r.A)("receive")},get PingTime(){return(0,r.A)("ping")},get ClockSkew(){return(0,r.A)("skew")},get Missing(){return(0,r.A)("missing")},get Tablets(){return(0,r.A)("tablets")},get PDisks(){return(0,r.A)("pdisks")},get PileName(){return(0,r.A)("field_pile-name")},get MaxPDiskUsage(){return i.S.MaxPDiskUsage},get MaxVDiskSlotUsage(){return i.S.MaxVDiskSlotUsage},get CapacityAlert(){return i.S.CapacityAlert}},m={get NodeId(){return(0,r.A)("node-id")},get Host(){return(0,r.A)("host")},get NodeName(){return(0,r.A)("node-name")},get Database(){return(0,r.A)("database")},get DiskSpaceUsage(){return(0,r.A)("disk-usage")},get DC(){return(0,r.A)("dc")},get Rack(){return(0,r.A)("rack")},get Missing(){return(0,r.A)("missing")},get Uptime(){return(0,r.A)("uptime")},get Version(){return(0,r.A)("version")},get SystemState(){return(0,r.A)("system-state")},get ConnectStatus(){return(0,r.A)("connect-status")},get NetworkUtilization(){return(0,r.A)("network-utilization")},get ClockSkew(){return(0,r.A)("clock-skew")},get PingTime(){return(0,r.A)("ping-time")},get PileName(){return(0,r.A)("field_pile-name")},get CapacityAlert(){return i.S.CapacityAlert}};function p(e){return m[e]}let h={NodeId:["NodeId"],Host:["Host","Rack","Database","SystemState"],NetworkHost:["Host","Rack","Database","SystemState","ConnectStatus"],Database:["Database"],NodeName:["NodeName"],DC:["DC"],Rack:["Rack"],Version:["Version"],Uptime:["Uptime","DisconnectTime"],Memory:["Memory","MemoryDetailed"],RAM:["Memory"],Pools:["CPU"],CPU:["CPU"],LoadAverage:["LoadAverage"],Load:["LoadAverage"],DiskSpaceUsage:["DiskSpaceUsage"],TotalSessions:["SystemState"],Connections:["Connections"],NetworkUtilization:["NetworkUtilization"],SendThroughput:["SendThroughput"],ReceiveThroughput:["ReceiveThroughput"],PingTime:["PingTime"],ClockSkew:["ClockSkew"],Missing:["Missing"],Tablets:["Tablets","Database"],PDisks:["PDisks"],PileName:["PileName"],MaxPDiskUsage:["MaxPDiskUsage"],MaxVDiskSlotUsage:["MaxVDiskSlotUsage"],CapacityAlert:["CapacityAlert"]},g={NodeId:"NodeId",Host:"Host",NetworkHost:"Host",Database:"Database",NodeName:"NodeName",DC:"DC",Rack:"Rack",Version:"Version",Uptime:"Uptime",Memory:"Memory",RAM:"Memory",CPU:"CPU",Pools:"CPU",LoadAverage:"LoadAverage",Load:"LoadAverage",DiskSpaceUsage:"DiskSpaceUsage",TotalSessions:void 0,Connections:"Connections",NetworkUtilization:"NetworkUtilization",SendThroughput:"SendThroughput",ReceiveThroughput:"ReceiveThroughput",PingTime:"PingTime",ClockSkew:"ClockSkew",Missing:"Missing",Tablets:void 0,PDisks:void 0,PileName:void 0,MaxPDiskUsage:"MaxPDiskUsage",MaxVDiskSlotUsage:"MaxVDiskSlotUsage",CapacityAlert:"CapacityAlert"};function f(e){return g[e]}function k(e){return!!g[e]}},47456:function(e,t,a){a.d(t,{A:()=>s});var i=a(51432),r=JSON.parse('{"node-id":"Node ID","host":"Host","database":"Database","node-name":"Node Name","dc":"DC","rack":"Rack","version":"Version","uptime":"Uptime","memory":"Detailed Memory","ram":"RAM","cpu":"CPU","pools":"Pools","disk-usage":"Disk Usage","tablets":"Tablets","load-average":"Load Average","load":"Load","sessions":"Sessions","missing":"Missing","pdisks":"PDisks","field_memory-used":"Memory used","field_memory-limit":"Memory limit","field_pile-name":"Pile Name","system-state":"System State","connect-status":"Connect Status","utilization":"Utilization","network-utilization":"Network Utilization","connections":"Connections","clock-skew":"Clock Skew","skew":"Skew","ping-time":"Ping Time","ping":"Ping","send":"Send","receive":"Receive","max":"Max","min":"Min","avg":"Avg","sum":"Sum"}');let s=(0,i.g4)("ydb-nodes-columns",{en:r})},28504:function(e,t,a){a.d(t,{E:()=>k});var i=a(74848),r=a(96540),s=a(2543),n=a(50504),l=a(15474),o=a(15749),d=a(78331),u=a(80184),c=a(8946),m=a(25247),p=a(9263),h=a(37296),g=a(96099);let f=(0,m.cn)("pdisk-storage"),k=({data:e={},vDisks:t,showPopup:a,onShowPopup:m,onHidePopup:k,className:v,progressBarClassName:x,viewContext:S,width:N,delayOpen:y=h.s,delayClose:D=h.s,withIcon:b,highlighted:w,highlightedDisk:P,setHighlightedDisk:A})=>{let I,{NodeId:C,PDiskId:j}=e,M=!(0,s.isNil)(C)&&!(0,s.isNil)(j),U=r.useRef(null);return M&&(I=(0,c.Ck)(j,C)),(0,i.jsxs)("div",{className:f(null,v),ref:U,style:{width:N},children:[t?.length?(0,i.jsx)("div",{className:f("vdisks"),children:t.map(e=>{let t=e.StringifiedId,a=P===t;return(0,i.jsx)("div",{className:f("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,i.jsx)(u.y,{withIcon:b,data:e,inactive:!(0,g.OH)(e,S),compact:!0,delayOpen:y,delayClose:D,showPopup:a,onShowPopup:()=>A?.(t),onHidePopup:()=>A?.(void 0),highlighted:a})},t)})}):null,(0,i.jsx)(l.P,{showPopup:a,offset:{mainAxis:2,crossAxis:0},anchorRef:U,onShowPopup:m,onHidePopup:k,renderPopupContent:()=>(0,i.jsx)(d.Oy,{data:e}),delayOpen:y,delayClose:D,children:(0,i.jsx)(o.E,{to:I,className:f("content"),children:(0,i.jsx)(n.V,{withIcon:b,diskAllocatedPercent:e.AllocatedPercent,severity:e.Severity,className:x,highlighted:w,noDataPlaceholder:(0,p.A)("no-data")})})})]})}},25041:function(e,t,a){a.d(t,{z:()=>eM});var i=a(74848),r=a(88831),s=a(96540),n=a(42724),l=a(1459),o=a(22708),d=a(2837),u=a(4283),c=a(14476);let m=c.z.nativeEnum(u.r).catch(u.r.all),p=c.z.nativeEnum(u.G).catch(u.G.groups);var h=a(61738),g=a(65101),f=a(38512),k=a(87669);let v=["NodeId","Host","Uptime","CPU","RAM","PDisks"],x=["NodeId"],S=["Host","DC","Rack","Version","Uptime","Missing","DiskSpaceUsage","CapacityAlert"],N=["MaxPDiskUsage","MaxVDiskSlotUsage","CapacityAlert"],y=S.map(e=>({value:e,content:(0,k.kn)(e)})),D=c.z.custom(e=>S.includes(e)).catch(void 0),b={groups:"groupsSearch",nodes:"nodesSearch"};function w(){let[e,t]=(0,o.useQueryParams)({type:o.StringParam,visible:o.StringParam,groupsSearch:o.StringParam,nodesSearch:o.StringParam,search:o.StringParam,uptimeFilter:o.StringParam,storageNodesGroupBy:o.StringParam,storageGroupsGroupBy:o.StringParam}),[a,i]=(0,h.iK)(d.GS.STORAGE_TYPE,u.G.groups),r=(0,l.uf)(),n=p.parse(e.type),c=m.parse(e.visible),k=e.groupsSearch??"",v=e.nodesSearch??"",x=g.Bm.parse(e.uptimeFilter),S=f.kY.parse(e.storageGroupsGroupBy),N=D.parse(e.storageNodesGroupBy);s.useEffect(()=>{if(e.search){let a={search:void 0};a[b[n]]=e.search,t(a,"replaceIn")}},[e.search,n,t]);let y=e=>{t({visible:e},"replaceIn")},w=s.useCallback(e=>{t({type:e},"replaceIn"),i(e)},[t,i]),P=e=>{t({uptimeFilter:e},"replaceIn")},A=s.useCallback(e=>{t({storageGroupsGroupBy:e||void 0},"replaceIn")},[t]),I=s.useCallback(e=>{t({storageNodesGroupBy:e||void 0},"replaceIn")},[t]);return s.useEffect(()=>{if(r)return;let a={};"CapacityAlert"===e.storageGroupsGroupBy&&(a.storageGroupsGroupBy=void 0),"CapacityAlert"===e.storageNodesGroupBy&&(a.storageNodesGroupBy=void 0),Object.keys(a).length>0&&t(a,"replaceIn")},[r,e.storageGroupsGroupBy,e.storageNodesGroupBy,t]),{storageType:n,visibleEntities:c,groupsSearchValue:k,nodesSearchValue:v,nodesUptimeFilter:x,storageGroupsGroupByParam:S,storageNodesGroupByParam:N,handleTextFilterGroupsChange:e=>{t({groupsSearch:e||void 0},"replaceIn")},handleTextFilterNodesChange:e=>{t({nodesSearch:e||void 0},"replaceIn")},handleVisibleEntitiesChange:y,handleStorageTypeChange:w,handleUptimeFilterChange:P,handleStorageGroupsGroupByParamChange:A,handleStorageNodesGroupByParamChange:I,handleShowAllGroups:()=>{y("all")},handleShowAllNodes:()=>{y("all"),P("All")}}}var P=a(73232),A=a(41254),I=a(31596),C=a(65615),j=a(15045),M=a(282),U=a(74104),E=a(78799),T=a(49745);let R=({visibleEntities:e,onShowAll:t})=>{let a;return(e===u.r.space&&(a=(0,T.A)("empty.out_of_space")),e===u.r.missing&&(a=(0,T.A)("empty.degraded")),a)?(0,i.jsx)(E.U,{title:a,showAll:(0,T.A)("show_all"),onShowAll:t}):null};var G=a(2230),L=a(33583),_=a(36712);let V=({columns:e,database:t,nodeId:a,groupId:r,pDiskId:o,filterGroup:d,filterGroupBy:c,searchValue:m,visibleEntities:p,onShowAll:h,scrollContainerRef:g,renderErrorMessage:k,initialEntitiesCount:v})=>{var x;let S=(0,l.Pm)(),N=(x=(0,l.YA)(),s.useCallback(async e=>{let{limit:t,offset:a,sortParams:i,filters:r,columnsIds:s}=e,{sortOrder:n,columnId:l}=i??{},{searchValue:o,visibleEntities:d,database:u,nodeId:c,groupId:m,pDiskId:p,filterGroup:h,filterGroupBy:g}=r??{},k=(0,f.GP)(l),v=k?(0,L.T)(k,n):void 0,S=(0,_.R)(s,f.YX),{groups:N,found:y,total:D}=await (0,G.t)({limit:t,offset:a,sort:v,filter:o,with:d,database:u,nodeId:c,groupId:m,pDiskId:p,filter_group:h,filter_group_by:g,fieldsRequired:S,shouldUseGroupsHandler:x});return{data:N||[],found:y||0,total:D||0}},[x])),y=s.useMemo(()=>({searchValue:m,visibleEntities:p,database:t,nodeId:a,groupId:r,pDiskId:o,filterGroup:d,filterGroupBy:c}),[m,p,t,a,r,o,d,c]);return(0,i.jsx)(n.r,{loading:!S,children:(0,i.jsx)(U.k5,{columnsWidthLSKey:f.qK,scrollContainerRef:g,columns:e,fetchData:N,initialEntitiesCount:v,renderErrorMessage:k,renderEmptyDataMessage:()=>p!==u.r.all?(0,i.jsx)(R,{onShowAll:h,visibleEntities:p}):(0,T.A)("empty.default"),filters:y,tableName:U.qr.STORAGE_GROUPS})})};var O=a(33702),z=a(15491);function W({visibleEntities:e,viewContext:t}){let a=(0,r.X)(),i=(0,r.b)(),n=(0,l.Z9)(),o=(0,l.uf)(),d=s.useMemo(()=>{let e=[];return n||e.push(f.UW.PileName),o||e.push(...f.k7),!a&&(e.push(...f.in),i||e.push(...f.oq)),e},[n,o,a,i]),c=s.useMemo(()=>(0,z.J)({viewContext:t}).filter(e=>!d.some(t=>t===e.name)),[t,d]),m=s.useMemo(()=>e===u.r.missing?[...f.LO,f.UW.Degraded]:e===u.r.space?[...f.LO,f.UW.DiskSpace]:f.LO,[e]),p=s.useMemo(()=>n?f.hu.includes(f.UW.PileName)?f.hu:[...f.hu,f.UW.PileName]:f.hu,[n]);return(0,O.K)(c,f.zY,f.H6,p,m)}var H=a(51670),F=a(4627),B=a(9263),Y=a(37296),J=a(77269),$=a(43834),q=a(53211),K=a(12623),Q=a(29472),X=a(81392);let Z={[u.G.groups]:"Groups",[u.G.nodes]:"Nodes"},ee=({value:e,onChange:t})=>(0,i.jsxs)(X.x,{value:e,onUpdate:t,qa:"storage-type-filter",children:[(0,i.jsx)(X.x.Option,{value:u.G.groups,children:Z[u.G.groups]}),(0,i.jsx)(X.x.Option,{value:u.G.nodes,children:Z[u.G.nodes]})]}),et={[u.r.all]:"All",[u.r.missing]:"Degraded",[u.r.space]:"Out of Space"},ea=({value:e,onChange:t})=>(0,i.jsxs)(X.x,{value:e,onUpdate:t,qa:"storage-visible-entities-filter",children:[(0,i.jsx)(X.x.Option,{value:u.r.missing,children:et[u.r.missing]}),(0,i.jsx)(X.x.Option,{value:u.r.space,children:et[u.r.space]}),(0,i.jsx)(X.x.Option,{value:u.r.all,children:et[u.r.all]})]});function ei({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a,entitiesCountTotal:n,entitiesLoading:o}){let{groupsSearchValue:d,storageType:u,visibleEntities:c,storageGroupsGroupByParam:m,handleTextFilterGroupsChange:p,handleStorageTypeChange:h,handleVisibleEntitiesChange:g,handleStorageGroupsGroupByParamChange:k}=w(),v=(0,r.X)(),x=(0,l.Z9)(),S=(0,l.uf)(),N=s.useMemo(()=>{let e=[];return x||e.push("PileName"),S||e.push("CapacityAlert"),f.SE.filter(t=>!e.includes(t.value))},[x,S]);return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(Q.v,{value:d,onChange:p,placeholder:(0,B.A)("controls_groups-search-placeholder"),className:(0,Y.b)("search")}),e&&v&&(0,i.jsx)(ee,{value:u,onChange:h}),t?null:(0,i.jsx)(ea,{value:c,onChange:g}),t?(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(J.E,{variant:"body-2",children:(0,B.A)("controls_group-by-placeholder")}),(0,i.jsx)($.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:m?[m]:void 0,onUpdate:e=>{k(e[0])},options:N})]}):null,(0,i.jsx)(q.T,{label:(0,B.A)("groups"),loading:o,total:n,current:a})]})}function er({withTypeSelector:e,withGroupBySelect:t}){let{tableState:a}=(0,K.WV)();return(0,i.jsx)(ei,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a.foundEntities,entitiesCountTotal:a.totalEntities,entitiesLoading:a.isInitialLoad})}let es=s.memo(function({name:e,count:t,isExpanded:a,database:r,nodeId:s,groupId:n,pDiskId:l,searchValue:o,scrollContainerRef:d,filterGroupBy:u,columns:c,onIsExpandedChange:m,handleShowAllGroups:p}){let h="CapacityAlert"===u?(0,j.e)(e):void 0;return(0,i.jsx)(H.Q,{title:e,count:t,entityName:(0,B.A)("groups"),expanded:a,onIsExpandedChange:m,titleColor:h,children:(0,i.jsx)(A.o,{initialState:{sortParams:void 0},table:(0,i.jsx)(V,{database:r,scrollContainerRef:d,nodeId:s,groupId:n,pDiskId:l,filterGroup:e,filterGroupBy:u,searchValue:o,visibleEntities:"all",onShowAll:p,renderErrorMessage:M.$,columns:c,initialEntitiesCount:t}),tableWrapperProps:{scrollContainerRef:d}})},e)});function en({database:e,nodeId:t,groupId:a,pDiskId:r,scrollContainerRef:n,viewContext:l}){let[o]=(0,h.Nt)(),{groupsSearchValue:d,storageGroupsGroupByParam:u,visibleEntities:c,handleShowAllGroups:m}=w(),{columnsToShow:p,columnsToSelect:g,setColumns:f}=W({visibleEntities:c,viewContext:l}),{currentData:k,isFetching:v,error:x}=C.S.useGetStorageGroupsInfoQuery({database:e,with:"all",nodeId:t,groupId:a,pDiskId:r,filter:d,shouldUseGroupsHandler:!0,group:u},{pollingInterval:o}),S=void 0===k&&v,{tableGroups:N,found:y=0,total:D=0}=k||{},{expandedGroups:b,setIsGroupExpanded:j}=(0,F.$)(N),M=s.useMemo(()=>({foundEntities:y,totalEntities:D,isInitialLoad:S,sortParams:void 0}),[y,D,S]);return(0,i.jsx)(A.o,{controls:(0,i.jsx)(ei,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:y,entitiesCountTotal:D,entitiesLoading:S}),extraControls:(0,i.jsx)(I.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:f}),error:x?(0,i.jsx)(P.o,{error:x}):null,table:N?.length?N.map(({name:s,count:l})=>{let o=b[s];return(0,i.jsx)(es,{name:s,count:l,isExpanded:o,database:e,nodeId:t,groupId:a,pDiskId:r,filterGroupBy:u,searchValue:d,visibleEntities:"all",scrollContainerRef:n,onIsExpandedChange:j,handleShowAllGroups:m,columns:p},s)}):(0,B.A)("no-groups"),initialState:M,tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[d,u,N],loading:S,className:(0,Y.b)("groups-wrapper")}})}function el({database:e,nodeId:t,groupId:a,pDiskId:r,viewContext:s,scrollContainerRef:n,initialEntitiesCount:o}){let{groupsSearchValue:d,visibleEntities:u,handleShowAllGroups:c}=w(),m=(0,l.SA)(),{columnsToShow:p,columnsToSelect:h,setColumns:g}=W({visibleEntities:u,viewContext:s});return(0,i.jsx)(A.o,{controls:(0,i.jsx)(er,{withTypeSelector:!0,withGroupBySelect:m}),extraControls:(0,i.jsx)(I.O,{popupWidth:200,items:h,showStatus:!0,onUpdate:g}),table:(0,i.jsx)(V,{database:e,nodeId:t,groupId:a,pDiskId:r,searchValue:d,visibleEntities:u,onShowAll:c,scrollContainerRef:n,renderErrorMessage:M.$,columns:p,initialEntitiesCount:o}),tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[d,u]}})}function eo(e){let{storageGroupsGroupByParam:t,visibleEntities:a,handleShowAllGroups:r}=w(),o=(0,l.Pm)(),d=(0,l.SA)();return s.useEffect(()=>{d&&"all"!==a&&r()},[r,d,a]),(0,i.jsx)(n.r,{loading:!o,children:d&&t?(0,i.jsx)(en,{...e}):(0,i.jsx)(el,{...e})})}var ed=a(67103),eu=a(25247),ec=a(51432),em=JSON.parse('{"empty.default":"No such nodes","empty.out_of_space":"No nodes with out of space errors","empty.degraded":"No degraded nodes","empty.small_uptime":"No nodes with uptime < 1h","empty.several_filters":"No nodes match current filters combination","show_all":"Show all nodes"}'),ep=JSON.parse('{"empty.default":"Нет узлов","empty.out_of_space":"Нет узлов, в которых кончается место","empty.degraded":"Нет деградировавших узлов","empty.small_uptime":"Нет узлов с uptime < 1h","empty.several_filters":"Нет узлов, подходящих под текущие фильтры","show_all":"Показать все узлы"}');let eh=(0,ec.g4)("ydb-storage-nodes",{ru:ep,en:em}),eg=({visibleEntities:e,nodesUptimeFilter:t,onShowAll:a})=>{let r;return(e===u.r.space&&(r=eh("empty.out_of_space")),e===u.r.missing&&(r=eh("empty.degraded")),"SmallUptime"===t&&(r=eh("empty.small_uptime")),e!==u.r.all&&"All"!==t&&(r=eh("empty.several_filters")),r)?(0,i.jsx)(E.U,{title:r,showAll:eh("show_all"),onShowAll:a}):null};var ef=a(58405);let ek=async e=>{let{type:t="static",storage:a=!0,limit:i,offset:r,sortParams:s,filters:n,columnsIds:l}=e,{searchValue:o,nodesUptimeFilter:d,visibleEntities:u,database:c,nodeId:m,groupId:p,filterGroup:h,filterGroupBy:f}=n??{},{sortOrder:v,columnId:x}=s??{},S=(0,k.kU)(x),N=S?(0,L.T)(S,v):void 0,y=(0,_.R)(l,k.fN),D=await window.api.viewer.getNodes({type:t,storage:a,limit:i,offset:r,sort:N,filter:o,uptime:(0,g.Fo)(d),with:u,database:c,node_id:m,group_id:p,filter_group:h,filter_group_by:f,fieldsRequired:y}),b=(0,ef.rz)(D);return{data:b.nodes||[],found:b.found||0,total:b.total||0,columnsSettings:b.columnsSettings}},ev=(0,eu.cn)("ydb-storage-nodes"),ex=e=>ev("node",{unavailable:(0,g.X7)(e)}),eS=({columns:e,database:t,nodeId:a,groupId:r,filterGroup:n,filterGroupBy:l,searchValue:o,visibleEntities:d,nodesUptimeFilter:c,onShowAll:m,scrollContainerRef:p,renderErrorMessage:h,initialEntitiesCount:g,onDataFetched:f})=>{let k=s.useMemo(()=>({searchValue:o,visibleEntities:d,nodesUptimeFilter:c,database:t,nodeId:a,groupId:r,filterGroup:n,filterGroupBy:l}),[o,d,c,t,a,r,n,l]);return(0,i.jsx)(U.k5,{columnsWidthLSKey:"storageNodesColumnsWidth",scrollContainerRef:p,columns:e,fetchData:ek,rowHeight:51,initialEntitiesCount:g,renderErrorMessage:h,renderEmptyDataMessage:()=>d!==u.r.all||"All"!==c?(0,i.jsx)(eg,{onShowAll:m,nodesUptimeFilter:c,visibleEntities:d}):eh("empty.default"),getRowClassName:ex,filters:k,tableName:U.qr.STORAGE_NODES,onDataFetched:f})};var eN=a(96099),ey=a(92961);function eD({withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a,entitiesCountTotal:r,entitiesLoading:n}){let{nodesSearchValue:o,storageType:d,visibleEntities:u,nodesUptimeFilter:c,storageNodesGroupByParam:m,handleTextFilterNodesChange:p,handleStorageTypeChange:h,handleVisibleEntitiesChange:g,handleUptimeFilterChange:f,handleStorageNodesGroupByParamChange:k}=w(),v=(0,l.uf)(),x=s.useMemo(()=>{let e=[];return v||e.push("CapacityAlert"),y.filter(t=>!e.includes(t.value))},[v]);return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(Q.v,{value:o,onChange:p,placeholder:(0,B.A)("controls_nodes-search-placeholder"),className:(0,Y.b)("search")}),e&&(0,i.jsx)(ee,{value:d,onChange:h}),t?null:(0,i.jsx)(ea,{value:u,onChange:g}),t?null:(0,i.jsx)(ey.j,{value:c,onChange:f}),t?(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(J.E,{variant:"body-2",children:(0,B.A)("controls_group-by-placeholder")}),(0,i.jsx)($.l,{hasClear:!0,placeholder:"-",width:150,defaultValue:m?[m]:void 0,onUpdate:e=>{k(e[0])},options:x})]}):null,(0,i.jsx)(q.T,{label:(0,B.A)("nodes"),loading:n,total:r,current:a})]})}function eb({withTypeSelector:e,withGroupBySelect:t}){let{tableState:a}=(0,K.WV)();return(0,i.jsx)(eD,{withTypeSelector:e,withGroupBySelect:t,entitiesCountCurrent:a.foundEntities,entitiesCountTotal:a.totalEntities,entitiesLoading:a.isInitialLoad})}var ew=a(40159);function eP({database:e,viewContext:t,columnsSettings:a}){let{visibleEntities:i}=w();return function({visibleEntities:e,database:t,viewContext:a,columnsSettings:i}){let r=(0,l.Z9)(),n=(0,l.uf)(),o=s.useMemo(()=>{let e=[];return r||e.push(k.vg.PileName),n||e.push(...N),e},[r,n]),d=s.useMemo(()=>(0,ew.C)({database:t,viewContext:a,columnsSettings:i}).filter(e=>!o.some(t=>t===e.name)),[t,a,i,o]),c=s.useMemo(()=>e===u.r.missing?[...x,k.vg.Missing]:x,[e]),m=s.useMemo(()=>r?v.includes(k.vg.PileName)?v:[...v,k.vg.PileName]:v,[r]);return(0,O.K)(d,"storageNodesSelectedColumns",k.uG,m,c)}({visibleEntities:i,database:e,viewContext:t,columnsSettings:a})}let eA=s.memo(function({name:e,count:t,isExpanded:a,database:r,nodeId:s,groupId:n,searchValue:l,scrollContainerRef:o,filterGroupBy:d,columns:u,onIsExpandedChange:c,handleShowAllNodes:m,onDataFetched:p}){let h="CapacityAlert"===d?(0,j.e)(e):void 0;return(0,i.jsx)(H.Q,{title:e,count:t,entityName:(0,B.A)("nodes"),expanded:a,onIsExpandedChange:c,titleColor:h,children:(0,i.jsx)(A.o,{initialState:{sortParams:void 0},table:(0,i.jsx)(eS,{database:r,scrollContainerRef:o,nodeId:s,groupId:n,filterGroup:e,filterGroupBy:d,searchValue:l,visibleEntities:"all",nodesUptimeFilter:"All",onShowAll:m,renderErrorMessage:M.$,columns:u,initialEntitiesCount:t,onDataFetched:p}),tableWrapperProps:{scrollContainerRef:o}})},e)});function eI({database:e,groupId:t,nodeId:a,viewContext:r,scrollContainerRef:n}){let[l]=(0,h.Nt)(),{nodesSearchValue:o,storageNodesGroupByParam:d,handleShowAllNodes:u}=w(),{handleDataFetched:c,columnsSettings:m}=(0,eN.fj)(),{columnsToShow:p,columnsToSelect:g,setColumns:f}=eP({database:e,viewContext:r,columnsSettings:m}),{currentData:k,isFetching:v,error:x}=C.S.useGetStorageNodesInfoQuery({database:e,with:"all",filter:o,node_id:a,group_id:t,group:d},{pollingInterval:l}),S=void 0===k&&v,{tableGroups:N,found:y=0,total:D=0}=k||{},{expandedGroups:b,setIsGroupExpanded:P}=(0,F.$)(N),j=s.useMemo(()=>({foundEntities:y,totalEntities:D,isInitialLoad:S,sortParams:void 0}),[y,D,S]);return(0,i.jsx)(A.o,{controls:(0,i.jsx)(eD,{withTypeSelector:!0,withGroupBySelect:!0,entitiesCountCurrent:y,entitiesCountTotal:D,entitiesLoading:S}),extraControls:(0,i.jsx)(I.O,{popupWidth:200,items:g,showStatus:!0,onUpdate:f}),error:x?(0,i.jsx)(ed.o,{error:x}):null,table:N?.length?N.map(({name:r,count:s})=>{let l=b[r];return(0,i.jsx)(eA,{name:r,count:s,isExpanded:l,database:e,nodeId:a,groupId:t,searchValue:o,visibleEntities:"all",filterGroupBy:d,scrollContainerRef:n,onIsExpandedChange:P,handleShowAllNodes:u,columns:p,onDataFetched:c},r)}):(0,B.A)("no-nodes"),initialState:j,tableWrapperProps:{scrollContainerRef:n,scrollDependencies:[o,d,N],loading:S,className:(0,Y.b)("groups-wrapper")}})}function eC({database:e,nodeId:t,groupId:a,viewContext:r,scrollContainerRef:s,initialEntitiesCount:n}){let{nodesSearchValue:o,visibleEntities:d,nodesUptimeFilter:u,handleShowAllNodes:c}=w(),m=(0,l.Ye)(),{handleDataFetched:p,columnsSettings:h}=(0,eN.fj)(),{columnsToShow:g,columnsToSelect:f,setColumns:k}=eP({database:e,viewContext:r,columnsSettings:h});return(0,i.jsx)(A.o,{controls:(0,i.jsx)(eb,{withTypeSelector:!0,withGroupBySelect:m}),extraControls:(0,i.jsx)(I.O,{popupWidth:200,items:f,showStatus:!0,onUpdate:k}),table:(0,i.jsx)(eS,{database:e,nodeId:t,groupId:a,searchValue:o,visibleEntities:d,nodesUptimeFilter:u,onShowAll:c,scrollContainerRef:s,renderErrorMessage:M.$,columns:g,initialEntitiesCount:n,onDataFetched:p}),tableWrapperProps:{scrollContainerRef:s,scrollDependencies:[o,d,u]}})}function ej(e){let{storageNodesGroupByParam:t,visibleEntities:a,nodesUptimeFilter:r,handleShowAllNodes:o}=w(),d=(0,l.Pm)(),u=(0,l.Ye)();return s.useEffect(()=>{u&&("all"!==a||"All"!==r)&&o()},[o,r,u,a]),(0,i.jsx)(n.r,{loading:!d,children:u&&t?(0,i.jsx)(eI,{...e}):(0,i.jsx)(eC,{...e})})}let eM=e=>{let{storageType:t}=w();!function(){let[e,t]=(0,o.useQueryParam)("type",o.StringParam),[a]=(0,h.iK)(d.GS.STORAGE_TYPE,u.G.groups),i=s.useMemo(()=>p.parse(e??a),[e,a]);s.useEffect(()=>{i!==e&&t(i)},[i,e,t])}();let a=(0,r.X)();return"nodes"===t&&a?(0,i.jsx)(ej,{initialEntitiesCount:(0,eN.b0)(e.viewContext),...e}):(0,i.jsx)(eo,{initialEntitiesCount:(0,eN.QQ)(e.viewContext),...e})}},15491:function(e,t,a){a.d(t,{k:()=>er,J:()=>es});var i=a(74848),r=a(82687),s=a(29581),n=a(85169),l=a(5434),o=a(29901),d=a(17427),u=a(2543),c=a(5948),m=a(93397),p=a(17989),h=a(79092),g=a(62113),f=a(8946),k=a(25247),v=a(35537),x=a(97855),S=a(14016),N=a(51630),y=a(28241),D=a(96540),b=a(70900),w=a(80184),P=a(28504),A=a(37296),I=a(96099);let C=(0,k.cn)("ydb-storage-disks");function j({vDisks:e=[],viewContext:t,erasure:a,withIcon:r}){let s=(0,I.Ep)(e,a),[l,o]=D.useState(),{theme:{spaceBaseSize:d}}=(0,b.L)();if(!e.length)return null;let u=(316-d*(e.length-1))/e.length;return(0,i.jsxs)("div",{className:C(null),children:[(0,i.jsx)(n.s,{direction:"row",gap:1,grow:!0,style:{width:316},children:e?.map((e,a)=>(0,i.jsx)(M,{vDisk:e,inactive:!(0,I.OH)(e,t),highlightedVDisk:l,setHighlightedVDisk:o,unavailableVDiskWidth:u,withIcon:r},e.StringifiedId||a))}),(0,i.jsx)("div",{className:C("pdisks-wrapper"),children:e?.map((e,t)=>(0,i.jsx)(U,{vDisk:e,highlightedVDisk:l,setHighlightedVDisk:o,withDCMargin:s.includes(t),withIcon:r},e?.PDisk?.StringifiedId||t))})]})}function M({vDisk:e,highlightedVDisk:t,inactive:a,setHighlightedVDisk:r,unavailableVDiskWidth:s,withIcon:n}){let l={...e,PDisk:void 0},o=e.StringifiedId,d=(0,y.kf)(l.AllocatedSize)?void 0:s,u=Number(l.AllocatedSize)||1,c=t===o;return(0,i.jsx)("div",{style:{flexGrow:u,minWidth:d},className:C("vdisk-item"),children:(0,i.jsx)(w.y,{data:l,compact:!0,withIcon:n,inactive:a,showPopup:c,delayOpen:A.s,delayClose:A.s,onShowPopup:()=>r?.(o),onHidePopup:()=>r?.(void 0),progressBarClassName:C("vdisk-progress-bar"),highlighted:c})})}function U({vDisk:e,highlightedVDisk:t,setHighlightedVDisk:a,withDCMargin:r,withIcon:s}){let n=e.StringifiedId,l=t===n;return e.PDisk?(0,i.jsx)(P.E,{className:C("pdisk-item",{"with-dc-margin":r}),progressBarClassName:C("pdisk-progress-bar"),data:e.PDisk,showPopup:l,delayOpen:A.s,delayClose:A.s,onShowPopup:()=>a?.(n),onHidePopup:()=>a?.(void 0),withIcon:s,highlighted:l}):null}var E=a(7360);let T=(0,k.cn)("stack"),R=({children:e,className:t})=>(0,i.jsx)("div",{className:T(null,t),children:D.Children.map(e,(e,t)=>D.isValidElement(e)?(0,i.jsx)("div",{className:T("layer"),style:{"--ydb-stack-level":t},children:e}):null)});function G({data:e,className:t,stackClassName:a,withIcon:r,highlightedVDisk:s,setHighlightedVDisk:n,...l}){let{Donors:o,...d}=e||{},u=e?.StringifiedId,c=!!(u&&s===u),m={withIcon:r,showPopup:c,highlighted:c,onShowPopup:D.useCallback(()=>{u&&n?.(u)},[u,n]),onHidePopup:D.useCallback(()=>{n?.(void 0)},[n]),...l},p=o&&o.length>0?(0,i.jsxs)(R,{className:a,children:[(0,i.jsx)(w.y,{data:d,...m}),o.map(e=>{let t=(0,E.NJ)(e);return(0,i.jsx)(w.y,{data:e,...m},(0,x.U9)(t?e.VDiskId:e))})]}):(0,i.jsx)(w.y,{data:e,withIcon:r,...m});return(0,i.jsx)("div",{className:t,children:p})}let L=(0,k.cn)("ydb-storage-vdisks");function _({vDisks:e,viewContext:t,erasure:a,withIcon:r}){let s=(0,I.Ep)(e,a),[n,l]=D.useState();return(0,i.jsx)("div",{className:L("wrapper"),children:e?.map((e,a)=>(0,i.jsx)(G,{withIcon:r,data:e,inactive:!(0,I.OH)(e,t),delayOpen:A.s,delayClose:A.s,className:L("item",{"with-dc-margin":s.includes(a)}),highlightedVDisk:n,setHighlightedVDisk:l,progressBarClassName:L("vdisks-progress-bar")},e.StringifiedId))})}var V=a(49745),O=a(38512);let z=(0,k.cn)("ydb-storage-groups-columns"),W={name:O.UW.PoolName,header:O.H6.PoolName,width:250,render:({row:e})=>e.PoolName?(0,i.jsx)(c.s,{content:e.PoolName,placement:["right"],openDelay:0,className:z("pool-name-wrapper"),children:(0,i.jsx)("span",{className:z("pool-name"),children:e.PoolName})}):v.Pd,align:s.Ay.LEFT},H={name:O.UW.PileName,header:O.H6.PileName,width:120,render:({row:e})=>e.PileName||v.Pd,align:s.Ay.LEFT},F={name:O.UW.MediaType,header:O.H6.MediaType,width:100,resizeMinWidth:100,align:s.Ay.LEFT,render:({row:e})=>(0,i.jsxs)(n.s,{children:[(0,i.jsx)(l.J,{children:e.MediaType||v.Pd}),"\xa0",e.Encryption&&(0,i.jsx)(o.A,{content:(0,V.A)("encrypted"),placement:"right",className:v.zQ,children:(0,i.jsx)(l.J,{children:(0,i.jsx)(d.I,{data:r.A,size:18})})})]}),sortable:!1},B={name:O.UW.Erasure,header:O.H6.Erasure,width:100,sortAccessor:e=>e.ErasureSpecies,render:({row:e})=>e.ErasureSpecies?e.ErasureSpecies:v.Pd,align:s.Ay.LEFT},Y={name:O.UW.Degraded,header:O.H6.Degraded,width:110,resizeMinWidth:110,render:({row:e})=>e.Degraded?(0,i.jsxs)(l.J,{theme:(0,I.k_)(e),children:["Degraded: ",e.Degraded]}):"-",align:s.Ay.LEFT,defaultOrder:s.Ay.DESCENDING},J={name:O.UW.State,header:O.H6.State,width:150,render:({row:e})=>e.State??v.Pd,align:s.Ay.LEFT,defaultOrder:s.Ay.DESCENDING},$={name:O.UW.Usage,header:O.H6.Usage,width:85,resizeMinWidth:75,render:({row:e})=>(0,u.isNil)(e.Usage)?v.Pd:(0,i.jsx)(h.U,{value:Math.floor(e.Usage),theme:(0,S.f)(e.Usage)}),align:s.Ay.LEFT},q={name:O.UW.DiskSpaceUsage,header:O.H6.DiskSpaceUsage,width:115,resizeMinWidth:75,render:({row:e})=>(0,u.isNil)(e.DiskSpaceUsage)?v.Pd:(0,i.jsx)(h.U,{value:Math.floor(e.DiskSpaceUsage),theme:(0,S.f)(e.DiskSpaceUsage)}),align:s.Ay.LEFT},K={name:O.UW.GroupId,header:O.H6.GroupId,width:140,render:({row:e})=>e.GroupId?(0,i.jsx)(en,{id:e.GroupId}):v.Pd,sortAccessor:e=>Number(e.GroupId),align:s.Ay.LEFT},Q={name:O.UW.Used,header:O.H6.Used,width:100,render:({row:e})=>(0,y.wb)(e.Used,!0),align:s.Ay.RIGHT},X={name:O.UW.Limit,header:O.H6.Limit,width:100,render:({row:e})=>(0,y.wb)(e.Limit),align:s.Ay.RIGHT},Z={name:O.UW.DiskSpace,header:O.H6.DiskSpace,width:70,render:({row:e})=>(0,i.jsx)(p.k,{status:e.DiskSpace}),align:s.Ay.CENTER},ee={name:O.UW.Read,header:O.H6.Read,width:100,render:({row:e})=>e.Read?(0,y.O4)(e.Read):v.Pd,align:s.Ay.RIGHT},et={name:O.UW.Write,header:O.H6.Write,width:100,render:({row:e})=>e.Write?(0,y.O4)(e.Write):v.Pd,align:s.Ay.RIGHT},ea={name:O.UW.Latency,header:O.H6.Latency,width:100,render:({row:e})=>(0,u.isNil)(e.LatencyPutTabletLogMs)?v.Pd:(0,N.Xo)(e.LatencyPutTabletLogMs),align:s.Ay.RIGHT},ei={name:O.UW.AllocationUnits,header:O.H6.AllocationUnits,width:150,render:({row:e})=>(0,u.isNil)(e.AllocationUnits)?v.Pd:(0,x.ZV)(e.AllocationUnits),align:s.Ay.RIGHT},er=()=>[K,F,B,$,Q,X],es=e=>[K,W,H,F,B,Y,J,$,q,Q,X,Z,ee,et,ea,ei,{name:O.UW.VDisks,header:O.H6.VDisks,className:z("vdisks-column"),render:({row:t})=>(0,i.jsx)(_,{vDisks:t.VDisks,viewContext:e?.viewContext,erasure:t.ErasureSpecies,withIcon:!0}),align:s.Ay.CENTER,width:475,resizeable:!1,sortable:!1},{name:O.UW.VDisksPDisks,header:O.H6.VDisksPDisks,className:z("disks-column"),render:({row:t})=>(0,i.jsx)(j,{vDisks:t.VDisks,viewContext:e?.viewContext,erasure:t.ErasureSpecies,withIcon:!0}),align:s.Ay.CENTER,width:800,resizeable:!1,sortable:!1},(0,g.T5)(),(0,g.H0)(),(0,g.nX)(),(0,g.jP)(),(0,g.fh)()].map(e=>({...e,sortable:(0,O.i4)(e.name)}));function en({id:e}){let t=(0,f.zO)();return(0,i.jsx)(m.c,{name:String(e),path:t(e),hasClipboardButton:!0,showStatus:!1})}},38512:function(e,t,a){a.d(t,{YX:()=>N,k7:()=>h,UW:()=>u,i4:()=>b,qK:()=>o,SE:()=>x,hu:()=>m,LO:()=>g,H6:()=>f,zY:()=>d,GP:()=>D,kY:()=>S,in:()=>c,oq:()=>p});var i=a(14476),r=a(28974),s=a(51432),n=JSON.parse('{"pool-name":"Pool Name","pile-name":"Pile Name","type":"Type","encryption":"Encryption","erasure":"Erasure","degraded":"Degraded","missing-disks":"Missing Disks","state":"State","usage":"Usage","disk-usage":"Disk usage","group-id":"Group ID","used":"Used","limit":"Limit","space":"Space","read":"Read","write":"Write","latency":"Latency","allocation-units":"Allocation Units","vdisks":"VDisks","vdisks-pdisks":"VDisks with PDisks"}');let l=(0,s.g4)("ydb-storage-groups-columns",{en:n}),o="storageGroupsColumnsWidth",d="storageGroupsSelectedColumns",u={GroupId:"GroupId",PoolName:"PoolName",PileName:"PileName",MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:"DiskSpace",Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:"VDisks",VDisksPDisks:"VDisksPDisks",Degraded:"Degraded",State:"State",...r.Z},c=["DiskSpaceUsage","Latency","AllocationUnits","VDisksPDisks"],m=["GroupId","PoolName","Erasure","Used","VDisks"],p=["DiskSpace"],h=["MaxPDiskUsage","MaxVDiskSlotUsage","MaxVDiskRawUsage","MaxNormalizedOccupancy","CapacityAlert"],g=["GroupId"],f={get PoolName(){return l("pool-name")},get MediaType(){return l("type")},get PileName(){return l("pile-name")},get Erasure(){return l("erasure")},get GroupId(){return l("group-id")},get Used(){return l("used")},get Limit(){return l("limit")},get Usage(){return l("usage")},get DiskSpaceUsage(){return l("disk-usage")},get DiskSpace(){return l("space")},get Read(){return l("read")},get Write(){return l("write")},get Latency(){return l("latency")},get AllocationUnits(){return l("allocation-units")},get VDisks(){return l("vdisks")},get VDisksPDisks(){return l("vdisks-pdisks")},get Degraded(){return l("missing-disks")},get State(){return l("state")},get MaxPDiskUsage(){return r.S.MaxPDiskUsage},get MaxVDiskSlotUsage(){return r.S.MaxVDiskSlotUsage},get MaxVDiskRawUsage(){return r.S.MaxVDiskRawUsage},get MaxNormalizedOccupancy(){return r.S.MaxNormalizedOccupancy},get CapacityAlert(){return r.S.CapacityAlert}},k={get GroupId(){return l("group-id")},get Erasure(){return l("erasure")},get Usage(){return l("usage")},get DiskSpaceUsage(){return l("disk-usage")},get PoolName(){return l("pool-name")},get PileName(){return l("pile-name")},get Kind(){return l("type")},get Encryption(){return l("encryption")},get MediaType(){return l("type")},get MissingDisks(){return l("missing-disks")},get State(){return l("state")},get Latency(){return l("latency")},get CapacityAlert(){return r.S.CapacityAlert}},v=["PoolName","PileName","MediaType","Encryption","Erasure","Usage","DiskSpaceUsage","State","MissingDisks","Latency","CapacityAlert"],x=v.map(e=>({value:e,content:k[e]})),S=i.z.custom(e=>v.includes(e)).catch(void 0),N={GroupId:["GroupId"],PoolName:["PoolName"],PileName:["PileName"],MediaType:["MediaType","Encryption"],Erasure:["Erasure"],Used:["Used"],Limit:["Limit"],Usage:["Usage"],DiskSpaceUsage:["DiskSpaceUsage"],DiskSpace:["State"],Read:["Read"],Write:["Write"],Latency:["Latency"],AllocationUnits:["AllocationUnits"],VDisks:["VDisk","PDisk","Read","Write"],VDisksPDisks:["VDisk","PDisk","Read","Write"],Degraded:["MissingDisks"],State:["State"],MaxPDiskUsage:["MaxPDiskUsage"],MaxVDiskSlotUsage:["MaxVDiskSlotUsage"],MaxVDiskRawUsage:["MaxVDiskRawUsage"],MaxNormalizedOccupancy:["MaxNormalizedOccupancy"],CapacityAlert:["CapacityAlert"]},y={GroupId:"GroupId",PoolName:"PoolName",PileName:void 0,MediaType:"MediaType",Erasure:"Erasure",Used:"Used",Limit:"Limit",Usage:"Usage",DiskSpaceUsage:"DiskSpaceUsage",DiskSpace:void 0,Read:"Read",Write:"Write",Latency:"Latency",AllocationUnits:"AllocationUnits",VDisks:void 0,VDisksPDisks:void 0,Degraded:"Degraded",State:"State",MaxPDiskUsage:"MaxPDiskUsage",MaxVDiskSlotUsage:"MaxVDiskSlotUsage",MaxVDiskRawUsage:"MaxVDiskRawUsage",MaxNormalizedOccupancy:"MaxNormalizedOccupancy",CapacityAlert:"CapacityAlert"};function D(e){return y[e]}function b(e){return!!y[e]}},49745:function(e,t,a){a.d(t,{A:()=>n});var i=a(51432),r=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),s=JSON.parse('{"empty.default":"Нет групп","empty.out_of_space":"Нет групп, в которых кончается место","empty.degraded":"Нет деградировавших групп","show_all":"Показать все группы","encrypted":"Зашифрованная группа"}');let n=(0,i.g4)("ydb-storage-groups",{ru:s,en:r})},40159:function(e,t,a){a.d(t,{t:()=>h,C:()=>g});var i=a(74848),r=a(29581),s=a(62113),n=a(65943),l=a(87669),o=a(25247),d=a(96540),u=a(28504);let c=(0,o.cn)("ydb-storage-pdisks");function m({pDisks:e=[],vDisks:t=[],viewContext:a,pDiskWidth:r}){let[s,n]=d.useState();return e.length?(0,i.jsx)("div",{className:c("pdisks-wrapper"),children:e.map(e=>{let l=e.StringifiedId,o=t.filter(t=>t.PDiskId===e.PDiskId),d=s===l;return(0,i.jsx)("div",{className:c("pdisks-item"),children:(0,i.jsx)(u.E,{data:e,vDisks:o,viewContext:a,width:r,showPopup:d,onShowPopup:()=>n(l),onHidePopup:()=>n(void 0),highlighted:d,highlightedDisk:s,setHighlightedDisk:n})},l)})}):null}let p=(0,o.cn)("ydb-storage-nodes-columns"),h=({viewContext:e,columnsSettings:t})=>({name:l.vg.PDisks,header:l.uG.PDisks,className:p("pdisks-column"),width:t?.pDiskContainerWidth,render:({row:a})=>(0,i.jsx)(m,{pDisks:a.PDisks,vDisks:a.VDisks,viewContext:e,pDiskWidth:t?.pDiskWidth}),align:r.Ay.CENTER,sortable:!1,resizeable:!1}),g=({database:e,viewContext:t,columnsSettings:a})=>[(0,n._E)(),(0,n.Nh)({database:e}),(0,n.eT)(),(0,n.uk)(),(0,n.OV)(),(0,n.OX)(),(0,n.jl)(),(0,n.fr)(),(0,n.kv)(),(0,n.pH)(),(0,n.iX)(),(0,n.Bg)(),(0,n.Rn)(),(0,n.Vz)(),h({viewContext:t,columnsSettings:a}),(0,n.qp)({database:e}),(0,s.T5)(),(0,s.H0)(),(0,s.fh)()].map(e=>({...e,sortable:(0,l.sp)(e.name)}))},51670:function(e,t,a){a.d(t,{Q:()=>o});var i=a(74848);a(96540);var r=a(94866),s=a(77269),n=a(5434);let l=(0,a(25247).cn)("ydb-table-group"),o=({children:e,title:t,entityName:a,count:o,expanded:d=!1,onIsExpandedChange:u,titleColor:c})=>(0,i.jsxs)("div",{className:l(null),children:[(0,i.jsx)("button",{onClick:()=>{u(t,!d)},className:l("button"),title:t,children:(0,i.jsxs)("div",{className:l("title-wrapper"),children:[(0,i.jsx)(r.I,{direction:d?"top":"bottom"}),(0,i.jsxs)("div",{className:l("title"),children:[(0,i.jsx)(s.E,{variant:"subheader-2",style:c?{color:c}:void 0,children:t}),(0,i.jsxs)(s.E,{variant:"body-2",color:"secondary",className:l("count"),children:[a,": ",(0,i.jsx)(n.J,{theme:"normal",children:o})]})]})]})}),d?(0,i.jsx)("div",{className:l("content"),children:e}):null]});o.displayName="TableGroup"},4627:function(e,t,a){a.d(t,{$:()=>r});var i=a(96540);function r(e){let[t,a]=i.useState({});return i.useEffect(()=>{e?.length&&a(t=>e.reduce((e,{name:a})=>{let i=t[a];return{...e,[a]:i??!1}},{}))},[e]),{expandedGroups:t,setIsGroupExpanded:i.useCallback((e,t)=>{a(a=>({...a,[e]:t}))},[])}}},9263:function(e,t,a){a.d(t,{A:()=>s});var i=a(51432),r=JSON.parse('{"groups":"Groups","nodes":"Nodes","controls_groups-search-placeholder":"Group ID, Pool name","controls_nodes-search-placeholder":"Node ID, FQDN","controls_group-by-placeholder":"Group by:","no-nodes":"No such nodes","no-groups":"No such groups","no-data":"no data"}');let s=(0,i.g4)("ydb-storage",{en:r})},37296:function(e,t,a){a.d(t,{b:()=>i,s:()=>r});let i=(0,a(25247).cn)("global-storage"),r=200},96099:function(e,t,a){a.d(t,{k_:()=>m,QQ:()=>g,b0:()=>h,OH:()=>p,fj:()=>d,Ep:()=>f});var i=a(96540),r=a(2543),s=a(56321),n=a(14016),l=a(61738),o=a(81709);function d(){let[e,t]=i.useState(void 0),[a,r]=i.useState(void 0);return{handleDataFetched:i.useCallback(a=>{if(a?.columnsSettings&&!e){let{maxSlotsPerDisk:e,maxDisksPerNode:i}=a.columnsSettings,s=e||1,n=i||1,l=Math.max(8*s+(s-1)*2,165);t(l),r(n*l+(n-1)*10+20)}},[e]),columnsSettings:i.useMemo(()=>({pDiskWidth:e||165,pDiskContainerWidth:a}),[a,e])}}let u=(0,n.H)(["success","warning","danger"],1,2),c={"block-4-2":(0,n.H)(["success","warning","danger"],1,2),"mirror-3-dc":(0,n.H)(["success","warning","danger"],1,3)},m=e=>{let t;return(void 0!==(t=e.ErasureSpecies)&&t in c?c[e.ErasureSpecies]:u)(e.Degraded)};function p(e,t){let a=!0;return!(0,r.isNil)(e.VDiskId?.GroupID)&&t?.groupId&&(a&&=String(e.VDiskId.GroupID)===t.groupId),!(0,r.isNil)(e.NodeId)&&t?.nodeId&&(a&&=String(e.NodeId)===t.nodeId),!(0,r.isNil)(e.PDiskId)&&t?.pDiskId&&(a&&=String(e.PDiskId)===t.pDiskId),!(0,r.isNil)(e.VDiskSlotId)&&t?.vDiskSlotId&&(a&&=String(e.VDiskSlotId)===t.vDiskSlotId),a}function h(e){return(0,r.isNil)(e?.nodeId)&&(0,r.isNil)(e?.pDiskId)&&(0,r.isNil)(e?.vDiskSlotId)?10:1}function g(e){return(0,r.isNil)(e?.groupId)&&(0,r.isNil)(e?.vDiskSlotId)?10:1}function f(e=[],t){let a=(0,o.J)(),r=(0,l.N4)(e=>(0,s.K)(e,a));return i.useMemo(()=>{let a=[];return"mirror-3-dc"!==t&&"mirror-3of4"!==t||e.forEach((t,i)=>{r?.get(Number(t?.NodeId))?.DC!==r?.get(Number(e[i+1]?.NodeId))?.DC&&a.push(i)}),a},[t,e,r])}},98567:function(e,t,a){a.d(t,{b:()=>function e(t={}){let{Whiteboard:a={},PDisk:d,...u}=t,c={...a,...u,VDiskId:a.VDiskId},m=function(e={}){let{Whiteboard:t,...a}=e,i={...t,...a,PDiskId:t?.PDiskId};if(void 0===i.PDiskId&&a.PDiskId){let e=Number(a.PDiskId.split("-")[1]);isNaN(e)||(i.PDiskId=e)}let s=a.PDiskId||(0,l.r$)({nodeId:i.NodeId,pDiskId:i.PDiskId}),{AllocatedPercent:d,AllocatedSize:u,AvailableSize:c,TotalSize:m}=(0,o.hK)({AvailableSize:i.AvailableSize,TotalSize:i.TotalSize}),p=a.Type?.toUpperCase()??(0,n.Y)(t?.Category),h=(0,r.d)({State:t?.State,AllocatedPercent:d}),g=a.SlotSize??t?.EnforcedDynamicSlotSize;return{...i,StringifiedId:s,AllocatedPercent:d,AllocatedSize:u,AvailableSize:c,TotalSize:m,Type:p,Severity:h,SlotSize:g}}({...d,NodeId:c.NodeId}),p=m?.PDiskId??a?.PDiskId,h=u.VDiskId??(0,i.U9)(a.VDiskId),g=(0,s.b)(c),f=(0,o.LW)({AvailableSize:c.AvailableSize,AllocatedSize:c.AllocatedSize,SlotSize:d?.SlotSize}),k=u.Donors?.map(t=>e({...t,Whiteboard:{...t.Whiteboard,DonorMode:!0}}));return{...c,...f,PDisk:m,Donors:k,PDiskId:p,StringifiedId:h,Severity:g}}});var i=a(97855),r=a(93639),s=a(16021),n=a(96360),l=a(7360),o=a(22530)},2230:function(e,t,a){a.d(t,{t:()=>r});var i=a(58405);async function r({version:e="v2",shouldUseGroupsHandler:t,...a},r){if(t&&"v1"!==e){let e=await window.api.storage.getStorageGroups({...a},r);return(0,i.Rv)(e)}{let t=await window.api.viewer.getStorageInfo({version:e,...a},r);return(0,i.Qi)(t)}}},65615:function(e,t,a){a.d(t,{S:()=>n});var i=a(56496),r=a(2230),s=a(58405);let n=i.F.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,{signal:t})=>{try{let a=await window.api.viewer.getNodes({storage:!0,type:"static",...e},{signal:t});return{data:(0,s.rz)(a)}}catch(e){return{error:e}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,{signal:t})=>{try{return{data:await (0,r.t)(e,{signal:t})}}catch(e){return{error:e}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},58405:function(e,t,a){a.d(t,{Qi:()=>f,Rv:()=>k,rz:()=>g});var i=a(2543),r=a(97855),s=a(7360),n=a(22530),l=a(65101),o=a(51630),d=a(98567);let u=e=>{if((0,i.isNil)(e))return;let t=Number(e);if(!Number.isNaN(t))return t/100};function c(e){let{DiskSpace:t,VDisks:a=[]}=e;return t||(0,s.XY)(Math.max(...a.map(e=>(0,s.H7)(e.DiskSpace))))}let m=(e,t)=>{let a=(0,n.WT)(e);return{...a,StoragePoolName:t,Donors:a?.Donors?.map(e=>({...e,StoragePoolName:t}))}},p=e=>{let{VDisks:t=[],PoolName:a,Usage:i=0,Read:r=0,Write:s=0,Used:n=0,Limit:l=0,Degraded:o=0,Kind:d,MediaType:u,GroupID:p,Overall:h,GroupGeneration:g}=e,f=t.map(e=>m(e,a)),k=100*Number(i),v=c(e);return{...e,PoolName:a,GroupId:p,MediaType:u||d,VDisks:f,Usage:k,Overall:h,GroupGeneration:g?String(g):void 0,Read:Number(r),Write:Number(s),Used:Number(n),Limit:Number(l),Degraded:Number(o),DiskSpace:v}},h=(e,t,a)=>{if(!((0,i.isNil)(e)||(0,i.isNil)(t)||(0,i.isNil)(a)))return(0,r.U9)({NodeId:e,PDiskId:t,VSlotId:a})},g=e=>{let{Nodes:t,TotalNodes:a,FoundNodes:i,NodeGroups:r,MaximumSlotsPerDisk:s,MaximumDisksPerNode:o}=e,d=r?.map(({GroupName:e,NodeCount:t})=>{if(e&&t)return{name:e,count:Number(t)}}).filter(e=>!!e),c=s&&!isNaN(Number(s))?Number(s):Math.max(1,...(t||[]).flatMap(e=>{let t=e.PDisks||[],a=e.VDisks||[];return t.map(e=>a.filter(t=>t.PDiskId===e.PDiskId).length||0)})),m=o&&!isNaN(Number(o))?Number(o):Math.max(1,...(t||[]).map(e=>e.PDisks?.length||0)),p=t?.map(e=>((e,t,a)=>{let{SystemState:i,NodeId:r,PDisks:s,VDisks:o,MaxPDiskUsage:d,MaxVDiskSlotUsage:c,CapacityAlert:m,...p}=e,h=s?.filter(e=>"Normal"!==e.State).length||0,g=s?.map(e=>({...(0,n.or)(e),NodeId:r})),f=o?.map(e=>({...(0,n.WT)(e),NodeId:r}));return{...p,...(0,l.q1)(i),NodeId:r,PDisks:g,VDisks:f,Missing:h,MaximumSlotsPerDisk:t,MaximumDisksPerNode:a,MaxPDiskUsage:u(d),MaxVDiskSlotUsage:u(c),CapacityAlert:m}})(e,c,m));return(e=>{if(!e?.length)return;let t=new Map;e.forEach(e=>{e.VDisks?.forEach(e=>{let a=h(e.NodeId,e.PDiskId,e.VDiskSlotId);a&&t.set(a,e)})}),e.forEach(e=>{e.VDisks?.forEach(e=>{!e.Replicated&&e.Donors?.length&&e.Donors.forEach(a=>{let i=h(a.NodeId,a.PDiskId,a.VDiskSlotId);if(!i)return;let r=t.get(i);r&&(r.Recipient={NodeId:e.NodeId,StringifiedId:e.StringifiedId},a.StringifiedId!==r.StringifiedId&&(a.StringifiedId=r.StringifiedId))})})})})(p),{nodes:p,total:Number(a)||p?.length,found:Number(i),tableGroups:d,columnsSettings:{maxSlotsPerDisk:c,maxDisksPerNode:m}}},f=e=>{let t,{StoragePools:a,StorageGroups:i,TotalGroups:r,FoundGroups:s}=e,l=(t=[],i?t=i.map(p):a?.forEach(e=>{e.Groups?.forEach(a=>{t.push(((e,t)=>{let a,i=0,r=0,s=0,l=0,o=0,{Name:d,MediaType:u}=t;if(e.VDisks)for(let t of e.VDisks){let{Replicated:e,VDiskState:d,AvailableSize:u,AllocatedSize:c,PDisk:m,ReadThroughput:p,WriteThroughput:h}=t,{Type:g,State:f,AvailableSize:k}=(0,n.or)(m);(!1===e||"Normal"!==f||"OK"!==d)&&(i+=1);let v=Number(u??k)||0,x=Number(c)||0;r+=x,s+=v+x,l+=Number(p)||0,o+=Number(h)||0,a=g&&(g===a||!a)?g:"Mixed"}let p=e.VDisks?.map(e=>m(e,d)),h=s?((e,t=1)=>Math.floor((e.Limit?100*e.Used/e.Limit:0)/t)*t)({Used:r,Limit:s},5):void 0,g=c(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:p,Usage:h,Read:l,Write:o,PoolName:d,Used:r,Limit:s,Degraded:i,MediaType:u||a||void 0,DiskSpace:g}})(a,e))})}),t);return{groups:l,total:Number(r)||l.length,found:Number(s)}};function k(e){let{FoundGroups:t,TotalGroups:a,StorageGroups:i=[],StorageGroupGroups:r}=e,s=i.map(e=>{let{Usage:t,DiskSpaceUsage:a,Read:i,Write:r,Used:s,Limit:n,MissingDisks:l,VDisks:m=[],Overall:p,LatencyPutTabletLog:h,LatencyPutUserData:g,LatencyGetFast:f,MaxPDiskUsage:k,MaxVDiskSlotUsage:v,MaxVDiskRawUsage:x,MaxNormalizedOccupancy:S,CapacityAlert:N}=e,y=m.map(d.b),D=c(e);return{...e,Usage:t,DiskSpaceUsage:a,Read:Number(i),Write:Number(r),Used:Number(s),Limit:Number(n),LatencyPutTabletLogMs:(0,o.Jc)(h),LatencyPutUserDataMs:(0,o.Jc)(g),LatencyGetFastMs:(0,o.Jc)(f),Degraded:Number(l),Overall:p,VDisks:y,DiskSpace:D,MaxPDiskUsage:u(k),MaxVDiskRawUsage:u(x),MaxVDiskSlotUsage:u(v),MaxNormalizedOccupancy:S,CapacityAlert:N}}),n=r?.map(({GroupName:e,GroupCount:t})=>{if(e&&t)return{name:e,count:Number(t)}}).filter(e=>!!e);return{groups:s,total:Number(a)||s.length,found:Number(t),tableGroups:n}}},15045:function(e,t,a){a.d(t,{e:()=>s});let i={GREEN:"#00b377",CYAN:"#66e0ff",LIGHTYELLOWMOVE:"#fbffb3",YELLOWSTOP:"#dae600",LIGHTORANGE:"#baa600",PREORANGE:"#996600",ORANGE:"#803e00",RED:"#660000",BLACK:"#000000"},r=i.GREEN,s=e=>{if(e)return e in i?i[e]:r}},93639:function(e,t,a){a.d(t,{J:()=>n,d:()=>s});var i=a(95980),r=a(7360);function s(e){let t=n(e.State),a=(0,r.SW)(e.AllocatedPercent);return t!==i.Km&&a?Math.max(t,a):t}function n(e){var t;return void 0!==(t=e)&&t in i.iZ?i.iZ[e]:i.Km}},16021:function(e,t,a){a.d(t,{J:()=>n,b:()=>s});var i=a(40897),r=a(95980);function s(e){let{DiskSpace:t,VDiskState:a,FrontQueues:i,Replicated:s}=e;if(!a)return r.Ne;let o=Math.max(Math.min(r.aW.Yellow,l(t)),n(a),Math.min(r.aW.Yellow,l(i)));return!1===s&&o===r.aW.Green&&(o=r.aW.Blue),o}function n(e){return e?r.qs[e]??r.Km:r.Ne}function l(e){return e?e===i.m.Blue?r.aW.Green:r.aW[e]??r.Km:r.Km}},95980:function(e,t,a){a.d(t,{A$:()=>c,Km:()=>m,Ne:()=>h,WK:()=>S,Yh:()=>p,aW:()=>d,iZ:()=>f,nG:()=>x,nZ:()=>v,nr:()=>k,qs:()=>g,r4:()=>u});var i=a(11169),r=a(14204),s=a(21852),n=a(32065),l=a(52555),o=a(52457);let d={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},u="DarkGrey",c=Object.entries(d).reduce((e,[t,a])=>({...e,[a]:t}),{}),m=d.Grey,p=c[m],h=d.Red,g={OK:d.Green,Initial:d.Yellow,SyncGuidRecovery:d.Yellow,LocalRecoveryError:d.Red,SyncGuidRecoveryError:d.Red,PDiskError:d.Red},f={Normal:d.Green,Initial:d.Yellow,InitialFormatRead:d.Yellow,InitialSysLogRead:d.Yellow,InitialCommonLogRead:d.Yellow,InitialFormatReadError:d.Red,InitialSysLogReadError:d.Red,InitialSysLogParseError:d.Red,InitialCommonLogReadError:d.Red,InitialCommonLogParseError:d.Red,CommonLoggerInitError:d.Red,OpenFileError:d.Red,ChunkQuotaError:d.Red,DeviceIoError:d.Red,Stopped:d.Red},k={[d.Green]:{theme:"success",icon:i.A},[d.Yellow]:{theme:"warning",icon:r.A},[d.Red]:{theme:"danger",icon:s.A},[d.Blue]:{theme:"info",icon:n.A},[d.Grey]:{theme:"normal"}},v=l.A,x=o.A,S={donor:{theme:"unknown",icon:v},replica:{theme:k[d.Blue].theme,icon:k[d.Blue].icon}}},96360:function(e,t,a){a.d(t,{Y:()=>i});function i(e){var t;let a;if(!e)return;let i=(t=BigInt(e).toString(2),a={},Object.entries({isSolidState:1,kind:55,typeExt:8}).reduce((e,[i,r])=>{let s=t.length-e;return a[i]=t.substring(s-r,s)||"0",e+r},0),a);if("1"===i.isSolidState)switch(parseInt(i.typeExt,2)){case 0:return"SSD";case 2:return"NVME"}else if("0"===i.typeExt)return"HDD"}},7360:function(e,t,a){a.d(t,{H7:()=>c,NJ:()=>l,PH:()=>h,SW:()=>d,XY:()=>u,nC:()=>p,r$:()=>m});var i=a(2543),r=a(40897),s=a(14016),n=a(95980);function l(e){return"VDiskId"in e}let o=(0,s.H)([r.m.Green,r.m.Yellow,r.m.Red]),d=e=>(0,i.isNil)(e)?0:c(o(e));function u(e){return void 0===e?n.Yh:n.A$[e]||n.Yh}function c(e){return e?n.aW[e]:0}function m({nodeId:e,pDiskId:t}){if(!(0,i.isNil)(e)&&!(0,i.isNil)(t))return`${e}-${t}`}function p(e){return("vDiskId"in e?[e.vDiskId]:[e.nodeId,e.pDiskId,e.vDiskSlotId]).join("-")}function h(e,t){if(void 0===e)return;let a=e===n.aW.Red;return t?n.nZ:a?n.nG:void 0}},22530:function(e,t,a){a.d(t,{LW:()=>u,WT:()=>function e(t={}){if(!(0,o.NJ)(t)){let{NodeId:e,PDiskId:a,VSlotId:s}=t,n=(0,i.isNil)(s)||(0,i.isNil)(a)||(0,i.isNil)(e)?void 0:{NodeId:e,PDiskId:a,VSlotId:s};return{StringifiedId:(0,r.U9)(n),NodeId:e,PDiskId:a,VDiskSlotId:s}}let{PDisk:a,PDiskId:s,VDiskId:l,NodeId:c,Donors:m,AvailableSize:p,AllocatedSize:h,...g}=t,f=a?d({...a,NodeId:a?.NodeId??c}):void 0,k=s??f?.PDiskId,v=u({AvailableSize:p,AllocatedSize:h,SlotSize:a?.EnforcedDynamicSlotSize}),x=(0,n.b)(t),S=(0,r.U9)(l),N=m?.map(t=>{if((0,o.NJ)(t))return e({...t,DonorMode:!0});{let{NodeId:e,PDiskId:a,VSlotId:r}=t,s=(0,i.isNil)(e)||(0,i.isNil)(a)||(0,i.isNil)(r)?"":`${e}-${a}-${r}`;return{NodeId:e,PDiskId:a,VDiskSlotId:r,StringifiedId:s,DonorMode:!0}}});return{...g,...v,VDiskId:l,NodeId:c,PDiskId:k,PDisk:f,Donors:N,Severity:x,StringifiedId:S}},hK:()=>c,or:()=>d});var i=a(2543),r=a(97855),s=a(93639),n=a(16021),l=a(96360),o=a(7360);function d(e={}){let{AvailableSize:t,TotalSize:a,Category:i,State:r,PDiskId:n,NodeId:u,EnforcedDynamicSlotSize:m,...p}=e,h=(0,o.r$)({nodeId:u,pDiskId:n}),g=(0,l.Y)(i),f=c({AvailableSize:t,TotalSize:a}),k=(0,s.d)({State:r,AllocatedPercent:f.AllocatedPercent});return{...p,...f,PDiskId:n,NodeId:u,StringifiedId:h,Type:g,Category:i,State:r,Severity:k,SlotSize:m}}function u({AvailableSize:e,AllocatedSize:t,SlotSize:a}){let i=Number(e??0),r=Number(t),s=Number(a),n=r+i;!i&&s&&(n=s);let l=n>0?Math.floor(100*r/n):NaN;return{AvailableSize:i,AllocatedSize:r,SizeLimit:n,AllocatedPercent:l}}function c({AvailableSize:e,TotalSize:t}){let a=Number(e),i=Number(t),r=i-a,s=Math.floor(100*r/i);return{AvailableSize:a,TotalSize:i,AllocatedSize:r,AllocatedPercent:s}}},33583:function(e,t,a){a.d(t,{T:()=>i}),a(60680);let i=(e,t=-1)=>-1===t?`-${e}`:e},5577:function(e,t,a){a.d(t,{g:()=>n,w:()=>l});var i=a(35537),r=a(97855);let s=e=>(0,r.ZV)((0,r.CR)(e||0,2)),n=(e,t)=>[s(e),s(t)];function l({inverseColorize:e,warningThreshold:t=i.Hh,dangerThreshold:a=i.Ed,colorizeProgress:r,fillWidth:s}){let n=e?"danger":"good";return r&&(s>t&&s<=a?n="warning":s>a&&(n=e?"good":"danger")),n}},282:function(e,t,a){a.d(t,{$:()=>n});var i=a(74848),r=a(19583),s=a(67103);let n=e=>403===e.status?(0,i.jsx)(r.O,{position:"left"}):(0,i.jsx)(s.o,{error:e})},36712:function(e,t,a){a.d(t,{R:()=>i});function i(e,t){return Array.from(e.reduce((e,a)=>(t[a].forEach(t=>{e.add(t)}),e),new Set)).sort()}},53486:function(e,t,a){a.d(t,{P:()=>s,_:()=>n});var i=a(40897);let r={Dead:i.m.Red,Created:i.m.Yellow,ResolveStateStorage:i.m.Yellow,Candidate:i.m.Yellow,BlockBlobStorage:i.m.Yellow,WriteZeroEntry:i.m.Yellow,Restored:i.m.Yellow,Discover:i.m.Yellow,Lock:i.m.Yellow,Stopped:i.m.Yellow,ResolveLeader:i.m.Yellow,RebuildGraph:i.m.Yellow,Terminating:i.m.Yellow,Deleted:i.m.Green,Active:i.m.Green},s=e=>e?Object.values(i.m).includes(e)?e:r[e]:i.m.Grey;function n(e){if(!e)return"unknown";switch(e){case"Dead":return"danger";case"Active":case"Deleted":return"success";default:return"warning"}}}}]);