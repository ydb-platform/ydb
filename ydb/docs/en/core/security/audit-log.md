# Audit log

_An audit log_ is a stream that includes data about all the operations that tried to change the {{ ydb-short-name }} objects, successfully or unsuccessfully. The audit log captures, among other things:

* Database: create, edit, delete databases, modify properties.
* Directory: create and delete directories.
* Table: create or edit table schema, change partitions count, backup, recovery, copy, rename, delete tables.
* Topic: create, edit, delete topics.
* ACL: edit ACLs and transfer ownership.
* SQL operations: DDL and DML requests.
* Configuration changes, administrative events.

The data of the audit log stream can be delivered to:

* File on each {{ ydb-short-name }} cluster node.
* Agent for delivering [Unified Agent](https://yandex.cloud/docs/monitoring/concepts/data-collection/unified-agent/) metrics.
* Standard error stream, `stderr`.

You can use any of the listed destinations or their combinations.

If you forward the stream to a file, access to the audit log is controlled by file-system permissions. Saving the audit log to a file is recommended for production installations.

Forwarding the audit log to the standard error stream (`stderr`) is recommended for test installations. Further stream processing is determined by the {{ ydb-short-name }} cluster [logging](../devops/observability/logging.md) settings.

## Audit log events {#events}

Audit events are generated by various audit event sources â€” {{ ydb-short-name }} services or subsystems capable of producing them. Each source is identified by a unique `component` attribute value. In general, enabling audit requires one or more [stream destinations](#enabling-audit-log) in the audit configuration, but some sources may require additional parameters in [audit configuration](#audit-configuration) or enabling [feature flags](../reference/configuration/feature_flags.md).

*Audit event source* could create a separate audit event that contains a set of attributes. These attributes could be divided into two groups:
* Common attributes shared across all event sources.
* Attributes specific to the source that generates the audit event.

### Common attributes {#common-attributes}

#|
|| Attribute          | Description ||
|| `subject`          | Event source SID (`<login>@<subsystem>` format). Unless mandatory authentication is enabled, the attribute will be set to `{none}`.<br/>Required. ||
|| `sanitized_token`  | A partially masked authentication token that was used to execute the request. Can be used to link related events while keeping the original credentials hidden. If authentication was not performed, the value will be `{none}`.<br/>Required. ||
|| `operation`        | Operation name (for example, `ALTER DATABASE`, `CREATE TABLE`).<br/>Required. ||
|| `component`        | Unique identifier of the *audit event source* that generated the event.<br/>Required. ||
|| `status`           | Operation completion status.<br/>Acceptable values:<ul><li>`SUCCESS`: The operation completed successfully.</li><li>`ERROR`: The operation failed.</li><li>`IN-PROCESS`: The operation is in progress.</li></ul>Required. ||
|| `reason`           | Error message.<br/>Optional. ||
|| `request_id`       | Unique ID of the request that invoked the operation. You can use the `request_id` to differentiate events related to different operations and link the events together to build a single audit-related operation context.<br/>Optional. ||
|| `remote_address`   | The IP of the client that delivered the request.<br/>Optional. ||
|| `detailed_status`  | Component-specific status value.<br/>Optional. ||
|| `database`         | Database path (for example, `/my_dir/db`).<br/>Optional. ||
|| `cloud_id`         | Cloud identifier of the {{ ydb-short-name }} database.<br/>Optional. ||
|| `folder_id`        | Folder identifier of the {{ ydb-short-name }} cluster or database.<br/>Optional. ||
|| `resource_id`      | Resource identifier of the {{ ydb-short-name }} database.<br/>Optional. ||
|#

### Schemeshard attributes {#schemeshard}

* **Component value:** `schemeshard`.
* **Logged operations:** Schema operations triggered by DDL queries, ACL modifications, and user management operations.
* **How to enable:** Only [basic audit configuration](#enabling-audit-log) required.

#|
|| Attribute                                | Description ||
|| **Common schemeshard attributes**        | **>** ||
|| `tx_id`                                  | Transaction identifier for the operation.</br>Required. ||
|| `paths`                                  | List of paths affected by the operation.</br>Optional. ||
|| **Ownership and permission attributes**  | **>** ||
|| `new_owner`                              | New owner assigned to a resource.</br>Optional. ||
|| `acl_add`                                | Access control entries being added.</br>Optional. ||
|| `acl_remove`                             | Access control entries being removed.</br>Optional. ||
|| **Custom attributes**                    | **>** ||
|| `user_attrs_add`                         | User attributes being added to a resource.</br>Optional. ||
|| `user_attrs_remove`                      | User attributes being removed from a resource.</br>Optional. ||
|| **Login/Auth specific**                  | **>** ||
|| `login_user`                             | User name recorded by login operations.</br>Optional. ||
|| `login_group`                            | Group name recorded by login operations.</br>Optional. ||
|| `login_member`                           | Membership changes.</br>Optional. ||
|| `login_user_change`                      | Changes applied to user settings.</br>Optional. ||
|| `login_user_level`                       | Privilege level of the user recorded by audit events. Could be `admin`.</br>Optional. ||
|| **Import/Export operation attributes**   | **>** ||
|| `id`                                     | Unique identifier for export or import operations.</br>Optional. ||
|| `uid`                                    | User-defined label for operations.</br>Optional. ||
|| `start_time`                             | Timestamp when an operation started.</br>Optional. ||
|| `end_time`                               | Timestamp when an operation completed.</br>Optional. ||
|| `last_login`                             | Timestamp of the user's last successful login.</br>Optional. ||
|| **Export-specific**                      | **>** ||
|| `export_type`                            | Export destination. Possible values: `yt`, `s3`.</br>Optional. ||
|| `export_item_count`                      | Number of exported items.</br>Optional. ||
|| `export_yt_prefix`                       | YT destination path prefix.</br>Optional. ||
|| `export_s3_bucket`                       | S3 bucket used for exports.</br>Optional. ||
|| `export_s3_prefix`                       | S3 destination prefix.</br>Optional. ||
|| **Import-specific**                      | **>** ||
|| `import_type`                            | Import source type. Value `s3`.</br>Optional. ||
|| `import_item_count`                      | Number of imported items.</br>Optional. ||
|| `import_s3_bucket`                       | S3 bucket used for imports.</br>Optional. ||
|| `import_s3_prefix`                       | S3 source prefix.</br>Optional. ||
|#

### GRPC services attributes {#grpc-proxy}

* **Component value:** `grpc-proxy`.
* **Logged operations:** All non-internal gRPC requests.
* **How to enable:** Requires specifying log classes in audit configuration.
* **Log classes:** Depends on the API: `Ddl`, `Dml`, `Operations`, `ClusterAdmin`, `DatabaseAdmin`, or other classes matching the endpoint.
* **Log phases:** `Received`, `Completed`.

#|
|| Attribute | Description ||
|| **Common gRPC attributes** | **>** ||
|| `grpc_method`              | RPC method name.</br>Required.</br>Optional. ||
|| `request`                  | Sanitized representation of the incoming request.</br>Optional. ||
|| `start_time`               | Operation start time in ISO 8601 format.</br>Required. ||
|| `end_time`                 | Operation end time in ISO 8601 format.</br>Optional. ||
|| **Transaction attributes** | **>** ||
|| `tx_id`                    | Transaction identifier.</br>Optional. ||
|| `begin_tx`                 | Flag set to `1` when the request starts a new transaction.</br>Optional. ||
|| `commit_tx`                | Shows whether the request commits the transaction. Possible values: `true`, `false`.</br>Optional. ||
|| **Request fields**         | **>** ||
|| `query_text`               | Sanitized YQL query text.</br>Optional. ||
|| `prepared_query_id`        | Identifier of a prepared query.</br>Optional. ||
|| `program_text`             | TabletService `ExecuteTabletMiniKQL` payload.</br>Optional. ||
|| `schema_changes`           | TabletService `ChangeTabletSchema` payload.</br>Optional. ||
|| `table`                    | Full table path (for example, for `BulkUpsert`).</br>Optional. ||
|| `row_count`                | Number of rows affected by `BulkUpsert`.</br>Optional. ||
|| `tablet_id`                | Tablet identifier.</br>Optional. ||
|#

### GRPC connection attributes {#grpc-connection}

* **Component value:** `grpc-conn`.
* **Logged operations:** Connection state changes (connect/disconnect).
* **How to enable:** Enable the `EnableGrpcAudit` [feature flag](../reference/configuration/feature_flags.md).

This source does not add component-specific attributes beyond the common attribute set.

### GRPC login attributes {#grpc-login}

* **Component value:** `grpc-login`.
* **Logged operations:** gRPC authentication.
* **How to enable:** Requires specifying log classes in [audit configuration](#audit-log-configuration).
* **Log classes:** `Login`.
* **Log phases:** `Completed`.

#|
|| Attribute          | Description ||
|| `login_user`       | User name.</br>Required. ||
|| `login_user_level` | Value recorded for successful administrator logins. It only takes `admin` value.</br>Optional. ||
|#

### Monitoring service attributes {#monitoring}

* **Component value:** `monitoring`.
* **Logged operations:** HTTP requests handled by the monitoring service.
* **How to enable:** Requires specifying log classes in [audit configuration](#audit-log-configuration).
* **Log classes:** `ClusterAdmin`.
* **Log phases:** `Received`, `Completed`.

#|
|| Attribute  | Description ||
|| `method`   | HTTP request method.</br>Required. ||
|| `url`      | Request path without query parameters.</br>Required. ||
|| `params`   | Query string parameters.</br>Optional. ||
|| `body`     | Request body (truncated to 2 MB with the `TRUNCATED_BY_YDB` suffix).</br>Optional. ||
|#

### Heartbeat attributes {#heartbeat}

* **Component value:** `audit`.
* **Logged operations:** Periodic audit [heartbeat](#heartbeat-settings) messages.
* **How to enable:** It needs specifying log classes in [audit configuration](#audit-log-configuration).
* **Log classes:** `AuditHeartbeat`.
* **Log phases:** `Completed`.

#|
|| Attribute | Description ||
|| `node_id` | Node identifier.</br>Required. ||
|#

### BSC attributes {#bsc}

* **Component value:** `bsc`.
* **Logged operations:** Configuration replacement requests (`TEvControllerReplaceConfigRequest`) emitted by the console.
* **How to enable:** Only [basic audit configuration](#enabling-audit-log) required.

#|
|| Attribute    | Description ||
|| `old_config` | Previous configuration snapshot.</br>Optional. ||
|| `new_config` | New configuration snapshot.</br>Optional. ||
|#

### Distconf attributes {#distconf}

* **Component value:** `distconf`.
* **Logged operations:** Distributed configuration changes.
* **How to enable:** Only [basic audit configuration](#enabling-audit-log) required.

#|
|| Attribute    | Description ||
|| `old_config` | Previous configuration snapshot.</br>Required. ||
|| `new_config` | New configuration snapshot.</br>Required. ||
|#

### Web login attributes {#web-login}

* **Component value:** `web-login`.
* **Logged operations:** Web console logout events.
* **How to enable:** Only [basic audit configuration](#enabling-audit-log) required.

This source does not add component-specific attributes beyond the common set.

### Console attributes {#console}

* **Component value:** `console`.
* **Logged operations:** Dynamic configuration changes and tenant database lifecycle events.
* **How to enable:** Only [basic audit configuration](#enabling-audit-log) required.

#|
|| Attribute    | Description ||
|| `old_config` | Previous configuration snapshot.</br>Optional. ||
|| `new_config` | New configuration snapshot.</br>Optional. ||
|#

> **Note:** YMQ-specific audit sources and the YDBCP deployment variant use a different audit logging configuration and are described in dedicated internal guides.

## Audit log configuration {#audit-log-configuration}

### Enabling audit log {#enabling-audit-log}

Delivering events to the audit log stream is enabled for the entire {{ ydb-short-name }} cluster. For *basic configuration*, add, to the [cluster configuration](../reference/configuration/index.md), the `audit_config` section, and specify in it one of the stream destinations (`file_backend`, `unified_agent_backend`, `stderr_backend`) or their combination:

```yaml
audit_config:
  file_backend:
    format: audit_log_format
    file_path: "path_to_log_file"
  unified_agent_backend:
    format: audit_log_format
    log_name: session_meta_log_name
  stderr_backend:
    format: audit_log_format
```

### `TAuditConfig` parameters {#audit-config}

The `audit_config` section maps directly to the `TAuditConfig` protobuf message. All fields are optional unless stated otherwise.

#|
|| Key                      | Description ||
|| `stderr_backend`         | Forward the audit log to the standard error stream (`stderr`). See the [`TStderrBackend`](#backend-settings) structure.</br>Optional. ||
|| `file_backend`           | Write the audit log to a file at each cluster node. See the [`TFileBackend`](#backend-settings) structure.</br>Optional. ||
|| `unified_agent_backend`  | Stream the audit log to the Unified Agent. In addition, you need to define the `uaclient_config` section in the [cluster configuration](../reference/configuration/index.md). See the [`TUnifiedAgentBackend`](#backend-settings) structure.</br>Optional. ||
|| `log_class_config`       | Array of per-log-class overrides. See the [`TLogClassConfig`](#log-class-config) structure. ||
|| `heartbeat`              | Optional heartbeat configuration. See the [`THeartbeatSettings`](#heartbeat-settings) structure. ||
|#

### Backend settings {#backend-settings}

Each backend supports the following fields:

#|
|| Field                | Description ||
|| `format`             | Audit log format. The default value is `JSON`. See the [`Log format`](#log-format) for details.</ul>Optional. ||
|| `file_path`          | Path to the file that the audit log will be streamed to. If the path and the file are missing, they will be created on each node at cluster startup. If the file exists, the data will be appended to it.<br/>This parameter is required if you use `file_backend`. ||
|| `log_name`           | The session metadata delivered with the message. Using the metadata, you can redirect the log stream to one or more child channels based on the condition: `_log_name: "session_meta_log_name"`.<br/>Optional. ||
|| `log_json_envelope`  | JSON template that wraps each log record. The template must contain the `%message%` placeholder, which is replaced with the serialized audit record. See the [`Envelope format`](#envelope-format). ||
|#

#### Log format {#log-format}

The `format` field specifies the serialization format for audit events. The supported formats are:

#|
|| Format | Description ||
|| `JSON`  | Each audit event is serialized as a single-line JSON object preceded by an ISO 8601 timestamp.</br>`<time>: {"k1": "v1", "k2": "v2", ...}` </br>*k1, k2, ..., kn - fields of audit log message and v1, v2, ..., vn are their values* ||
|| `TXT`   | Each audit event is serialized as a single-line text string in the `key=value` format, preceded by an ISO 8601 timestamp.</br>`<time>: k1=v1, k2=v2, ...` </br>*k1, k2, ..., kn - fields of audit log message and v1, v2, ..., vn are their values* || ||
|| `JSON_LOG_COMPATIBLE` | Each audit event is serialized as a single-line JSON object suitable for output to destinations shared with debug logs. The object contains the `@timestamp` field with the ISO 8601 timestamp and the `@log_type` field set to `audit`.</br>`{"@timestamp": "<ISO 8601 time>", "@log_type": "audit", "k1": "v1", "k2": "v2", ...}` </br>*@timestamp is ISO 8601 format time string, k1, k2, ..., kn - fields of audit log message and v1, v2, ..., vn are their values* ||
|#

#### Envelope format {#envelope}

Backends can wrap audit events into a custom JSON envelope before delivering them to the backend by specifying the `log_json_envelope` field. The template must contain a `%message%` placeholder that is replaced with the serialized audit record in the selected format. The inserted message is automatically escaped during JSON serialization.

For example, the following configuration outputs audit events to `stderr` in JSON format, wrapped in a custom envelope with the `audit` field:

```yaml
audit_config:
  stderr_backend:
    format: JSON
    log_json_envelope: '{"audit": %message%, "source": "ydb-audit-log"}'
```

See the [Example with Envelope JSON](#examples) section for output details.

### Log class configuration {#log-class-config}

Each entry in `log_class_config` accepts the following fields:

#|
|| Field                  | Description ||
|| `log_class`            | Selects the request class to configure. Uses values from the [log classes](#log-classes) list. The `log_class_config` list must not contain two classes with the same name.<br/>Required. ||
|| `enable_logging`       | Enables audit event emission for the selected log class. Disabled by default.<br/>Optional. ||
|| `exclude_account_type` | Array of account type (`Anonymous`, `User`, `Service`, `ServiceImpersonatedFromUser`) that should exclude events even if logging is enabled.<br/>Optional. ||
|| `log_phase`            | Array of request processing phases to log. See the [Log phases](#log-phases).<br/>Optional. ||
|#

#### Log classes {#log-classes}

The supported log classes cover different API surfaces. If not specified, the `Default` class is used.
The log classes are defined as follows:

#|
|| Log class          | Description ||
|| `ClusterAdmin`     | Cluster administration requests. ||
|| `DatabaseAdmin`    | Database administration requests. ||
|| `Login`            | Login requests. ||
|| `NodeRegistration` | Node registration. ||
|| `Ddl`              | Ddl requests. ||
|| `Dml`              | Dml requests. ||
|| `Operations`       | Asynchronous RPC operations that require polling for completion ||
|| `ExportImport`     | Export and import operations. ||
|| `Acl`              | Access control operations. ||
|| `AuditHeartbeat`   | Synthetic heartbeat messages that confirm audit logging remains operational. ||
|| `Default`          | Default settings for any component that doesn't have a configuration entry. ||
|#

#### Log phases {#log-phases}

These phases indicate the processing stage at which the audit event is emitted: whether the request was logged when it was received or after it finished processing.
The log phases are defined as follows:

#|
|| Log phase name | Description ||
|| `Received`     | A request is received and the initial checks and authentication are made. The `status` attribute is set to `IN-PROCESS`. </br>This phase is disabled by default; you must include `Received` in log_class_config.log_phase to enable it. ||
|| `Completed`    | A request is completely finished. The `status` attribute is set to `SUCCESS` or `ERROR`. This phase is enabled by default, if `log_class_config.log_phase` is not set. ||
|#

### Heartbeat settings {#heartbeat-settings}

Heartbeat events help you monitor the health of the audit logging subsystem. They let you set alerts for missing audit events without triggering false positives on workloads that legitimately stay idle for extended periods.

`heartbeat.interval_seconds` controls how often audit heartbeat events are written. A value of `0` disables heartbeat messages.

### Config samples {#config-samples}

Below is a simple configuration that saves the audit log text to a file in `TXT` format.

```yaml
audit_config:
  file_backend:
    format: TXT
    file_path: "/var/log/ydb-audit.log"
```

Sample configuration that sends the audit log to Yandex Unified Agent with the `audit` label and also outputs it to `stderr` in JSON format. The `Default` settings enable logging for all classes in the `Completed` phase. Additionally, `ClusterAdmin` is configured to log the `Received` phase, and `DatabaseAdmin` is configured to exclude events from anonymous users:

```yaml
audit_config:
  unified_agent_backend:
    format: TXT
    log_name: audit
  stderr_backend:
    format: JSON
  log_class_config:
    - log_class: ClusterAdmin
      enable_logging: true
      log_phase: [Received, Completed]
    - log_class: DatabaseAdmin
      enable_logging: true
      log_phase: [Completed]
      exclude_account_type: [Anonymous]
    - log_class: Default
      enable_logging: true
  heartbeat:
    interval_seconds: 60
```

## Examples {#examples}

The following tabs show the same audit log event written in different formats.

{% list tabs %}

- JSON

    For `JSON` format, the audit log entries will look as follows:

    ```json
    2023-03-14T10:41:36.485788Z: {"paths":"[/my_dir/db1/some_dir]","tx_id":"281474976775658","database":"/my_dir/db1","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx","status":"SUCCESS","subject":"{none}","sanitized_token":"{none}", "detailed_status":"StatusAccepted","operation":"MODIFY ACL","component":"schemeshard","acl_add":"[+(ConnDB):subject:-]"}
    2023-03-13T20:07:30.927210Z: {"reason":"Check failed: path: '/my_dir/db1/some_dir', error: path exist, request accepts it (id: [OwnerId: 72075186224037889, LocalPathId: 3], type: EPathTypeDir, state: EPathStateNoChanges)","paths":"[/my_dir/db1/some_dir]","tx_id":"844424930216970","database":"/my_dir/db1","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx","status":"SUCCESS","subject":"{none}","sanitized_token":"{none}","detailed_status":"StatusAlreadyExists","operation":"CREATE DIRECTORY","component":"schemeshard"}
    2025-11-03T18:07:39.056211Z: {"@log_type":"audit","begin_tx":1,"commit_tx":1,"component":"grpc-proxy","database":"/my_dir/db1","detailed_status":"SUCCESS","end_time":"2025-11-03T18:07:39.056204Z","grpc_method":"Ydb.Query.V1.QueryService/ExecuteQuery","operation":"ExecuteQueryRequest","query_text":"SELECT * FROM `my_row_table`;","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]","sanitized_token":"xxxxxxxx.**","start_time":"2025-11-03T18:07:39.054863Z","status":"SUCCESS","subject":"serviceaccount@as"}
    2025-11-03T17:41:44.203214Z: {"component":"monitoring","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]","operation":"HTTP REQUEST","method":"POST","url":"/viewer/query","params":"base64=false&schema=multipart","body":"{\"query\":\"SELECT * FROM `my_row_table`;\",\"database\":\"/local\",\"action\":\"execute-query\",\"syntax\":\"yql_v1\"}","status":"IN-PROCESS","reason":"Execute"}
    ```

- TXT

    For `TXT` format, the audit log entries will look as follows:

    ```txt
    2023-03-14T10:41:36.485788Z: component=schemeshard, tx_id=281474976775658, remote_address=ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx, subject={none}, database=/my_dir/db1, operation=MODIFY ACL, paths=[/my_dir/db1/some_dir], status=SUCCESS, detailed_status=StatusSuccess, acl_add=[+(ConnDB):subject:-]
    2023-03-13T20:07:30.927210Z: component=schemeshard, tx_id=281474976775657, remote_address=ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx, subject={none}, database=/my_dir/db1, operation=CREATE DIRECTORY, paths=[/my_dir/db1/some_dir], status=SUCCESS, detailed_status=StatusAlreadyExists, reason=Check failed: path: '/my_dir/db1/some_dir', error: path exist, request accepts it (id: [OwnerId: 72075186224037889, LocalPathId: 3], type: EPathTypeDir, state: EPathStateNoChanges)
    2025-11-03T18:07:39.056211Z: component=grpc-proxy, tx_id=281474976775656, remote_address=ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx, subject=serviceaccount@as, database=/my_dir/db1, operation=ExecuteQueryRequest, query_text=SELECT * FROM `my_row_table`; status=SUCCESS, detailed_status=StatusSuccess, begin_tx=1, commit_tx=1, end_time=2025-11-03T18:07:39.056204Z, grpc_method=Ydb.Query.V1.QueryService/ExecuteQuery, sanitized_token=xxxxxxxx.**, start_time=2025-11-03T18:07:39.054863Z
    2025-11-03T17:41:44.203214Z: component=monitoring, remote_address=ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx], operation=HTTP REQUEST, method=POST, url=/viewer/query, params=base64=false&schema=multipart, body={"query":"SELECT * FROM `my_row_table`;","database":"/local","action":"execute-query","syntax":"yql_v1"}, status=IN-PROCESS, reason=Execute
    ```

- JSON_LOG_COMPATIBLE

    For `JSON_LOG_COMPATIBLE` format, the audit log entries will look as follows:

    ```json
    {"@timestamp":"2023-03-14T10:41:36.485788Z","@log_type":"audit","paths":"[/my_dir/db1/some_dir]","tx_id":"281474976775658","database":"/my_dir/db1","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx","status":"SUCCESS","subject":"{none}","detailed_status":"StatusAccepted","operation":"MODIFY ACL","component":"schemeshard","acl_add":"[+(ConnDB):subject:-]"}
    {"@timestamp":"2023-03-13T20:07:30.927210Z","@log_type":"audit","reason":"Check failed: path: '/my_dir/db1/some_dir', error: path exist, request accepts it (id: [OwnerId: 72075186224037889, LocalPathId: 3], type: EPathTypeDir, state: EPathStateNoChanges)","paths":"[/my_dir/db1/some_dir]","tx_id":"844424930216970","database":"/my_dir/db1","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx","status":"SUCCESS","subject":"{none}","detailed_status":"StatusAlreadyExists","operation":"CREATE DIRECTORY","component":"schemeshard"}
    {"@timestamp":"2025-11-03T18:07:39.056211Z","@log_type":"audit","begin_tx":1,"commit_tx":1,"component":"grpc-proxy","database":"/my_dir/db1","detailed_status":"SUCCESS","end_time":"2025-11-03T18:07:39.056204Z","grpc_method":"Ydb.Query.V1.QueryService/ExecuteQuery","operation":"ExecuteQueryRequest","query_text":"SELECT * FROM `my_row_table`;","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]","start_time":"2025-11-03T18:07:39.054863Z","status":"SUCCESS","subject":"serviceaccount@as","sanitized_token":"xxxxxxxx.**"}
    {"@timestamp":"2025-11-03T17:41:44.203214Z","@log_type":"audit","component":"monitoring","remote_address":"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]","operation":"HTTP REQUEST","method":"POST","url":"/viewer/query","params":"base64=false&schema=multipart","body":"{\"query\":\"SELECT * FROM `my_row_table`;\",\"database\":\"/local\",\"action\":\"execute-query\",\"syntax\":\"yql_v1\"}","status":"IN-PROCESS","reason":"Execute"}
    ```

- Envelope JSON

    For JSON envelope template: `{"message": %message%, "source": "ydb-audit-log"}`, the audit log entries will look as follows:

    ```json
    {"message":"2023-03-14T10:41:36.485788Z: {\"paths\":\"[/my_dir/db1/some_dir]\",\"tx_id\":\"281474976775658\",\"database\":\"/my_dir/db1\",\"remote_address\":\"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx\",\"status\":\"SUCCESS\",\"subject\":\"{none}\",\"detailed_status\":\"StatusAccepted\",\"operation\":\"MODIFY ACL\",\"component\":\"schemeshard\",\"acl_add\":\"[+(ConnDB):subject:-]\"}\n","source":"ydb-audit-log"}
    {"message":"2023-03-13T20:07:30.927210Z: {\"reason\":\"Check failed: path: '/my_dir/db1/some_dir', error: path exist, request accepts it (id: [OwnerId: 72075186224037889, LocalPathId: 3], type: EPathTypeDir, state: EPathStateNoChanges)\",\"paths\":\"[/my_dir/db1/some_dir]\",\"tx_id\":\"844424930216970\",\"database\":\"/my_dir/db1\",\"remote_address\":\"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx\",\"status\":\"SUCCESS\",\"subject\":\"{none}\",\"detailed_status\":\"StatusAlreadyExists\",\"operation\":\"CREATE DIRECTORY\",\"component\":\"schemeshard\"}\n","source":"ydb-audit-log"}
    {"message":"2025-11-03T18:07:39.056211Z: {\"@log_type\":\"audit\",\"begin_tx\":1,\"commit_tx\":1,\"component\":\"grpc-proxy\",\"database\":\"/my_dir/db1\",\"detailed_status\":\"SUCCESS\",\"end_time\":\"2025-11-03T18:07:39.056204Z\",\"grpc_method\":\"Ydb.Query.V1.QueryService/ExecuteQuery\",\"operation\":\"ExecuteQueryRequest\",\"query_text\":\"SELECT * FROM `my_row_table`;\",\"remote_address\":\"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]\",\"sanitized_token\":\"xxxxxxxx.**\",\"start_time\":\"2025-11-03T18:07:39.054863Z\",\"status\":\"SUCCESS\",\"subject\":\"serviceaccount@as\"}\n","source":"ydb-audit-log"}
    {"message":"2025-11-03T17:41:44.203214Z: {\"component\":\"monitoring\",\"remote_address\":\"ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]\",\"operation\":\"HTTP REQUEST\",\"method\":\"POST\",\"url\":\"/viewer/query\",\"params\":\"base64=false&schema=multipart\",\"body\":\"{\\\"query\\\":\\\"SELECT * FROM `my_row_table`;\\\",\\\"database\\\":\\\"/local\\\",\\\"action\\\":\\\"execute-query\\\",\\\"syntax\\\":\\\"yql_v1\\\"}\",\"status\":\"IN-PROCESS\",\"reason\":\"Execute\"}\n","source":"ydb-audit-log"}
    ```

- Pretty JSON

    Below is the same audit log entry in a more human-readable format:

    ```json
    {
      "paths": "[/my_dir/db1/some_dir]",
      "tx_id": "281474976775658",
      "database": "/my_dir/db1",
      "remote_address": "ipv6:[xxxx:xxx:xxx:xxx:x:xxxx:xxx:xxxx]:xxxxx",
      "status": "SUCCESS",
      "subject": "{none}",
      "detailed_status": "StatusAccepted",
      "operation": "MODIFY ACL",
      "component": "schemeshard",
      "acl_add": "[+(ConnDB):subject:-]"
    }
    ```

{% endlist %}
