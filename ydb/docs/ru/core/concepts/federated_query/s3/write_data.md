# Запись данных в бакеты S3 ({{ objstorage-full-name }})

В {{ ydb-full-name }} для записи данных в бакет {{ objstorage-full-name }} можно использовать [внешние соединения](#connection-write) или [внешние таблицы](#external-table-write).

## Запись данных через внешнее соединение {#connection-write}

Запись данных с помощью соединений удобно использовать для прототипирования и первоначальной настройки работы с записью данных. SQL-выражение иллюстрирует запись данных во внешний источник данных напрямую.

```yql
INSERT INTO `connection`.`test/`
WITH
(
  FORMAT = "csv_with_names"
)
SELECT
    "value" AS value, "name" AS name
```

Запись будет произведена в указанный путь. При этом режиме результирующие файлы не будут партиционированы. Если необходимо партиционировать результирующие файлы, то используйте запись через [внешние таблицы](#external-table-write). Создаваемые при записи файлы получают случайные имена.

При работе с внешними соединениями возможны только операции чтения (`SELECT`) и вставки (`INSERT`) данных, другие виды операций не поддерживаются.

## Запись данных через внешние таблицы {#external-table-write}

Если записывать данные нужно регулярно, то удобно делать это с помощью внешних таблиц. При этом нет необходимости указывать все детали работы с этими данными в каждом запросе. Для записи данных в бакет создайте [внешнюю таблицу](external_table.md) в S3 ({{ objstorage-full-name }}) и используйте обычное SQL-выражение `INSERT INTO`:

```yql
INSERT INTO `test`
SELECT
    "value" AS value, "name" AS name
```

## Экспорт данных в объектное хранилище S3 {#export-to-s3}

{{ ydb-short-name }} поддерживает экспорт данных из таблиц в S3 с помощью [внешнего соединения](../../datamodel/external_data_source.md).

Экспорт из [колоночных таблиц](../../datamodel/table.md#column-oriented-tables) (OLAP-таблиц) поддерживается без ограничений. Экспорт из [строковых таблиц](../../datamodel/table.md#row-oriented-tables) поддерживается только для таблиц размером до 1 ГБ.

Для экспорта нужно использовать запрос [записи во внешнее соединение](#connection-write) с указанием [формата экспортируемого файла](./formats.md):

```yql
INSERT INTO `connection`.`test/`
WITH
(
    FORMAT = "csv_with_names"
)
SELECT
    *
FROM table
```

