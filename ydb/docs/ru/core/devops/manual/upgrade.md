# Обновление

{{ ydb-short-name }} распределенная система, поддерживающая плавное обновление (rolling restart) без даунтайма и деградации производительности.

## Порядок обновления {#upgrade-order}

Базовым сценарием является обновление исполняемого файла и последовательный рестарт каждого узла:

1. Обновление и рестарт storage узлов;
1. Обновление и рестарт динамических узлов.

Процесс остановки и запуска описан на странице [Безопасные рестарт и выключение узлов](../../maintenance/manual/node_restarting.md).
Узлы {{ ydb-short-name }} следует обновлять последовательно по одному, после каждого шага контролировать состояние кластера через [{{ ydb-short-name }} Monitoring](../../reference/embedded-ui/ydb-monitoring.md) - на вкладке `Storage` не должно быть пулов в состоянии `Degraded` (как на примере ниже). В противном случае обновление необходимо остановить.

![Monitoring_storage_state](../../reference/embedded-ui/_assets/monitoring_storage_state.png)

## Совместимость версий {#version-compatability}

{% note info %}

Раньше версия сервера {{ ydb-short-name }} состояла из 3 чисел (например, `v24.3.3`), начиная с мажорной версии `25.1`, добавлена четвертое число, которое обозначает номер патча (например, `v25.1.1.3`). Подробнее про изменения в именовании версий [тут](../../contributor/manage-releases.md). 

{% endnote %}

Совместимыми для обновления являются все минорные версии в рамках одной мажорной версии. Мажорные версии совместимы последовательно. Для обновления на следующую мажорную версию предварительно следует обновиться на последний доступный минорный релиз текущей мажорной версии. Например:

* `X.Y.*.* → X.Y.*.*` — обновление возможно, все минорные версии в рамках одной мажорной совместимы.
* `X.Y.Z.*` (последняя доступная `X.Y.*.*`) → `X.Y+1.*.*` - обновление возможно, мажорные версии последовательны.
* `X.Y.*.*` → `X.Y+2.*.*` — обновление невозможно, мажорные версии непоследовательны.
* `X.Y.*.* → X.Y-2.*.*` — обновление невозможно, мажорные версии непоследовательны.

{% note warning %}

Также, в любом случае нельзя откатываться на более чем 2 мажорные версии назад относительно хотя бы раз выкаченной версии, так как настолько старая версия может не знать как работать с данными на дисках, которые записала текущая.

{% endnote %}

Список доступных версий можно получить на [странице загрузки](../../downloads/index.md). Релизная политика {{ ydb-short-name }} описана более детально в статье [Управление релизами](../../contributor/manage-releases.md) в разделе документации для разработчиков {{ ydb-short-name }}.

### Примеры совместимости версий

* `v.25.1.3.2`  ->  `v.25.1.5.5` - обновление возможно
* `v.25.1.5.5`  ->  `v.25.2.3.1` - обновление возможно (где `v25.1.5.*` последняя доступная минорная версия в `v.25.1`)
* `v.25.1.4.1`  ->  `v.25.2.3.1` - обновление невозможно, необходимо сначала обновиться до последней минорной версии (`v.25.1.5.*`)
* `v.25.1.5.5`  ->  `v.25.3.5.3` - обновление невозможно, необходимо сначала обновиться до следующей мажорной версии (`v.25.2.*.*`).


## Проверка результата обновления {#upgrade_check}

Проверить версии узлов после обновления можно на странице `Nodes` мониторинга.
