# Аудитное логирование клиентских соединений

Записи о входящих "соединениях" позволяют узнать, с каких ip-адресов и от чьего имени приходят клиентские запросы.

## Атрибуты записей

| __Атрибут__ | __Описание__ |
|:----|:----|
| `component` | Логирующий компонент, всегда `grpc-conn`.
| `remote_address` | IP-адрес клиента, приславшего запрос.
| `subject` | User SID пользователя, от имени которого выполняется операция.
| `database` | Путь базы данных, в которой выполняется операция.
| `operation`| Тип запроса.

## Включение

Аудитное логирование должно быть [включено](audit-log.md#enabling-audit-log) на кластере.

Логирование клиентских соединений включается флагом `feature_flags.enable_grpc_audit` через изменение [конфигурации кластера](../maintenance/manual/config-overview.md).

[//]: # (TODO: добавить ссылку нв раздел feature-flags, когда он появится)

## Что нужно знать

[//]: # (TODO: добавить переменную для ссылок на glossary)
- Логирование происходит в компоненте {{ ydb-short-name }} `gRPC Proxy`.

- Взаимодействие с клиентом происходит по протоколу [gRPC](https://grpc.io/), который реальные сетевые соединения скрывает за более высокоуровневыми понятиями. Поэтому вместо факта установления сетевого соединения `gRPC Proxy` логирует факт прихода клиентского запроса.

- В лог попадают запросы, прошедшие [аутентификацию](../deploy/configuration/config#auth) и проверку прав на базу. При отключенной аутентификации логируются все запросы.

## Пример записи лога

```json
{
    "component": "grpc-conn",
    "remote_address": "xxxx:xxx:xxxx:xx:xxxx:xxxx:xxxx:xxx",
    "subject": "bfbohb360qqqql1ef604@ad",
    "database": "/root/db"
    "operation": "ExecuteDataQueryRequest",
}
```
