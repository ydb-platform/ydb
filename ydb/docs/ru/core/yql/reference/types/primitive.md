# Примитивные типы данных

<!-- markdownlint-disable blanks-around-fences -->

Термины «простые», «примитивные» и «элементарные» типы данных используются как синонимы.

## Числовые типы {#numeric}

Тип | Описание | Примечания
----- | ----- | -----
`Bool` | Логическое значение. |
`Int8` | Целое число со знаком.<br/>Допустимые значения: от –2<sup>7</sup> до 2<sup>7</sup>–1. |
`Int16` | Целое число со знаком.<br/>Допустимые значения: от –2<sup>15</sup> до 2<sup>15</sup>–1. |
`Int32` | Целое число со знаком.<br/>Допустимые значения: от –2<sup>31</sup> до 2<sup>31</sup>–1. |
`Int64` | Целое число со знаком.<br/>Допустимые значения: от –2<sup>63</sup> до 2<sup>63</sup>–1. |
`Uint8` | Беззнаковое целое число.<br/>Допустимые значения: от 0 до 2<sup>8</sup>–1. |
`Uint16` | Беззнаковое целое число.<br/>Допустимые значения: от 0 до 2<sup>16</sup>–1. |
`Uint32` | Беззнаковое целое число.<br/>Допустимые значения: от 0 до 2<sup>32</sup>–1. |
`Uint64` | Беззнаковое целое число.<br/>Допустимые значения: от 0 до 2<sup>64</sup>–1. |
`Float` | Вещественное число с переменной точностью размером 4 байта. | {% if feature_map_tables %}Не может быть использован в первичном ключе{% endif %}
`Double` | Вещественное число с переменной точностью размером 8 байт. | {% if feature_map_tables %}Не может быть использован в первичном ключе{% endif %}
`Decimal` | Вещественное число с указанной точностью, до 35 десятичных знаков | {% if feature_map_tables %}При использовании в колонках таблиц точность фиксирована: Decimal (22,9).{% endif %}
{% if feature_map_tables %}
`DyNumber` | Бинарное представление вещественного числа точностью до 38 знаков.<br/>Допустимые значения: положительные от 1×10<sup>-130</sup> до 1×10<sup>126</sup>–1, отрицательные от -1×10<sup>126</sup>–1 до -1×10<sup>-130</sup> и 0.<br/>Совместим с типом `Number` AWS DynamoDB. Не рекомендуется для использования в {{ backend_name_lower }}-native приложениях.  |
{% endif %}


## Строковые типы {#string}

Тип | Описание | Примечания
----- | ----- | -----
`String` | Строка, может содержать произвольные бинарные данные |
`Utf8` | Текст в кодировке [UTF-8](https://en.wikipedia.org/wiki/UTF-8) |
`Json` | [JSON](https://en.wikipedia.org/wiki/JSON) в текстовом представлении|Не поддерживает возможность сравнения{% if feature_map_tables %}, не может быть использован в первичном ключе{% endif %}
`JsonDocument` | [JSON](https://en.wikipedia.org/wiki/JSON) в бинарном индексированном представлении | Не поддерживает возможность сравнения{% if feature_map_tables %}, не может быть использован в первичном ключе{% endif %}
`Yson` | [YSON](yson.md) в текстовом или бинарном представлении | Не поддерживает возможность сравнения{% if feature_map_tables %}, не может быть использован в первичном ключе{% endif %}
`Uuid` | Универсальный идентификатор [UUID](https://tools.ietf.org/html/rfc4122) |

{% note info "Ограничения на размер" %}

Максимальный размер значения в ячейке {% if feature_map_tables %} неключевого столбца {% endif %} с любым строковым типом данных —  8 МБ.

{% endnote %}

В отличие от типа данных `Json`, который хранит исходное текстовое представление, переданное пользователем, `JsonDocument` использует бинарное индексированное представление. Важное отличие с точки зрения семантики состоит в том, что `JsonDocument` не сохраняет форматирование, порядок ключей в объектах и их дубликаты.

За счет индексированного представления `JsonDocument` позволяет обходить документную модель с использованием `JsonPath` без необходимости парсинга всего содержимого. Это позволяет эффективно выполнять операции из [JSON API](../builtins/json.md), уменьшая задержки и стоимость пользовательских запросов. Выполнение запросов над `JsonDocument` может быть до нескольких раз эффективнее в зависимости от типа нагрузки.

Из-за добавленной избыточности `JsonDocument` менее эффективен в хранении. Дополнительные накладные расходы на хранение зависят от конкретного содержимого и в среднем составляют 20–30% от исходного объема. Сохранение данных в формате `JsonDocument` требует дополнительной конвертации из текстового представления, что делает его запись менее эффективной. Тем не менее, для большинства read-intensive сценариев, подразумевающих обработку данных из JSON, этот тип данных является предпочтительным и рекомендуется к использованию.

{% note warning %}

Для хранения чисел (JSON Number) в `JsonDocument`, а также для арифметических операций над ними в [JSON API](../builtins/json.md) используется тип [Double](https://en.wikipedia.org/wiki/Double-precision_floating-point_format). Возможна потеря точности при использовании нестандартных представлений чисел в исходном JSON-документе.

{% endnote %}

## Дата и время {#datetime}

Тип | Описание | Примечания
----- | ----- | -----
`Date` | Дата, точность до дней | Диапазон значений для всех временных типов кроме `Interval` - от нуля часов 01.01.1970 до нуля часов 01.01.2106. Внутреннее представление `Date` – беззнаковое целое 16 бит  |
`Datetime` | Дата/время, точность до секунд | Внутреннее представление – беззнаковое целое 32 бит |
`Timestamp` | Дата/время, точность до микросекунд | Внутреннее представление – беззнаковое целое 64 бит |
`Interval` | Интервал времени (знаковый), точность до микросекунд | Диапазон значений – от -136 лет до +136 лет. Внутреннее представление – знаковое целое 64 бит. {% if feature_map_tables %}Не может быть использован в первичном ключе{% endif %}
`TzDate` | Дата с меткой временной зоны, точность до дней | Не поддерживается в столбцах таблиц
`TzDateTime` | Дата/время с меткой временной зоны, точность до секунд | Не поддерживается в столбцах таблиц
`TzTimestamp` | Дата/время с меткой временной зоны, точность до микросекунд | Не поддерживается в столбцах таблиц

### Особенности поддержки типов с меткой временной зоны

Метка временной зоны у типов `TzDate`, `TzDatetime`, `TzTimestamp` это атрибут, который используется:

* При преобразовании ([CAST](../syntax/expressions.md#cast), [DateTime::Parse](../udf/list/datetime.md#parse), [DateTime::Format](../udf/list/datetime.md#format)) в строку и из строки.
* В [DateTime::Split](../udf/list/datetime.md#split) - появляется компонент таймзоны в `Resource<TM>`.

Само значение позиции во времени у этих типов хранится в UTC, и метка таймзоны никак не участвует в прочих расчётах. Например:

```yql
SELECT --эти выражения всегда true для любых таймзон: таймзона не влияет на точку во времени.
    AddTimezone(CurrentUtcDate(), "Europe/Moscow") ==
        AddTimezone(CurrentUtcDate(), "America/New_York"),
    AddTimezone(CurrentUtcDatetime(), "Europe/Moscow") ==
        AddTimezone(CurrentUtcDatetime(), "America/New_York");
```

Важно понимать, что при преобразованиях между `TzDate` и `TzDatetime` или `TzTimestamp` дате соответствует не полночь по локальному времени таймзоны, а полночь по UTC для даты в UTC.


## Приведение простых типов данных {#cast}

### Явное приведение {#explicit-cast}

Явное приведение при помощи [CAST](../syntax/expressions.md#cast):

#### Приведение к численным типам

Тип | Bool | Int8 | Int16 | Int32 | Int64 | Uint8 | Uint16 | Uint32 | Uint64 | Float | Double | Decimal
--- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
**Bool** | — | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Да<sup>1</sup> | Нет
**Int8** | Да<sup>2</sup> | — | Да | Да | Да | Да<sup>3</sup> | Да<sup>3</sup> | Да<sup>3</sup> | Да<sup>3</sup> | Да | Да | Да
**Int16** | Да<sup>2</sup> | Да<sup>4</sup> | — | Да | Да | Да<sup>3,4</sup> | Да<sup>3</sup> | Да<sup>3</sup> | Да<sup>3</sup> | Да | Да | Да
**Int32** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | — | Да | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3</sup> | Да<sup>3</sup> | Да | Да | Да
**Int64** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | — | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3</sup> | Да | Да | Да
**Uint8** | Да<sup>2</sup> | Да<sup>4</sup> | Да | Да | Да | — | Да | Да | Да | Да | Да | Да
**Uint16** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да | Да<sup>4</sup> | — | Да | Да | Да | Да | Да
**Uint32** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да<sup>4</sup> | Да<sup>4</sup> | — | Да | Да | Да | Да
**Uint64** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | — | Да | Да | Да
**Float** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | — | Да | Нет
**Double** | Да<sup>2</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да | — | Нет
**Decimal** | Нет | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да | —
**String** | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да
**Utf8** | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да | Да
**Json** | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет
**Yson** | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Да<sup>5</sup> | Нет
**Uuid** | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет | Нет
**Date** | Нет | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да | Да<sup>4</sup> | Да | Да | Да | Да | Да | Да | Нет
**Datetime** | Нет | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да | Да | Да | Нет
**Timestamp** | Нет | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да | Да | Нет
**Interval** | Нет | Да<sup>4</sup> | Да<sup>4</sup> | Да<sup>4</sup> | Да | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3,4</sup> | Да<sup>3</sup> | Да | Да | Нет

<sup>1</sup> `True` преобразуется в `1`, `False` преобразуется в `0`.
<sup>2</sup> Любое значение кроме `0` преобразуется в `True`, `0` преобразуется в `False`.
<sup>3</sup> Возможно только в случае неотрицательного значения.
<sup>4</sup> Возможно только в случае попадания в диапазон допустимых значений.
<sup>5</sup> При помощи встроенной функции [Yson::ConvertTo](../udf/list/yson.md#ysonconvertto).

#### Приведение к типам данных даты и времени

Тип | Date | Datetime | Timestamp | Interval
--- | --- | --- | --- | ---
**Bool** | Нет | Нет | Нет | Нет
**Int8** | Да | Да | Да | Да
**Int16** | Да | Да | Да | Да
**Int32** | Да | Да | Да | Да
**Int64** | Да | Да | Да | Да
**Uint8** | Да | Да | Да | Да
**Uint16** | Да | Да | Да | Да
**Uint32** | Да | Да | Да | Да
**Uint64** | Да | Да | Да | Да
**Float** | Нет | Нет | Нет | Нет
**Double** | Нет | Нет | Нет | Нет
**Decimal** | Нет | Нет | Нет | Нет
**String** | Да | Да | Да | Да
**Utf8** | Да | Да | Да | Да
**Json** | Нет | Нет | Нет | Нет
**Yson** | Нет | Нет | Нет | Нет
**Uuid** | Нет | Нет | Нет | Нет
**Date** | — | Да | Да | Нет
**Datetime** | Да | — | Да | Нет
**Timestamp** | Да | Да | — | Нет
**Interval** | Нет | Нет | Нет | — | —

#### Приведение к другим типам данных

Тип | String | Utf8 | Json | Yson | Uuid
--- | --- | --- | --- | --- | ---
**Bool** | Да | Нет | Нет | Нет | Нет |
**Int8** | Да | Нет | Нет | Нет | Нет
**Int16** | Да | Нет | Нет | Нет | Нет
**Int32** | Да | Нет | Нет | Нет | Нет
**Int64** | Да | Нет | Нет | Нет | Нет
**Uint8** | Да | Нет | Нет | Нет | Нет
**Uint16** | Да | Нет | Нет | Нет | Нет
**Uint32** | Да | Нет | Нет | Нет | Нет
**Uint64** | Да | Нет | Нет | Нет | Нет
**Float** | Да | Нет | Нет | Нет | Нет
**Double** | Да | Нет | Нет | Нет | Нет
**Decimal** | Да | Нет | Нет | Нет | Нет
**String** | — | Да | Да | Да | Да
**Utf8** | Да | — | Нет | Нет | Нет
**Json** | Да | Да | — | Нет | Нет
**Yson** | Да<sup>1</sup> | Нет | Нет | Нет | Нет
**Uuid** | Да | Да | Нет | Нет | —
**Date** | Да | Да | Нет | Нет | Нет
**Datetime** | Да | Да | Нет | Нет | Нет
**Timestamp** | Да | Да | Нет | Нет | Нет
**Interval** | Да | Да | Нет | Нет | Нет

<sup>1</sup> При помощи встроенной функции [Yson::ConvertTo](../udf/list/yson.md#ysonconvertto).

##### Примеры

{% include [x](../_includes/cast_examples.md) %}

### Неявное приведение {#implicit-cast}

Неявное приведение типов, которое возникает в базовых операциях (`+`, `-`, `*`, `/`, `%`) между разными типами данных. В ячейках таблицы указан тип результата операции, если она возможна:

#### Численные типы

При несовпадении численных типов сначала выполняется BitCast обоих аргументов к типу результата, а потом уже операция.

Тип | Int8 | Int16 | Int32 | Int64 | Uint8 | Uint16 | Uint32 | Uint64 | Float | Double
--- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
**Int8** | — | `Int16` | `Int32` | `Int64` | `Int8` | `Uint16` | `Uint32` | `Uint64` | `Float` | `Double`
**Int16** | `Int16` | — | `Int32` | `Int64` | `Int16` | `Int16` | `Uint32` | `Uint64` | `Float` | `Double`
**Int32** | `Int32` | `Int32` | — | `Int64` | `Int32` | `Int32` | `Int32` | `Uint64` | `Float` | `Double`
**Int64** | `Int64` | `Int64` | `Int64` | — | `Int64` | `Int64` | `Int64` | `Int64` | `Float` | `Double`
**Uint8** | `Int8` | `Int16` | `Int32` | `Int64` | — | `Uint16` | `Uint32` | `Uint64` | `Float` | `Double`
**Uint16** | `Uint16` | `Int16` | `Int32` | `Int64` | `Uint16` | — | `Uint32` | `Uint64` | `Float` | `Double`
**Uint32** | `Uint32` | `Uint32` | `Int32` | `Int64` | `Uint32` | `Uint32` | — | `Uint64` | `Float` | `Double`
**Uint64** | `Uint64` | `Uint64` | `Uint64` | `Int64` | `Uint64` | `Uint64` | `Uint64` | — | `Float` | `Double`
**Float** | `Float` | `Float` | `Float` | `Float` | `Float` | `Float` | `Float` | `Float` | — | `Double`
**Double** | `Double` | `Double` | `Double` | `Double` | `Double` | `Double` | `Double` | `Double` | `Double` | —


#### Типы даты и времени

Тип | Date | Datetime | Timestamp | Interval | TzDate | TzDatetime | TzTimestamp
--- | --- | --- | --- | --- | --- | --- | ---
**Date** | — | — | — | `Date` | — | — | —
**Datetime** | — | — | — | `Datetime` | — | — | —
**Timestamp** | — | — | — | `Timestamp` | — | — | —
**Interval** | `Date` | `Datetime` | `Timestamp` | — | `TzDate` | `TzDatetime` | `TzTimestamp`
**TzDate** | — | — | — | `TzDate` | — | — | —
**TzDatetime** | — | — | — | `TzDatetime` | — | — | —
**TzTimestamp**  | — | — | — | `TzTimestamp` | — | — | —
