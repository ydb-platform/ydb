services:

  fq-connector-go:
    build: ./connector.d
    container_name: fq-tests-ch-fq-connector-go
    ports:
      - 2130
    depends_on:
      clickhouse:
        condition: service_healthy

  clickhouse:
    build: ./clickhouse.d
    container_name: fq-tests-ch-clickhouse
    environment:
      CLICKHOUSE_ALWAYS_RUN_INITDB_SCRIPTS: 1
      CLICKHOUSE_DB: db
      CLICKHOUSE_DEFAULT_ACCESS_MANAGEMENT: 1
      CLICKHOUSE_PASSWORD: password
      CLICKHOUSE_USER: user
    ports:
      - 9000
      - 8123

version: "2.4"
