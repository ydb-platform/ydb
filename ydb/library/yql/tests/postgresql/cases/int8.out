--
-- INT8
-- Test int8 64-bit integers.
--
CREATE TABLE INT8_TBL(q1 int8, q2 int8);
INSERT INTO INT8_TBL VALUES('  123   ','  456');
INSERT INTO INT8_TBL VALUES('123   ','4567890123456789');
INSERT INTO INT8_TBL VALUES('4567890123456789','123');
INSERT INTO INT8_TBL VALUES(+4567890123456789,'4567890123456789');
INSERT INTO INT8_TBL VALUES('+4567890123456789','-4567890123456789');
-- bad inputs
INSERT INTO INT8_TBL(q1) VALUES ('      ');
ERROR:  invalid input syntax for type bigint: "      "
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('      ');
                                         ^
INSERT INTO INT8_TBL(q1) VALUES ('xxx');
ERROR:  invalid input syntax for type bigint: "xxx"
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('xxx');
                                         ^
INSERT INTO INT8_TBL(q1) VALUES ('3908203590239580293850293850329485');
ERROR:  value "3908203590239580293850293850329485" is out of range for type bigint
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('39082035902395802938502938...
                                         ^
INSERT INTO INT8_TBL(q1) VALUES ('-1204982019841029840928340329840934');
ERROR:  value "-1204982019841029840928340329840934" is out of range for type bigint
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('-1204982019841029840928340...
                                         ^
INSERT INTO INT8_TBL(q1) VALUES ('- 123');
ERROR:  invalid input syntax for type bigint: "- 123"
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('- 123');
                                         ^
INSERT INTO INT8_TBL(q1) VALUES ('  345     5');
ERROR:  invalid input syntax for type bigint: "  345     5"
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('  345     5');
                                         ^
INSERT INTO INT8_TBL(q1) VALUES ('');
ERROR:  invalid input syntax for type bigint: ""
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('');
                                         ^
SELECT * FROM INT8_TBL WHERE q2 > 4567890123456789;
 q1 | q2 
----+----
(0 rows)

SELECT * FROM INT8_TBL WHERE 123 > q1;
 q1 | q2 
----+----
(0 rows)

SELECT * FROM INT8_TBL WHERE '123'::int2 > q1;
 q1 | q2 
----+----
(0 rows)

-- check min/max values and overflow behavior
select '-9223372036854775808'::int8;
         int8         
----------------------
 -9223372036854775808
(1 row)

select '-9223372036854775809'::int8;
ERROR:  value "-9223372036854775809" is out of range for type bigint
LINE 1: select '-9223372036854775809'::int8;
               ^
select '9223372036854775807'::int8;
        int8         
---------------------
 9223372036854775807
(1 row)

select '9223372036854775808'::int8;
ERROR:  value "9223372036854775808" is out of range for type bigint
LINE 1: select '9223372036854775808'::int8;
               ^
select -('-9223372036854775807'::int8);
      ?column?       
---------------------
 9223372036854775807
(1 row)

select -('-9223372036854775808'::int8);
ERROR:  bigint out of range
select '9223372036854775800'::int8 + '9223372036854775800'::int8;
ERROR:  bigint out of range
select '-9223372036854775800'::int8 + '-9223372036854775800'::int8;
ERROR:  bigint out of range
select '9223372036854775800'::int8 - '-9223372036854775800'::int8;
ERROR:  bigint out of range
select '-9223372036854775800'::int8 - '9223372036854775800'::int8;
ERROR:  bigint out of range
select '9223372036854775800'::int8 * '9223372036854775800'::int8;
ERROR:  bigint out of range
select '9223372036854775800'::int8 / '0'::int8;
ERROR:  division by zero
select '9223372036854775800'::int8 % '0'::int8;
ERROR:  division by zero
select abs('-9223372036854775808'::int8);
ERROR:  bigint out of range
select '9223372036854775800'::int8 + '100'::int4;
ERROR:  bigint out of range
select '-9223372036854775800'::int8 - '100'::int4;
ERROR:  bigint out of range
select '9223372036854775800'::int8 * '100'::int4;
ERROR:  bigint out of range
select '100'::int4 + '9223372036854775800'::int8;
ERROR:  bigint out of range
select '-100'::int4 - '9223372036854775800'::int8;
ERROR:  bigint out of range
select '100'::int4 * '9223372036854775800'::int8;
ERROR:  bigint out of range
select '9223372036854775800'::int8 + '100'::int2;
ERROR:  bigint out of range
select '-9223372036854775800'::int8 - '100'::int2;
ERROR:  bigint out of range
select '9223372036854775800'::int8 * '100'::int2;
ERROR:  bigint out of range
select '-9223372036854775808'::int8 / '0'::int2;
ERROR:  division by zero
select '100'::int2 + '9223372036854775800'::int8;
ERROR:  bigint out of range
select '-100'::int2 - '9223372036854775800'::int8;
ERROR:  bigint out of range
select '100'::int2 * '9223372036854775800'::int8;
ERROR:  bigint out of range
select '100'::int2 / '0'::int8;
ERROR:  division by zero
SELECT CAST('42'::int2 AS int8), CAST('-37'::int2 AS int8);
 int8 | int8 
------+------
   42 |  -37
(1 row)

SELECT CAST('36854775807.0'::float4 AS int8);
    int8     
-------------
 36854775808
(1 row)

SELECT CAST('922337203685477580700.0'::float8 AS int8);
ERROR:  bigint out of range
-- generate_series
SELECT * FROM generate_series('+4567890123456789'::int8, '+4567890123456799'::int8);
 generate_series  
------------------
 4567890123456789
 4567890123456790
 4567890123456791
 4567890123456792
 4567890123456793
 4567890123456794
 4567890123456795
 4567890123456796
 4567890123456797
 4567890123456798
 4567890123456799
(11 rows)

