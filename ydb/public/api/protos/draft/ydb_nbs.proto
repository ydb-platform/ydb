syntax = "proto3";
option cc_enable_arenas = true;

package Ydb.Nbs;

option java_package = "com.yandex.ydb.nbs.proto";
option java_outer_classname = "NbsProtos";
option java_multiple_files = true;

import "ydb/public/api/protos/ydb_operation.proto";


////////////////////////////////////////////////////////////////////////////////
// Partition create request/response.

enum StorageMediaKind {
    STORAGE_MEDIA_DEFAULT = 0;
    STORAGE_MEDIA_SSD = 1;
    STORAGE_MEDIA_MEMORY = 2;
}

message CreatePartitionRequest {
    Ydb.Operations.OperationParams operation_params = 1;

    // Storage pool name to use.
    string StoragePoolName = 2;

    // Minimum addressable block size (smallest unit of I/O operations).
    uint32 BlockSize = 3;

    // Maximum number of blocks stored in partition.
    uint64 BlocksCount = 4;

    // Storage media type
    StorageMediaKind StorageMedia = 5;
}

message CreatePartitionResponse {
    Ydb.Operations.Operation operation = 1;
}

message CreatePartitionResult {
    string TabletId = 1;
}

////////////////////////////////////////////////////////////////////////////////
// Partition delete request/response.

message DeletePartitionRequest {
    Ydb.Operations.OperationParams operation_params = 1;
    // Partition tablet id to delete.
    string TabletId = 2;
}

message DeletePartitionResponse {
    Ydb.Operations.Operation operation = 1;
}

message DeletePartitionResult {
    // Deleted partition tablet id.
    string TabletId = 1;
}

////////////////////////////////////////////////////////////////////////////////
// Partition list request/response.

message ListPartitionsRequest {
    Ydb.Operations.OperationParams operation_params = 1;
}

message ListPartitionsResponse {
    Ydb.Operations.Operation operation = 1;
}

message ListPartitionsResult {
    repeated string TabletId = 1;
}

////////////////////////////////////////////////////////////////////////////////
// I/O vector message.

message IOVector {
    // I/O buffers.
    repeated bytes Buffers = 1;
}

////////////////////////////////////////////////////////////////////////////////
// Blocks read request/response.

message ReadBlocksRequest {
    Ydb.Operations.OperationParams operation_params = 1;

    // Label of volume to read from.
    string DiskId = 2;

    // Start block index.
    uint64 StartIndex = 3;

    // Number of blocks to read.
    uint32 BlocksCount = 4;
}

message ReadBlocksResponse {
    Ydb.Operations.Operation operation = 1;
}

message ReadBlocksResult
{
    // Requested blocks.
    IOVector Blocks = 1;
}

////////////////////////////////////////////////////////////////////////////////
// Blocks write request/response.

message WriteBlocksRequest {
    Ydb.Operations.OperationParams operation_params = 1;

    // Label of volume to write to.
    string DiskId = 2;

    // Start block index.
    uint64 StartIndex = 3;

    // Blocks to write.
    IOVector Blocks = 4;
}

message WriteBlocksResponse {
    Ydb.Operations.Operation operation = 1;
}

message WriteBlocksResult {
}
