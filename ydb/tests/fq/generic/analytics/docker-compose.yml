services:

  fq-connector-go:
    build: ./connector
    container_name: tests-fq-generic-analytics-fq-connector-go
    ports:
      - "2130"
    depends_on:
      clickhouse:
        condition: service_healthy
      greenplum:
        condition: service_healthy
      mysql:
        condition: service_healthy
      postgresql:
        condition: service_healthy
      ydb:
        condition: service_healthy

  clickhouse:
    build: ./clickhouse
    container_name: tests-fq-generic-analytics-clickhouse
    environment:
      CLICKHOUSE_DB: db
      CLICKHOUSE_DEFAULT_ACCESS_MANAGEMENT: 1
      CLICKHOUSE_PASSWORD: password
      CLICKHOUSE_USER: user
    tmpfs:
      - /run
      - /tmp
      - /var

  mysql:
    build: ./mysql
    container_name: tests-fq-generic-analytics-mysql
    environment:
      MYSQL_DATABASE: db
      MYSQL_ROOT_PASSWORD: password
    ports:
      - 3306
    tmpfs:
      - /run
      - /tmp
      - /var

  greenplum:
    build: ./greenplum
    container_name: tests-fq-generic-analytics-greenplum
    tmpfs:
      - /run
      - /tmp
      - /var

  postgresql:
    build: ./postgresql
    command: -p 6432
    container_name: tests-fq-generic-analytics-postgresql
    environment:
      POSTGRES_DB: db
      POSTGRES_PASSWORD: password
      POSTGRES_USER: user
    tmpfs:
      - /run
      - /tmp
      - /var

  ydb:
    build: ./ydb
    container_name: tests-fq-generic-analytics-ydb
    environment:
      DB_USE_IN_MEMORY_PDISKS: "true"
      POSTGRES_PASSWORD: password
      POSTGRES_USER: user
      YDB_DEFAULT_LOG_LEVEL: DEBUG
    hostname: tests-fq-generic-analytics-ydb

version: "2.4"
