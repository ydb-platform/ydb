(
(let $1 (Configure! world (DataSource '"config") '"DqEngine" '"force"))
(let $2 (Configure! $1 (DataSource '"dq" '"$all") '"Attr" '"maxtasksperstage" '"10"))
(let $3 (Configure! $2 (DataSource '"pq" '"$all") '"Attr" '"consumer" '"test_client"))
(let $4 (DataSource '"pq" '"pq"))
(let $5 '('('"PartitionsCount" '"1")))
(let $6 (StructType '('"Data" (DataType 'String))))
(let $7 (PqTopic '"pq" '"local" '"test_topic_input" $5 '() $6))
(let $8 '('"Data"))
(let $9 '('"Endpoint" '"<pq_pq_endpoint>"))
(let $10 '('"SharedReading" '"1"))
(let $11 '('"UseSsl" '"1"))
(let $12 '('('"Consumer" '"test_client") $9 $10 '('"ReconnectPeriod" '"") '('"Format" '"raw") '('"ReadGroup" '"fqrun") $11))
(let $13 (SecureParam '"cluster:default_pq"))
(let $14 (DqPqTopicSource $3 $7 $8 $12 $13 '"" $6 '""))
(let $15 (lambda '($25) (block '(
  (let $26 '('('"format" '"raw") '('"formatSettings" '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX"))) '('"settings" '($10))))
  (let $27 (DqSourceWideWrap $25 $4 $6 $26))
  (return (NarrowMap $27 (lambda '($28) (AsStruct '('"Data" $28)))))
))))
(let $16 (DataSink '"pq" '"pq"))
(let $17 (PqTopic '"pq" '"local" '"test_topic_output" $5 '() $6))
(let $18 '($9 $11))
(let $19 (DqPqTopicSink $17 $18 $13))
(let $20 (Commit! (DqQuery! $3 '((DqStage '((DqSource $4 $14)) $15 '('('"_logical_id" '0)) '((DqSink '"0" $16 $19))))) $16))
(let $21 (PqTopic '"pq" '"local" '"test_topic_input2" $5 '() $6))
(let $22 (DqPqTopicSource $20 $21 $8 $12 $13 '"" $6 '""))
(let $23 (PqTopic '"pq" '"local" '"test_topic_output2" $5 '() $6))
(let $24 (DqPqTopicSink $23 $18 $13))
(return (Commit! (DqQuery! $20 '((DqStage '((DqSource $4 $22)) $15 '('('"_logical_id" '0)) '((DqSink '"0" $16 $24))))) $16))
)
