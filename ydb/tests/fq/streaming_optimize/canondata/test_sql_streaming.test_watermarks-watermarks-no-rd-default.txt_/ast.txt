(
(let $1 (Configure! world (DataSource '"config") '"DqEngine" '"force"))
(let $2 (Configure! $1 (DataSource '"dq" '"$all") '"Attr" '"watermarksmode" '"default"))
(let $3 (Configure! $2 (DataSource '"pq" '"$all") '"Attr" '"consumer" '"test_client"))
(let $4 (DataSink 'result))
(let $5 (DataSource '"pq" '"pq"))
(let $6 (StructType '('"ts" (DataType 'Timestamp))))
(let $7 (PqTopic '"pq" '"local" '"test_topic_input" '('('"PartitionsCount" '"1")) '() $6))
(let $8 '('"SharedReading" '"0"))
(let $9 '('('"Consumer" '"test_client") '('"Endpoint" '"<pq_pq_endpoint>") $8 '('"ReconnectPeriod" '"") '('"Format" '"json_each_row") '('"ReadGroup" '"fqrun") '('"UseSsl" '"1") '('"WatermarksEnable" '"1") '('"WatermarksGranularityUs" '"2000000") '('"WatermarksLateArrivalDelayUs" '"7000000") '('"WatermarksLateEventsPolicy" '"adjust") '('"WatermarksIdlePartitions" '"1") '('"WatermarksIdleTimeoutUs" '"3000000")))
(let $10 (DqPqTopicSource world $7 '('"ts") $9 (SecureParam '"cluster:default_pq") '"" $6 '"\x1A0\b\x03\x12\x19\x12\x17_yql_sys_tsp_write_time\x1A\x11\n\x0F\n\x02\b3\x12\t!\xC0\xCFj\x00\x00\x00\x00\x00"))
(let $11 (DqStage '((DqSource $5 $10)) (lambda '($14) (block '(
  (let $15 '('('"data.datetime.formatname" '"POSIX") '('"data.timestamp.formatname" '"POSIX") '('"watermarkgranularity" '"PT2S") '('"watermarkidletimeout" '"PT3S")))
  (let $16 '('('"format" '"json_each_row") '('"formatSettings" $15) '('"settings" '($8))))
  (let $17 (DqSourceWideWrap $14 $5 $6 $16))
  (return (NarrowMap $17 (lambda '($18) (AsStruct '('"ts" $18)))))
))) '('('"_logical_id" '0))))
(let $12 (DqStage '((DqCnUnionAll (TDqOutput $11 '"0"))) (lambda '($19) $19) '('('"_logical_id" '0))))
(let $13 (ResPull! $3 $4 (Key) (DqCnResult (TDqOutput $12 '"0") '()) '('('type) '('autoref)) '"dq"))
(return (Commit! (Commit! $13 $4) (DataSink '"pq" '"pq")))
)
