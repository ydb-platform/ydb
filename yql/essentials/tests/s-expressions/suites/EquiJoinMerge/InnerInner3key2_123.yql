(
(let world (Configure! world (DataSource '"yt" '"$all") '"Attr" '"joinmergetableslimit" '"10"))
(let world (Configure! world (DataSource '"yt" '"$all") '"Attr" '"joinallowcolumnrenames" 'true))
(let mr_source (DataSource 'yt 'plato))
(let x (Read! world mr_source (Key '('table (String 'Input1))) '('key 'subkey 'value1) '()))
(let world (Left! x))
(let table1 (Right! x))
(let x (Read! world mr_source (Key '('table (String 'Input2))) '('key 'subkey 'value2) '()))
(let world (Left! x))
(let table2 (Right! x))
(let x (Read! world mr_source (Key '('table (String 'Input3))) '('key 'subkey 'value3) '()))
(let world (Left! x))
(let table3 (Right! x))
(let join (EquiJoin '(table1 'a) '(table2 'b) '(table3 'c) 
  '('Inner
    '('Inner '"a" '"b" '('"a" '"key" '"a" '"subkey") '('"b" '"key" '"b" '"subkey") '()) 
    '"c" '('"a" '"key" '"a" '"subkey") '('"c" '"key" '"c" '"subkey") '()) '()))
(let res_sink (DataSink 'result))
(let world (Write! world res_sink (Key) join '('('type))))
(let world (Commit! world res_sink))
(return world)
)
