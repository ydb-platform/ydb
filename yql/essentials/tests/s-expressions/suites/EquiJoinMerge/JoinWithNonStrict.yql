(

(let world (Configure! world (DataSource '"yt" '"$all") '"Attr" '"joinmergetableslimit" '"10"))
(let world (Configure! world (DataSource '"yt" '"$all") '"Attr" '"joinmergeunsortedfactor" '"3.0"))
(let mr_source (DataSource 'yt 'plato))
(let x (Read! world mr_source (Key '('table (String 'Input1))) '('key 'subkey 'value) '()))
(let world (Left! x))
(let table1 (Right! x))
(let x (Read! world mr_source (Key '('table (String 'Input2))) '('key) '('('infer_scheme))))
(let world (Left! x))
(let table2 (Right! x))
(let join (EquiJoin '(table1 'a) '(table2 'b)
    '('Inner '"a" '"b" '('"a" '"key") '('"b" '"key" ) '()) 
    '()))
(let res_sink (DataSink 'result))
(let world (Write! world res_sink (Key) join '('('type))))
(let world (Commit! world res_sink))
(return world)
)
