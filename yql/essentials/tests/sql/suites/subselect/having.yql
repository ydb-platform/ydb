$input = SELECT * FROM AS_TABLE([
    <|k: 1, v: 1|>, <|k: 2, v: 1|>,
    <|k: 1, v: 2|>, <|k: 2, v: 2|>,
    <|k: 1, v: 3|>, <|k: 2, v: 3|>,
    <|k: 1, v: 4|>, <|k: 2, v: 4|>,
    <|k: 1, v: 5|>, <|k: 2, v: 5|>,
]);

SELECT k, Avg(v) FROM $input GROUP BY k HAVING Avg(v) == (SELECT 3);

SELECT k, Avg(v) FROM $input GROUP BY k HAVING Avg(v) == (SELECT Avg(v) FROM $input);

SELECT k, Avg(v) FROM $input GROUP BY k HAVING Avg(v) == (SELECT Avg(v) FROM $input WHERE v == 3);
