/*
syntax='proto3';

import "yt/yt_proto/yt/formats/extension.proto";

message Test {
  option (NYT.default_field_flags) = SERIALIZATION_PROTOBUF;
  message InnerInner {
    string a = 1;
  }
  message Inner {
    InnerInner i = 1;
  }
  Inner inner = 1;
  Test test = 2;
}
*/


$config = @@{
  "name": "Test",
  "format": "json",
  "skip": 0,
  "lists": {
    "optional": false
  },
  "meta": "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",
  "view": {
    "recursion": "bytes",
    "enum": "number",
    "yt_mode": true
  }
}@@;

$udfPar = Udf(Protobuf::Parse, $config as TypeConfig);
$udfSer = Udf(Protobuf::Serialize, $config as TypeConfig);

SELECT TestField, Ensure("Success", $udfPar(TestField) == $udfPar($udfSer($udfPar(TestField))), "Fail")
FROM plato.Input;

