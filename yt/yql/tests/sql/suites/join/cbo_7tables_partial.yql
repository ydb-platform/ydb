USE plato;

PRAGMA CostBasedOptimizer = 'native';
PRAGMA yt.CostBasedOptimizerPartial = '3';
PRAGMA yt.MapJoinLimit = '1000';
PRAGMA yt.LookupJoinLimit = '1000';
PRAGMA yt.LookupJoinMaxRows = '100';
PRAGMA yt.ExtendedStatsMaxChunkCount = '0';
PRAGMA yt.JoinMergeTablesLimit = '100';

SELECT
    InputA.Key1 AS a_k1,
    InputA.Key2 AS a_k2,
    InputA.Fk1 AS a_fk,
    InputA.Value AS a_v,
    InputB.k AS b_k,
    InputB.val AS b_v,
    InputC.k AS c_k,
    InputC.v AS c_v,
    InputD.k AS d_k,
    InputD.value AS d_v,
    InputE.e1 AS e_e1,
    InputF.f2 AS f_f2,
    InputG.g1 AS g_g1,
    InputG.g2 AS g_g2,
    InputG.g3 AS g_g3,
FROM
    InputA
INNER JOIN
    InputC
ON
    InputA.Key1 == InputC.k
RIGHT JOIN
    InputD
ON
    InputA.Key2 == InputD.k
RIGHT JOIN (
    SELECT
        *
    FROM
        InputB
    WHERE
        k != ''
) AS InputB
ON
    InputA.Fk1 == InputB.k
INNER JOIN
    InputG
ON
    InputD.value == InputG.g3
INNER JOIN
    InputF
ON
    InputF.f2 == InputG.g1
INNER JOIN
    InputE
ON
    InputG.g2 == InputE.e1
;
