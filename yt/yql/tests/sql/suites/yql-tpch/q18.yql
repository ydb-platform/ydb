/* dqfile can not */
/* hybridfile can not - missing langver support */
--ignore runonopt plan diff
PRAGMA YqlSelect = 'force';
PRAGMA AnsiImplicitCrossJoin;

SELECT
    c_name,
    c_custkey,
    o_orderkey,
    o_orderdate,
    o_totalprice,
    Sum(l_quantity)
FROM
    plato.customer
,
    plato.orders
,
    plato.lineitem
WHERE
    o_orderkey IN (
        SELECT
            l_orderkey
        FROM
            plato.lineitem
        GROUP BY
            l_orderkey
        HAVING
            Sum(l_quantity) > 300
    )
    AND c_custkey == o_custkey
    AND o_orderkey == l_orderkey
GROUP BY
    c_name,
    c_custkey,
    o_orderkey,
    o_orderdate,
    o_totalprice
ORDER BY
    o_totalprice DESC,
    o_orderdate
LIMIT 100;
